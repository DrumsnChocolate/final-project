12/26 13:01:43 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 (main, Sep 11 2023, 13:44:35) [GCC 11.2.0]
    CUDA available: True
    numpy_random_seed: 1779930985
    GPU 0: NVIDIA A40
    CUDA_HOME: None
    GCC: gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
    PyTorch: 2.0.0
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.15.0
    OpenCV: 4.8.1
    MMEngine: 0.9.1

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1779930985
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

12/26 13:01:44 - mmengine - INFO - Config:
backbone_norm_cfg = dict(eps=1e-06, requires_grad=True, type='LN')
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/cbis/cbis-linked'
dataset_type = 'CBISBinaryDataset'
default_hooks = dict(
    checkpoint=dict(
        by_epoch=False,
        interval=16000,
        max_keep_ckpts=2,
        type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
launcher = 'none'
load_from = None
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=[
        dict(
            act_cfg=dict(type='ReLU'),
            align_corners=False,
            channels=256,
            dropout_ratio=0,
            in_channels=1024,
            in_index=0,
            kernel_size=3,
            loss_decode=dict(
                loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
            norm_cfg=dict(requires_grad=True, type='SyncBN'),
            num_classes=2,
            num_convs=2,
            type='SETRUPHead'),
        dict(
            act_cfg=dict(type='ReLU'),
            align_corners=False,
            channels=256,
            dropout_ratio=0,
            in_channels=1024,
            in_index=1,
            kernel_size=3,
            loss_decode=dict(
                loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
            norm_cfg=dict(requires_grad=True, type='SyncBN'),
            num_classes=2,
            num_convs=2,
            type='SETRUPHead'),
        dict(
            act_cfg=dict(type='ReLU'),
            align_corners=False,
            channels=256,
            dropout_ratio=0,
            in_channels=1024,
            in_index=2,
            kernel_size=3,
            loss_decode=dict(
                loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
            norm_cfg=dict(requires_grad=True, type='SyncBN'),
            num_classes=2,
            num_convs=2,
            type='SETRUPHead'),
    ],
    backbone=dict(
        drop_rate=0.0,
        embed_dims=1024,
        img_size=(
            512,
            512,
        ),
        in_channels=3,
        init_cfg=dict(
            checkpoint='pretrain/vit_large_p16.pth', type='Pretrained'),
        interpolate_mode='bilinear',
        norm_cfg=dict(eps=1e-06, requires_grad=True, type='LN'),
        num_heads=16,
        num_layers=24,
        out_indices=(
            9,
            14,
            19,
            23,
        ),
        patch_size=16,
        type='VisionTransformer',
        with_cls_token=True),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0,
        in_channels=1024,
        in_index=3,
        kernel_size=3,
        loss_decode=dict(
            class_weight=[
                0.04,
                1.96,
            ],
            loss_weight=1.0,
            type='CrossEntropyLoss',
            use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=2,
        num_convs=4,
        type='SETRUPHead',
        up_scale=2),
    pretrained=None,
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
num_classes = 2
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.1, momentum=0.9, type='SGD', weight_decay=0.001),
    paramwise_cfg=dict(custom_keys=dict(head=dict(lr_mult=10.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.1, momentum=0.9, type='SGD', weight_decay=0.001)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
record_gpu_snapshot = True
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/test', seg_map_path='annotations_binary/test'),
        data_root='data/cbis/cbis-linked',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                512,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=False, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='CBISBinaryDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        512,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=False, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/train', seg_map_path='annotations_binary/train'),
        data_root='data/cbis/cbis-linked',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=False, type='LoadAnnotations'),
            dict(keep_ratio=True, scale=(
                512,
                512,
            ), type='Resize'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PackSegInputs'),
        ],
        type='CBISBinaryDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=False, type='LoadAnnotations'),
    dict(keep_ratio=True, scale=(
        512,
        512,
    ), type='Resize'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = None
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/val', seg_map_path='annotations_binary/val'),
        data_root='data/cbis/cbis-linked',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                512,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=False, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='CBISBinaryDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
val_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        512,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=False, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = './work_dirs/setr_vit-l_pup_8xb2-160k_cbis-ddsm-binary-512x512'

/home/s1952889/final-project/implementation/mmsegmentation/mmseg/models/decode_heads/decode_head.py:120: UserWarning: For binary segmentation, we suggest using`out_channels = 1` to define the outputchannels of segmentor, and use `threshold`to convert `seg_logits` into a predictionapplying a threshold
  warnings.warn('For binary segmentation, we suggest using'
/home/s1952889/final-project/implementation/mmsegmentation/mmseg/models/builder.py:36: UserWarning: ``build_loss`` would be deprecated soon, please use ``mmseg.registry.MODELS.build()`` 
  warnings.warn('``build_loss`` would be deprecated soon, please use '
/home/s1952889/final-project/implementation/mmsegmentation/mmseg/models/losses/cross_entropy_loss.py:253: UserWarning: Default ``avg_non_ignore`` is False, if you would like to ignore the certain label and average loss over non-ignore labels, which is the same with PyTorch official cross_entropy, set ``avg_non_ignore=True``.
  warnings.warn(
12/26 13:02:00 - mmengine - INFO - Total parameters: 317137928
12/26 13:02:00 - mmengine - INFO - Trainable parameters: 317137928
12/26 13:02:01 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
/home/s1952889/final-project/implementation/mmsegmentation/mmseg/engine/hooks/visualization_hook.py:61: UserWarning: The draw is False, it means that the hook for visualization will not take effect. The results will NOT be visualized or stored.
  warnings.warn('The draw is False, it means that the '
12/26 13:02:01 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
/home/s1952889/final-project/implementation/mmsegmentation/mmseg/datasets/transforms/loading.py:83: UserWarning: `reduce_zero_label` will be deprecated, if you would like to ignore the zero label, please set `reduce_zero_label=True` when dataset initialized
  warnings.warn('`reduce_zero_label` will be deprecated, '
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.conv_seg.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.conv_seg.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.conv_seg.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.conv_seg.bias:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.conv_seg.bias:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.conv_seg.bias:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.norm.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.norm.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.norm.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.norm.bias:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.norm.bias:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.norm.bias:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.0.0.conv.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.0.0.conv.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.0.0.conv.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.0.0.bn.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.0.0.bn.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.0.0.bn.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.0.0.bn.bias:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.0.0.bn.bias:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.0.0.bn.bias:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.1.0.conv.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.1.0.conv.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.1.0.conv.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.1.0.bn.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.1.0.bn.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.1.0.bn.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.1.0.bn.bias:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.1.0.bn.bias:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.1.0.bn.bias:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.2.0.conv.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.2.0.conv.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.2.0.conv.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.2.0.bn.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.2.0.bn.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.2.0.bn.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.2.0.bn.bias:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.2.0.bn.bias:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.2.0.bn.bias:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.3.0.conv.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.3.0.conv.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.3.0.conv.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.3.0.bn.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.3.0.bn.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.3.0.bn.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.3.0.bn.bias:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.3.0.bn.bias:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- decode_head.up_convs.3.0.bn.bias:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.conv_seg.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.conv_seg.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.conv_seg.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.conv_seg.bias:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.conv_seg.bias:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.conv_seg.bias:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.norm.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.norm.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.norm.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.norm.bias:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.norm.bias:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.norm.bias:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.up_convs.0.0.conv.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.up_convs.0.0.conv.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.up_convs.0.0.conv.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.up_convs.0.0.bn.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.up_convs.0.0.bn.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.up_convs.0.0.bn.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.up_convs.0.0.bn.bias:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.up_convs.0.0.bn.bias:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.up_convs.0.0.bn.bias:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.up_convs.1.0.conv.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.up_convs.1.0.conv.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.up_convs.1.0.conv.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.up_convs.1.0.bn.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.up_convs.1.0.bn.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.up_convs.1.0.bn.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.up_convs.1.0.bn.bias:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.up_convs.1.0.bn.bias:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.0.up_convs.1.0.bn.bias:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.conv_seg.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.conv_seg.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.conv_seg.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.conv_seg.bias:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.conv_seg.bias:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.conv_seg.bias:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.norm.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.norm.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.norm.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.norm.bias:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.norm.bias:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.norm.bias:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.up_convs.0.0.conv.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.up_convs.0.0.conv.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.up_convs.0.0.conv.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.up_convs.0.0.bn.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.up_convs.0.0.bn.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.up_convs.0.0.bn.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.up_convs.0.0.bn.bias:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.up_convs.0.0.bn.bias:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.up_convs.0.0.bn.bias:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.up_convs.1.0.conv.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.up_convs.1.0.conv.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.up_convs.1.0.conv.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.up_convs.1.0.bn.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.up_convs.1.0.bn.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.up_convs.1.0.bn.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.up_convs.1.0.bn.bias:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.up_convs.1.0.bn.bias:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.1.up_convs.1.0.bn.bias:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.conv_seg.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.conv_seg.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.conv_seg.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.conv_seg.bias:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.conv_seg.bias:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.conv_seg.bias:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.norm.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.norm.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.norm.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.norm.bias:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.norm.bias:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.norm.bias:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.up_convs.0.0.conv.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.up_convs.0.0.conv.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.up_convs.0.0.conv.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.up_convs.0.0.bn.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.up_convs.0.0.bn.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.up_convs.0.0.bn.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.up_convs.0.0.bn.bias:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.up_convs.0.0.bn.bias:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.up_convs.0.0.bn.bias:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.up_convs.1.0.conv.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.up_convs.1.0.conv.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.up_convs.1.0.conv.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.up_convs.1.0.bn.weight:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.up_convs.1.0.bn.weight:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.up_convs.1.0.bn.weight:lr_mult=10.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.up_convs.1.0.bn.bias:lr=1.0
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.up_convs.1.0.bn.bias:weight_decay=0.001
12/26 13:02:03 - mmengine - INFO - paramwise_options -- auxiliary_head.2.up_convs.1.0.bn.bias:lr_mult=10.0
12/26 13:02:04 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: pretrain/vit_large_p16.pth
Resize the pos_embed shape from torch.Size([1, 577, 1024]) to torch.Size([1, 1025, 1024])
The model and loaded state dict do not match exactly

unexpected key in source state_dict: ln1.bias, ln1.weight, patch_embed.projection.bias

12/26 13:02:18 - mmengine - WARNING - "FileClient" will be deprecated in future. Please use io functions in https://mmengine.readthedocs.io/en/latest/api/fileio.html#file-io
12/26 13:02:18 - mmengine - WARNING - "HardDiskBackend" is the alias of "LocalBackend" and the former will be deprecated in future.
12/26 13:02:18 - mmengine - INFO - Checkpoints will be saved to /home/s1952889/final-project/implementation/mmsegmentation/work_dirs/setr_vit-l_pup_8xb2-160k_cbis-ddsm-binary-512x512/20231226_130135.
12/26 13:03:05 - mmengine - INFO - Iter(train) [    50/160000]  base_lr: 9.9972e-02 lr: 9.9972e-02  eta: 1 day, 17:20:52  time: 0.8982  data_time: 0.0088  memory: 23299  loss: 0.7239  decode.loss_ce: 0.6861  decode.acc_seg: 53.2211  aux_0.loss_ce: 0.0126  aux_0.acc_seg: 99.1174  aux_1.loss_ce: 0.0124  aux_1.acc_seg: 99.1174  aux_2.loss_ce: 0.0128  aux_2.acc_seg: 99.1174
12/26 13:03:50 - mmengine - INFO - Iter(train) [   100/160000]  base_lr: 9.9944e-02 lr: 9.9944e-02  eta: 1 day, 16:39:44  time: 0.9016  data_time: 0.0088  memory: 22588  loss: 0.7320  decode.loss_ce: 0.6886  decode.acc_seg: 35.4391  aux_0.loss_ce: 0.0141  aux_0.acc_seg: 99.2259  aux_1.loss_ce: 0.0144  aux_1.acc_seg: 99.2259  aux_2.loss_ce: 0.0149  aux_2.acc_seg: 99.2259
12/26 13:04:35 - mmengine - INFO - Iter(train) [   150/160000]  base_lr: 9.9916e-02 lr: 9.9916e-02  eta: 1 day, 16:28:10  time: 0.9042  data_time: 0.0082  memory: 22588  loss: 0.7276  decode.loss_ce: 0.6885  decode.acc_seg: 98.6867  aux_0.loss_ce: 0.0130  aux_0.acc_seg: 99.6505  aux_1.loss_ce: 0.0130  aux_1.acc_seg: 99.6505  aux_2.loss_ce: 0.0131  aux_2.acc_seg: 99.6505
12/26 13:05:20 - mmengine - INFO - Iter(train) [   200/160000]  base_lr: 9.9888e-02 lr: 9.9888e-02  eta: 1 day, 16:22:47  time: 0.9044  data_time: 0.0081  memory: 22588  loss: 0.6949  decode.loss_ce: 0.6561  decode.acc_seg: 44.6998  aux_0.loss_ce: 0.0130  aux_0.acc_seg: 97.1127  aux_1.loss_ce: 0.0129  aux_1.acc_seg: 97.1127  aux_2.loss_ce: 0.0129  aux_2.acc_seg: 97.1127
12/26 13:06:05 - mmengine - INFO - Iter(train) [   250/160000]  base_lr: 9.9860e-02 lr: 9.9860e-02  eta: 1 day, 16:19:27  time: 0.9048  data_time: 0.0080  memory: 22588  loss: 0.8901  decode.loss_ce: 0.8575  decode.acc_seg: 99.7011  aux_0.loss_ce: 0.0109  aux_0.acc_seg: 99.7011  aux_1.loss_ce: 0.0109  aux_1.acc_seg: 99.7011  aux_2.loss_ce: 0.0108  aux_2.acc_seg: 99.7011
12/26 13:06:51 - mmengine - INFO - Iter(train) [   300/160000]  base_lr: 9.9832e-02 lr: 9.9832e-02  eta: 1 day, 16:17:14  time: 0.9052  data_time: 0.0080  memory: 22588  loss: 0.7949  decode.loss_ce: 0.7640  decode.acc_seg: 98.3518  aux_0.loss_ce: 0.0103  aux_0.acc_seg: 98.3518  aux_1.loss_ce: 0.0103  aux_1.acc_seg: 98.3518  aux_2.loss_ce: 0.0103  aux_2.acc_seg: 98.3518
12/26 13:07:36 - mmengine - INFO - Iter(train) [   350/160000]  base_lr: 9.9804e-02 lr: 9.9804e-02  eta: 1 day, 16:15:19  time: 0.9040  data_time: 0.0080  memory: 22588  loss: 0.6492  decode.loss_ce: 0.6131  decode.acc_seg: 52.7470  aux_0.loss_ce: 0.0120  aux_0.acc_seg: 98.8350  aux_1.loss_ce: 0.0120  aux_1.acc_seg: 98.8350  aux_2.loss_ce: 0.0120  aux_2.acc_seg: 98.8350
12/26 13:08:21 - mmengine - INFO - Iter(train) [   400/160000]  base_lr: 9.9776e-02 lr: 9.9776e-02  eta: 1 day, 16:13:37  time: 0.9052  data_time: 0.0080  memory: 22588  loss: 0.9207  decode.loss_ce: 0.8766  decode.acc_seg: 97.4751  aux_0.loss_ce: 0.0147  aux_0.acc_seg: 97.4751  aux_1.loss_ce: 0.0147  aux_1.acc_seg: 97.4751  aux_2.loss_ce: 0.0147  aux_2.acc_seg: 97.4751
12/26 13:09:06 - mmengine - INFO - Iter(train) [   450/160000]  base_lr: 9.9748e-02 lr: 9.9748e-02  eta: 1 day, 16:11:49  time: 0.9018  data_time: 0.0080  memory: 22588  loss: 0.8832  decode.loss_ce: 0.8497  decode.acc_seg: 99.3895  aux_0.loss_ce: 0.0111  aux_0.acc_seg: 99.3895  aux_1.loss_ce: 0.0112  aux_1.acc_seg: 99.3895  aux_2.loss_ce: 0.0112  aux_2.acc_seg: 99.3895
12/26 13:09:51 - mmengine - INFO - Iter(train) [   500/160000]  base_lr: 9.9720e-02 lr: 9.9720e-02  eta: 1 day, 16:09:15  time: 0.8994  data_time: 0.0080  memory: 22588  loss: 1.1115  decode.loss_ce: 1.0732  decode.acc_seg: 99.3732  aux_0.loss_ce: 0.0128  aux_0.acc_seg: 99.3732  aux_1.loss_ce: 0.0127  aux_1.acc_seg: 99.3732  aux_2.loss_ce: 0.0127  aux_2.acc_seg: 99.3732
12/26 13:10:36 - mmengine - INFO - Iter(train) [   550/160000]  base_lr: 9.9691e-02 lr: 9.9691e-02  eta: 1 day, 16:06:46  time: 0.8987  data_time: 0.0080  memory: 22588  loss: 1.0054  decode.loss_ce: 0.9501  decode.acc_seg: 3.1880  aux_0.loss_ce: 0.0184  aux_0.acc_seg: 96.8120  aux_1.loss_ce: 0.0184  aux_1.acc_seg: 96.8120  aux_2.loss_ce: 0.0184  aux_2.acc_seg: 96.8120
12/26 13:10:39 - mmengine - INFO - Exp name: setr_vit-l_pup_8xb2-160k_cbis-ddsm-binary-512x512_20231226_130135
12/26 13:11:21 - mmengine - INFO - Iter(train) [   600/160000]  base_lr: 9.9663e-02 lr: 9.9663e-02  eta: 1 day, 16:04:33  time: 0.8995  data_time: 0.0081  memory: 22588  loss: 0.7873  decode.loss_ce: 0.7528  decode.acc_seg: 98.7934  aux_0.loss_ce: 0.0115  aux_0.acc_seg: 98.7934  aux_1.loss_ce: 0.0115  aux_1.acc_seg: 98.7934  aux_2.loss_ce: 0.0115  aux_2.acc_seg: 98.7934
12/26 13:12:06 - mmengine - INFO - Iter(train) [   650/160000]  base_lr: 9.9635e-02 lr: 9.9635e-02  eta: 1 day, 16:02:35  time: 0.8987  data_time: 0.0079  memory: 22588  loss: 0.7166  decode.loss_ce: 0.6694  decode.acc_seg: 97.0243  aux_0.loss_ce: 0.0159  aux_0.acc_seg: 97.0243  aux_1.loss_ce: 0.0157  aux_1.acc_seg: 97.0243  aux_2.loss_ce: 0.0156  aux_2.acc_seg: 97.0243
