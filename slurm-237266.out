/bin/bash: /home/s1952889/miniconda3/envs/prompt/lib/libtinfo.so.6: no version information available (required by /bin/bash)
An exception occurred in telemetry logging.Disabling telemetry to prevent further exceptions.
Traceback (most recent call last):
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.11/site-packages/iopath/common/file_io.py", line 946, in __log_tmetry_keys
    handler.log_event()
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.11/site-packages/iopath/common/event_logger.py", line 97, in log_event
    del self._evt
        ^^^^^^^^^
AttributeError: 'NativePathHandler' object has no attribute '_evt'
Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/25 22:01:51 visual_prompt]: Rank of current process: 0. World size: 1
[09/25 22:01:52 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/25 22:01:52 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/25 22:01:52 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/25 22:01:52 visual_prompt]: Training with config:
[09/25 22:01:52 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr50.0_wd0.01/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.01, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 50.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/25 22:01:52 visual_prompt]: Loading training data...
2023-09-25 22:01:52.252728: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-09-25 22:01:52.300898: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-09-25 22:01:53.663819: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[09/25 22:01:56 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/25 22:01:58 visual_prompt]: Number of images: 800
[09/25 22:01:58 visual_prompt]: Number of classes: 2 / 2
[09/25 22:01:58 visual_prompt]: Loading validation data...
[09/25 22:01:58 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/25 22:01:58 visual_prompt]: Number of images: 200
[09/25 22:01:58 visual_prompt]: Number of classes: 2 / 2
[09/25 22:01:58 visual_prompt]: Constructing models...
[09/25 22:02:01 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/25 22:02:01 visual_prompt]: tuned percent:0.536
[09/25 22:02:03 visual_prompt]: Device used for model: 0
[09/25 22:02:03 visual_prompt]: Setting up Evaluator...
[09/25 22:02:03 visual_prompt]: Setting up Trainer...
[09/25 22:02:03 visual_prompt]: 	Setting up the optimizer...
[09/25 22:02:03 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/25 22:02:13 visual_prompt]: Epoch 1 / 100: avg data time: 1.81e-01, avg batch time: 0.7999, average train loss: 1.9653
[09/25 22:02:15 visual_prompt]: Inference (val):avg data time: 1.94e-05, avg batch time: 0.1647, average loss: 2.0033
[09/25 22:02:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/25 22:02:15 visual_prompt]: Best epoch 1: best metric: 0.520
[09/25 22:02:15 visual_prompt]: Training 2 / 100 epoch, with learning rate 5.0
[09/25 22:02:21 visual_prompt]: Epoch 2 / 100: avg data time: 3.43e-02, avg batch time: 0.4729, average train loss: 33.0201
[09/25 22:02:22 visual_prompt]: Inference (val):avg data time: 2.07e-05, avg batch time: 0.1651, average loss: 45.3548
[09/25 22:02:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 47.21	
[09/25 22:02:22 visual_prompt]: Training 3 / 100 epoch, with learning rate 10.0
[09/25 22:02:29 visual_prompt]: Epoch 3 / 100: avg data time: 5.32e-02, avg batch time: 0.4874, average train loss: 29.5369
[09/25 22:02:30 visual_prompt]: Inference (val):avg data time: 1.60e-05, avg batch time: 0.1651, average loss: 29.8019
[09/25 22:02:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 53.78	
[09/25 22:02:30 visual_prompt]: Training 4 / 100 epoch, with learning rate 15.0
[09/25 22:02:36 visual_prompt]: Epoch 4 / 100: avg data time: 4.64e-02, avg batch time: 0.4831, average train loss: 31.7584
[09/25 22:02:38 visual_prompt]: Inference (val):avg data time: 1.76e-05, avg batch time: 0.1648, average loss: 46.4565
[09/25 22:02:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 53.55	
[09/25 22:02:38 visual_prompt]: Training 5 / 100 epoch, with learning rate 20.0
[09/25 22:02:44 visual_prompt]: Epoch 5 / 100: avg data time: 4.20e-02, avg batch time: 0.4776, average train loss: 39.9089
[09/25 22:02:45 visual_prompt]: Inference (val):avg data time: 1.94e-05, avg batch time: 0.1653, average loss: 64.6772
[09/25 22:02:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 47.50	rocauc: 62.13	
[09/25 22:02:45 visual_prompt]: Training 6 / 100 epoch, with learning rate 25.0
[09/25 22:02:52 visual_prompt]: Epoch 6 / 100: avg data time: 4.13e-02, avg batch time: 0.4772, average train loss: 42.6104
[09/25 22:02:53 visual_prompt]: Inference (val):avg data time: 2.04e-05, avg batch time: 0.1654, average loss: 25.3355
[09/25 22:02:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 61.20	
[09/25 22:02:53 visual_prompt]: Training 7 / 100 epoch, with learning rate 30.0
[09/25 22:02:59 visual_prompt]: Epoch 7 / 100: avg data time: 4.84e-02, avg batch time: 0.4859, average train loss: 50.4423
[09/25 22:03:01 visual_prompt]: Inference (val):avg data time: 1.87e-05, avg batch time: 0.1657, average loss: 72.2846
[09/25 22:03:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 19.84	
[09/25 22:03:01 visual_prompt]: Training 8 / 100 epoch, with learning rate 35.0
[09/25 22:03:07 visual_prompt]: Epoch 8 / 100: avg data time: 4.37e-02, avg batch time: 0.4804, average train loss: 59.5970
[09/25 22:03:09 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1662, average loss: 83.2755
[09/25 22:03:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 47.67	
[09/25 22:03:09 visual_prompt]: Training 9 / 100 epoch, with learning rate 40.0
[09/25 22:03:15 visual_prompt]: Epoch 9 / 100: avg data time: 4.58e-02, avg batch time: 0.4818, average train loss: 79.5350
[09/25 22:03:16 visual_prompt]: Inference (val):avg data time: 1.69e-05, avg batch time: 0.1664, average loss: 136.3011
[09/25 22:03:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 35.07	
[09/25 22:03:16 visual_prompt]: Training 10 / 100 epoch, with learning rate 45.0
[09/25 22:03:23 visual_prompt]: Epoch 10 / 100: avg data time: 4.20e-02, avg batch time: 0.4795, average train loss: 110.7156
[09/25 22:03:24 visual_prompt]: Inference (val):avg data time: 3.07e-05, avg batch time: 0.1665, average loss: 79.0366
[09/25 22:03:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 70.91	
[09/25 22:03:24 visual_prompt]: Training 11 / 100 epoch, with learning rate 50.0
[09/25 22:03:31 visual_prompt]: Epoch 11 / 100: avg data time: 4.81e-02, avg batch time: 0.4851, average train loss: 177.6049
[09/25 22:03:32 visual_prompt]: Inference (val):avg data time: 1.66e-05, avg batch time: 0.1661, average loss: 221.1240
[09/25 22:03:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 42.45	
[09/25 22:03:32 visual_prompt]: Training 12 / 100 epoch, with learning rate 49.9847706754774
[09/25 22:03:38 visual_prompt]: Epoch 12 / 100: avg data time: 5.55e-02, avg batch time: 0.4930, average train loss: 192.7431
[09/25 22:03:40 visual_prompt]: Inference (val):avg data time: 4.11e-05, avg batch time: 0.1660, average loss: 74.3682
[09/25 22:03:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 24.43	
[09/25 22:03:40 visual_prompt]: Training 13 / 100 epoch, with learning rate 49.939101256495604
[09/25 22:03:46 visual_prompt]: Epoch 13 / 100: avg data time: 3.41e-02, avg batch time: 0.4720, average train loss: 162.4277
[09/25 22:03:47 visual_prompt]: Inference (val):avg data time: 1.90e-05, avg batch time: 0.1665, average loss: 131.1116
[09/25 22:03:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 33.78	
[09/25 22:03:47 visual_prompt]: Training 14 / 100 epoch, with learning rate 49.86304738420683
[09/25 22:03:54 visual_prompt]: Epoch 14 / 100: avg data time: 3.95e-02, avg batch time: 0.4771, average train loss: 126.5209
[09/25 22:03:55 visual_prompt]: Inference (val):avg data time: 1.85e-05, avg batch time: 0.1664, average loss: 308.3372
[09/25 22:03:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 45.92	
[09/25 22:03:55 visual_prompt]: Training 15 / 100 epoch, with learning rate 49.75670171853926
[09/25 22:04:02 visual_prompt]: Epoch 15 / 100: avg data time: 4.81e-02, avg batch time: 0.4853, average train loss: 147.8655
[09/25 22:04:03 visual_prompt]: Inference (val):avg data time: 1.75e-05, avg batch time: 0.1669, average loss: 97.4015
[09/25 22:04:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 57.37	
[09/25 22:04:03 visual_prompt]: Training 16 / 100 epoch, with learning rate 49.6201938253052
[09/25 22:04:09 visual_prompt]: Epoch 16 / 100: avg data time: 3.19e-02, avg batch time: 0.4769, average train loss: 169.5751
[09/25 22:04:10 visual_prompt]: Inference (val):avg data time: 1.56e-05, avg batch time: 0.1668, average loss: 117.2402
[09/25 22:04:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 48.39	
[09/25 22:04:10 visual_prompt]: Training 17 / 100 epoch, with learning rate 49.45369001834514
[09/25 22:04:17 visual_prompt]: Epoch 17 / 100: avg data time: 4.24e-02, avg batch time: 0.4817, average train loss: 119.7937
[09/25 22:04:18 visual_prompt]: Inference (val):avg data time: 2.01e-05, avg batch time: 0.1668, average loss: 133.0857
[09/25 22:04:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 11.98	
[09/25 22:04:18 visual_prompt]: Training 18 / 100 epoch, with learning rate 49.25739315689991
[09/25 22:04:25 visual_prompt]: Epoch 18 / 100: avg data time: 3.94e-02, avg batch time: 0.4775, average train loss: 131.1162
[09/25 22:04:26 visual_prompt]: Inference (val):avg data time: 1.65e-05, avg batch time: 0.1672, average loss: 52.1724
[09/25 22:04:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 46.50	rocauc: 48.90	
[09/25 22:04:26 visual_prompt]: Training 19 / 100 epoch, with learning rate 49.03154239845797
[09/25 22:04:32 visual_prompt]: Epoch 19 / 100: avg data time: 4.82e-02, avg batch time: 0.4862, average train loss: 120.2983
[09/25 22:04:34 visual_prompt]: Inference (val):avg data time: 1.68e-05, avg batch time: 0.1668, average loss: 355.5621
[09/25 22:04:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 48.09	
[09/25 22:04:34 visual_prompt]: Training 20 / 100 epoch, with learning rate 48.77641290737884
[09/25 22:04:40 visual_prompt]: Epoch 20 / 100: avg data time: 3.94e-02, avg batch time: 0.4786, average train loss: 166.2549
[09/25 22:04:41 visual_prompt]: Inference (val):avg data time: 1.88e-05, avg batch time: 0.1673, average loss: 260.1429
[09/25 22:04:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.66	
[09/25 22:04:41 visual_prompt]: Training 21 / 100 epoch, with learning rate 48.49231551964771
[09/25 22:04:48 visual_prompt]: Epoch 21 / 100: avg data time: 3.54e-02, avg batch time: 0.4758, average train loss: 114.6918
[09/25 22:04:49 visual_prompt]: Inference (val):avg data time: 1.79e-05, avg batch time: 0.1669, average loss: 97.0656
[09/25 22:04:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 44.19	
[09/25 22:04:49 visual_prompt]: Training 22 / 100 epoch, with learning rate 48.17959636416968
[09/25 22:04:56 visual_prompt]: Epoch 22 / 100: avg data time: 5.12e-02, avg batch time: 0.4892, average train loss: 137.5802
[09/25 22:04:57 visual_prompt]: Inference (val):avg data time: 1.81e-05, avg batch time: 0.1669, average loss: 174.4688
[09/25 22:04:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 59.05	
[09/25 22:04:57 visual_prompt]: Training 23 / 100 epoch, with learning rate 47.83863644106502
[09/25 22:05:03 visual_prompt]: Epoch 23 / 100: avg data time: 4.08e-02, avg batch time: 0.4817, average train loss: 93.6597
[09/25 22:05:05 visual_prompt]: Inference (val):avg data time: 1.72e-05, avg batch time: 0.1670, average loss: 2.2239
[09/25 22:05:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 46.02	
[09/25 22:05:05 visual_prompt]: Training 24 / 100 epoch, with learning rate 47.46985115747918
[09/25 22:05:11 visual_prompt]: Epoch 24 / 100: avg data time: 4.78e-02, avg batch time: 0.4867, average train loss: 98.1542
[09/25 22:05:13 visual_prompt]: Inference (val):avg data time: 1.84e-05, avg batch time: 0.1672, average loss: 202.0480
[09/25 22:05:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 29.46	
[09/25 22:05:13 visual_prompt]: Training 25 / 100 epoch, with learning rate 47.073689821473174
[09/25 22:05:19 visual_prompt]: Epoch 25 / 100: avg data time: 3.38e-02, avg batch time: 0.4774, average train loss: 78.7443
[09/25 22:05:20 visual_prompt]: Inference (val):avg data time: 1.66e-05, avg batch time: 0.1673, average loss: 41.3350
[09/25 22:05:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 24.54	
[09/25 22:05:20 visual_prompt]: Training 26 / 100 epoch, with learning rate 46.65063509461097
[09/25 22:05:27 visual_prompt]: Epoch 26 / 100: avg data time: 4.09e-02, avg batch time: 0.4829, average train loss: 71.8963
[09/25 22:05:28 visual_prompt]: Inference (val):avg data time: 1.79e-05, avg batch time: 0.1673, average loss: 102.5682
[09/25 22:05:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 75.64	
[09/25 22:05:28 visual_prompt]: Training 27 / 100 epoch, with learning rate 46.20120240391065
[09/25 22:05:34 visual_prompt]: Epoch 27 / 100: avg data time: 3.71e-02, avg batch time: 0.4784, average train loss: 153.9674
[09/25 22:05:36 visual_prompt]: Inference (val):avg data time: 1.75e-05, avg batch time: 0.1673, average loss: 51.9205
[09/25 22:05:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 25.50	rocauc: 23.12	
[09/25 22:05:36 visual_prompt]: Training 28 / 100 epoch, with learning rate 45.72593931387604
[09/25 22:05:42 visual_prompt]: Epoch 28 / 100: avg data time: 3.83e-02, avg batch time: 0.4801, average train loss: 131.6242
[09/25 22:05:43 visual_prompt]: Inference (val):avg data time: 1.82e-05, avg batch time: 0.1671, average loss: 42.2096
[09/25 22:05:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 49.84	
[09/25 22:05:43 visual_prompt]: Training 29 / 100 epoch, with learning rate 45.22542485937369
[09/25 22:05:50 visual_prompt]: Epoch 29 / 100: avg data time: 3.88e-02, avg batch time: 0.4783, average train loss: 110.2952
[09/25 22:05:51 visual_prompt]: Inference (val):avg data time: 1.96e-05, avg batch time: 0.1677, average loss: 107.8613
[09/25 22:05:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 39.97	
[09/25 22:05:51 visual_prompt]: Training 30 / 100 epoch, with learning rate 44.70026884016804
[09/25 22:05:58 visual_prompt]: Epoch 30 / 100: avg data time: 4.11e-02, avg batch time: 0.4803, average train loss: 110.6063
[09/25 22:05:59 visual_prompt]: Inference (val):avg data time: 1.86e-05, avg batch time: 0.1674, average loss: 168.1019
[09/25 22:05:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 86.13	
[09/25 22:05:59 visual_prompt]: Training 31 / 100 epoch, with learning rate 44.15111107797445
[09/25 22:06:05 visual_prompt]: Epoch 31 / 100: avg data time: 4.32e-02, avg batch time: 0.4837, average train loss: 83.6762
[09/25 22:06:07 visual_prompt]: Inference (val):avg data time: 1.77e-05, avg batch time: 0.1670, average loss: 91.8510
[09/25 22:06:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 26.85	
[09/25 22:06:07 visual_prompt]: Training 32 / 100 epoch, with learning rate 43.57862063693486
[09/25 22:06:13 visual_prompt]: Epoch 32 / 100: avg data time: 3.75e-02, avg batch time: 0.4784, average train loss: 96.6863
[09/25 22:06:14 visual_prompt]: Inference (val):avg data time: 1.65e-05, avg batch time: 0.1673, average loss: 448.5538
[09/25 22:06:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 50.42	
[09/25 22:06:14 visual_prompt]: Training 33 / 100 epoch, with learning rate 42.98349500846628
[09/25 22:06:21 visual_prompt]: Epoch 33 / 100: avg data time: 5.14e-02, avg batch time: 0.4921, average train loss: 158.4254
[09/25 22:06:22 visual_prompt]: Inference (val):avg data time: 1.57e-05, avg batch time: 0.1674, average loss: 133.7494
[09/25 22:06:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 44.70	
[09/25 22:06:22 visual_prompt]: Training 34 / 100 epoch, with learning rate 42.36645926147493
[09/25 22:06:29 visual_prompt]: Epoch 34 / 100: avg data time: 3.45e-02, avg batch time: 0.4762, average train loss: 145.7050
[09/25 22:06:30 visual_prompt]: Inference (val):avg data time: 1.66e-05, avg batch time: 0.1674, average loss: 61.3030
[09/25 22:06:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 81.68	
[09/25 22:06:30 visual_prompt]: Training 35 / 100 epoch, with learning rate 41.72826515897145
[09/25 22:06:36 visual_prompt]: Epoch 35 / 100: avg data time: 4.14e-02, avg batch time: 0.4797, average train loss: 152.1743
[09/25 22:06:37 visual_prompt]: Inference (val):avg data time: 1.91e-05, avg batch time: 0.1675, average loss: 69.1567
[09/25 22:06:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 42.50	
[09/25 22:06:37 visual_prompt]: Training 36 / 100 epoch, with learning rate 41.06969024216348
[09/25 22:06:44 visual_prompt]: Epoch 36 / 100: avg data time: 3.76e-02, avg batch time: 0.4807, average train loss: 84.7127
[09/25 22:06:45 visual_prompt]: Inference (val):avg data time: 1.56e-05, avg batch time: 0.1672, average loss: 6.6380
[09/25 22:06:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 36.48	
[09/25 22:06:45 visual_prompt]: Training 37 / 100 epoch, with learning rate 40.391536883141455
[09/25 22:06:52 visual_prompt]: Epoch 37 / 100: avg data time: 3.86e-02, avg batch time: 0.4789, average train loss: 102.8559
[09/25 22:06:53 visual_prompt]: Inference (val):avg data time: 1.91e-05, avg batch time: 0.1672, average loss: 51.6322
[09/25 22:06:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 60.97	
[09/25 22:06:53 visual_prompt]: Training 38 / 100 epoch, with learning rate 39.69463130731183
[09/25 22:06:59 visual_prompt]: Epoch 38 / 100: avg data time: 3.40e-02, avg batch time: 0.4779, average train loss: 146.0694
[09/25 22:07:01 visual_prompt]: Inference (val):avg data time: 2.09e-05, avg batch time: 0.1674, average loss: 45.0278
[09/25 22:07:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 70.40	
[09/25 22:07:01 visual_prompt]: Training 39 / 100 epoch, with learning rate 38.97982258676867
[09/25 22:07:07 visual_prompt]: Epoch 39 / 100: avg data time: 4.59e-02, avg batch time: 0.4853, average train loss: 113.0581
[09/25 22:07:08 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.1674, average loss: 64.3991
[09/25 22:07:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 44.50	rocauc: 51.26	
[09/25 22:07:08 visual_prompt]: Training 40 / 100 epoch, with learning rate 38.24798160583012
[09/25 22:07:15 visual_prompt]: Epoch 40 / 100: avg data time: 3.97e-02, avg batch time: 0.4814, average train loss: 150.6506
[09/25 22:07:16 visual_prompt]: Inference (val):avg data time: 2.08e-05, avg batch time: 0.1680, average loss: 17.8301
[09/25 22:07:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.50	rocauc: 48.55	
[09/25 22:07:16 visual_prompt]: Training 41 / 100 epoch, with learning rate 37.5
[09/25 22:07:23 visual_prompt]: Epoch 41 / 100: avg data time: 4.47e-02, avg batch time: 0.4858, average train loss: 148.7042
[09/25 22:07:24 visual_prompt]: Inference (val):avg data time: 2.17e-05, avg batch time: 0.1676, average loss: 157.3961
[09/25 22:07:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 57.85	
[09/25 22:07:24 visual_prompt]: Training 42 / 100 epoch, with learning rate 36.736789069647266
[09/25 22:07:30 visual_prompt]: Epoch 42 / 100: avg data time: 4.54e-02, avg batch time: 0.4854, average train loss: 94.6067
[09/25 22:07:32 visual_prompt]: Inference (val):avg data time: 1.97e-05, avg batch time: 0.1678, average loss: 75.1843
[09/25 22:07:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 69.05	
[09/25 22:07:32 visual_prompt]: Training 43 / 100 epoch, with learning rate 35.959278669726935
[09/25 22:07:38 visual_prompt]: Epoch 43 / 100: avg data time: 3.28e-02, avg batch time: 0.4744, average train loss: 87.3769
[09/25 22:07:39 visual_prompt]: Inference (val):avg data time: 1.94e-05, avg batch time: 0.1675, average loss: 279.1096
[09/25 22:07:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 52.93	
[09/25 22:07:39 visual_prompt]: Training 44 / 100 epoch, with learning rate 35.16841607689501
[09/25 22:07:46 visual_prompt]: Epoch 44 / 100: avg data time: 3.46e-02, avg batch time: 0.4764, average train loss: 117.5986
[09/25 22:07:47 visual_prompt]: Inference (val):avg data time: 2.08e-05, avg batch time: 0.1676, average loss: 39.4990
[09/25 22:07:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 53.63	
[09/25 22:07:47 visual_prompt]: Training 45 / 100 epoch, with learning rate 34.365164835397806
[09/25 22:07:53 visual_prompt]: Epoch 45 / 100: avg data time: 3.33e-02, avg batch time: 0.4780, average train loss: 79.7239
[09/25 22:07:55 visual_prompt]: Inference (val):avg data time: 1.99e-05, avg batch time: 0.1677, average loss: 73.1743
[09/25 22:07:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 36.00	rocauc: 39.25	
[09/25 22:07:55 visual_prompt]: Training 46 / 100 epoch, with learning rate 33.55050358314172
[09/25 22:08:01 visual_prompt]: Epoch 46 / 100: avg data time: 3.63e-02, avg batch time: 0.4770, average train loss: 73.2388
[09/25 22:08:02 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1683, average loss: 72.7124
[09/25 22:08:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 29.69	
[09/25 22:08:02 visual_prompt]: Training 47 / 100 epoch, with learning rate 32.72542485937369
[09/25 22:08:09 visual_prompt]: Epoch 47 / 100: avg data time: 3.67e-02, avg batch time: 0.4786, average train loss: 74.7006
[09/25 22:08:10 visual_prompt]: Inference (val):avg data time: 2.01e-05, avg batch time: 0.1674, average loss: 127.4007
[09/25 22:08:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 18.04	
[09/25 22:08:10 visual_prompt]: Training 48 / 100 epoch, with learning rate 31.89093389542498
[09/25 22:08:17 visual_prompt]: Epoch 48 / 100: avg data time: 5.13e-02, avg batch time: 0.4913, average train loss: 71.5693
[09/25 22:08:18 visual_prompt]: Inference (val):avg data time: 1.81e-05, avg batch time: 0.1680, average loss: 19.4655
[09/25 22:08:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 33.63	
[09/25 22:08:18 visual_prompt]: Training 49 / 100 epoch, with learning rate 31.04804738999169
[09/25 22:08:25 visual_prompt]: Epoch 49 / 100: avg data time: 3.85e-02, avg batch time: 0.4799, average train loss: 41.0649
[09/25 22:08:26 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.1676, average loss: 44.2930
[09/25 22:08:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 60.17	
[09/25 22:08:26 visual_prompt]: Training 50 / 100 epoch, with learning rate 30.19779227044398
[09/25 22:08:32 visual_prompt]: Epoch 50 / 100: avg data time: 4.06e-02, avg batch time: 0.4811, average train loss: 69.5146
[09/25 22:08:34 visual_prompt]: Inference (val):avg data time: 1.98e-05, avg batch time: 0.1673, average loss: 13.1983
[09/25 22:08:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 76.49	
[09/25 22:08:34 visual_prompt]: Training 51 / 100 epoch, with learning rate 29.341204441673263
[09/25 22:08:40 visual_prompt]: Epoch 51 / 100: avg data time: 5.25e-02, avg batch time: 0.4940, average train loss: 57.5313
[09/25 22:08:42 visual_prompt]: Inference (val):avg data time: 1.84e-05, avg batch time: 0.1678, average loss: 42.0738
[09/25 22:08:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 64.49	
[09/25 22:08:42 visual_prompt]: Training 52 / 100 epoch, with learning rate 28.479327524001636
[09/25 22:08:48 visual_prompt]: Epoch 52 / 100: avg data time: 3.41e-02, avg batch time: 0.4759, average train loss: 42.2783
[09/25 22:08:49 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1677, average loss: 37.4230
[09/25 22:08:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 49.96	
[09/25 22:08:49 visual_prompt]: Training 53 / 100 epoch, with learning rate 27.61321158169134
[09/25 22:08:56 visual_prompt]: Epoch 53 / 100: avg data time: 3.38e-02, avg batch time: 0.4765, average train loss: 68.5516
[09/25 22:08:57 visual_prompt]: Inference (val):avg data time: 2.20e-05, avg batch time: 0.1678, average loss: 31.1298
[09/25 22:08:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 65.05	
[09/25 22:08:57 visual_prompt]: Training 54 / 100 epoch, with learning rate 26.74391184360313
[09/25 22:09:03 visual_prompt]: Epoch 54 / 100: avg data time: 4.22e-02, avg batch time: 0.4854, average train loss: 39.2747
[09/25 22:09:05 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1678, average loss: 213.1730
[09/25 22:09:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 52.40	
[09/25 22:09:05 visual_prompt]: Training 55 / 100 epoch, with learning rate 25.872487417562528
[09/25 22:09:11 visual_prompt]: Epoch 55 / 100: avg data time: 4.71e-02, avg batch time: 0.4892, average train loss: 91.3255
[09/25 22:09:12 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1674, average loss: 192.9333
[09/25 22:09:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 24.00	
[09/25 22:09:13 visual_prompt]: Training 56 / 100 epoch, with learning rate 25.0
[09/25 22:09:19 visual_prompt]: Epoch 56 / 100: avg data time: 4.85e-02, avg batch time: 0.4898, average train loss: 68.8853
[09/25 22:09:20 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1681, average loss: 23.8252
[09/25 22:09:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 26.41	
[09/25 22:09:20 visual_prompt]: Training 57 / 100 epoch, with learning rate 24.127512582437483
[09/25 22:09:27 visual_prompt]: Epoch 57 / 100: avg data time: 4.09e-02, avg batch time: 0.4849, average train loss: 35.2070
[09/25 22:09:28 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1675, average loss: 67.7403
[09/25 22:09:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 69.55	
[09/25 22:09:28 visual_prompt]: Training 58 / 100 epoch, with learning rate 23.256088156396867
[09/25 22:09:35 visual_prompt]: Epoch 58 / 100: avg data time: 3.70e-02, avg batch time: 0.4823, average train loss: 42.9115
[09/25 22:09:36 visual_prompt]: Inference (val):avg data time: 2.23e-05, avg batch time: 0.1683, average loss: 7.0182
[09/25 22:09:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 72.21	
[09/25 22:09:36 visual_prompt]: Training 59 / 100 epoch, with learning rate 22.38678841830867
[09/25 22:09:42 visual_prompt]: Epoch 59 / 100: avg data time: 4.28e-02, avg batch time: 0.4835, average train loss: 69.4814
[09/25 22:09:44 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1678, average loss: 84.7323
[09/25 22:09:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 34.11	
[09/25 22:09:44 visual_prompt]: Training 60 / 100 epoch, with learning rate 21.52067247599837
[09/25 22:09:50 visual_prompt]: Epoch 60 / 100: avg data time: 3.83e-02, avg batch time: 0.4800, average train loss: 83.2675
[09/25 22:09:51 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1679, average loss: 105.8956
[09/25 22:09:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 52.48	
[09/25 22:09:51 visual_prompt]: Training 61 / 100 epoch, with learning rate 20.65879555832674
[09/25 22:09:58 visual_prompt]: Epoch 61 / 100: avg data time: 4.29e-02, avg batch time: 0.4840, average train loss: 90.7616
[09/25 22:09:59 visual_prompt]: Inference (val):avg data time: 2.04e-05, avg batch time: 0.1683, average loss: 92.5440
[09/25 22:09:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.50	rocauc: 53.11	
[09/25 22:09:59 visual_prompt]: Best epoch 61: best metric: 0.525
[09/25 22:09:59 visual_prompt]: Training 62 / 100 epoch, with learning rate 19.80220772955602
[09/25 22:10:05 visual_prompt]: Epoch 62 / 100: avg data time: 4.43e-02, avg batch time: 0.4860, average train loss: 36.9350
[09/25 22:10:07 visual_prompt]: Inference (val):avg data time: 1.96e-05, avg batch time: 0.1678, average loss: 108.4832
[09/25 22:10:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 79.29	
[09/25 22:10:07 visual_prompt]: Training 63 / 100 epoch, with learning rate 18.95195261000831
[09/25 22:10:13 visual_prompt]: Epoch 63 / 100: avg data time: 4.23e-02, avg batch time: 0.4849, average train loss: 63.3491
[09/25 22:10:15 visual_prompt]: Inference (val):avg data time: 1.97e-05, avg batch time: 0.1675, average loss: 27.4505
[09/25 22:10:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 79.49	
[09/25 22:10:15 visual_prompt]: Training 64 / 100 epoch, with learning rate 18.10906610457502
[09/25 22:10:21 visual_prompt]: Epoch 64 / 100: avg data time: 4.76e-02, avg batch time: 0.4886, average train loss: 79.1004
[09/25 22:10:22 visual_prompt]: Inference (val):avg data time: 1.84e-05, avg batch time: 0.1674, average loss: 77.2146
[09/25 22:10:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 70.01	
[09/25 22:10:22 visual_prompt]: Training 65 / 100 epoch, with learning rate 17.274575140626318
[09/25 22:10:29 visual_prompt]: Epoch 65 / 100: avg data time: 3.96e-02, avg batch time: 0.4817, average train loss: 41.7870
[09/25 22:10:30 visual_prompt]: Inference (val):avg data time: 1.97e-05, avg batch time: 0.1678, average loss: 7.9198
[09/25 22:10:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 55.79	
[09/25 22:10:30 visual_prompt]: Training 66 / 100 epoch, with learning rate 16.449496416858285
[09/25 22:10:37 visual_prompt]: Epoch 66 / 100: avg data time: 5.04e-02, avg batch time: 0.4909, average train loss: 73.6844
[09/25 22:10:38 visual_prompt]: Inference (val):avg data time: 1.85e-05, avg batch time: 0.1677, average loss: 160.4176
[09/25 22:10:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 65.02	
[09/25 22:10:38 visual_prompt]: Training 67 / 100 epoch, with learning rate 15.634835164602197
[09/25 22:10:45 visual_prompt]: Epoch 67 / 100: avg data time: 3.71e-02, avg batch time: 0.4800, average train loss: 49.2696
[09/25 22:10:46 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.1675, average loss: 116.4777
[09/25 22:10:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 42.33	
[09/25 22:10:46 visual_prompt]: Training 68 / 100 epoch, with learning rate 14.831583923104999
[09/25 22:10:52 visual_prompt]: Epoch 68 / 100: avg data time: 4.04e-02, avg batch time: 0.4835, average train loss: 39.8756
[09/25 22:10:54 visual_prompt]: Inference (val):avg data time: 1.93e-05, avg batch time: 0.1678, average loss: 24.0501
[09/25 22:10:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 68.94	
[09/25 22:10:54 visual_prompt]: Training 69 / 100 epoch, with learning rate 14.040721330273062
[09/25 22:11:00 visual_prompt]: Epoch 69 / 100: avg data time: 3.18e-02, avg batch time: 0.4754, average train loss: 20.3561
[09/25 22:11:01 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1677, average loss: 29.8435
[09/25 22:11:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 53.11	
[09/25 22:11:01 visual_prompt]: Training 70 / 100 epoch, with learning rate 13.263210930352736
[09/25 22:11:08 visual_prompt]: Epoch 70 / 100: avg data time: 3.60e-02, avg batch time: 0.4811, average train loss: 34.2079
[09/25 22:11:09 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.1677, average loss: 5.8583
[09/25 22:11:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 54.15	
[09/25 22:11:09 visual_prompt]: Training 71 / 100 epoch, with learning rate 12.500000000000005
[09/25 22:11:16 visual_prompt]: Epoch 71 / 100: avg data time: 3.89e-02, avg batch time: 0.4832, average train loss: 32.3754
[09/25 22:11:17 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.1676, average loss: 18.1296
[09/25 22:11:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 38.30	
[09/25 22:11:17 visual_prompt]: Training 72 / 100 epoch, with learning rate 11.75201839416988
[09/25 22:11:23 visual_prompt]: Epoch 72 / 100: avg data time: 3.47e-02, avg batch time: 0.4801, average train loss: 26.5635
[09/25 22:11:25 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.1680, average loss: 3.4284
[09/25 22:11:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 48.74	
[09/25 22:11:25 visual_prompt]: Training 73 / 100 epoch, with learning rate 11.020177413231332
[09/25 22:11:31 visual_prompt]: Epoch 73 / 100: avg data time: 4.11e-02, avg batch time: 0.4853, average train loss: 17.5841
[09/25 22:11:32 visual_prompt]: Inference (val):avg data time: 1.90e-05, avg batch time: 0.1680, average loss: 51.3469
[09/25 22:11:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 72.33	
[09/25 22:11:32 visual_prompt]: Training 74 / 100 epoch, with learning rate 10.305368692688175
[09/25 22:11:39 visual_prompt]: Epoch 74 / 100: avg data time: 4.28e-02, avg batch time: 0.4875, average train loss: 24.8342
[09/25 22:11:40 visual_prompt]: Inference (val):avg data time: 1.95e-05, avg batch time: 0.1677, average loss: 6.8868
[09/25 22:11:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 58.69	
[09/25 22:11:40 visual_prompt]: Training 75 / 100 epoch, with learning rate 9.608463116858543
[09/25 22:11:47 visual_prompt]: Epoch 75 / 100: avg data time: 3.41e-02, avg batch time: 0.4812, average train loss: 19.2704
[09/25 22:11:48 visual_prompt]: Inference (val):avg data time: 1.82e-05, avg batch time: 0.1681, average loss: 27.2394
[09/25 22:11:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 41.38	
[09/25 22:11:48 visual_prompt]: Training 76 / 100 epoch, with learning rate 8.930309757836516
[09/25 22:11:55 visual_prompt]: Epoch 76 / 100: avg data time: 5.06e-02, avg batch time: 0.4946, average train loss: 23.5936
[09/25 22:11:56 visual_prompt]: Inference (val):avg data time: 1.73e-05, avg batch time: 0.1678, average loss: 21.8185
[09/25 22:11:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 48.80	
[09/25 22:11:56 visual_prompt]: Training 77 / 100 epoch, with learning rate 8.271734841028552
[09/25 22:12:02 visual_prompt]: Epoch 77 / 100: avg data time: 4.73e-02, avg batch time: 0.4912, average train loss: 23.9413
[09/25 22:12:04 visual_prompt]: Inference (val):avg data time: 1.95e-05, avg batch time: 0.1680, average loss: 24.2905
[09/25 22:12:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.95	
[09/25 22:12:04 visual_prompt]: Training 78 / 100 epoch, with learning rate 7.633540738525066
[09/25 22:12:10 visual_prompt]: Epoch 78 / 100: avg data time: 4.12e-02, avg batch time: 0.4850, average train loss: 20.0030
[09/25 22:12:11 visual_prompt]: Inference (val):avg data time: 1.75e-05, avg batch time: 0.1681, average loss: 8.2278
[09/25 22:12:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 41.78	
[09/25 22:12:11 visual_prompt]: Training 79 / 100 epoch, with learning rate 7.016504991533726
[09/25 22:12:18 visual_prompt]: Epoch 79 / 100: avg data time: 4.67e-02, avg batch time: 0.4920, average train loss: 12.8134
[09/25 22:12:19 visual_prompt]: Inference (val):avg data time: 1.56e-05, avg batch time: 0.1676, average loss: 19.2699
[09/25 22:12:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 42.33	
[09/25 22:12:19 visual_prompt]: Training 80 / 100 epoch, with learning rate 6.4213793630651415
[09/25 22:12:26 visual_prompt]: Epoch 80 / 100: avg data time: 3.44e-02, avg batch time: 0.4809, average train loss: 12.3143
[09/25 22:12:27 visual_prompt]: Inference (val):avg data time: 1.70e-05, avg batch time: 0.1680, average loss: 11.4115
[09/25 22:12:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 56.08	
[09/25 22:12:27 visual_prompt]: Training 81 / 100 epoch, with learning rate 5.848888922025552
[09/25 22:12:34 visual_prompt]: Epoch 81 / 100: avg data time: 4.17e-02, avg batch time: 0.4878, average train loss: 13.8996
[09/25 22:12:35 visual_prompt]: Inference (val):avg data time: 2.07e-05, avg batch time: 0.1677, average loss: 7.2834
[09/25 22:12:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 49.76	
[09/25 22:12:35 visual_prompt]: Training 82 / 100 epoch, with learning rate 5.2997311598319525
[09/25 22:12:41 visual_prompt]: Epoch 82 / 100: avg data time: 4.52e-02, avg batch time: 0.4899, average train loss: 10.6354
[09/25 22:12:43 visual_prompt]: Inference (val):avg data time: 1.93e-05, avg batch time: 0.1678, average loss: 22.5546
[09/25 22:12:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 25.01	
[09/25 22:12:43 visual_prompt]: Training 83 / 100 epoch, with learning rate 4.774575140626316
[09/25 22:12:49 visual_prompt]: Epoch 83 / 100: avg data time: 4.14e-02, avg batch time: 0.4862, average train loss: 15.1791
[09/25 22:12:50 visual_prompt]: Inference (val):avg data time: 1.76e-05, avg batch time: 0.1677, average loss: 10.8263
[09/25 22:12:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 47.19	
[09/25 22:12:50 visual_prompt]: Training 84 / 100 epoch, with learning rate 4.27406068612396
[09/25 22:12:57 visual_prompt]: Epoch 84 / 100: avg data time: 4.91e-02, avg batch time: 0.4928, average train loss: 12.6122
[09/25 22:12:58 visual_prompt]: Inference (val):avg data time: 1.94e-05, avg batch time: 0.1677, average loss: 2.6565
[09/25 22:12:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 51.67	
[09/25 22:12:58 visual_prompt]: Training 85 / 100 epoch, with learning rate 3.798797596089351
[09/25 22:13:05 visual_prompt]: Epoch 85 / 100: avg data time: 3.61e-02, avg batch time: 0.4815, average train loss: 10.4450
[09/25 22:13:06 visual_prompt]: Inference (val):avg data time: 1.94e-05, avg batch time: 0.1677, average loss: 3.6883
[09/25 22:13:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 51.00	rocauc: 30.00	
[09/25 22:13:06 visual_prompt]: Training 86 / 100 epoch, with learning rate 3.349364905389032
[09/25 22:13:12 visual_prompt]: Epoch 86 / 100: avg data time: 3.71e-02, avg batch time: 0.4823, average train loss: 9.0327
[09/25 22:13:14 visual_prompt]: Inference (val):avg data time: 1.88e-05, avg batch time: 0.1678, average loss: 10.1269
[09/25 22:13:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 50.60	
[09/25 22:13:14 visual_prompt]: Training 87 / 100 epoch, with learning rate 2.9263101785268253
[09/25 22:13:20 visual_prompt]: Epoch 87 / 100: avg data time: 4.02e-02, avg batch time: 0.4856, average train loss: 5.3575
[09/25 22:13:22 visual_prompt]: Inference (val):avg data time: 1.70e-05, avg batch time: 0.1678, average loss: 10.2273
[09/25 22:13:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 60.85	
[09/25 22:13:22 visual_prompt]: Training 88 / 100 epoch, with learning rate 2.5301488425208296
[09/25 22:13:28 visual_prompt]: Epoch 88 / 100: avg data time: 4.86e-02, avg batch time: 0.4933, average train loss: 4.7914
[09/25 22:13:29 visual_prompt]: Inference (val):avg data time: 1.82e-05, avg batch time: 0.1675, average loss: 1.8788
[09/25 22:13:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 50.31	
[09/25 22:13:29 visual_prompt]: Training 89 / 100 epoch, with learning rate 2.1613635589349753
[09/25 22:13:36 visual_prompt]: Epoch 89 / 100: avg data time: 4.48e-02, avg batch time: 0.4890, average train loss: 6.0955
[09/25 22:13:37 visual_prompt]: Inference (val):avg data time: 1.89e-05, avg batch time: 0.1678, average loss: 23.7205
[09/25 22:13:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 75.87	
[09/25 22:13:37 visual_prompt]: Training 90 / 100 epoch, with learning rate 1.820403635830317
[09/25 22:13:44 visual_prompt]: Epoch 90 / 100: avg data time: 3.66e-02, avg batch time: 0.4810, average train loss: 7.3461
[09/25 22:13:45 visual_prompt]: Inference (val):avg data time: 1.82e-05, avg batch time: 0.1678, average loss: 2.2692
[09/25 22:13:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 44.63	
[09/25 22:13:45 visual_prompt]: Training 91 / 100 epoch, with learning rate 1.507684480352292
[09/25 22:13:52 visual_prompt]: Epoch 91 / 100: avg data time: 4.68e-02, avg batch time: 0.4928, average train loss: 2.6739
[09/25 22:13:53 visual_prompt]: Inference (val):avg data time: 1.69e-05, avg batch time: 0.1680, average loss: 2.2242
[09/25 22:13:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 63.71	
[09/25 22:13:53 visual_prompt]: Training 92 / 100 epoch, with learning rate 1.2235870926211616
[09/25 22:13:59 visual_prompt]: Epoch 92 / 100: avg data time: 4.23e-02, avg batch time: 0.4869, average train loss: 1.4539
[09/25 22:14:01 visual_prompt]: Inference (val):avg data time: 1.67e-05, avg batch time: 0.1675, average loss: 0.7836
[09/25 22:14:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 18.55	
[09/25 22:14:01 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.9684576015420276
[09/25 22:14:07 visual_prompt]: Epoch 93 / 100: avg data time: 4.59e-02, avg batch time: 0.4904, average train loss: 1.7119
[09/25 22:14:09 visual_prompt]: Inference (val):avg data time: 1.90e-05, avg batch time: 0.1677, average loss: 1.8084
[09/25 22:14:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 71.99	
[09/25 22:14:09 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.7426068431000882
[09/25 22:14:15 visual_prompt]: Epoch 94 / 100: avg data time: 3.97e-02, avg batch time: 0.4856, average train loss: 1.0176
[09/25 22:14:17 visual_prompt]: Inference (val):avg data time: 1.66e-05, avg batch time: 0.1677, average loss: 0.7008
[09/25 22:14:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 47.60	
[09/25 22:14:17 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.5463099816548578
[09/25 22:14:23 visual_prompt]: Epoch 95 / 100: avg data time: 5.07e-02, avg batch time: 0.4953, average train loss: 0.7792
[09/25 22:14:24 visual_prompt]: Inference (val):avg data time: 1.55e-05, avg batch time: 0.1678, average loss: 0.6971
[09/25 22:14:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.05	
[09/25 22:14:24 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.3798061746947995
[09/25 22:14:31 visual_prompt]: Epoch 96 / 100: avg data time: 4.16e-02, avg batch time: 0.4884, average train loss: 0.8041
[09/25 22:14:32 visual_prompt]: Inference (val):avg data time: 1.62e-05, avg batch time: 0.1677, average loss: 0.7703
[09/25 22:14:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.85	
[09/25 22:14:32 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.24329828146074095
[09/25 22:14:39 visual_prompt]: Epoch 97 / 100: avg data time: 3.68e-02, avg batch time: 0.4831, average train loss: 0.7395
[09/25 22:14:40 visual_prompt]: Inference (val):avg data time: 1.86e-05, avg batch time: 0.1676, average loss: 0.7003
[09/25 22:14:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 82.57	
[09/25 22:14:40 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.13695261579316775
[09/25 22:14:47 visual_prompt]: Epoch 98 / 100: avg data time: 4.82e-02, avg batch time: 0.4947, average train loss: 0.7060
[09/25 22:14:48 visual_prompt]: Inference (val):avg data time: 1.90e-05, avg batch time: 0.1678, average loss: 0.6959
[09/25 22:14:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 83.39	
[09/25 22:14:48 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.06089874350439506
[09/25 22:14:55 visual_prompt]: Epoch 99 / 100: avg data time: 4.14e-02, avg batch time: 0.4861, average train loss: 0.6901
[09/25 22:14:56 visual_prompt]: Inference (val):avg data time: 1.96e-05, avg batch time: 0.1677, average loss: 0.6840
[09/25 22:14:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 53.00	rocauc: 86.18	
[09/25 22:14:56 visual_prompt]: Best epoch 99: best metric: 0.530
[09/25 22:14:56 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.015229324522605947
[09/25 22:15:02 visual_prompt]: Epoch 100 / 100: avg data time: 3.54e-02, avg batch time: 0.4828, average train loss: 0.6757
[09/25 22:15:03 visual_prompt]: Inference (val):avg data time: 1.69e-05, avg batch time: 0.1681, average loss: 0.6567
[09/25 22:15:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 64.00	rocauc: 87.36	
[09/25 22:15:03 visual_prompt]: Best epoch 100: best metric: 0.640
[09/25 22:15:03 visual_prompt]: Rank of current process: 0. World size: 1
[09/25 22:15:03 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/25 22:15:03 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/25 22:15:03 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/25 22:15:03 visual_prompt]: Training with config:
[09/25 22:15:03 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr50.0_wd0.001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 50.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/25 22:15:03 visual_prompt]: Loading training data...
[09/25 22:15:03 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/25 22:15:05 visual_prompt]: Number of images: 800
[09/25 22:15:05 visual_prompt]: Number of classes: 2 / 2
[09/25 22:15:05 visual_prompt]: Loading validation data...
[09/25 22:15:05 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/25 22:15:05 visual_prompt]: Number of images: 200
[09/25 22:15:05 visual_prompt]: Number of classes: 2 / 2
[09/25 22:15:05 visual_prompt]: Constructing models...
[09/25 22:15:08 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/25 22:15:08 visual_prompt]: tuned percent:0.536
[09/25 22:15:08 visual_prompt]: Device used for model: 0
[09/25 22:15:08 visual_prompt]: Setting up Evaluator...
[09/25 22:15:08 visual_prompt]: Setting up Trainer...
[09/25 22:15:08 visual_prompt]: 	Setting up the optimizer...
[09/25 22:15:08 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/25 22:15:14 visual_prompt]: Epoch 1 / 100: avg data time: 4.10e-02, avg batch time: 0.4868, average train loss: 1.9657
[09/25 22:15:16 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1672, average loss: 2.0033
[09/25 22:15:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/25 22:15:16 visual_prompt]: Best epoch 1: best metric: 0.520
[09/25 22:15:16 visual_prompt]: Training 2 / 100 epoch, with learning rate 5.0
[09/25 22:15:22 visual_prompt]: Epoch 2 / 100: avg data time: 3.70e-02, avg batch time: 0.4779, average train loss: 37.9881
[09/25 22:15:23 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1676, average loss: 25.0100
[09/25 22:15:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 62.34	
[09/25 22:15:23 visual_prompt]: Training 3 / 100 epoch, with learning rate 10.0
[09/25 22:15:30 visual_prompt]: Epoch 3 / 100: avg data time: 4.47e-02, avg batch time: 0.4875, average train loss: 19.6117
[09/25 22:15:31 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.1669, average loss: 0.7095
[09/25 22:15:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 56.50	rocauc: 73.36	
[09/25 22:15:31 visual_prompt]: Best epoch 3: best metric: 0.565
[09/25 22:15:31 visual_prompt]: Training 4 / 100 epoch, with learning rate 15.0
[09/25 22:15:38 visual_prompt]: Epoch 4 / 100: avg data time: 4.11e-02, avg batch time: 0.4835, average train loss: 35.7523
[09/25 22:15:39 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1670, average loss: 39.8906
[09/25 22:15:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 33.47	
[09/25 22:15:39 visual_prompt]: Training 5 / 100 epoch, with learning rate 20.0
[09/25 22:15:46 visual_prompt]: Epoch 5 / 100: avg data time: 4.45e-02, avg batch time: 0.4866, average train loss: 66.4992
[09/25 22:15:47 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1676, average loss: 59.2964
[09/25 22:15:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 51.90	
[09/25 22:15:47 visual_prompt]: Training 6 / 100 epoch, with learning rate 25.0
[09/25 22:15:54 visual_prompt]: Epoch 6 / 100: avg data time: 5.31e-02, avg batch time: 0.4951, average train loss: 41.8024
[09/25 22:15:55 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1671, average loss: 4.9723
[09/25 22:15:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 75.46	
[09/25 22:15:55 visual_prompt]: Training 7 / 100 epoch, with learning rate 30.0
[09/25 22:16:02 visual_prompt]: Epoch 7 / 100: avg data time: 4.63e-02, avg batch time: 0.4878, average train loss: 31.7911
[09/25 22:16:03 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1674, average loss: 14.9095
[09/25 22:16:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.50	rocauc: 84.61	
[09/25 22:16:03 visual_prompt]: Training 8 / 100 epoch, with learning rate 35.0
[09/25 22:16:10 visual_prompt]: Epoch 8 / 100: avg data time: 5.09e-02, avg batch time: 0.4913, average train loss: 125.7839
[09/25 22:16:11 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1678, average loss: 8.2379
[09/25 22:16:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 47.44	
[09/25 22:16:11 visual_prompt]: Training 9 / 100 epoch, with learning rate 40.0
[09/25 22:16:18 visual_prompt]: Epoch 9 / 100: avg data time: 4.93e-02, avg batch time: 0.4891, average train loss: 122.5896
[09/25 22:16:19 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1671, average loss: 75.7544
[09/25 22:16:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 53.74	
[09/25 22:16:19 visual_prompt]: Training 10 / 100 epoch, with learning rate 45.0
[09/25 22:16:25 visual_prompt]: Epoch 10 / 100: avg data time: 5.04e-02, avg batch time: 0.4910, average train loss: 83.1114
[09/25 22:16:27 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1672, average loss: 20.1446
[09/25 22:16:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 55.61	
[09/25 22:16:27 visual_prompt]: Training 11 / 100 epoch, with learning rate 50.0
[09/25 22:16:33 visual_prompt]: Epoch 11 / 100: avg data time: 5.17e-02, avg batch time: 0.4916, average train loss: 130.8698
[09/25 22:16:35 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1675, average loss: 187.5832
[09/25 22:16:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 60.48	
[09/25 22:16:35 visual_prompt]: Training 12 / 100 epoch, with learning rate 49.9847706754774
[09/25 22:16:41 visual_prompt]: Epoch 12 / 100: avg data time: 4.53e-02, avg batch time: 0.4860, average train loss: 95.5177
[09/25 22:16:43 visual_prompt]: Inference (val):avg data time: 2.73e-05, avg batch time: 0.1672, average loss: 246.2750
[09/25 22:16:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 66.64	
[09/25 22:16:43 visual_prompt]: Training 13 / 100 epoch, with learning rate 49.939101256495604
[09/25 22:16:49 visual_prompt]: Epoch 13 / 100: avg data time: 4.35e-02, avg batch time: 0.4840, average train loss: 165.0516
[09/25 22:16:51 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1674, average loss: 250.2807
[09/25 22:16:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 49.50	
[09/25 22:16:51 visual_prompt]: Training 14 / 100 epoch, with learning rate 49.86304738420683
[09/25 22:16:57 visual_prompt]: Epoch 14 / 100: avg data time: 3.69e-02, avg batch time: 0.4792, average train loss: 120.6338
[09/25 22:16:58 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1676, average loss: 78.3951
[09/25 22:16:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 77.76	
[09/25 22:16:58 visual_prompt]: Training 15 / 100 epoch, with learning rate 49.75670171853926
[09/25 22:17:05 visual_prompt]: Epoch 15 / 100: avg data time: 3.90e-02, avg batch time: 0.4805, average train loss: 77.3999
[09/25 22:17:06 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1675, average loss: 154.5189
[09/25 22:17:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 53.84	
[09/25 22:17:06 visual_prompt]: Training 16 / 100 epoch, with learning rate 49.6201938253052
[09/25 22:17:13 visual_prompt]: Epoch 16 / 100: avg data time: 4.98e-02, avg batch time: 0.4903, average train loss: 109.0883
[09/25 22:17:14 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1674, average loss: 61.5601
[09/25 22:17:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 54.65	
[09/25 22:17:14 visual_prompt]: Training 17 / 100 epoch, with learning rate 49.45369001834514
[09/25 22:17:21 visual_prompt]: Epoch 17 / 100: avg data time: 5.23e-02, avg batch time: 0.4936, average train loss: 74.9523
[09/25 22:17:22 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1674, average loss: 65.1274
[09/25 22:17:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 38.32	
[09/25 22:17:22 visual_prompt]: Training 18 / 100 epoch, with learning rate 49.25739315689991
[09/25 22:17:29 visual_prompt]: Epoch 18 / 100: avg data time: 4.75e-02, avg batch time: 0.4873, average train loss: 102.7553
[09/25 22:17:30 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1672, average loss: 25.4438
[09/25 22:17:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 52.03	
[09/25 22:17:30 visual_prompt]: Training 19 / 100 epoch, with learning rate 49.03154239845797
[09/25 22:17:37 visual_prompt]: Epoch 19 / 100: avg data time: 5.66e-02, avg batch time: 0.4967, average train loss: 90.5336
[09/25 22:17:38 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1675, average loss: 125.3859
[09/25 22:17:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 49.53	
[09/25 22:17:38 visual_prompt]: Training 20 / 100 epoch, with learning rate 48.77641290737884
[09/25 22:17:45 visual_prompt]: Epoch 20 / 100: avg data time: 4.67e-02, avg batch time: 0.4899, average train loss: 76.1024
[09/25 22:17:46 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1674, average loss: 31.6060
[09/25 22:17:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 56.95	
[09/25 22:17:46 visual_prompt]: Training 21 / 100 epoch, with learning rate 48.49231551964771
[09/25 22:17:53 visual_prompt]: Epoch 21 / 100: avg data time: 5.36e-02, avg batch time: 0.4938, average train loss: 113.0747
[09/25 22:17:54 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1678, average loss: 72.6550
[09/25 22:17:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 47.86	
[09/25 22:17:54 visual_prompt]: Training 22 / 100 epoch, with learning rate 48.17959636416968
[09/25 22:18:01 visual_prompt]: Epoch 22 / 100: avg data time: 5.33e-02, avg batch time: 0.4935, average train loss: 75.7638
[09/25 22:18:02 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1678, average loss: 275.4827
[09/25 22:18:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 35.80	
[09/25 22:18:02 visual_prompt]: Training 23 / 100 epoch, with learning rate 47.83863644106502
[09/25 22:18:09 visual_prompt]: Epoch 23 / 100: avg data time: 5.29e-02, avg batch time: 0.4931, average train loss: 147.7391
[09/25 22:18:10 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1674, average loss: 385.6419
[09/25 22:18:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 44.84	
[09/25 22:18:10 visual_prompt]: Training 24 / 100 epoch, with learning rate 47.46985115747918
[09/25 22:18:17 visual_prompt]: Epoch 24 / 100: avg data time: 5.40e-02, avg batch time: 0.4925, average train loss: 124.6299
[09/25 22:18:18 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1675, average loss: 96.1249
[09/25 22:18:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 40.93	
[09/25 22:18:18 visual_prompt]: Training 25 / 100 epoch, with learning rate 47.073689821473174
[09/25 22:18:25 visual_prompt]: Epoch 25 / 100: avg data time: 4.85e-02, avg batch time: 0.4911, average train loss: 100.6032
[09/25 22:18:26 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1673, average loss: 27.9838
[09/25 22:18:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 49.51	
[09/25 22:18:26 visual_prompt]: Training 26 / 100 epoch, with learning rate 46.65063509461097
[09/25 22:18:33 visual_prompt]: Epoch 26 / 100: avg data time: 5.14e-02, avg batch time: 0.4923, average train loss: 88.5867
[09/25 22:18:34 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1675, average loss: 69.8357
[09/25 22:18:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 39.34	
[09/25 22:18:34 visual_prompt]: Training 27 / 100 epoch, with learning rate 46.20120240391065
[09/25 22:18:41 visual_prompt]: Epoch 27 / 100: avg data time: 5.22e-02, avg batch time: 0.4931, average train loss: 97.7361
[09/25 22:18:42 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1674, average loss: 18.8907
[09/25 22:18:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 41.86	
[09/25 22:18:42 visual_prompt]: Training 28 / 100 epoch, with learning rate 45.72593931387604
[09/25 22:18:49 visual_prompt]: Epoch 28 / 100: avg data time: 5.00e-02, avg batch time: 0.4907, average train loss: 62.8041
[09/25 22:18:50 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1676, average loss: 286.0604
[09/25 22:18:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 58.65	
[09/25 22:18:50 visual_prompt]: Training 29 / 100 epoch, with learning rate 45.22542485937369
[09/25 22:18:57 visual_prompt]: Epoch 29 / 100: avg data time: 4.77e-02, avg batch time: 0.4884, average train loss: 67.6809
[09/25 22:18:58 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1677, average loss: 42.4610
[09/25 22:18:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 36.62	
[09/25 22:18:58 visual_prompt]: Training 30 / 100 epoch, with learning rate 44.70026884016804
[09/25 22:19:05 visual_prompt]: Epoch 30 / 100: avg data time: 5.28e-02, avg batch time: 0.4937, average train loss: 61.4468
[09/25 22:19:06 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1674, average loss: 32.1379
[09/25 22:19:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 67.22	
[09/25 22:19:06 visual_prompt]: Training 31 / 100 epoch, with learning rate 44.15111107797445
[09/25 22:19:13 visual_prompt]: Epoch 31 / 100: avg data time: 4.80e-02, avg batch time: 0.4891, average train loss: 115.2733
[09/25 22:19:14 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1677, average loss: 38.1510
[09/25 22:19:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 59.75	
[09/25 22:19:14 visual_prompt]: Training 32 / 100 epoch, with learning rate 43.57862063693486
[09/25 22:19:21 visual_prompt]: Epoch 32 / 100: avg data time: 5.38e-02, avg batch time: 0.4946, average train loss: 101.4242
[09/25 22:19:22 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1673, average loss: 162.5635
[09/25 22:19:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 52.69	
[09/25 22:19:22 visual_prompt]: Training 33 / 100 epoch, with learning rate 42.98349500846628
[09/25 22:19:29 visual_prompt]: Epoch 33 / 100: avg data time: 4.58e-02, avg batch time: 0.4886, average train loss: 59.0105
[09/25 22:19:30 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1675, average loss: 154.4153
[09/25 22:19:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 55.00	rocauc: 62.33	
[09/25 22:19:30 visual_prompt]: Training 34 / 100 epoch, with learning rate 42.36645926147493
[09/25 22:19:37 visual_prompt]: Epoch 34 / 100: avg data time: 3.97e-02, avg batch time: 0.4816, average train loss: 101.4683
[09/25 22:19:38 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1677, average loss: 0.8162
[09/25 22:19:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 49.00	rocauc: 58.62	
[09/25 22:19:38 visual_prompt]: Training 35 / 100 epoch, with learning rate 41.72826515897145
[09/25 22:19:45 visual_prompt]: Epoch 35 / 100: avg data time: 5.52e-02, avg batch time: 0.4953, average train loss: 71.7041
[09/25 22:19:46 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1673, average loss: 129.7047
[09/25 22:19:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 46.14	
[09/25 22:19:46 visual_prompt]: Training 36 / 100 epoch, with learning rate 41.06969024216348
[09/25 22:19:53 visual_prompt]: Epoch 36 / 100: avg data time: 4.89e-02, avg batch time: 0.4902, average train loss: 127.1935
[09/25 22:19:54 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1671, average loss: 9.1956
[09/25 22:19:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 61.76	
[09/25 22:19:54 visual_prompt]: Training 37 / 100 epoch, with learning rate 40.391536883141455
[09/25 22:20:01 visual_prompt]: Epoch 37 / 100: avg data time: 4.81e-02, avg batch time: 0.4903, average train loss: 76.2208
[09/25 22:20:02 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1674, average loss: 96.2023
[09/25 22:20:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 45.58	
[09/25 22:20:02 visual_prompt]: Training 38 / 100 epoch, with learning rate 39.69463130731183
[09/25 22:20:09 visual_prompt]: Epoch 38 / 100: avg data time: 5.67e-02, avg batch time: 0.4969, average train loss: 48.7268
[09/25 22:20:10 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1674, average loss: 13.2725
[09/25 22:20:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 42.62	
[09/25 22:20:10 visual_prompt]: Training 39 / 100 epoch, with learning rate 38.97982258676867
[09/25 22:20:17 visual_prompt]: Epoch 39 / 100: avg data time: 5.08e-02, avg batch time: 0.4922, average train loss: 94.4109
[09/25 22:20:18 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1676, average loss: 114.6806
[09/25 22:20:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 45.19	
[09/25 22:20:18 visual_prompt]: Training 40 / 100 epoch, with learning rate 38.24798160583012
[09/25 22:20:25 visual_prompt]: Epoch 40 / 100: avg data time: 4.82e-02, avg batch time: 0.4904, average train loss: 57.8274
[09/25 22:20:26 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1671, average loss: 146.1114
[09/25 22:20:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 35.35	
[09/25 22:20:26 visual_prompt]: Training 41 / 100 epoch, with learning rate 37.5
[09/25 22:20:33 visual_prompt]: Epoch 41 / 100: avg data time: 4.61e-02, avg batch time: 0.4897, average train loss: 71.0248
[09/25 22:20:34 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1675, average loss: 41.2304
[09/25 22:20:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 63.77	
[09/25 22:20:34 visual_prompt]: Training 42 / 100 epoch, with learning rate 36.736789069647266
[09/25 22:20:41 visual_prompt]: Epoch 42 / 100: avg data time: 5.44e-02, avg batch time: 0.4940, average train loss: 63.7508
[09/25 22:20:42 visual_prompt]: Inference (val):avg data time: 2.23e-05, avg batch time: 0.1670, average loss: 138.8979
[09/25 22:20:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.00	rocauc: 72.09	
[09/25 22:20:42 visual_prompt]: Best epoch 42: best metric: 0.660
[09/25 22:20:42 visual_prompt]: Training 43 / 100 epoch, with learning rate 35.959278669726935
[09/25 22:20:48 visual_prompt]: Epoch 43 / 100: avg data time: 4.00e-02, avg batch time: 0.4820, average train loss: 188.1114
[09/25 22:20:50 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1673, average loss: 401.3287
[09/25 22:20:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 41.17	
[09/25 22:20:50 visual_prompt]: Training 44 / 100 epoch, with learning rate 35.16841607689501
[09/25 22:20:56 visual_prompt]: Epoch 44 / 100: avg data time: 5.10e-02, avg batch time: 0.4900, average train loss: 147.5269
[09/25 22:20:58 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1673, average loss: 4.8667
[09/25 22:20:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 78.87	
[09/25 22:20:58 visual_prompt]: Training 45 / 100 epoch, with learning rate 34.365164835397806
[09/25 22:21:04 visual_prompt]: Epoch 45 / 100: avg data time: 4.30e-02, avg batch time: 0.4867, average train loss: 74.0152
[09/25 22:21:06 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1675, average loss: 5.7213
[09/25 22:21:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 55.94	
[09/25 22:21:06 visual_prompt]: Training 46 / 100 epoch, with learning rate 33.55050358314172
[09/25 22:21:12 visual_prompt]: Epoch 46 / 100: avg data time: 5.00e-02, avg batch time: 0.4908, average train loss: 70.1249
[09/25 22:21:14 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1670, average loss: 133.2773
[09/25 22:21:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 37.92	
[09/25 22:21:14 visual_prompt]: Training 47 / 100 epoch, with learning rate 32.72542485937369
[09/25 22:21:20 visual_prompt]: Epoch 47 / 100: avg data time: 4.97e-02, avg batch time: 0.4918, average train loss: 59.4543
[09/25 22:21:22 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1676, average loss: 84.8295
[09/25 22:21:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 63.76	
[09/25 22:21:22 visual_prompt]: Training 48 / 100 epoch, with learning rate 31.89093389542498
[09/25 22:21:28 visual_prompt]: Epoch 48 / 100: avg data time: 5.43e-02, avg batch time: 0.4965, average train loss: 51.2161
[09/25 22:21:30 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1672, average loss: 50.3293
[09/25 22:21:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 33.90	
[09/25 22:21:30 visual_prompt]: Training 49 / 100 epoch, with learning rate 31.04804738999169
[09/25 22:21:36 visual_prompt]: Epoch 49 / 100: avg data time: 4.98e-02, avg batch time: 0.4919, average train loss: 47.3464
[09/25 22:21:38 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1675, average loss: 61.8507
[09/25 22:21:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 47.50	rocauc: 38.81	
[09/25 22:21:38 visual_prompt]: Training 50 / 100 epoch, with learning rate 30.19779227044398
[09/25 22:21:44 visual_prompt]: Epoch 50 / 100: avg data time: 4.21e-02, avg batch time: 0.4823, average train loss: 64.8749
[09/25 22:21:45 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1674, average loss: 53.3518
[09/25 22:21:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 68.16	
[09/25 22:21:45 visual_prompt]: Training 51 / 100 epoch, with learning rate 29.341204441673263
[09/25 22:21:52 visual_prompt]: Epoch 51 / 100: avg data time: 3.74e-02, avg batch time: 0.4802, average train loss: 49.2211
[09/25 22:21:53 visual_prompt]: Inference (val):avg data time: 2.70e-05, avg batch time: 0.1677, average loss: 33.3445
[09/25 22:21:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 60.54	
[09/25 22:21:53 visual_prompt]: Training 52 / 100 epoch, with learning rate 28.479327524001636
[09/25 22:22:00 visual_prompt]: Epoch 52 / 100: avg data time: 4.92e-02, avg batch time: 0.4923, average train loss: 42.1348
[09/25 22:22:01 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1676, average loss: 119.5314
[09/25 22:22:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 56.23	
[09/25 22:22:01 visual_prompt]: Training 53 / 100 epoch, with learning rate 27.61321158169134
[09/25 22:22:08 visual_prompt]: Epoch 53 / 100: avg data time: 5.73e-02, avg batch time: 0.4981, average train loss: 41.0555
[09/25 22:22:09 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1672, average loss: 11.7099
[09/25 22:22:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 73.45	
[09/25 22:22:09 visual_prompt]: Training 54 / 100 epoch, with learning rate 26.74391184360313
[09/25 22:22:16 visual_prompt]: Epoch 54 / 100: avg data time: 3.40e-02, avg batch time: 0.4782, average train loss: 36.8695
[09/25 22:22:17 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1675, average loss: 23.6302
[09/25 22:22:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 27.80	
[09/25 22:22:17 visual_prompt]: Training 55 / 100 epoch, with learning rate 25.872487417562528
[09/25 22:22:24 visual_prompt]: Epoch 55 / 100: avg data time: 5.07e-02, avg batch time: 0.4929, average train loss: 47.7454
[09/25 22:22:25 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.1673, average loss: 26.2961
[09/25 22:22:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 54.14	
[09/25 22:22:25 visual_prompt]: Training 56 / 100 epoch, with learning rate 25.0
[09/25 22:22:32 visual_prompt]: Epoch 56 / 100: avg data time: 4.72e-02, avg batch time: 0.4905, average train loss: 37.9930
[09/25 22:22:33 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1675, average loss: 139.3891
[09/25 22:22:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 53.26	
[09/25 22:22:33 visual_prompt]: Training 57 / 100 epoch, with learning rate 24.127512582437483
[09/25 22:22:40 visual_prompt]: Epoch 57 / 100: avg data time: 5.39e-02, avg batch time: 0.4964, average train loss: 70.3557
[09/25 22:22:41 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1676, average loss: 25.3399
[09/25 22:22:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 11.77	
[09/25 22:22:41 visual_prompt]: Training 58 / 100 epoch, with learning rate 23.256088156396867
[09/25 22:22:48 visual_prompt]: Epoch 58 / 100: avg data time: 5.69e-02, avg batch time: 0.4989, average train loss: 37.0397
[09/25 22:22:49 visual_prompt]: Inference (val):avg data time: 1.96e-05, avg batch time: 0.1676, average loss: 52.7357
[09/25 22:22:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 23.27	
[09/25 22:22:49 visual_prompt]: Training 59 / 100 epoch, with learning rate 22.38678841830867
[09/25 22:22:56 visual_prompt]: Epoch 59 / 100: avg data time: 5.08e-02, avg batch time: 0.4917, average train loss: 51.3382
[09/25 22:22:57 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1678, average loss: 32.0892
[09/25 22:22:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 51.09	
[09/25 22:22:57 visual_prompt]: Training 60 / 100 epoch, with learning rate 21.52067247599837
[09/25 22:23:04 visual_prompt]: Epoch 60 / 100: avg data time: 5.53e-02, avg batch time: 0.4967, average train loss: 41.1134
[09/25 22:23:05 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1676, average loss: 8.6343
[09/25 22:23:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 25.55	
[09/25 22:23:05 visual_prompt]: Training 61 / 100 epoch, with learning rate 20.65879555832674
[09/25 22:23:12 visual_prompt]: Epoch 61 / 100: avg data time: 4.59e-02, avg batch time: 0.4872, average train loss: 78.1053
[09/25 22:23:13 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.1671, average loss: 386.4729
[09/25 22:23:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 58.43	
[09/25 22:23:13 visual_prompt]: Training 62 / 100 epoch, with learning rate 19.80220772955602
[09/25 22:23:20 visual_prompt]: Epoch 62 / 100: avg data time: 4.05e-02, avg batch time: 0.4809, average train loss: 100.1534
[09/25 22:23:21 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1675, average loss: 15.7171
[09/25 22:23:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 70.41	
[09/25 22:23:21 visual_prompt]: Training 63 / 100 epoch, with learning rate 18.95195261000831
[09/25 22:23:27 visual_prompt]: Epoch 63 / 100: avg data time: 4.77e-02, avg batch time: 0.4905, average train loss: 28.0670
[09/25 22:23:29 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1671, average loss: 80.8834
[09/25 22:23:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 66.33	
[09/25 22:23:29 visual_prompt]: Training 64 / 100 epoch, with learning rate 18.10906610457502
[09/25 22:23:35 visual_prompt]: Epoch 64 / 100: avg data time: 3.92e-02, avg batch time: 0.4843, average train loss: 36.5975
[09/25 22:23:37 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.1675, average loss: 13.3956
[09/25 22:23:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 55.60	
[09/25 22:23:37 visual_prompt]: Training 65 / 100 epoch, with learning rate 17.274575140626318
[09/25 22:23:43 visual_prompt]: Epoch 65 / 100: avg data time: 5.32e-02, avg batch time: 0.4973, average train loss: 26.5503
[09/25 22:23:45 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.1671, average loss: 3.4312
[09/25 22:23:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 73.67	
[09/25 22:23:45 visual_prompt]: Training 66 / 100 epoch, with learning rate 16.449496416858285
[09/25 22:23:51 visual_prompt]: Epoch 66 / 100: avg data time: 5.34e-02, avg batch time: 0.4951, average train loss: 42.7716
[09/25 22:23:53 visual_prompt]: Inference (val):avg data time: 1.94e-05, avg batch time: 0.1677, average loss: 55.2469
[09/25 22:23:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 39.83	
[09/25 22:23:53 visual_prompt]: Training 67 / 100 epoch, with learning rate 15.634835164602197
[09/25 22:23:59 visual_prompt]: Epoch 67 / 100: avg data time: 4.16e-02, avg batch time: 0.4844, average train loss: 24.8939
[09/25 22:24:01 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1675, average loss: 25.9690
[09/25 22:24:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 73.10	
[09/25 22:24:01 visual_prompt]: Training 68 / 100 epoch, with learning rate 14.831583923104999
[09/25 22:24:07 visual_prompt]: Epoch 68 / 100: avg data time: 5.21e-02, avg batch time: 0.4949, average train loss: 20.1442
[09/25 22:24:09 visual_prompt]: Inference (val):avg data time: 1.92e-05, avg batch time: 0.1671, average loss: 18.3398
[09/25 22:24:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 28.84	
[09/25 22:24:09 visual_prompt]: Training 69 / 100 epoch, with learning rate 14.040721330273062
[09/25 22:24:15 visual_prompt]: Epoch 69 / 100: avg data time: 4.66e-02, avg batch time: 0.4887, average train loss: 21.2921
[09/25 22:24:17 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.1675, average loss: 47.7867
[09/25 22:24:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 60.00	
[09/25 22:24:17 visual_prompt]: Training 70 / 100 epoch, with learning rate 13.263210930352736
[09/25 22:24:23 visual_prompt]: Epoch 70 / 100: avg data time: 4.40e-02, avg batch time: 0.4866, average train loss: 51.7193
[09/25 22:24:24 visual_prompt]: Inference (val):avg data time: 2.06e-05, avg batch time: 0.1674, average loss: 79.0441
[09/25 22:24:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.24	
[09/25 22:24:24 visual_prompt]: Training 71 / 100 epoch, with learning rate 12.500000000000005
[09/25 22:24:31 visual_prompt]: Epoch 71 / 100: avg data time: 3.65e-02, avg batch time: 0.4799, average train loss: 38.5540
[09/25 22:24:32 visual_prompt]: Inference (val):avg data time: 2.10e-05, avg batch time: 0.1675, average loss: 23.0373
[09/25 22:24:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 65.55	
[09/25 22:24:32 visual_prompt]: Training 72 / 100 epoch, with learning rate 11.75201839416988
[09/25 22:24:39 visual_prompt]: Epoch 72 / 100: avg data time: 5.16e-02, avg batch time: 0.4947, average train loss: 28.4954
[09/25 22:24:40 visual_prompt]: Inference (val):avg data time: 2.07e-05, avg batch time: 0.1674, average loss: 51.7524
[09/25 22:24:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 48.81	
[09/25 22:24:40 visual_prompt]: Training 73 / 100 epoch, with learning rate 11.020177413231332
[09/25 22:24:47 visual_prompt]: Epoch 73 / 100: avg data time: 4.64e-02, avg batch time: 0.4896, average train loss: 27.1033
[09/25 22:24:48 visual_prompt]: Inference (val):avg data time: 2.04e-05, avg batch time: 0.1680, average loss: 58.0509
[09/25 22:24:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 49.90	
[09/25 22:24:48 visual_prompt]: Training 74 / 100 epoch, with learning rate 10.305368692688175
[09/25 22:24:55 visual_prompt]: Epoch 74 / 100: avg data time: 5.09e-02, avg batch time: 0.4944, average train loss: 21.0126
[09/25 22:24:56 visual_prompt]: Inference (val):avg data time: 1.95e-05, avg batch time: 0.1675, average loss: 36.8053
[09/25 22:24:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 56.19	
[09/25 22:24:56 visual_prompt]: Training 75 / 100 epoch, with learning rate 9.608463116858543
[09/25 22:25:03 visual_prompt]: Epoch 75 / 100: avg data time: 3.83e-02, avg batch time: 0.4825, average train loss: 25.8170
[09/25 22:25:04 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1675, average loss: 52.0629
[09/25 22:25:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 79.75	
[09/25 22:25:04 visual_prompt]: Training 76 / 100 epoch, with learning rate 8.930309757836516
[09/25 22:25:11 visual_prompt]: Epoch 76 / 100: avg data time: 3.86e-02, avg batch time: 0.4829, average train loss: 24.9925
[09/25 22:25:12 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1676, average loss: 2.1950
[09/25 22:25:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 59.46	
[09/25 22:25:12 visual_prompt]: Training 77 / 100 epoch, with learning rate 8.271734841028552
[09/25 22:25:19 visual_prompt]: Epoch 77 / 100: avg data time: 4.88e-02, avg batch time: 0.4936, average train loss: 14.9241
[09/25 22:25:20 visual_prompt]: Inference (val):avg data time: 2.03e-05, avg batch time: 0.1679, average loss: 29.6317
[09/25 22:25:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 70.43	
[09/25 22:25:20 visual_prompt]: Training 78 / 100 epoch, with learning rate 7.633540738525066
[09/25 22:25:27 visual_prompt]: Epoch 78 / 100: avg data time: 4.20e-02, avg batch time: 0.4865, average train loss: 16.9437
[09/25 22:25:28 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1672, average loss: 21.4624
[09/25 22:25:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 54.61	
[09/25 22:25:28 visual_prompt]: Training 79 / 100 epoch, with learning rate 7.016504991533726
[09/25 22:25:35 visual_prompt]: Epoch 79 / 100: avg data time: 6.16e-02, avg batch time: 0.5054, average train loss: 10.4741
[09/25 22:25:36 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1672, average loss: 3.5648
[09/25 22:25:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 70.12	
[09/25 22:25:36 visual_prompt]: Training 80 / 100 epoch, with learning rate 6.4213793630651415
[09/25 22:25:43 visual_prompt]: Epoch 80 / 100: avg data time: 4.43e-02, avg batch time: 0.4897, average train loss: 8.2079
[09/25 22:25:44 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.1675, average loss: 2.3769
[09/25 22:25:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.84	
[09/25 22:25:44 visual_prompt]: Training 81 / 100 epoch, with learning rate 5.848888922025552
[09/25 22:25:51 visual_prompt]: Epoch 81 / 100: avg data time: 5.26e-02, avg batch time: 0.4959, average train loss: 4.7298
[09/25 22:25:52 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1678, average loss: 7.9676
[09/25 22:25:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 87.88	
[09/25 22:25:52 visual_prompt]: Training 82 / 100 epoch, with learning rate 5.2997311598319525
[09/25 22:25:59 visual_prompt]: Epoch 82 / 100: avg data time: 4.85e-02, avg batch time: 0.4938, average train loss: 4.2544
[09/25 22:26:00 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1673, average loss: 0.7538
[09/25 22:26:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 75.91	
[09/25 22:26:00 visual_prompt]: Training 83 / 100 epoch, with learning rate 4.774575140626316
[09/25 22:26:07 visual_prompt]: Epoch 83 / 100: avg data time: 4.13e-02, avg batch time: 0.4875, average train loss: 4.4721
[09/25 22:26:08 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1676, average loss: 5.0437
[09/25 22:26:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 64.40	
[09/25 22:26:08 visual_prompt]: Training 84 / 100 epoch, with learning rate 4.27406068612396
[09/25 22:26:14 visual_prompt]: Epoch 84 / 100: avg data time: 3.77e-02, avg batch time: 0.4839, average train loss: 3.8651
[09/25 22:26:16 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.1675, average loss: 3.4392
[09/25 22:26:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 64.01	
[09/25 22:26:16 visual_prompt]: Training 85 / 100 epoch, with learning rate 3.798797596089351
[09/25 22:26:22 visual_prompt]: Epoch 85 / 100: avg data time: 4.24e-02, avg batch time: 0.4876, average train loss: 1.6615
[09/25 22:26:24 visual_prompt]: Inference (val):avg data time: 1.88e-05, avg batch time: 0.1673, average loss: 0.7672
[09/25 22:26:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 79.18	
[09/25 22:26:24 visual_prompt]: Training 86 / 100 epoch, with learning rate 3.349364905389032
[09/25 22:26:30 visual_prompt]: Epoch 86 / 100: avg data time: 4.30e-02, avg batch time: 0.4883, average train loss: 1.9702
[09/25 22:26:32 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1678, average loss: 3.7262
[09/25 22:26:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.01	
[09/25 22:26:32 visual_prompt]: Training 87 / 100 epoch, with learning rate 2.9263101785268253
[09/25 22:26:38 visual_prompt]: Epoch 87 / 100: avg data time: 4.75e-02, avg batch time: 0.4931, average train loss: 3.3617
[09/25 22:26:40 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1674, average loss: 10.2198
[09/25 22:26:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 66.02	
[09/25 22:26:40 visual_prompt]: Training 88 / 100 epoch, with learning rate 2.5301488425208296
[09/25 22:26:46 visual_prompt]: Epoch 88 / 100: avg data time: 3.72e-02, avg batch time: 0.4808, average train loss: 2.1829
[09/25 22:26:47 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1675, average loss: 0.8696
[09/25 22:26:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 86.97	
[09/25 22:26:47 visual_prompt]: Training 89 / 100 epoch, with learning rate 2.1613635589349753
[09/25 22:26:54 visual_prompt]: Epoch 89 / 100: avg data time: 3.68e-02, avg batch time: 0.4822, average train loss: 2.5348
[09/25 22:26:55 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1672, average loss: 1.1375
[09/25 22:26:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.58	
[09/25 22:26:55 visual_prompt]: Training 90 / 100 epoch, with learning rate 1.820403635830317
[09/25 22:27:02 visual_prompt]: Epoch 90 / 100: avg data time: 5.35e-02, avg batch time: 0.4986, average train loss: 1.5871
[09/25 22:27:03 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.1673, average loss: 1.7299
[09/25 22:27:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 87.78	
[09/25 22:27:03 visual_prompt]: Training 91 / 100 epoch, with learning rate 1.507684480352292
[09/25 22:27:10 visual_prompt]: Epoch 91 / 100: avg data time: 4.23e-02, avg batch time: 0.4875, average train loss: 1.3100
[09/25 22:27:11 visual_prompt]: Inference (val):avg data time: 1.97e-05, avg batch time: 0.1676, average loss: 0.8372
[09/25 22:27:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 90.14	
[09/25 22:27:11 visual_prompt]: Training 92 / 100 epoch, with learning rate 1.2235870926211616
[09/25 22:27:18 visual_prompt]: Epoch 92 / 100: avg data time: 5.12e-02, avg batch time: 0.4950, average train loss: 0.8406
[09/25 22:27:19 visual_prompt]: Inference (val):avg data time: 2.07e-05, avg batch time: 0.1677, average loss: 1.2612
[09/25 22:27:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 90.72	
[09/25 22:27:19 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.9684576015420276
[09/25 22:27:26 visual_prompt]: Epoch 93 / 100: avg data time: 4.68e-02, avg batch time: 0.4917, average train loss: 0.8806
[09/25 22:27:27 visual_prompt]: Inference (val):avg data time: 2.03e-05, avg batch time: 0.1673, average loss: 0.5784
[09/25 22:27:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 63.50	rocauc: 92.25	
[09/25 22:27:27 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.7426068431000882
[09/25 22:27:34 visual_prompt]: Epoch 94 / 100: avg data time: 5.13e-02, avg batch time: 0.4955, average train loss: 0.6098
[09/25 22:27:35 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.1672, average loss: 0.5198
[09/25 22:27:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 91.15	
[09/25 22:27:35 visual_prompt]: Best epoch 94: best metric: 0.790
[09/25 22:27:35 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.5463099816548578
[09/25 22:27:42 visual_prompt]: Epoch 95 / 100: avg data time: 4.93e-02, avg batch time: 0.4935, average train loss: 0.5597
[09/25 22:27:43 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.1677, average loss: 0.4764
[09/25 22:27:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 92.50	
[09/25 22:27:43 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.3798061746947995
[09/25 22:27:50 visual_prompt]: Epoch 96 / 100: avg data time: 5.72e-02, avg batch time: 0.5011, average train loss: 0.5305
[09/25 22:27:51 visual_prompt]: Inference (val):avg data time: 1.98e-05, avg batch time: 0.1672, average loss: 0.4405
[09/25 22:27:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.21	
[09/25 22:27:51 visual_prompt]: Best epoch 96: best metric: 0.805
[09/25 22:27:51 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.24329828146074095
[09/25 22:27:58 visual_prompt]: Epoch 97 / 100: avg data time: 5.72e-02, avg batch time: 0.5014, average train loss: 0.4853
[09/25 22:27:59 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1677, average loss: 0.3876
[09/25 22:27:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.29	
[09/25 22:27:59 visual_prompt]: Best epoch 97: best metric: 0.815
[09/25 22:27:59 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.13695261579316775
[09/25 22:28:06 visual_prompt]: Epoch 98 / 100: avg data time: 5.27e-02, avg batch time: 0.4977, average train loss: 0.4701
[09/25 22:28:07 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1677, average loss: 0.3665
[09/25 22:28:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.46	
[09/25 22:28:07 visual_prompt]: Best epoch 98: best metric: 0.820
[09/25 22:28:07 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.06089874350439506
[09/25 22:28:14 visual_prompt]: Epoch 99 / 100: avg data time: 4.31e-02, avg batch time: 0.4880, average train loss: 0.4592
[09/25 22:28:15 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1679, average loss: 0.3859
[09/25 22:28:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.57	
[09/25 22:28:15 visual_prompt]: Best epoch 99: best metric: 0.830
[09/25 22:28:15 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.015229324522605947
[09/25 22:28:22 visual_prompt]: Epoch 100 / 100: avg data time: 4.98e-02, avg batch time: 0.4941, average train loss: 0.4551
[09/25 22:28:23 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1678, average loss: 0.3783
[09/25 22:28:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.45	
[09/25 22:28:23 visual_prompt]: Rank of current process: 0. World size: 1
[09/25 22:28:23 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/25 22:28:23 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/25 22:28:23 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/25 22:28:23 visual_prompt]: Training with config:
[09/25 22:28:23 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr50.0_wd0.0001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 50.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/25 22:28:23 visual_prompt]: Loading training data...
[09/25 22:28:23 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/25 22:28:24 visual_prompt]: Number of images: 800
[09/25 22:28:24 visual_prompt]: Number of classes: 2 / 2
[09/25 22:28:24 visual_prompt]: Loading validation data...
[09/25 22:28:24 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/25 22:28:25 visual_prompt]: Number of images: 200
[09/25 22:28:25 visual_prompt]: Number of classes: 2 / 2
[09/25 22:28:25 visual_prompt]: Constructing models...
[09/25 22:28:27 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/25 22:28:27 visual_prompt]: tuned percent:0.536
[09/25 22:28:27 visual_prompt]: Device used for model: 0
[09/25 22:28:27 visual_prompt]: Setting up Evaluator...
[09/25 22:28:27 visual_prompt]: Setting up Trainer...
[09/25 22:28:27 visual_prompt]: 	Setting up the optimizer...
[09/25 22:28:27 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/25 22:28:34 visual_prompt]: Epoch 1 / 100: avg data time: 5.02e-02, avg batch time: 0.4948, average train loss: 1.9791
[09/25 22:28:35 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1672, average loss: 2.0033
[09/25 22:28:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/25 22:28:35 visual_prompt]: Best epoch 1: best metric: 0.520
[09/25 22:28:35 visual_prompt]: Training 2 / 100 epoch, with learning rate 5.0
[09/25 22:28:42 visual_prompt]: Epoch 2 / 100: avg data time: 5.45e-02, avg batch time: 0.4967, average train loss: 32.7894
[09/25 22:28:43 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1667, average loss: 50.5118
[09/25 22:28:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 71.64	
[09/25 22:28:43 visual_prompt]: Training 3 / 100 epoch, with learning rate 10.0
[09/25 22:28:50 visual_prompt]: Epoch 3 / 100: avg data time: 5.28e-02, avg batch time: 0.4945, average train loss: 35.0876
[09/25 22:28:51 visual_prompt]: Inference (val):avg data time: 2.76e-05, avg batch time: 0.1667, average loss: 20.1653
[09/25 22:28:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.73	
[09/25 22:28:51 visual_prompt]: Training 4 / 100 epoch, with learning rate 15.0
[09/25 22:28:58 visual_prompt]: Epoch 4 / 100: avg data time: 3.87e-02, avg batch time: 0.4820, average train loss: 23.2237
[09/25 22:28:59 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1668, average loss: 6.7966
[09/25 22:28:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.07	
[09/25 22:28:59 visual_prompt]: Training 5 / 100 epoch, with learning rate 20.0
[09/25 22:29:06 visual_prompt]: Epoch 5 / 100: avg data time: 4.27e-02, avg batch time: 0.4857, average train loss: 25.4939
[09/25 22:29:07 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1673, average loss: 38.6266
[09/25 22:29:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.71	
[09/25 22:29:07 visual_prompt]: Training 6 / 100 epoch, with learning rate 25.0
[09/25 22:29:14 visual_prompt]: Epoch 6 / 100: avg data time: 4.25e-02, avg batch time: 0.4858, average train loss: 23.6608
[09/25 22:29:15 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1671, average loss: 21.5985
[09/25 22:29:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 89.03	
[09/25 22:29:15 visual_prompt]: Training 7 / 100 epoch, with learning rate 30.0
[09/25 22:29:22 visual_prompt]: Epoch 7 / 100: avg data time: 5.27e-02, avg batch time: 0.4928, average train loss: 56.5276
[09/25 22:29:23 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1671, average loss: 88.6518
[09/25 22:29:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 65.57	
[09/25 22:29:23 visual_prompt]: Training 8 / 100 epoch, with learning rate 35.0
[09/25 22:29:30 visual_prompt]: Epoch 8 / 100: avg data time: 3.80e-02, avg batch time: 0.4798, average train loss: 79.6873
[09/25 22:29:31 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1671, average loss: 110.8123
[09/25 22:29:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 52.64	
[09/25 22:29:31 visual_prompt]: Training 9 / 100 epoch, with learning rate 40.0
[09/25 22:29:38 visual_prompt]: Epoch 9 / 100: avg data time: 4.57e-02, avg batch time: 0.4862, average train loss: 114.6170
[09/25 22:29:39 visual_prompt]: Inference (val):avg data time: 2.70e-05, avg batch time: 0.1670, average loss: 130.6335
[09/25 22:29:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 18.11	
[09/25 22:29:39 visual_prompt]: Training 10 / 100 epoch, with learning rate 45.0
[09/25 22:29:46 visual_prompt]: Epoch 10 / 100: avg data time: 4.17e-02, avg batch time: 0.4813, average train loss: 173.9261
[09/25 22:29:47 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1670, average loss: 114.6935
[09/25 22:29:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 52.76	
[09/25 22:29:47 visual_prompt]: Training 11 / 100 epoch, with learning rate 50.0
[09/25 22:29:54 visual_prompt]: Epoch 11 / 100: avg data time: 5.62e-02, avg batch time: 0.4962, average train loss: 85.5052
[09/25 22:29:55 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1671, average loss: 195.4980
[09/25 22:29:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 55.99	
[09/25 22:29:55 visual_prompt]: Training 12 / 100 epoch, with learning rate 49.9847706754774
[09/25 22:30:02 visual_prompt]: Epoch 12 / 100: avg data time: 4.84e-02, avg batch time: 0.4874, average train loss: 124.6828
[09/25 22:30:03 visual_prompt]: Inference (val):avg data time: 4.32e-05, avg batch time: 0.1671, average loss: 138.1397
[09/25 22:30:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 80.07	
[09/25 22:30:03 visual_prompt]: Training 13 / 100 epoch, with learning rate 49.939101256495604
[09/25 22:30:10 visual_prompt]: Epoch 13 / 100: avg data time: 3.98e-02, avg batch time: 0.4807, average train loss: 62.6700
[09/25 22:30:11 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1672, average loss: 69.4426
[09/25 22:30:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 73.25	
[09/25 22:30:11 visual_prompt]: Training 14 / 100 epoch, with learning rate 49.86304738420683
[09/25 22:30:18 visual_prompt]: Epoch 14 / 100: avg data time: 5.08e-02, avg batch time: 0.4931, average train loss: 51.0993
[09/25 22:30:19 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1677, average loss: 268.1621
[09/25 22:30:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.30	
[09/25 22:30:19 visual_prompt]: Training 15 / 100 epoch, with learning rate 49.75670171853926
[09/25 22:30:26 visual_prompt]: Epoch 15 / 100: avg data time: 4.11e-02, avg batch time: 0.4806, average train loss: 90.3204
[09/25 22:30:27 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1677, average loss: 30.2062
[09/25 22:30:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.93	
[09/25 22:30:27 visual_prompt]: Training 16 / 100 epoch, with learning rate 49.6201938253052
[09/25 22:30:34 visual_prompt]: Epoch 16 / 100: avg data time: 5.61e-02, avg batch time: 0.4973, average train loss: 50.1011
[09/25 22:30:35 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1670, average loss: 36.3398
[09/25 22:30:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 56.66	
[09/25 22:30:35 visual_prompt]: Training 17 / 100 epoch, with learning rate 49.45369001834514
[09/25 22:30:42 visual_prompt]: Epoch 17 / 100: avg data time: 4.64e-02, avg batch time: 0.4876, average train loss: 62.1357
[09/25 22:30:43 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1672, average loss: 107.8379
[09/25 22:30:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 52.96	
[09/25 22:30:43 visual_prompt]: Training 18 / 100 epoch, with learning rate 49.25739315689991
[09/25 22:30:50 visual_prompt]: Epoch 18 / 100: avg data time: 5.14e-02, avg batch time: 0.4920, average train loss: 76.2244
[09/25 22:30:51 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.1669, average loss: 81.3942
[09/25 22:30:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 27.19	
[09/25 22:30:51 visual_prompt]: Training 19 / 100 epoch, with learning rate 49.03154239845797
[09/25 22:30:58 visual_prompt]: Epoch 19 / 100: avg data time: 5.22e-02, avg batch time: 0.4937, average train loss: 68.1168
[09/25 22:30:59 visual_prompt]: Inference (val):avg data time: 2.08e-05, avg batch time: 0.1669, average loss: 10.0885
[09/25 22:30:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 56.74	
[09/25 22:30:59 visual_prompt]: Training 20 / 100 epoch, with learning rate 48.77641290737884
[09/25 22:31:06 visual_prompt]: Epoch 20 / 100: avg data time: 4.02e-02, avg batch time: 0.4810, average train loss: 91.0212
[09/25 22:31:07 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1672, average loss: 10.4631
[09/25 22:31:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 49.22	
[09/25 22:31:07 visual_prompt]: Training 21 / 100 epoch, with learning rate 48.49231551964771
[09/25 22:31:14 visual_prompt]: Epoch 21 / 100: avg data time: 5.20e-02, avg batch time: 0.4940, average train loss: 81.7686
[09/25 22:31:15 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1669, average loss: 5.0933
[09/25 22:31:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 59.22	
[09/25 22:31:15 visual_prompt]: Training 22 / 100 epoch, with learning rate 48.17959636416968
[09/25 22:31:22 visual_prompt]: Epoch 22 / 100: avg data time: 5.11e-02, avg batch time: 0.4913, average train loss: 57.5821
[09/25 22:31:23 visual_prompt]: Inference (val):avg data time: 3.19e-05, avg batch time: 0.1669, average loss: 27.3939
[09/25 22:31:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 77.60	
[09/25 22:31:23 visual_prompt]: Training 23 / 100 epoch, with learning rate 47.83863644106502
[09/25 22:31:30 visual_prompt]: Epoch 23 / 100: avg data time: 5.09e-02, avg batch time: 0.4934, average train loss: 51.9375
[09/25 22:31:31 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1672, average loss: 42.2300
[09/25 22:31:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 72.39	
[09/25 22:31:31 visual_prompt]: Training 24 / 100 epoch, with learning rate 47.46985115747918
[09/25 22:31:38 visual_prompt]: Epoch 24 / 100: avg data time: 3.87e-02, avg batch time: 0.4787, average train loss: 120.6144
[09/25 22:31:39 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1668, average loss: 130.9701
[09/25 22:31:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 79.26	
[09/25 22:31:39 visual_prompt]: Training 25 / 100 epoch, with learning rate 47.073689821473174
[09/25 22:31:46 visual_prompt]: Epoch 25 / 100: avg data time: 5.13e-02, avg batch time: 0.4918, average train loss: 72.3827
[09/25 22:31:47 visual_prompt]: Inference (val):avg data time: 3.04e-05, avg batch time: 0.1677, average loss: 314.3654
[09/25 22:31:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 45.81	
[09/25 22:31:47 visual_prompt]: Training 26 / 100 epoch, with learning rate 46.65063509461097
[09/25 22:31:54 visual_prompt]: Epoch 26 / 100: avg data time: 6.00e-02, avg batch time: 0.4999, average train loss: 193.1452
[09/25 22:31:55 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1674, average loss: 137.2005
[09/25 22:31:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 63.16	
[09/25 22:31:55 visual_prompt]: Training 27 / 100 epoch, with learning rate 46.20120240391065
[09/25 22:32:02 visual_prompt]: Epoch 27 / 100: avg data time: 4.88e-02, avg batch time: 0.4888, average train loss: 105.8402
[09/25 22:32:03 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1674, average loss: 217.7500
[09/25 22:32:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 70.50	
[09/25 22:32:03 visual_prompt]: Training 28 / 100 epoch, with learning rate 45.72593931387604
[09/25 22:32:10 visual_prompt]: Epoch 28 / 100: avg data time: 4.66e-02, avg batch time: 0.4870, average train loss: 159.1457
[09/25 22:32:11 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1674, average loss: 47.4536
[09/25 22:32:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 80.70	
[09/25 22:32:11 visual_prompt]: Training 29 / 100 epoch, with learning rate 45.22542485937369
[09/25 22:32:18 visual_prompt]: Epoch 29 / 100: avg data time: 3.86e-02, avg batch time: 0.4800, average train loss: 74.6636
[09/25 22:32:19 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1671, average loss: 138.0592
[09/25 22:32:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 81.02	
[09/25 22:32:19 visual_prompt]: Training 30 / 100 epoch, with learning rate 44.70026884016804
[09/25 22:32:26 visual_prompt]: Epoch 30 / 100: avg data time: 3.91e-02, avg batch time: 0.4812, average train loss: 88.3810
[09/25 22:32:27 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1666, average loss: 159.7872
[09/25 22:32:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 26.45	
[09/25 22:32:27 visual_prompt]: Training 31 / 100 epoch, with learning rate 44.15111107797445
[09/25 22:32:34 visual_prompt]: Epoch 31 / 100: avg data time: 5.70e-02, avg batch time: 0.4974, average train loss: 80.6831
[09/25 22:32:35 visual_prompt]: Inference (val):avg data time: 2.04e-05, avg batch time: 0.1673, average loss: 103.7008
[09/25 22:32:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 34.63	
[09/25 22:32:35 visual_prompt]: Training 32 / 100 epoch, with learning rate 43.57862063693486
[09/25 22:32:42 visual_prompt]: Epoch 32 / 100: avg data time: 4.57e-02, avg batch time: 0.4872, average train loss: 98.2422
[09/25 22:32:43 visual_prompt]: Inference (val):avg data time: 3.92e-05, avg batch time: 0.1677, average loss: 272.0024
[09/25 22:32:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 77.85	
[09/25 22:32:43 visual_prompt]: Training 33 / 100 epoch, with learning rate 42.98349500846628
[09/25 22:32:50 visual_prompt]: Epoch 33 / 100: avg data time: 5.33e-02, avg batch time: 0.4934, average train loss: 119.7652
[09/25 22:32:51 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1674, average loss: 47.0872
[09/25 22:32:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 62.60	
[09/25 22:32:51 visual_prompt]: Training 34 / 100 epoch, with learning rate 42.36645926147493
[09/25 22:32:58 visual_prompt]: Epoch 34 / 100: avg data time: 4.07e-02, avg batch time: 0.4820, average train loss: 50.5915
[09/25 22:32:59 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1672, average loss: 50.2408
[09/25 22:32:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 90.49	
[09/25 22:32:59 visual_prompt]: Training 35 / 100 epoch, with learning rate 41.72826515897145
[09/25 22:33:06 visual_prompt]: Epoch 35 / 100: avg data time: 5.25e-02, avg batch time: 0.4947, average train loss: 67.3901
[09/25 22:33:07 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1673, average loss: 90.9847
[09/25 22:33:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 22.27	
[09/25 22:33:07 visual_prompt]: Training 36 / 100 epoch, with learning rate 41.06969024216348
[09/25 22:33:13 visual_prompt]: Epoch 36 / 100: avg data time: 4.28e-02, avg batch time: 0.4850, average train loss: 50.1303
[09/25 22:33:15 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1671, average loss: 66.4355
[09/25 22:33:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 52.20	
[09/25 22:33:15 visual_prompt]: Training 37 / 100 epoch, with learning rate 40.391536883141455
[09/25 22:33:21 visual_prompt]: Epoch 37 / 100: avg data time: 3.76e-02, avg batch time: 0.4797, average train loss: 51.5691
[09/25 22:33:23 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.1669, average loss: 41.7269
[09/25 22:33:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 81.63	
[09/25 22:33:23 visual_prompt]: Training 38 / 100 epoch, with learning rate 39.69463130731183
[09/25 22:33:29 visual_prompt]: Epoch 38 / 100: avg data time: 4.93e-02, avg batch time: 0.4882, average train loss: 138.0608
[09/25 22:33:31 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.1676, average loss: 295.6088
[09/25 22:33:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 23.58	
[09/25 22:33:31 visual_prompt]: Training 39 / 100 epoch, with learning rate 38.97982258676867
[09/25 22:33:37 visual_prompt]: Epoch 39 / 100: avg data time: 3.93e-02, avg batch time: 0.4802, average train loss: 156.6665
[09/25 22:33:39 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1671, average loss: 194.8428
[09/25 22:33:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 68.10	
[09/25 22:33:39 visual_prompt]: Training 40 / 100 epoch, with learning rate 38.24798160583012
[09/25 22:33:45 visual_prompt]: Epoch 40 / 100: avg data time: 5.68e-02, avg batch time: 0.4956, average train loss: 162.5331
[09/25 22:33:47 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.1672, average loss: 91.7065
[09/25 22:33:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 65.02	
[09/25 22:33:47 visual_prompt]: Training 41 / 100 epoch, with learning rate 37.5
[09/25 22:33:53 visual_prompt]: Epoch 41 / 100: avg data time: 5.26e-02, avg batch time: 0.4937, average train loss: 57.2273
[09/25 22:33:55 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1675, average loss: 62.1400
[09/25 22:33:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.63	
[09/25 22:33:55 visual_prompt]: Training 42 / 100 epoch, with learning rate 36.736789069647266
[09/25 22:34:01 visual_prompt]: Epoch 42 / 100: avg data time: 4.96e-02, avg batch time: 0.4904, average train loss: 60.1753
[09/25 22:34:03 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1672, average loss: 62.7638
[09/25 22:34:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.23	
[09/25 22:34:03 visual_prompt]: Training 43 / 100 epoch, with learning rate 35.959278669726935
[09/25 22:34:09 visual_prompt]: Epoch 43 / 100: avg data time: 4.16e-02, avg batch time: 0.4830, average train loss: 46.3636
[09/25 22:34:10 visual_prompt]: Inference (val):avg data time: 2.17e-05, avg batch time: 0.1675, average loss: 93.2765
[09/25 22:34:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 67.65	
[09/25 22:34:10 visual_prompt]: Training 44 / 100 epoch, with learning rate 35.16841607689501
[09/25 22:34:17 visual_prompt]: Epoch 44 / 100: avg data time: 4.33e-02, avg batch time: 0.4860, average train loss: 66.9755
[09/25 22:34:18 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1673, average loss: 161.2124
[09/25 22:34:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 54.44	
[09/25 22:34:18 visual_prompt]: Training 45 / 100 epoch, with learning rate 34.365164835397806
[09/25 22:34:25 visual_prompt]: Epoch 45 / 100: avg data time: 5.23e-02, avg batch time: 0.4948, average train loss: 54.1479
[09/25 22:34:26 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1671, average loss: 1.6012
[09/25 22:34:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.06	
[09/25 22:34:26 visual_prompt]: Training 46 / 100 epoch, with learning rate 33.55050358314172
[09/25 22:34:33 visual_prompt]: Epoch 46 / 100: avg data time: 4.70e-02, avg batch time: 0.4916, average train loss: 41.1559
[09/25 22:34:35 visual_prompt]: Inference (val):avg data time: 3.27e-05, avg batch time: 0.1677, average loss: 61.8719
[09/25 22:34:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.68	
[09/25 22:34:35 visual_prompt]: Training 47 / 100 epoch, with learning rate 32.72542485937369
[09/25 22:34:41 visual_prompt]: Epoch 47 / 100: avg data time: 5.61e-02, avg batch time: 0.4973, average train loss: 87.5254
[09/25 22:34:43 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1669, average loss: 92.0288
[09/25 22:34:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 71.19	
[09/25 22:34:43 visual_prompt]: Training 48 / 100 epoch, with learning rate 31.89093389542498
[09/25 22:34:49 visual_prompt]: Epoch 48 / 100: avg data time: 4.52e-02, avg batch time: 0.4856, average train loss: 45.7156
[09/25 22:34:50 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1671, average loss: 77.2456
[09/25 22:34:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 88.06	
[09/25 22:34:50 visual_prompt]: Training 49 / 100 epoch, with learning rate 31.04804738999169
[09/25 22:34:57 visual_prompt]: Epoch 49 / 100: avg data time: 5.24e-02, avg batch time: 0.4958, average train loss: 41.5699
[09/25 22:34:59 visual_prompt]: Inference (val):avg data time: 2.07e-05, avg batch time: 0.1672, average loss: 21.6584
[09/25 22:34:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 78.76	
[09/25 22:34:59 visual_prompt]: Training 50 / 100 epoch, with learning rate 30.19779227044398
[09/25 22:35:05 visual_prompt]: Epoch 50 / 100: avg data time: 5.18e-02, avg batch time: 0.4934, average train loss: 34.7907
[09/25 22:35:07 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1669, average loss: 5.9853
[09/25 22:35:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 75.18	
[09/25 22:35:07 visual_prompt]: Training 51 / 100 epoch, with learning rate 29.341204441673263
[09/25 22:35:13 visual_prompt]: Epoch 51 / 100: avg data time: 5.11e-02, avg batch time: 0.4941, average train loss: 26.8767
[09/25 22:35:15 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.1677, average loss: 11.6210
[09/25 22:35:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.23	
[09/25 22:35:15 visual_prompt]: Training 52 / 100 epoch, with learning rate 28.479327524001636
[09/25 22:35:21 visual_prompt]: Epoch 52 / 100: avg data time: 3.94e-02, avg batch time: 0.4835, average train loss: 29.6130
[09/25 22:35:23 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1673, average loss: 9.2365
[09/25 22:35:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 71.91	
[09/25 22:35:23 visual_prompt]: Training 53 / 100 epoch, with learning rate 27.61321158169134
[09/25 22:35:29 visual_prompt]: Epoch 53 / 100: avg data time: 4.87e-02, avg batch time: 0.4905, average train loss: 31.3676
[09/25 22:35:31 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1670, average loss: 1.8596
[09/25 22:35:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.20	
[09/25 22:35:31 visual_prompt]: Training 54 / 100 epoch, with learning rate 26.74391184360313
[09/25 22:35:37 visual_prompt]: Epoch 54 / 100: avg data time: 4.22e-02, avg batch time: 0.4880, average train loss: 14.1784
[09/25 22:35:39 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.1677, average loss: 9.6080
[09/25 22:35:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 77.70	
[09/25 22:35:39 visual_prompt]: Training 55 / 100 epoch, with learning rate 25.872487417562528
[09/25 22:35:45 visual_prompt]: Epoch 55 / 100: avg data time: 4.14e-02, avg batch time: 0.4886, average train loss: 9.2360
[09/25 22:35:47 visual_prompt]: Inference (val):avg data time: 1.93e-05, avg batch time: 0.1673, average loss: 29.6858
[09/25 22:35:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 81.07	
[09/25 22:35:47 visual_prompt]: Training 56 / 100 epoch, with learning rate 25.0
[09/25 22:35:53 visual_prompt]: Epoch 56 / 100: avg data time: 4.55e-02, avg batch time: 0.4883, average train loss: 29.5714
[09/25 22:35:54 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.1671, average loss: 85.3522
[09/25 22:35:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 56.91	
[09/25 22:35:54 visual_prompt]: Training 57 / 100 epoch, with learning rate 24.127512582437483
[09/25 22:36:01 visual_prompt]: Epoch 57 / 100: avg data time: 4.19e-02, avg batch time: 0.4822, average train loss: 72.7829
[09/25 22:36:02 visual_prompt]: Inference (val):avg data time: 3.61e-05, avg batch time: 0.1672, average loss: 59.5399
[09/25 22:36:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 66.19	
[09/25 22:36:02 visual_prompt]: Training 58 / 100 epoch, with learning rate 23.256088156396867
[09/25 22:36:09 visual_prompt]: Epoch 58 / 100: avg data time: 3.89e-02, avg batch time: 0.4833, average train loss: 26.0032
[09/25 22:36:10 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1670, average loss: 15.9558
[09/25 22:36:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 80.02	
[09/25 22:36:10 visual_prompt]: Training 59 / 100 epoch, with learning rate 22.38678841830867
[09/25 22:36:17 visual_prompt]: Epoch 59 / 100: avg data time: 4.55e-02, avg batch time: 0.4865, average train loss: 59.5213
[09/25 22:36:18 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.1671, average loss: 14.5339
[09/25 22:36:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 74.61	
[09/25 22:36:18 visual_prompt]: Training 60 / 100 epoch, with learning rate 21.52067247599837
[09/25 22:36:25 visual_prompt]: Epoch 60 / 100: avg data time: 4.21e-02, avg batch time: 0.4856, average train loss: 25.6062
[09/25 22:36:26 visual_prompt]: Inference (val):avg data time: 2.07e-05, avg batch time: 0.1673, average loss: 21.3755
[09/25 22:36:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 35.10	
[09/25 22:36:26 visual_prompt]: Training 61 / 100 epoch, with learning rate 20.65879555832674
[09/25 22:36:33 visual_prompt]: Epoch 61 / 100: avg data time: 4.08e-02, avg batch time: 0.4848, average train loss: 24.8397
[09/25 22:36:34 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1670, average loss: 35.0068
[09/25 22:36:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 74.10	
[09/25 22:36:34 visual_prompt]: Training 62 / 100 epoch, with learning rate 19.80220772955602
[09/25 22:36:41 visual_prompt]: Epoch 62 / 100: avg data time: 4.29e-02, avg batch time: 0.4852, average train loss: 18.6419
[09/25 22:36:42 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.1671, average loss: 30.1744
[09/25 22:36:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 76.86	
[09/25 22:36:42 visual_prompt]: Training 63 / 100 epoch, with learning rate 18.95195261000831
[09/25 22:36:48 visual_prompt]: Epoch 63 / 100: avg data time: 3.85e-02, avg batch time: 0.4822, average train loss: 22.1410
[09/25 22:36:50 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1673, average loss: 39.0827
[09/25 22:36:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 39.22	
[09/25 22:36:50 visual_prompt]: Training 64 / 100 epoch, with learning rate 18.10906610457502
[09/25 22:36:56 visual_prompt]: Epoch 64 / 100: avg data time: 4.68e-02, avg batch time: 0.4906, average train loss: 21.5260
[09/25 22:36:58 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1675, average loss: 35.9095
[09/25 22:36:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.23	
[09/25 22:36:58 visual_prompt]: Training 65 / 100 epoch, with learning rate 17.274575140626318
[09/25 22:37:05 visual_prompt]: Epoch 65 / 100: avg data time: 4.94e-02, avg batch time: 0.4925, average train loss: 11.7084
[09/25 22:37:06 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1674, average loss: 3.0742
[09/25 22:37:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 81.76	
[09/25 22:37:06 visual_prompt]: Training 66 / 100 epoch, with learning rate 16.449496416858285
[09/25 22:37:12 visual_prompt]: Epoch 66 / 100: avg data time: 3.68e-02, avg batch time: 0.4831, average train loss: 4.7341
[09/25 22:37:14 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1671, average loss: 16.9761
[09/25 22:37:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 76.62	
[09/25 22:37:14 visual_prompt]: Training 67 / 100 epoch, with learning rate 15.634835164602197
[09/25 22:37:20 visual_prompt]: Epoch 67 / 100: avg data time: 5.20e-02, avg batch time: 0.4953, average train loss: 12.4932
[09/25 22:37:22 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1678, average loss: 6.3235
[09/25 22:37:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 70.77	
[09/25 22:37:22 visual_prompt]: Training 68 / 100 epoch, with learning rate 14.831583923104999
[09/25 22:37:29 visual_prompt]: Epoch 68 / 100: avg data time: 5.55e-02, avg batch time: 0.4985, average train loss: 29.5640
[09/25 22:37:30 visual_prompt]: Inference (val):avg data time: 2.09e-05, avg batch time: 0.1673, average loss: 47.5294
[09/25 22:37:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 65.67	
[09/25 22:37:30 visual_prompt]: Training 69 / 100 epoch, with learning rate 14.040721330273062
[09/25 22:37:37 visual_prompt]: Epoch 69 / 100: avg data time: 4.26e-02, avg batch time: 0.4861, average train loss: 22.9860
[09/25 22:37:38 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1677, average loss: 40.1406
[09/25 22:37:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 38.56	
[09/25 22:37:38 visual_prompt]: Training 70 / 100 epoch, with learning rate 13.263210930352736
[09/25 22:37:45 visual_prompt]: Epoch 70 / 100: avg data time: 4.37e-02, avg batch time: 0.4868, average train loss: 34.3643
[09/25 22:37:46 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1674, average loss: 15.8424
[09/25 22:37:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 57.96	
[09/25 22:37:46 visual_prompt]: Training 71 / 100 epoch, with learning rate 12.500000000000005
[09/25 22:37:52 visual_prompt]: Epoch 71 / 100: avg data time: 4.08e-02, avg batch time: 0.4842, average train loss: 43.0006
[09/25 22:37:54 visual_prompt]: Inference (val):avg data time: 2.04e-05, avg batch time: 0.1673, average loss: 62.3966
[09/25 22:37:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 67.79	
[09/25 22:37:54 visual_prompt]: Training 72 / 100 epoch, with learning rate 11.75201839416988
[09/25 22:38:00 visual_prompt]: Epoch 72 / 100: avg data time: 3.67e-02, avg batch time: 0.4776, average train loss: 56.8798
[09/25 22:38:02 visual_prompt]: Inference (val):avg data time: 3.67e-05, avg batch time: 0.1673, average loss: 9.2400
[09/25 22:38:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 55.23	
[09/25 22:38:02 visual_prompt]: Training 73 / 100 epoch, with learning rate 11.020177413231332
[09/25 22:38:08 visual_prompt]: Epoch 73 / 100: avg data time: 4.83e-02, avg batch time: 0.4937, average train loss: 17.1573
[09/25 22:38:10 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1672, average loss: 6.8900
[09/25 22:38:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 87.56	
[09/25 22:38:10 visual_prompt]: Training 74 / 100 epoch, with learning rate 10.305368692688175
[09/25 22:38:16 visual_prompt]: Epoch 74 / 100: avg data time: 5.43e-02, avg batch time: 0.4989, average train loss: 7.7453
[09/25 22:38:18 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1674, average loss: 14.2157
[09/25 22:38:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 89.46	
[09/25 22:38:18 visual_prompt]: Training 75 / 100 epoch, with learning rate 9.608463116858543
[09/25 22:38:24 visual_prompt]: Epoch 75 / 100: avg data time: 4.06e-02, avg batch time: 0.4868, average train loss: 13.0527
[09/25 22:38:26 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1673, average loss: 19.8975
[09/25 22:38:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 88.93	
[09/25 22:38:26 visual_prompt]: Training 76 / 100 epoch, with learning rate 8.930309757836516
[09/25 22:38:32 visual_prompt]: Epoch 76 / 100: avg data time: 4.76e-02, avg batch time: 0.4922, average train loss: 12.6904
[09/25 22:38:34 visual_prompt]: Inference (val):avg data time: 2.08e-05, avg batch time: 0.1674, average loss: 14.8826
[09/25 22:38:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 88.51	
[09/25 22:38:34 visual_prompt]: Training 77 / 100 epoch, with learning rate 8.271734841028552
[09/25 22:38:40 visual_prompt]: Epoch 77 / 100: avg data time: 4.19e-02, avg batch time: 0.4876, average train loss: 5.9366
[09/25 22:38:42 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1673, average loss: 3.5918
[09/25 22:38:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 55.50	rocauc: 89.49	
[09/25 22:38:42 visual_prompt]: Best epoch 77: best metric: 0.555
[09/25 22:38:42 visual_prompt]: Training 78 / 100 epoch, with learning rate 7.633540738525066
[09/25 22:38:48 visual_prompt]: Epoch 78 / 100: avg data time: 4.29e-02, avg batch time: 0.4878, average train loss: 5.1194
[09/25 22:38:50 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1671, average loss: 6.5610
[09/25 22:38:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 89.45	
[09/25 22:38:50 visual_prompt]: Training 79 / 100 epoch, with learning rate 7.016504991533726
[09/25 22:38:56 visual_prompt]: Epoch 79 / 100: avg data time: 4.16e-02, avg batch time: 0.4866, average train loss: 5.2326
[09/25 22:38:58 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1674, average loss: 1.0371
[09/25 22:38:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.50	rocauc: 90.24	
[09/25 22:38:58 visual_prompt]: Best epoch 79: best metric: 0.655
[09/25 22:38:58 visual_prompt]: Training 80 / 100 epoch, with learning rate 6.4213793630651415
[09/25 22:39:04 visual_prompt]: Epoch 80 / 100: avg data time: 3.82e-02, avg batch time: 0.4827, average train loss: 1.4648
[09/25 22:39:05 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1675, average loss: 1.0027
[09/25 22:39:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 62.00	rocauc: 89.24	
[09/25 22:39:06 visual_prompt]: Training 81 / 100 epoch, with learning rate 5.848888922025552
[09/25 22:39:12 visual_prompt]: Epoch 81 / 100: avg data time: 4.33e-02, avg batch time: 0.4893, average train loss: 1.2202
[09/25 22:39:13 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1672, average loss: 1.5791
[09/25 22:39:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.50	rocauc: 89.50	
[09/25 22:39:13 visual_prompt]: Training 82 / 100 epoch, with learning rate 5.2997311598319525
[09/25 22:39:20 visual_prompt]: Epoch 82 / 100: avg data time: 4.63e-02, avg batch time: 0.4904, average train loss: 0.9779
[09/25 22:39:21 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1674, average loss: 0.6817
[09/25 22:39:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.50	rocauc: 90.43	
[09/25 22:39:21 visual_prompt]: Best epoch 82: best metric: 0.725
[09/25 22:39:21 visual_prompt]: Training 83 / 100 epoch, with learning rate 4.774575140626316
[09/25 22:39:28 visual_prompt]: Epoch 83 / 100: avg data time: 4.15e-02, avg batch time: 0.4868, average train loss: 0.7872
[09/25 22:39:29 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1676, average loss: 1.0196
[09/25 22:39:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 58.00	rocauc: 90.98	
[09/25 22:39:29 visual_prompt]: Training 84 / 100 epoch, with learning rate 4.27406068612396
[09/25 22:39:36 visual_prompt]: Epoch 84 / 100: avg data time: 4.32e-02, avg batch time: 0.4905, average train loss: 1.3782
[09/25 22:39:37 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1677, average loss: 0.6215
[09/25 22:39:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 91.11	
[09/25 22:39:37 visual_prompt]: Best epoch 84: best metric: 0.790
[09/25 22:39:37 visual_prompt]: Training 85 / 100 epoch, with learning rate 3.798797596089351
[09/25 22:39:44 visual_prompt]: Epoch 85 / 100: avg data time: 3.79e-02, avg batch time: 0.4835, average train loss: 1.1634
[09/25 22:39:45 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1676, average loss: 0.8053
[09/25 22:39:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.00	rocauc: 91.35	
[09/25 22:39:45 visual_prompt]: Training 86 / 100 epoch, with learning rate 3.349364905389032
[09/25 22:39:52 visual_prompt]: Epoch 86 / 100: avg data time: 4.87e-02, avg batch time: 0.4935, average train loss: 0.7099
[09/25 22:39:53 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1677, average loss: 0.5472
[09/25 22:39:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.00	rocauc: 91.61	
[09/25 22:39:53 visual_prompt]: Training 87 / 100 epoch, with learning rate 2.9263101785268253
[09/25 22:40:00 visual_prompt]: Epoch 87 / 100: avg data time: 3.78e-02, avg batch time: 0.4834, average train loss: 0.6491
[09/25 22:40:01 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1673, average loss: 1.0285
[09/25 22:40:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 56.00	rocauc: 91.47	
[09/25 22:40:01 visual_prompt]: Training 88 / 100 epoch, with learning rate 2.5301488425208296
[09/25 22:40:08 visual_prompt]: Epoch 88 / 100: avg data time: 3.81e-02, avg batch time: 0.4847, average train loss: 0.7511
[09/25 22:40:09 visual_prompt]: Inference (val):avg data time: 5.66e-05, avg batch time: 0.1677, average loss: 0.3904
[09/25 22:40:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.65	
[09/25 22:40:09 visual_prompt]: Best epoch 88: best metric: 0.820
[09/25 22:40:09 visual_prompt]: Training 89 / 100 epoch, with learning rate 2.1613635589349753
[09/25 22:40:16 visual_prompt]: Epoch 89 / 100: avg data time: 4.44e-02, avg batch time: 0.4894, average train loss: 0.4670
[09/25 22:40:17 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1678, average loss: 0.6681
[09/25 22:40:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.50	rocauc: 91.55	
[09/25 22:40:17 visual_prompt]: Training 90 / 100 epoch, with learning rate 1.820403635830317
[09/25 22:40:24 visual_prompt]: Epoch 90 / 100: avg data time: 5.26e-02, avg batch time: 0.4970, average train loss: 0.5697
[09/25 22:40:25 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1674, average loss: 0.3799
[09/25 22:40:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 91.29	
[09/25 22:40:25 visual_prompt]: Best epoch 90: best metric: 0.845
[09/25 22:40:25 visual_prompt]: Training 91 / 100 epoch, with learning rate 1.507684480352292
[09/25 22:40:32 visual_prompt]: Epoch 91 / 100: avg data time: 5.22e-02, avg batch time: 0.4969, average train loss: 0.4560
[09/25 22:40:33 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1675, average loss: 0.6084
[09/25 22:40:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.00	rocauc: 91.07	
[09/25 22:40:33 visual_prompt]: Training 92 / 100 epoch, with learning rate 1.2235870926211616
[09/25 22:40:40 visual_prompt]: Epoch 92 / 100: avg data time: 4.39e-02, avg batch time: 0.4890, average train loss: 0.5312
[09/25 22:40:41 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1678, average loss: 0.4028
[09/25 22:40:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.08	
[09/25 22:40:41 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.9684576015420276
[09/25 22:40:48 visual_prompt]: Epoch 93 / 100: avg data time: 3.80e-02, avg batch time: 0.4860, average train loss: 0.4466
[09/25 22:40:49 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1676, average loss: 0.3954
[09/25 22:40:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.31	
[09/25 22:40:49 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.7426068431000882
[09/25 22:40:56 visual_prompt]: Epoch 94 / 100: avg data time: 5.15e-02, avg batch time: 0.4958, average train loss: 0.4325
[09/25 22:40:57 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1677, average loss: 0.3840
[09/25 22:40:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.03	
[09/25 22:40:57 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.5463099816548578
[09/25 22:41:04 visual_prompt]: Epoch 95 / 100: avg data time: 4.56e-02, avg batch time: 0.4896, average train loss: 0.4182
[09/25 22:41:05 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1676, average loss: 0.3854
[09/25 22:41:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 90.97	
[09/25 22:41:05 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.3798061746947995
[09/25 22:41:12 visual_prompt]: Epoch 96 / 100: avg data time: 4.20e-02, avg batch time: 0.4875, average train loss: 0.4173
[09/25 22:41:13 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1676, average loss: 0.3951
[09/25 22:41:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 90.96	
[09/25 22:41:13 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.24329828146074095
[09/25 22:41:20 visual_prompt]: Epoch 97 / 100: avg data time: 4.31e-02, avg batch time: 0.4878, average train loss: 0.4083
[09/25 22:41:21 visual_prompt]: Inference (val):avg data time: 2.70e-05, avg batch time: 0.1674, average loss: 0.3939
[09/25 22:41:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 90.91	
[09/25 22:41:21 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.13695261579316775
[09/25 22:41:28 visual_prompt]: Epoch 98 / 100: avg data time: 4.30e-02, avg batch time: 0.4875, average train loss: 0.4106
[09/25 22:41:29 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1675, average loss: 0.3989
[09/25 22:41:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 90.85	
[09/25 22:41:29 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.06089874350439506
[09/25 22:41:36 visual_prompt]: Epoch 99 / 100: avg data time: 3.89e-02, avg batch time: 0.4877, average train loss: 0.4106
[09/25 22:41:37 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1679, average loss: 0.3927
[09/25 22:41:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 90.86	
[09/25 22:41:37 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.015229324522605947
[09/25 22:41:44 visual_prompt]: Epoch 100 / 100: avg data time: 5.23e-02, avg batch time: 0.4959, average train loss: 0.3987
[09/25 22:41:45 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1678, average loss: 0.3948
[09/25 22:41:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 90.85	
[09/25 22:41:45 visual_prompt]: Rank of current process: 0. World size: 1
[09/25 22:41:45 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/25 22:41:45 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/25 22:41:45 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/25 22:41:45 visual_prompt]: Training with config:
[09/25 22:41:45 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr50.0_wd0.0/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 50.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/25 22:41:45 visual_prompt]: Loading training data...
[09/25 22:41:45 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/25 22:41:46 visual_prompt]: Number of images: 800
[09/25 22:41:46 visual_prompt]: Number of classes: 2 / 2
[09/25 22:41:46 visual_prompt]: Loading validation data...
[09/25 22:41:46 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/25 22:41:47 visual_prompt]: Number of images: 200
[09/25 22:41:47 visual_prompt]: Number of classes: 2 / 2
[09/25 22:41:47 visual_prompt]: Constructing models...
[09/25 22:41:49 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/25 22:41:49 visual_prompt]: tuned percent:0.536
[09/25 22:41:49 visual_prompt]: Device used for model: 0
[09/25 22:41:49 visual_prompt]: Setting up Evaluator...
[09/25 22:41:49 visual_prompt]: Setting up Trainer...
[09/25 22:41:49 visual_prompt]: 	Setting up the optimizer...
[09/25 22:41:49 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/25 22:41:56 visual_prompt]: Epoch 1 / 100: avg data time: 4.51e-02, avg batch time: 0.4892, average train loss: 1.9663
[09/25 22:41:57 visual_prompt]: Inference (val):avg data time: 5.02e-05, avg batch time: 0.1669, average loss: 2.0033
[09/25 22:41:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/25 22:41:57 visual_prompt]: Best epoch 1: best metric: 0.520
[09/25 22:41:57 visual_prompt]: Training 2 / 100 epoch, with learning rate 5.0
[09/25 22:42:04 visual_prompt]: Epoch 2 / 100: avg data time: 3.87e-02, avg batch time: 0.4821, average train loss: 31.8473
[09/25 22:42:05 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.1671, average loss: 6.9202
[09/25 22:42:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 66.90	
[09/25 22:42:05 visual_prompt]: Training 3 / 100 epoch, with learning rate 10.0
[09/25 22:42:12 visual_prompt]: Epoch 3 / 100: avg data time: 5.36e-02, avg batch time: 0.4973, average train loss: 23.7210
[09/25 22:42:13 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1670, average loss: 24.3532
[09/25 22:42:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.72	
[09/25 22:42:13 visual_prompt]: Training 4 / 100 epoch, with learning rate 15.0
[09/25 22:42:20 visual_prompt]: Epoch 4 / 100: avg data time: 5.24e-02, avg batch time: 0.4940, average train loss: 34.6387
[09/25 22:42:21 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1673, average loss: 36.2445
[09/25 22:42:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.80	
[09/25 22:42:21 visual_prompt]: Training 5 / 100 epoch, with learning rate 20.0
[09/25 22:42:28 visual_prompt]: Epoch 5 / 100: avg data time: 4.68e-02, avg batch time: 0.4887, average train loss: 53.4175
[09/25 22:42:29 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1673, average loss: 123.6446
[09/25 22:42:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 86.23	
[09/25 22:42:29 visual_prompt]: Training 6 / 100 epoch, with learning rate 25.0
[09/25 22:42:35 visual_prompt]: Epoch 6 / 100: avg data time: 4.08e-02, avg batch time: 0.4791, average train loss: 67.9143
[09/25 22:42:37 visual_prompt]: Inference (val):avg data time: 1.98e-05, avg batch time: 0.1674, average loss: 1.9989
[09/25 22:42:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 71.50	rocauc: 85.80	
[09/25 22:42:37 visual_prompt]: Best epoch 6: best metric: 0.715
[09/25 22:42:37 visual_prompt]: Training 7 / 100 epoch, with learning rate 30.0
[09/25 22:42:44 visual_prompt]: Epoch 7 / 100: avg data time: 5.08e-02, avg batch time: 0.4938, average train loss: 33.7945
[09/25 22:42:45 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.1672, average loss: 11.2179
[09/25 22:42:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.60	
[09/25 22:42:45 visual_prompt]: Training 8 / 100 epoch, with learning rate 35.0
[09/25 22:42:52 visual_prompt]: Epoch 8 / 100: avg data time: 5.33e-02, avg batch time: 0.4930, average train loss: 50.3395
[09/25 22:42:53 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1676, average loss: 20.4211
[09/25 22:42:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.67	
[09/25 22:42:53 visual_prompt]: Training 9 / 100 epoch, with learning rate 40.0
[09/25 22:43:00 visual_prompt]: Epoch 9 / 100: avg data time: 5.30e-02, avg batch time: 0.4920, average train loss: 89.5200
[09/25 22:43:01 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1672, average loss: 38.0701
[09/25 22:43:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.27	
[09/25 22:43:01 visual_prompt]: Training 10 / 100 epoch, with learning rate 45.0
[09/25 22:43:08 visual_prompt]: Epoch 10 / 100: avg data time: 5.19e-02, avg batch time: 0.4910, average train loss: 146.9505
[09/25 22:43:09 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.1670, average loss: 114.4569
[09/25 22:43:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 87.96	
[09/25 22:43:09 visual_prompt]: Training 11 / 100 epoch, with learning rate 50.0
[09/25 22:43:16 visual_prompt]: Epoch 11 / 100: avg data time: 5.35e-02, avg batch time: 0.4945, average train loss: 54.6894
[09/25 22:43:17 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1672, average loss: 159.6810
[09/25 22:43:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 87.23	
[09/25 22:43:17 visual_prompt]: Training 12 / 100 epoch, with learning rate 49.9847706754774
[09/25 22:43:24 visual_prompt]: Epoch 12 / 100: avg data time: 5.13e-02, avg batch time: 0.4912, average train loss: 89.0800
[09/25 22:43:25 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1669, average loss: 96.8698
[09/25 22:43:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 73.68	
[09/25 22:43:25 visual_prompt]: Training 13 / 100 epoch, with learning rate 49.939101256495604
[09/25 22:43:32 visual_prompt]: Epoch 13 / 100: avg data time: 4.94e-02, avg batch time: 0.4893, average train loss: 62.2587
[09/25 22:43:33 visual_prompt]: Inference (val):avg data time: 2.11e-05, avg batch time: 0.1671, average loss: 54.4200
[09/25 22:43:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 87.19	
[09/25 22:43:33 visual_prompt]: Training 14 / 100 epoch, with learning rate 49.86304738420683
[09/25 22:43:40 visual_prompt]: Epoch 14 / 100: avg data time: 5.28e-02, avg batch time: 0.4929, average train loss: 68.5161
[09/25 22:43:41 visual_prompt]: Inference (val):avg data time: 2.00e-05, avg batch time: 0.1672, average loss: 53.2401
[09/25 22:43:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 88.50	
[09/25 22:43:41 visual_prompt]: Training 15 / 100 epoch, with learning rate 49.75670171853926
[09/25 22:43:48 visual_prompt]: Epoch 15 / 100: avg data time: 5.78e-02, avg batch time: 0.4975, average train loss: 142.3764
[09/25 22:43:49 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1671, average loss: 124.7019
[09/25 22:43:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 88.63	
[09/25 22:43:49 visual_prompt]: Training 16 / 100 epoch, with learning rate 49.6201938253052
[09/25 22:43:56 visual_prompt]: Epoch 16 / 100: avg data time: 5.59e-02, avg batch time: 0.4965, average train loss: 108.9931
[09/25 22:43:57 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1674, average loss: 68.2301
[09/25 22:43:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 88.30	
[09/25 22:43:57 visual_prompt]: Training 17 / 100 epoch, with learning rate 49.45369001834514
[09/25 22:44:04 visual_prompt]: Epoch 17 / 100: avg data time: 4.41e-02, avg batch time: 0.4851, average train loss: 80.4185
[09/25 22:44:05 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.1673, average loss: 87.1996
[09/25 22:44:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 88.24	
[09/25 22:44:05 visual_prompt]: Training 18 / 100 epoch, with learning rate 49.25739315689991
[09/25 22:44:12 visual_prompt]: Epoch 18 / 100: avg data time: 5.20e-02, avg batch time: 0.4921, average train loss: 94.6585
[09/25 22:44:13 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1676, average loss: 112.0597
[09/25 22:44:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 88.57	
[09/25 22:44:13 visual_prompt]: Training 19 / 100 epoch, with learning rate 49.03154239845797
[09/25 22:44:20 visual_prompt]: Epoch 19 / 100: avg data time: 4.84e-02, avg batch time: 0.4876, average train loss: 132.0501
[09/25 22:44:21 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1672, average loss: 80.7188
[09/25 22:44:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.85	
[09/25 22:44:21 visual_prompt]: Training 20 / 100 epoch, with learning rate 48.77641290737884
[09/25 22:44:28 visual_prompt]: Epoch 20 / 100: avg data time: 5.71e-02, avg batch time: 0.4959, average train loss: 82.9855
[09/25 22:44:29 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1668, average loss: 91.6074
[09/25 22:44:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 89.27	
[09/25 22:44:29 visual_prompt]: Training 21 / 100 epoch, with learning rate 48.49231551964771
[09/25 22:44:36 visual_prompt]: Epoch 21 / 100: avg data time: 5.20e-02, avg batch time: 0.4919, average train loss: 50.8655
[09/25 22:44:37 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.1670, average loss: 14.9739
[09/25 22:44:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.50	rocauc: 90.01	
[09/25 22:44:37 visual_prompt]: Training 22 / 100 epoch, with learning rate 48.17959636416968
[09/25 22:44:44 visual_prompt]: Epoch 22 / 100: avg data time: 5.21e-02, avg batch time: 0.4946, average train loss: 14.9713
[09/25 22:44:45 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.1672, average loss: 11.7721
[09/25 22:44:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 90.60	
[09/25 22:44:45 visual_prompt]: Training 23 / 100 epoch, with learning rate 47.83863644106502
[09/25 22:44:52 visual_prompt]: Epoch 23 / 100: avg data time: 5.62e-02, avg batch time: 0.4986, average train loss: 12.6336
[09/25 22:44:53 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1671, average loss: 4.6035
[09/25 22:44:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 64.50	rocauc: 90.98	
[09/25 22:44:53 visual_prompt]: Training 24 / 100 epoch, with learning rate 47.46985115747918
[09/25 22:45:00 visual_prompt]: Epoch 24 / 100: avg data time: 5.45e-02, avg batch time: 0.4986, average train loss: 12.1654
[09/25 22:45:02 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1671, average loss: 9.0667
[09/25 22:45:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.00	rocauc: 90.80	
[09/25 22:45:02 visual_prompt]: Training 25 / 100 epoch, with learning rate 47.073689821473174
[09/25 22:45:08 visual_prompt]: Epoch 25 / 100: avg data time: 4.98e-02, avg batch time: 0.4925, average train loss: 7.0457
[09/25 22:45:10 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1672, average loss: 2.1558
[09/25 22:45:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 90.53	
[09/25 22:45:10 visual_prompt]: Best epoch 25: best metric: 0.795
[09/25 22:45:10 visual_prompt]: Training 26 / 100 epoch, with learning rate 46.65063509461097
[09/25 22:45:16 visual_prompt]: Epoch 26 / 100: avg data time: 5.41e-02, avg batch time: 0.4975, average train loss: 10.5105
[09/25 22:45:18 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1677, average loss: 12.2186
[09/25 22:45:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 61.00	rocauc: 90.20	
[09/25 22:45:18 visual_prompt]: Training 27 / 100 epoch, with learning rate 46.20120240391065
[09/25 22:45:24 visual_prompt]: Epoch 27 / 100: avg data time: 5.03e-02, avg batch time: 0.4915, average train loss: 16.0506
[09/25 22:45:26 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1672, average loss: 4.9709
[09/25 22:45:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.00	
[09/25 22:45:26 visual_prompt]: Best epoch 27: best metric: 0.815
[09/25 22:45:26 visual_prompt]: Training 28 / 100 epoch, with learning rate 45.72593931387604
[09/25 22:45:32 visual_prompt]: Epoch 28 / 100: avg data time: 5.38e-02, avg batch time: 0.4955, average train loss: 11.0965
[09/25 22:45:34 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.1673, average loss: 10.6975
[09/25 22:45:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 54.50	rocauc: 91.78	
[09/25 22:45:34 visual_prompt]: Training 29 / 100 epoch, with learning rate 45.22542485937369
[09/25 22:45:40 visual_prompt]: Epoch 29 / 100: avg data time: 5.37e-02, avg batch time: 0.4972, average train loss: 6.7614
[09/25 22:45:42 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1671, average loss: 6.8159
[09/25 22:45:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.00	rocauc: 91.92	
[09/25 22:45:42 visual_prompt]: Training 30 / 100 epoch, with learning rate 44.70026884016804
[09/25 22:45:48 visual_prompt]: Epoch 30 / 100: avg data time: 4.93e-02, avg batch time: 0.4921, average train loss: 5.3583
[09/25 22:45:50 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1673, average loss: 2.4058
[09/25 22:45:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.44	
[09/25 22:45:50 visual_prompt]: Best epoch 30: best metric: 0.850
[09/25 22:45:50 visual_prompt]: Training 31 / 100 epoch, with learning rate 44.15111107797445
[09/25 22:45:57 visual_prompt]: Epoch 31 / 100: avg data time: 5.15e-02, avg batch time: 0.4959, average train loss: 3.7669
[09/25 22:45:58 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1672, average loss: 1.4039
[09/25 22:45:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.12	
[09/25 22:45:58 visual_prompt]: Training 32 / 100 epoch, with learning rate 43.57862063693486
[09/25 22:46:05 visual_prompt]: Epoch 32 / 100: avg data time: 5.25e-02, avg batch time: 0.4958, average train loss: 4.0626
[09/25 22:46:06 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1672, average loss: 4.6988
[09/25 22:46:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 68.00	rocauc: 92.23	
[09/25 22:46:06 visual_prompt]: Training 33 / 100 epoch, with learning rate 42.98349500846628
[09/25 22:46:13 visual_prompt]: Epoch 33 / 100: avg data time: 5.11e-02, avg batch time: 0.4959, average train loss: 2.8310
[09/25 22:46:14 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1675, average loss: 1.9058
[09/25 22:46:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 91.38	
[09/25 22:46:14 visual_prompt]: Training 34 / 100 epoch, with learning rate 42.36645926147493
[09/25 22:46:21 visual_prompt]: Epoch 34 / 100: avg data time: 3.73e-02, avg batch time: 0.4808, average train loss: 1.6552
[09/25 22:46:22 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1677, average loss: 1.2650
[09/25 22:46:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.50	rocauc: 90.80	
[09/25 22:46:22 visual_prompt]: Training 35 / 100 epoch, with learning rate 41.72826515897145
[09/25 22:46:28 visual_prompt]: Epoch 35 / 100: avg data time: 4.16e-02, avg batch time: 0.4865, average train loss: 4.9568
[09/25 22:46:30 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1675, average loss: 25.2730
[09/25 22:46:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 91.76	
[09/25 22:46:30 visual_prompt]: Training 36 / 100 epoch, with learning rate 41.06969024216348
[09/25 22:46:36 visual_prompt]: Epoch 36 / 100: avg data time: 5.37e-02, avg batch time: 0.4979, average train loss: 9.3416
[09/25 22:46:38 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1674, average loss: 3.0556
[09/25 22:46:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.16	
[09/25 22:46:38 visual_prompt]: Training 37 / 100 epoch, with learning rate 40.391536883141455
[09/25 22:46:44 visual_prompt]: Epoch 37 / 100: avg data time: 4.31e-02, avg batch time: 0.4865, average train loss: 3.1083
[09/25 22:46:46 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1676, average loss: 2.4518
[09/25 22:46:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.52	
[09/25 22:46:46 visual_prompt]: Training 38 / 100 epoch, with learning rate 39.69463130731183
[09/25 22:46:52 visual_prompt]: Epoch 38 / 100: avg data time: 5.22e-02, avg batch time: 0.4969, average train loss: 3.0805
[09/25 22:46:54 visual_prompt]: Inference (val):avg data time: 2.14e-05, avg batch time: 0.1669, average loss: 1.3837
[09/25 22:46:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 90.86	
[09/25 22:46:54 visual_prompt]: Training 39 / 100 epoch, with learning rate 38.97982258676867
[09/25 22:47:00 visual_prompt]: Epoch 39 / 100: avg data time: 4.07e-02, avg batch time: 0.4856, average train loss: 7.8562
[09/25 22:47:02 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1672, average loss: 2.2720
[09/25 22:47:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.46	
[09/25 22:47:02 visual_prompt]: Training 40 / 100 epoch, with learning rate 38.24798160583012
[09/25 22:47:08 visual_prompt]: Epoch 40 / 100: avg data time: 3.77e-02, avg batch time: 0.4845, average train loss: 4.1287
[09/25 22:47:09 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1676, average loss: 2.6622
[09/25 22:47:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 90.66	
[09/25 22:47:09 visual_prompt]: Training 41 / 100 epoch, with learning rate 37.5
[09/25 22:47:16 visual_prompt]: Epoch 41 / 100: avg data time: 3.70e-02, avg batch time: 0.4826, average train loss: 2.8891
[09/25 22:47:17 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1674, average loss: 2.1158
[09/25 22:47:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 90.19	
[09/25 22:47:17 visual_prompt]: Training 42 / 100 epoch, with learning rate 36.736789069647266
[09/25 22:47:24 visual_prompt]: Epoch 42 / 100: avg data time: 3.81e-02, avg batch time: 0.4825, average train loss: 3.2621
[09/25 22:47:25 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1677, average loss: 7.7458
[09/25 22:47:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 55.50	rocauc: 90.64	
[09/25 22:47:25 visual_prompt]: Training 43 / 100 epoch, with learning rate 35.959278669726935
[09/25 22:47:32 visual_prompt]: Epoch 43 / 100: avg data time: 5.37e-02, avg batch time: 0.4976, average train loss: 3.0116
[09/25 22:47:33 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1673, average loss: 1.5227
[09/25 22:47:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.20	
[09/25 22:47:33 visual_prompt]: Training 44 / 100 epoch, with learning rate 35.16841607689501
[09/25 22:47:40 visual_prompt]: Epoch 44 / 100: avg data time: 5.53e-02, avg batch time: 0.4989, average train loss: 1.8507
[09/25 22:47:41 visual_prompt]: Inference (val):avg data time: 2.20e-05, avg batch time: 0.1677, average loss: 2.5789
[09/25 22:47:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.00	rocauc: 90.62	
[09/25 22:47:41 visual_prompt]: Training 45 / 100 epoch, with learning rate 34.365164835397806
[09/25 22:47:48 visual_prompt]: Epoch 45 / 100: avg data time: 4.57e-02, avg batch time: 0.4901, average train loss: 2.4151
[09/25 22:47:49 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1675, average loss: 1.3901
[09/25 22:47:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 90.83	
[09/25 22:47:49 visual_prompt]: Training 46 / 100 epoch, with learning rate 33.55050358314172
[09/25 22:47:56 visual_prompt]: Epoch 46 / 100: avg data time: 3.92e-02, avg batch time: 0.4830, average train loss: 1.4887
[09/25 22:47:57 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1674, average loss: 2.6507
[09/25 22:47:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.00	rocauc: 90.57	
[09/25 22:47:57 visual_prompt]: Training 47 / 100 epoch, with learning rate 32.72542485937369
[09/25 22:48:04 visual_prompt]: Epoch 47 / 100: avg data time: 5.11e-02, avg batch time: 0.4949, average train loss: 1.5511
[09/25 22:48:05 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1676, average loss: 1.3342
[09/25 22:48:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 90.85	
[09/25 22:48:05 visual_prompt]: Training 48 / 100 epoch, with learning rate 31.89093389542498
[09/25 22:48:12 visual_prompt]: Epoch 48 / 100: avg data time: 5.14e-02, avg batch time: 0.4955, average train loss: 2.4755
[09/25 22:48:13 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1674, average loss: 1.7398
[09/25 22:48:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.00	rocauc: 90.71	
[09/25 22:48:13 visual_prompt]: Training 49 / 100 epoch, with learning rate 31.04804738999169
[09/25 22:48:20 visual_prompt]: Epoch 49 / 100: avg data time: 5.47e-02, avg batch time: 0.4986, average train loss: 2.1617
[09/25 22:48:21 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1676, average loss: 1.5687
[09/25 22:48:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.00	
[09/25 22:48:21 visual_prompt]: Training 50 / 100 epoch, with learning rate 30.19779227044398
[09/25 22:48:28 visual_prompt]: Epoch 50 / 100: avg data time: 4.66e-02, avg batch time: 0.4915, average train loss: 2.4143
[09/25 22:48:29 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.1678, average loss: 5.2979
[09/25 22:48:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 63.50	rocauc: 90.92	
[09/25 22:48:29 visual_prompt]: Training 51 / 100 epoch, with learning rate 29.341204441673263
[09/25 22:48:36 visual_prompt]: Epoch 51 / 100: avg data time: 5.23e-02, avg batch time: 0.4965, average train loss: 3.0802
[09/25 22:48:37 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1676, average loss: 2.3413
[09/25 22:48:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 90.62	
[09/25 22:48:37 visual_prompt]: Training 52 / 100 epoch, with learning rate 28.479327524001636
[09/25 22:48:44 visual_prompt]: Epoch 52 / 100: avg data time: 5.63e-02, avg batch time: 0.5000, average train loss: 2.1133
[09/25 22:48:45 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1678, average loss: 1.7171
[09/25 22:48:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 90.47	
[09/25 22:48:45 visual_prompt]: Training 53 / 100 epoch, with learning rate 27.61321158169134
[09/25 22:48:52 visual_prompt]: Epoch 53 / 100: avg data time: 5.02e-02, avg batch time: 0.4939, average train loss: 3.3779
[09/25 22:48:53 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1675, average loss: 2.5563
[09/25 22:48:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 90.66	
[09/25 22:48:53 visual_prompt]: Training 54 / 100 epoch, with learning rate 26.74391184360313
[09/25 22:49:00 visual_prompt]: Epoch 54 / 100: avg data time: 4.25e-02, avg batch time: 0.4880, average train loss: 2.4673
[09/25 22:49:01 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1673, average loss: 1.9320
[09/25 22:49:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 90.67	
[09/25 22:49:01 visual_prompt]: Training 55 / 100 epoch, with learning rate 25.872487417562528
[09/25 22:49:08 visual_prompt]: Epoch 55 / 100: avg data time: 5.41e-02, avg batch time: 0.4978, average train loss: 1.6977
[09/25 22:49:09 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1672, average loss: 1.3705
[09/25 22:49:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 90.43	
[09/25 22:49:09 visual_prompt]: Training 56 / 100 epoch, with learning rate 25.0
[09/25 22:49:16 visual_prompt]: Epoch 56 / 100: avg data time: 3.58e-02, avg batch time: 0.4819, average train loss: 0.9854
[09/25 22:49:17 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1676, average loss: 1.0269
[09/25 22:49:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 89.69	
[09/25 22:49:17 visual_prompt]: Training 57 / 100 epoch, with learning rate 24.127512582437483
[09/25 22:49:24 visual_prompt]: Epoch 57 / 100: avg data time: 3.73e-02, avg batch time: 0.4821, average train loss: 1.1682
[09/25 22:49:25 visual_prompt]: Inference (val):avg data time: 2.23e-05, avg batch time: 0.1675, average loss: 0.7543
[09/25 22:49:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 89.74	
[09/25 22:49:25 visual_prompt]: Training 58 / 100 epoch, with learning rate 23.256088156396867
[09/25 22:49:32 visual_prompt]: Epoch 58 / 100: avg data time: 4.25e-02, avg batch time: 0.4876, average train loss: 0.8894
[09/25 22:49:33 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1672, average loss: 1.9816
[09/25 22:49:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.00	rocauc: 89.86	
[09/25 22:49:33 visual_prompt]: Training 59 / 100 epoch, with learning rate 22.38678841830867
[09/25 22:49:40 visual_prompt]: Epoch 59 / 100: avg data time: 5.81e-02, avg batch time: 0.5017, average train loss: 1.6601
[09/25 22:49:41 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1674, average loss: 1.0842
[09/25 22:49:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.50	rocauc: 89.97	
[09/25 22:49:41 visual_prompt]: Training 60 / 100 epoch, with learning rate 21.52067247599837
[09/25 22:49:48 visual_prompt]: Epoch 60 / 100: avg data time: 4.38e-02, avg batch time: 0.4899, average train loss: 1.6880
[09/25 22:49:49 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1674, average loss: 1.3967
[09/25 22:49:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.50	rocauc: 90.53	
[09/25 22:49:49 visual_prompt]: Training 61 / 100 epoch, with learning rate 20.65879555832674
[09/25 22:49:56 visual_prompt]: Epoch 61 / 100: avg data time: 4.49e-02, avg batch time: 0.4896, average train loss: 1.6336
[09/25 22:49:57 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1676, average loss: 2.2274
[09/25 22:49:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.50	rocauc: 90.34	
[09/25 22:49:57 visual_prompt]: Training 62 / 100 epoch, with learning rate 19.80220772955602
[09/25 22:50:04 visual_prompt]: Epoch 62 / 100: avg data time: 5.38e-02, avg batch time: 0.4997, average train loss: 1.2717
[09/25 22:50:05 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1676, average loss: 1.1600
[09/25 22:50:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 90.28	
[09/25 22:50:05 visual_prompt]: Training 63 / 100 epoch, with learning rate 18.95195261000831
[09/25 22:50:12 visual_prompt]: Epoch 63 / 100: avg data time: 4.25e-02, avg batch time: 0.4893, average train loss: 2.0069
[09/25 22:50:13 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1674, average loss: 2.3797
[09/25 22:50:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.00	rocauc: 90.22	
[09/25 22:50:13 visual_prompt]: Training 64 / 100 epoch, with learning rate 18.10906610457502
[09/25 22:50:20 visual_prompt]: Epoch 64 / 100: avg data time: 5.19e-02, avg batch time: 0.4977, average train loss: 1.0676
[09/25 22:50:21 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1673, average loss: 1.8070
[09/25 22:50:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.00	rocauc: 90.14	
[09/25 22:50:21 visual_prompt]: Training 65 / 100 epoch, with learning rate 17.274575140626318
[09/25 22:50:28 visual_prompt]: Epoch 65 / 100: avg data time: 4.08e-02, avg batch time: 0.4871, average train loss: 1.0870
[09/25 22:50:29 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1673, average loss: 0.9975
[09/25 22:50:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 89.67	
[09/25 22:50:29 visual_prompt]: Training 66 / 100 epoch, with learning rate 16.449496416858285
[09/25 22:50:36 visual_prompt]: Epoch 66 / 100: avg data time: 4.12e-02, avg batch time: 0.4861, average train loss: 0.6622
[09/25 22:50:37 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1677, average loss: 1.0188
[09/25 22:50:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.50	rocauc: 89.39	
[09/25 22:50:37 visual_prompt]: Training 67 / 100 epoch, with learning rate 15.634835164602197
[09/25 22:50:44 visual_prompt]: Epoch 67 / 100: avg data time: 5.52e-02, avg batch time: 0.4998, average train loss: 0.5805
[09/25 22:50:45 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1673, average loss: 1.3009
[09/25 22:50:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.50	rocauc: 89.20	
[09/25 22:50:45 visual_prompt]: Training 68 / 100 epoch, with learning rate 14.831583923104999
[09/25 22:50:52 visual_prompt]: Epoch 68 / 100: avg data time: 5.33e-02, avg batch time: 0.4969, average train loss: 1.0030
[09/25 22:50:53 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1678, average loss: 0.7396
[09/25 22:50:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 89.03	
[09/25 22:50:53 visual_prompt]: Training 69 / 100 epoch, with learning rate 14.040721330273062
[09/25 22:51:00 visual_prompt]: Epoch 69 / 100: avg data time: 5.50e-02, avg batch time: 0.4982, average train loss: 0.7894
[09/25 22:51:01 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1673, average loss: 1.4530
[09/25 22:51:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.50	rocauc: 88.67	
[09/25 22:51:01 visual_prompt]: Training 70 / 100 epoch, with learning rate 13.263210930352736
[09/25 22:51:08 visual_prompt]: Epoch 70 / 100: avg data time: 4.24e-02, avg batch time: 0.4874, average train loss: 1.5608
[09/25 22:51:09 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1672, average loss: 0.9896
[09/25 22:51:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.00	rocauc: 89.79	
[09/25 22:51:09 visual_prompt]: Training 71 / 100 epoch, with learning rate 12.500000000000005
[09/25 22:51:16 visual_prompt]: Epoch 71 / 100: avg data time: 5.84e-02, avg batch time: 0.5029, average train loss: 1.4983
[09/25 22:51:17 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1675, average loss: 1.3781
[09/25 22:51:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 90.31	
[09/25 22:51:17 visual_prompt]: Training 72 / 100 epoch, with learning rate 11.75201839416988
[09/25 22:51:24 visual_prompt]: Epoch 72 / 100: avg data time: 4.35e-02, avg batch time: 0.4897, average train loss: 0.9794
[09/25 22:51:25 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1674, average loss: 1.9447
[09/25 22:51:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.00	rocauc: 89.96	
[09/25 22:51:25 visual_prompt]: Training 73 / 100 epoch, with learning rate 11.020177413231332
[09/25 22:51:32 visual_prompt]: Epoch 73 / 100: avg data time: 4.95e-02, avg batch time: 0.4946, average train loss: 0.9922
[09/25 22:51:33 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1676, average loss: 1.3477
[09/25 22:51:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.50	rocauc: 89.32	
[09/25 22:51:33 visual_prompt]: Training 74 / 100 epoch, with learning rate 10.305368692688175
[09/25 22:51:40 visual_prompt]: Epoch 74 / 100: avg data time: 3.94e-02, avg batch time: 0.4858, average train loss: 1.3398
[09/25 22:51:41 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1673, average loss: 0.9748
[09/25 22:51:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 89.66	
[09/25 22:51:41 visual_prompt]: Training 75 / 100 epoch, with learning rate 9.608463116858543
[09/25 22:51:48 visual_prompt]: Epoch 75 / 100: avg data time: 5.35e-02, avg batch time: 0.4974, average train loss: 0.7245
[09/25 22:51:49 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1671, average loss: 0.9531
[09/25 22:51:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 89.65	
[09/25 22:51:49 visual_prompt]: Training 76 / 100 epoch, with learning rate 8.930309757836516
[09/25 22:51:56 visual_prompt]: Epoch 76 / 100: avg data time: 5.73e-02, avg batch time: 0.5008, average train loss: 0.8092
[09/25 22:51:57 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1674, average loss: 1.0992
[09/25 22:51:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 89.49	
[09/25 22:51:57 visual_prompt]: Training 77 / 100 epoch, with learning rate 8.271734841028552
[09/25 22:52:04 visual_prompt]: Epoch 77 / 100: avg data time: 4.74e-02, avg batch time: 0.4924, average train loss: 0.8827
[09/25 22:52:06 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1676, average loss: 1.9989
[09/25 22:52:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.00	rocauc: 89.61	
[09/25 22:52:06 visual_prompt]: Training 78 / 100 epoch, with learning rate 7.633540738525066
[09/25 22:52:12 visual_prompt]: Epoch 78 / 100: avg data time: 4.71e-02, avg batch time: 0.4912, average train loss: 0.6680
[09/25 22:52:14 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1673, average loss: 1.1462
[09/25 22:52:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 89.57	
[09/25 22:52:14 visual_prompt]: Training 79 / 100 epoch, with learning rate 7.016504991533726
[09/25 22:52:20 visual_prompt]: Epoch 79 / 100: avg data time: 4.45e-02, avg batch time: 0.4879, average train loss: 0.5662
[09/25 22:52:22 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1672, average loss: 0.7957
[09/25 22:52:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 89.22	
[09/25 22:52:22 visual_prompt]: Training 80 / 100 epoch, with learning rate 6.4213793630651415
[09/25 22:52:28 visual_prompt]: Epoch 80 / 100: avg data time: 4.53e-02, avg batch time: 0.4907, average train loss: 0.5722
[09/25 22:52:30 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1676, average loss: 0.9275
[09/25 22:52:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.00	rocauc: 88.68	
[09/25 22:52:30 visual_prompt]: Training 81 / 100 epoch, with learning rate 5.848888922025552
[09/25 22:52:36 visual_prompt]: Epoch 81 / 100: avg data time: 4.73e-02, avg batch time: 0.4913, average train loss: 0.6011
[09/25 22:52:38 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1673, average loss: 1.0108
[09/25 22:52:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.00	rocauc: 88.81	
[09/25 22:52:38 visual_prompt]: Training 82 / 100 epoch, with learning rate 5.2997311598319525
[09/25 22:52:44 visual_prompt]: Epoch 82 / 100: avg data time: 4.41e-02, avg batch time: 0.4893, average train loss: 0.5035
[09/25 22:52:46 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1672, average loss: 0.7919
[09/25 22:52:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 89.02	
[09/25 22:52:46 visual_prompt]: Training 83 / 100 epoch, with learning rate 4.774575140626316
[09/25 22:52:52 visual_prompt]: Epoch 83 / 100: avg data time: 4.90e-02, avg batch time: 0.4935, average train loss: 0.4633
[09/25 22:52:54 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1674, average loss: 0.9714
[09/25 22:52:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.50	rocauc: 88.90	
[09/25 22:52:54 visual_prompt]: Training 84 / 100 epoch, with learning rate 4.27406068612396
[09/25 22:53:00 visual_prompt]: Epoch 84 / 100: avg data time: 4.55e-02, avg batch time: 0.4909, average train loss: 0.5300
[09/25 22:53:02 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1673, average loss: 1.4467
[09/25 22:53:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.00	rocauc: 88.92	
[09/25 22:53:02 visual_prompt]: Training 85 / 100 epoch, with learning rate 3.798797596089351
[09/25 22:53:08 visual_prompt]: Epoch 85 / 100: avg data time: 5.47e-02, avg batch time: 0.4988, average train loss: 0.4857
[09/25 22:53:10 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1676, average loss: 0.7062
[09/25 22:53:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.50	rocauc: 88.95	
[09/25 22:53:10 visual_prompt]: Training 86 / 100 epoch, with learning rate 3.349364905389032
[09/25 22:53:16 visual_prompt]: Epoch 86 / 100: avg data time: 4.20e-02, avg batch time: 0.4870, average train loss: 0.4208
[09/25 22:53:18 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1676, average loss: 0.8250
[09/25 22:53:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.50	rocauc: 88.87	
[09/25 22:53:18 visual_prompt]: Training 87 / 100 epoch, with learning rate 2.9263101785268253
[09/25 22:53:24 visual_prompt]: Epoch 87 / 100: avg data time: 3.87e-02, avg batch time: 0.4844, average train loss: 0.4708
[09/25 22:53:26 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1677, average loss: 0.9326
[09/25 22:53:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.00	rocauc: 88.69	
[09/25 22:53:26 visual_prompt]: Training 88 / 100 epoch, with learning rate 2.5301488425208296
[09/25 22:53:32 visual_prompt]: Epoch 88 / 100: avg data time: 4.74e-02, avg batch time: 0.4916, average train loss: 0.4395
[09/25 22:53:34 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1674, average loss: 1.2872
[09/25 22:53:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.00	rocauc: 88.60	
[09/25 22:53:34 visual_prompt]: Training 89 / 100 epoch, with learning rate 2.1613635589349753
[09/25 22:53:40 visual_prompt]: Epoch 89 / 100: avg data time: 5.24e-02, avg batch time: 0.4967, average train loss: 0.4455
[09/25 22:53:42 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1673, average loss: 0.7731
[09/25 22:53:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 88.61	
[09/25 22:53:42 visual_prompt]: Training 90 / 100 epoch, with learning rate 1.820403635830317
[09/25 22:53:48 visual_prompt]: Epoch 90 / 100: avg data time: 5.02e-02, avg batch time: 0.4938, average train loss: 0.4276
[09/25 22:53:50 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1675, average loss: 0.8057
[09/25 22:53:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 88.56	
[09/25 22:53:50 visual_prompt]: Training 91 / 100 epoch, with learning rate 1.507684480352292
[09/25 22:53:56 visual_prompt]: Epoch 91 / 100: avg data time: 4.90e-02, avg batch time: 0.4934, average train loss: 0.3869
[09/25 22:53:58 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1676, average loss: 0.8349
[09/25 22:53:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.00	rocauc: 88.54	
[09/25 22:53:58 visual_prompt]: Training 92 / 100 epoch, with learning rate 1.2235870926211616
[09/25 22:54:05 visual_prompt]: Epoch 92 / 100: avg data time: 5.78e-02, avg batch time: 0.5020, average train loss: 0.4079
[09/25 22:54:06 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1679, average loss: 0.9652
[09/25 22:54:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.00	rocauc: 88.48	
[09/25 22:54:06 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.9684576015420276
[09/25 22:54:13 visual_prompt]: Epoch 93 / 100: avg data time: 4.79e-02, avg batch time: 0.4925, average train loss: 0.3776
[09/25 22:54:14 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1672, average loss: 0.8510
[09/25 22:54:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.00	rocauc: 88.41	
[09/25 22:54:14 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.7426068431000882
[09/25 22:54:21 visual_prompt]: Epoch 94 / 100: avg data time: 4.98e-02, avg batch time: 0.4943, average train loss: 0.4036
[09/25 22:54:22 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1675, average loss: 0.8332
[09/25 22:54:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.00	rocauc: 88.37	
[09/25 22:54:22 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.5463099816548578
[09/25 22:54:29 visual_prompt]: Epoch 95 / 100: avg data time: 5.54e-02, avg batch time: 0.4988, average train loss: 0.4019
[09/25 22:54:30 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1674, average loss: 0.7342
[09/25 22:54:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.50	rocauc: 88.36	
[09/25 22:54:30 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.3798061746947995
[09/25 22:54:37 visual_prompt]: Epoch 96 / 100: avg data time: 5.33e-02, avg batch time: 0.4980, average train loss: 0.4154
[09/25 22:54:38 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1673, average loss: 0.9395
[09/25 22:54:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.50	rocauc: 88.37	
[09/25 22:54:38 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.24329828146074095
[09/25 22:54:45 visual_prompt]: Epoch 97 / 100: avg data time: 4.76e-02, avg batch time: 0.4920, average train loss: 0.4187
[09/25 22:54:46 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1674, average loss: 0.8284
[09/25 22:54:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.00	rocauc: 88.36	
[09/25 22:54:46 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.13695261579316775
[09/25 22:54:53 visual_prompt]: Epoch 98 / 100: avg data time: 5.09e-02, avg batch time: 0.4954, average train loss: 0.4113
[09/25 22:54:55 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1674, average loss: 0.8023
[09/25 22:54:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 88.35	
[09/25 22:54:55 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.06089874350439506
[09/25 22:55:01 visual_prompt]: Epoch 99 / 100: avg data time: 5.49e-02, avg batch time: 0.4980, average train loss: 0.3855
[09/25 22:55:03 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1672, average loss: 0.8248
[09/25 22:55:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.00	rocauc: 88.35	
[09/25 22:55:03 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.015229324522605947
[09/25 22:55:09 visual_prompt]: Epoch 100 / 100: avg data time: 4.18e-02, avg batch time: 0.4849, average train loss: 0.3964
[09/25 22:55:11 visual_prompt]: Inference (val):avg data time: 3.23e-05, avg batch time: 0.1675, average loss: 0.8218
[09/25 22:55:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.00	rocauc: 88.34	
[09/25 22:55:11 visual_prompt]: Rank of current process: 0. World size: 1
[09/25 22:55:11 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/25 22:55:11 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/25 22:55:11 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/25 22:55:11 visual_prompt]: Training with config:
[09/25 22:55:11 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr25.0_wd0.01/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.01, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 25.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/25 22:55:11 visual_prompt]: Loading training data...
[09/25 22:55:11 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/25 22:55:12 visual_prompt]: Number of images: 800
[09/25 22:55:12 visual_prompt]: Number of classes: 2 / 2
[09/25 22:55:12 visual_prompt]: Loading validation data...
[09/25 22:55:12 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/25 22:55:12 visual_prompt]: Number of images: 200
[09/25 22:55:12 visual_prompt]: Number of classes: 2 / 2
[09/25 22:55:12 visual_prompt]: Constructing models...
[09/25 22:55:15 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/25 22:55:15 visual_prompt]: tuned percent:0.536
[09/25 22:55:15 visual_prompt]: Device used for model: 0
[09/25 22:55:15 visual_prompt]: Setting up Evaluator...
[09/25 22:55:15 visual_prompt]: Setting up Trainer...
[09/25 22:55:15 visual_prompt]: 	Setting up the optimizer...
[09/25 22:55:15 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/25 22:55:21 visual_prompt]: Epoch 1 / 100: avg data time: 4.22e-02, avg batch time: 0.4876, average train loss: 1.9774
[09/25 22:55:23 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1669, average loss: 2.0033
[09/25 22:55:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/25 22:55:23 visual_prompt]: Best epoch 1: best metric: 0.520
[09/25 22:55:23 visual_prompt]: Training 2 / 100 epoch, with learning rate 2.5
[09/25 22:55:29 visual_prompt]: Epoch 2 / 100: avg data time: 4.66e-02, avg batch time: 0.4895, average train loss: 14.0440
[09/25 22:55:31 visual_prompt]: Inference (val):avg data time: 3.34e-05, avg batch time: 0.1670, average loss: 1.5605
[09/25 22:55:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 70.78	
[09/25 22:55:31 visual_prompt]: Training 3 / 100 epoch, with learning rate 5.0
[09/25 22:55:37 visual_prompt]: Epoch 3 / 100: avg data time: 4.68e-02, avg batch time: 0.4905, average train loss: 25.7743
[09/25 22:55:39 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1669, average loss: 23.3712
[09/25 22:55:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 59.12	
[09/25 22:55:39 visual_prompt]: Training 4 / 100 epoch, with learning rate 7.5
[09/25 22:55:45 visual_prompt]: Epoch 4 / 100: avg data time: 4.56e-02, avg batch time: 0.4884, average train loss: 24.8620
[09/25 22:55:46 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1670, average loss: 35.2404
[09/25 22:55:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 58.80	
[09/25 22:55:46 visual_prompt]: Training 5 / 100 epoch, with learning rate 10.0
[09/25 22:55:53 visual_prompt]: Epoch 5 / 100: avg data time: 4.16e-02, avg batch time: 0.4859, average train loss: 15.2368
[09/25 22:55:54 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1670, average loss: 15.2029
[09/25 22:55:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 71.70	
[09/25 22:55:54 visual_prompt]: Training 6 / 100 epoch, with learning rate 12.5
[09/25 22:56:01 visual_prompt]: Epoch 6 / 100: avg data time: 4.24e-02, avg batch time: 0.4864, average train loss: 29.7901
[09/25 22:56:02 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1671, average loss: 45.0375
[09/25 22:56:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 72.38	
[09/25 22:56:02 visual_prompt]: Training 7 / 100 epoch, with learning rate 15.0
[09/25 22:56:09 visual_prompt]: Epoch 7 / 100: avg data time: 5.56e-02, avg batch time: 0.4968, average train loss: 29.0432
[09/25 22:56:10 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1669, average loss: 53.6678
[09/25 22:56:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 54.40	
[09/25 22:56:10 visual_prompt]: Training 8 / 100 epoch, with learning rate 17.5
[09/25 22:56:17 visual_prompt]: Epoch 8 / 100: avg data time: 4.99e-02, avg batch time: 0.4936, average train loss: 34.4171
[09/25 22:56:18 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1669, average loss: 10.2661
[09/25 22:56:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 62.63	
[09/25 22:56:18 visual_prompt]: Training 9 / 100 epoch, with learning rate 20.0
[09/25 22:56:25 visual_prompt]: Epoch 9 / 100: avg data time: 4.12e-02, avg batch time: 0.4848, average train loss: 32.6537
[09/25 22:56:26 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1669, average loss: 28.7222
[09/25 22:56:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 63.36	
[09/25 22:56:26 visual_prompt]: Training 10 / 100 epoch, with learning rate 22.5
[09/25 22:56:33 visual_prompt]: Epoch 10 / 100: avg data time: 5.41e-02, avg batch time: 0.4961, average train loss: 62.7613
[09/25 22:56:35 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1674, average loss: 30.3829
[09/25 22:56:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 60.11	
[09/25 22:56:35 visual_prompt]: Training 11 / 100 epoch, with learning rate 25.0
[09/25 22:56:41 visual_prompt]: Epoch 11 / 100: avg data time: 4.67e-02, avg batch time: 0.4876, average train loss: 88.7708
[09/25 22:56:42 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1674, average loss: 7.4317
[09/25 22:56:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 51.00	rocauc: 52.03	
[09/25 22:56:42 visual_prompt]: Training 12 / 100 epoch, with learning rate 24.9923853377387
[09/25 22:56:49 visual_prompt]: Epoch 12 / 100: avg data time: 4.09e-02, avg batch time: 0.4828, average train loss: 68.6902
[09/25 22:56:50 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1673, average loss: 49.4771
[09/25 22:56:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 39.66	
[09/25 22:56:50 visual_prompt]: Training 13 / 100 epoch, with learning rate 24.969550628247802
[09/25 22:56:57 visual_prompt]: Epoch 13 / 100: avg data time: 4.48e-02, avg batch time: 0.4850, average train loss: 54.4221
[09/25 22:56:58 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1673, average loss: 116.2422
[09/25 22:56:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 54.34	
[09/25 22:56:58 visual_prompt]: Training 14 / 100 epoch, with learning rate 24.931523692103415
[09/25 22:57:05 visual_prompt]: Epoch 14 / 100: avg data time: 3.82e-02, avg batch time: 0.4821, average train loss: 43.0280
[09/25 22:57:06 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1673, average loss: 17.2422
[09/25 22:57:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 31.90	
[09/25 22:57:06 visual_prompt]: Training 15 / 100 epoch, with learning rate 24.87835085926963
[09/25 22:57:12 visual_prompt]: Epoch 15 / 100: avg data time: 4.10e-02, avg batch time: 0.4836, average train loss: 38.1014
[09/25 22:57:14 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1677, average loss: 25.0008
[09/25 22:57:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 51.64	
[09/25 22:57:14 visual_prompt]: Training 16 / 100 epoch, with learning rate 24.8100969126526
[09/25 22:57:20 visual_prompt]: Epoch 16 / 100: avg data time: 4.39e-02, avg batch time: 0.4852, average train loss: 75.8832
[09/25 22:57:22 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.1679, average loss: 70.6388
[09/25 22:57:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 49.33	
[09/25 22:57:22 visual_prompt]: Training 17 / 100 epoch, with learning rate 24.72684500917257
[09/25 22:57:28 visual_prompt]: Epoch 17 / 100: avg data time: 4.31e-02, avg batch time: 0.4843, average train loss: 80.4675
[09/25 22:57:30 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1674, average loss: 102.4897
[09/25 22:57:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 62.60	
[09/25 22:57:30 visual_prompt]: Training 18 / 100 epoch, with learning rate 24.628696578449954
[09/25 22:57:36 visual_prompt]: Epoch 18 / 100: avg data time: 3.93e-02, avg batch time: 0.4818, average train loss: 67.7778
[09/25 22:57:37 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1672, average loss: 77.2238
[09/25 22:57:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 76.50	
[09/25 22:57:37 visual_prompt]: Training 19 / 100 epoch, with learning rate 24.515771199228986
[09/25 22:57:44 visual_prompt]: Epoch 19 / 100: avg data time: 3.76e-02, avg batch time: 0.4812, average train loss: 50.8615
[09/25 22:57:45 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1675, average loss: 54.5852
[09/25 22:57:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 45.32	
[09/25 22:57:45 visual_prompt]: Training 20 / 100 epoch, with learning rate 24.38820645368942
[09/25 22:57:52 visual_prompt]: Epoch 20 / 100: avg data time: 4.09e-02, avg batch time: 0.4832, average train loss: 67.1180
[09/25 22:57:53 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1674, average loss: 74.5923
[09/25 22:57:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 69.04	
[09/25 22:57:53 visual_prompt]: Training 21 / 100 epoch, with learning rate 24.246157759823856
[09/25 22:58:00 visual_prompt]: Epoch 21 / 100: avg data time: 5.28e-02, avg batch time: 0.4944, average train loss: 75.7384
[09/25 22:58:01 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1674, average loss: 15.3352
[09/25 22:58:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 51.61	
[09/25 22:58:01 visual_prompt]: Training 22 / 100 epoch, with learning rate 24.08979818208484
[09/25 22:58:08 visual_prompt]: Epoch 22 / 100: avg data time: 5.08e-02, avg batch time: 0.4934, average train loss: 69.2470
[09/25 22:58:09 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1674, average loss: 18.0912
[09/25 22:58:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 48.46	
[09/25 22:58:09 visual_prompt]: Training 23 / 100 epoch, with learning rate 23.91931822053251
[09/25 22:58:16 visual_prompt]: Epoch 23 / 100: avg data time: 5.16e-02, avg batch time: 0.4941, average train loss: 43.5036
[09/25 22:58:18 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1676, average loss: 67.9541
[09/25 22:58:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 62.23	
[09/25 22:58:18 visual_prompt]: Training 24 / 100 epoch, with learning rate 23.73492557873959
[09/25 22:58:24 visual_prompt]: Epoch 24 / 100: avg data time: 4.62e-02, avg batch time: 0.4875, average train loss: 90.9730
[09/25 22:58:25 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1673, average loss: 12.6913
[09/25 22:58:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 68.84	
[09/25 22:58:25 visual_prompt]: Training 25 / 100 epoch, with learning rate 23.536844910736587
[09/25 22:58:32 visual_prompt]: Epoch 25 / 100: avg data time: 3.94e-02, avg batch time: 0.4836, average train loss: 32.4345
[09/25 22:58:33 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1671, average loss: 93.9847
[09/25 22:58:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 32.39	
[09/25 22:58:33 visual_prompt]: Training 26 / 100 epoch, with learning rate 23.325317547305485
[09/25 22:58:40 visual_prompt]: Epoch 26 / 100: avg data time: 4.61e-02, avg batch time: 0.4895, average train loss: 55.9535
[09/25 22:58:41 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1672, average loss: 19.0517
[09/25 22:58:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 16.34	
[09/25 22:58:41 visual_prompt]: Training 27 / 100 epoch, with learning rate 23.100601201955325
[09/25 22:58:48 visual_prompt]: Epoch 27 / 100: avg data time: 4.82e-02, avg batch time: 0.4908, average train loss: 41.9279
[09/25 22:58:49 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1675, average loss: 15.7857
[09/25 22:58:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 67.99	
[09/25 22:58:49 visual_prompt]: Training 28 / 100 epoch, with learning rate 22.86296965693802
[09/25 22:58:56 visual_prompt]: Epoch 28 / 100: avg data time: 4.44e-02, avg batch time: 0.4861, average train loss: 55.1752
[09/25 22:58:57 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1668, average loss: 5.1883
[09/25 22:58:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.79	
[09/25 22:58:57 visual_prompt]: Training 29 / 100 epoch, with learning rate 22.612712429686844
[09/25 22:59:04 visual_prompt]: Epoch 29 / 100: avg data time: 5.31e-02, avg batch time: 0.4960, average train loss: 51.4177
[09/25 22:59:05 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1673, average loss: 37.0608
[09/25 22:59:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 30.31	
[09/25 22:59:05 visual_prompt]: Training 30 / 100 epoch, with learning rate 22.35013442008402
[09/25 22:59:12 visual_prompt]: Epoch 30 / 100: avg data time: 5.37e-02, avg batch time: 0.4957, average train loss: 42.8575
[09/25 22:59:13 visual_prompt]: Inference (val):avg data time: 4.04e-05, avg batch time: 0.1673, average loss: 7.6046
[09/25 22:59:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 50.34	
[09/25 22:59:13 visual_prompt]: Training 31 / 100 epoch, with learning rate 22.075555538987224
[09/25 22:59:20 visual_prompt]: Epoch 31 / 100: avg data time: 3.94e-02, avg batch time: 0.4831, average train loss: 38.4859
[09/25 22:59:21 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1671, average loss: 73.7956
[09/25 22:59:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 60.65	
[09/25 22:59:21 visual_prompt]: Training 32 / 100 epoch, with learning rate 21.78931031846743
[09/25 22:59:28 visual_prompt]: Epoch 32 / 100: avg data time: 4.76e-02, avg batch time: 0.4894, average train loss: 40.0858
[09/25 22:59:29 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1676, average loss: 51.1379
[09/25 22:59:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 40.00	rocauc: 26.13	
[09/25 22:59:29 visual_prompt]: Training 33 / 100 epoch, with learning rate 21.49174750423314
[09/25 22:59:36 visual_prompt]: Epoch 33 / 100: avg data time: 4.19e-02, avg batch time: 0.4849, average train loss: 37.9391
[09/25 22:59:37 visual_prompt]: Inference (val):avg data time: 4.09e-05, avg batch time: 0.1673, average loss: 39.1641
[09/25 22:59:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 17.04	
[09/25 22:59:37 visual_prompt]: Training 34 / 100 epoch, with learning rate 21.183229630737465
[09/25 22:59:44 visual_prompt]: Epoch 34 / 100: avg data time: 4.79e-02, avg batch time: 0.4893, average train loss: 34.2196
[09/25 22:59:45 visual_prompt]: Inference (val):avg data time: 2.76e-05, avg batch time: 0.1669, average loss: 28.2570
[09/25 22:59:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 68.20	
[09/25 22:59:45 visual_prompt]: Training 35 / 100 epoch, with learning rate 20.864132579485727
[09/25 22:59:52 visual_prompt]: Epoch 35 / 100: avg data time: 3.88e-02, avg batch time: 0.4805, average train loss: 51.4951
[09/25 22:59:53 visual_prompt]: Inference (val):avg data time: 3.15e-05, avg batch time: 0.1674, average loss: 42.5995
[09/25 22:59:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 37.54	
[09/25 22:59:53 visual_prompt]: Training 36 / 100 epoch, with learning rate 20.53484512108174
[09/25 23:00:00 visual_prompt]: Epoch 36 / 100: avg data time: 4.40e-02, avg batch time: 0.4865, average train loss: 49.5693
[09/25 23:00:01 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1673, average loss: 3.7305
[09/25 23:00:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 51.00	rocauc: 63.98	
[09/25 23:00:01 visual_prompt]: Training 37 / 100 epoch, with learning rate 20.195768441570728
[09/25 23:00:08 visual_prompt]: Epoch 37 / 100: avg data time: 5.37e-02, avg batch time: 0.4972, average train loss: 65.5249
[09/25 23:00:09 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1677, average loss: 43.1587
[09/25 23:00:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 31.96	
[09/25 23:00:09 visual_prompt]: Training 38 / 100 epoch, with learning rate 19.847315653655915
[09/25 23:00:16 visual_prompt]: Epoch 38 / 100: avg data time: 5.06e-02, avg batch time: 0.4921, average train loss: 60.3342
[09/25 23:00:17 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1674, average loss: 8.4153
[09/25 23:00:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 54.72	
[09/25 23:00:17 visual_prompt]: Training 39 / 100 epoch, with learning rate 19.489911293384335
[09/25 23:00:24 visual_prompt]: Epoch 39 / 100: avg data time: 5.30e-02, avg batch time: 0.4948, average train loss: 52.1071
[09/25 23:00:25 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1671, average loss: 63.2374
[09/25 23:00:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 72.98	
[09/25 23:00:25 visual_prompt]: Training 40 / 100 epoch, with learning rate 19.12399080291506
[09/25 23:00:32 visual_prompt]: Epoch 40 / 100: avg data time: 5.47e-02, avg batch time: 0.4956, average train loss: 72.3329
[09/25 23:00:33 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1677, average loss: 96.3874
[09/25 23:00:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 29.57	
[09/25 23:00:33 visual_prompt]: Training 41 / 100 epoch, with learning rate 18.75
[09/25 23:00:40 visual_prompt]: Epoch 41 / 100: avg data time: 5.35e-02, avg batch time: 0.4950, average train loss: 65.7110
[09/25 23:00:42 visual_prompt]: Inference (val):avg data time: 3.13e-05, avg batch time: 0.1671, average loss: 47.6109
[09/25 23:00:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 43.50	rocauc: 37.11	
[09/25 23:00:42 visual_prompt]: Training 42 / 100 epoch, with learning rate 18.368394534823633
[09/25 23:00:48 visual_prompt]: Epoch 42 / 100: avg data time: 5.43e-02, avg batch time: 0.4949, average train loss: 67.1232
[09/25 23:00:50 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1673, average loss: 8.8274
[09/25 23:00:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 58.49	
[09/25 23:00:50 visual_prompt]: Training 43 / 100 epoch, with learning rate 17.979639334863467
[09/25 23:00:56 visual_prompt]: Epoch 43 / 100: avg data time: 3.82e-02, avg batch time: 0.4825, average train loss: 62.8792
[09/25 23:00:57 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1676, average loss: 93.0722
[09/25 23:00:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 45.24	
[09/25 23:00:57 visual_prompt]: Training 44 / 100 epoch, with learning rate 17.584208038447503
[09/25 23:01:04 visual_prompt]: Epoch 44 / 100: avg data time: 4.95e-02, avg batch time: 0.4916, average train loss: 60.3778
[09/25 23:01:06 visual_prompt]: Inference (val):avg data time: 3.20e-05, avg batch time: 0.1674, average loss: 27.1570
[09/25 23:01:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 60.68	
[09/25 23:01:06 visual_prompt]: Training 45 / 100 epoch, with learning rate 17.182582417698903
[09/25 23:01:12 visual_prompt]: Epoch 45 / 100: avg data time: 5.30e-02, avg batch time: 0.4939, average train loss: 44.6075
[09/25 23:01:14 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1677, average loss: 7.5947
[09/25 23:01:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.63	
[09/25 23:01:14 visual_prompt]: Training 46 / 100 epoch, with learning rate 16.77525179157086
[09/25 23:01:20 visual_prompt]: Epoch 46 / 100: avg data time: 4.59e-02, avg batch time: 0.4889, average train loss: 34.2354
[09/25 23:01:22 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1674, average loss: 27.9735
[09/25 23:01:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 26.33	
[09/25 23:01:22 visual_prompt]: Training 47 / 100 epoch, with learning rate 16.362712429686844
[09/25 23:01:28 visual_prompt]: Epoch 47 / 100: avg data time: 5.37e-02, avg batch time: 0.4961, average train loss: 34.8926
[09/25 23:01:30 visual_prompt]: Inference (val):avg data time: 2.98e-05, avg batch time: 0.1672, average loss: 110.6717
[09/25 23:01:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 74.72	
[09/25 23:01:30 visual_prompt]: Training 48 / 100 epoch, with learning rate 15.94546694771249
[09/25 23:01:36 visual_prompt]: Epoch 48 / 100: avg data time: 4.23e-02, avg batch time: 0.4835, average train loss: 59.9583
[09/25 23:01:38 visual_prompt]: Inference (val):avg data time: 3.10e-05, avg batch time: 0.1674, average loss: 40.7791
[09/25 23:01:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 61.11	
[09/25 23:01:38 visual_prompt]: Training 49 / 100 epoch, with learning rate 15.524023694995845
[09/25 23:01:44 visual_prompt]: Epoch 49 / 100: avg data time: 5.32e-02, avg batch time: 0.4960, average train loss: 48.8210
[09/25 23:01:46 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1676, average loss: 128.2012
[09/25 23:01:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 19.86	
[09/25 23:01:46 visual_prompt]: Training 50 / 100 epoch, with learning rate 15.09889613522199
[09/25 23:01:52 visual_prompt]: Epoch 50 / 100: avg data time: 4.51e-02, avg batch time: 0.4865, average train loss: 74.1710
[09/25 23:01:54 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1677, average loss: 53.2056
[09/25 23:01:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 65.74	
[09/25 23:01:54 visual_prompt]: Training 51 / 100 epoch, with learning rate 14.670602220836631
[09/25 23:02:00 visual_prompt]: Epoch 51 / 100: avg data time: 5.24e-02, avg batch time: 0.4945, average train loss: 63.7057
[09/25 23:02:02 visual_prompt]: Inference (val):avg data time: 6.04e-05, avg batch time: 0.1676, average loss: 16.5316
[09/25 23:02:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 70.47	
[09/25 23:02:02 visual_prompt]: Training 52 / 100 epoch, with learning rate 14.239663762000818
[09/25 23:02:09 visual_prompt]: Epoch 52 / 100: avg data time: 6.07e-02, avg batch time: 0.5209, average train loss: 36.0135
[09/25 23:02:10 visual_prompt]: Inference (val):avg data time: 3.78e-05, avg batch time: 0.1671, average loss: 0.8560
[09/25 23:02:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.50	rocauc: 45.25	
[09/25 23:02:10 visual_prompt]: Training 53 / 100 epoch, with learning rate 13.80660579084567
[09/25 23:02:17 visual_prompt]: Epoch 53 / 100: avg data time: 5.36e-02, avg batch time: 0.4964, average train loss: 18.7524
[09/25 23:02:18 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1677, average loss: 3.0835
[09/25 23:02:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 14.08	
[09/25 23:02:18 visual_prompt]: Training 54 / 100 epoch, with learning rate 13.371955921801565
[09/25 23:02:25 visual_prompt]: Epoch 54 / 100: avg data time: 5.30e-02, avg batch time: 0.4956, average train loss: 33.8029
[09/25 23:02:26 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1673, average loss: 64.5497
[09/25 23:02:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 45.76	
[09/25 23:02:26 visual_prompt]: Training 55 / 100 epoch, with learning rate 12.936243708781264
[09/25 23:02:33 visual_prompt]: Epoch 55 / 100: avg data time: 5.67e-02, avg batch time: 0.4991, average train loss: 34.8467
[09/25 23:02:34 visual_prompt]: Inference (val):avg data time: 3.14e-05, avg batch time: 0.1678, average loss: 32.4186
[09/25 23:02:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 73.35	
[09/25 23:02:34 visual_prompt]: Training 56 / 100 epoch, with learning rate 12.5
[09/25 23:02:41 visual_prompt]: Epoch 56 / 100: avg data time: 5.55e-02, avg batch time: 0.4989, average train loss: 33.6476
[09/25 23:02:42 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1673, average loss: 27.8332
[09/25 23:02:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 68.38	
[09/25 23:02:42 visual_prompt]: Training 57 / 100 epoch, with learning rate 12.063756291218741
[09/25 23:02:49 visual_prompt]: Epoch 57 / 100: avg data time: 4.24e-02, avg batch time: 0.4870, average train loss: 29.4021
[09/25 23:02:50 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1679, average loss: 95.8611
[09/25 23:02:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 42.65	
[09/25 23:02:50 visual_prompt]: Training 58 / 100 epoch, with learning rate 11.628044078198434
[09/25 23:02:57 visual_prompt]: Epoch 58 / 100: avg data time: 5.62e-02, avg batch time: 0.4983, average train loss: 33.3693
[09/25 23:02:58 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1676, average loss: 78.9110
[09/25 23:02:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 46.72	
[09/25 23:02:58 visual_prompt]: Training 59 / 100 epoch, with learning rate 11.193394209154334
[09/25 23:03:05 visual_prompt]: Epoch 59 / 100: avg data time: 5.15e-02, avg batch time: 0.4927, average train loss: 63.3748
[09/25 23:03:06 visual_prompt]: Inference (val):avg data time: 3.04e-05, avg batch time: 0.1673, average loss: 25.4217
[09/25 23:03:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 37.71	
[09/25 23:03:06 visual_prompt]: Training 60 / 100 epoch, with learning rate 10.760336237999185
[09/25 23:03:13 visual_prompt]: Epoch 60 / 100: avg data time: 5.39e-02, avg batch time: 0.4968, average train loss: 20.4010
[09/25 23:03:15 visual_prompt]: Inference (val):avg data time: 3.25e-05, avg batch time: 0.1675, average loss: 54.0277
[09/25 23:03:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 38.46	
[09/25 23:03:15 visual_prompt]: Training 61 / 100 epoch, with learning rate 10.32939777916337
[09/25 23:03:21 visual_prompt]: Epoch 61 / 100: avg data time: 4.60e-02, avg batch time: 0.4887, average train loss: 29.1445
[09/25 23:03:23 visual_prompt]: Inference (val):avg data time: 3.34e-05, avg batch time: 0.1675, average loss: 28.3960
[09/25 23:03:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 17.27	
[09/25 23:03:23 visual_prompt]: Training 62 / 100 epoch, with learning rate 9.90110386477801
[09/25 23:03:29 visual_prompt]: Epoch 62 / 100: avg data time: 5.58e-02, avg batch time: 0.4993, average train loss: 20.7160
[09/25 23:03:31 visual_prompt]: Inference (val):avg data time: 3.03e-05, avg batch time: 0.1673, average loss: 0.7004
[09/25 23:03:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 55.00	rocauc: 52.39	
[09/25 23:03:31 visual_prompt]: Best epoch 62: best metric: 0.550
[09/25 23:03:31 visual_prompt]: Training 63 / 100 epoch, with learning rate 9.475976305004155
[09/25 23:03:37 visual_prompt]: Epoch 63 / 100: avg data time: 4.89e-02, avg batch time: 0.4907, average train loss: 31.4009
[09/25 23:03:39 visual_prompt]: Inference (val):avg data time: 2.79e-05, avg batch time: 0.1675, average loss: 59.4852
[09/25 23:03:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 44.32	
[09/25 23:03:39 visual_prompt]: Training 64 / 100 epoch, with learning rate 9.05453305228751
[09/25 23:03:45 visual_prompt]: Epoch 64 / 100: avg data time: 3.87e-02, avg batch time: 0.4819, average train loss: 29.7861
[09/25 23:03:47 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1671, average loss: 33.2906
[09/25 23:03:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 36.74	
[09/25 23:03:47 visual_prompt]: Training 65 / 100 epoch, with learning rate 8.637287570313159
[09/25 23:03:53 visual_prompt]: Epoch 65 / 100: avg data time: 4.93e-02, avg batch time: 0.4929, average train loss: 26.8047
[09/25 23:03:54 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1673, average loss: 8.0746
[09/25 23:03:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 65.80	
[09/25 23:03:54 visual_prompt]: Training 66 / 100 epoch, with learning rate 8.224748208429142
[09/25 23:04:01 visual_prompt]: Epoch 66 / 100: avg data time: 4.11e-02, avg batch time: 0.4845, average train loss: 17.0934
[09/25 23:04:02 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1672, average loss: 11.2850
[09/25 23:04:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 46.67	
[09/25 23:04:02 visual_prompt]: Training 67 / 100 epoch, with learning rate 7.817417582301099
[09/25 23:04:09 visual_prompt]: Epoch 67 / 100: avg data time: 5.63e-02, avg batch time: 0.4996, average train loss: 16.4192
[09/25 23:04:10 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1675, average loss: 4.8615
[09/25 23:04:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 78.33	
[09/25 23:04:10 visual_prompt]: Training 68 / 100 epoch, with learning rate 7.415791961552499
[09/25 23:04:17 visual_prompt]: Epoch 68 / 100: avg data time: 5.46e-02, avg batch time: 0.4975, average train loss: 26.2119
[09/25 23:04:19 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1672, average loss: 6.6809
[09/25 23:04:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 47.71	
[09/25 23:04:19 visual_prompt]: Training 69 / 100 epoch, with learning rate 7.020360665136531
[09/25 23:04:25 visual_prompt]: Epoch 69 / 100: avg data time: 5.53e-02, avg batch time: 0.4985, average train loss: 8.2562
[09/25 23:04:27 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1673, average loss: 1.8722
[09/25 23:04:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 67.23	
[09/25 23:04:27 visual_prompt]: Training 70 / 100 epoch, with learning rate 6.631605465176368
[09/25 23:04:33 visual_prompt]: Epoch 70 / 100: avg data time: 4.56e-02, avg batch time: 0.4904, average train loss: 17.9421
[09/25 23:04:35 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1671, average loss: 11.9200
[09/25 23:04:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 37.91	
[09/25 23:04:35 visual_prompt]: Training 71 / 100 epoch, with learning rate 6.250000000000003
[09/25 23:04:41 visual_prompt]: Epoch 71 / 100: avg data time: 5.20e-02, avg batch time: 0.4956, average train loss: 16.6666
[09/25 23:04:43 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1673, average loss: 14.1380
[09/25 23:04:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 50.00	rocauc: 34.13	
[09/25 23:04:43 visual_prompt]: Training 72 / 100 epoch, with learning rate 5.87600919708494
[09/25 23:04:49 visual_prompt]: Epoch 72 / 100: avg data time: 4.74e-02, avg batch time: 0.4918, average train loss: 13.8251
[09/25 23:04:51 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1674, average loss: 4.4683
[09/25 23:04:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 78.90	
[09/25 23:04:51 visual_prompt]: Training 73 / 100 epoch, with learning rate 5.510088706615666
[09/25 23:04:58 visual_prompt]: Epoch 73 / 100: avg data time: 5.87e-02, avg batch time: 0.5030, average train loss: 10.6264
[09/25 23:04:59 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1677, average loss: 13.8808
[09/25 23:04:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 41.89	
[09/25 23:04:59 visual_prompt]: Training 74 / 100 epoch, with learning rate 5.1526843463440875
[09/25 23:05:06 visual_prompt]: Epoch 74 / 100: avg data time: 5.84e-02, avg batch time: 0.5026, average train loss: 7.5008
[09/25 23:05:07 visual_prompt]: Inference (val):avg data time: 3.37e-05, avg batch time: 0.1673, average loss: 2.1586
[09/25 23:05:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 61.49	
[09/25 23:05:07 visual_prompt]: Training 75 / 100 epoch, with learning rate 4.804231558429271
[09/25 23:05:14 visual_prompt]: Epoch 75 / 100: avg data time: 4.70e-02, avg batch time: 0.4915, average train loss: 6.8051
[09/25 23:05:15 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1671, average loss: 13.8863
[09/25 23:05:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 54.60	
[09/25 23:05:15 visual_prompt]: Training 76 / 100 epoch, with learning rate 4.465154878918258
[09/25 23:05:22 visual_prompt]: Epoch 76 / 100: avg data time: 4.56e-02, avg batch time: 0.4902, average train loss: 12.4332
[09/25 23:05:23 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1677, average loss: 23.7970
[09/25 23:05:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 48.51	
[09/25 23:05:23 visual_prompt]: Training 77 / 100 epoch, with learning rate 4.135867420514276
[09/25 23:05:30 visual_prompt]: Epoch 77 / 100: avg data time: 5.27e-02, avg batch time: 0.4975, average train loss: 6.2994
[09/25 23:05:31 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.1672, average loss: 40.1513
[09/25 23:05:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 75.61	
[09/25 23:05:31 visual_prompt]: Training 78 / 100 epoch, with learning rate 3.816770369262533
[09/25 23:05:38 visual_prompt]: Epoch 78 / 100: avg data time: 4.24e-02, avg batch time: 0.4870, average train loss: 9.9448
[09/25 23:05:39 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1670, average loss: 3.5037
[09/25 23:05:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 51.54	
[09/25 23:05:39 visual_prompt]: Training 79 / 100 epoch, with learning rate 3.508252495766863
[09/25 23:05:46 visual_prompt]: Epoch 79 / 100: avg data time: 5.07e-02, avg batch time: 0.4958, average train loss: 9.4803
[09/25 23:05:47 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1673, average loss: 2.5951
[09/25 23:05:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 63.99	
[09/25 23:05:47 visual_prompt]: Training 80 / 100 epoch, with learning rate 3.2106896815325707
[09/25 23:05:54 visual_prompt]: Epoch 80 / 100: avg data time: 5.01e-02, avg batch time: 0.4958, average train loss: 4.0276
[09/25 23:05:55 visual_prompt]: Inference (val):avg data time: 2.79e-05, avg batch time: 0.1674, average loss: 4.5983
[09/25 23:05:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 63.17	
[09/25 23:05:55 visual_prompt]: Training 81 / 100 epoch, with learning rate 2.924444461012776
[09/25 23:06:02 visual_prompt]: Epoch 81 / 100: avg data time: 5.68e-02, avg batch time: 0.5002, average train loss: 2.6367
[09/25 23:06:03 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1675, average loss: 1.3410
[09/25 23:06:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 52.03	
[09/25 23:06:03 visual_prompt]: Training 82 / 100 epoch, with learning rate 2.6498655799159763
[09/25 23:06:10 visual_prompt]: Epoch 82 / 100: avg data time: 4.88e-02, avg batch time: 0.4928, average train loss: 3.0240
[09/25 23:06:11 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1671, average loss: 2.7236
[09/25 23:06:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 51.25	
[09/25 23:06:11 visual_prompt]: Training 83 / 100 epoch, with learning rate 2.387287570313158
[09/25 23:06:18 visual_prompt]: Epoch 83 / 100: avg data time: 4.95e-02, avg batch time: 0.4939, average train loss: 2.0207
[09/25 23:06:19 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1674, average loss: 6.5718
[09/25 23:06:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 69.32	
[09/25 23:06:19 visual_prompt]: Training 84 / 100 epoch, with learning rate 2.13703034306198
[09/25 23:06:26 visual_prompt]: Epoch 84 / 100: avg data time: 5.46e-02, avg batch time: 0.4987, average train loss: 1.6659
[09/25 23:06:28 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1672, average loss: 1.9113
[09/25 23:06:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 23.43	
[09/25 23:06:28 visual_prompt]: Training 85 / 100 epoch, with learning rate 1.8993987980446756
[09/25 23:06:34 visual_prompt]: Epoch 85 / 100: avg data time: 4.90e-02, avg batch time: 0.4928, average train loss: 1.5364
[09/25 23:06:35 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1672, average loss: 3.0512
[09/25 23:06:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 53.87	
[09/25 23:06:35 visual_prompt]: Training 86 / 100 epoch, with learning rate 1.674682452694516
[09/25 23:06:42 visual_prompt]: Epoch 86 / 100: avg data time: 4.80e-02, avg batch time: 0.4924, average train loss: 1.4079
[09/25 23:06:44 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1674, average loss: 2.6881
[09/25 23:06:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 72.44	
[09/25 23:06:44 visual_prompt]: Training 87 / 100 epoch, with learning rate 1.4631550892634126
[09/25 23:06:50 visual_prompt]: Epoch 87 / 100: avg data time: 4.92e-02, avg batch time: 0.4938, average train loss: 1.5677
[09/25 23:06:52 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1674, average loss: 0.6867
[09/25 23:06:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 79.64	
[09/25 23:06:52 visual_prompt]: Training 88 / 100 epoch, with learning rate 1.2650744212604148
[09/25 23:06:58 visual_prompt]: Epoch 88 / 100: avg data time: 4.83e-02, avg batch time: 0.4920, average train loss: 0.9157
[09/25 23:07:00 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1673, average loss: 0.7904
[09/25 23:07:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 45.01	
[09/25 23:07:00 visual_prompt]: Training 89 / 100 epoch, with learning rate 1.0806817794674877
[09/25 23:07:06 visual_prompt]: Epoch 89 / 100: avg data time: 3.98e-02, avg batch time: 0.4844, average train loss: 0.9821
[09/25 23:07:08 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1672, average loss: 0.8257
[09/25 23:07:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 63.78	
[09/25 23:07:08 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.9102018179151585
[09/25 23:07:14 visual_prompt]: Epoch 90 / 100: avg data time: 5.12e-02, avg batch time: 0.4948, average train loss: 0.8340
[09/25 23:07:16 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1678, average loss: 0.8243
[09/25 23:07:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 78.41	
[09/25 23:07:16 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.753842240176146
[09/25 23:07:22 visual_prompt]: Epoch 91 / 100: avg data time: 4.29e-02, avg batch time: 0.4879, average train loss: 0.7484
[09/25 23:07:24 visual_prompt]: Inference (val):avg data time: 4.80e-05, avg batch time: 0.1677, average loss: 0.8060
[09/25 23:07:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 87.92	
[09/25 23:07:24 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.6117935463105808
[09/25 23:07:30 visual_prompt]: Epoch 92 / 100: avg data time: 5.42e-02, avg batch time: 0.4991, average train loss: 0.7913
[09/25 23:07:32 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1674, average loss: 0.6928
[09/25 23:07:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 70.71	
[09/25 23:07:32 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.4842288007710138
[09/25 23:07:38 visual_prompt]: Epoch 93 / 100: avg data time: 4.87e-02, avg batch time: 0.4936, average train loss: 0.7299
[09/25 23:07:40 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1675, average loss: 0.7005
[09/25 23:07:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 83.49	
[09/25 23:07:40 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.3713034215500441
[09/25 23:07:46 visual_prompt]: Epoch 94 / 100: avg data time: 5.21e-02, avg batch time: 0.4971, average train loss: 0.7240
[09/25 23:07:48 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1673, average loss: 0.7012
[09/25 23:07:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 80.61	
[09/25 23:07:48 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.2731549908274289
[09/25 23:07:54 visual_prompt]: Epoch 95 / 100: avg data time: 4.99e-02, avg batch time: 0.4943, average train loss: 0.7282
[09/25 23:07:56 visual_prompt]: Inference (val):avg data time: 2.07e-05, avg batch time: 0.1673, average loss: 0.6927
[09/25 23:07:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.97	
[09/25 23:07:56 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.18990308734739975
[09/25 23:08:02 visual_prompt]: Epoch 96 / 100: avg data time: 4.48e-02, avg batch time: 0.4894, average train loss: 0.6985
[09/25 23:08:04 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1674, average loss: 1.9163
[09/25 23:08:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.72	
[09/25 23:08:04 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.12164914073037048
[09/25 23:08:10 visual_prompt]: Epoch 97 / 100: avg data time: 5.03e-02, avg batch time: 0.4941, average train loss: 0.8066
[09/25 23:08:12 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1671, average loss: 0.6875
[09/25 23:08:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 80.70	
[09/25 23:08:12 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.06847630789658388
[09/25 23:08:18 visual_prompt]: Epoch 98 / 100: avg data time: 5.03e-02, avg batch time: 0.4934, average train loss: 0.6929
[09/25 23:08:20 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1673, average loss: 0.6773
[09/25 23:08:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 79.21	
[09/25 23:08:20 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.03044937175219753
[09/25 23:08:26 visual_prompt]: Epoch 99 / 100: avg data time: 4.38e-02, avg batch time: 0.4898, average train loss: 0.6828
[09/25 23:08:28 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1671, average loss: 0.6645
[09/25 23:08:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 68.50	rocauc: 80.41	
[09/25 23:08:28 visual_prompt]: Best epoch 99: best metric: 0.685
[09/25 23:08:28 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0076146622613029735
[09/25 23:08:34 visual_prompt]: Epoch 100 / 100: avg data time: 3.77e-02, avg batch time: 0.4829, average train loss: 0.6743
[09/25 23:08:36 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1676, average loss: 0.6614
[09/25 23:08:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.00	rocauc: 83.15	
[09/25 23:08:36 visual_prompt]: Best epoch 100: best metric: 0.700
[09/25 23:08:36 visual_prompt]: Rank of current process: 0. World size: 1
[09/25 23:08:36 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/25 23:08:36 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/25 23:08:36 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/25 23:08:36 visual_prompt]: Training with config:
[09/25 23:08:36 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr25.0_wd0.001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 25.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/25 23:08:36 visual_prompt]: Loading training data...
[09/25 23:08:36 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/25 23:08:37 visual_prompt]: Number of images: 800
[09/25 23:08:37 visual_prompt]: Number of classes: 2 / 2
[09/25 23:08:37 visual_prompt]: Loading validation data...
[09/25 23:08:37 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/25 23:08:37 visual_prompt]: Number of images: 200
[09/25 23:08:37 visual_prompt]: Number of classes: 2 / 2
[09/25 23:08:37 visual_prompt]: Constructing models...
[09/25 23:08:40 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/25 23:08:40 visual_prompt]: tuned percent:0.536
[09/25 23:08:40 visual_prompt]: Device used for model: 0
[09/25 23:08:40 visual_prompt]: Setting up Evaluator...
[09/25 23:08:40 visual_prompt]: Setting up Trainer...
[09/25 23:08:40 visual_prompt]: 	Setting up the optimizer...
[09/25 23:08:40 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/25 23:08:46 visual_prompt]: Epoch 1 / 100: avg data time: 5.06e-02, avg batch time: 0.4943, average train loss: 1.9857
[09/25 23:08:48 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1668, average loss: 2.0033
[09/25 23:08:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/25 23:08:48 visual_prompt]: Best epoch 1: best metric: 0.520
[09/25 23:08:48 visual_prompt]: Training 2 / 100 epoch, with learning rate 2.5
[09/25 23:08:55 visual_prompt]: Epoch 2 / 100: avg data time: 5.63e-02, avg batch time: 0.4991, average train loss: 18.8155
[09/25 23:08:56 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1669, average loss: 4.9890
[09/25 23:08:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.43	
[09/25 23:08:56 visual_prompt]: Training 3 / 100 epoch, with learning rate 5.0
[09/25 23:09:02 visual_prompt]: Epoch 3 / 100: avg data time: 3.99e-02, avg batch time: 0.4809, average train loss: 40.3942
[09/25 23:09:04 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1672, average loss: 10.7418
[09/25 23:09:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 70.85	
[09/25 23:09:04 visual_prompt]: Training 4 / 100 epoch, with learning rate 7.5
[09/25 23:09:10 visual_prompt]: Epoch 4 / 100: avg data time: 3.96e-02, avg batch time: 0.4830, average train loss: 26.4441
[09/25 23:09:12 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1673, average loss: 32.8680
[09/25 23:09:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 79.61	
[09/25 23:09:12 visual_prompt]: Training 5 / 100 epoch, with learning rate 10.0
[09/25 23:09:18 visual_prompt]: Epoch 5 / 100: avg data time: 5.39e-02, avg batch time: 0.4962, average train loss: 19.0176
[09/25 23:09:20 visual_prompt]: Inference (val):avg data time: 4.35e-05, avg batch time: 0.1675, average loss: 17.8505
[09/25 23:09:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 35.29	
[09/25 23:09:20 visual_prompt]: Training 6 / 100 epoch, with learning rate 12.5
[09/25 23:09:26 visual_prompt]: Epoch 6 / 100: avg data time: 4.83e-02, avg batch time: 0.4922, average train loss: 24.8485
[09/25 23:09:28 visual_prompt]: Inference (val):avg data time: 2.79e-05, avg batch time: 0.1671, average loss: 67.1720
[09/25 23:09:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 87.38	
[09/25 23:09:28 visual_prompt]: Training 7 / 100 epoch, with learning rate 15.0
[09/25 23:09:34 visual_prompt]: Epoch 7 / 100: avg data time: 4.81e-02, avg batch time: 0.4901, average train loss: 33.7161
[09/25 23:09:36 visual_prompt]: Inference (val):avg data time: 2.73e-05, avg batch time: 0.1673, average loss: 44.9048
[09/25 23:09:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 29.68	
[09/25 23:09:36 visual_prompt]: Training 8 / 100 epoch, with learning rate 17.5
[09/25 23:09:43 visual_prompt]: Epoch 8 / 100: avg data time: 5.01e-02, avg batch time: 0.4921, average train loss: 27.1705
[09/25 23:09:44 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1669, average loss: 7.3562
[09/25 23:09:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 61.77	
[09/25 23:09:44 visual_prompt]: Training 9 / 100 epoch, with learning rate 20.0
[09/25 23:09:50 visual_prompt]: Epoch 9 / 100: avg data time: 3.81e-02, avg batch time: 0.4811, average train loss: 46.7406
[09/25 23:09:52 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1677, average loss: 7.0400
[09/25 23:09:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 40.50	rocauc: 25.88	
[09/25 23:09:52 visual_prompt]: Training 10 / 100 epoch, with learning rate 22.5
[09/25 23:09:58 visual_prompt]: Epoch 10 / 100: avg data time: 4.62e-02, avg batch time: 0.4891, average train loss: 39.8748
[09/25 23:10:00 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1674, average loss: 3.4112
[09/25 23:10:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 41.96	
[09/25 23:10:00 visual_prompt]: Training 11 / 100 epoch, with learning rate 25.0
[09/25 23:10:06 visual_prompt]: Epoch 11 / 100: avg data time: 4.41e-02, avg batch time: 0.4873, average train loss: 27.5464
[09/25 23:10:08 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1673, average loss: 70.3205
[09/25 23:10:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 36.89	
[09/25 23:10:08 visual_prompt]: Training 12 / 100 epoch, with learning rate 24.9923853377387
[09/25 23:10:14 visual_prompt]: Epoch 12 / 100: avg data time: 4.92e-02, avg batch time: 0.4892, average train loss: 56.3566
[09/25 23:10:16 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1675, average loss: 53.7126
[09/25 23:10:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 61.82	
[09/25 23:10:16 visual_prompt]: Training 13 / 100 epoch, with learning rate 24.969550628247802
[09/25 23:10:23 visual_prompt]: Epoch 13 / 100: avg data time: 6.06e-02, avg batch time: 0.4998, average train loss: 72.3331
[09/25 23:10:24 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1671, average loss: 77.1087
[09/25 23:10:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 23.61	
[09/25 23:10:24 visual_prompt]: Training 14 / 100 epoch, with learning rate 24.931523692103415
[09/25 23:10:31 visual_prompt]: Epoch 14 / 100: avg data time: 4.71e-02, avg batch time: 0.4892, average train loss: 56.0261
[09/25 23:10:32 visual_prompt]: Inference (val):avg data time: 2.73e-05, avg batch time: 0.1673, average loss: 43.9869
[09/25 23:10:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 60.61	
[09/25 23:10:32 visual_prompt]: Training 15 / 100 epoch, with learning rate 24.87835085926963
[09/25 23:10:39 visual_prompt]: Epoch 15 / 100: avg data time: 4.30e-02, avg batch time: 0.4849, average train loss: 44.0489
[09/25 23:10:40 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1670, average loss: 82.3206
[09/25 23:10:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 53.89	
[09/25 23:10:40 visual_prompt]: Training 16 / 100 epoch, with learning rate 24.8100969126526
[09/25 23:10:47 visual_prompt]: Epoch 16 / 100: avg data time: 4.45e-02, avg batch time: 0.4850, average train loss: 80.5990
[09/25 23:10:48 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1674, average loss: 39.4054
[09/25 23:10:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 55.26	
[09/25 23:10:48 visual_prompt]: Training 17 / 100 epoch, with learning rate 24.72684500917257
[09/25 23:10:55 visual_prompt]: Epoch 17 / 100: avg data time: 4.67e-02, avg batch time: 0.4907, average train loss: 26.4793
[09/25 23:10:56 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1675, average loss: 66.7481
[09/25 23:10:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 36.25	
[09/25 23:10:56 visual_prompt]: Training 18 / 100 epoch, with learning rate 24.628696578449954
[09/25 23:11:03 visual_prompt]: Epoch 18 / 100: avg data time: 5.50e-02, avg batch time: 0.4954, average train loss: 63.3274
[09/25 23:11:04 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1669, average loss: 28.1373
[09/25 23:11:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 38.45	
[09/25 23:11:04 visual_prompt]: Training 19 / 100 epoch, with learning rate 24.515771199228986
[09/25 23:11:11 visual_prompt]: Epoch 19 / 100: avg data time: 4.98e-02, avg batch time: 0.4931, average train loss: 53.6125
[09/25 23:11:12 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1669, average loss: 1.1307
[09/25 23:11:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.50	rocauc: 59.61	
[09/25 23:11:12 visual_prompt]: Best epoch 19: best metric: 0.525
[09/25 23:11:12 visual_prompt]: Training 20 / 100 epoch, with learning rate 24.38820645368942
[09/25 23:11:19 visual_prompt]: Epoch 20 / 100: avg data time: 4.82e-02, avg batch time: 0.4890, average train loss: 63.6498
[09/25 23:11:20 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1671, average loss: 68.8051
[09/25 23:11:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 50.74	
[09/25 23:11:20 visual_prompt]: Training 21 / 100 epoch, with learning rate 24.246157759823856
[09/25 23:11:27 visual_prompt]: Epoch 21 / 100: avg data time: 4.16e-02, avg batch time: 0.4846, average train loss: 56.7515
[09/25 23:11:28 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1670, average loss: 42.2855
[09/25 23:11:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 46.82	
[09/25 23:11:28 visual_prompt]: Training 22 / 100 epoch, with learning rate 24.08979818208484
[09/25 23:11:35 visual_prompt]: Epoch 22 / 100: avg data time: 5.64e-02, avg batch time: 0.4987, average train loss: 46.1525
[09/25 23:11:36 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1676, average loss: 112.8083
[09/25 23:11:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 50.50	rocauc: 42.78	
[09/25 23:11:36 visual_prompt]: Training 23 / 100 epoch, with learning rate 23.91931822053251
[09/25 23:11:43 visual_prompt]: Epoch 23 / 100: avg data time: 4.01e-02, avg batch time: 0.4826, average train loss: 59.7451
[09/25 23:11:44 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1675, average loss: 42.4844
[09/25 23:11:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 71.99	
[09/25 23:11:44 visual_prompt]: Training 24 / 100 epoch, with learning rate 23.73492557873959
[09/25 23:11:51 visual_prompt]: Epoch 24 / 100: avg data time: 4.83e-02, avg batch time: 0.4905, average train loss: 32.4675
[09/25 23:11:52 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1673, average loss: 78.8691
[09/25 23:11:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 62.01	
[09/25 23:11:52 visual_prompt]: Training 25 / 100 epoch, with learning rate 23.536844910736587
[09/25 23:11:59 visual_prompt]: Epoch 25 / 100: avg data time: 5.06e-02, avg batch time: 0.4930, average train loss: 45.2010
[09/25 23:12:00 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1677, average loss: 48.2136
[09/25 23:12:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 55.27	
[09/25 23:12:00 visual_prompt]: Training 26 / 100 epoch, with learning rate 23.325317547305485
[09/25 23:12:07 visual_prompt]: Epoch 26 / 100: avg data time: 4.91e-02, avg batch time: 0.4911, average train loss: 56.3191
[09/25 23:12:08 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1674, average loss: 12.2289
[09/25 23:12:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 73.81	
[09/25 23:12:08 visual_prompt]: Training 27 / 100 epoch, with learning rate 23.100601201955325
[09/25 23:12:15 visual_prompt]: Epoch 27 / 100: avg data time: 4.98e-02, avg batch time: 0.4935, average train loss: 33.8524
[09/25 23:12:16 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1673, average loss: 30.2990
[09/25 23:12:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 67.25	
[09/25 23:12:16 visual_prompt]: Training 28 / 100 epoch, with learning rate 22.86296965693802
[09/25 23:12:23 visual_prompt]: Epoch 28 / 100: avg data time: 4.85e-02, avg batch time: 0.4911, average train loss: 54.3622
[09/25 23:12:24 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1674, average loss: 38.4167
[09/25 23:12:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 49.85	
[09/25 23:12:24 visual_prompt]: Training 29 / 100 epoch, with learning rate 22.612712429686844
[09/25 23:12:31 visual_prompt]: Epoch 29 / 100: avg data time: 4.59e-02, avg batch time: 0.4880, average train loss: 45.1447
[09/25 23:12:32 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.1673, average loss: 6.0532
[09/25 23:12:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 36.36	
[09/25 23:12:32 visual_prompt]: Training 30 / 100 epoch, with learning rate 22.35013442008402
[09/25 23:12:39 visual_prompt]: Epoch 30 / 100: avg data time: 4.97e-02, avg batch time: 0.4918, average train loss: 46.6567
[09/25 23:12:40 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1672, average loss: 16.4781
[09/25 23:12:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 54.82	
[09/25 23:12:40 visual_prompt]: Training 31 / 100 epoch, with learning rate 22.075555538987224
[09/25 23:12:47 visual_prompt]: Epoch 31 / 100: avg data time: 5.69e-02, avg batch time: 0.4983, average train loss: 37.0366
[09/25 23:12:48 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1672, average loss: 33.1568
[09/25 23:12:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 35.89	
[09/25 23:12:48 visual_prompt]: Training 32 / 100 epoch, with learning rate 21.78931031846743
[09/25 23:12:55 visual_prompt]: Epoch 32 / 100: avg data time: 6.04e-02, avg batch time: 0.5050, average train loss: 25.0217
[09/25 23:12:57 visual_prompt]: Inference (val):avg data time: 2.04e-05, avg batch time: 0.1672, average loss: 58.6130
[09/25 23:12:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.12	
[09/25 23:12:57 visual_prompt]: Training 33 / 100 epoch, with learning rate 21.49174750423314
[09/25 23:13:03 visual_prompt]: Epoch 33 / 100: avg data time: 3.74e-02, avg batch time: 0.4800, average train loss: 44.1975
[09/25 23:13:04 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1671, average loss: 59.7105
[09/25 23:13:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 82.73	
[09/25 23:13:04 visual_prompt]: Training 34 / 100 epoch, with learning rate 21.183229630737465
[09/25 23:13:11 visual_prompt]: Epoch 34 / 100: avg data time: 3.98e-02, avg batch time: 0.4829, average train loss: 48.4824
[09/25 23:13:12 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1674, average loss: 14.6708
[09/25 23:13:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 23.79	
[09/25 23:13:12 visual_prompt]: Training 35 / 100 epoch, with learning rate 20.864132579485727
[09/25 23:13:19 visual_prompt]: Epoch 35 / 100: avg data time: 3.96e-02, avg batch time: 0.4812, average train loss: 50.8065
[09/25 23:13:20 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1676, average loss: 85.5804
[09/25 23:13:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 83.53	
[09/25 23:13:20 visual_prompt]: Training 36 / 100 epoch, with learning rate 20.53484512108174
[09/25 23:13:27 visual_prompt]: Epoch 36 / 100: avg data time: 4.29e-02, avg batch time: 0.4867, average train loss: 63.4766
[09/25 23:13:28 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1675, average loss: 32.0790
[09/25 23:13:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 50.52	
[09/25 23:13:28 visual_prompt]: Training 37 / 100 epoch, with learning rate 20.195768441570728
[09/25 23:13:35 visual_prompt]: Epoch 37 / 100: avg data time: 4.61e-02, avg batch time: 0.4870, average train loss: 57.0755
[09/25 23:13:36 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1675, average loss: 20.4870
[09/25 23:13:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 55.00	rocauc: 70.53	
[09/25 23:13:36 visual_prompt]: Best epoch 37: best metric: 0.550
[09/25 23:13:36 visual_prompt]: Training 38 / 100 epoch, with learning rate 19.847315653655915
[09/25 23:13:43 visual_prompt]: Epoch 38 / 100: avg data time: 3.95e-02, avg batch time: 0.4826, average train loss: 44.9586
[09/25 23:13:44 visual_prompt]: Inference (val):avg data time: 4.66e-05, avg batch time: 0.1678, average loss: 8.3373
[09/25 23:13:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 78.63	
[09/25 23:13:44 visual_prompt]: Training 39 / 100 epoch, with learning rate 19.489911293384335
[09/25 23:13:50 visual_prompt]: Epoch 39 / 100: avg data time: 4.01e-02, avg batch time: 0.4826, average train loss: 31.9002
[09/25 23:13:52 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1675, average loss: 224.6295
[09/25 23:13:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 44.62	
[09/25 23:13:52 visual_prompt]: Training 40 / 100 epoch, with learning rate 19.12399080291506
[09/25 23:13:58 visual_prompt]: Epoch 40 / 100: avg data time: 3.83e-02, avg batch time: 0.4806, average train loss: 68.1116
[09/25 23:14:00 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1670, average loss: 50.3101
[09/25 23:14:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 75.31	
[09/25 23:14:00 visual_prompt]: Training 41 / 100 epoch, with learning rate 18.75
[09/25 23:14:06 visual_prompt]: Epoch 41 / 100: avg data time: 5.36e-02, avg batch time: 0.4953, average train loss: 36.0454
[09/25 23:14:08 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1672, average loss: 16.8378
[09/25 23:14:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 56.92	
[09/25 23:14:08 visual_prompt]: Training 42 / 100 epoch, with learning rate 18.368394534823633
[09/25 23:14:14 visual_prompt]: Epoch 42 / 100: avg data time: 4.59e-02, avg batch time: 0.4900, average train loss: 32.4559
[09/25 23:14:16 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1676, average loss: 26.6373
[09/25 23:14:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 36.41	
[09/25 23:14:16 visual_prompt]: Training 43 / 100 epoch, with learning rate 17.979639334863467
[09/25 23:14:23 visual_prompt]: Epoch 43 / 100: avg data time: 4.92e-02, avg batch time: 0.4914, average train loss: 39.4203
[09/25 23:14:24 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1677, average loss: 143.1199
[09/25 23:14:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 68.84	
[09/25 23:14:24 visual_prompt]: Training 44 / 100 epoch, with learning rate 17.584208038447503
[09/25 23:14:30 visual_prompt]: Epoch 44 / 100: avg data time: 4.24e-02, avg batch time: 0.4842, average train loss: 57.9961
[09/25 23:14:32 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1673, average loss: 0.9765
[09/25 23:14:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 51.00	rocauc: 54.21	
[09/25 23:14:32 visual_prompt]: Training 45 / 100 epoch, with learning rate 17.182582417698903
[09/25 23:14:38 visual_prompt]: Epoch 45 / 100: avg data time: 4.10e-02, avg batch time: 0.4831, average train loss: 36.7803
[09/25 23:14:40 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1674, average loss: 46.4630
[09/25 23:14:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 71.17	
[09/25 23:14:40 visual_prompt]: Training 46 / 100 epoch, with learning rate 16.77525179157086
[09/25 23:14:46 visual_prompt]: Epoch 46 / 100: avg data time: 3.83e-02, avg batch time: 0.4819, average train loss: 26.0935
[09/25 23:14:48 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1673, average loss: 18.7638
[09/25 23:14:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.02	
[09/25 23:14:48 visual_prompt]: Training 47 / 100 epoch, with learning rate 16.362712429686844
[09/25 23:14:54 visual_prompt]: Epoch 47 / 100: avg data time: 5.56e-02, avg batch time: 0.4980, average train loss: 35.1799
[09/25 23:14:56 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1675, average loss: 63.5022
[09/25 23:14:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 53.87	
[09/25 23:14:56 visual_prompt]: Training 48 / 100 epoch, with learning rate 15.94546694771249
[09/25 23:15:02 visual_prompt]: Epoch 48 / 100: avg data time: 4.58e-02, avg batch time: 0.4874, average train loss: 46.1998
[09/25 23:15:04 visual_prompt]: Inference (val):avg data time: 4.86e-05, avg batch time: 0.1673, average loss: 2.2982
[09/25 23:15:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 43.70	
[09/25 23:15:04 visual_prompt]: Training 49 / 100 epoch, with learning rate 15.524023694995845
[09/25 23:15:10 visual_prompt]: Epoch 49 / 100: avg data time: 5.05e-02, avg batch time: 0.4927, average train loss: 23.0854
[09/25 23:15:12 visual_prompt]: Inference (val):avg data time: 3.50e-05, avg batch time: 0.1677, average loss: 7.2344
[09/25 23:15:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 40.59	
[09/25 23:15:12 visual_prompt]: Training 50 / 100 epoch, with learning rate 15.09889613522199
[09/25 23:15:19 visual_prompt]: Epoch 50 / 100: avg data time: 5.04e-02, avg batch time: 0.4945, average train loss: 26.5166
[09/25 23:15:20 visual_prompt]: Inference (val):avg data time: 3.03e-05, avg batch time: 0.1675, average loss: 1.5226
[09/25 23:15:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 61.69	
[09/25 23:15:20 visual_prompt]: Training 51 / 100 epoch, with learning rate 14.670602220836631
[09/25 23:15:27 visual_prompt]: Epoch 51 / 100: avg data time: 4.32e-02, avg batch time: 0.4874, average train loss: 21.8264
[09/25 23:15:28 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1676, average loss: 70.6346
[09/25 23:15:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 64.91	
[09/25 23:15:28 visual_prompt]: Training 52 / 100 epoch, with learning rate 14.239663762000818
[09/25 23:15:35 visual_prompt]: Epoch 52 / 100: avg data time: 4.46e-02, avg batch time: 0.4880, average train loss: 57.0949
[09/25 23:15:36 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1669, average loss: 18.0917
[09/25 23:15:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 57.36	
[09/25 23:15:36 visual_prompt]: Training 53 / 100 epoch, with learning rate 13.80660579084567
[09/25 23:15:43 visual_prompt]: Epoch 53 / 100: avg data time: 4.90e-02, avg batch time: 0.4898, average train loss: 32.9336
[09/25 23:15:44 visual_prompt]: Inference (val):avg data time: 3.10e-05, avg batch time: 0.1675, average loss: 23.9182
[09/25 23:15:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 53.66	
[09/25 23:15:44 visual_prompt]: Training 54 / 100 epoch, with learning rate 13.371955921801565
[09/25 23:15:51 visual_prompt]: Epoch 54 / 100: avg data time: 4.43e-02, avg batch time: 0.4894, average train loss: 26.8801
[09/25 23:15:52 visual_prompt]: Inference (val):avg data time: 4.94e-05, avg batch time: 0.1678, average loss: 84.6397
[09/25 23:15:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 79.83	
[09/25 23:15:52 visual_prompt]: Training 55 / 100 epoch, with learning rate 12.936243708781264
[09/25 23:15:59 visual_prompt]: Epoch 55 / 100: avg data time: 5.55e-02, avg batch time: 0.4984, average train loss: 46.0273
[09/25 23:16:00 visual_prompt]: Inference (val):avg data time: 4.67e-05, avg batch time: 0.1671, average loss: 19.3505
[09/25 23:16:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 49.67	
[09/25 23:16:00 visual_prompt]: Training 56 / 100 epoch, with learning rate 12.5
[09/25 23:16:07 visual_prompt]: Epoch 56 / 100: avg data time: 5.12e-02, avg batch time: 0.4929, average train loss: 34.7096
[09/25 23:16:08 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1676, average loss: 22.3152
[09/25 23:16:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 62.25	
[09/25 23:16:08 visual_prompt]: Training 57 / 100 epoch, with learning rate 12.063756291218741
[09/25 23:16:15 visual_prompt]: Epoch 57 / 100: avg data time: 4.87e-02, avg batch time: 0.4932, average train loss: 15.7287
[09/25 23:16:16 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1674, average loss: 42.1933
[09/25 23:16:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 68.82	
[09/25 23:16:16 visual_prompt]: Training 58 / 100 epoch, with learning rate 11.628044078198434
[09/25 23:16:23 visual_prompt]: Epoch 58 / 100: avg data time: 5.14e-02, avg batch time: 0.4957, average train loss: 14.5399
[09/25 23:16:24 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1675, average loss: 5.5613
[09/25 23:16:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.18	
[09/25 23:16:24 visual_prompt]: Training 59 / 100 epoch, with learning rate 11.193394209154334
[09/25 23:16:31 visual_prompt]: Epoch 59 / 100: avg data time: 4.30e-02, avg batch time: 0.4874, average train loss: 11.0480
[09/25 23:16:32 visual_prompt]: Inference (val):avg data time: 3.17e-05, avg batch time: 0.1677, average loss: 13.0297
[09/25 23:16:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 60.58	
[09/25 23:16:32 visual_prompt]: Training 60 / 100 epoch, with learning rate 10.760336237999185
[09/25 23:16:39 visual_prompt]: Epoch 60 / 100: avg data time: 5.14e-02, avg batch time: 0.4941, average train loss: 25.5399
[09/25 23:16:40 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1677, average loss: 34.7161
[09/25 23:16:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 71.40	
[09/25 23:16:40 visual_prompt]: Training 61 / 100 epoch, with learning rate 10.32939777916337
[09/25 23:16:47 visual_prompt]: Epoch 61 / 100: avg data time: 4.41e-02, avg batch time: 0.4892, average train loss: 22.3856
[09/25 23:16:48 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1671, average loss: 9.7196
[09/25 23:16:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 81.17	
[09/25 23:16:48 visual_prompt]: Training 62 / 100 epoch, with learning rate 9.90110386477801
[09/25 23:16:55 visual_prompt]: Epoch 62 / 100: avg data time: 5.38e-02, avg batch time: 0.4972, average train loss: 16.3549
[09/25 23:16:57 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1675, average loss: 7.3591
[09/25 23:16:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 82.84	
[09/25 23:16:57 visual_prompt]: Training 63 / 100 epoch, with learning rate 9.475976305004155
[09/25 23:17:03 visual_prompt]: Epoch 63 / 100: avg data time: 4.52e-02, avg batch time: 0.4892, average train loss: 16.8030
[09/25 23:17:05 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1675, average loss: 1.6345
[09/25 23:17:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 81.98	
[09/25 23:17:05 visual_prompt]: Training 64 / 100 epoch, with learning rate 9.05453305228751
[09/25 23:17:11 visual_prompt]: Epoch 64 / 100: avg data time: 4.90e-02, avg batch time: 0.4935, average train loss: 15.4630
[09/25 23:17:13 visual_prompt]: Inference (val):avg data time: 3.14e-05, avg batch time: 0.1674, average loss: 23.1172
[09/25 23:17:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 61.23	
[09/25 23:17:13 visual_prompt]: Training 65 / 100 epoch, with learning rate 8.637287570313159
[09/25 23:17:19 visual_prompt]: Epoch 65 / 100: avg data time: 4.36e-02, avg batch time: 0.4892, average train loss: 9.4190
[09/25 23:17:21 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1673, average loss: 3.2618
[09/25 23:17:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 80.91	
[09/25 23:17:21 visual_prompt]: Training 66 / 100 epoch, with learning rate 8.224748208429142
[09/25 23:17:27 visual_prompt]: Epoch 66 / 100: avg data time: 4.36e-02, avg batch time: 0.4872, average train loss: 27.7983
[09/25 23:17:29 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1673, average loss: 4.3594
[09/25 23:17:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 49.71	
[09/25 23:17:29 visual_prompt]: Training 67 / 100 epoch, with learning rate 7.817417582301099
[09/25 23:17:35 visual_prompt]: Epoch 67 / 100: avg data time: 4.48e-02, avg batch time: 0.4870, average train loss: 21.8035
[09/25 23:17:37 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1674, average loss: 1.8167
[09/25 23:17:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 57.29	
[09/25 23:17:37 visual_prompt]: Training 68 / 100 epoch, with learning rate 7.415791961552499
[09/25 23:17:43 visual_prompt]: Epoch 68 / 100: avg data time: 3.96e-02, avg batch time: 0.4839, average train loss: 17.1646
[09/25 23:17:44 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1677, average loss: 11.1607
[09/25 23:17:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 32.03	
[09/25 23:17:44 visual_prompt]: Training 69 / 100 epoch, with learning rate 7.020360665136531
[09/25 23:17:51 visual_prompt]: Epoch 69 / 100: avg data time: 4.58e-02, avg batch time: 0.4897, average train loss: 13.6129
[09/25 23:17:52 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1673, average loss: 19.6850
[09/25 23:17:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.49	
[09/25 23:17:52 visual_prompt]: Training 70 / 100 epoch, with learning rate 6.631605465176368
[09/25 23:17:59 visual_prompt]: Epoch 70 / 100: avg data time: 3.85e-02, avg batch time: 0.4828, average train loss: 4.7055
[09/25 23:18:00 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1673, average loss: 5.1689
[09/25 23:18:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.42	
[09/25 23:18:00 visual_prompt]: Training 71 / 100 epoch, with learning rate 6.250000000000003
[09/25 23:18:07 visual_prompt]: Epoch 71 / 100: avg data time: 5.06e-02, avg batch time: 0.4952, average train loss: 7.1230
[09/25 23:18:08 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1670, average loss: 8.1954
[09/25 23:18:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 16.65	
[09/25 23:18:08 visual_prompt]: Training 72 / 100 epoch, with learning rate 5.87600919708494
[09/25 23:18:15 visual_prompt]: Epoch 72 / 100: avg data time: 5.10e-02, avg batch time: 0.4947, average train loss: 15.9218
[09/25 23:18:16 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1678, average loss: 4.1353
[09/25 23:18:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 34.20	
[09/25 23:18:16 visual_prompt]: Training 73 / 100 epoch, with learning rate 5.510088706615666
[09/25 23:18:23 visual_prompt]: Epoch 73 / 100: avg data time: 4.16e-02, avg batch time: 0.4863, average train loss: 11.0888
[09/25 23:18:24 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1673, average loss: 10.8515
[09/25 23:18:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.64	
[09/25 23:18:24 visual_prompt]: Training 74 / 100 epoch, with learning rate 5.1526843463440875
[09/25 23:18:31 visual_prompt]: Epoch 74 / 100: avg data time: 4.12e-02, avg batch time: 0.4870, average train loss: 9.2579
[09/25 23:18:32 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1674, average loss: 2.1176
[09/25 23:18:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.21	
[09/25 23:18:32 visual_prompt]: Training 75 / 100 epoch, with learning rate 4.804231558429271
[09/25 23:18:39 visual_prompt]: Epoch 75 / 100: avg data time: 4.51e-02, avg batch time: 0.4899, average train loss: 18.4355
[09/25 23:18:40 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1674, average loss: 11.5407
[09/25 23:18:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 87.64	
[09/25 23:18:40 visual_prompt]: Training 76 / 100 epoch, with learning rate 4.465154878918258
[09/25 23:18:47 visual_prompt]: Epoch 76 / 100: avg data time: 4.68e-02, avg batch time: 0.4914, average train loss: 7.6521
[09/25 23:18:48 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1674, average loss: 17.2931
[09/25 23:18:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 82.53	
[09/25 23:18:48 visual_prompt]: Training 77 / 100 epoch, with learning rate 4.135867420514276
[09/25 23:18:55 visual_prompt]: Epoch 77 / 100: avg data time: 4.51e-02, avg batch time: 0.4914, average train loss: 7.2868
[09/25 23:18:56 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1674, average loss: 3.3049
[09/25 23:18:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 68.51	
[09/25 23:18:56 visual_prompt]: Training 78 / 100 epoch, with learning rate 3.816770369262533
[09/25 23:19:03 visual_prompt]: Epoch 78 / 100: avg data time: 3.73e-02, avg batch time: 0.4840, average train loss: 4.3313
[09/25 23:19:04 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1672, average loss: 7.8502
[09/25 23:19:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 78.65	
[09/25 23:19:04 visual_prompt]: Training 79 / 100 epoch, with learning rate 3.508252495766863
[09/25 23:19:11 visual_prompt]: Epoch 79 / 100: avg data time: 3.99e-02, avg batch time: 0.4863, average train loss: 6.0562
[09/25 23:19:12 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1676, average loss: 7.0912
[09/25 23:19:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 72.50	
[09/25 23:19:12 visual_prompt]: Training 80 / 100 epoch, with learning rate 3.2106896815325707
[09/25 23:19:19 visual_prompt]: Epoch 80 / 100: avg data time: 4.94e-02, avg batch time: 0.4933, average train loss: 5.1420
[09/25 23:19:20 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.1673, average loss: 2.4197
[09/25 23:19:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.08	
[09/25 23:19:20 visual_prompt]: Training 81 / 100 epoch, with learning rate 2.924444461012776
[09/25 23:19:27 visual_prompt]: Epoch 81 / 100: avg data time: 4.91e-02, avg batch time: 0.4937, average train loss: 2.1816
[09/25 23:19:28 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1674, average loss: 0.8200
[09/25 23:19:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.74	
[09/25 23:19:28 visual_prompt]: Training 82 / 100 epoch, with learning rate 2.6498655799159763
[09/25 23:19:35 visual_prompt]: Epoch 82 / 100: avg data time: 4.18e-02, avg batch time: 0.4897, average train loss: 1.2592
[09/25 23:19:36 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1673, average loss: 0.6924
[09/25 23:19:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.28	
[09/25 23:19:36 visual_prompt]: Training 83 / 100 epoch, with learning rate 2.387287570313158
[09/25 23:19:43 visual_prompt]: Epoch 83 / 100: avg data time: 4.80e-02, avg batch time: 0.4927, average train loss: 1.0914
[09/25 23:19:44 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1674, average loss: 1.4180
[09/25 23:19:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 76.97	
[09/25 23:19:44 visual_prompt]: Training 84 / 100 epoch, with learning rate 2.13703034306198
[09/25 23:19:51 visual_prompt]: Epoch 84 / 100: avg data time: 4.93e-02, avg batch time: 0.4939, average train loss: 1.4425
[09/25 23:19:52 visual_prompt]: Inference (val):avg data time: 3.56e-05, avg batch time: 0.1673, average loss: 0.7327
[09/25 23:19:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 37.94	
[09/25 23:19:52 visual_prompt]: Training 85 / 100 epoch, with learning rate 1.8993987980446756
[09/25 23:19:59 visual_prompt]: Epoch 85 / 100: avg data time: 4.21e-02, avg batch time: 0.4868, average train loss: 0.8365
[09/25 23:20:00 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1673, average loss: 0.7071
[09/25 23:20:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 86.98	
[09/25 23:20:00 visual_prompt]: Training 86 / 100 epoch, with learning rate 1.674682452694516
[09/25 23:20:07 visual_prompt]: Epoch 86 / 100: avg data time: 3.75e-02, avg batch time: 0.4830, average train loss: 1.5571
[09/25 23:20:08 visual_prompt]: Inference (val):avg data time: 3.83e-05, avg batch time: 0.1672, average loss: 4.2571
[09/25 23:20:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 57.35	
[09/25 23:20:08 visual_prompt]: Training 87 / 100 epoch, with learning rate 1.4631550892634126
[09/25 23:20:15 visual_prompt]: Epoch 87 / 100: avg data time: 3.93e-02, avg batch time: 0.4837, average train loss: 1.8795
[09/25 23:20:16 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1676, average loss: 0.7051
[09/25 23:20:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 40.92	
[09/25 23:20:16 visual_prompt]: Training 88 / 100 epoch, with learning rate 1.2650744212604148
[09/25 23:20:23 visual_prompt]: Epoch 88 / 100: avg data time: 4.97e-02, avg batch time: 0.4937, average train loss: 1.0217
[09/25 23:20:24 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1673, average loss: 0.9892
[09/25 23:20:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 75.97	
[09/25 23:20:24 visual_prompt]: Training 89 / 100 epoch, with learning rate 1.0806817794674877
[09/25 23:20:31 visual_prompt]: Epoch 89 / 100: avg data time: 4.70e-02, avg batch time: 0.4925, average train loss: 1.0375
[09/25 23:20:32 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1675, average loss: 1.1171
[09/25 23:20:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 81.74	
[09/25 23:20:32 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.9102018179151585
[09/25 23:20:39 visual_prompt]: Epoch 90 / 100: avg data time: 4.69e-02, avg batch time: 0.4917, average train loss: 0.9241
[09/25 23:20:40 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1676, average loss: 0.7371
[09/25 23:20:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 76.52	
[09/25 23:20:40 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.753842240176146
[09/25 23:20:47 visual_prompt]: Epoch 91 / 100: avg data time: 3.82e-02, avg batch time: 0.4850, average train loss: 0.7135
[09/25 23:20:48 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1674, average loss: 1.1128
[09/25 23:20:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 83.66	
[09/25 23:20:48 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.6117935463105808
[09/25 23:20:55 visual_prompt]: Epoch 92 / 100: avg data time: 4.99e-02, avg batch time: 0.4946, average train loss: 0.7413
[09/25 23:20:56 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1674, average loss: 0.6491
[09/25 23:20:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 64.00	rocauc: 84.35	
[09/25 23:20:56 visual_prompt]: Best epoch 92: best metric: 0.640
[09/25 23:20:56 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.4842288007710138
[09/25 23:21:03 visual_prompt]: Epoch 93 / 100: avg data time: 3.75e-02, avg batch time: 0.4823, average train loss: 0.6566
[09/25 23:21:04 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1674, average loss: 0.6219
[09/25 23:21:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 63.50	rocauc: 86.11	
[09/25 23:21:04 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.3713034215500441
[09/25 23:21:11 visual_prompt]: Epoch 94 / 100: avg data time: 5.15e-02, avg batch time: 0.4961, average train loss: 0.6709
[09/25 23:21:12 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1675, average loss: 0.6900
[09/25 23:21:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 55.00	rocauc: 85.96	
[09/25 23:21:12 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.2731549908274289
[09/25 23:21:19 visual_prompt]: Epoch 95 / 100: avg data time: 4.91e-02, avg batch time: 0.4929, average train loss: 0.6554
[09/25 23:21:20 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1675, average loss: 0.5831
[09/25 23:21:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 86.74	
[09/25 23:21:20 visual_prompt]: Best epoch 95: best metric: 0.800
[09/25 23:21:20 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.18990308734739975
[09/25 23:21:27 visual_prompt]: Epoch 96 / 100: avg data time: 4.61e-02, avg batch time: 0.4921, average train loss: 0.5833
[09/25 23:21:28 visual_prompt]: Inference (val):avg data time: 2.70e-05, avg batch time: 0.1679, average loss: 0.5993
[09/25 23:21:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 63.50	rocauc: 87.52	
[09/25 23:21:28 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.12164914073037048
[09/25 23:21:35 visual_prompt]: Epoch 97 / 100: avg data time: 4.49e-02, avg batch time: 0.4899, average train loss: 0.5981
[09/25 23:21:36 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1676, average loss: 0.6329
[09/25 23:21:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 58.00	rocauc: 89.42	
[09/25 23:21:36 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.06847630789658388
[09/25 23:21:43 visual_prompt]: Epoch 98 / 100: avg data time: 3.76e-02, avg batch time: 0.4829, average train loss: 0.5655
[09/25 23:21:44 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1674, average loss: 0.4639
[09/25 23:21:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 89.21	
[09/25 23:21:44 visual_prompt]: Best epoch 98: best metric: 0.805
[09/25 23:21:44 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.03044937175219753
[09/25 23:21:51 visual_prompt]: Epoch 99 / 100: avg data time: 4.06e-02, avg batch time: 0.4863, average train loss: 0.5181
[09/25 23:21:52 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1674, average loss: 0.4333
[09/25 23:21:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 90.03	
[09/25 23:21:52 visual_prompt]: Best epoch 99: best metric: 0.820
[09/25 23:21:52 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0076146622613029735
[09/25 23:21:59 visual_prompt]: Epoch 100 / 100: avg data time: 4.05e-02, avg batch time: 0.4860, average train loss: 0.5050
[09/25 23:22:00 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1679, average loss: 0.4216
[09/25 23:22:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 90.59	
[09/25 23:22:00 visual_prompt]: Rank of current process: 0. World size: 1
[09/25 23:22:00 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/25 23:22:00 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/25 23:22:00 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/25 23:22:00 visual_prompt]: Training with config:
[09/25 23:22:00 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr25.0_wd0.0001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 25.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/25 23:22:00 visual_prompt]: Loading training data...
[09/25 23:22:00 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/25 23:22:01 visual_prompt]: Number of images: 800
[09/25 23:22:01 visual_prompt]: Number of classes: 2 / 2
[09/25 23:22:01 visual_prompt]: Loading validation data...
[09/25 23:22:01 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/25 23:22:02 visual_prompt]: Number of images: 200
[09/25 23:22:02 visual_prompt]: Number of classes: 2 / 2
[09/25 23:22:02 visual_prompt]: Constructing models...
[09/25 23:22:04 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/25 23:22:04 visual_prompt]: tuned percent:0.536
[09/25 23:22:04 visual_prompt]: Device used for model: 0
[09/25 23:22:04 visual_prompt]: Setting up Evaluator...
[09/25 23:22:04 visual_prompt]: Setting up Trainer...
[09/25 23:22:04 visual_prompt]: 	Setting up the optimizer...
[09/25 23:22:04 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/25 23:22:11 visual_prompt]: Epoch 1 / 100: avg data time: 3.90e-02, avg batch time: 0.4843, average train loss: 1.9379
[09/25 23:22:12 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1670, average loss: 2.0033
[09/25 23:22:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/25 23:22:12 visual_prompt]: Best epoch 1: best metric: 0.520
[09/25 23:22:12 visual_prompt]: Training 2 / 100 epoch, with learning rate 2.5
[09/25 23:22:18 visual_prompt]: Epoch 2 / 100: avg data time: 3.54e-02, avg batch time: 0.4803, average train loss: 11.3981
[09/25 23:22:20 visual_prompt]: Inference (val):avg data time: 3.82e-05, avg batch time: 0.1671, average loss: 20.5214
[09/25 23:22:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 76.72	
[09/25 23:22:20 visual_prompt]: Training 3 / 100 epoch, with learning rate 5.0
[09/25 23:22:26 visual_prompt]: Epoch 3 / 100: avg data time: 4.89e-02, avg batch time: 0.4917, average train loss: 12.8501
[09/25 23:22:28 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1674, average loss: 1.6959
[09/25 23:22:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 50.50	rocauc: 85.63	
[09/25 23:22:28 visual_prompt]: Training 4 / 100 epoch, with learning rate 7.5
[09/25 23:22:34 visual_prompt]: Epoch 4 / 100: avg data time: 4.95e-02, avg batch time: 0.4932, average train loss: 13.6026
[09/25 23:22:36 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1669, average loss: 0.4924
[09/25 23:22:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.00	rocauc: 86.02	
[09/25 23:22:36 visual_prompt]: Best epoch 4: best metric: 0.770
[09/25 23:22:36 visual_prompt]: Training 5 / 100 epoch, with learning rate 10.0
[09/25 23:22:42 visual_prompt]: Epoch 5 / 100: avg data time: 4.32e-02, avg batch time: 0.4869, average train loss: 10.9208
[09/25 23:22:44 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1671, average loss: 41.7540
[09/25 23:22:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 86.83	
[09/25 23:22:44 visual_prompt]: Training 6 / 100 epoch, with learning rate 12.5
[09/25 23:22:50 visual_prompt]: Epoch 6 / 100: avg data time: 5.10e-02, avg batch time: 0.4915, average train loss: 56.8687
[09/25 23:22:52 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1667, average loss: 117.9080
[09/25 23:22:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.70	
[09/25 23:22:52 visual_prompt]: Training 7 / 100 epoch, with learning rate 15.0
[09/25 23:22:58 visual_prompt]: Epoch 7 / 100: avg data time: 4.98e-02, avg batch time: 0.4894, average train loss: 85.7710
[09/25 23:23:00 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1670, average loss: 21.8383
[09/25 23:23:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 82.47	
[09/25 23:23:00 visual_prompt]: Training 8 / 100 epoch, with learning rate 17.5
[09/25 23:23:07 visual_prompt]: Epoch 8 / 100: avg data time: 6.09e-02, avg batch time: 0.5024, average train loss: 34.7545
[09/25 23:23:08 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1674, average loss: 73.2524
[09/25 23:23:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 79.53	
[09/25 23:23:08 visual_prompt]: Training 9 / 100 epoch, with learning rate 20.0
[09/25 23:23:15 visual_prompt]: Epoch 9 / 100: avg data time: 4.27e-02, avg batch time: 0.4876, average train loss: 43.9211
[09/25 23:23:16 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1674, average loss: 17.4454
[09/25 23:23:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 80.18	
[09/25 23:23:16 visual_prompt]: Training 10 / 100 epoch, with learning rate 22.5
[09/25 23:23:22 visual_prompt]: Epoch 10 / 100: avg data time: 4.55e-02, avg batch time: 0.4875, average train loss: 63.3911
[09/25 23:23:24 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1673, average loss: 36.5081
[09/25 23:23:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 87.47	
[09/25 23:23:24 visual_prompt]: Training 11 / 100 epoch, with learning rate 25.0
[09/25 23:23:30 visual_prompt]: Epoch 11 / 100: avg data time: 5.00e-02, avg batch time: 0.4918, average train loss: 61.7584
[09/25 23:23:32 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1673, average loss: 53.5342
[09/25 23:23:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 82.24	
[09/25 23:23:32 visual_prompt]: Training 12 / 100 epoch, with learning rate 24.9923853377387
[09/25 23:23:38 visual_prompt]: Epoch 12 / 100: avg data time: 4.75e-02, avg batch time: 0.4877, average train loss: 67.1055
[09/25 23:23:40 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1676, average loss: 69.6617
[09/25 23:23:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 78.14	
[09/25 23:23:40 visual_prompt]: Training 13 / 100 epoch, with learning rate 24.969550628247802
[09/25 23:23:46 visual_prompt]: Epoch 13 / 100: avg data time: 4.12e-02, avg batch time: 0.4846, average train loss: 41.7936
[09/25 23:23:48 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1675, average loss: 6.3237
[09/25 23:23:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 81.31	
[09/25 23:23:48 visual_prompt]: Training 14 / 100 epoch, with learning rate 24.931523692103415
[09/25 23:23:54 visual_prompt]: Epoch 14 / 100: avg data time: 3.88e-02, avg batch time: 0.4820, average train loss: 32.5390
[09/25 23:23:56 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1676, average loss: 23.7186
[09/25 23:23:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 70.02	
[09/25 23:23:56 visual_prompt]: Training 15 / 100 epoch, with learning rate 24.87835085926963
[09/25 23:24:02 visual_prompt]: Epoch 15 / 100: avg data time: 5.56e-02, avg batch time: 0.4954, average train loss: 56.0320
[09/25 23:24:04 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1672, average loss: 36.2583
[09/25 23:24:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 68.19	
[09/25 23:24:04 visual_prompt]: Training 16 / 100 epoch, with learning rate 24.8100969126526
[09/25 23:24:10 visual_prompt]: Epoch 16 / 100: avg data time: 4.78e-02, avg batch time: 0.4886, average train loss: 28.3398
[09/25 23:24:11 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1672, average loss: 26.0487
[09/25 23:24:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 75.38	
[09/25 23:24:11 visual_prompt]: Training 17 / 100 epoch, with learning rate 24.72684500917257
[09/25 23:24:18 visual_prompt]: Epoch 17 / 100: avg data time: 4.69e-02, avg batch time: 0.4903, average train loss: 36.6140
[09/25 23:24:19 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1672, average loss: 58.8454
[09/25 23:24:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 61.18	
[09/25 23:24:19 visual_prompt]: Training 18 / 100 epoch, with learning rate 24.628696578449954
[09/25 23:24:26 visual_prompt]: Epoch 18 / 100: avg data time: 4.94e-02, avg batch time: 0.4920, average train loss: 25.2404
[09/25 23:24:27 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1671, average loss: 46.2115
[09/25 23:24:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 61.09	
[09/25 23:24:27 visual_prompt]: Training 19 / 100 epoch, with learning rate 24.515771199228986
[09/25 23:24:34 visual_prompt]: Epoch 19 / 100: avg data time: 5.80e-02, avg batch time: 0.4992, average train loss: 35.6561
[09/25 23:24:36 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1671, average loss: 30.7816
[09/25 23:24:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 45.35	
[09/25 23:24:36 visual_prompt]: Training 20 / 100 epoch, with learning rate 24.38820645368942
[09/25 23:24:42 visual_prompt]: Epoch 20 / 100: avg data time: 5.48e-02, avg batch time: 0.4968, average train loss: 46.2895
[09/25 23:24:44 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1674, average loss: 52.1821
[09/25 23:24:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 65.24	
[09/25 23:24:44 visual_prompt]: Training 21 / 100 epoch, with learning rate 24.246157759823856
[09/25 23:24:50 visual_prompt]: Epoch 21 / 100: avg data time: 5.64e-02, avg batch time: 0.4968, average train loss: 49.9275
[09/25 23:24:52 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1673, average loss: 73.0405
[09/25 23:24:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.04	
[09/25 23:24:52 visual_prompt]: Training 22 / 100 epoch, with learning rate 24.08979818208484
[09/25 23:24:58 visual_prompt]: Epoch 22 / 100: avg data time: 5.52e-02, avg batch time: 0.4959, average train loss: 45.8942
[09/25 23:25:00 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1673, average loss: 91.6001
[09/25 23:25:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 78.02	
[09/25 23:25:00 visual_prompt]: Training 23 / 100 epoch, with learning rate 23.91931822053251
[09/25 23:25:06 visual_prompt]: Epoch 23 / 100: avg data time: 4.97e-02, avg batch time: 0.4892, average train loss: 93.3607
[09/25 23:25:08 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1671, average loss: 47.4434
[09/25 23:25:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 80.88	
[09/25 23:25:08 visual_prompt]: Training 24 / 100 epoch, with learning rate 23.73492557873959
[09/25 23:25:14 visual_prompt]: Epoch 24 / 100: avg data time: 4.65e-02, avg batch time: 0.4895, average train loss: 42.5536
[09/25 23:25:16 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1677, average loss: 39.2353
[09/25 23:25:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 81.14	
[09/25 23:25:16 visual_prompt]: Training 25 / 100 epoch, with learning rate 23.536844910736587
[09/25 23:25:22 visual_prompt]: Epoch 25 / 100: avg data time: 5.05e-02, avg batch time: 0.4926, average train loss: 84.7759
[09/25 23:25:24 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1675, average loss: 147.8928
[09/25 23:25:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 61.02	
[09/25 23:25:24 visual_prompt]: Training 26 / 100 epoch, with learning rate 23.325317547305485
[09/25 23:25:30 visual_prompt]: Epoch 26 / 100: avg data time: 5.02e-02, avg batch time: 0.4912, average train loss: 45.8548
[09/25 23:25:32 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1673, average loss: 14.8964
[09/25 23:25:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 51.53	
[09/25 23:25:32 visual_prompt]: Training 27 / 100 epoch, with learning rate 23.100601201955325
[09/25 23:25:38 visual_prompt]: Epoch 27 / 100: avg data time: 4.71e-02, avg batch time: 0.4885, average train loss: 26.0156
[09/25 23:25:40 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1671, average loss: 4.0081
[09/25 23:25:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.64	
[09/25 23:25:40 visual_prompt]: Training 28 / 100 epoch, with learning rate 22.86296965693802
[09/25 23:25:46 visual_prompt]: Epoch 28 / 100: avg data time: 3.89e-02, avg batch time: 0.4818, average train loss: 28.9367
[09/25 23:25:48 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1672, average loss: 8.1825
[09/25 23:25:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 47.92	
[09/25 23:25:48 visual_prompt]: Training 29 / 100 epoch, with learning rate 22.612712429686844
[09/25 23:25:54 visual_prompt]: Epoch 29 / 100: avg data time: 5.17e-02, avg batch time: 0.4961, average train loss: 20.6061
[09/25 23:25:56 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1672, average loss: 50.2910
[09/25 23:25:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 80.82	
[09/25 23:25:56 visual_prompt]: Training 30 / 100 epoch, with learning rate 22.35013442008402
[09/25 23:26:02 visual_prompt]: Epoch 30 / 100: avg data time: 5.12e-02, avg batch time: 0.4946, average train loss: 19.6767
[09/25 23:26:04 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1673, average loss: 9.0846
[09/25 23:26:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 80.23	
[09/25 23:26:04 visual_prompt]: Training 31 / 100 epoch, with learning rate 22.075555538987224
[09/25 23:26:10 visual_prompt]: Epoch 31 / 100: avg data time: 5.16e-02, avg batch time: 0.4945, average train loss: 21.9401
[09/25 23:26:12 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1672, average loss: 27.4853
[09/25 23:26:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 87.31	
[09/25 23:26:12 visual_prompt]: Training 32 / 100 epoch, with learning rate 21.78931031846743
[09/25 23:26:18 visual_prompt]: Epoch 32 / 100: avg data time: 4.95e-02, avg batch time: 0.4904, average train loss: 33.5806
[09/25 23:26:20 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1674, average loss: 8.4766
[09/25 23:26:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 22.05	
[09/25 23:26:20 visual_prompt]: Training 33 / 100 epoch, with learning rate 21.49174750423314
[09/25 23:26:26 visual_prompt]: Epoch 33 / 100: avg data time: 4.36e-02, avg batch time: 0.4874, average train loss: 16.6153
[09/25 23:26:28 visual_prompt]: Inference (val):avg data time: 3.37e-05, avg batch time: 0.1674, average loss: 12.0968
[09/25 23:26:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 79.90	
[09/25 23:26:28 visual_prompt]: Training 34 / 100 epoch, with learning rate 21.183229630737465
[09/25 23:26:34 visual_prompt]: Epoch 34 / 100: avg data time: 4.93e-02, avg batch time: 0.4929, average train loss: 25.5100
[09/25 23:26:36 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1672, average loss: 33.7775
[09/25 23:26:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 80.35	
[09/25 23:26:36 visual_prompt]: Training 35 / 100 epoch, with learning rate 20.864132579485727
[09/25 23:26:42 visual_prompt]: Epoch 35 / 100: avg data time: 5.14e-02, avg batch time: 0.4937, average train loss: 32.5437
[09/25 23:26:44 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1675, average loss: 26.3225
[09/25 23:26:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 65.62	
[09/25 23:26:44 visual_prompt]: Training 36 / 100 epoch, with learning rate 20.53484512108174
[09/25 23:26:50 visual_prompt]: Epoch 36 / 100: avg data time: 5.55e-02, avg batch time: 0.4974, average train loss: 33.3673
[09/25 23:26:52 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1672, average loss: 17.4753
[09/25 23:26:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 74.75	
[09/25 23:26:52 visual_prompt]: Training 37 / 100 epoch, with learning rate 20.195768441570728
[09/25 23:26:58 visual_prompt]: Epoch 37 / 100: avg data time: 4.99e-02, avg batch time: 0.4942, average train loss: 19.5286
[09/25 23:27:00 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1674, average loss: 9.9243
[09/25 23:27:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.38	
[09/25 23:27:00 visual_prompt]: Training 38 / 100 epoch, with learning rate 19.847315653655915
[09/25 23:27:07 visual_prompt]: Epoch 38 / 100: avg data time: 4.28e-02, avg batch time: 0.4883, average train loss: 5.5521
[09/25 23:27:08 visual_prompt]: Inference (val):avg data time: 3.14e-05, avg batch time: 0.1673, average loss: 8.7617
[09/25 23:27:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.93	
[09/25 23:27:08 visual_prompt]: Training 39 / 100 epoch, with learning rate 19.489911293384335
[09/25 23:27:15 visual_prompt]: Epoch 39 / 100: avg data time: 5.49e-02, avg batch time: 0.4981, average train loss: 13.4074
[09/25 23:27:16 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1673, average loss: 34.5671
[09/25 23:27:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 87.41	
[09/25 23:27:16 visual_prompt]: Training 40 / 100 epoch, with learning rate 19.12399080291506
[09/25 23:27:23 visual_prompt]: Epoch 40 / 100: avg data time: 5.40e-02, avg batch time: 0.4975, average train loss: 20.5820
[09/25 23:27:24 visual_prompt]: Inference (val):avg data time: 2.92e-05, avg batch time: 0.1674, average loss: 51.4505
[09/25 23:27:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 82.27	
[09/25 23:27:24 visual_prompt]: Training 41 / 100 epoch, with learning rate 18.75
[09/25 23:27:31 visual_prompt]: Epoch 41 / 100: avg data time: 4.46e-02, avg batch time: 0.4861, average train loss: 48.6682
[09/25 23:27:32 visual_prompt]: Inference (val):avg data time: 3.45e-05, avg batch time: 0.1671, average loss: 22.5195
[09/25 23:27:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 39.47	
[09/25 23:27:32 visual_prompt]: Training 42 / 100 epoch, with learning rate 18.368394534823633
[09/25 23:27:39 visual_prompt]: Epoch 42 / 100: avg data time: 5.23e-02, avg batch time: 0.4961, average train loss: 25.1658
[09/25 23:27:40 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1673, average loss: 0.6423
[09/25 23:27:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 61.00	rocauc: 62.20	
[09/25 23:27:40 visual_prompt]: Training 43 / 100 epoch, with learning rate 17.979639334863467
[09/25 23:27:47 visual_prompt]: Epoch 43 / 100: avg data time: 3.91e-02, avg batch time: 0.4826, average train loss: 35.4055
[09/25 23:27:48 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1676, average loss: 72.7399
[09/25 23:27:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 66.55	
[09/25 23:27:48 visual_prompt]: Training 44 / 100 epoch, with learning rate 17.584208038447503
[09/25 23:27:55 visual_prompt]: Epoch 44 / 100: avg data time: 5.07e-02, avg batch time: 0.4948, average train loss: 21.0971
[09/25 23:27:56 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1674, average loss: 44.1000
[09/25 23:27:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 79.93	
[09/25 23:27:56 visual_prompt]: Training 45 / 100 epoch, with learning rate 17.182582417698903
[09/25 23:28:03 visual_prompt]: Epoch 45 / 100: avg data time: 4.57e-02, avg batch time: 0.4894, average train loss: 31.3670
[09/25 23:28:04 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1672, average loss: 30.2284
[09/25 23:28:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 82.75	
[09/25 23:28:04 visual_prompt]: Training 46 / 100 epoch, with learning rate 16.77525179157086
[09/25 23:28:11 visual_prompt]: Epoch 46 / 100: avg data time: 5.36e-02, avg batch time: 0.4962, average train loss: 40.7877
[09/25 23:28:13 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1676, average loss: 15.6767
[09/25 23:28:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.00	
[09/25 23:28:13 visual_prompt]: Training 47 / 100 epoch, with learning rate 16.362712429686844
[09/25 23:28:19 visual_prompt]: Epoch 47 / 100: avg data time: 4.03e-02, avg batch time: 0.4856, average train loss: 9.7115
[09/25 23:28:20 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1677, average loss: 11.8730
[09/25 23:28:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.72	
[09/25 23:28:20 visual_prompt]: Training 48 / 100 epoch, with learning rate 15.94546694771249
[09/25 23:28:27 visual_prompt]: Epoch 48 / 100: avg data time: 5.99e-02, avg batch time: 0.5038, average train loss: 9.9360
[09/25 23:28:29 visual_prompt]: Inference (val):avg data time: 2.98e-05, avg batch time: 0.1678, average loss: 7.5964
[09/25 23:28:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 51.50	rocauc: 86.95	
[09/25 23:28:29 visual_prompt]: Training 49 / 100 epoch, with learning rate 15.524023694995845
[09/25 23:28:35 visual_prompt]: Epoch 49 / 100: avg data time: 5.47e-02, avg batch time: 0.5001, average train loss: 7.0273
[09/25 23:28:37 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1676, average loss: 7.8475
[09/25 23:28:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 87.85	
[09/25 23:28:37 visual_prompt]: Training 50 / 100 epoch, with learning rate 15.09889613522199
[09/25 23:28:43 visual_prompt]: Epoch 50 / 100: avg data time: 5.22e-02, avg batch time: 0.4966, average train loss: 19.8002
[09/25 23:28:45 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1677, average loss: 24.5578
[09/25 23:28:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 56.54	
[09/25 23:28:45 visual_prompt]: Training 51 / 100 epoch, with learning rate 14.670602220836631
[09/25 23:28:51 visual_prompt]: Epoch 51 / 100: avg data time: 4.11e-02, avg batch time: 0.4855, average train loss: 15.3384
[09/25 23:28:53 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1672, average loss: 16.7326
[09/25 23:28:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 59.49	
[09/25 23:28:53 visual_prompt]: Training 52 / 100 epoch, with learning rate 14.239663762000818
[09/25 23:29:00 visual_prompt]: Epoch 52 / 100: avg data time: 5.77e-02, avg batch time: 0.4998, average train loss: 15.1392
[09/25 23:29:01 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1671, average loss: 20.9534
[09/25 23:29:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 80.09	
[09/25 23:29:01 visual_prompt]: Training 53 / 100 epoch, with learning rate 13.80660579084567
[09/25 23:29:08 visual_prompt]: Epoch 53 / 100: avg data time: 4.99e-02, avg batch time: 0.4930, average train loss: 23.0088
[09/25 23:29:09 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1674, average loss: 31.8401
[09/25 23:29:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 78.09	
[09/25 23:29:09 visual_prompt]: Training 54 / 100 epoch, with learning rate 13.371955921801565
[09/25 23:29:16 visual_prompt]: Epoch 54 / 100: avg data time: 5.28e-02, avg batch time: 0.4952, average train loss: 22.0657
[09/25 23:29:17 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1673, average loss: 20.0604
[09/25 23:29:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 67.80	
[09/25 23:29:17 visual_prompt]: Training 55 / 100 epoch, with learning rate 12.936243708781264
[09/25 23:29:24 visual_prompt]: Epoch 55 / 100: avg data time: 5.11e-02, avg batch time: 0.4932, average train loss: 29.0330
[09/25 23:29:25 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1674, average loss: 25.9603
[09/25 23:29:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 66.67	
[09/25 23:29:25 visual_prompt]: Training 56 / 100 epoch, with learning rate 12.5
[09/25 23:29:32 visual_prompt]: Epoch 56 / 100: avg data time: 3.77e-02, avg batch time: 0.4811, average train loss: 21.7173
[09/25 23:29:33 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1673, average loss: 23.1685
[09/25 23:29:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 64.81	
[09/25 23:29:33 visual_prompt]: Training 57 / 100 epoch, with learning rate 12.063756291218741
[09/25 23:29:40 visual_prompt]: Epoch 57 / 100: avg data time: 4.17e-02, avg batch time: 0.4849, average train loss: 16.8498
[09/25 23:29:41 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1673, average loss: 14.9726
[09/25 23:29:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.45	
[09/25 23:29:41 visual_prompt]: Training 58 / 100 epoch, with learning rate 11.628044078198434
[09/25 23:29:48 visual_prompt]: Epoch 58 / 100: avg data time: 4.19e-02, avg batch time: 0.4882, average train loss: 20.4668
[09/25 23:29:49 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1675, average loss: 33.9634
[09/25 23:29:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 86.65	
[09/25 23:29:49 visual_prompt]: Training 59 / 100 epoch, with learning rate 11.193394209154334
[09/25 23:29:56 visual_prompt]: Epoch 59 / 100: avg data time: 4.20e-02, avg batch time: 0.4852, average train loss: 26.5829
[09/25 23:29:57 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.1673, average loss: 16.8259
[09/25 23:29:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 87.09	
[09/25 23:29:57 visual_prompt]: Training 60 / 100 epoch, with learning rate 10.760336237999185
[09/25 23:30:04 visual_prompt]: Epoch 60 / 100: avg data time: 4.30e-02, avg batch time: 0.4897, average train loss: 16.1152
[09/25 23:30:05 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1674, average loss: 1.8023
[09/25 23:30:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 86.76	
[09/25 23:30:05 visual_prompt]: Training 61 / 100 epoch, with learning rate 10.32939777916337
[09/25 23:30:11 visual_prompt]: Epoch 61 / 100: avg data time: 4.72e-02, avg batch time: 0.4914, average train loss: 18.9386
[09/25 23:30:13 visual_prompt]: Inference (val):avg data time: 2.05e-05, avg batch time: 0.1676, average loss: 16.2781
[09/25 23:30:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.87	
[09/25 23:30:13 visual_prompt]: Training 62 / 100 epoch, with learning rate 9.90110386477801
[09/25 23:30:20 visual_prompt]: Epoch 62 / 100: avg data time: 4.85e-02, avg batch time: 0.4935, average train loss: 7.7840
[09/25 23:30:21 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1677, average loss: 1.9294
[09/25 23:30:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.89	
[09/25 23:30:21 visual_prompt]: Training 63 / 100 epoch, with learning rate 9.475976305004155
[09/25 23:30:28 visual_prompt]: Epoch 63 / 100: avg data time: 5.31e-02, avg batch time: 0.4981, average train loss: 9.2317
[09/25 23:30:29 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1673, average loss: 11.1205
[09/25 23:30:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 81.90	
[09/25 23:30:29 visual_prompt]: Training 64 / 100 epoch, with learning rate 9.05453305228751
[09/25 23:30:36 visual_prompt]: Epoch 64 / 100: avg data time: 4.95e-02, avg batch time: 0.4937, average train loss: 6.4523
[09/25 23:30:37 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.1677, average loss: 0.9207
[09/25 23:30:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 86.70	
[09/25 23:30:37 visual_prompt]: Training 65 / 100 epoch, with learning rate 8.637287570313159
[09/25 23:30:44 visual_prompt]: Epoch 65 / 100: avg data time: 4.00e-02, avg batch time: 0.4861, average train loss: 10.8326
[09/25 23:30:45 visual_prompt]: Inference (val):avg data time: 2.07e-05, avg batch time: 0.1672, average loss: 9.2828
[09/25 23:30:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 83.86	
[09/25 23:30:45 visual_prompt]: Training 66 / 100 epoch, with learning rate 8.224748208429142
[09/25 23:30:52 visual_prompt]: Epoch 66 / 100: avg data time: 4.03e-02, avg batch time: 0.4867, average train loss: 8.8015
[09/25 23:30:53 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1670, average loss: 5.8086
[09/25 23:30:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 81.20	
[09/25 23:30:53 visual_prompt]: Training 67 / 100 epoch, with learning rate 7.817417582301099
[09/25 23:31:00 visual_prompt]: Epoch 67 / 100: avg data time: 4.18e-02, avg batch time: 0.4876, average train loss: 10.4283
[09/25 23:31:01 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1676, average loss: 34.6394
[09/25 23:31:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 65.61	
[09/25 23:31:01 visual_prompt]: Training 68 / 100 epoch, with learning rate 7.415791961552499
[09/25 23:31:08 visual_prompt]: Epoch 68 / 100: avg data time: 4.65e-02, avg batch time: 0.4909, average train loss: 23.5155
[09/25 23:31:09 visual_prompt]: Inference (val):avg data time: 2.08e-05, avg batch time: 0.1676, average loss: 5.7833
[09/25 23:31:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 65.30	
[09/25 23:31:09 visual_prompt]: Training 69 / 100 epoch, with learning rate 7.020360665136531
[09/25 23:31:16 visual_prompt]: Epoch 69 / 100: avg data time: 3.83e-02, avg batch time: 0.4834, average train loss: 6.8368
[09/25 23:31:17 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1675, average loss: 11.8058
[09/25 23:31:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 60.49	
[09/25 23:31:17 visual_prompt]: Training 70 / 100 epoch, with learning rate 6.631605465176368
[09/25 23:31:24 visual_prompt]: Epoch 70 / 100: avg data time: 5.19e-02, avg batch time: 0.4956, average train loss: 4.4806
[09/25 23:31:25 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1676, average loss: 6.5013
[09/25 23:31:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 70.44	
[09/25 23:31:25 visual_prompt]: Training 71 / 100 epoch, with learning rate 6.250000000000003
[09/25 23:31:32 visual_prompt]: Epoch 71 / 100: avg data time: 5.04e-02, avg batch time: 0.4942, average train loss: 2.5163
[09/25 23:31:33 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1674, average loss: 0.6433
[09/25 23:31:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 79.55	
[09/25 23:31:33 visual_prompt]: Training 72 / 100 epoch, with learning rate 5.87600919708494
[09/25 23:31:40 visual_prompt]: Epoch 72 / 100: avg data time: 5.12e-02, avg batch time: 0.4959, average train loss: 1.5672
[09/25 23:31:41 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1676, average loss: 0.7189
[09/25 23:31:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.94	
[09/25 23:31:41 visual_prompt]: Training 73 / 100 epoch, with learning rate 5.510088706615666
[09/25 23:31:48 visual_prompt]: Epoch 73 / 100: avg data time: 5.02e-02, avg batch time: 0.4941, average train loss: 2.9178
[09/25 23:31:49 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1675, average loss: 3.5612
[09/25 23:31:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.64	
[09/25 23:31:49 visual_prompt]: Training 74 / 100 epoch, with learning rate 5.1526843463440875
[09/25 23:31:56 visual_prompt]: Epoch 74 / 100: avg data time: 5.79e-02, avg batch time: 0.5019, average train loss: 7.1672
[09/25 23:31:57 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1675, average loss: 2.1189
[09/25 23:31:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 87.54	
[09/25 23:31:57 visual_prompt]: Training 75 / 100 epoch, with learning rate 4.804231558429271
[09/25 23:32:04 visual_prompt]: Epoch 75 / 100: avg data time: 4.69e-02, avg batch time: 0.4917, average train loss: 1.6426
[09/25 23:32:05 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1677, average loss: 0.5036
[09/25 23:32:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.00	rocauc: 88.46	
[09/25 23:32:05 visual_prompt]: Training 76 / 100 epoch, with learning rate 4.465154878918258
[09/25 23:32:12 visual_prompt]: Epoch 76 / 100: avg data time: 3.81e-02, avg batch time: 0.4822, average train loss: 0.8513
[09/25 23:32:13 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1674, average loss: 1.5525
[09/25 23:32:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 90.67	
[09/25 23:32:13 visual_prompt]: Training 77 / 100 epoch, with learning rate 4.135867420514276
[09/25 23:32:20 visual_prompt]: Epoch 77 / 100: avg data time: 4.68e-02, avg batch time: 0.4920, average train loss: 1.2209
[09/25 23:32:21 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1675, average loss: 1.0424
[09/25 23:32:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 58.50	rocauc: 92.31	
[09/25 23:32:21 visual_prompt]: Training 78 / 100 epoch, with learning rate 3.816770369262533
[09/25 23:32:28 visual_prompt]: Epoch 78 / 100: avg data time: 5.13e-02, avg batch time: 0.4981, average train loss: 0.9320
[09/25 23:32:29 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1674, average loss: 0.4981
[09/25 23:32:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 92.66	
[09/25 23:32:29 visual_prompt]: Best epoch 78: best metric: 0.785
[09/25 23:32:29 visual_prompt]: Training 79 / 100 epoch, with learning rate 3.508252495766863
[09/25 23:32:36 visual_prompt]: Epoch 79 / 100: avg data time: 5.54e-02, avg batch time: 0.4994, average train loss: 0.5535
[09/25 23:32:37 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1676, average loss: 0.7408
[09/25 23:32:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 61.00	rocauc: 92.13	
[09/25 23:32:37 visual_prompt]: Training 80 / 100 epoch, with learning rate 3.2106896815325707
[09/25 23:32:44 visual_prompt]: Epoch 80 / 100: avg data time: 4.63e-02, avg batch time: 0.4915, average train loss: 0.7974
[09/25 23:32:45 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1674, average loss: 1.2351
[09/25 23:32:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 54.00	rocauc: 93.11	
[09/25 23:32:45 visual_prompt]: Training 81 / 100 epoch, with learning rate 2.924444461012776
[09/25 23:32:52 visual_prompt]: Epoch 81 / 100: avg data time: 4.44e-02, avg batch time: 0.4901, average train loss: 0.8618
[09/25 23:32:53 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.1673, average loss: 1.3566
[09/25 23:32:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 57.00	rocauc: 88.91	
[09/25 23:32:53 visual_prompt]: Training 82 / 100 epoch, with learning rate 2.6498655799159763
[09/25 23:33:00 visual_prompt]: Epoch 82 / 100: avg data time: 5.24e-02, avg batch time: 0.4965, average train loss: 0.9063
[09/25 23:33:01 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1678, average loss: 0.8429
[09/25 23:33:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 71.50	rocauc: 92.43	
[09/25 23:33:01 visual_prompt]: Training 83 / 100 epoch, with learning rate 2.387287570313158
[09/25 23:33:08 visual_prompt]: Epoch 83 / 100: avg data time: 5.19e-02, avg batch time: 0.4965, average train loss: 0.6538
[09/25 23:33:09 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1678, average loss: 0.4771
[09/25 23:33:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.80	
[09/25 23:33:09 visual_prompt]: Best epoch 83: best metric: 0.820
[09/25 23:33:09 visual_prompt]: Training 84 / 100 epoch, with learning rate 2.13703034306198
[09/25 23:33:16 visual_prompt]: Epoch 84 / 100: avg data time: 5.02e-02, avg batch time: 0.4958, average train loss: 0.5135
[09/25 23:33:18 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1676, average loss: 0.5518
[09/25 23:33:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.00	rocauc: 92.03	
[09/25 23:33:18 visual_prompt]: Training 85 / 100 epoch, with learning rate 1.8993987980446756
[09/25 23:33:24 visual_prompt]: Epoch 85 / 100: avg data time: 5.78e-02, avg batch time: 0.5020, average train loss: 0.6243
[09/25 23:33:26 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1676, average loss: 0.5204
[09/25 23:33:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 92.27	
[09/25 23:33:26 visual_prompt]: Training 86 / 100 epoch, with learning rate 1.674682452694516
[09/25 23:33:32 visual_prompt]: Epoch 86 / 100: avg data time: 5.09e-02, avg batch time: 0.4964, average train loss: 0.4404
[09/25 23:33:34 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1679, average loss: 0.4407
[09/25 23:33:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 92.07	
[09/25 23:33:34 visual_prompt]: Training 87 / 100 epoch, with learning rate 1.4631550892634126
[09/25 23:33:40 visual_prompt]: Epoch 87 / 100: avg data time: 5.07e-02, avg batch time: 0.4948, average train loss: 0.3967
[09/25 23:33:42 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1677, average loss: 0.3848
[09/25 23:33:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.90	
[09/25 23:33:42 visual_prompt]: Best epoch 87: best metric: 0.830
[09/25 23:33:42 visual_prompt]: Training 88 / 100 epoch, with learning rate 1.2650744212604148
[09/25 23:33:49 visual_prompt]: Epoch 88 / 100: avg data time: 4.59e-02, avg batch time: 0.4923, average train loss: 0.3833
[09/25 23:33:50 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1677, average loss: 0.3953
[09/25 23:33:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.70	
[09/25 23:33:50 visual_prompt]: Training 89 / 100 epoch, with learning rate 1.0806817794674877
[09/25 23:33:57 visual_prompt]: Epoch 89 / 100: avg data time: 5.17e-02, avg batch time: 0.4970, average train loss: 0.3928
[09/25 23:33:58 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1675, average loss: 0.3971
[09/25 23:33:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 90.85	
[09/25 23:33:58 visual_prompt]: Best epoch 89: best metric: 0.835
[09/25 23:33:58 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.9102018179151585
[09/25 23:34:05 visual_prompt]: Epoch 90 / 100: avg data time: 5.55e-02, avg batch time: 0.4998, average train loss: 0.3697
[09/25 23:34:06 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1676, average loss: 0.4060
[09/25 23:34:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.06	
[09/25 23:34:06 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.753842240176146
[09/25 23:34:13 visual_prompt]: Epoch 91 / 100: avg data time: 4.74e-02, avg batch time: 0.4917, average train loss: 0.3401
[09/25 23:34:14 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1677, average loss: 0.4460
[09/25 23:34:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.50	rocauc: 90.41	
[09/25 23:34:14 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.6117935463105808
[09/25 23:34:21 visual_prompt]: Epoch 92 / 100: avg data time: 5.11e-02, avg batch time: 0.4954, average train loss: 0.3397
[09/25 23:34:22 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1680, average loss: 0.4214
[09/25 23:34:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 89.74	
[09/25 23:34:22 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.4842288007710138
[09/25 23:34:29 visual_prompt]: Epoch 93 / 100: avg data time: 4.88e-02, avg batch time: 0.4936, average train loss: 0.3452
[09/25 23:34:30 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1678, average loss: 0.4223
[09/25 23:34:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 90.01	
[09/25 23:34:30 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.3713034215500441
[09/25 23:34:37 visual_prompt]: Epoch 94 / 100: avg data time: 5.04e-02, avg batch time: 0.4954, average train loss: 0.3401
[09/25 23:34:38 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1675, average loss: 0.4467
[09/25 23:34:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 90.17	
[09/25 23:34:38 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.2731549908274289
[09/25 23:34:45 visual_prompt]: Epoch 95 / 100: avg data time: 4.85e-02, avg batch time: 0.4927, average train loss: 0.3392
[09/25 23:34:46 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1675, average loss: 0.4472
[09/25 23:34:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 89.61	
[09/25 23:34:46 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.18990308734739975
[09/25 23:34:53 visual_prompt]: Epoch 96 / 100: avg data time: 3.89e-02, avg batch time: 0.4849, average train loss: 0.3053
[09/25 23:34:54 visual_prompt]: Inference (val):avg data time: 3.01e-05, avg batch time: 0.1676, average loss: 0.4326
[09/25 23:34:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 89.50	
[09/25 23:34:54 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.12164914073037048
[09/25 23:35:01 visual_prompt]: Epoch 97 / 100: avg data time: 4.69e-02, avg batch time: 0.4917, average train loss: 0.2992
[09/25 23:35:02 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1678, average loss: 0.4288
[09/25 23:35:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 89.75	
[09/25 23:35:02 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.06847630789658388
[09/25 23:35:09 visual_prompt]: Epoch 98 / 100: avg data time: 4.96e-02, avg batch time: 0.4954, average train loss: 0.2833
[09/25 23:35:10 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1677, average loss: 0.4313
[09/25 23:35:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 89.65	
[09/25 23:35:10 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.03044937175219753
[09/25 23:35:17 visual_prompt]: Epoch 99 / 100: avg data time: 4.35e-02, avg batch time: 0.4882, average train loss: 0.2764
[09/25 23:35:18 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1677, average loss: 0.4389
[09/25 23:35:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 89.36	
[09/25 23:35:18 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0076146622613029735
[09/25 23:35:25 visual_prompt]: Epoch 100 / 100: avg data time: 4.23e-02, avg batch time: 0.4893, average train loss: 0.2759
[09/25 23:35:26 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1677, average loss: 0.4357
[09/25 23:35:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 89.43	
[09/25 23:35:26 visual_prompt]: Rank of current process: 0. World size: 1
[09/25 23:35:26 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/25 23:35:26 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/25 23:35:26 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/25 23:35:26 visual_prompt]: Training with config:
[09/25 23:35:26 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr25.0_wd0.0/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 25.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/25 23:35:26 visual_prompt]: Loading training data...
[09/25 23:35:26 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/25 23:35:28 visual_prompt]: Number of images: 800
[09/25 23:35:28 visual_prompt]: Number of classes: 2 / 2
[09/25 23:35:28 visual_prompt]: Loading validation data...
[09/25 23:35:28 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/25 23:35:28 visual_prompt]: Number of images: 200
[09/25 23:35:28 visual_prompt]: Number of classes: 2 / 2
[09/25 23:35:28 visual_prompt]: Constructing models...
[09/25 23:35:30 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/25 23:35:30 visual_prompt]: tuned percent:0.536
[09/25 23:35:31 visual_prompt]: Device used for model: 0
[09/25 23:35:31 visual_prompt]: Setting up Evaluator...
[09/25 23:35:31 visual_prompt]: Setting up Trainer...
[09/25 23:35:31 visual_prompt]: 	Setting up the optimizer...
[09/25 23:35:31 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/25 23:35:37 visual_prompt]: Epoch 1 / 100: avg data time: 5.09e-02, avg batch time: 0.4978, average train loss: 1.9175
[09/25 23:35:39 visual_prompt]: Inference (val):avg data time: 1.96e-05, avg batch time: 0.1669, average loss: 2.0033
[09/25 23:35:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/25 23:35:39 visual_prompt]: Best epoch 1: best metric: 0.520
[09/25 23:35:39 visual_prompt]: Training 2 / 100 epoch, with learning rate 2.5
[09/25 23:35:45 visual_prompt]: Epoch 2 / 100: avg data time: 3.81e-02, avg batch time: 0.4825, average train loss: 15.0078
[09/25 23:35:47 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1673, average loss: 20.6314
[09/25 23:35:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.07	
[09/25 23:35:47 visual_prompt]: Training 3 / 100 epoch, with learning rate 5.0
[09/25 23:35:53 visual_prompt]: Epoch 3 / 100: avg data time: 4.17e-02, avg batch time: 0.4866, average train loss: 11.0610
[09/25 23:35:55 visual_prompt]: Inference (val):avg data time: 1.78e-05, avg batch time: 0.1672, average loss: 0.6502
[09/25 23:35:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 88.51	
[09/25 23:35:55 visual_prompt]: Best epoch 3: best metric: 0.795
[09/25 23:35:55 visual_prompt]: Training 4 / 100 epoch, with learning rate 7.5
[09/25 23:36:01 visual_prompt]: Epoch 4 / 100: avg data time: 5.39e-02, avg batch time: 0.4998, average train loss: 15.6637
[09/25 23:36:03 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1670, average loss: 20.3446
[09/25 23:36:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.59	
[09/25 23:36:03 visual_prompt]: Training 5 / 100 epoch, with learning rate 10.0
[09/25 23:36:09 visual_prompt]: Epoch 5 / 100: avg data time: 5.56e-02, avg batch time: 0.4990, average train loss: 17.2330
[09/25 23:36:11 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1677, average loss: 45.9392
[09/25 23:36:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 89.29	
[09/25 23:36:11 visual_prompt]: Training 6 / 100 epoch, with learning rate 12.5
[09/25 23:36:17 visual_prompt]: Epoch 6 / 100: avg data time: 4.13e-02, avg batch time: 0.4864, average train loss: 23.2126
[09/25 23:36:19 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1671, average loss: 1.9432
[09/25 23:36:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 61.50	rocauc: 88.75	
[09/25 23:36:19 visual_prompt]: Training 7 / 100 epoch, with learning rate 15.0
[09/25 23:36:26 visual_prompt]: Epoch 7 / 100: avg data time: 5.94e-02, avg batch time: 0.5029, average train loss: 8.7594
[09/25 23:36:27 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.1673, average loss: 5.8286
[09/25 23:36:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 51.00	rocauc: 88.67	
[09/25 23:36:27 visual_prompt]: Training 8 / 100 epoch, with learning rate 17.5
[09/25 23:36:34 visual_prompt]: Epoch 8 / 100: avg data time: 5.05e-02, avg batch time: 0.4929, average train loss: 23.7258
[09/25 23:36:35 visual_prompt]: Inference (val):avg data time: 3.49e-05, avg batch time: 0.1674, average loss: 3.6095
[09/25 23:36:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 57.00	rocauc: 88.25	
[09/25 23:36:35 visual_prompt]: Training 9 / 100 epoch, with learning rate 20.0
[09/25 23:36:42 visual_prompt]: Epoch 9 / 100: avg data time: 4.75e-02, avg batch time: 0.4901, average train loss: 30.6669
[09/25 23:36:43 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.1676, average loss: 17.2907
[09/25 23:36:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 63.00	rocauc: 88.34	
[09/25 23:36:43 visual_prompt]: Training 10 / 100 epoch, with learning rate 22.5
[09/25 23:36:50 visual_prompt]: Epoch 10 / 100: avg data time: 5.45e-02, avg batch time: 0.4946, average train loss: 126.1980
[09/25 23:36:51 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1671, average loss: 95.0830
[09/25 23:36:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.88	
[09/25 23:36:51 visual_prompt]: Training 11 / 100 epoch, with learning rate 25.0
[09/25 23:36:58 visual_prompt]: Epoch 11 / 100: avg data time: 4.67e-02, avg batch time: 0.4869, average train loss: 59.9647
[09/25 23:36:59 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1675, average loss: 32.7686
[09/25 23:36:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.88	
[09/25 23:36:59 visual_prompt]: Training 12 / 100 epoch, with learning rate 24.9923853377387
[09/25 23:37:06 visual_prompt]: Epoch 12 / 100: avg data time: 5.01e-02, avg batch time: 0.4932, average train loss: 19.6103
[09/25 23:37:07 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1675, average loss: 9.3995
[09/25 23:37:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.60	
[09/25 23:37:07 visual_prompt]: Training 13 / 100 epoch, with learning rate 24.969550628247802
[09/25 23:37:14 visual_prompt]: Epoch 13 / 100: avg data time: 4.10e-02, avg batch time: 0.4819, average train loss: 50.7900
[09/25 23:37:15 visual_prompt]: Inference (val):avg data time: 2.08e-05, avg batch time: 0.1672, average loss: 31.4248
[09/25 23:37:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 88.77	
[09/25 23:37:15 visual_prompt]: Training 14 / 100 epoch, with learning rate 24.931523692103415
[09/25 23:37:22 visual_prompt]: Epoch 14 / 100: avg data time: 4.85e-02, avg batch time: 0.4896, average train loss: 40.8972
[09/25 23:37:23 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.1672, average loss: 78.9792
[09/25 23:37:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 88.86	
[09/25 23:37:23 visual_prompt]: Training 15 / 100 epoch, with learning rate 24.87835085926963
[09/25 23:37:30 visual_prompt]: Epoch 15 / 100: avg data time: 4.58e-02, avg batch time: 0.4869, average train loss: 51.7725
[09/25 23:37:31 visual_prompt]: Inference (val):avg data time: 2.11e-05, avg batch time: 0.1676, average loss: 78.3260
[09/25 23:37:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 87.90	
[09/25 23:37:31 visual_prompt]: Training 16 / 100 epoch, with learning rate 24.8100969126526
[09/25 23:37:38 visual_prompt]: Epoch 16 / 100: avg data time: 3.84e-02, avg batch time: 0.4830, average train loss: 36.1498
[09/25 23:37:39 visual_prompt]: Inference (val):avg data time: 2.10e-05, avg batch time: 0.1676, average loss: 16.9834
[09/25 23:37:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.00	rocauc: 89.26	
[09/25 23:37:39 visual_prompt]: Training 17 / 100 epoch, with learning rate 24.72684500917257
[09/25 23:37:46 visual_prompt]: Epoch 17 / 100: avg data time: 4.97e-02, avg batch time: 0.4924, average train loss: 23.3828
[09/25 23:37:47 visual_prompt]: Inference (val):avg data time: 2.05e-05, avg batch time: 0.1675, average loss: 16.8104
[09/25 23:37:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 89.86	
[09/25 23:37:47 visual_prompt]: Training 18 / 100 epoch, with learning rate 24.628696578449954
[09/25 23:37:54 visual_prompt]: Epoch 18 / 100: avg data time: 4.57e-02, avg batch time: 0.4900, average train loss: 11.5719
[09/25 23:37:55 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1678, average loss: 2.5049
[09/25 23:37:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 90.01	
[09/25 23:37:55 visual_prompt]: Best epoch 18: best metric: 0.800
[09/25 23:37:55 visual_prompt]: Training 19 / 100 epoch, with learning rate 24.515771199228986
[09/25 23:38:02 visual_prompt]: Epoch 19 / 100: avg data time: 5.63e-02, avg batch time: 0.5008, average train loss: 5.1281
[09/25 23:38:03 visual_prompt]: Inference (val):avg data time: 2.17e-05, avg batch time: 0.1677, average loss: 11.8621
[09/25 23:38:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 89.39	
[09/25 23:38:03 visual_prompt]: Training 20 / 100 epoch, with learning rate 24.38820645368942
[09/25 23:38:10 visual_prompt]: Epoch 20 / 100: avg data time: 5.25e-02, avg batch time: 0.4970, average train loss: 5.7352
[09/25 23:38:11 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1671, average loss: 1.5111
[09/25 23:38:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 90.15	
[09/25 23:38:11 visual_prompt]: Best epoch 20: best metric: 0.845
[09/25 23:38:11 visual_prompt]: Training 21 / 100 epoch, with learning rate 24.246157759823856
[09/25 23:38:18 visual_prompt]: Epoch 21 / 100: avg data time: 5.04e-02, avg batch time: 0.4956, average train loss: 4.3415
[09/25 23:38:19 visual_prompt]: Inference (val):avg data time: 1.92e-05, avg batch time: 0.1674, average loss: 10.1697
[09/25 23:38:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 53.00	rocauc: 89.92	
[09/25 23:38:19 visual_prompt]: Training 22 / 100 epoch, with learning rate 24.08979818208484
[09/25 23:38:26 visual_prompt]: Epoch 22 / 100: avg data time: 3.96e-02, avg batch time: 0.4863, average train loss: 9.1243
[09/25 23:38:27 visual_prompt]: Inference (val):avg data time: 2.10e-05, avg batch time: 0.1676, average loss: 18.3333
[09/25 23:38:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 53.00	rocauc: 91.12	
[09/25 23:38:27 visual_prompt]: Training 23 / 100 epoch, with learning rate 23.91931822053251
[09/25 23:38:34 visual_prompt]: Epoch 23 / 100: avg data time: 4.55e-02, avg batch time: 0.4906, average train loss: 6.8073
[09/25 23:38:35 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.1675, average loss: 1.9380
[09/25 23:38:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 91.43	
[09/25 23:38:35 visual_prompt]: Training 24 / 100 epoch, with learning rate 23.73492557873959
[09/25 23:38:42 visual_prompt]: Epoch 24 / 100: avg data time: 5.63e-02, avg batch time: 0.5000, average train loss: 8.2011
[09/25 23:38:44 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.1676, average loss: 36.1551
[09/25 23:38:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 91.03	
[09/25 23:38:44 visual_prompt]: Training 25 / 100 epoch, with learning rate 23.536844910736587
[09/25 23:38:50 visual_prompt]: Epoch 25 / 100: avg data time: 4.33e-02, avg batch time: 0.4878, average train loss: 12.1704
[09/25 23:38:52 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1676, average loss: 15.6470
[09/25 23:38:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 53.00	rocauc: 91.84	
[09/25 23:38:52 visual_prompt]: Training 26 / 100 epoch, with learning rate 23.325317547305485
[09/25 23:38:58 visual_prompt]: Epoch 26 / 100: avg data time: 4.87e-02, avg batch time: 0.4901, average train loss: 39.5871
[09/25 23:39:00 visual_prompt]: Inference (val):avg data time: 1.98e-05, avg batch time: 0.1676, average loss: 59.7899
[09/25 23:39:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 90.58	
[09/25 23:39:00 visual_prompt]: Training 27 / 100 epoch, with learning rate 23.100601201955325
[09/25 23:39:06 visual_prompt]: Epoch 27 / 100: avg data time: 4.43e-02, avg batch time: 0.4872, average train loss: 63.2433
[09/25 23:39:08 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1678, average loss: 28.6138
[09/25 23:39:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.00	rocauc: 91.50	
[09/25 23:39:08 visual_prompt]: Training 28 / 100 epoch, with learning rate 22.86296965693802
[09/25 23:39:14 visual_prompt]: Epoch 28 / 100: avg data time: 4.63e-02, avg batch time: 0.4887, average train loss: 22.0886
[09/25 23:39:15 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1678, average loss: 4.9899
[09/25 23:39:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.27	
[09/25 23:39:15 visual_prompt]: Training 29 / 100 epoch, with learning rate 22.612712429686844
[09/25 23:39:22 visual_prompt]: Epoch 29 / 100: avg data time: 4.52e-02, avg batch time: 0.4902, average train loss: 7.3513
[09/25 23:39:23 visual_prompt]: Inference (val):avg data time: 2.09e-05, avg batch time: 0.1677, average loss: 6.8475
[09/25 23:39:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 68.50	rocauc: 90.67	
[09/25 23:39:23 visual_prompt]: Training 30 / 100 epoch, with learning rate 22.35013442008402
[09/25 23:39:30 visual_prompt]: Epoch 30 / 100: avg data time: 5.52e-02, avg batch time: 0.5002, average train loss: 4.6165
[09/25 23:39:31 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1676, average loss: 1.7127
[09/25 23:39:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.04	
[09/25 23:39:31 visual_prompt]: Training 31 / 100 epoch, with learning rate 22.075555538987224
[09/25 23:39:38 visual_prompt]: Epoch 31 / 100: avg data time: 4.93e-02, avg batch time: 0.4948, average train loss: 4.1918
[09/25 23:39:39 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.1679, average loss: 3.4846
[09/25 23:39:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.00	rocauc: 91.18	
[09/25 23:39:39 visual_prompt]: Training 32 / 100 epoch, with learning rate 21.78931031846743
[09/25 23:39:46 visual_prompt]: Epoch 32 / 100: avg data time: 4.99e-02, avg batch time: 0.4946, average train loss: 14.1086
[09/25 23:39:48 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1677, average loss: 11.8216
[09/25 23:39:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.50	rocauc: 91.97	
[09/25 23:39:48 visual_prompt]: Training 33 / 100 epoch, with learning rate 21.49174750423314
[09/25 23:39:54 visual_prompt]: Epoch 33 / 100: avg data time: 3.84e-02, avg batch time: 0.4837, average train loss: 13.3279
[09/25 23:39:55 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1676, average loss: 13.2246
[09/25 23:39:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 64.00	rocauc: 92.50	
[09/25 23:39:55 visual_prompt]: Training 34 / 100 epoch, with learning rate 21.183229630737465
[09/25 23:40:02 visual_prompt]: Epoch 34 / 100: avg data time: 4.23e-02, avg batch time: 0.4852, average train loss: 7.7570
[09/25 23:40:03 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1675, average loss: 3.6656
[09/25 23:40:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 92.11	
[09/25 23:40:03 visual_prompt]: Training 35 / 100 epoch, with learning rate 20.864132579485727
[09/25 23:40:10 visual_prompt]: Epoch 35 / 100: avg data time: 4.24e-02, avg batch time: 0.4881, average train loss: 4.8972
[09/25 23:40:11 visual_prompt]: Inference (val):avg data time: 1.91e-05, avg batch time: 0.1679, average loss: 9.0732
[09/25 23:40:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 57.00	rocauc: 91.64	
[09/25 23:40:11 visual_prompt]: Training 36 / 100 epoch, with learning rate 20.53484512108174
[09/25 23:40:18 visual_prompt]: Epoch 36 / 100: avg data time: 5.11e-02, avg batch time: 0.4952, average train loss: 5.6758
[09/25 23:40:20 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1677, average loss: 2.7307
[09/25 23:40:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 91.67	
[09/25 23:40:20 visual_prompt]: Training 37 / 100 epoch, with learning rate 20.195768441570728
[09/25 23:40:26 visual_prompt]: Epoch 37 / 100: avg data time: 5.45e-02, avg batch time: 0.4984, average train loss: 7.5734
[09/25 23:40:28 visual_prompt]: Inference (val):avg data time: 2.01e-05, avg batch time: 0.1676, average loss: 3.5882
[09/25 23:40:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 92.23	
[09/25 23:40:28 visual_prompt]: Training 38 / 100 epoch, with learning rate 19.847315653655915
[09/25 23:40:34 visual_prompt]: Epoch 38 / 100: avg data time: 4.96e-02, avg batch time: 0.4943, average train loss: 5.2788
[09/25 23:40:36 visual_prompt]: Inference (val):avg data time: 2.17e-05, avg batch time: 0.1677, average loss: 4.6957
[09/25 23:40:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.00	rocauc: 92.03	
[09/25 23:40:36 visual_prompt]: Training 39 / 100 epoch, with learning rate 19.489911293384335
[09/25 23:40:42 visual_prompt]: Epoch 39 / 100: avg data time: 5.00e-02, avg batch time: 0.4947, average train loss: 4.7866
[09/25 23:40:44 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1678, average loss: 7.1634
[09/25 23:40:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 69.00	rocauc: 92.06	
[09/25 23:40:44 visual_prompt]: Training 40 / 100 epoch, with learning rate 19.12399080291506
[09/25 23:40:51 visual_prompt]: Epoch 40 / 100: avg data time: 5.04e-02, avg batch time: 0.4956, average train loss: 4.6561
[09/25 23:40:52 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1677, average loss: 2.9317
[09/25 23:40:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 92.34	
[09/25 23:40:52 visual_prompt]: Training 41 / 100 epoch, with learning rate 18.75
[09/25 23:40:59 visual_prompt]: Epoch 41 / 100: avg data time: 4.85e-02, avg batch time: 0.4934, average train loss: 3.8496
[09/25 23:41:00 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1677, average loss: 5.0681
[09/25 23:41:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.00	rocauc: 92.17	
[09/25 23:41:00 visual_prompt]: Training 42 / 100 epoch, with learning rate 18.368394534823633
[09/25 23:41:07 visual_prompt]: Epoch 42 / 100: avg data time: 4.86e-02, avg batch time: 0.4930, average train loss: 2.8704
[09/25 23:41:08 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1675, average loss: 4.3261
[09/25 23:41:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 69.00	rocauc: 91.94	
[09/25 23:41:08 visual_prompt]: Training 43 / 100 epoch, with learning rate 17.979639334863467
[09/25 23:41:15 visual_prompt]: Epoch 43 / 100: avg data time: 4.47e-02, avg batch time: 0.4888, average train loss: 4.2409
[09/25 23:41:16 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1678, average loss: 9.4666
[09/25 23:41:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 55.50	rocauc: 91.47	
[09/25 23:41:16 visual_prompt]: Training 44 / 100 epoch, with learning rate 17.584208038447503
[09/25 23:41:22 visual_prompt]: Epoch 44 / 100: avg data time: 3.67e-02, avg batch time: 0.4813, average train loss: 6.7325
[09/25 23:41:24 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1678, average loss: 5.2143
[09/25 23:41:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.50	rocauc: 92.46	
[09/25 23:41:24 visual_prompt]: Training 45 / 100 epoch, with learning rate 17.182582417698903
[09/25 23:41:30 visual_prompt]: Epoch 45 / 100: avg data time: 4.26e-02, avg batch time: 0.4876, average train loss: 5.5752
[09/25 23:41:32 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.1675, average loss: 12.7574
[09/25 23:41:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 59.00	rocauc: 93.04	
[09/25 23:41:32 visual_prompt]: Training 46 / 100 epoch, with learning rate 16.77525179157086
[09/25 23:41:38 visual_prompt]: Epoch 46 / 100: avg data time: 3.89e-02, avg batch time: 0.4835, average train loss: 5.9534
[09/25 23:41:40 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1674, average loss: 3.3376
[09/25 23:41:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 92.79	
[09/25 23:41:40 visual_prompt]: Training 47 / 100 epoch, with learning rate 16.362712429686844
[09/25 23:41:46 visual_prompt]: Epoch 47 / 100: avg data time: 4.85e-02, avg batch time: 0.4939, average train loss: 3.1460
[09/25 23:41:48 visual_prompt]: Inference (val):avg data time: 2.00e-05, avg batch time: 0.1677, average loss: 2.2783
[09/25 23:41:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.45	
[09/25 23:41:48 visual_prompt]: Training 48 / 100 epoch, with learning rate 15.94546694771249
[09/25 23:41:54 visual_prompt]: Epoch 48 / 100: avg data time: 3.60e-02, avg batch time: 0.4829, average train loss: 4.0800
[09/25 23:41:56 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1678, average loss: 7.3236
[09/25 23:41:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 64.00	rocauc: 91.35	
[09/25 23:41:56 visual_prompt]: Training 49 / 100 epoch, with learning rate 15.524023694995845
[09/25 23:42:02 visual_prompt]: Epoch 49 / 100: avg data time: 3.84e-02, avg batch time: 0.4836, average train loss: 5.0928
[09/25 23:42:04 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1678, average loss: 3.0830
[09/25 23:42:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.76	
[09/25 23:42:04 visual_prompt]: Training 50 / 100 epoch, with learning rate 15.09889613522199
[09/25 23:42:10 visual_prompt]: Epoch 50 / 100: avg data time: 4.45e-02, avg batch time: 0.4887, average train loss: 3.6732
[09/25 23:42:12 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1680, average loss: 2.4207
[09/25 23:42:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 92.67	
[09/25 23:42:12 visual_prompt]: Training 51 / 100 epoch, with learning rate 14.670602220836631
[09/25 23:42:18 visual_prompt]: Epoch 51 / 100: avg data time: 4.90e-02, avg batch time: 0.4931, average train loss: 4.6385
[09/25 23:42:20 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1678, average loss: 2.3093
[09/25 23:42:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.45	
[09/25 23:42:20 visual_prompt]: Training 52 / 100 epoch, with learning rate 14.239663762000818
[09/25 23:42:26 visual_prompt]: Epoch 52 / 100: avg data time: 4.68e-02, avg batch time: 0.4911, average train loss: 2.2239
[09/25 23:42:28 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1678, average loss: 2.7352
[09/25 23:42:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 91.83	
[09/25 23:42:28 visual_prompt]: Training 53 / 100 epoch, with learning rate 13.80660579084567
[09/25 23:42:34 visual_prompt]: Epoch 53 / 100: avg data time: 5.05e-02, avg batch time: 0.4958, average train loss: 1.7737
[09/25 23:42:36 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1676, average loss: 2.1522
[09/25 23:42:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 90.83	
[09/25 23:42:36 visual_prompt]: Training 54 / 100 epoch, with learning rate 13.371955921801565
[09/25 23:42:42 visual_prompt]: Epoch 54 / 100: avg data time: 4.61e-02, avg batch time: 0.4905, average train loss: 1.2213
[09/25 23:42:44 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1676, average loss: 1.3126
[09/25 23:42:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 90.20	
[09/25 23:42:44 visual_prompt]: Training 55 / 100 epoch, with learning rate 12.936243708781264
[09/25 23:42:51 visual_prompt]: Epoch 55 / 100: avg data time: 4.96e-02, avg batch time: 0.4945, average train loss: 1.0833
[09/25 23:42:52 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.1680, average loss: 1.2987
[09/25 23:42:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 89.61	
[09/25 23:42:52 visual_prompt]: Training 56 / 100 epoch, with learning rate 12.5
[09/25 23:42:59 visual_prompt]: Epoch 56 / 100: avg data time: 4.27e-02, avg batch time: 0.4878, average train loss: 0.9333
[09/25 23:43:00 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1678, average loss: 1.8062
[09/25 23:43:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.00	rocauc: 91.39	
[09/25 23:43:00 visual_prompt]: Training 57 / 100 epoch, with learning rate 12.063756291218741
[09/25 23:43:07 visual_prompt]: Epoch 57 / 100: avg data time: 4.94e-02, avg batch time: 0.4946, average train loss: 0.9913
[09/25 23:43:08 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1682, average loss: 1.4152
[09/25 23:43:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.00	rocauc: 91.37	
[09/25 23:43:08 visual_prompt]: Training 58 / 100 epoch, with learning rate 11.628044078198434
[09/25 23:43:15 visual_prompt]: Epoch 58 / 100: avg data time: 3.83e-02, avg batch time: 0.4849, average train loss: 2.0219
[09/25 23:43:16 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1675, average loss: 4.7328
[09/25 23:43:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 67.00	rocauc: 91.44	
[09/25 23:43:16 visual_prompt]: Training 59 / 100 epoch, with learning rate 11.193394209154334
[09/25 23:43:23 visual_prompt]: Epoch 59 / 100: avg data time: 5.07e-02, avg batch time: 0.4957, average train loss: 2.1743
[09/25 23:43:24 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.1677, average loss: 1.9041
[09/25 23:43:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 92.90	
[09/25 23:43:24 visual_prompt]: Training 60 / 100 epoch, with learning rate 10.760336237999185
[09/25 23:43:31 visual_prompt]: Epoch 60 / 100: avg data time: 4.69e-02, avg batch time: 0.4948, average train loss: 1.9816
[09/25 23:43:32 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1675, average loss: 2.1720
[09/25 23:43:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.50	rocauc: 92.48	
[09/25 23:43:32 visual_prompt]: Training 61 / 100 epoch, with learning rate 10.32939777916337
[09/25 23:43:39 visual_prompt]: Epoch 61 / 100: avg data time: 4.53e-02, avg batch time: 0.4917, average train loss: 1.1365
[09/25 23:43:40 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.1677, average loss: 1.3952
[09/25 23:43:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.38	
[09/25 23:43:40 visual_prompt]: Training 62 / 100 epoch, with learning rate 9.90110386477801
[09/25 23:43:47 visual_prompt]: Epoch 62 / 100: avg data time: 5.44e-02, avg batch time: 0.4988, average train loss: 1.2426
[09/25 23:43:48 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1680, average loss: 1.4246
[09/25 23:43:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 90.66	
[09/25 23:43:48 visual_prompt]: Training 63 / 100 epoch, with learning rate 9.475976305004155
[09/25 23:43:55 visual_prompt]: Epoch 63 / 100: avg data time: 3.91e-02, avg batch time: 0.4852, average train loss: 1.2700
[09/25 23:43:56 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1678, average loss: 3.6447
[09/25 23:43:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.50	rocauc: 91.11	
[09/25 23:43:56 visual_prompt]: Training 64 / 100 epoch, with learning rate 9.05453305228751
[09/25 23:44:03 visual_prompt]: Epoch 64 / 100: avg data time: 5.57e-02, avg batch time: 0.5009, average train loss: 1.5434
[09/25 23:44:04 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1677, average loss: 3.2865
[09/25 23:44:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.00	rocauc: 92.16	
[09/25 23:44:04 visual_prompt]: Training 65 / 100 epoch, with learning rate 8.637287570313159
[09/25 23:44:11 visual_prompt]: Epoch 65 / 100: avg data time: 4.81e-02, avg batch time: 0.4931, average train loss: 1.5349
[09/25 23:44:13 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1679, average loss: 4.2805
[09/25 23:44:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 68.50	rocauc: 92.19	
[09/25 23:44:13 visual_prompt]: Training 66 / 100 epoch, with learning rate 8.224748208429142
[09/25 23:44:19 visual_prompt]: Epoch 66 / 100: avg data time: 4.63e-02, avg batch time: 0.4927, average train loss: 3.3825
[09/25 23:44:21 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1680, average loss: 1.2536
[09/25 23:44:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.74	
[09/25 23:44:21 visual_prompt]: Training 67 / 100 epoch, with learning rate 7.817417582301099
[09/25 23:44:27 visual_prompt]: Epoch 67 / 100: avg data time: 5.44e-02, avg batch time: 0.4998, average train loss: 1.3042
[09/25 23:44:29 visual_prompt]: Inference (val):avg data time: 3.39e-05, avg batch time: 0.1680, average loss: 2.1298
[09/25 23:44:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.50	rocauc: 92.72	
[09/25 23:44:29 visual_prompt]: Training 68 / 100 epoch, with learning rate 7.415791961552499
[09/25 23:44:35 visual_prompt]: Epoch 68 / 100: avg data time: 4.94e-02, avg batch time: 0.4947, average train loss: 1.4090
[09/25 23:44:37 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1677, average loss: 1.2330
[09/25 23:44:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.57	
[09/25 23:44:37 visual_prompt]: Training 69 / 100 epoch, with learning rate 7.020360665136531
[09/25 23:44:44 visual_prompt]: Epoch 69 / 100: avg data time: 5.57e-02, avg batch time: 0.5003, average train loss: 1.0187
[09/25 23:44:45 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1677, average loss: 1.4121
[09/25 23:44:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 91.14	
[09/25 23:44:45 visual_prompt]: Training 70 / 100 epoch, with learning rate 6.631605465176368
[09/25 23:44:52 visual_prompt]: Epoch 70 / 100: avg data time: 4.99e-02, avg batch time: 0.4960, average train loss: 0.8972
[09/25 23:44:53 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1674, average loss: 1.2197
[09/25 23:44:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 91.85	
[09/25 23:44:53 visual_prompt]: Training 71 / 100 epoch, with learning rate 6.250000000000003
[09/25 23:45:00 visual_prompt]: Epoch 71 / 100: avg data time: 4.87e-02, avg batch time: 0.4935, average train loss: 0.9928
[09/25 23:45:01 visual_prompt]: Inference (val):avg data time: 2.07e-05, avg batch time: 0.1675, average loss: 3.1441
[09/25 23:45:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 71.50	rocauc: 91.22	
[09/25 23:45:01 visual_prompt]: Training 72 / 100 epoch, with learning rate 5.87600919708494
[09/25 23:45:08 visual_prompt]: Epoch 72 / 100: avg data time: 4.47e-02, avg batch time: 0.4899, average train loss: 1.5737
[09/25 23:45:09 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1675, average loss: 1.4836
[09/25 23:45:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 91.64	
[09/25 23:45:09 visual_prompt]: Training 73 / 100 epoch, with learning rate 5.510088706615666
[09/25 23:45:16 visual_prompt]: Epoch 73 / 100: avg data time: 4.21e-02, avg batch time: 0.4871, average train loss: 1.0155
[09/25 23:45:17 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1678, average loss: 2.0764
[09/25 23:45:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 91.49	
[09/25 23:45:17 visual_prompt]: Training 74 / 100 epoch, with learning rate 5.1526843463440875
[09/25 23:45:24 visual_prompt]: Epoch 74 / 100: avg data time: 5.38e-02, avg batch time: 0.4987, average train loss: 0.8149
[09/25 23:45:25 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1677, average loss: 1.1969
[09/25 23:45:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.02	
[09/25 23:45:25 visual_prompt]: Training 75 / 100 epoch, with learning rate 4.804231558429271
[09/25 23:45:32 visual_prompt]: Epoch 75 / 100: avg data time: 4.98e-02, avg batch time: 0.4950, average train loss: 0.7323
[09/25 23:45:33 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1683, average loss: 1.3098
[09/25 23:45:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 90.72	
[09/25 23:45:33 visual_prompt]: Training 76 / 100 epoch, with learning rate 4.465154878918258
[09/25 23:45:40 visual_prompt]: Epoch 76 / 100: avg data time: 4.13e-02, avg batch time: 0.4875, average train loss: 0.5509
[09/25 23:45:41 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1681, average loss: 1.7284
[09/25 23:45:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 90.77	
[09/25 23:45:41 visual_prompt]: Training 77 / 100 epoch, with learning rate 4.135867420514276
[09/25 23:45:48 visual_prompt]: Epoch 77 / 100: avg data time: 5.08e-02, avg batch time: 0.4955, average train loss: 0.5368
[09/25 23:45:49 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1674, average loss: 1.2128
[09/25 23:45:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 90.81	
[09/25 23:45:49 visual_prompt]: Training 78 / 100 epoch, with learning rate 3.816770369262533
[09/25 23:45:56 visual_prompt]: Epoch 78 / 100: avg data time: 3.91e-02, avg batch time: 0.4869, average train loss: 0.5279
[09/25 23:45:57 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1677, average loss: 1.2494
[09/25 23:45:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.22	
[09/25 23:45:57 visual_prompt]: Training 79 / 100 epoch, with learning rate 3.508252495766863
[09/25 23:46:04 visual_prompt]: Epoch 79 / 100: avg data time: 5.37e-02, avg batch time: 0.4989, average train loss: 0.5874
[09/25 23:46:06 visual_prompt]: Inference (val):avg data time: 2.06e-05, avg batch time: 0.1678, average loss: 1.0273
[09/25 23:46:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.06	
[09/25 23:46:06 visual_prompt]: Training 80 / 100 epoch, with learning rate 3.2106896815325707
[09/25 23:46:12 visual_prompt]: Epoch 80 / 100: avg data time: 5.62e-02, avg batch time: 0.5012, average train loss: 0.4659
[09/25 23:46:14 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1677, average loss: 1.0513
[09/25 23:46:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 90.80	
[09/25 23:46:14 visual_prompt]: Training 81 / 100 epoch, with learning rate 2.924444461012776
[09/25 23:46:20 visual_prompt]: Epoch 81 / 100: avg data time: 4.62e-02, avg batch time: 0.4921, average train loss: 0.4753
[09/25 23:46:22 visual_prompt]: Inference (val):avg data time: 1.94e-05, avg batch time: 0.1676, average loss: 1.0069
[09/25 23:46:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 90.56	
[09/25 23:46:22 visual_prompt]: Training 82 / 100 epoch, with learning rate 2.6498655799159763
[09/25 23:46:28 visual_prompt]: Epoch 82 / 100: avg data time: 3.91e-02, avg batch time: 0.4857, average train loss: 0.5055
[09/25 23:46:30 visual_prompt]: Inference (val):avg data time: 3.45e-05, avg batch time: 0.1680, average loss: 1.0178
[09/25 23:46:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 90.64	
[09/25 23:46:30 visual_prompt]: Training 83 / 100 epoch, with learning rate 2.387287570313158
[09/25 23:46:36 visual_prompt]: Epoch 83 / 100: avg data time: 4.75e-02, avg batch time: 0.4937, average train loss: 0.4647
[09/25 23:46:38 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.1676, average loss: 0.9905
[09/25 23:46:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 90.62	
[09/25 23:46:38 visual_prompt]: Training 84 / 100 epoch, with learning rate 2.13703034306198
[09/25 23:46:44 visual_prompt]: Epoch 84 / 100: avg data time: 3.98e-02, avg batch time: 0.4870, average train loss: 0.3833
[09/25 23:46:46 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1676, average loss: 1.1455
[09/25 23:46:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 90.58	
[09/25 23:46:46 visual_prompt]: Training 85 / 100 epoch, with learning rate 1.8993987980446756
[09/25 23:46:52 visual_prompt]: Epoch 85 / 100: avg data time: 3.80e-02, avg batch time: 0.4846, average train loss: 0.4678
[09/25 23:46:54 visual_prompt]: Inference (val):avg data time: 1.91e-05, avg batch time: 0.1676, average loss: 0.9590
[09/25 23:46:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 90.85	
[09/25 23:46:54 visual_prompt]: Training 86 / 100 epoch, with learning rate 1.674682452694516
[09/25 23:47:00 visual_prompt]: Epoch 86 / 100: avg data time: 4.09e-02, avg batch time: 0.4869, average train loss: 0.4441
[09/25 23:47:02 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1676, average loss: 0.9507
[09/25 23:47:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.07	
[09/25 23:47:02 visual_prompt]: Training 87 / 100 epoch, with learning rate 1.4631550892634126
[09/25 23:47:08 visual_prompt]: Epoch 87 / 100: avg data time: 3.89e-02, avg batch time: 0.4845, average train loss: 0.4298
[09/25 23:47:10 visual_prompt]: Inference (val):avg data time: 2.04e-05, avg batch time: 0.1678, average loss: 0.9944
[09/25 23:47:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.02	
[09/25 23:47:10 visual_prompt]: Training 88 / 100 epoch, with learning rate 1.2650744212604148
[09/25 23:47:16 visual_prompt]: Epoch 88 / 100: avg data time: 3.98e-02, avg batch time: 0.4843, average train loss: 0.4256
[09/25 23:47:17 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1678, average loss: 0.9563
[09/25 23:47:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.14	
[09/25 23:47:17 visual_prompt]: Training 89 / 100 epoch, with learning rate 1.0806817794674877
[09/25 23:47:24 visual_prompt]: Epoch 89 / 100: avg data time: 4.08e-02, avg batch time: 0.4860, average train loss: 0.4108
[09/25 23:47:25 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1674, average loss: 1.0404
[09/25 23:47:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 91.16	
[09/25 23:47:25 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.9102018179151585
[09/25 23:47:32 visual_prompt]: Epoch 90 / 100: avg data time: 5.06e-02, avg batch time: 0.4958, average train loss: 0.4448
[09/25 23:47:34 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1676, average loss: 0.9345
[09/25 23:47:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.19	
[09/25 23:47:34 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.753842240176146
[09/25 23:47:40 visual_prompt]: Epoch 91 / 100: avg data time: 3.87e-02, avg batch time: 0.4844, average train loss: 0.3636
[09/25 23:47:41 visual_prompt]: Inference (val):avg data time: 1.91e-05, avg batch time: 0.1678, average loss: 0.9281
[09/25 23:47:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.20	
[09/25 23:47:41 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.6117935463105808
[09/25 23:47:48 visual_prompt]: Epoch 92 / 100: avg data time: 4.06e-02, avg batch time: 0.4868, average train loss: 0.3479
[09/25 23:47:49 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1677, average loss: 0.9193
[09/25 23:47:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.20	
[09/25 23:47:49 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.4842288007710138
[09/25 23:47:56 visual_prompt]: Epoch 93 / 100: avg data time: 4.46e-02, avg batch time: 0.4918, average train loss: 0.3665
[09/25 23:47:57 visual_prompt]: Inference (val):avg data time: 2.03e-05, avg batch time: 0.1680, average loss: 0.9278
[09/25 23:47:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.15	
[09/25 23:47:57 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.3713034215500441
[09/25 23:48:04 visual_prompt]: Epoch 94 / 100: avg data time: 3.99e-02, avg batch time: 0.4867, average train loss: 0.3548
[09/25 23:48:05 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1679, average loss: 0.8956
[09/25 23:48:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.12	
[09/25 23:48:05 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.2731549908274289
[09/25 23:48:12 visual_prompt]: Epoch 95 / 100: avg data time: 3.93e-02, avg batch time: 0.4857, average train loss: 0.4085
[09/25 23:48:13 visual_prompt]: Inference (val):avg data time: 2.01e-05, avg batch time: 0.1679, average loss: 0.9080
[09/25 23:48:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.13	
[09/25 23:48:13 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.18990308734739975
[09/25 23:48:20 visual_prompt]: Epoch 96 / 100: avg data time: 4.54e-02, avg batch time: 0.4903, average train loss: 0.3451
[09/25 23:48:21 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1675, average loss: 0.8966
[09/25 23:48:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.12	
[09/25 23:48:21 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.12164914073037048
[09/25 23:48:28 visual_prompt]: Epoch 97 / 100: avg data time: 3.54e-02, avg batch time: 0.4817, average train loss: 0.3830
[09/25 23:48:29 visual_prompt]: Inference (val):avg data time: 1.91e-05, avg batch time: 0.1679, average loss: 0.9081
[09/25 23:48:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.10	
[09/25 23:48:29 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.06847630789658388
[09/25 23:48:36 visual_prompt]: Epoch 98 / 100: avg data time: 3.91e-02, avg batch time: 0.4838, average train loss: 0.3833
[09/25 23:48:37 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1679, average loss: 0.9139
[09/25 23:48:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.08	
[09/25 23:48:37 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.03044937175219753
[09/25 23:48:44 visual_prompt]: Epoch 99 / 100: avg data time: 5.50e-02, avg batch time: 0.4992, average train loss: 0.3375
[09/25 23:48:45 visual_prompt]: Inference (val):avg data time: 1.99e-05, avg batch time: 0.1676, average loss: 0.9099
[09/25 23:48:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.08	
[09/25 23:48:45 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0076146622613029735
[09/25 23:48:52 visual_prompt]: Epoch 100 / 100: avg data time: 4.02e-02, avg batch time: 0.4867, average train loss: 0.3470
[09/25 23:48:53 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1674, average loss: 0.9069
[09/25 23:48:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.08	
[09/25 23:48:53 visual_prompt]: Rank of current process: 0. World size: 1
[09/25 23:48:53 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/25 23:48:53 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/25 23:48:53 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/25 23:48:53 visual_prompt]: Training with config:
[09/25 23:48:53 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr10.0_wd0.01/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.01, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 10.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/25 23:48:53 visual_prompt]: Loading training data...
[09/25 23:48:53 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/25 23:48:55 visual_prompt]: Number of images: 800
[09/25 23:48:55 visual_prompt]: Number of classes: 2 / 2
[09/25 23:48:55 visual_prompt]: Loading validation data...
[09/25 23:48:55 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/25 23:48:55 visual_prompt]: Number of images: 200
[09/25 23:48:55 visual_prompt]: Number of classes: 2 / 2
[09/25 23:48:55 visual_prompt]: Constructing models...
[09/25 23:48:57 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/25 23:48:57 visual_prompt]: tuned percent:0.536
[09/25 23:48:57 visual_prompt]: Device used for model: 0
[09/25 23:48:57 visual_prompt]: Setting up Evaluator...
[09/25 23:48:57 visual_prompt]: Setting up Trainer...
[09/25 23:48:57 visual_prompt]: 	Setting up the optimizer...
[09/25 23:48:57 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/25 23:49:04 visual_prompt]: Epoch 1 / 100: avg data time: 4.92e-02, avg batch time: 0.4931, average train loss: 1.9797
[09/25 23:49:05 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1674, average loss: 2.0033
[09/25 23:49:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/25 23:49:05 visual_prompt]: Best epoch 1: best metric: 0.520
[09/25 23:49:05 visual_prompt]: Training 2 / 100 epoch, with learning rate 1.0
[09/25 23:49:12 visual_prompt]: Epoch 2 / 100: avg data time: 5.02e-02, avg batch time: 0.4922, average train loss: 21.2595
[09/25 23:49:14 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1670, average loss: 13.6287
[09/25 23:49:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 39.44	
[09/25 23:49:14 visual_prompt]: Training 3 / 100 epoch, with learning rate 2.0
[09/25 23:49:20 visual_prompt]: Epoch 3 / 100: avg data time: 5.21e-02, avg batch time: 0.4949, average train loss: 6.0971
[09/25 23:49:22 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1673, average loss: 5.2956
[09/25 23:49:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 50.52	
[09/25 23:49:22 visual_prompt]: Training 4 / 100 epoch, with learning rate 3.0
[09/25 23:49:28 visual_prompt]: Epoch 4 / 100: avg data time: 5.30e-02, avg batch time: 0.4960, average train loss: 2.8621
[09/25 23:49:30 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1672, average loss: 1.7288
[09/25 23:49:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 48.63	
[09/25 23:49:30 visual_prompt]: Training 5 / 100 epoch, with learning rate 4.0
[09/25 23:49:36 visual_prompt]: Epoch 5 / 100: avg data time: 4.59e-02, avg batch time: 0.4895, average train loss: 3.1121
[09/25 23:49:38 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1678, average loss: 2.2935
[09/25 23:49:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 58.10	
[09/25 23:49:38 visual_prompt]: Training 6 / 100 epoch, with learning rate 5.0
[09/25 23:49:44 visual_prompt]: Epoch 6 / 100: avg data time: 4.79e-02, avg batch time: 0.4912, average train loss: 7.8996
[09/25 23:49:46 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1677, average loss: 2.2659
[09/25 23:49:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 65.02	
[09/25 23:49:46 visual_prompt]: Training 7 / 100 epoch, with learning rate 6.0
[09/25 23:49:53 visual_prompt]: Epoch 7 / 100: avg data time: 5.29e-02, avg batch time: 0.4986, average train loss: 14.9111
[09/25 23:49:54 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1673, average loss: 5.1346
[09/25 23:49:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 66.56	
[09/25 23:49:54 visual_prompt]: Training 8 / 100 epoch, with learning rate 7.0
[09/25 23:50:01 visual_prompt]: Epoch 8 / 100: avg data time: 4.89e-02, avg batch time: 0.4923, average train loss: 15.2651
[09/25 23:50:02 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1674, average loss: 12.5493
[09/25 23:50:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 57.61	
[09/25 23:50:02 visual_prompt]: Training 9 / 100 epoch, with learning rate 8.0
[09/25 23:50:09 visual_prompt]: Epoch 9 / 100: avg data time: 3.88e-02, avg batch time: 0.4831, average train loss: 11.9249
[09/25 23:50:10 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1676, average loss: 16.6716
[09/25 23:50:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 62.36	
[09/25 23:50:10 visual_prompt]: Training 10 / 100 epoch, with learning rate 9.0
[09/25 23:50:17 visual_prompt]: Epoch 10 / 100: avg data time: 4.13e-02, avg batch time: 0.4856, average train loss: 15.3695
[09/25 23:50:18 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.1674, average loss: 14.9590
[09/25 23:50:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 64.26	
[09/25 23:50:18 visual_prompt]: Training 11 / 100 epoch, with learning rate 10.0
[09/25 23:50:25 visual_prompt]: Epoch 11 / 100: avg data time: 5.22e-02, avg batch time: 0.4970, average train loss: 20.1434
[09/25 23:50:26 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1675, average loss: 28.1408
[09/25 23:50:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 37.86	
[09/25 23:50:26 visual_prompt]: Training 12 / 100 epoch, with learning rate 9.996954135095478
[09/25 23:50:33 visual_prompt]: Epoch 12 / 100: avg data time: 4.67e-02, avg batch time: 0.4913, average train loss: 19.5876
[09/25 23:50:34 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1675, average loss: 26.6095
[09/25 23:50:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 48.79	
[09/25 23:50:34 visual_prompt]: Training 13 / 100 epoch, with learning rate 9.987820251299121
[09/25 23:50:41 visual_prompt]: Epoch 13 / 100: avg data time: 4.28e-02, avg batch time: 0.4860, average train loss: 22.2701
[09/25 23:50:42 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1679, average loss: 1.9884
[09/25 23:50:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 62.50	rocauc: 73.90	
[09/25 23:50:42 visual_prompt]: Best epoch 13: best metric: 0.625
[09/25 23:50:42 visual_prompt]: Training 14 / 100 epoch, with learning rate 9.972609476841367
[09/25 23:50:49 visual_prompt]: Epoch 14 / 100: avg data time: 5.63e-02, avg batch time: 0.5002, average train loss: 18.6557
[09/25 23:50:50 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1676, average loss: 99.3463
[09/25 23:50:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 60.75	
[09/25 23:50:50 visual_prompt]: Training 15 / 100 epoch, with learning rate 9.951340343707852
[09/25 23:50:57 visual_prompt]: Epoch 15 / 100: avg data time: 5.10e-02, avg batch time: 0.4942, average train loss: 31.6821
[09/25 23:50:58 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1673, average loss: 34.6320
[09/25 23:50:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 70.67	
[09/25 23:50:58 visual_prompt]: Training 16 / 100 epoch, with learning rate 9.924038765061042
[09/25 23:51:05 visual_prompt]: Epoch 16 / 100: avg data time: 5.06e-02, avg batch time: 0.4934, average train loss: 25.4544
[09/25 23:51:07 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1677, average loss: 6.2968
[09/25 23:51:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 55.06	
[09/25 23:51:07 visual_prompt]: Training 17 / 100 epoch, with learning rate 9.890738003669028
[09/25 23:51:13 visual_prompt]: Epoch 17 / 100: avg data time: 3.92e-02, avg batch time: 0.4853, average train loss: 37.4999
[09/25 23:51:15 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1677, average loss: 12.4108
[09/25 23:51:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 23.92	
[09/25 23:51:15 visual_prompt]: Training 18 / 100 epoch, with learning rate 9.851478631379981
[09/25 23:51:21 visual_prompt]: Epoch 18 / 100: avg data time: 5.36e-02, avg batch time: 0.4979, average train loss: 25.3174
[09/25 23:51:23 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1676, average loss: 38.9059
[09/25 23:51:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.57	
[09/25 23:51:23 visual_prompt]: Training 19 / 100 epoch, with learning rate 9.806308479691594
[09/25 23:51:29 visual_prompt]: Epoch 19 / 100: avg data time: 5.45e-02, avg batch time: 0.4992, average train loss: 20.0176
[09/25 23:51:31 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1678, average loss: 3.5360
[09/25 23:51:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 56.20	
[09/25 23:51:31 visual_prompt]: Training 20 / 100 epoch, with learning rate 9.755282581475768
[09/25 23:51:37 visual_prompt]: Epoch 20 / 100: avg data time: 5.76e-02, avg batch time: 0.5000, average train loss: 33.0031
[09/25 23:51:39 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1674, average loss: 22.0253
[09/25 23:51:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 67.64	
[09/25 23:51:39 visual_prompt]: Training 21 / 100 epoch, with learning rate 9.698463103929543
[09/25 23:51:46 visual_prompt]: Epoch 21 / 100: avg data time: 4.16e-02, avg batch time: 0.4866, average train loss: 28.8613
[09/25 23:51:47 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1681, average loss: 28.3615
[09/25 23:51:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 46.49	
[09/25 23:51:47 visual_prompt]: Training 22 / 100 epoch, with learning rate 9.635919272833938
[09/25 23:51:54 visual_prompt]: Epoch 22 / 100: avg data time: 5.19e-02, avg batch time: 0.4949, average train loss: 15.1323
[09/25 23:51:55 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1673, average loss: 29.0629
[09/25 23:51:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 48.86	
[09/25 23:51:55 visual_prompt]: Training 23 / 100 epoch, with learning rate 9.567727288213003
[09/25 23:52:02 visual_prompt]: Epoch 23 / 100: avg data time: 4.58e-02, avg batch time: 0.4915, average train loss: 24.6064
[09/25 23:52:03 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1675, average loss: 67.1698
[09/25 23:52:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 79.14	
[09/25 23:52:03 visual_prompt]: Training 24 / 100 epoch, with learning rate 9.493970231495835
[09/25 23:52:10 visual_prompt]: Epoch 24 / 100: avg data time: 5.42e-02, avg batch time: 0.4976, average train loss: 30.0096
[09/25 23:52:11 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1678, average loss: 51.8099
[09/25 23:52:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 39.35	
[09/25 23:52:11 visual_prompt]: Training 25 / 100 epoch, with learning rate 9.414737964294634
[09/25 23:52:18 visual_prompt]: Epoch 25 / 100: avg data time: 5.19e-02, avg batch time: 0.4935, average train loss: 38.1558
[09/25 23:52:19 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1677, average loss: 8.0516
[09/25 23:52:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 68.56	
[09/25 23:52:19 visual_prompt]: Training 26 / 100 epoch, with learning rate 9.330127018922195
[09/25 23:52:26 visual_prompt]: Epoch 26 / 100: avg data time: 5.58e-02, avg batch time: 0.4996, average train loss: 28.5957
[09/25 23:52:27 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.1678, average loss: 41.2951
[09/25 23:52:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 27.48	
[09/25 23:52:27 visual_prompt]: Training 27 / 100 epoch, with learning rate 9.240240480782129
[09/25 23:52:34 visual_prompt]: Epoch 27 / 100: avg data time: 5.12e-02, avg batch time: 0.4955, average train loss: 30.9932
[09/25 23:52:36 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.1677, average loss: 21.4872
[09/25 23:52:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 61.87	
[09/25 23:52:36 visual_prompt]: Training 28 / 100 epoch, with learning rate 9.145187862775208
[09/25 23:52:42 visual_prompt]: Epoch 28 / 100: avg data time: 4.98e-02, avg batch time: 0.4924, average train loss: 23.1656
[09/25 23:52:44 visual_prompt]: Inference (val):avg data time: 2.00e-05, avg batch time: 0.1677, average loss: 0.9666
[09/25 23:52:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 54.18	
[09/25 23:52:44 visual_prompt]: Training 29 / 100 epoch, with learning rate 9.045084971874736
[09/25 23:52:50 visual_prompt]: Epoch 29 / 100: avg data time: 4.62e-02, avg batch time: 0.4911, average train loss: 15.4448
[09/25 23:52:52 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1674, average loss: 11.1291
[09/25 23:52:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 48.12	
[09/25 23:52:52 visual_prompt]: Training 30 / 100 epoch, with learning rate 8.940053768033609
[09/25 23:52:58 visual_prompt]: Epoch 30 / 100: avg data time: 3.45e-02, avg batch time: 0.4791, average train loss: 21.3936
[09/25 23:52:59 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1678, average loss: 17.7697
[09/25 23:52:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 65.80	
[09/25 23:52:59 visual_prompt]: Training 31 / 100 epoch, with learning rate 8.83022221559489
[09/25 23:53:06 visual_prompt]: Epoch 31 / 100: avg data time: 5.01e-02, avg batch time: 0.4939, average train loss: 22.2122
[09/25 23:53:08 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1676, average loss: 40.2712
[09/25 23:53:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 33.63	
[09/25 23:53:08 visual_prompt]: Training 32 / 100 epoch, with learning rate 8.715724127386972
[09/25 23:53:14 visual_prompt]: Epoch 32 / 100: avg data time: 4.40e-02, avg batch time: 0.4884, average train loss: 20.1104
[09/25 23:53:16 visual_prompt]: Inference (val):avg data time: 3.44e-05, avg batch time: 0.1679, average loss: 21.7340
[09/25 23:53:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 36.90	
[09/25 23:53:16 visual_prompt]: Training 33 / 100 epoch, with learning rate 8.596699001693256
[09/25 23:53:22 visual_prompt]: Epoch 33 / 100: avg data time: 4.74e-02, avg batch time: 0.4910, average train loss: 28.6439
[09/25 23:53:24 visual_prompt]: Inference (val):avg data time: 2.07e-05, avg batch time: 0.1676, average loss: 16.0040
[09/25 23:53:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 46.15	
[09/25 23:53:24 visual_prompt]: Training 34 / 100 epoch, with learning rate 8.473291852294986
[09/25 23:53:30 visual_prompt]: Epoch 34 / 100: avg data time: 4.28e-02, avg batch time: 0.4878, average train loss: 10.8169
[09/25 23:53:32 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1676, average loss: 11.5686
[09/25 23:53:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 80.88	
[09/25 23:53:32 visual_prompt]: Training 35 / 100 epoch, with learning rate 8.345653031794292
[09/25 23:53:38 visual_prompt]: Epoch 35 / 100: avg data time: 4.91e-02, avg batch time: 0.4920, average train loss: 16.3890
[09/25 23:53:40 visual_prompt]: Inference (val):avg data time: 2.11e-05, avg batch time: 0.1675, average loss: 21.8227
[09/25 23:53:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 51.29	
[09/25 23:53:40 visual_prompt]: Training 36 / 100 epoch, with learning rate 8.213938048432697
[09/25 23:53:47 visual_prompt]: Epoch 36 / 100: avg data time: 4.54e-02, avg batch time: 0.4913, average train loss: 14.4269
[09/25 23:53:48 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.1677, average loss: 3.4206
[09/25 23:53:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 73.02	
[09/25 23:53:48 visual_prompt]: Training 37 / 100 epoch, with learning rate 8.078307376628292
[09/25 23:53:55 visual_prompt]: Epoch 37 / 100: avg data time: 5.04e-02, avg batch time: 0.4933, average train loss: 17.9435
[09/25 23:53:56 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1677, average loss: 7.7844
[09/25 23:53:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 64.79	
[09/25 23:53:56 visual_prompt]: Training 38 / 100 epoch, with learning rate 7.938926261462366
[09/25 23:54:03 visual_prompt]: Epoch 38 / 100: avg data time: 4.57e-02, avg batch time: 0.4908, average train loss: 12.6318
[09/25 23:54:04 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1676, average loss: 14.1413
[09/25 23:54:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 38.58	
[09/25 23:54:04 visual_prompt]: Training 39 / 100 epoch, with learning rate 7.795964517353734
[09/25 23:54:10 visual_prompt]: Epoch 39 / 100: avg data time: 3.58e-02, avg batch time: 0.4811, average train loss: 18.1140
[09/25 23:54:12 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.1675, average loss: 21.7206
[09/25 23:54:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 38.22	
[09/25 23:54:12 visual_prompt]: Training 40 / 100 epoch, with learning rate 7.649596321166024
[09/25 23:54:19 visual_prompt]: Epoch 40 / 100: avg data time: 4.89e-02, avg batch time: 0.4925, average train loss: 16.0663
[09/25 23:54:20 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1676, average loss: 1.0697
[09/25 23:54:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 58.05	
[09/25 23:54:20 visual_prompt]: Training 41 / 100 epoch, with learning rate 7.5
[09/25 23:54:26 visual_prompt]: Epoch 41 / 100: avg data time: 3.88e-02, avg batch time: 0.4830, average train loss: 24.5563
[09/25 23:54:28 visual_prompt]: Inference (val):avg data time: 2.17e-05, avg batch time: 0.1674, average loss: 18.3872
[09/25 23:54:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 56.91	
[09/25 23:54:28 visual_prompt]: Training 42 / 100 epoch, with learning rate 7.347357813929454
[09/25 23:54:34 visual_prompt]: Epoch 42 / 100: avg data time: 5.16e-02, avg batch time: 0.4960, average train loss: 11.6385
[09/25 23:54:36 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1675, average loss: 19.5877
[09/25 23:54:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 40.47	
[09/25 23:54:36 visual_prompt]: Training 43 / 100 epoch, with learning rate 7.191855733945387
[09/25 23:54:43 visual_prompt]: Epoch 43 / 100: avg data time: 5.88e-02, avg batch time: 0.5027, average train loss: 12.1435
[09/25 23:54:44 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1682, average loss: 21.2141
[09/25 23:54:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 28.54	
[09/25 23:54:44 visual_prompt]: Training 44 / 100 epoch, with learning rate 7.033683215379002
[09/25 23:54:51 visual_prompt]: Epoch 44 / 100: avg data time: 4.09e-02, avg batch time: 0.4861, average train loss: 15.3263
[09/25 23:54:52 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1675, average loss: 32.7009
[09/25 23:54:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 77.58	
[09/25 23:54:52 visual_prompt]: Training 45 / 100 epoch, with learning rate 6.873032967079561
[09/25 23:54:59 visual_prompt]: Epoch 45 / 100: avg data time: 3.84e-02, avg batch time: 0.4848, average train loss: 17.5928
[09/25 23:55:00 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1676, average loss: 8.8929
[09/25 23:55:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 58.29	
[09/25 23:55:00 visual_prompt]: Training 46 / 100 epoch, with learning rate 6.710100716628345
[09/25 23:55:07 visual_prompt]: Epoch 46 / 100: avg data time: 4.80e-02, avg batch time: 0.4922, average train loss: 14.5235
[09/25 23:55:08 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1680, average loss: 11.0403
[09/25 23:55:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 50.26	
[09/25 23:55:08 visual_prompt]: Training 47 / 100 epoch, with learning rate 6.545084971874737
[09/25 23:55:15 visual_prompt]: Epoch 47 / 100: avg data time: 3.94e-02, avg batch time: 0.4838, average train loss: 15.1938
[09/25 23:55:16 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1676, average loss: 12.8934
[09/25 23:55:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.16	
[09/25 23:55:16 visual_prompt]: Training 48 / 100 epoch, with learning rate 6.378186779084995
[09/25 23:55:23 visual_prompt]: Epoch 48 / 100: avg data time: 5.10e-02, avg batch time: 0.4948, average train loss: 10.8148
[09/25 23:55:24 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1679, average loss: 4.2565
[09/25 23:55:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 19.99	
[09/25 23:55:24 visual_prompt]: Training 49 / 100 epoch, with learning rate 6.209609477998338
[09/25 23:55:31 visual_prompt]: Epoch 49 / 100: avg data time: 4.53e-02, avg batch time: 0.4904, average train loss: 13.5342
[09/25 23:55:32 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1674, average loss: 23.0839
[09/25 23:55:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 37.29	
[09/25 23:55:32 visual_prompt]: Training 50 / 100 epoch, with learning rate 6.039558454088796
[09/25 23:55:39 visual_prompt]: Epoch 50 / 100: avg data time: 5.07e-02, avg batch time: 0.4946, average train loss: 9.9991
[09/25 23:55:40 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1677, average loss: 9.0705
[09/25 23:55:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 36.18	
[09/25 23:55:40 visual_prompt]: Training 51 / 100 epoch, with learning rate 5.868240888334652
[09/25 23:55:47 visual_prompt]: Epoch 51 / 100: avg data time: 4.71e-02, avg batch time: 0.4921, average train loss: 12.7544
[09/25 23:55:48 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1676, average loss: 16.6296
[09/25 23:55:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 58.52	
[09/25 23:55:48 visual_prompt]: Training 52 / 100 epoch, with learning rate 5.695865504800327
[09/25 23:55:55 visual_prompt]: Epoch 52 / 100: avg data time: 4.33e-02, avg batch time: 0.4872, average train loss: 8.6148
[09/25 23:55:56 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1674, average loss: 2.2270
[09/25 23:55:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 35.21	
[09/25 23:55:56 visual_prompt]: Training 53 / 100 epoch, with learning rate 5.522642316338268
[09/25 23:56:03 visual_prompt]: Epoch 53 / 100: avg data time: 4.47e-02, avg batch time: 0.4907, average train loss: 6.3288
[09/25 23:56:04 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1676, average loss: 5.8612
[09/25 23:56:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 71.23	
[09/25 23:56:04 visual_prompt]: Training 54 / 100 epoch, with learning rate 5.3487823687206255
[09/25 23:56:11 visual_prompt]: Epoch 54 / 100: avg data time: 4.07e-02, avg batch time: 0.4861, average train loss: 9.8755
[09/25 23:56:12 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1678, average loss: 8.6272
[09/25 23:56:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 76.69	
[09/25 23:56:12 visual_prompt]: Training 55 / 100 epoch, with learning rate 5.174497483512505
[09/25 23:56:19 visual_prompt]: Epoch 55 / 100: avg data time: 4.45e-02, avg batch time: 0.4901, average train loss: 15.6530
[09/25 23:56:20 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1673, average loss: 11.6895
[09/25 23:56:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 20.03	
[09/25 23:56:20 visual_prompt]: Training 56 / 100 epoch, with learning rate 5.0
[09/25 23:56:27 visual_prompt]: Epoch 56 / 100: avg data time: 5.63e-02, avg batch time: 0.5002, average train loss: 9.2044
[09/25 23:56:28 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1674, average loss: 12.4462
[09/25 23:56:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 71.74	
[09/25 23:56:28 visual_prompt]: Training 57 / 100 epoch, with learning rate 4.8255025164874965
[09/25 23:56:35 visual_prompt]: Epoch 57 / 100: avg data time: 4.72e-02, avg batch time: 0.4918, average train loss: 13.5413
[09/25 23:56:37 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1674, average loss: 2.7444
[09/25 23:56:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 31.63	
[09/25 23:56:37 visual_prompt]: Training 58 / 100 epoch, with learning rate 4.651217631279374
[09/25 23:56:43 visual_prompt]: Epoch 58 / 100: avg data time: 4.93e-02, avg batch time: 0.4953, average train loss: 13.1888
[09/25 23:56:45 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1676, average loss: 5.2456
[09/25 23:56:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 40.45	
[09/25 23:56:45 visual_prompt]: Training 59 / 100 epoch, with learning rate 4.477357683661733
[09/25 23:56:51 visual_prompt]: Epoch 59 / 100: avg data time: 3.71e-02, avg batch time: 0.4828, average train loss: 9.9253
[09/25 23:56:53 visual_prompt]: Inference (val):avg data time: 2.79e-05, avg batch time: 0.1678, average loss: 9.3009
[09/25 23:56:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 37.01	
[09/25 23:56:53 visual_prompt]: Training 60 / 100 epoch, with learning rate 4.3041344951996745
[09/25 23:56:59 visual_prompt]: Epoch 60 / 100: avg data time: 3.85e-02, avg batch time: 0.4823, average train loss: 8.0610
[09/25 23:57:01 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1676, average loss: 3.4162
[09/25 23:57:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 50.87	
[09/25 23:57:01 visual_prompt]: Training 61 / 100 epoch, with learning rate 4.131759111665349
[09/25 23:57:07 visual_prompt]: Epoch 61 / 100: avg data time: 5.20e-02, avg batch time: 0.4977, average train loss: 7.7897
[09/25 23:57:09 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1677, average loss: 8.5238
[09/25 23:57:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 78.06	
[09/25 23:57:09 visual_prompt]: Training 62 / 100 epoch, with learning rate 3.960441545911204
[09/25 23:57:15 visual_prompt]: Epoch 62 / 100: avg data time: 4.75e-02, avg batch time: 0.4931, average train loss: 7.7902
[09/25 23:57:17 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1673, average loss: 13.5147
[09/25 23:57:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 49.05	
[09/25 23:57:17 visual_prompt]: Training 63 / 100 epoch, with learning rate 3.790390522001662
[09/25 23:57:23 visual_prompt]: Epoch 63 / 100: avg data time: 4.40e-02, avg batch time: 0.4890, average train loss: 9.8926
[09/25 23:57:25 visual_prompt]: Inference (val):avg data time: 3.19e-05, avg batch time: 0.1676, average loss: 88.7300
[09/25 23:57:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 26.89	
[09/25 23:57:25 visual_prompt]: Training 64 / 100 epoch, with learning rate 3.6218132209150045
[09/25 23:57:32 visual_prompt]: Epoch 64 / 100: avg data time: 5.39e-02, avg batch time: 0.4975, average train loss: 16.0636
[09/25 23:57:33 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1675, average loss: 1.9401
[09/25 23:57:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 56.70	
[09/25 23:57:33 visual_prompt]: Training 65 / 100 epoch, with learning rate 3.454915028125263
[09/25 23:57:40 visual_prompt]: Epoch 65 / 100: avg data time: 4.47e-02, avg batch time: 0.4896, average train loss: 6.6045
[09/25 23:57:41 visual_prompt]: Inference (val):avg data time: 3.35e-05, avg batch time: 0.1676, average loss: 2.1777
[09/25 23:57:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 64.04	
[09/25 23:57:41 visual_prompt]: Training 66 / 100 epoch, with learning rate 3.289899283371657
[09/25 23:57:48 visual_prompt]: Epoch 66 / 100: avg data time: 3.91e-02, avg batch time: 0.4845, average train loss: 5.2454
[09/25 23:57:49 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1676, average loss: 3.5540
[09/25 23:57:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 58.26	
[09/25 23:57:49 visual_prompt]: Training 67 / 100 epoch, with learning rate 3.1269670329204398
[09/25 23:57:56 visual_prompt]: Epoch 67 / 100: avg data time: 3.92e-02, avg batch time: 0.4860, average train loss: 3.2109
[09/25 23:57:57 visual_prompt]: Inference (val):avg data time: 2.70e-05, avg batch time: 0.1674, average loss: 7.8284
[09/25 23:57:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 60.14	
[09/25 23:57:57 visual_prompt]: Training 68 / 100 epoch, with learning rate 2.9663167846209997
[09/25 23:58:04 visual_prompt]: Epoch 68 / 100: avg data time: 5.98e-02, avg batch time: 0.5037, average train loss: 7.3356
[09/25 23:58:05 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1676, average loss: 10.3391
[09/25 23:58:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 19.79	
[09/25 23:58:05 visual_prompt]: Training 69 / 100 epoch, with learning rate 2.8081442660546125
[09/25 23:58:12 visual_prompt]: Epoch 69 / 100: avg data time: 4.35e-02, avg batch time: 0.4869, average train loss: 4.2548
[09/25 23:58:13 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1675, average loss: 1.6163
[09/25 23:58:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 38.26	
[09/25 23:58:13 visual_prompt]: Training 70 / 100 epoch, with learning rate 2.6526421860705476
[09/25 23:58:20 visual_prompt]: Epoch 70 / 100: avg data time: 5.42e-02, avg batch time: 0.4987, average train loss: 2.3417
[09/25 23:58:21 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1675, average loss: 0.7309
[09/25 23:58:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 37.34	
[09/25 23:58:21 visual_prompt]: Training 71 / 100 epoch, with learning rate 2.500000000000001
[09/25 23:58:28 visual_prompt]: Epoch 71 / 100: avg data time: 5.48e-02, avg batch time: 0.4987, average train loss: 5.5291
[09/25 23:58:30 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1680, average loss: 1.7255
[09/25 23:58:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 29.71	
[09/25 23:58:30 visual_prompt]: Training 72 / 100 epoch, with learning rate 2.350403678833976
[09/25 23:58:36 visual_prompt]: Epoch 72 / 100: avg data time: 4.95e-02, avg batch time: 0.4935, average train loss: 6.6076
[09/25 23:58:38 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1678, average loss: 6.1235
[09/25 23:58:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.30	
[09/25 23:58:38 visual_prompt]: Training 73 / 100 epoch, with learning rate 2.2040354826462667
[09/25 23:58:44 visual_prompt]: Epoch 73 / 100: avg data time: 5.48e-02, avg batch time: 0.4985, average train loss: 4.6185
[09/25 23:58:46 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1676, average loss: 3.8468
[09/25 23:58:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 51.03	
[09/25 23:58:46 visual_prompt]: Training 74 / 100 epoch, with learning rate 2.061073738537635
[09/25 23:58:52 visual_prompt]: Epoch 74 / 100: avg data time: 4.34e-02, avg batch time: 0.4887, average train loss: 3.4642
[09/25 23:58:54 visual_prompt]: Inference (val):avg data time: 3.12e-05, avg batch time: 0.1676, average loss: 4.6071
[09/25 23:58:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 43.53	
[09/25 23:58:54 visual_prompt]: Training 75 / 100 epoch, with learning rate 1.9216926233717087
[09/25 23:59:01 visual_prompt]: Epoch 75 / 100: avg data time: 5.21e-02, avg batch time: 0.4959, average train loss: 1.8149
[09/25 23:59:02 visual_prompt]: Inference (val):avg data time: 3.14e-05, avg batch time: 0.1677, average loss: 0.6980
[09/25 23:59:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 44.11	
[09/25 23:59:02 visual_prompt]: Training 76 / 100 epoch, with learning rate 1.7860619515673033
[09/25 23:59:08 visual_prompt]: Epoch 76 / 100: avg data time: 3.98e-02, avg batch time: 0.4867, average train loss: 1.4975
[09/25 23:59:10 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1677, average loss: 3.5720
[09/25 23:59:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 51.55	
[09/25 23:59:10 visual_prompt]: Training 77 / 100 epoch, with learning rate 1.6543469682057106
[09/25 23:59:16 visual_prompt]: Epoch 77 / 100: avg data time: 3.85e-02, avg batch time: 0.4849, average train loss: 2.6197
[09/25 23:59:18 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1678, average loss: 0.8788
[09/25 23:59:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.73	
[09/25 23:59:18 visual_prompt]: Training 78 / 100 epoch, with learning rate 1.5267081477050133
[09/25 23:59:25 visual_prompt]: Epoch 78 / 100: avg data time: 5.87e-02, avg batch time: 0.5021, average train loss: 1.2314
[09/25 23:59:26 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1673, average loss: 0.7016
[09/25 23:59:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 70.29	
[09/25 23:59:26 visual_prompt]: Training 79 / 100 epoch, with learning rate 1.403300998306745
[09/25 23:59:33 visual_prompt]: Epoch 79 / 100: avg data time: 5.21e-02, avg batch time: 0.4955, average train loss: 1.8176
[09/25 23:59:34 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1675, average loss: 1.1630
[09/25 23:59:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 30.78	
[09/25 23:59:34 visual_prompt]: Training 80 / 100 epoch, with learning rate 1.2842758726130281
[09/25 23:59:41 visual_prompt]: Epoch 80 / 100: avg data time: 5.36e-02, avg batch time: 0.4980, average train loss: 0.8928
[09/25 23:59:42 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1675, average loss: 2.3818
[09/25 23:59:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 60.93	
[09/25 23:59:42 visual_prompt]: Training 81 / 100 epoch, with learning rate 1.1697777844051105
[09/25 23:59:49 visual_prompt]: Epoch 81 / 100: avg data time: 5.11e-02, avg batch time: 0.4957, average train loss: 1.5064
[09/25 23:59:50 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1675, average loss: 1.7995
[09/25 23:59:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 72.15	
[09/25 23:59:50 visual_prompt]: Training 82 / 100 epoch, with learning rate 1.0599462319663906
[09/25 23:59:57 visual_prompt]: Epoch 82 / 100: avg data time: 5.20e-02, avg batch time: 0.4966, average train loss: 1.4920
[09/25 23:59:59 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1678, average loss: 2.0000
[09/25 23:59:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 86.80	
[09/25 23:59:59 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.9549150281252633
[09/26 00:00:05 visual_prompt]: Epoch 83 / 100: avg data time: 5.12e-02, avg batch time: 0.4962, average train loss: 1.4798
[09/26 00:00:07 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1679, average loss: 1.8232
[09/26 00:00:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 81.62	
[09/26 00:00:07 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.8548121372247919
[09/26 00:00:13 visual_prompt]: Epoch 84 / 100: avg data time: 4.34e-02, avg batch time: 0.4884, average train loss: 0.8956
[09/26 00:00:15 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1676, average loss: 4.5891
[09/26 00:00:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 39.48	
[09/26 00:00:15 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.7597595192178702
[09/26 00:00:21 visual_prompt]: Epoch 85 / 100: avg data time: 4.82e-02, avg batch time: 0.4941, average train loss: 1.4197
[09/26 00:00:23 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1677, average loss: 0.7086
[09/26 00:00:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 72.02	
[09/26 00:00:23 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.6698729810778065
[09/26 00:00:29 visual_prompt]: Epoch 86 / 100: avg data time: 5.40e-02, avg batch time: 0.4979, average train loss: 0.7557
[09/26 00:00:31 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1677, average loss: 0.7010
[09/26 00:00:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.56	
[09/26 00:00:31 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.5852620357053651
[09/26 00:00:38 visual_prompt]: Epoch 87 / 100: avg data time: 5.40e-02, avg batch time: 0.4991, average train loss: 0.7002
[09/26 00:00:39 visual_prompt]: Inference (val):avg data time: 4.02e-05, avg batch time: 0.1675, average loss: 0.7081
[09/26 00:00:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 80.01	
[09/26 00:00:39 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.5060297685041659
[09/26 00:00:46 visual_prompt]: Epoch 88 / 100: avg data time: 4.81e-02, avg batch time: 0.4919, average train loss: 0.7383
[09/26 00:00:47 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1674, average loss: 0.6907
[09/26 00:00:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.65	
[09/26 00:00:47 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.4322727117869951
[09/26 00:00:54 visual_prompt]: Epoch 89 / 100: avg data time: 5.20e-02, avg batch time: 0.4965, average train loss: 0.7394
[09/26 00:00:55 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1677, average loss: 0.6913
[09/26 00:00:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 53.50	rocauc: 68.47	
[09/26 00:00:55 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.36408072716606343
[09/26 00:01:02 visual_prompt]: Epoch 90 / 100: avg data time: 4.51e-02, avg batch time: 0.4895, average train loss: 0.9079
[09/26 00:01:03 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1678, average loss: 0.6633
[09/26 00:01:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.00	rocauc: 76.67	
[09/26 00:01:03 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.3015368960704584
[09/26 00:01:10 visual_prompt]: Epoch 91 / 100: avg data time: 4.27e-02, avg batch time: 0.4894, average train loss: 0.7304
[09/26 00:01:11 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1678, average loss: 0.6987
[09/26 00:01:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 76.00	
[09/26 00:01:11 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.24471741852423234
[09/26 00:01:18 visual_prompt]: Epoch 92 / 100: avg data time: 3.93e-02, avg batch time: 0.4858, average train loss: 0.7206
[09/26 00:01:19 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1680, average loss: 0.6952
[09/26 00:01:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 79.87	
[09/26 00:01:19 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.19369152030840553
[09/26 00:01:26 visual_prompt]: Epoch 93 / 100: avg data time: 5.66e-02, avg batch time: 0.5006, average train loss: 0.6920
[09/26 00:01:27 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1678, average loss: 0.7451
[09/26 00:01:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 87.59	
[09/26 00:01:27 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.14852136862001764
[09/26 00:01:34 visual_prompt]: Epoch 94 / 100: avg data time: 5.29e-02, avg batch time: 0.4969, average train loss: 0.6905
[09/26 00:01:36 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1677, average loss: 0.6880
[09/26 00:01:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.35	
[09/26 00:01:36 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.10926199633097156
[09/26 00:01:42 visual_prompt]: Epoch 95 / 100: avg data time: 5.40e-02, avg batch time: 0.4986, average train loss: 0.6904
[09/26 00:01:44 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1678, average loss: 0.6806
[09/26 00:01:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 88.09	
[09/26 00:01:44 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.0759612349389599
[09/26 00:01:50 visual_prompt]: Epoch 96 / 100: avg data time: 5.13e-02, avg batch time: 0.4959, average train loss: 0.6718
[09/26 00:01:52 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1679, average loss: 0.6748
[09/26 00:01:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 90.83	
[09/26 00:01:52 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.04865965629214819
[09/26 00:01:59 visual_prompt]: Epoch 97 / 100: avg data time: 5.01e-02, avg batch time: 0.4970, average train loss: 0.6499
[09/26 00:02:00 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1680, average loss: 0.5422
[09/26 00:02:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.50	rocauc: 87.18	
[09/26 00:02:00 visual_prompt]: Best epoch 97: best metric: 0.735
[09/26 00:02:00 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.02739052315863355
[09/26 00:02:07 visual_prompt]: Epoch 98 / 100: avg data time: 4.53e-02, avg batch time: 0.4917, average train loss: 0.5963
[09/26 00:02:08 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.1677, average loss: 0.4445
[09/26 00:02:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 90.65	
[09/26 00:02:08 visual_prompt]: Best epoch 98: best metric: 0.825
[09/26 00:02:08 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.012179748700879012
[09/26 00:02:15 visual_prompt]: Epoch 99 / 100: avg data time: 6.38e-02, avg batch time: 0.5089, average train loss: 0.5562
[09/26 00:02:16 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1678, average loss: 0.5241
[09/26 00:02:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.00	rocauc: 92.19	
[09/26 00:02:16 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0030458649045211894
[09/26 00:02:23 visual_prompt]: Epoch 100 / 100: avg data time: 4.47e-02, avg batch time: 0.4903, average train loss: 0.5542
[09/26 00:02:24 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1675, average loss: 0.4179
[09/26 00:02:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.00	
[09/26 00:02:24 visual_prompt]: Best epoch 100: best metric: 0.860
[09/26 00:02:24 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 00:02:24 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 00:02:24 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 00:02:24 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 00:02:24 visual_prompt]: Training with config:
[09/26 00:02:24 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr10.0_wd0.001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 10.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 00:02:24 visual_prompt]: Loading training data...
[09/26 00:02:24 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 00:02:26 visual_prompt]: Number of images: 800
[09/26 00:02:26 visual_prompt]: Number of classes: 2 / 2
[09/26 00:02:26 visual_prompt]: Loading validation data...
[09/26 00:02:26 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 00:02:26 visual_prompt]: Number of images: 200
[09/26 00:02:26 visual_prompt]: Number of classes: 2 / 2
[09/26 00:02:26 visual_prompt]: Constructing models...
[09/26 00:02:28 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 00:02:28 visual_prompt]: tuned percent:0.536
[09/26 00:02:29 visual_prompt]: Device used for model: 0
[09/26 00:02:29 visual_prompt]: Setting up Evaluator...
[09/26 00:02:29 visual_prompt]: Setting up Trainer...
[09/26 00:02:29 visual_prompt]: 	Setting up the optimizer...
[09/26 00:02:29 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 00:02:35 visual_prompt]: Epoch 1 / 100: avg data time: 5.30e-02, avg batch time: 0.4968, average train loss: 1.9702
[09/26 00:02:37 visual_prompt]: Inference (val):avg data time: 2.99e-05, avg batch time: 0.1675, average loss: 2.0033
[09/26 00:02:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 00:02:37 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 00:02:37 visual_prompt]: Training 2 / 100 epoch, with learning rate 1.0
[09/26 00:02:43 visual_prompt]: Epoch 2 / 100: avg data time: 3.55e-02, avg batch time: 0.4782, average train loss: 19.7842
[09/26 00:02:45 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1671, average loss: 7.0904
[09/26 00:02:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.40	
[09/26 00:02:45 visual_prompt]: Training 3 / 100 epoch, with learning rate 2.0
[09/26 00:02:51 visual_prompt]: Epoch 3 / 100: avg data time: 3.87e-02, avg batch time: 0.4837, average train loss: 5.2441
[09/26 00:02:53 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1673, average loss: 3.8575
[09/26 00:02:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.36	
[09/26 00:02:53 visual_prompt]: Training 4 / 100 epoch, with learning rate 3.0
[09/26 00:02:59 visual_prompt]: Epoch 4 / 100: avg data time: 4.46e-02, avg batch time: 0.4879, average train loss: 8.9719
[09/26 00:03:01 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1672, average loss: 12.4119
[09/26 00:03:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.16	
[09/26 00:03:01 visual_prompt]: Training 5 / 100 epoch, with learning rate 4.0
[09/26 00:03:07 visual_prompt]: Epoch 5 / 100: avg data time: 4.00e-02, avg batch time: 0.4844, average train loss: 13.2241
[09/26 00:03:09 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1676, average loss: 15.0522
[09/26 00:03:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 81.24	
[09/26 00:03:09 visual_prompt]: Training 6 / 100 epoch, with learning rate 5.0
[09/26 00:03:15 visual_prompt]: Epoch 6 / 100: avg data time: 3.98e-02, avg batch time: 0.4857, average train loss: 8.0867
[09/26 00:03:17 visual_prompt]: Inference (val):avg data time: 3.83e-05, avg batch time: 0.1677, average loss: 15.4660
[09/26 00:03:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 46.83	
[09/26 00:03:17 visual_prompt]: Training 7 / 100 epoch, with learning rate 6.0
[09/26 00:03:23 visual_prompt]: Epoch 7 / 100: avg data time: 4.51e-02, avg batch time: 0.4890, average train loss: 9.1174
[09/26 00:03:24 visual_prompt]: Inference (val):avg data time: 2.73e-05, avg batch time: 0.1672, average loss: 18.6007
[09/26 00:03:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 40.28	
[09/26 00:03:25 visual_prompt]: Training 8 / 100 epoch, with learning rate 7.0
[09/26 00:03:31 visual_prompt]: Epoch 8 / 100: avg data time: 4.77e-02, avg batch time: 0.4907, average train loss: 10.9406
[09/26 00:03:33 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1669, average loss: 3.1917
[09/26 00:03:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 45.38	
[09/26 00:03:33 visual_prompt]: Training 9 / 100 epoch, with learning rate 8.0
[09/26 00:03:39 visual_prompt]: Epoch 9 / 100: avg data time: 5.39e-02, avg batch time: 0.4971, average train loss: 6.9821
[09/26 00:03:41 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1671, average loss: 20.1376
[09/26 00:03:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 31.12	
[09/26 00:03:41 visual_prompt]: Training 10 / 100 epoch, with learning rate 9.0
[09/26 00:03:47 visual_prompt]: Epoch 10 / 100: avg data time: 5.28e-02, avg batch time: 0.4980, average train loss: 22.7867
[09/26 00:03:49 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1676, average loss: 9.6922
[09/26 00:03:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 57.97	
[09/26 00:03:49 visual_prompt]: Training 11 / 100 epoch, with learning rate 10.0
[09/26 00:03:56 visual_prompt]: Epoch 11 / 100: avg data time: 4.48e-02, avg batch time: 0.4893, average train loss: 19.2533
[09/26 00:03:57 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1676, average loss: 7.2967
[09/26 00:03:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 43.46	
[09/26 00:03:57 visual_prompt]: Training 12 / 100 epoch, with learning rate 9.996954135095478
[09/26 00:04:04 visual_prompt]: Epoch 12 / 100: avg data time: 5.21e-02, avg batch time: 0.4965, average train loss: 14.8592
[09/26 00:04:05 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1677, average loss: 7.8833
[09/26 00:04:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 65.51	
[09/26 00:04:05 visual_prompt]: Training 13 / 100 epoch, with learning rate 9.987820251299121
[09/26 00:04:12 visual_prompt]: Epoch 13 / 100: avg data time: 5.11e-02, avg batch time: 0.4944, average train loss: 11.1651
[09/26 00:04:13 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1675, average loss: 4.2216
[09/26 00:04:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 39.58	
[09/26 00:04:13 visual_prompt]: Training 14 / 100 epoch, with learning rate 9.972609476841367
[09/26 00:04:20 visual_prompt]: Epoch 14 / 100: avg data time: 4.79e-02, avg batch time: 0.4911, average train loss: 20.2309
[09/26 00:04:21 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1674, average loss: 14.3975
[09/26 00:04:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 76.03	
[09/26 00:04:21 visual_prompt]: Training 15 / 100 epoch, with learning rate 9.951340343707852
[09/26 00:04:28 visual_prompt]: Epoch 15 / 100: avg data time: 4.84e-02, avg batch time: 0.4930, average train loss: 11.5931
[09/26 00:04:29 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1672, average loss: 8.2548
[09/26 00:04:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 43.98	
[09/26 00:04:29 visual_prompt]: Training 16 / 100 epoch, with learning rate 9.924038765061042
[09/26 00:04:36 visual_prompt]: Epoch 16 / 100: avg data time: 4.75e-02, avg batch time: 0.4913, average train loss: 18.3000
[09/26 00:04:37 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1672, average loss: 12.4791
[09/26 00:04:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 70.47	
[09/26 00:04:37 visual_prompt]: Training 17 / 100 epoch, with learning rate 9.890738003669028
[09/26 00:04:44 visual_prompt]: Epoch 17 / 100: avg data time: 4.01e-02, avg batch time: 0.4829, average train loss: 24.2066
[09/26 00:04:45 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1676, average loss: 36.5763
[09/26 00:04:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 17.46	
[09/26 00:04:45 visual_prompt]: Training 18 / 100 epoch, with learning rate 9.851478631379981
[09/26 00:04:52 visual_prompt]: Epoch 18 / 100: avg data time: 5.01e-02, avg batch time: 0.4915, average train loss: 39.4162
[09/26 00:04:53 visual_prompt]: Inference (val):avg data time: 3.04e-05, avg batch time: 0.1676, average loss: 7.4118
[09/26 00:04:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 64.00	
[09/26 00:04:53 visual_prompt]: Training 19 / 100 epoch, with learning rate 9.806308479691594
[09/26 00:05:00 visual_prompt]: Epoch 19 / 100: avg data time: 4.80e-02, avg batch time: 0.4925, average train loss: 12.1604
[09/26 00:05:01 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1676, average loss: 6.4609
[09/26 00:05:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 66.17	
[09/26 00:05:01 visual_prompt]: Training 20 / 100 epoch, with learning rate 9.755282581475768
[09/26 00:05:08 visual_prompt]: Epoch 20 / 100: avg data time: 4.86e-02, avg batch time: 0.4918, average train loss: 7.4530
[09/26 00:05:09 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1677, average loss: 4.3660
[09/26 00:05:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 69.40	
[09/26 00:05:09 visual_prompt]: Training 21 / 100 epoch, with learning rate 9.698463103929543
[09/26 00:05:16 visual_prompt]: Epoch 21 / 100: avg data time: 4.62e-02, avg batch time: 0.4932, average train loss: 13.9149
[09/26 00:05:17 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1675, average loss: 6.0960
[09/26 00:05:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 59.51	
[09/26 00:05:17 visual_prompt]: Training 22 / 100 epoch, with learning rate 9.635919272833938
[09/26 00:05:24 visual_prompt]: Epoch 22 / 100: avg data time: 4.80e-02, avg batch time: 0.4941, average train loss: 14.0169
[09/26 00:05:26 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1678, average loss: 12.2208
[09/26 00:05:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 47.25	
[09/26 00:05:26 visual_prompt]: Training 23 / 100 epoch, with learning rate 9.567727288213003
[09/26 00:05:32 visual_prompt]: Epoch 23 / 100: avg data time: 4.09e-02, avg batch time: 0.4849, average train loss: 11.3831
[09/26 00:05:33 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1677, average loss: 15.6982
[09/26 00:05:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 73.57	
[09/26 00:05:33 visual_prompt]: Training 24 / 100 epoch, with learning rate 9.493970231495835
[09/26 00:05:40 visual_prompt]: Epoch 24 / 100: avg data time: 4.54e-02, avg batch time: 0.4910, average train loss: 16.0040
[09/26 00:05:42 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1677, average loss: 5.9557
[09/26 00:05:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 67.23	
[09/26 00:05:42 visual_prompt]: Training 25 / 100 epoch, with learning rate 9.414737964294634
[09/26 00:05:48 visual_prompt]: Epoch 25 / 100: avg data time: 4.95e-02, avg batch time: 0.4923, average train loss: 21.4682
[09/26 00:05:50 visual_prompt]: Inference (val):avg data time: 2.92e-05, avg batch time: 0.1675, average loss: 45.1834
[09/26 00:05:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 64.11	
[09/26 00:05:50 visual_prompt]: Training 26 / 100 epoch, with learning rate 9.330127018922195
[09/26 00:05:56 visual_prompt]: Epoch 26 / 100: avg data time: 4.73e-02, avg batch time: 0.4903, average train loss: 26.3278
[09/26 00:05:58 visual_prompt]: Inference (val):avg data time: 3.01e-05, avg batch time: 0.1675, average loss: 1.5285
[09/26 00:05:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 78.44	
[09/26 00:05:58 visual_prompt]: Training 27 / 100 epoch, with learning rate 9.240240480782129
[09/26 00:06:04 visual_prompt]: Epoch 27 / 100: avg data time: 5.61e-02, avg batch time: 0.4994, average train loss: 10.1576
[09/26 00:06:06 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1675, average loss: 7.4662
[09/26 00:06:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 53.06	
[09/26 00:06:06 visual_prompt]: Training 28 / 100 epoch, with learning rate 9.145187862775208
[09/26 00:06:13 visual_prompt]: Epoch 28 / 100: avg data time: 5.23e-02, avg batch time: 0.4969, average train loss: 16.1708
[09/26 00:06:14 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1679, average loss: 33.9680
[09/26 00:06:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 44.17	
[09/26 00:06:14 visual_prompt]: Training 29 / 100 epoch, with learning rate 9.045084971874736
[09/26 00:06:21 visual_prompt]: Epoch 29 / 100: avg data time: 4.90e-02, avg batch time: 0.4937, average train loss: 28.1000
[09/26 00:06:22 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1676, average loss: 6.4480
[09/26 00:06:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 51.54	
[09/26 00:06:22 visual_prompt]: Training 30 / 100 epoch, with learning rate 8.940053768033609
[09/26 00:06:29 visual_prompt]: Epoch 30 / 100: avg data time: 4.40e-02, avg batch time: 0.4887, average train loss: 13.0046
[09/26 00:06:30 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1673, average loss: 9.2590
[09/26 00:06:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.24	
[09/26 00:06:30 visual_prompt]: Training 31 / 100 epoch, with learning rate 8.83022221559489
[09/26 00:06:37 visual_prompt]: Epoch 31 / 100: avg data time: 4.86e-02, avg batch time: 0.4909, average train loss: 23.6811
[09/26 00:06:38 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1676, average loss: 5.8834
[09/26 00:06:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 81.00	
[09/26 00:06:38 visual_prompt]: Training 32 / 100 epoch, with learning rate 8.715724127386972
[09/26 00:06:45 visual_prompt]: Epoch 32 / 100: avg data time: 5.48e-02, avg batch time: 0.4988, average train loss: 11.1900
[09/26 00:06:46 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1681, average loss: 5.5588
[09/26 00:06:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 70.28	
[09/26 00:06:46 visual_prompt]: Training 33 / 100 epoch, with learning rate 8.596699001693256
[09/26 00:06:53 visual_prompt]: Epoch 33 / 100: avg data time: 5.41e-02, avg batch time: 0.4980, average train loss: 19.6596
[09/26 00:06:55 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1676, average loss: 17.2425
[09/26 00:06:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 34.21	
[09/26 00:06:55 visual_prompt]: Training 34 / 100 epoch, with learning rate 8.473291852294986
[09/26 00:07:01 visual_prompt]: Epoch 34 / 100: avg data time: 5.13e-02, avg batch time: 0.4945, average train loss: 32.1561
[09/26 00:07:03 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1679, average loss: 26.1845
[09/26 00:07:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 49.72	
[09/26 00:07:03 visual_prompt]: Training 35 / 100 epoch, with learning rate 8.345653031794292
[09/26 00:07:09 visual_prompt]: Epoch 35 / 100: avg data time: 5.42e-02, avg batch time: 0.4991, average train loss: 17.6461
[09/26 00:07:11 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1678, average loss: 4.4738
[09/26 00:07:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 75.09	
[09/26 00:07:11 visual_prompt]: Training 36 / 100 epoch, with learning rate 8.213938048432697
[09/26 00:07:18 visual_prompt]: Epoch 36 / 100: avg data time: 5.35e-02, avg batch time: 0.4978, average train loss: 10.8622
[09/26 00:07:19 visual_prompt]: Inference (val):avg data time: 3.08e-05, avg batch time: 0.1676, average loss: 18.6388
[09/26 00:07:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 74.85	
[09/26 00:07:19 visual_prompt]: Training 37 / 100 epoch, with learning rate 8.078307376628292
[09/26 00:07:26 visual_prompt]: Epoch 37 / 100: avg data time: 3.82e-02, avg batch time: 0.4829, average train loss: 15.3594
[09/26 00:07:27 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1675, average loss: 3.3015
[09/26 00:07:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 58.06	
[09/26 00:07:27 visual_prompt]: Training 38 / 100 epoch, with learning rate 7.938926261462366
[09/26 00:07:34 visual_prompt]: Epoch 38 / 100: avg data time: 4.62e-02, avg batch time: 0.4900, average train loss: 11.9175
[09/26 00:07:35 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1673, average loss: 2.8746
[09/26 00:07:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 69.15	
[09/26 00:07:35 visual_prompt]: Training 39 / 100 epoch, with learning rate 7.795964517353734
[09/26 00:07:42 visual_prompt]: Epoch 39 / 100: avg data time: 5.31e-02, avg batch time: 0.4973, average train loss: 19.5196
[09/26 00:07:43 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1678, average loss: 28.8012
[09/26 00:07:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 19.04	
[09/26 00:07:43 visual_prompt]: Training 40 / 100 epoch, with learning rate 7.649596321166024
[09/26 00:07:50 visual_prompt]: Epoch 40 / 100: avg data time: 5.28e-02, avg batch time: 0.4966, average train loss: 14.2272
[09/26 00:07:51 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1678, average loss: 13.4172
[09/26 00:07:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 73.19	
[09/26 00:07:51 visual_prompt]: Training 41 / 100 epoch, with learning rate 7.5
[09/26 00:07:58 visual_prompt]: Epoch 41 / 100: avg data time: 5.83e-02, avg batch time: 0.5034, average train loss: 11.9807
[09/26 00:08:00 visual_prompt]: Inference (val):avg data time: 3.12e-05, avg batch time: 0.1679, average loss: 32.3043
[09/26 00:08:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.97	
[09/26 00:08:00 visual_prompt]: Training 42 / 100 epoch, with learning rate 7.347357813929454
[09/26 00:08:06 visual_prompt]: Epoch 42 / 100: avg data time: 4.99e-02, avg batch time: 0.4943, average train loss: 14.9244
[09/26 00:08:08 visual_prompt]: Inference (val):avg data time: 3.45e-05, avg batch time: 0.1679, average loss: 6.9595
[09/26 00:08:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 37.44	
[09/26 00:08:08 visual_prompt]: Training 43 / 100 epoch, with learning rate 7.191855733945387
[09/26 00:08:15 visual_prompt]: Epoch 43 / 100: avg data time: 5.54e-02, avg batch time: 0.5001, average train loss: 6.0363
[09/26 00:08:16 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1674, average loss: 8.7240
[09/26 00:08:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 52.23	
[09/26 00:08:16 visual_prompt]: Training 44 / 100 epoch, with learning rate 7.033683215379002
[09/26 00:08:23 visual_prompt]: Epoch 44 / 100: avg data time: 5.31e-02, avg batch time: 0.4970, average train loss: 9.5630
[09/26 00:08:24 visual_prompt]: Inference (val):avg data time: 3.21e-05, avg batch time: 0.1677, average loss: 11.1621
[09/26 00:08:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 71.22	
[09/26 00:08:24 visual_prompt]: Training 45 / 100 epoch, with learning rate 6.873032967079561
[09/26 00:08:31 visual_prompt]: Epoch 45 / 100: avg data time: 4.34e-02, avg batch time: 0.4900, average train loss: 8.4275
[09/26 00:08:32 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1672, average loss: 6.7240
[09/26 00:08:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 45.03	
[09/26 00:08:32 visual_prompt]: Training 46 / 100 epoch, with learning rate 6.710100716628345
[09/26 00:08:39 visual_prompt]: Epoch 46 / 100: avg data time: 5.58e-02, avg batch time: 0.4996, average train loss: 4.3747
[09/26 00:08:40 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1670, average loss: 3.4659
[09/26 00:08:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 45.35	
[09/26 00:08:40 visual_prompt]: Training 47 / 100 epoch, with learning rate 6.545084971874737
[09/26 00:08:47 visual_prompt]: Epoch 47 / 100: avg data time: 4.36e-02, avg batch time: 0.4883, average train loss: 4.4818
[09/26 00:08:48 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1677, average loss: 13.2237
[09/26 00:08:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 55.03	
[09/26 00:08:48 visual_prompt]: Training 48 / 100 epoch, with learning rate 6.378186779084995
[09/26 00:08:55 visual_prompt]: Epoch 48 / 100: avg data time: 5.34e-02, avg batch time: 0.4979, average train loss: 9.4170
[09/26 00:08:57 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1677, average loss: 5.1923
[09/26 00:08:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 38.26	
[09/26 00:08:57 visual_prompt]: Training 49 / 100 epoch, with learning rate 6.209609477998338
[09/26 00:09:03 visual_prompt]: Epoch 49 / 100: avg data time: 4.28e-02, avg batch time: 0.4888, average train loss: 10.6567
[09/26 00:09:05 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1677, average loss: 8.2839
[09/26 00:09:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 67.44	
[09/26 00:09:05 visual_prompt]: Training 50 / 100 epoch, with learning rate 6.039558454088796
[09/26 00:09:11 visual_prompt]: Epoch 50 / 100: avg data time: 5.10e-02, avg batch time: 0.4956, average train loss: 11.3548
[09/26 00:09:13 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1675, average loss: 2.9174
[09/26 00:09:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 72.85	
[09/26 00:09:13 visual_prompt]: Training 51 / 100 epoch, with learning rate 5.868240888334652
[09/26 00:09:20 visual_prompt]: Epoch 51 / 100: avg data time: 5.55e-02, avg batch time: 0.4995, average train loss: 9.9215
[09/26 00:09:21 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1672, average loss: 24.8419
[09/26 00:09:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 70.82	
[09/26 00:09:21 visual_prompt]: Training 52 / 100 epoch, with learning rate 5.695865504800327
[09/26 00:09:28 visual_prompt]: Epoch 52 / 100: avg data time: 4.33e-02, avg batch time: 0.4875, average train loss: 13.8700
[09/26 00:09:29 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1674, average loss: 24.8224
[09/26 00:09:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 50.50	rocauc: 63.07	
[09/26 00:09:29 visual_prompt]: Training 53 / 100 epoch, with learning rate 5.522642316338268
[09/26 00:09:36 visual_prompt]: Epoch 53 / 100: avg data time: 5.03e-02, avg batch time: 0.4949, average train loss: 12.5046
[09/26 00:09:37 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1676, average loss: 12.8384
[09/26 00:09:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 70.42	
[09/26 00:09:37 visual_prompt]: Training 54 / 100 epoch, with learning rate 5.3487823687206255
[09/26 00:09:44 visual_prompt]: Epoch 54 / 100: avg data time: 4.38e-02, avg batch time: 0.4892, average train loss: 7.5988
[09/26 00:09:45 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1676, average loss: 4.6179
[09/26 00:09:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 76.12	
[09/26 00:09:45 visual_prompt]: Training 55 / 100 epoch, with learning rate 5.174497483512505
[09/26 00:09:52 visual_prompt]: Epoch 55 / 100: avg data time: 4.68e-02, avg batch time: 0.4922, average train loss: 6.6063
[09/26 00:09:53 visual_prompt]: Inference (val):avg data time: 2.99e-05, avg batch time: 0.1677, average loss: 18.2258
[09/26 00:09:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 59.33	
[09/26 00:09:53 visual_prompt]: Training 56 / 100 epoch, with learning rate 5.0
[09/26 00:10:00 visual_prompt]: Epoch 56 / 100: avg data time: 4.08e-02, avg batch time: 0.4854, average train loss: 8.8905
[09/26 00:10:01 visual_prompt]: Inference (val):avg data time: 2.76e-05, avg batch time: 0.1676, average loss: 2.8534
[09/26 00:10:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 79.73	
[09/26 00:10:01 visual_prompt]: Training 57 / 100 epoch, with learning rate 4.8255025164874965
[09/26 00:10:08 visual_prompt]: Epoch 57 / 100: avg data time: 4.70e-02, avg batch time: 0.4916, average train loss: 6.5283
[09/26 00:10:09 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1676, average loss: 10.5555
[09/26 00:10:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 49.00	rocauc: 63.33	
[09/26 00:10:09 visual_prompt]: Training 58 / 100 epoch, with learning rate 4.651217631279374
[09/26 00:10:16 visual_prompt]: Epoch 58 / 100: avg data time: 5.35e-02, avg batch time: 0.4969, average train loss: 6.2659
[09/26 00:10:17 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1677, average loss: 10.0209
[09/26 00:10:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 61.17	
[09/26 00:10:17 visual_prompt]: Training 59 / 100 epoch, with learning rate 4.477357683661733
[09/26 00:10:24 visual_prompt]: Epoch 59 / 100: avg data time: 5.62e-02, avg batch time: 0.5008, average train loss: 12.1259
[09/26 00:10:25 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1676, average loss: 17.0372
[09/26 00:10:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 79.44	
[09/26 00:10:25 visual_prompt]: Training 60 / 100 epoch, with learning rate 4.3041344951996745
[09/26 00:10:32 visual_prompt]: Epoch 60 / 100: avg data time: 4.09e-02, avg batch time: 0.4860, average train loss: 8.7929
[09/26 00:10:33 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1678, average loss: 10.9380
[09/26 00:10:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 32.65	
[09/26 00:10:33 visual_prompt]: Training 61 / 100 epoch, with learning rate 4.131759111665349
[09/26 00:10:40 visual_prompt]: Epoch 61 / 100: avg data time: 3.85e-02, avg batch time: 0.4854, average train loss: 11.6411
[09/26 00:10:41 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1673, average loss: 5.0528
[09/26 00:10:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.31	
[09/26 00:10:41 visual_prompt]: Training 62 / 100 epoch, with learning rate 3.960441545911204
[09/26 00:10:48 visual_prompt]: Epoch 62 / 100: avg data time: 5.42e-02, avg batch time: 0.4995, average train loss: 7.8384
[09/26 00:10:49 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1678, average loss: 21.5123
[09/26 00:10:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 81.30	
[09/26 00:10:49 visual_prompt]: Training 63 / 100 epoch, with learning rate 3.790390522001662
[09/26 00:10:56 visual_prompt]: Epoch 63 / 100: avg data time: 4.25e-02, avg batch time: 0.4866, average train loss: 13.3583
[09/26 00:10:57 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1679, average loss: 10.0420
[09/26 00:10:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 72.90	
[09/26 00:10:57 visual_prompt]: Training 64 / 100 epoch, with learning rate 3.6218132209150045
[09/26 00:11:04 visual_prompt]: Epoch 64 / 100: avg data time: 3.99e-02, avg batch time: 0.4852, average train loss: 9.4719
[09/26 00:11:05 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1679, average loss: 1.6303
[09/26 00:11:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 82.09	
[09/26 00:11:05 visual_prompt]: Training 65 / 100 epoch, with learning rate 3.454915028125263
[09/26 00:11:12 visual_prompt]: Epoch 65 / 100: avg data time: 4.53e-02, avg batch time: 0.4906, average train loss: 8.0448
[09/26 00:11:13 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1676, average loss: 4.0225
[09/26 00:11:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 53.68	
[09/26 00:11:13 visual_prompt]: Training 66 / 100 epoch, with learning rate 3.289899283371657
[09/26 00:11:20 visual_prompt]: Epoch 66 / 100: avg data time: 3.84e-02, avg batch time: 0.4829, average train loss: 4.6721
[09/26 00:11:21 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1677, average loss: 7.8623
[09/26 00:11:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 80.23	
[09/26 00:11:21 visual_prompt]: Training 67 / 100 epoch, with learning rate 3.1269670329204398
[09/26 00:11:28 visual_prompt]: Epoch 67 / 100: avg data time: 5.26e-02, avg batch time: 0.4963, average train loss: 3.1096
[09/26 00:11:29 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1676, average loss: 4.8350
[09/26 00:11:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 77.67	
[09/26 00:11:29 visual_prompt]: Training 68 / 100 epoch, with learning rate 2.9663167846209997
[09/26 00:11:36 visual_prompt]: Epoch 68 / 100: avg data time: 3.95e-02, avg batch time: 0.4851, average train loss: 2.6383
[09/26 00:11:37 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1678, average loss: 3.3018
[09/26 00:11:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 75.41	
[09/26 00:11:37 visual_prompt]: Training 69 / 100 epoch, with learning rate 2.8081442660546125
[09/26 00:11:44 visual_prompt]: Epoch 69 / 100: avg data time: 4.24e-02, avg batch time: 0.4881, average train loss: 1.5316
[09/26 00:11:45 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1677, average loss: 3.3993
[09/26 00:11:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.58	
[09/26 00:11:45 visual_prompt]: Training 70 / 100 epoch, with learning rate 2.6526421860705476
[09/26 00:11:52 visual_prompt]: Epoch 70 / 100: avg data time: 5.05e-02, avg batch time: 0.4953, average train loss: 1.8012
[09/26 00:11:53 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.1674, average loss: 1.4763
[09/26 00:11:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.25	
[09/26 00:11:53 visual_prompt]: Training 71 / 100 epoch, with learning rate 2.500000000000001
[09/26 00:12:00 visual_prompt]: Epoch 71 / 100: avg data time: 4.83e-02, avg batch time: 0.4928, average train loss: 1.7513
[09/26 00:12:01 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1676, average loss: 1.7023
[09/26 00:12:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 62.61	
[09/26 00:12:01 visual_prompt]: Training 72 / 100 epoch, with learning rate 2.350403678833976
[09/26 00:12:08 visual_prompt]: Epoch 72 / 100: avg data time: 4.84e-02, avg batch time: 0.4935, average train loss: 3.2053
[09/26 00:12:10 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1677, average loss: 0.9687
[09/26 00:12:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 47.86	
[09/26 00:12:10 visual_prompt]: Training 73 / 100 epoch, with learning rate 2.2040354826462667
[09/26 00:12:16 visual_prompt]: Epoch 73 / 100: avg data time: 4.02e-02, avg batch time: 0.4853, average train loss: 0.9736
[09/26 00:12:18 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1674, average loss: 0.8811
[09/26 00:12:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 73.63	
[09/26 00:12:18 visual_prompt]: Training 74 / 100 epoch, with learning rate 2.061073738537635
[09/26 00:12:24 visual_prompt]: Epoch 74 / 100: avg data time: 4.70e-02, avg batch time: 0.4938, average train loss: 2.6542
[09/26 00:12:26 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1674, average loss: 0.8053
[09/26 00:12:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 65.67	
[09/26 00:12:26 visual_prompt]: Training 75 / 100 epoch, with learning rate 1.9216926233717087
[09/26 00:12:32 visual_prompt]: Epoch 75 / 100: avg data time: 4.66e-02, avg batch time: 0.4902, average train loss: 1.1224
[09/26 00:12:34 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1678, average loss: 0.6697
[09/26 00:12:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 75.97	
[09/26 00:12:34 visual_prompt]: Training 76 / 100 epoch, with learning rate 1.7860619515673033
[09/26 00:12:40 visual_prompt]: Epoch 76 / 100: avg data time: 4.13e-02, avg batch time: 0.4859, average train loss: 1.1403
[09/26 00:12:42 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1675, average loss: 0.8018
[09/26 00:12:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.78	
[09/26 00:12:42 visual_prompt]: Training 77 / 100 epoch, with learning rate 1.6543469682057106
[09/26 00:12:48 visual_prompt]: Epoch 77 / 100: avg data time: 4.40e-02, avg batch time: 0.4896, average train loss: 1.6543
[09/26 00:12:50 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1673, average loss: 2.0522
[09/26 00:12:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 81.74	
[09/26 00:12:50 visual_prompt]: Training 78 / 100 epoch, with learning rate 1.5267081477050133
[09/26 00:12:56 visual_prompt]: Epoch 78 / 100: avg data time: 4.50e-02, avg batch time: 0.4885, average train loss: 1.6478
[09/26 00:12:58 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1678, average loss: 1.5515
[09/26 00:12:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 67.48	
[09/26 00:12:58 visual_prompt]: Training 79 / 100 epoch, with learning rate 1.403300998306745
[09/26 00:13:04 visual_prompt]: Epoch 79 / 100: avg data time: 4.80e-02, avg batch time: 0.4924, average train loss: 1.3268
[09/26 00:13:06 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1675, average loss: 0.6849
[09/26 00:13:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 79.11	
[09/26 00:13:06 visual_prompt]: Training 80 / 100 epoch, with learning rate 1.2842758726130281
[09/26 00:13:12 visual_prompt]: Epoch 80 / 100: avg data time: 3.91e-02, avg batch time: 0.4854, average train loss: 0.8074
[09/26 00:13:14 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1675, average loss: 0.6623
[09/26 00:13:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.00	rocauc: 80.49	
[09/26 00:13:14 visual_prompt]: Best epoch 80: best metric: 0.600
[09/26 00:13:14 visual_prompt]: Training 81 / 100 epoch, with learning rate 1.1697777844051105
[09/26 00:13:20 visual_prompt]: Epoch 81 / 100: avg data time: 4.13e-02, avg batch time: 0.4850, average train loss: 1.2415
[09/26 00:13:22 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1676, average loss: 0.7692
[09/26 00:13:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 51.61	
[09/26 00:13:22 visual_prompt]: Training 82 / 100 epoch, with learning rate 1.0599462319663906
[09/26 00:13:28 visual_prompt]: Epoch 82 / 100: avg data time: 5.11e-02, avg batch time: 0.4938, average train loss: 0.7738
[09/26 00:13:30 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1674, average loss: 1.1258
[09/26 00:13:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 83.36	
[09/26 00:13:30 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.9549150281252633
[09/26 00:13:36 visual_prompt]: Epoch 83 / 100: avg data time: 3.81e-02, avg batch time: 0.4822, average train loss: 0.9182
[09/26 00:13:38 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.1672, average loss: 1.6468
[09/26 00:13:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.70	
[09/26 00:13:38 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.8548121372247919
[09/26 00:13:44 visual_prompt]: Epoch 84 / 100: avg data time: 5.12e-02, avg batch time: 0.4955, average train loss: 1.6510
[09/26 00:13:46 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1672, average loss: 2.0350
[09/26 00:13:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.06	
[09/26 00:13:46 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.7597595192178702
[09/26 00:13:52 visual_prompt]: Epoch 85 / 100: avg data time: 4.59e-02, avg batch time: 0.4897, average train loss: 1.5343
[09/26 00:13:54 visual_prompt]: Inference (val):avg data time: 3.24e-05, avg batch time: 0.1673, average loss: 0.7155
[09/26 00:13:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.50	rocauc: 85.53	
[09/26 00:13:54 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.6698729810778065
[09/26 00:14:00 visual_prompt]: Epoch 86 / 100: avg data time: 4.74e-02, avg batch time: 0.4922, average train loss: 0.7504
[09/26 00:14:02 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1674, average loss: 0.5896
[09/26 00:14:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.00	rocauc: 85.75	
[09/26 00:14:02 visual_prompt]: Best epoch 86: best metric: 0.700
[09/26 00:14:02 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.5852620357053651
[09/26 00:14:09 visual_prompt]: Epoch 87 / 100: avg data time: 5.48e-02, avg batch time: 0.4990, average train loss: 0.5951
[09/26 00:14:10 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1679, average loss: 0.6260
[09/26 00:14:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 61.00	rocauc: 88.78	
[09/26 00:14:10 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.5060297685041659
[09/26 00:14:17 visual_prompt]: Epoch 88 / 100: avg data time: 4.13e-02, avg batch time: 0.4870, average train loss: 0.8443
[09/26 00:14:18 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1672, average loss: 0.6835
[09/26 00:14:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.83	
[09/26 00:14:18 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.4322727117869951
[09/26 00:14:25 visual_prompt]: Epoch 89 / 100: avg data time: 4.49e-02, avg batch time: 0.4884, average train loss: 0.7415
[09/26 00:14:26 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1674, average loss: 0.6952
[09/26 00:14:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 81.56	
[09/26 00:14:26 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.36408072716606343
[09/26 00:14:32 visual_prompt]: Epoch 90 / 100: avg data time: 4.02e-02, avg batch time: 0.4860, average train loss: 0.6454
[09/26 00:14:34 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1675, average loss: 0.5034
[09/26 00:14:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 87.58	
[09/26 00:14:34 visual_prompt]: Best epoch 90: best metric: 0.805
[09/26 00:14:34 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.3015368960704584
[09/26 00:14:41 visual_prompt]: Epoch 91 / 100: avg data time: 4.08e-02, avg batch time: 0.4860, average train loss: 0.6604
[09/26 00:14:42 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1676, average loss: 0.5733
[09/26 00:14:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 87.77	
[09/26 00:14:42 visual_prompt]: Best epoch 91: best metric: 0.835
[09/26 00:14:42 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.24471741852423234
[09/26 00:14:49 visual_prompt]: Epoch 92 / 100: avg data time: 3.79e-02, avg batch time: 0.4845, average train loss: 0.6702
[09/26 00:14:50 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1675, average loss: 0.5747
[09/26 00:14:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 64.00	rocauc: 88.09	
[09/26 00:14:50 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.19369152030840553
[09/26 00:14:57 visual_prompt]: Epoch 93 / 100: avg data time: 5.05e-02, avg batch time: 0.4949, average train loss: 0.6383
[09/26 00:14:58 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1676, average loss: 0.5122
[09/26 00:14:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 88.26	
[09/26 00:14:58 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.14852136862001764
[09/26 00:15:05 visual_prompt]: Epoch 94 / 100: avg data time: 5.66e-02, avg batch time: 0.5003, average train loss: 0.6065
[09/26 00:15:06 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1676, average loss: 0.5748
[09/26 00:15:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 68.00	rocauc: 88.44	
[09/26 00:15:06 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.10926199633097156
[09/26 00:15:13 visual_prompt]: Epoch 95 / 100: avg data time: 5.21e-02, avg batch time: 0.4957, average train loss: 0.5806
[09/26 00:15:14 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1675, average loss: 0.5242
[09/26 00:15:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 71.00	rocauc: 88.93	
[09/26 00:15:14 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.0759612349389599
[09/26 00:15:21 visual_prompt]: Epoch 96 / 100: avg data time: 3.79e-02, avg batch time: 0.4835, average train loss: 0.5823
[09/26 00:15:22 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1679, average loss: 0.4892
[09/26 00:15:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.50	rocauc: 88.90	
[09/26 00:15:22 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.04865965629214819
[09/26 00:15:29 visual_prompt]: Epoch 97 / 100: avg data time: 4.41e-02, avg batch time: 0.4899, average train loss: 0.5484
[09/26 00:15:30 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1675, average loss: 0.4946
[09/26 00:15:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.50	rocauc: 88.91	
[09/26 00:15:30 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.02739052315863355
[09/26 00:15:37 visual_prompt]: Epoch 98 / 100: avg data time: 4.42e-02, avg batch time: 0.4908, average train loss: 0.5246
[09/26 00:15:38 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1675, average loss: 0.4306
[09/26 00:15:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 88.73	
[09/26 00:15:38 visual_prompt]: Best epoch 98: best metric: 0.845
[09/26 00:15:38 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.012179748700879012
[09/26 00:15:45 visual_prompt]: Epoch 99 / 100: avg data time: 4.38e-02, avg batch time: 0.4902, average train loss: 0.5008
[09/26 00:15:46 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1679, average loss: 0.4285
[09/26 00:15:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 88.71	
[09/26 00:15:46 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0030458649045211894
[09/26 00:15:53 visual_prompt]: Epoch 100 / 100: avg data time: 4.67e-02, avg batch time: 0.4915, average train loss: 0.5102
[09/26 00:15:55 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1677, average loss: 0.4287
[09/26 00:15:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 88.80	
[09/26 00:15:55 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 00:15:55 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 00:15:55 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 00:15:55 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 00:15:55 visual_prompt]: Training with config:
[09/26 00:15:55 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr10.0_wd0.0001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 10.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 00:15:55 visual_prompt]: Loading training data...
[09/26 00:15:55 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 00:15:56 visual_prompt]: Number of images: 800
[09/26 00:15:56 visual_prompt]: Number of classes: 2 / 2
[09/26 00:15:56 visual_prompt]: Loading validation data...
[09/26 00:15:56 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 00:15:56 visual_prompt]: Number of images: 200
[09/26 00:15:56 visual_prompt]: Number of classes: 2 / 2
[09/26 00:15:56 visual_prompt]: Constructing models...
[09/26 00:15:58 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 00:15:58 visual_prompt]: tuned percent:0.536
[09/26 00:15:59 visual_prompt]: Device used for model: 0
[09/26 00:15:59 visual_prompt]: Setting up Evaluator...
[09/26 00:15:59 visual_prompt]: Setting up Trainer...
[09/26 00:15:59 visual_prompt]: 	Setting up the optimizer...
[09/26 00:15:59 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 00:16:05 visual_prompt]: Epoch 1 / 100: avg data time: 4.17e-02, avg batch time: 0.4876, average train loss: 1.9950
[09/26 00:16:07 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1673, average loss: 2.0033
[09/26 00:16:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 00:16:07 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 00:16:07 visual_prompt]: Training 2 / 100 epoch, with learning rate 1.0
[09/26 00:16:13 visual_prompt]: Epoch 2 / 100: avg data time: 5.34e-02, avg batch time: 0.4958, average train loss: 20.4362
[09/26 00:16:15 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1670, average loss: 14.1330
[09/26 00:16:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 64.44	
[09/26 00:16:15 visual_prompt]: Training 3 / 100 epoch, with learning rate 2.0
[09/26 00:16:21 visual_prompt]: Epoch 3 / 100: avg data time: 5.63e-02, avg batch time: 0.4993, average train loss: 9.0377
[09/26 00:16:23 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1670, average loss: 6.1518
[09/26 00:16:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 80.92	
[09/26 00:16:23 visual_prompt]: Training 4 / 100 epoch, with learning rate 3.0
[09/26 00:16:29 visual_prompt]: Epoch 4 / 100: avg data time: 4.72e-02, avg batch time: 0.4914, average train loss: 10.1876
[09/26 00:16:31 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1672, average loss: 6.4466
[09/26 00:16:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.60	
[09/26 00:16:31 visual_prompt]: Training 5 / 100 epoch, with learning rate 4.0
[09/26 00:16:38 visual_prompt]: Epoch 5 / 100: avg data time: 4.91e-02, avg batch time: 0.4936, average train loss: 12.1706
[09/26 00:16:39 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1672, average loss: 15.3176
[09/26 00:16:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.03	
[09/26 00:16:39 visual_prompt]: Training 6 / 100 epoch, with learning rate 5.0
[09/26 00:16:46 visual_prompt]: Epoch 6 / 100: avg data time: 5.75e-02, avg batch time: 0.5021, average train loss: 11.0901
[09/26 00:16:47 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1672, average loss: 4.0787
[09/26 00:16:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.14	
[09/26 00:16:47 visual_prompt]: Training 7 / 100 epoch, with learning rate 6.0
[09/26 00:16:54 visual_prompt]: Epoch 7 / 100: avg data time: 5.10e-02, avg batch time: 0.4953, average train loss: 5.6314
[09/26 00:16:55 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1672, average loss: 11.0202
[09/26 00:16:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 87.37	
[09/26 00:16:55 visual_prompt]: Training 8 / 100 epoch, with learning rate 7.0
[09/26 00:17:02 visual_prompt]: Epoch 8 / 100: avg data time: 4.64e-02, avg batch time: 0.4904, average train loss: 10.9058
[09/26 00:17:03 visual_prompt]: Inference (val):avg data time: 3.99e-05, avg batch time: 0.1672, average loss: 27.5188
[09/26 00:17:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 86.35	
[09/26 00:17:03 visual_prompt]: Training 9 / 100 epoch, with learning rate 8.0
[09/26 00:17:10 visual_prompt]: Epoch 9 / 100: avg data time: 4.48e-02, avg batch time: 0.4897, average train loss: 22.7493
[09/26 00:17:11 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1674, average loss: 37.2128
[09/26 00:17:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.96	
[09/26 00:17:11 visual_prompt]: Training 10 / 100 epoch, with learning rate 9.0
[09/26 00:17:18 visual_prompt]: Epoch 10 / 100: avg data time: 4.23e-02, avg batch time: 0.4857, average train loss: 26.8219
[09/26 00:17:19 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1676, average loss: 65.0869
[09/26 00:17:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 80.84	
[09/26 00:17:19 visual_prompt]: Training 11 / 100 epoch, with learning rate 10.0
[09/26 00:17:26 visual_prompt]: Epoch 11 / 100: avg data time: 5.78e-02, avg batch time: 0.5012, average train loss: 26.7294
[09/26 00:17:27 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1671, average loss: 36.0528
[09/26 00:17:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 68.72	
[09/26 00:17:27 visual_prompt]: Training 12 / 100 epoch, with learning rate 9.996954135095478
[09/26 00:17:34 visual_prompt]: Epoch 12 / 100: avg data time: 4.51e-02, avg batch time: 0.4886, average train loss: 14.2407
[09/26 00:17:35 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1673, average loss: 9.1075
[09/26 00:17:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 46.60	
[09/26 00:17:35 visual_prompt]: Training 13 / 100 epoch, with learning rate 9.987820251299121
[09/26 00:17:42 visual_prompt]: Epoch 13 / 100: avg data time: 5.04e-02, avg batch time: 0.4947, average train loss: 12.7172
[09/26 00:17:43 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1672, average loss: 12.0176
[09/26 00:17:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.78	
[09/26 00:17:43 visual_prompt]: Training 14 / 100 epoch, with learning rate 9.972609476841367
[09/26 00:17:50 visual_prompt]: Epoch 14 / 100: avg data time: 3.98e-02, avg batch time: 0.4848, average train loss: 6.5428
[09/26 00:17:51 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1675, average loss: 14.8015
[09/26 00:17:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.49	
[09/26 00:17:51 visual_prompt]: Training 15 / 100 epoch, with learning rate 9.951340343707852
[09/26 00:17:58 visual_prompt]: Epoch 15 / 100: avg data time: 3.97e-02, avg batch time: 0.4853, average train loss: 8.4308
[09/26 00:17:59 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1675, average loss: 1.5237
[09/26 00:17:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.71	
[09/26 00:17:59 visual_prompt]: Training 16 / 100 epoch, with learning rate 9.924038765061042
[09/26 00:18:06 visual_prompt]: Epoch 16 / 100: avg data time: 4.78e-02, avg batch time: 0.4936, average train loss: 8.5735
[09/26 00:18:07 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1677, average loss: 16.6402
[09/26 00:18:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 73.63	
[09/26 00:18:07 visual_prompt]: Training 17 / 100 epoch, with learning rate 9.890738003669028
[09/26 00:18:14 visual_prompt]: Epoch 17 / 100: avg data time: 5.69e-02, avg batch time: 0.5004, average train loss: 14.4055
[09/26 00:18:16 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1674, average loss: 9.9954
[09/26 00:18:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 71.54	
[09/26 00:18:16 visual_prompt]: Training 18 / 100 epoch, with learning rate 9.851478631379981
[09/26 00:18:22 visual_prompt]: Epoch 18 / 100: avg data time: 5.40e-02, avg batch time: 0.4972, average train loss: 12.1428
[09/26 00:18:24 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1674, average loss: 12.9174
[09/26 00:18:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 49.28	
[09/26 00:18:24 visual_prompt]: Training 19 / 100 epoch, with learning rate 9.806308479691594
[09/26 00:18:30 visual_prompt]: Epoch 19 / 100: avg data time: 5.20e-02, avg batch time: 0.4975, average train loss: 11.3548
[09/26 00:18:32 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1672, average loss: 17.0644
[09/26 00:18:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 80.44	
[09/26 00:18:32 visual_prompt]: Training 20 / 100 epoch, with learning rate 9.755282581475768
[09/26 00:18:38 visual_prompt]: Epoch 20 / 100: avg data time: 5.22e-02, avg batch time: 0.4961, average train loss: 15.9368
[09/26 00:18:40 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1674, average loss: 9.5857
[09/26 00:18:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.09	
[09/26 00:18:40 visual_prompt]: Training 21 / 100 epoch, with learning rate 9.698463103929543
[09/26 00:18:47 visual_prompt]: Epoch 21 / 100: avg data time: 6.15e-02, avg batch time: 0.5047, average train loss: 23.4605
[09/26 00:18:48 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1672, average loss: 15.2438
[09/26 00:18:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.54	
[09/26 00:18:48 visual_prompt]: Training 22 / 100 epoch, with learning rate 9.635919272833938
[09/26 00:18:55 visual_prompt]: Epoch 22 / 100: avg data time: 5.49e-02, avg batch time: 0.4992, average train loss: 14.2435
[09/26 00:18:56 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1674, average loss: 2.7666
[09/26 00:18:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 86.59	
[09/26 00:18:56 visual_prompt]: Training 23 / 100 epoch, with learning rate 9.567727288213003
[09/26 00:19:03 visual_prompt]: Epoch 23 / 100: avg data time: 4.51e-02, avg batch time: 0.4902, average train loss: 3.5390
[09/26 00:19:04 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1679, average loss: 10.7595
[09/26 00:19:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 87.32	
[09/26 00:19:04 visual_prompt]: Training 24 / 100 epoch, with learning rate 9.493970231495835
[09/26 00:19:11 visual_prompt]: Epoch 24 / 100: avg data time: 5.42e-02, avg batch time: 0.4981, average train loss: 4.7722
[09/26 00:19:13 visual_prompt]: Inference (val):avg data time: 4.01e-05, avg batch time: 0.1678, average loss: 13.9277
[09/26 00:19:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 88.21	
[09/26 00:19:13 visual_prompt]: Training 25 / 100 epoch, with learning rate 9.414737964294634
[09/26 00:19:19 visual_prompt]: Epoch 25 / 100: avg data time: 5.65e-02, avg batch time: 0.5007, average train loss: 15.0067
[09/26 00:19:21 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1674, average loss: 12.3316
[09/26 00:19:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 79.88	
[09/26 00:19:21 visual_prompt]: Training 26 / 100 epoch, with learning rate 9.330127018922195
[09/26 00:19:27 visual_prompt]: Epoch 26 / 100: avg data time: 5.51e-02, avg batch time: 0.4990, average train loss: 8.5712
[09/26 00:19:29 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1674, average loss: 5.5321
[09/26 00:19:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 36.40	
[09/26 00:19:29 visual_prompt]: Training 27 / 100 epoch, with learning rate 9.240240480782129
[09/26 00:19:35 visual_prompt]: Epoch 27 / 100: avg data time: 4.63e-02, avg batch time: 0.4915, average train loss: 4.9041
[09/26 00:19:37 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1675, average loss: 4.2048
[09/26 00:19:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.76	
[09/26 00:19:37 visual_prompt]: Training 28 / 100 epoch, with learning rate 9.145187862775208
[09/26 00:19:44 visual_prompt]: Epoch 28 / 100: avg data time: 5.49e-02, avg batch time: 0.4987, average train loss: 4.1137
[09/26 00:19:45 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1677, average loss: 2.6435
[09/26 00:19:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 88.65	
[09/26 00:19:45 visual_prompt]: Training 29 / 100 epoch, with learning rate 9.045084971874736
[09/26 00:19:52 visual_prompt]: Epoch 29 / 100: avg data time: 4.18e-02, avg batch time: 0.4878, average train loss: 3.6501
[09/26 00:19:53 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1676, average loss: 2.9665
[09/26 00:19:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 89.54	
[09/26 00:19:53 visual_prompt]: Training 30 / 100 epoch, with learning rate 8.940053768033609
[09/26 00:20:00 visual_prompt]: Epoch 30 / 100: avg data time: 4.60e-02, avg batch time: 0.4911, average train loss: 3.4460
[09/26 00:20:01 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1675, average loss: 2.5171
[09/26 00:20:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 89.57	
[09/26 00:20:01 visual_prompt]: Training 31 / 100 epoch, with learning rate 8.83022221559489
[09/26 00:20:08 visual_prompt]: Epoch 31 / 100: avg data time: 4.35e-02, avg batch time: 0.4892, average train loss: 4.0007
[09/26 00:20:09 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1674, average loss: 7.3867
[09/26 00:20:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.12	
[09/26 00:20:09 visual_prompt]: Training 32 / 100 epoch, with learning rate 8.715724127386972
[09/26 00:20:16 visual_prompt]: Epoch 32 / 100: avg data time: 4.08e-02, avg batch time: 0.4864, average train loss: 5.3657
[09/26 00:20:17 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1675, average loss: 0.5650
[09/26 00:20:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 69.00	rocauc: 78.74	
[09/26 00:20:17 visual_prompt]: Best epoch 32: best metric: 0.690
[09/26 00:20:17 visual_prompt]: Training 33 / 100 epoch, with learning rate 8.596699001693256
[09/26 00:20:24 visual_prompt]: Epoch 33 / 100: avg data time: 4.24e-02, avg batch time: 0.4903, average train loss: 2.3246
[09/26 00:20:25 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1675, average loss: 3.7941
[09/26 00:20:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.07	
[09/26 00:20:25 visual_prompt]: Training 34 / 100 epoch, with learning rate 8.473291852294986
[09/26 00:20:32 visual_prompt]: Epoch 34 / 100: avg data time: 5.56e-02, avg batch time: 0.5007, average train loss: 5.6749
[09/26 00:20:33 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1675, average loss: 9.7039
[09/26 00:20:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.10	
[09/26 00:20:33 visual_prompt]: Training 35 / 100 epoch, with learning rate 8.345653031794292
[09/26 00:20:40 visual_prompt]: Epoch 35 / 100: avg data time: 4.58e-02, avg batch time: 0.4917, average train loss: 6.7097
[09/26 00:20:41 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1676, average loss: 8.6526
[09/26 00:20:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 81.16	
[09/26 00:20:41 visual_prompt]: Training 36 / 100 epoch, with learning rate 8.213938048432697
[09/26 00:20:48 visual_prompt]: Epoch 36 / 100: avg data time: 4.03e-02, avg batch time: 0.4854, average train loss: 7.1289
[09/26 00:20:49 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1674, average loss: 6.2539
[09/26 00:20:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.20	
[09/26 00:20:49 visual_prompt]: Training 37 / 100 epoch, with learning rate 8.078307376628292
[09/26 00:20:56 visual_prompt]: Epoch 37 / 100: avg data time: 5.35e-02, avg batch time: 0.4982, average train loss: 14.1645
[09/26 00:20:57 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1674, average loss: 17.3219
[09/26 00:20:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 78.22	
[09/26 00:20:57 visual_prompt]: Training 38 / 100 epoch, with learning rate 7.938926261462366
[09/26 00:21:04 visual_prompt]: Epoch 38 / 100: avg data time: 4.92e-02, avg batch time: 0.4941, average train loss: 21.2340
[09/26 00:21:05 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1675, average loss: 3.9039
[09/26 00:21:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 81.91	
[09/26 00:21:05 visual_prompt]: Training 39 / 100 epoch, with learning rate 7.795964517353734
[09/26 00:21:12 visual_prompt]: Epoch 39 / 100: avg data time: 5.35e-02, avg batch time: 0.4971, average train loss: 14.9049
[09/26 00:21:14 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1676, average loss: 33.2750
[09/26 00:21:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 83.36	
[09/26 00:21:14 visual_prompt]: Training 40 / 100 epoch, with learning rate 7.649596321166024
[09/26 00:21:20 visual_prompt]: Epoch 40 / 100: avg data time: 4.89e-02, avg batch time: 0.4929, average train loss: 15.8626
[09/26 00:21:22 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1674, average loss: 17.5167
[09/26 00:21:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.78	
[09/26 00:21:22 visual_prompt]: Training 41 / 100 epoch, with learning rate 7.5
[09/26 00:21:28 visual_prompt]: Epoch 41 / 100: avg data time: 4.05e-02, avg batch time: 0.4854, average train loss: 9.8037
[09/26 00:21:30 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1671, average loss: 2.9247
[09/26 00:21:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.15	
[09/26 00:21:30 visual_prompt]: Training 42 / 100 epoch, with learning rate 7.347357813929454
[09/26 00:21:36 visual_prompt]: Epoch 42 / 100: avg data time: 5.22e-02, avg batch time: 0.4962, average train loss: 6.8355
[09/26 00:21:38 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1675, average loss: 5.7165
[09/26 00:21:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.64	
[09/26 00:21:38 visual_prompt]: Training 43 / 100 epoch, with learning rate 7.191855733945387
[09/26 00:21:44 visual_prompt]: Epoch 43 / 100: avg data time: 4.76e-02, avg batch time: 0.4931, average train loss: 3.6319
[09/26 00:21:46 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1677, average loss: 5.8614
[09/26 00:21:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.67	
[09/26 00:21:46 visual_prompt]: Training 44 / 100 epoch, with learning rate 7.033683215379002
[09/26 00:21:52 visual_prompt]: Epoch 44 / 100: avg data time: 4.27e-02, avg batch time: 0.4877, average train loss: 3.9794
[09/26 00:21:54 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1676, average loss: 0.8626
[09/26 00:21:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.21	
[09/26 00:21:54 visual_prompt]: Training 45 / 100 epoch, with learning rate 6.873032967079561
[09/26 00:22:00 visual_prompt]: Epoch 45 / 100: avg data time: 4.90e-02, avg batch time: 0.4929, average train loss: 4.4765
[09/26 00:22:02 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1672, average loss: 6.1728
[09/26 00:22:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.04	
[09/26 00:22:02 visual_prompt]: Training 46 / 100 epoch, with learning rate 6.710100716628345
[09/26 00:22:09 visual_prompt]: Epoch 46 / 100: avg data time: 5.50e-02, avg batch time: 0.5007, average train loss: 4.3144
[09/26 00:22:10 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1674, average loss: 1.4936
[09/26 00:22:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.77	
[09/26 00:22:10 visual_prompt]: Training 47 / 100 epoch, with learning rate 6.545084971874737
[09/26 00:22:17 visual_prompt]: Epoch 47 / 100: avg data time: 3.99e-02, avg batch time: 0.4856, average train loss: 3.9887
[09/26 00:22:18 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1676, average loss: 1.7058
[09/26 00:22:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.76	
[09/26 00:22:18 visual_prompt]: Training 48 / 100 epoch, with learning rate 6.378186779084995
[09/26 00:22:25 visual_prompt]: Epoch 48 / 100: avg data time: 4.92e-02, avg batch time: 0.4933, average train loss: 2.2290
[09/26 00:22:26 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1677, average loss: 0.5896
[09/26 00:22:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 86.17	
[09/26 00:22:26 visual_prompt]: Best epoch 48: best metric: 0.790
[09/26 00:22:26 visual_prompt]: Training 49 / 100 epoch, with learning rate 6.209609477998338
[09/26 00:22:33 visual_prompt]: Epoch 49 / 100: avg data time: 4.70e-02, avg batch time: 0.4915, average train loss: 2.1118
[09/26 00:22:34 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1678, average loss: 1.0162
[09/26 00:22:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 88.77	
[09/26 00:22:34 visual_prompt]: Training 50 / 100 epoch, with learning rate 6.039558454088796
[09/26 00:22:41 visual_prompt]: Epoch 50 / 100: avg data time: 3.83e-02, avg batch time: 0.4841, average train loss: 2.0063
[09/26 00:22:42 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1677, average loss: 0.7290
[09/26 00:22:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.00	rocauc: 87.94	
[09/26 00:22:42 visual_prompt]: Training 51 / 100 epoch, with learning rate 5.868240888334652
[09/26 00:22:49 visual_prompt]: Epoch 51 / 100: avg data time: 4.27e-02, avg batch time: 0.4878, average train loss: 0.9287
[09/26 00:22:50 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1675, average loss: 0.5299
[09/26 00:22:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.50	rocauc: 89.01	
[09/26 00:22:50 visual_prompt]: Training 52 / 100 epoch, with learning rate 5.695865504800327
[09/26 00:22:57 visual_prompt]: Epoch 52 / 100: avg data time: 4.43e-02, avg batch time: 0.4899, average train loss: 0.7828
[09/26 00:22:58 visual_prompt]: Inference (val):avg data time: 3.01e-05, avg batch time: 0.1675, average loss: 1.2023
[09/26 00:22:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 55.50	rocauc: 89.57	
[09/26 00:22:58 visual_prompt]: Training 53 / 100 epoch, with learning rate 5.522642316338268
[09/26 00:23:05 visual_prompt]: Epoch 53 / 100: avg data time: 4.20e-02, avg batch time: 0.4879, average train loss: 0.7951
[09/26 00:23:06 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1678, average loss: 0.4380
[09/26 00:23:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 89.59	
[09/26 00:23:06 visual_prompt]: Best epoch 53: best metric: 0.795
[09/26 00:23:06 visual_prompt]: Training 54 / 100 epoch, with learning rate 5.3487823687206255
[09/26 00:23:13 visual_prompt]: Epoch 54 / 100: avg data time: 3.97e-02, avg batch time: 0.4864, average train loss: 1.4029
[09/26 00:23:14 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1677, average loss: 2.4897
[09/26 00:23:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 91.00	
[09/26 00:23:14 visual_prompt]: Training 55 / 100 epoch, with learning rate 5.174497483512505
[09/26 00:23:21 visual_prompt]: Epoch 55 / 100: avg data time: 5.92e-02, avg batch time: 0.5034, average train loss: 1.4117
[09/26 00:23:23 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1676, average loss: 0.3837
[09/26 00:23:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 91.85	
[09/26 00:23:23 visual_prompt]: Best epoch 55: best metric: 0.860
[09/26 00:23:23 visual_prompt]: Training 56 / 100 epoch, with learning rate 5.0
[09/26 00:23:29 visual_prompt]: Epoch 56 / 100: avg data time: 4.80e-02, avg batch time: 0.4922, average train loss: 0.6900
[09/26 00:23:31 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1676, average loss: 1.4887
[09/26 00:23:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 91.98	
[09/26 00:23:31 visual_prompt]: Training 57 / 100 epoch, with learning rate 4.8255025164874965
[09/26 00:23:37 visual_prompt]: Epoch 57 / 100: avg data time: 4.82e-02, avg batch time: 0.4926, average train loss: 1.1635
[09/26 00:23:39 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1676, average loss: 0.7337
[09/26 00:23:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.50	rocauc: 90.79	
[09/26 00:23:39 visual_prompt]: Training 58 / 100 epoch, with learning rate 4.651217631279374
[09/26 00:23:45 visual_prompt]: Epoch 58 / 100: avg data time: 5.18e-02, avg batch time: 0.4971, average train loss: 1.3716
[09/26 00:23:47 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1680, average loss: 0.6375
[09/26 00:23:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 92.00	
[09/26 00:23:47 visual_prompt]: Training 59 / 100 epoch, with learning rate 4.477357683661733
[09/26 00:23:54 visual_prompt]: Epoch 59 / 100: avg data time: 5.16e-02, avg batch time: 0.4971, average train loss: 1.1446
[09/26 00:23:55 visual_prompt]: Inference (val):avg data time: 3.04e-05, avg batch time: 0.1675, average loss: 0.5126
[09/26 00:23:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.14	
[09/26 00:23:55 visual_prompt]: Training 60 / 100 epoch, with learning rate 4.3041344951996745
[09/26 00:24:02 visual_prompt]: Epoch 60 / 100: avg data time: 4.24e-02, avg batch time: 0.4885, average train loss: 0.6871
[09/26 00:24:03 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1678, average loss: 0.3710
[09/26 00:24:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.38	
[09/26 00:24:03 visual_prompt]: Training 61 / 100 epoch, with learning rate 4.131759111665349
[09/26 00:24:10 visual_prompt]: Epoch 61 / 100: avg data time: 4.41e-02, avg batch time: 0.4891, average train loss: 0.5477
[09/26 00:24:11 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1679, average loss: 0.5570
[09/26 00:24:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.00	rocauc: 91.70	
[09/26 00:24:11 visual_prompt]: Training 62 / 100 epoch, with learning rate 3.960441545911204
[09/26 00:24:18 visual_prompt]: Epoch 62 / 100: avg data time: 5.53e-02, avg batch time: 0.5009, average train loss: 0.5211
[09/26 00:24:19 visual_prompt]: Inference (val):avg data time: 2.79e-05, avg batch time: 0.1678, average loss: 0.5020
[09/26 00:24:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 93.37	
[09/26 00:24:19 visual_prompt]: Training 63 / 100 epoch, with learning rate 3.790390522001662
[09/26 00:24:26 visual_prompt]: Epoch 63 / 100: avg data time: 5.77e-02, avg batch time: 0.5030, average train loss: 0.3902
[09/26 00:24:28 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1673, average loss: 0.4518
[09/26 00:24:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 91.79	
[09/26 00:24:28 visual_prompt]: Training 64 / 100 epoch, with learning rate 3.6218132209150045
[09/26 00:24:34 visual_prompt]: Epoch 64 / 100: avg data time: 4.41e-02, avg batch time: 0.4918, average train loss: 0.5093
[09/26 00:24:36 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1676, average loss: 0.6632
[09/26 00:24:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.00	rocauc: 94.35	
[09/26 00:24:36 visual_prompt]: Training 65 / 100 epoch, with learning rate 3.454915028125263
[09/26 00:24:42 visual_prompt]: Epoch 65 / 100: avg data time: 5.52e-02, avg batch time: 0.4996, average train loss: 0.4207
[09/26 00:24:44 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1679, average loss: 0.3710
[09/26 00:24:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.97	
[09/26 00:24:44 visual_prompt]: Training 66 / 100 epoch, with learning rate 3.289899283371657
[09/26 00:24:51 visual_prompt]: Epoch 66 / 100: avg data time: 5.88e-02, avg batch time: 0.5048, average train loss: 0.6097
[09/26 00:24:52 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1679, average loss: 0.3487
[09/26 00:24:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 94.12	
[09/26 00:24:52 visual_prompt]: Training 67 / 100 epoch, with learning rate 3.1269670329204398
[09/26 00:24:59 visual_prompt]: Epoch 67 / 100: avg data time: 4.31e-02, avg batch time: 0.4907, average train loss: 0.4507
[09/26 00:25:00 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1675, average loss: 0.4709
[09/26 00:25:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.50	rocauc: 92.64	
[09/26 00:25:00 visual_prompt]: Training 68 / 100 epoch, with learning rate 2.9663167846209997
[09/26 00:25:07 visual_prompt]: Epoch 68 / 100: avg data time: 4.67e-02, avg batch time: 0.4917, average train loss: 0.4788
[09/26 00:25:08 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1677, average loss: 0.3457
[09/26 00:25:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.97	
[09/26 00:25:08 visual_prompt]: Training 69 / 100 epoch, with learning rate 2.8081442660546125
[09/26 00:25:15 visual_prompt]: Epoch 69 / 100: avg data time: 5.74e-02, avg batch time: 0.5020, average train loss: 0.5730
[09/26 00:25:16 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1677, average loss: 0.4051
[09/26 00:25:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 93.93	
[09/26 00:25:16 visual_prompt]: Training 70 / 100 epoch, with learning rate 2.6526421860705476
[09/26 00:25:23 visual_prompt]: Epoch 70 / 100: avg data time: 5.18e-02, avg batch time: 0.4961, average train loss: 0.5757
[09/26 00:25:24 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1678, average loss: 0.5126
[09/26 00:25:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.50	rocauc: 91.52	
[09/26 00:25:24 visual_prompt]: Training 71 / 100 epoch, with learning rate 2.500000000000001
[09/26 00:25:31 visual_prompt]: Epoch 71 / 100: avg data time: 5.62e-02, avg batch time: 0.5010, average train loss: 0.4171
[09/26 00:25:33 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1676, average loss: 0.3788
[09/26 00:25:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 91.90	
[09/26 00:25:33 visual_prompt]: Training 72 / 100 epoch, with learning rate 2.350403678833976
[09/26 00:25:39 visual_prompt]: Epoch 72 / 100: avg data time: 4.23e-02, avg batch time: 0.4877, average train loss: 0.3015
[09/26 00:25:41 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1681, average loss: 0.4131
[09/26 00:25:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 91.98	
[09/26 00:25:41 visual_prompt]: Training 73 / 100 epoch, with learning rate 2.2040354826462667
[09/26 00:25:47 visual_prompt]: Epoch 73 / 100: avg data time: 5.02e-02, avg batch time: 0.4955, average train loss: 0.3620
[09/26 00:25:49 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1678, average loss: 0.3586
[09/26 00:25:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.22	
[09/26 00:25:49 visual_prompt]: Training 74 / 100 epoch, with learning rate 2.061073738537635
[09/26 00:25:56 visual_prompt]: Epoch 74 / 100: avg data time: 5.01e-02, avg batch time: 0.4950, average train loss: 0.2858
[09/26 00:25:57 visual_prompt]: Inference (val):avg data time: 5.65e-05, avg batch time: 0.1684, average loss: 0.4073
[09/26 00:25:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.57	
[09/26 00:25:57 visual_prompt]: Training 75 / 100 epoch, with learning rate 1.9216926233717087
[09/26 00:26:04 visual_prompt]: Epoch 75 / 100: avg data time: 5.73e-02, avg batch time: 0.5023, average train loss: 0.3777
[09/26 00:26:05 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1680, average loss: 0.8027
[09/26 00:26:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.00	rocauc: 91.93	
[09/26 00:26:05 visual_prompt]: Training 76 / 100 epoch, with learning rate 1.7860619515673033
[09/26 00:26:12 visual_prompt]: Epoch 76 / 100: avg data time: 5.47e-02, avg batch time: 0.5004, average train loss: 0.3543
[09/26 00:26:13 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1680, average loss: 0.4240
[09/26 00:26:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 93.59	
[09/26 00:26:13 visual_prompt]: Training 77 / 100 epoch, with learning rate 1.6543469682057106
[09/26 00:26:20 visual_prompt]: Epoch 77 / 100: avg data time: 4.62e-02, avg batch time: 0.4914, average train loss: 0.2405
[09/26 00:26:21 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1679, average loss: 0.5398
[09/26 00:26:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 91.79	
[09/26 00:26:21 visual_prompt]: Training 78 / 100 epoch, with learning rate 1.5267081477050133
[09/26 00:26:28 visual_prompt]: Epoch 78 / 100: avg data time: 5.42e-02, avg batch time: 0.4997, average train loss: 0.2341
[09/26 00:26:29 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1678, average loss: 0.4409
[09/26 00:26:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.61	
[09/26 00:26:29 visual_prompt]: Training 79 / 100 epoch, with learning rate 1.403300998306745
[09/26 00:26:36 visual_prompt]: Epoch 79 / 100: avg data time: 4.05e-02, avg batch time: 0.4881, average train loss: 0.2524
[09/26 00:26:37 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1682, average loss: 0.4270
[09/26 00:26:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.41	
[09/26 00:26:37 visual_prompt]: Training 80 / 100 epoch, with learning rate 1.2842758726130281
[09/26 00:26:44 visual_prompt]: Epoch 80 / 100: avg data time: 4.77e-02, avg batch time: 0.4929, average train loss: 0.2728
[09/26 00:26:46 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1678, average loss: 0.4094
[09/26 00:26:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.74	
[09/26 00:26:46 visual_prompt]: Training 81 / 100 epoch, with learning rate 1.1697777844051105
[09/26 00:26:52 visual_prompt]: Epoch 81 / 100: avg data time: 4.54e-02, avg batch time: 0.4904, average train loss: 0.1799
[09/26 00:26:54 visual_prompt]: Inference (val):avg data time: 2.70e-05, avg batch time: 0.1676, average loss: 0.3842
[09/26 00:26:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.89	
[09/26 00:26:54 visual_prompt]: Training 82 / 100 epoch, with learning rate 1.0599462319663906
[09/26 00:27:00 visual_prompt]: Epoch 82 / 100: avg data time: 5.11e-02, avg batch time: 0.4955, average train loss: 0.1350
[09/26 00:27:02 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1681, average loss: 0.4997
[09/26 00:27:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.37	
[09/26 00:27:02 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.9549150281252633
[09/26 00:27:09 visual_prompt]: Epoch 83 / 100: avg data time: 5.83e-02, avg batch time: 0.5030, average train loss: 0.1066
[09/26 00:27:10 visual_prompt]: Inference (val):avg data time: 2.73e-05, avg batch time: 0.1678, average loss: 0.5062
[09/26 00:27:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.15	
[09/26 00:27:10 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.8548121372247919
[09/26 00:27:17 visual_prompt]: Epoch 84 / 100: avg data time: 4.78e-02, avg batch time: 0.4924, average train loss: 0.0864
[09/26 00:27:18 visual_prompt]: Inference (val):avg data time: 3.34e-05, avg batch time: 0.1679, average loss: 0.7759
[09/26 00:27:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 89.00	
[09/26 00:27:18 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.7597595192178702
[09/26 00:27:25 visual_prompt]: Epoch 85 / 100: avg data time: 5.62e-02, avg batch time: 0.5011, average train loss: 0.0988
[09/26 00:27:26 visual_prompt]: Inference (val):avg data time: 3.24e-05, avg batch time: 0.1679, average loss: 0.5054
[09/26 00:27:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.51	
[09/26 00:27:26 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.6698729810778065
[09/26 00:27:33 visual_prompt]: Epoch 86 / 100: avg data time: 5.50e-02, avg batch time: 0.4995, average train loss: 0.0751
[09/26 00:27:35 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1677, average loss: 0.6271
[09/26 00:27:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.66	
[09/26 00:27:35 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.5852620357053651
[09/26 00:27:41 visual_prompt]: Epoch 87 / 100: avg data time: 4.42e-02, avg batch time: 0.4922, average train loss: 0.0687
[09/26 00:27:43 visual_prompt]: Inference (val):avg data time: 3.18e-05, avg batch time: 0.1681, average loss: 0.5913
[09/26 00:27:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.00	
[09/26 00:27:43 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.5060297685041659
[09/26 00:27:49 visual_prompt]: Epoch 88 / 100: avg data time: 4.27e-02, avg batch time: 0.4896, average train loss: 0.0728
[09/26 00:27:51 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1677, average loss: 0.7851
[09/26 00:27:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.29	
[09/26 00:27:51 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.4322727117869951
[09/26 00:27:57 visual_prompt]: Epoch 89 / 100: avg data time: 5.49e-02, avg batch time: 0.5000, average train loss: 0.0765
[09/26 00:27:59 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1676, average loss: 0.6769
[09/26 00:27:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.46	
[09/26 00:27:59 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.36408072716606343
[09/26 00:28:06 visual_prompt]: Epoch 90 / 100: avg data time: 5.76e-02, avg batch time: 0.5026, average train loss: 0.1787
[09/26 00:28:07 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1681, average loss: 0.5294
[09/26 00:28:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 91.36	
[09/26 00:28:07 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.3015368960704584
[09/26 00:28:14 visual_prompt]: Epoch 91 / 100: avg data time: 4.03e-02, avg batch time: 0.4878, average train loss: 0.1371
[09/26 00:28:15 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1682, average loss: 0.5776
[09/26 00:28:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 90.94	
[09/26 00:28:15 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.24471741852423234
[09/26 00:28:22 visual_prompt]: Epoch 92 / 100: avg data time: 5.42e-02, avg batch time: 0.4994, average train loss: 0.0573
[09/26 00:28:23 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1675, average loss: 0.6830
[09/26 00:28:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 90.75	
[09/26 00:28:23 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.19369152030840553
[09/26 00:28:30 visual_prompt]: Epoch 93 / 100: avg data time: 5.42e-02, avg batch time: 0.4985, average train loss: 0.0274
[09/26 00:28:31 visual_prompt]: Inference (val):avg data time: 2.99e-05, avg batch time: 0.1680, average loss: 0.6573
[09/26 00:28:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.51	
[09/26 00:28:31 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.14852136862001764
[09/26 00:28:38 visual_prompt]: Epoch 94 / 100: avg data time: 5.84e-02, avg batch time: 0.5036, average train loss: 0.0246
[09/26 00:28:40 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1677, average loss: 0.7768
[09/26 00:28:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.40	
[09/26 00:28:40 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.10926199633097156
[09/26 00:28:46 visual_prompt]: Epoch 95 / 100: avg data time: 5.05e-02, avg batch time: 0.4963, average train loss: 0.0228
[09/26 00:28:48 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1677, average loss: 0.7900
[09/26 00:28:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.36	
[09/26 00:28:48 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.0759612349389599
[09/26 00:28:54 visual_prompt]: Epoch 96 / 100: avg data time: 4.39e-02, avg batch time: 0.4909, average train loss: 0.0192
[09/26 00:28:56 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1676, average loss: 0.8122
[09/26 00:28:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.26	
[09/26 00:28:56 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.04865965629214819
[09/26 00:29:03 visual_prompt]: Epoch 97 / 100: avg data time: 5.78e-02, avg batch time: 0.5029, average train loss: 0.0141
[09/26 00:29:04 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1679, average loss: 0.8198
[09/26 00:29:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.16	
[09/26 00:29:04 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.02739052315863355
[09/26 00:29:11 visual_prompt]: Epoch 98 / 100: avg data time: 5.22e-02, avg batch time: 0.4975, average train loss: 0.0127
[09/26 00:29:12 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1676, average loss: 0.8240
[09/26 00:29:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.12	
[09/26 00:29:12 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.012179748700879012
[09/26 00:29:19 visual_prompt]: Epoch 99 / 100: avg data time: 6.01e-02, avg batch time: 0.5045, average train loss: 0.0134
[09/26 00:29:20 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1678, average loss: 0.8254
[09/26 00:29:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.13	
[09/26 00:29:20 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0030458649045211894
[09/26 00:29:27 visual_prompt]: Epoch 100 / 100: avg data time: 4.77e-02, avg batch time: 0.4927, average train loss: 0.0123
[09/26 00:29:28 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1678, average loss: 0.8258
[09/26 00:29:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.12	
[09/26 00:29:28 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 00:29:28 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 00:29:28 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 00:29:28 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 00:29:28 visual_prompt]: Training with config:
[09/26 00:29:28 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr10.0_wd0.0/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 10.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 00:29:28 visual_prompt]: Loading training data...
[09/26 00:29:28 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 00:29:30 visual_prompt]: Number of images: 800
[09/26 00:29:30 visual_prompt]: Number of classes: 2 / 2
[09/26 00:29:30 visual_prompt]: Loading validation data...
[09/26 00:29:30 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 00:29:30 visual_prompt]: Number of images: 200
[09/26 00:29:30 visual_prompt]: Number of classes: 2 / 2
[09/26 00:29:30 visual_prompt]: Constructing models...
[09/26 00:29:32 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 00:29:32 visual_prompt]: tuned percent:0.536
[09/26 00:29:32 visual_prompt]: Device used for model: 0
[09/26 00:29:32 visual_prompt]: Setting up Evaluator...
[09/26 00:29:32 visual_prompt]: Setting up Trainer...
[09/26 00:29:32 visual_prompt]: 	Setting up the optimizer...
[09/26 00:29:32 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 00:29:39 visual_prompt]: Epoch 1 / 100: avg data time: 5.45e-02, avg batch time: 0.4978, average train loss: 1.9610
[09/26 00:29:41 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1670, average loss: 2.0033
[09/26 00:29:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 00:29:41 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 00:29:41 visual_prompt]: Training 2 / 100 epoch, with learning rate 1.0
[09/26 00:29:47 visual_prompt]: Epoch 2 / 100: avg data time: 4.11e-02, avg batch time: 0.4861, average train loss: 17.6580
[09/26 00:29:49 visual_prompt]: Inference (val):avg data time: 2.70e-05, avg batch time: 0.1668, average loss: 1.2500
[09/26 00:29:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 64.24	
[09/26 00:29:49 visual_prompt]: Training 3 / 100 epoch, with learning rate 2.0
[09/26 00:29:55 visual_prompt]: Epoch 3 / 100: avg data time: 3.86e-02, avg batch time: 0.4831, average train loss: 8.6738
[09/26 00:29:57 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1673, average loss: 2.4959
[09/26 00:29:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.72	
[09/26 00:29:57 visual_prompt]: Training 4 / 100 epoch, with learning rate 3.0
[09/26 00:30:03 visual_prompt]: Epoch 4 / 100: avg data time: 4.04e-02, avg batch time: 0.4851, average train loss: 2.4593
[09/26 00:30:05 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1670, average loss: 2.8232
[09/26 00:30:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 86.43	
[09/26 00:30:05 visual_prompt]: Training 5 / 100 epoch, with learning rate 4.0
[09/26 00:30:11 visual_prompt]: Epoch 5 / 100: avg data time: 5.43e-02, avg batch time: 0.4981, average train loss: 10.8655
[09/26 00:30:13 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1674, average loss: 5.4073
[09/26 00:30:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 86.92	
[09/26 00:30:13 visual_prompt]: Training 6 / 100 epoch, with learning rate 5.0
[09/26 00:30:19 visual_prompt]: Epoch 6 / 100: avg data time: 5.53e-02, avg batch time: 0.4979, average train loss: 5.8341
[09/26 00:30:21 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1674, average loss: 3.3473
[09/26 00:30:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 87.06	
[09/26 00:30:21 visual_prompt]: Training 7 / 100 epoch, with learning rate 6.0
[09/26 00:30:27 visual_prompt]: Epoch 7 / 100: avg data time: 4.90e-02, avg batch time: 0.4927, average train loss: 14.0102
[09/26 00:30:29 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1674, average loss: 29.4603
[09/26 00:30:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 86.77	
[09/26 00:30:29 visual_prompt]: Training 8 / 100 epoch, with learning rate 7.0
[09/26 00:30:36 visual_prompt]: Epoch 8 / 100: avg data time: 4.90e-02, avg batch time: 0.4936, average train loss: 14.3804
[09/26 00:30:37 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1671, average loss: 12.8154
[09/26 00:30:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 87.21	
[09/26 00:30:37 visual_prompt]: Training 9 / 100 epoch, with learning rate 8.0
[09/26 00:30:44 visual_prompt]: Epoch 9 / 100: avg data time: 4.95e-02, avg batch time: 0.4934, average train loss: 13.4895
[09/26 00:30:45 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1671, average loss: 17.3671
[09/26 00:30:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 87.79	
[09/26 00:30:45 visual_prompt]: Training 10 / 100 epoch, with learning rate 9.0
[09/26 00:30:52 visual_prompt]: Epoch 10 / 100: avg data time: 4.74e-02, avg batch time: 0.4911, average train loss: 13.0312
[09/26 00:30:53 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1686, average loss: 16.2825
[09/26 00:30:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 87.82	
[09/26 00:30:53 visual_prompt]: Training 11 / 100 epoch, with learning rate 10.0
[09/26 00:31:00 visual_prompt]: Epoch 11 / 100: avg data time: 4.86e-02, avg batch time: 0.4937, average train loss: 10.8816
[09/26 00:31:01 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1675, average loss: 1.1924
[09/26 00:31:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.50	rocauc: 89.78	
[09/26 00:31:01 visual_prompt]: Best epoch 11: best metric: 0.655
[09/26 00:31:01 visual_prompt]: Training 12 / 100 epoch, with learning rate 9.996954135095478
[09/26 00:31:08 visual_prompt]: Epoch 12 / 100: avg data time: 5.60e-02, avg batch time: 0.4998, average train loss: 4.7878
[09/26 00:31:09 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1675, average loss: 7.2872
[09/26 00:31:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 91.35	
[09/26 00:31:09 visual_prompt]: Training 13 / 100 epoch, with learning rate 9.987820251299121
[09/26 00:31:16 visual_prompt]: Epoch 13 / 100: avg data time: 5.30e-02, avg batch time: 0.4993, average train loss: 6.5129
[09/26 00:31:18 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1677, average loss: 5.7960
[09/26 00:31:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.50	rocauc: 91.07	
[09/26 00:31:18 visual_prompt]: Training 14 / 100 epoch, with learning rate 9.972609476841367
[09/26 00:31:24 visual_prompt]: Epoch 14 / 100: avg data time: 4.98e-02, avg batch time: 0.4945, average train loss: 2.9106
[09/26 00:31:26 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1675, average loss: 0.8760
[09/26 00:31:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 90.00	
[09/26 00:31:26 visual_prompt]: Best epoch 14: best metric: 0.850
[09/26 00:31:26 visual_prompt]: Training 15 / 100 epoch, with learning rate 9.951340343707852
[09/26 00:31:32 visual_prompt]: Epoch 15 / 100: avg data time: 3.86e-02, avg batch time: 0.4834, average train loss: 3.9697
[09/26 00:31:34 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1675, average loss: 2.0381
[09/26 00:31:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 53.00	rocauc: 91.27	
[09/26 00:31:34 visual_prompt]: Training 16 / 100 epoch, with learning rate 9.924038765061042
[09/26 00:31:40 visual_prompt]: Epoch 16 / 100: avg data time: 4.92e-02, avg batch time: 0.4943, average train loss: 1.5005
[09/26 00:31:42 visual_prompt]: Inference (val):avg data time: 2.95e-05, avg batch time: 0.1677, average loss: 0.6563
[09/26 00:31:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 90.84	
[09/26 00:31:42 visual_prompt]: Training 17 / 100 epoch, with learning rate 9.890738003669028
[09/26 00:31:49 visual_prompt]: Epoch 17 / 100: avg data time: 5.64e-02, avg batch time: 0.5001, average train loss: 1.0342
[09/26 00:31:50 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1676, average loss: 0.4582
[09/26 00:31:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.22	
[09/26 00:31:50 visual_prompt]: Training 18 / 100 epoch, with learning rate 9.851478631379981
[09/26 00:31:57 visual_prompt]: Epoch 18 / 100: avg data time: 4.58e-02, avg batch time: 0.4907, average train loss: 2.4352
[09/26 00:31:58 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1677, average loss: 0.5186
[09/26 00:31:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.38	
[09/26 00:31:58 visual_prompt]: Training 19 / 100 epoch, with learning rate 9.806308479691594
[09/26 00:32:04 visual_prompt]: Epoch 19 / 100: avg data time: 3.65e-02, avg batch time: 0.4824, average train loss: 2.2500
[09/26 00:32:06 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1677, average loss: 1.5975
[09/26 00:32:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 92.67	
[09/26 00:32:06 visual_prompt]: Training 20 / 100 epoch, with learning rate 9.755282581475768
[09/26 00:32:13 visual_prompt]: Epoch 20 / 100: avg data time: 4.63e-02, avg batch time: 0.4925, average train loss: 2.1298
[09/26 00:32:14 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1674, average loss: 2.2079
[09/26 00:32:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.50	rocauc: 92.79	
[09/26 00:32:14 visual_prompt]: Training 21 / 100 epoch, with learning rate 9.698463103929543
[09/26 00:32:21 visual_prompt]: Epoch 21 / 100: avg data time: 5.20e-02, avg batch time: 0.4982, average train loss: 1.3331
[09/26 00:32:22 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1674, average loss: 0.5669
[09/26 00:32:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.44	
[09/26 00:32:22 visual_prompt]: Training 22 / 100 epoch, with learning rate 9.635919272833938
[09/26 00:32:29 visual_prompt]: Epoch 22 / 100: avg data time: 5.03e-02, avg batch time: 0.4943, average train loss: 1.4676
[09/26 00:32:30 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.1676, average loss: 0.8113
[09/26 00:32:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.90	
[09/26 00:32:30 visual_prompt]: Training 23 / 100 epoch, with learning rate 9.567727288213003
[09/26 00:32:37 visual_prompt]: Epoch 23 / 100: avg data time: 4.82e-02, avg batch time: 0.4944, average train loss: 0.6996
[09/26 00:32:38 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.1676, average loss: 0.4558
[09/26 00:32:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 91.99	
[09/26 00:32:38 visual_prompt]: Best epoch 23: best metric: 0.860
[09/26 00:32:38 visual_prompt]: Training 24 / 100 epoch, with learning rate 9.493970231495835
[09/26 00:32:45 visual_prompt]: Epoch 24 / 100: avg data time: 5.25e-02, avg batch time: 0.4967, average train loss: 1.7689
[09/26 00:32:46 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1675, average loss: 1.9963
[09/26 00:32:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.00	rocauc: 92.04	
[09/26 00:32:46 visual_prompt]: Training 25 / 100 epoch, with learning rate 9.414737964294634
[09/26 00:32:53 visual_prompt]: Epoch 25 / 100: avg data time: 4.46e-02, avg batch time: 0.4910, average train loss: 1.1341
[09/26 00:32:54 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1677, average loss: 0.6757
[09/26 00:32:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.37	
[09/26 00:32:55 visual_prompt]: Training 26 / 100 epoch, with learning rate 9.330127018922195
[09/26 00:33:01 visual_prompt]: Epoch 26 / 100: avg data time: 4.46e-02, avg batch time: 0.4898, average train loss: 1.0312
[09/26 00:33:03 visual_prompt]: Inference (val):avg data time: 2.23e-05, avg batch time: 0.1675, average loss: 2.9707
[09/26 00:33:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 59.50	rocauc: 89.68	
[09/26 00:33:03 visual_prompt]: Training 27 / 100 epoch, with learning rate 9.240240480782129
[09/26 00:33:09 visual_prompt]: Epoch 27 / 100: avg data time: 4.44e-02, avg batch time: 0.4885, average train loss: 2.1124
[09/26 00:33:11 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1673, average loss: 2.7129
[09/26 00:33:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 71.50	rocauc: 93.99	
[09/26 00:33:11 visual_prompt]: Training 28 / 100 epoch, with learning rate 9.145187862775208
[09/26 00:33:17 visual_prompt]: Epoch 28 / 100: avg data time: 4.96e-02, avg batch time: 0.4962, average train loss: 2.2463
[09/26 00:33:19 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1677, average loss: 3.9894
[09/26 00:33:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 63.00	rocauc: 92.77	
[09/26 00:33:19 visual_prompt]: Training 29 / 100 epoch, with learning rate 9.045084971874736
[09/26 00:33:26 visual_prompt]: Epoch 29 / 100: avg data time: 5.63e-02, avg batch time: 0.5003, average train loss: 2.9563
[09/26 00:33:27 visual_prompt]: Inference (val):avg data time: 2.99e-05, avg batch time: 0.1676, average loss: 1.3866
[09/26 00:33:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.12	
[09/26 00:33:27 visual_prompt]: Training 30 / 100 epoch, with learning rate 8.940053768033609
[09/26 00:33:34 visual_prompt]: Epoch 30 / 100: avg data time: 5.61e-02, avg batch time: 0.5003, average train loss: 0.8390
[09/26 00:33:35 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1675, average loss: 6.0675
[09/26 00:33:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 89.99	
[09/26 00:33:35 visual_prompt]: Training 31 / 100 epoch, with learning rate 8.83022221559489
[09/26 00:33:42 visual_prompt]: Epoch 31 / 100: avg data time: 4.58e-02, avg batch time: 0.4923, average train loss: 4.5627
[09/26 00:33:43 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1676, average loss: 2.9489
[09/26 00:33:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.50	rocauc: 93.52	
[09/26 00:33:43 visual_prompt]: Training 32 / 100 epoch, with learning rate 8.715724127386972
[09/26 00:33:50 visual_prompt]: Epoch 32 / 100: avg data time: 3.52e-02, avg batch time: 0.4833, average train loss: 1.8705
[09/26 00:33:51 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1681, average loss: 0.7016
[09/26 00:33:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.74	
[09/26 00:33:51 visual_prompt]: Training 33 / 100 epoch, with learning rate 8.596699001693256
[09/26 00:33:58 visual_prompt]: Epoch 33 / 100: avg data time: 5.37e-02, avg batch time: 0.4982, average train loss: 0.7077
[09/26 00:34:00 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1681, average loss: 1.3718
[09/26 00:34:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.50	rocauc: 91.74	
[09/26 00:34:00 visual_prompt]: Training 34 / 100 epoch, with learning rate 8.473291852294986
[09/26 00:34:06 visual_prompt]: Epoch 34 / 100: avg data time: 5.58e-02, avg batch time: 0.5004, average train loss: 0.7014
[09/26 00:34:08 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1679, average loss: 0.5126
[09/26 00:34:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.83	
[09/26 00:34:08 visual_prompt]: Training 35 / 100 epoch, with learning rate 8.345653031794292
[09/26 00:34:14 visual_prompt]: Epoch 35 / 100: avg data time: 5.43e-02, avg batch time: 0.4995, average train loss: 0.6104
[09/26 00:34:16 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1675, average loss: 1.3995
[09/26 00:34:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.00	rocauc: 92.87	
[09/26 00:34:16 visual_prompt]: Training 36 / 100 epoch, with learning rate 8.213938048432697
[09/26 00:34:23 visual_prompt]: Epoch 36 / 100: avg data time: 5.91e-02, avg batch time: 0.5037, average train loss: 0.5246
[09/26 00:34:24 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1675, average loss: 0.8795
[09/26 00:34:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.45	
[09/26 00:34:24 visual_prompt]: Training 37 / 100 epoch, with learning rate 8.078307376628292
[09/26 00:34:31 visual_prompt]: Epoch 37 / 100: avg data time: 5.29e-02, avg batch time: 0.4984, average train loss: 0.7070
[09/26 00:34:32 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1678, average loss: 0.8854
[09/26 00:34:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 94.01	
[09/26 00:34:32 visual_prompt]: Training 38 / 100 epoch, with learning rate 7.938926261462366
[09/26 00:34:39 visual_prompt]: Epoch 38 / 100: avg data time: 5.67e-02, avg batch time: 0.5006, average train loss: 0.5228
[09/26 00:34:41 visual_prompt]: Inference (val):avg data time: 3.77e-05, avg batch time: 0.1675, average loss: 0.8810
[09/26 00:34:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.52	
[09/26 00:34:41 visual_prompt]: Training 39 / 100 epoch, with learning rate 7.795964517353734
[09/26 00:34:47 visual_prompt]: Epoch 39 / 100: avg data time: 5.16e-02, avg batch time: 0.4969, average train loss: 0.2946
[09/26 00:34:49 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1676, average loss: 0.4793
[09/26 00:34:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.83	
[09/26 00:34:49 visual_prompt]: Training 40 / 100 epoch, with learning rate 7.649596321166024
[09/26 00:34:55 visual_prompt]: Epoch 40 / 100: avg data time: 5.77e-02, avg batch time: 0.5017, average train loss: 0.2925
[09/26 00:34:57 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1676, average loss: 0.5948
[09/26 00:34:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 94.30	
[09/26 00:34:57 visual_prompt]: Training 41 / 100 epoch, with learning rate 7.5
[09/26 00:35:03 visual_prompt]: Epoch 41 / 100: avg data time: 4.35e-02, avg batch time: 0.4880, average train loss: 1.4085
[09/26 00:35:05 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1676, average loss: 7.0394
[09/26 00:35:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 53.00	rocauc: 92.71	
[09/26 00:35:05 visual_prompt]: Training 42 / 100 epoch, with learning rate 7.347357813929454
[09/26 00:35:12 visual_prompt]: Epoch 42 / 100: avg data time: 5.02e-02, avg batch time: 0.4942, average train loss: 2.8977
[09/26 00:35:13 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1676, average loss: 1.3474
[09/26 00:35:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.14	
[09/26 00:35:13 visual_prompt]: Training 43 / 100 epoch, with learning rate 7.191855733945387
[09/26 00:35:20 visual_prompt]: Epoch 43 / 100: avg data time: 4.85e-02, avg batch time: 0.4939, average train loss: 1.7507
[09/26 00:35:21 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1675, average loss: 2.1343
[09/26 00:35:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 92.13	
[09/26 00:35:21 visual_prompt]: Training 44 / 100 epoch, with learning rate 7.033683215379002
[09/26 00:35:28 visual_prompt]: Epoch 44 / 100: avg data time: 4.96e-02, avg batch time: 0.4944, average train loss: 1.4309
[09/26 00:35:29 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1676, average loss: 2.3395
[09/26 00:35:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.50	rocauc: 91.13	
[09/26 00:35:29 visual_prompt]: Training 45 / 100 epoch, with learning rate 6.873032967079561
[09/26 00:35:36 visual_prompt]: Epoch 45 / 100: avg data time: 5.37e-02, avg batch time: 0.4984, average train loss: 1.0894
[09/26 00:35:37 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1677, average loss: 1.0549
[09/26 00:35:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.25	
[09/26 00:35:37 visual_prompt]: Training 46 / 100 epoch, with learning rate 6.710100716628345
[09/26 00:35:44 visual_prompt]: Epoch 46 / 100: avg data time: 4.93e-02, avg batch time: 0.4934, average train loss: 0.5686
[09/26 00:35:45 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1676, average loss: 0.9965
[09/26 00:35:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 90.90	
[09/26 00:35:45 visual_prompt]: Training 47 / 100 epoch, with learning rate 6.545084971874737
[09/26 00:35:52 visual_prompt]: Epoch 47 / 100: avg data time: 4.60e-02, avg batch time: 0.4917, average train loss: 0.3357
[09/26 00:35:54 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1677, average loss: 0.9389
[09/26 00:35:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 92.91	
[09/26 00:35:54 visual_prompt]: Training 48 / 100 epoch, with learning rate 6.378186779084995
[09/26 00:36:00 visual_prompt]: Epoch 48 / 100: avg data time: 5.56e-02, avg batch time: 0.4997, average train loss: 0.5640
[09/26 00:36:02 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1680, average loss: 1.3932
[09/26 00:36:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 93.09	
[09/26 00:36:02 visual_prompt]: Training 49 / 100 epoch, with learning rate 6.209609477998338
[09/26 00:36:08 visual_prompt]: Epoch 49 / 100: avg data time: 3.94e-02, avg batch time: 0.4854, average train loss: 0.4488
[09/26 00:36:10 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1675, average loss: 1.7343
[09/26 00:36:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.00	rocauc: 93.73	
[09/26 00:36:10 visual_prompt]: Training 50 / 100 epoch, with learning rate 6.039558454088796
[09/26 00:36:16 visual_prompt]: Epoch 50 / 100: avg data time: 4.13e-02, avg batch time: 0.4873, average train loss: 0.4526
[09/26 00:36:18 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1679, average loss: 1.4782
[09/26 00:36:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.50	rocauc: 91.12	
[09/26 00:36:18 visual_prompt]: Training 51 / 100 epoch, with learning rate 5.868240888334652
[09/26 00:36:25 visual_prompt]: Epoch 51 / 100: avg data time: 4.80e-02, avg batch time: 0.4919, average train loss: 0.6042
[09/26 00:36:26 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1678, average loss: 1.2658
[09/26 00:36:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.11	
[09/26 00:36:26 visual_prompt]: Training 52 / 100 epoch, with learning rate 5.695865504800327
[09/26 00:36:33 visual_prompt]: Epoch 52 / 100: avg data time: 5.51e-02, avg batch time: 0.4997, average train loss: 0.3357
[09/26 00:36:34 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1678, average loss: 1.4545
[09/26 00:36:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 92.07	
[09/26 00:36:34 visual_prompt]: Training 53 / 100 epoch, with learning rate 5.522642316338268
[09/26 00:36:41 visual_prompt]: Epoch 53 / 100: avg data time: 4.45e-02, avg batch time: 0.4903, average train loss: 0.3827
[09/26 00:36:42 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1676, average loss: 1.2023
[09/26 00:36:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 92.62	
[09/26 00:36:42 visual_prompt]: Training 54 / 100 epoch, with learning rate 5.3487823687206255
[09/26 00:36:49 visual_prompt]: Epoch 54 / 100: avg data time: 4.85e-02, avg batch time: 0.4924, average train loss: 0.2512
[09/26 00:36:50 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1675, average loss: 1.2556
[09/26 00:36:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 90.98	
[09/26 00:36:50 visual_prompt]: Training 55 / 100 epoch, with learning rate 5.174497483512505
[09/26 00:36:57 visual_prompt]: Epoch 55 / 100: avg data time: 5.18e-02, avg batch time: 0.4965, average train loss: 0.1619
[09/26 00:36:59 visual_prompt]: Inference (val):avg data time: 3.36e-05, avg batch time: 0.1678, average loss: 1.1595
[09/26 00:36:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.63	
[09/26 00:36:59 visual_prompt]: Training 56 / 100 epoch, with learning rate 5.0
[09/26 00:37:05 visual_prompt]: Epoch 56 / 100: avg data time: 5.22e-02, avg batch time: 0.4969, average train loss: 0.1427
[09/26 00:37:07 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1679, average loss: 1.0739
[09/26 00:37:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 91.39	
[09/26 00:37:07 visual_prompt]: Training 57 / 100 epoch, with learning rate 4.8255025164874965
[09/26 00:37:13 visual_prompt]: Epoch 57 / 100: avg data time: 4.25e-02, avg batch time: 0.4874, average train loss: 0.0624
[09/26 00:37:15 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1679, average loss: 0.8899
[09/26 00:37:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.17	
[09/26 00:37:15 visual_prompt]: Training 58 / 100 epoch, with learning rate 4.651217631279374
[09/26 00:37:21 visual_prompt]: Epoch 58 / 100: avg data time: 4.36e-02, avg batch time: 0.4893, average train loss: 0.0475
[09/26 00:37:23 visual_prompt]: Inference (val):avg data time: 3.42e-05, avg batch time: 0.1676, average loss: 1.0066
[09/26 00:37:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.12	
[09/26 00:37:23 visual_prompt]: Training 59 / 100 epoch, with learning rate 4.477357683661733
[09/26 00:37:29 visual_prompt]: Epoch 59 / 100: avg data time: 5.20e-02, avg batch time: 0.4970, average train loss: 0.0488
[09/26 00:37:31 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1679, average loss: 1.0091
[09/26 00:37:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.02	
[09/26 00:37:31 visual_prompt]: Training 60 / 100 epoch, with learning rate 4.3041344951996745
[09/26 00:37:38 visual_prompt]: Epoch 60 / 100: avg data time: 4.90e-02, avg batch time: 0.4956, average train loss: 0.0241
[09/26 00:37:39 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1676, average loss: 1.0233
[09/26 00:37:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 91.75	
[09/26 00:37:39 visual_prompt]: Training 61 / 100 epoch, with learning rate 4.131759111665349
[09/26 00:37:46 visual_prompt]: Epoch 61 / 100: avg data time: 4.73e-02, avg batch time: 0.4919, average train loss: 0.0340
[09/26 00:37:47 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1675, average loss: 0.8526
[09/26 00:37:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.75	
[09/26 00:37:47 visual_prompt]: Training 62 / 100 epoch, with learning rate 3.960441545911204
[09/26 00:37:54 visual_prompt]: Epoch 62 / 100: avg data time: 4.04e-02, avg batch time: 0.4856, average train loss: 0.0207
[09/26 00:37:55 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1678, average loss: 0.8682
[09/26 00:37:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 92.11	
[09/26 00:37:55 visual_prompt]: Training 63 / 100 epoch, with learning rate 3.790390522001662
[09/26 00:38:02 visual_prompt]: Epoch 63 / 100: avg data time: 5.65e-02, avg batch time: 0.5016, average train loss: 0.0167
[09/26 00:38:03 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1677, average loss: 0.8660
[09/26 00:38:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 91.46	
[09/26 00:38:03 visual_prompt]: Training 64 / 100 epoch, with learning rate 3.6218132209150045
[09/26 00:38:10 visual_prompt]: Epoch 64 / 100: avg data time: 4.75e-02, avg batch time: 0.4919, average train loss: 0.0107
[09/26 00:38:11 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1679, average loss: 0.9171
[09/26 00:38:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 91.43	
[09/26 00:38:11 visual_prompt]: Training 65 / 100 epoch, with learning rate 3.454915028125263
[09/26 00:38:18 visual_prompt]: Epoch 65 / 100: avg data time: 4.32e-02, avg batch time: 0.4880, average train loss: 0.0110
[09/26 00:38:19 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1677, average loss: 1.2011
[09/26 00:38:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 91.56	
[09/26 00:38:19 visual_prompt]: Training 66 / 100 epoch, with learning rate 3.289899283371657
[09/26 00:38:26 visual_prompt]: Epoch 66 / 100: avg data time: 5.83e-02, avg batch time: 0.5023, average train loss: 0.0115
[09/26 00:38:28 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1680, average loss: 0.9563
[09/26 00:38:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 92.63	
[09/26 00:38:28 visual_prompt]: Training 67 / 100 epoch, with learning rate 3.1269670329204398
[09/26 00:38:34 visual_prompt]: Epoch 67 / 100: avg data time: 4.65e-02, avg batch time: 0.4930, average train loss: 0.0089
[09/26 00:38:36 visual_prompt]: Inference (val):avg data time: 3.38e-05, avg batch time: 0.1678, average loss: 0.9949
[09/26 00:38:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 92.24	
[09/26 00:38:36 visual_prompt]: Training 68 / 100 epoch, with learning rate 2.9663167846209997
[09/26 00:38:42 visual_prompt]: Epoch 68 / 100: avg data time: 4.03e-02, avg batch time: 0.4879, average train loss: 0.0029
[09/26 00:38:44 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1675, average loss: 1.0202
[09/26 00:38:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.93	
[09/26 00:38:44 visual_prompt]: Training 69 / 100 epoch, with learning rate 2.8081442660546125
[09/26 00:38:50 visual_prompt]: Epoch 69 / 100: avg data time: 5.88e-02, avg batch time: 0.5034, average train loss: 0.0053
[09/26 00:38:52 visual_prompt]: Inference (val):avg data time: 3.08e-05, avg batch time: 0.1676, average loss: 1.0863
[09/26 00:38:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 91.46	
[09/26 00:38:52 visual_prompt]: Training 70 / 100 epoch, with learning rate 2.6526421860705476
[09/26 00:38:59 visual_prompt]: Epoch 70 / 100: avg data time: 5.83e-02, avg batch time: 0.5025, average train loss: 0.0097
[09/26 00:39:00 visual_prompt]: Inference (val):avg data time: 3.17e-05, avg batch time: 0.1673, average loss: 1.0253
[09/26 00:39:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 91.24	
[09/26 00:39:00 visual_prompt]: Training 71 / 100 epoch, with learning rate 2.500000000000001
[09/26 00:39:07 visual_prompt]: Epoch 71 / 100: avg data time: 5.01e-02, avg batch time: 0.4949, average train loss: 0.0035
[09/26 00:39:08 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1678, average loss: 1.0729
[09/26 00:39:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.34	
[09/26 00:39:08 visual_prompt]: Training 72 / 100 epoch, with learning rate 2.350403678833976
[09/26 00:39:15 visual_prompt]: Epoch 72 / 100: avg data time: 4.55e-02, avg batch time: 0.4912, average train loss: 0.0036
[09/26 00:39:16 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1680, average loss: 1.0601
[09/26 00:39:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 91.51	
[09/26 00:39:16 visual_prompt]: Training 73 / 100 epoch, with learning rate 2.2040354826462667
[09/26 00:39:23 visual_prompt]: Epoch 73 / 100: avg data time: 3.86e-02, avg batch time: 0.4864, average train loss: 0.0025
[09/26 00:39:24 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1679, average loss: 1.1004
[09/26 00:39:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 91.51	
[09/26 00:39:24 visual_prompt]: Training 74 / 100 epoch, with learning rate 2.061073738537635
[09/26 00:39:31 visual_prompt]: Epoch 74 / 100: avg data time: 6.15e-02, avg batch time: 0.5062, average train loss: 0.0020
[09/26 00:39:32 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1678, average loss: 1.1105
[09/26 00:39:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 91.47	
[09/26 00:39:32 visual_prompt]: Training 75 / 100 epoch, with learning rate 1.9216926233717087
[09/26 00:39:39 visual_prompt]: Epoch 75 / 100: avg data time: 4.93e-02, avg batch time: 0.4933, average train loss: 0.0035
[09/26 00:39:40 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1677, average loss: 1.0528
[09/26 00:39:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 91.37	
[09/26 00:39:40 visual_prompt]: Training 76 / 100 epoch, with learning rate 1.7860619515673033
[09/26 00:39:47 visual_prompt]: Epoch 76 / 100: avg data time: 5.43e-02, avg batch time: 0.4993, average train loss: 0.0027
[09/26 00:39:49 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1681, average loss: 1.0892
[09/26 00:39:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 91.35	
[09/26 00:39:49 visual_prompt]: Training 77 / 100 epoch, with learning rate 1.6543469682057106
[09/26 00:39:55 visual_prompt]: Epoch 77 / 100: avg data time: 5.45e-02, avg batch time: 0.4984, average train loss: 0.0017
[09/26 00:39:57 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1676, average loss: 1.0945
[09/26 00:39:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.32	
[09/26 00:39:57 visual_prompt]: Training 78 / 100 epoch, with learning rate 1.5267081477050133
[09/26 00:40:03 visual_prompt]: Epoch 78 / 100: avg data time: 4.10e-02, avg batch time: 0.4861, average train loss: 0.0015
[09/26 00:40:05 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1680, average loss: 1.0890
[09/26 00:40:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 91.34	
[09/26 00:40:05 visual_prompt]: Training 79 / 100 epoch, with learning rate 1.403300998306745
[09/26 00:40:11 visual_prompt]: Epoch 79 / 100: avg data time: 4.30e-02, avg batch time: 0.4879, average train loss: 0.0019
[09/26 00:40:13 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.1675, average loss: 1.1053
[09/26 00:40:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.37	
[09/26 00:40:13 visual_prompt]: Training 80 / 100 epoch, with learning rate 1.2842758726130281
[09/26 00:40:19 visual_prompt]: Epoch 80 / 100: avg data time: 5.00e-02, avg batch time: 0.4941, average train loss: 0.0026
[09/26 00:40:21 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1682, average loss: 1.0965
[09/26 00:40:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 91.33	
[09/26 00:40:21 visual_prompt]: Training 81 / 100 epoch, with learning rate 1.1697777844051105
[09/26 00:40:27 visual_prompt]: Epoch 81 / 100: avg data time: 4.70e-02, avg batch time: 0.4925, average train loss: 0.0015
[09/26 00:40:29 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1680, average loss: 1.1095
[09/26 00:40:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.31	
[09/26 00:40:29 visual_prompt]: Training 82 / 100 epoch, with learning rate 1.0599462319663906
[09/26 00:40:36 visual_prompt]: Epoch 82 / 100: avg data time: 4.04e-02, avg batch time: 0.4887, average train loss: 0.0026
[09/26 00:40:37 visual_prompt]: Inference (val):avg data time: 2.08e-05, avg batch time: 0.1676, average loss: 1.0937
[09/26 00:40:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 91.27	
[09/26 00:40:37 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.9549150281252633
[09/26 00:40:44 visual_prompt]: Epoch 83 / 100: avg data time: 4.72e-02, avg batch time: 0.4923, average train loss: 0.0021
[09/26 00:40:45 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1676, average loss: 1.0795
[09/26 00:40:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 91.25	
[09/26 00:40:45 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.8548121372247919
[09/26 00:40:52 visual_prompt]: Epoch 84 / 100: avg data time: 5.08e-02, avg batch time: 0.4967, average train loss: 0.0019
[09/26 00:40:53 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1674, average loss: 1.0891
[09/26 00:40:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 91.30	
[09/26 00:40:53 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.7597595192178702
[09/26 00:41:00 visual_prompt]: Epoch 85 / 100: avg data time: 3.97e-02, avg batch time: 0.4853, average train loss: 0.0014
[09/26 00:41:01 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.1678, average loss: 1.0996
[09/26 00:41:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 91.36	
[09/26 00:41:01 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.6698729810778065
[09/26 00:41:08 visual_prompt]: Epoch 86 / 100: avg data time: 4.87e-02, avg batch time: 0.4948, average train loss: 0.0013
[09/26 00:41:09 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1676, average loss: 1.1083
[09/26 00:41:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.40	
[09/26 00:41:09 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.5852620357053651
[09/26 00:41:16 visual_prompt]: Epoch 87 / 100: avg data time: 4.76e-02, avg batch time: 0.4936, average train loss: 0.0018
[09/26 00:41:17 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.1679, average loss: 1.1106
[09/26 00:41:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.39	
[09/26 00:41:17 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.5060297685041659
[09/26 00:41:24 visual_prompt]: Epoch 88 / 100: avg data time: 4.37e-02, avg batch time: 0.4894, average train loss: 0.0012
[09/26 00:41:25 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1675, average loss: 1.1130
[09/26 00:41:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.39	
[09/26 00:41:25 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.4322727117869951
[09/26 00:41:32 visual_prompt]: Epoch 89 / 100: avg data time: 4.11e-02, avg batch time: 0.4867, average train loss: 0.0014
[09/26 00:41:33 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1679, average loss: 1.1178
[09/26 00:41:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.40	
[09/26 00:41:33 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.36408072716606343
[09/26 00:41:40 visual_prompt]: Epoch 90 / 100: avg data time: 4.23e-02, avg batch time: 0.4871, average train loss: 0.0022
[09/26 00:41:41 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1677, average loss: 1.1129
[09/26 00:41:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.37	
[09/26 00:41:41 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.3015368960704584
[09/26 00:41:48 visual_prompt]: Epoch 91 / 100: avg data time: 4.43e-02, avg batch time: 0.4899, average train loss: 0.0013
[09/26 00:41:49 visual_prompt]: Inference (val):avg data time: 2.14e-05, avg batch time: 0.1674, average loss: 1.1134
[09/26 00:41:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.34	
[09/26 00:41:49 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.24471741852423234
[09/26 00:41:56 visual_prompt]: Epoch 92 / 100: avg data time: 5.24e-02, avg batch time: 0.4979, average train loss: 0.0011
[09/26 00:41:58 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1677, average loss: 1.1147
[09/26 00:41:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.35	
[09/26 00:41:58 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.19369152030840553
[09/26 00:42:04 visual_prompt]: Epoch 93 / 100: avg data time: 5.19e-02, avg batch time: 0.4965, average train loss: 0.0015
[09/26 00:42:06 visual_prompt]: Inference (val):avg data time: 3.69e-05, avg batch time: 0.1675, average loss: 1.1156
[09/26 00:42:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.36	
[09/26 00:42:06 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.14852136862001764
[09/26 00:42:12 visual_prompt]: Epoch 94 / 100: avg data time: 4.50e-02, avg batch time: 0.4921, average train loss: 0.0011
[09/26 00:42:14 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1676, average loss: 1.1145
[09/26 00:42:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.34	
[09/26 00:42:14 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.10926199633097156
[09/26 00:42:21 visual_prompt]: Epoch 95 / 100: avg data time: 4.55e-02, avg batch time: 0.4903, average train loss: 0.0026
[09/26 00:42:22 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1675, average loss: 1.1156
[09/26 00:42:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.35	
[09/26 00:42:22 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.0759612349389599
[09/26 00:42:29 visual_prompt]: Epoch 96 / 100: avg data time: 3.90e-02, avg batch time: 0.4846, average train loss: 0.0017
[09/26 00:42:30 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.1675, average loss: 1.1169
[09/26 00:42:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.35	
[09/26 00:42:30 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.04865965629214819
[09/26 00:42:37 visual_prompt]: Epoch 97 / 100: avg data time: 4.21e-02, avg batch time: 0.4903, average train loss: 0.0021
[09/26 00:42:38 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1676, average loss: 1.1177
[09/26 00:42:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.36	
[09/26 00:42:38 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.02739052315863355
[09/26 00:42:45 visual_prompt]: Epoch 98 / 100: avg data time: 5.14e-02, avg batch time: 0.4959, average train loss: 0.0023
[09/26 00:42:46 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1676, average loss: 1.1186
[09/26 00:42:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.37	
[09/26 00:42:46 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.012179748700879012
[09/26 00:42:53 visual_prompt]: Epoch 99 / 100: avg data time: 4.07e-02, avg batch time: 0.4872, average train loss: 0.0012
[09/26 00:42:54 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1677, average loss: 1.1187
[09/26 00:42:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.37	
[09/26 00:42:54 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0030458649045211894
[09/26 00:43:01 visual_prompt]: Epoch 100 / 100: avg data time: 4.88e-02, avg batch time: 0.4950, average train loss: 0.0013
[09/26 00:43:02 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1676, average loss: 1.1187
[09/26 00:43:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.37	
[09/26 00:43:02 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 00:43:02 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 00:43:02 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 00:43:02 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 00:43:02 visual_prompt]: Training with config:
[09/26 00:43:02 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr5.0_wd0.01/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.01, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 5.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 00:43:02 visual_prompt]: Loading training data...
[09/26 00:43:02 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 00:43:03 visual_prompt]: Number of images: 800
[09/26 00:43:03 visual_prompt]: Number of classes: 2 / 2
[09/26 00:43:03 visual_prompt]: Loading validation data...
[09/26 00:43:03 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 00:43:04 visual_prompt]: Number of images: 200
[09/26 00:43:04 visual_prompt]: Number of classes: 2 / 2
[09/26 00:43:04 visual_prompt]: Constructing models...
[09/26 00:43:06 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 00:43:06 visual_prompt]: tuned percent:0.536
[09/26 00:43:06 visual_prompt]: Device used for model: 0
[09/26 00:43:06 visual_prompt]: Setting up Evaluator...
[09/26 00:43:06 visual_prompt]: Setting up Trainer...
[09/26 00:43:06 visual_prompt]: 	Setting up the optimizer...
[09/26 00:43:06 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 00:43:13 visual_prompt]: Epoch 1 / 100: avg data time: 4.57e-02, avg batch time: 0.4887, average train loss: 1.9996
[09/26 00:43:14 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1673, average loss: 2.0033
[09/26 00:43:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 00:43:14 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 00:43:14 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.5
[09/26 00:43:21 visual_prompt]: Epoch 2 / 100: avg data time: 4.68e-02, avg batch time: 0.4898, average train loss: 9.6680
[09/26 00:43:22 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1673, average loss: 0.7751
[09/26 00:43:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 73.01	
[09/26 00:43:22 visual_prompt]: Training 3 / 100 epoch, with learning rate 1.0
[09/26 00:43:29 visual_prompt]: Epoch 3 / 100: avg data time: 4.15e-02, avg batch time: 0.4871, average train loss: 1.5544
[09/26 00:43:31 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1673, average loss: 0.8859
[09/26 00:43:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 71.44	
[09/26 00:43:31 visual_prompt]: Training 4 / 100 epoch, with learning rate 1.5
[09/26 00:43:37 visual_prompt]: Epoch 4 / 100: avg data time: 4.17e-02, avg batch time: 0.4861, average train loss: 1.7721
[09/26 00:43:38 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1676, average loss: 2.6231
[09/26 00:43:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 50.50	
[09/26 00:43:38 visual_prompt]: Training 5 / 100 epoch, with learning rate 2.0
[09/26 00:43:45 visual_prompt]: Epoch 5 / 100: avg data time: 4.33e-02, avg batch time: 0.4880, average train loss: 2.5765
[09/26 00:43:46 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1675, average loss: 1.3813
[09/26 00:43:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 70.20	
[09/26 00:43:46 visual_prompt]: Training 6 / 100 epoch, with learning rate 2.5
[09/26 00:43:53 visual_prompt]: Epoch 6 / 100: avg data time: 4.67e-02, avg batch time: 0.4915, average train loss: 2.5227
[09/26 00:43:55 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.1676, average loss: 1.7566
[09/26 00:43:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 29.71	
[09/26 00:43:55 visual_prompt]: Training 7 / 100 epoch, with learning rate 3.0
[09/26 00:44:01 visual_prompt]: Epoch 7 / 100: avg data time: 5.35e-02, avg batch time: 0.4990, average train loss: 3.8889
[09/26 00:44:03 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1677, average loss: 12.4901
[09/26 00:44:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 40.72	
[09/26 00:44:03 visual_prompt]: Training 8 / 100 epoch, with learning rate 3.5
[09/26 00:44:09 visual_prompt]: Epoch 8 / 100: avg data time: 4.51e-02, avg batch time: 0.4903, average train loss: 6.5896
[09/26 00:44:11 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1673, average loss: 8.7148
[09/26 00:44:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 50.56	
[09/26 00:44:11 visual_prompt]: Training 9 / 100 epoch, with learning rate 4.0
[09/26 00:44:17 visual_prompt]: Epoch 9 / 100: avg data time: 5.51e-02, avg batch time: 0.4984, average train loss: 4.5374
[09/26 00:44:19 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1677, average loss: 4.3812
[09/26 00:44:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 41.33	
[09/26 00:44:19 visual_prompt]: Training 10 / 100 epoch, with learning rate 4.5
[09/26 00:44:26 visual_prompt]: Epoch 10 / 100: avg data time: 3.94e-02, avg batch time: 0.4861, average train loss: 4.3717
[09/26 00:44:27 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1674, average loss: 6.0844
[09/26 00:44:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 62.46	
[09/26 00:44:27 visual_prompt]: Training 11 / 100 epoch, with learning rate 5.0
[09/26 00:44:34 visual_prompt]: Epoch 11 / 100: avg data time: 4.67e-02, avg batch time: 0.4924, average train loss: 4.7988
[09/26 00:44:35 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1674, average loss: 10.8816
[09/26 00:44:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 21.97	
[09/26 00:44:35 visual_prompt]: Training 12 / 100 epoch, with learning rate 4.998477067547739
[09/26 00:44:42 visual_prompt]: Epoch 12 / 100: avg data time: 4.00e-02, avg batch time: 0.4841, average train loss: 6.8609
[09/26 00:44:43 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1678, average loss: 2.7806
[09/26 00:44:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 35.99	
[09/26 00:44:43 visual_prompt]: Training 13 / 100 epoch, with learning rate 4.993910125649561
[09/26 00:44:50 visual_prompt]: Epoch 13 / 100: avg data time: 5.39e-02, avg batch time: 0.4975, average train loss: 5.3770
[09/26 00:44:51 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1673, average loss: 4.5480
[09/26 00:44:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 56.29	
[09/26 00:44:51 visual_prompt]: Training 14 / 100 epoch, with learning rate 4.986304738420683
[09/26 00:44:58 visual_prompt]: Epoch 14 / 100: avg data time: 3.98e-02, avg batch time: 0.4851, average train loss: 12.5719
[09/26 00:44:59 visual_prompt]: Inference (val):avg data time: 1.96e-05, avg batch time: 0.1674, average loss: 7.1155
[09/26 00:44:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 46.79	
[09/26 00:44:59 visual_prompt]: Training 15 / 100 epoch, with learning rate 4.975670171853926
[09/26 00:45:06 visual_prompt]: Epoch 15 / 100: avg data time: 4.79e-02, avg batch time: 0.4932, average train loss: 10.7184
[09/26 00:45:07 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1677, average loss: 20.1627
[09/26 00:45:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 75.51	
[09/26 00:45:07 visual_prompt]: Training 16 / 100 epoch, with learning rate 4.962019382530521
[09/26 00:45:14 visual_prompt]: Epoch 16 / 100: avg data time: 4.00e-02, avg batch time: 0.4858, average train loss: 11.8489
[09/26 00:45:15 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1679, average loss: 17.8308
[09/26 00:45:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 58.42	
[09/26 00:45:15 visual_prompt]: Training 17 / 100 epoch, with learning rate 4.945369001834514
[09/26 00:45:22 visual_prompt]: Epoch 17 / 100: avg data time: 4.00e-02, avg batch time: 0.4850, average train loss: 13.1429
[09/26 00:45:23 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1676, average loss: 11.7917
[09/26 00:45:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 56.11	
[09/26 00:45:23 visual_prompt]: Training 18 / 100 epoch, with learning rate 4.925739315689991
[09/26 00:45:30 visual_prompt]: Epoch 18 / 100: avg data time: 3.76e-02, avg batch time: 0.4822, average train loss: 12.3749
[09/26 00:45:31 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1679, average loss: 3.5611
[09/26 00:45:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 72.98	
[09/26 00:45:31 visual_prompt]: Training 19 / 100 epoch, with learning rate 4.903154239845797
[09/26 00:45:38 visual_prompt]: Epoch 19 / 100: avg data time: 5.55e-02, avg batch time: 0.5003, average train loss: 6.2346
[09/26 00:45:39 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1679, average loss: 7.9547
[09/26 00:45:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 80.31	
[09/26 00:45:39 visual_prompt]: Training 20 / 100 epoch, with learning rate 4.877641290737884
[09/26 00:45:46 visual_prompt]: Epoch 20 / 100: avg data time: 4.79e-02, avg batch time: 0.4921, average train loss: 13.2836
[09/26 00:45:47 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1675, average loss: 2.7463
[09/26 00:45:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 43.00	rocauc: 42.75	
[09/26 00:45:47 visual_prompt]: Training 21 / 100 epoch, with learning rate 4.849231551964771
[09/26 00:45:54 visual_prompt]: Epoch 21 / 100: avg data time: 4.07e-02, avg batch time: 0.4877, average train loss: 11.0650
[09/26 00:45:55 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1676, average loss: 6.3805
[09/26 00:45:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 58.98	
[09/26 00:45:55 visual_prompt]: Training 22 / 100 epoch, with learning rate 4.817959636416969
[09/26 00:46:02 visual_prompt]: Epoch 22 / 100: avg data time: 4.14e-02, avg batch time: 0.4868, average train loss: 15.7590
[09/26 00:46:03 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1671, average loss: 20.0956
[09/26 00:46:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 40.06	
[09/26 00:46:03 visual_prompt]: Training 23 / 100 epoch, with learning rate 4.783863644106502
[09/26 00:46:10 visual_prompt]: Epoch 23 / 100: avg data time: 5.10e-02, avg batch time: 0.4956, average train loss: 8.2582
[09/26 00:46:11 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1677, average loss: 8.6251
[09/26 00:46:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 64.03	
[09/26 00:46:11 visual_prompt]: Training 24 / 100 epoch, with learning rate 4.7469851157479175
[09/26 00:46:18 visual_prompt]: Epoch 24 / 100: avg data time: 4.07e-02, avg batch time: 0.4864, average train loss: 7.6872
[09/26 00:46:19 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1675, average loss: 2.0327
[09/26 00:46:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 73.05	
[09/26 00:46:19 visual_prompt]: Training 25 / 100 epoch, with learning rate 4.707368982147317
[09/26 00:46:26 visual_prompt]: Epoch 25 / 100: avg data time: 4.19e-02, avg batch time: 0.4859, average train loss: 11.6393
[09/26 00:46:27 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1678, average loss: 1.5867
[09/26 00:46:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 28.60	
[09/26 00:46:27 visual_prompt]: Training 26 / 100 epoch, with learning rate 4.665063509461097
[09/26 00:46:34 visual_prompt]: Epoch 26 / 100: avg data time: 4.87e-02, avg batch time: 0.4934, average train loss: 10.0482
[09/26 00:46:35 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1677, average loss: 8.1335
[09/26 00:46:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 63.94	
[09/26 00:46:35 visual_prompt]: Training 27 / 100 epoch, with learning rate 4.620120240391064
[09/26 00:46:42 visual_prompt]: Epoch 27 / 100: avg data time: 4.80e-02, avg batch time: 0.4931, average train loss: 8.3589
[09/26 00:46:43 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1674, average loss: 0.7109
[09/26 00:46:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 57.05	
[09/26 00:46:43 visual_prompt]: Training 28 / 100 epoch, with learning rate 4.572593931387604
[09/26 00:46:50 visual_prompt]: Epoch 28 / 100: avg data time: 5.27e-02, avg batch time: 0.4978, average train loss: 5.5917
[09/26 00:46:52 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.1675, average loss: 15.4884
[09/26 00:46:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 56.49	
[09/26 00:46:52 visual_prompt]: Training 29 / 100 epoch, with learning rate 4.522542485937368
[09/26 00:46:58 visual_prompt]: Epoch 29 / 100: avg data time: 4.76e-02, avg batch time: 0.4924, average train loss: 9.7536
[09/26 00:47:00 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1676, average loss: 3.8353
[09/26 00:47:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 72.43	
[09/26 00:47:00 visual_prompt]: Training 30 / 100 epoch, with learning rate 4.4700268840168045
[09/26 00:47:06 visual_prompt]: Epoch 30 / 100: avg data time: 4.10e-02, avg batch time: 0.4867, average train loss: 5.3753
[09/26 00:47:08 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1673, average loss: 4.9534
[09/26 00:47:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 54.83	
[09/26 00:47:08 visual_prompt]: Training 31 / 100 epoch, with learning rate 4.415111107797445
[09/26 00:47:14 visual_prompt]: Epoch 31 / 100: avg data time: 4.97e-02, avg batch time: 0.4953, average train loss: 7.5982
[09/26 00:47:16 visual_prompt]: Inference (val):avg data time: 2.14e-05, avg batch time: 0.1679, average loss: 3.6536
[09/26 00:47:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 53.09	
[09/26 00:47:16 visual_prompt]: Training 32 / 100 epoch, with learning rate 4.357862063693486
[09/26 00:47:22 visual_prompt]: Epoch 32 / 100: avg data time: 4.17e-02, avg batch time: 0.4864, average train loss: 5.8795
[09/26 00:47:24 visual_prompt]: Inference (val):avg data time: 2.14e-05, avg batch time: 0.1674, average loss: 16.6921
[09/26 00:47:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 50.18	
[09/26 00:47:24 visual_prompt]: Training 33 / 100 epoch, with learning rate 4.298349500846628
[09/26 00:47:30 visual_prompt]: Epoch 33 / 100: avg data time: 3.98e-02, avg batch time: 0.4857, average train loss: 7.2675
[09/26 00:47:32 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1676, average loss: 0.8736
[09/26 00:47:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 25.89	
[09/26 00:47:32 visual_prompt]: Training 34 / 100 epoch, with learning rate 4.236645926147493
[09/26 00:47:39 visual_prompt]: Epoch 34 / 100: avg data time: 4.88e-02, avg batch time: 0.4931, average train loss: 5.1523
[09/26 00:47:40 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1675, average loss: 4.0483
[09/26 00:47:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 40.39	
[09/26 00:47:40 visual_prompt]: Training 35 / 100 epoch, with learning rate 4.172826515897146
[09/26 00:47:47 visual_prompt]: Epoch 35 / 100: avg data time: 4.35e-02, avg batch time: 0.4877, average train loss: 4.6277
[09/26 00:47:48 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1678, average loss: 13.7608
[09/26 00:47:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 76.49	
[09/26 00:47:48 visual_prompt]: Training 36 / 100 epoch, with learning rate 4.106969024216348
[09/26 00:47:55 visual_prompt]: Epoch 36 / 100: avg data time: 5.50e-02, avg batch time: 0.4997, average train loss: 6.5815
[09/26 00:47:56 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1676, average loss: 19.9107
[09/26 00:47:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 33.96	
[09/26 00:47:56 visual_prompt]: Training 37 / 100 epoch, with learning rate 4.039153688314146
[09/26 00:48:03 visual_prompt]: Epoch 37 / 100: avg data time: 4.46e-02, avg batch time: 0.4907, average train loss: 8.7324
[09/26 00:48:04 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1673, average loss: 32.5851
[09/26 00:48:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 20.18	
[09/26 00:48:04 visual_prompt]: Training 38 / 100 epoch, with learning rate 3.969463130731183
[09/26 00:48:11 visual_prompt]: Epoch 38 / 100: avg data time: 5.29e-02, avg batch time: 0.4975, average train loss: 14.3985
[09/26 00:48:13 visual_prompt]: Inference (val):avg data time: 3.66e-05, avg batch time: 0.1676, average loss: 10.6248
[09/26 00:48:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 31.09	
[09/26 00:48:13 visual_prompt]: Training 39 / 100 epoch, with learning rate 3.897982258676867
[09/26 00:48:19 visual_prompt]: Epoch 39 / 100: avg data time: 5.25e-02, avg batch time: 0.4978, average train loss: 6.2017
[09/26 00:48:21 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1676, average loss: 5.3651
[09/26 00:48:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 41.60	
[09/26 00:48:21 visual_prompt]: Training 40 / 100 epoch, with learning rate 3.824798160583012
[09/26 00:48:28 visual_prompt]: Epoch 40 / 100: avg data time: 4.70e-02, avg batch time: 0.4903, average train loss: 5.1183
[09/26 00:48:30 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1671, average loss: 7.3035
[09/26 00:48:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 25.42	
[09/26 00:48:30 visual_prompt]: Training 41 / 100 epoch, with learning rate 3.75
[09/26 00:48:36 visual_prompt]: Epoch 41 / 100: avg data time: 3.54e-02, avg batch time: 0.4794, average train loss: 7.5974
[09/26 00:48:38 visual_prompt]: Inference (val):avg data time: 3.47e-05, avg batch time: 0.1678, average loss: 0.6657
[09/26 00:48:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 53.50	rocauc: 75.56	
[09/26 00:48:38 visual_prompt]: Best epoch 41: best metric: 0.535
[09/26 00:48:38 visual_prompt]: Training 42 / 100 epoch, with learning rate 3.673678906964727
[09/26 00:48:44 visual_prompt]: Epoch 42 / 100: avg data time: 4.06e-02, avg batch time: 0.4852, average train loss: 9.4522
[09/26 00:48:46 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1672, average loss: 4.2000
[09/26 00:48:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 50.90	
[09/26 00:48:46 visual_prompt]: Training 43 / 100 epoch, with learning rate 3.5959278669726933
[09/26 00:48:52 visual_prompt]: Epoch 43 / 100: avg data time: 4.07e-02, avg batch time: 0.4856, average train loss: 4.5429
[09/26 00:48:54 visual_prompt]: Inference (val):avg data time: 2.73e-05, avg batch time: 0.1674, average loss: 15.7678
[09/26 00:48:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 64.16	
[09/26 00:48:54 visual_prompt]: Training 44 / 100 epoch, with learning rate 3.516841607689501
[09/26 00:49:00 visual_prompt]: Epoch 44 / 100: avg data time: 3.86e-02, avg batch time: 0.4838, average train loss: 10.9807
[09/26 00:49:02 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1674, average loss: 3.6585
[09/26 00:49:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 15.72	
[09/26 00:49:02 visual_prompt]: Training 45 / 100 epoch, with learning rate 3.4365164835397803
[09/26 00:49:09 visual_prompt]: Epoch 45 / 100: avg data time: 5.17e-02, avg batch time: 0.4952, average train loss: 5.9828
[09/26 00:49:10 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1679, average loss: 3.0339
[09/26 00:49:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 51.07	
[09/26 00:49:10 visual_prompt]: Training 46 / 100 epoch, with learning rate 3.3550503583141724
[09/26 00:49:17 visual_prompt]: Epoch 46 / 100: avg data time: 4.94e-02, avg batch time: 0.4932, average train loss: 13.1062
[09/26 00:49:18 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1676, average loss: 3.8059
[09/26 00:49:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 47.63	
[09/26 00:49:18 visual_prompt]: Training 47 / 100 epoch, with learning rate 3.2725424859373686
[09/26 00:49:25 visual_prompt]: Epoch 47 / 100: avg data time: 5.12e-02, avg batch time: 0.4950, average train loss: 5.5549
[09/26 00:49:26 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1675, average loss: 2.3571
[09/26 00:49:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 39.37	
[09/26 00:49:26 visual_prompt]: Training 48 / 100 epoch, with learning rate 3.1890933895424975
[09/26 00:49:33 visual_prompt]: Epoch 48 / 100: avg data time: 5.26e-02, avg batch time: 0.4962, average train loss: 4.5764
[09/26 00:49:34 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1677, average loss: 9.0138
[09/26 00:49:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 47.07	
[09/26 00:49:34 visual_prompt]: Training 49 / 100 epoch, with learning rate 3.104804738999169
[09/26 00:49:41 visual_prompt]: Epoch 49 / 100: avg data time: 4.66e-02, avg batch time: 0.4898, average train loss: 12.4592
[09/26 00:49:43 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1676, average loss: 6.3954
[09/26 00:49:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 52.21	
[09/26 00:49:43 visual_prompt]: Training 50 / 100 epoch, with learning rate 3.019779227044398
[09/26 00:49:49 visual_prompt]: Epoch 50 / 100: avg data time: 6.01e-02, avg batch time: 0.5039, average train loss: 4.2965
[09/26 00:49:51 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1676, average loss: 6.3471
[09/26 00:49:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 53.01	
[09/26 00:49:51 visual_prompt]: Training 51 / 100 epoch, with learning rate 2.934120444167326
[09/26 00:49:58 visual_prompt]: Epoch 51 / 100: avg data time: 4.47e-02, avg batch time: 0.4906, average train loss: 4.3958
[09/26 00:49:59 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1674, average loss: 5.8194
[09/26 00:49:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 82.47	
[09/26 00:49:59 visual_prompt]: Training 52 / 100 epoch, with learning rate 2.8479327524001636
[09/26 00:50:06 visual_prompt]: Epoch 52 / 100: avg data time: 5.14e-02, avg batch time: 0.4962, average train loss: 5.7031
[09/26 00:50:07 visual_prompt]: Inference (val):avg data time: 3.40e-05, avg batch time: 0.1679, average loss: 2.6371
[09/26 00:50:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 68.22	
[09/26 00:50:07 visual_prompt]: Training 53 / 100 epoch, with learning rate 2.761321158169134
[09/26 00:50:14 visual_prompt]: Epoch 53 / 100: avg data time: 5.52e-02, avg batch time: 0.4996, average train loss: 3.2425
[09/26 00:50:15 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1675, average loss: 1.7089
[09/26 00:50:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 37.72	
[09/26 00:50:15 visual_prompt]: Training 54 / 100 epoch, with learning rate 2.6743911843603128
[09/26 00:50:22 visual_prompt]: Epoch 54 / 100: avg data time: 4.58e-02, avg batch time: 0.4906, average train loss: 3.8508
[09/26 00:50:23 visual_prompt]: Inference (val):avg data time: 3.01e-05, avg batch time: 0.1672, average loss: 2.3679
[09/26 00:50:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 77.80	
[09/26 00:50:23 visual_prompt]: Training 55 / 100 epoch, with learning rate 2.5872487417562526
[09/26 00:50:30 visual_prompt]: Epoch 55 / 100: avg data time: 4.82e-02, avg batch time: 0.4924, average train loss: 4.1121
[09/26 00:50:32 visual_prompt]: Inference (val):avg data time: 4.96e-05, avg batch time: 0.1676, average loss: 10.5155
[09/26 00:50:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 37.78	
[09/26 00:50:32 visual_prompt]: Training 56 / 100 epoch, with learning rate 2.5
[09/26 00:50:38 visual_prompt]: Epoch 56 / 100: avg data time: 4.96e-02, avg batch time: 0.4948, average train loss: 6.9078
[09/26 00:50:40 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1674, average loss: 9.2722
[09/26 00:50:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 51.97	
[09/26 00:50:40 visual_prompt]: Training 57 / 100 epoch, with learning rate 2.4127512582437483
[09/26 00:50:46 visual_prompt]: Epoch 57 / 100: avg data time: 4.62e-02, avg batch time: 0.4911, average train loss: 6.3151
[09/26 00:50:48 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1678, average loss: 5.0249
[09/26 00:50:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 79.88	
[09/26 00:50:48 visual_prompt]: Training 58 / 100 epoch, with learning rate 2.325608815639687
[09/26 00:50:54 visual_prompt]: Epoch 58 / 100: avg data time: 4.30e-02, avg batch time: 0.4874, average train loss: 2.6466
[09/26 00:50:56 visual_prompt]: Inference (val):avg data time: 3.04e-05, avg batch time: 0.1677, average loss: 1.5142
[09/26 00:50:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 55.31	
[09/26 00:50:56 visual_prompt]: Training 59 / 100 epoch, with learning rate 2.2386788418308665
[09/26 00:51:02 visual_prompt]: Epoch 59 / 100: avg data time: 5.09e-02, avg batch time: 0.4943, average train loss: 3.1243
[09/26 00:51:04 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1677, average loss: 0.7415
[09/26 00:51:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 71.13	
[09/26 00:51:04 visual_prompt]: Training 60 / 100 epoch, with learning rate 2.1520672475998373
[09/26 00:51:11 visual_prompt]: Epoch 60 / 100: avg data time: 5.39e-02, avg batch time: 0.4976, average train loss: 2.8414
[09/26 00:51:12 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1677, average loss: 1.1263
[09/26 00:51:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 33.94	
[09/26 00:51:12 visual_prompt]: Training 61 / 100 epoch, with learning rate 2.0658795558326744
[09/26 00:51:19 visual_prompt]: Epoch 61 / 100: avg data time: 5.53e-02, avg batch time: 0.4998, average train loss: 3.3219
[09/26 00:51:20 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1676, average loss: 1.3655
[09/26 00:51:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 61.11	
[09/26 00:51:20 visual_prompt]: Training 62 / 100 epoch, with learning rate 1.980220772955602
[09/26 00:51:27 visual_prompt]: Epoch 62 / 100: avg data time: 4.99e-02, avg batch time: 0.4950, average train loss: 6.3465
[09/26 00:51:28 visual_prompt]: Inference (val):avg data time: 4.39e-05, avg batch time: 0.1673, average loss: 3.1163
[09/26 00:51:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 48.11	
[09/26 00:51:28 visual_prompt]: Training 63 / 100 epoch, with learning rate 1.895195261000831
[09/26 00:51:35 visual_prompt]: Epoch 63 / 100: avg data time: 5.24e-02, avg batch time: 0.4964, average train loss: 2.4364
[09/26 00:51:37 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1675, average loss: 1.8455
[09/26 00:51:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 60.72	
[09/26 00:51:37 visual_prompt]: Training 64 / 100 epoch, with learning rate 1.8109066104575022
[09/26 00:51:43 visual_prompt]: Epoch 64 / 100: avg data time: 5.23e-02, avg batch time: 0.4971, average train loss: 5.6290
[09/26 00:51:45 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1674, average loss: 1.1265
[09/26 00:51:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 43.49	
[09/26 00:51:45 visual_prompt]: Training 65 / 100 epoch, with learning rate 1.7274575140626316
[09/26 00:51:51 visual_prompt]: Epoch 65 / 100: avg data time: 5.39e-02, avg batch time: 0.4988, average train loss: 3.3318
[09/26 00:51:53 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1675, average loss: 3.6893
[09/26 00:51:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 35.00	rocauc: 42.45	
[09/26 00:51:53 visual_prompt]: Training 66 / 100 epoch, with learning rate 1.6449496416858285
[09/26 00:51:59 visual_prompt]: Epoch 66 / 100: avg data time: 4.63e-02, avg batch time: 0.4903, average train loss: 3.2799
[09/26 00:52:01 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1677, average loss: 1.4817
[09/26 00:52:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 65.69	
[09/26 00:52:01 visual_prompt]: Training 67 / 100 epoch, with learning rate 1.5634835164602199
[09/26 00:52:08 visual_prompt]: Epoch 67 / 100: avg data time: 5.13e-02, avg batch time: 0.4965, average train loss: 2.6152
[09/26 00:52:09 visual_prompt]: Inference (val):avg data time: 2.99e-05, avg batch time: 0.1676, average loss: 2.4020
[09/26 00:52:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 53.54	
[09/26 00:52:09 visual_prompt]: Training 68 / 100 epoch, with learning rate 1.4831583923104998
[09/26 00:52:16 visual_prompt]: Epoch 68 / 100: avg data time: 4.02e-02, avg batch time: 0.4856, average train loss: 1.4492
[09/26 00:52:17 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1677, average loss: 0.7047
[09/26 00:52:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 80.54	
[09/26 00:52:17 visual_prompt]: Training 69 / 100 epoch, with learning rate 1.4040721330273063
[09/26 00:52:24 visual_prompt]: Epoch 69 / 100: avg data time: 5.13e-02, avg batch time: 0.4957, average train loss: 2.1737
[09/26 00:52:25 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1677, average loss: 1.3884
[09/26 00:52:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 49.11	
[09/26 00:52:25 visual_prompt]: Training 70 / 100 epoch, with learning rate 1.3263210930352738
[09/26 00:52:32 visual_prompt]: Epoch 70 / 100: avg data time: 5.58e-02, avg batch time: 0.4998, average train loss: 2.4191
[09/26 00:52:33 visual_prompt]: Inference (val):avg data time: 3.08e-05, avg batch time: 0.1671, average loss: 3.4115
[09/26 00:52:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 62.90	
[09/26 00:52:33 visual_prompt]: Training 71 / 100 epoch, with learning rate 1.2500000000000004
[09/26 00:52:40 visual_prompt]: Epoch 71 / 100: avg data time: 5.49e-02, avg batch time: 0.4986, average train loss: 1.5673
[09/26 00:52:42 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1678, average loss: 0.7288
[09/26 00:52:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 70.51	
[09/26 00:52:42 visual_prompt]: Training 72 / 100 epoch, with learning rate 1.175201839416988
[09/26 00:52:48 visual_prompt]: Epoch 72 / 100: avg data time: 5.18e-02, avg batch time: 0.4957, average train loss: 0.9930
[09/26 00:52:50 visual_prompt]: Inference (val):avg data time: 3.09e-05, avg batch time: 0.1676, average loss: 1.1675
[09/26 00:52:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.32	
[09/26 00:52:50 visual_prompt]: Training 73 / 100 epoch, with learning rate 1.1020177413231333
[09/26 00:52:56 visual_prompt]: Epoch 73 / 100: avg data time: 4.06e-02, avg batch time: 0.4837, average train loss: 0.9396
[09/26 00:52:58 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1675, average loss: 0.7022
[09/26 00:52:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 60.64	
[09/26 00:52:58 visual_prompt]: Training 74 / 100 epoch, with learning rate 1.0305368692688175
[09/26 00:53:04 visual_prompt]: Epoch 74 / 100: avg data time: 4.83e-02, avg batch time: 0.4935, average train loss: 0.9821
[09/26 00:53:06 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1679, average loss: 0.9040
[09/26 00:53:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 50.04	
[09/26 00:53:06 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.9608463116858543
[09/26 00:53:12 visual_prompt]: Epoch 75 / 100: avg data time: 5.66e-02, avg batch time: 0.5012, average train loss: 1.1509
[09/26 00:53:14 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1676, average loss: 0.7013
[09/26 00:53:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.61	
[09/26 00:53:14 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.8930309757836516
[09/26 00:53:20 visual_prompt]: Epoch 76 / 100: avg data time: 4.02e-02, avg batch time: 0.4858, average train loss: 0.7636
[09/26 00:53:22 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1673, average loss: 0.6888
[09/26 00:53:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 81.87	
[09/26 00:53:22 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.8271734841028553
[09/26 00:53:28 visual_prompt]: Epoch 77 / 100: avg data time: 4.23e-02, avg batch time: 0.4885, average train loss: 0.7445
[09/26 00:53:30 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.1678, average loss: 0.7038
[09/26 00:53:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 47.50	rocauc: 52.86	
[09/26 00:53:30 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.7633540738525066
[09/26 00:53:37 visual_prompt]: Epoch 78 / 100: avg data time: 5.43e-02, avg batch time: 0.4987, average train loss: 0.7274
[09/26 00:53:38 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1675, average loss: 0.8183
[09/26 00:53:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 78.20	
[09/26 00:53:38 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.7016504991533725
[09/26 00:53:45 visual_prompt]: Epoch 79 / 100: avg data time: 4.71e-02, avg batch time: 0.4943, average train loss: 0.7597
[09/26 00:53:46 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1673, average loss: 0.6887
[09/26 00:53:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 78.88	
[09/26 00:53:46 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.6421379363065141
[09/26 00:53:53 visual_prompt]: Epoch 80 / 100: avg data time: 4.66e-02, avg batch time: 0.4910, average train loss: 0.7060
[09/26 00:53:54 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1678, average loss: 0.8642
[09/26 00:53:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.88	
[09/26 00:53:54 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.5848888922025552
[09/26 00:54:01 visual_prompt]: Epoch 81 / 100: avg data time: 4.51e-02, avg batch time: 0.4897, average train loss: 0.7462
[09/26 00:54:02 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1676, average loss: 0.7798
[09/26 00:54:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.87	
[09/26 00:54:02 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.5299731159831953
[09/26 00:54:09 visual_prompt]: Epoch 82 / 100: avg data time: 3.99e-02, avg batch time: 0.4864, average train loss: 0.7340
[09/26 00:54:10 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1679, average loss: 0.8179
[09/26 00:54:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.03	
[09/26 00:54:10 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.47745751406263165
[09/26 00:54:17 visual_prompt]: Epoch 83 / 100: avg data time: 4.87e-02, avg batch time: 0.4939, average train loss: 0.7505
[09/26 00:54:18 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1678, average loss: 0.7477
[09/26 00:54:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 60.91	
[09/26 00:54:18 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.42740606861239594
[09/26 00:54:25 visual_prompt]: Epoch 84 / 100: avg data time: 4.11e-02, avg batch time: 0.4865, average train loss: 0.7158
[09/26 00:54:26 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1679, average loss: 0.6862
[09/26 00:54:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 51.50	rocauc: 86.57	
[09/26 00:54:26 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.3798797596089351
[09/26 00:54:33 visual_prompt]: Epoch 85 / 100: avg data time: 4.73e-02, avg batch time: 0.4933, average train loss: 0.7060
[09/26 00:54:34 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1676, average loss: 0.7377
[09/26 00:54:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 79.62	
[09/26 00:54:34 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.33493649053890323
[09/26 00:54:41 visual_prompt]: Epoch 86 / 100: avg data time: 4.15e-02, avg batch time: 0.4867, average train loss: 0.7188
[09/26 00:54:42 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.1673, average loss: 0.6716
[09/26 00:54:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.50	rocauc: 79.50	
[09/26 00:54:42 visual_prompt]: Best epoch 86: best metric: 0.705
[09/26 00:54:42 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.29263101785268253
[09/26 00:54:49 visual_prompt]: Epoch 87 / 100: avg data time: 4.57e-02, avg batch time: 0.4921, average train loss: 0.6818
[09/26 00:54:51 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1675, average loss: 0.6607
[09/26 00:54:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 79.27	
[09/26 00:54:51 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.25301488425208296
[09/26 00:54:57 visual_prompt]: Epoch 88 / 100: avg data time: 4.47e-02, avg batch time: 0.4906, average train loss: 0.6905
[09/26 00:54:59 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1674, average loss: 0.6458
[09/26 00:54:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 87.05	
[09/26 00:54:59 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.21613635589349756
[09/26 00:55:05 visual_prompt]: Epoch 89 / 100: avg data time: 3.56e-02, avg batch time: 0.4812, average train loss: 0.6561
[09/26 00:55:07 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1677, average loss: 0.6064
[09/26 00:55:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 56.50	rocauc: 89.29	
[09/26 00:55:07 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.18204036358303172
[09/26 00:55:13 visual_prompt]: Epoch 90 / 100: avg data time: 4.73e-02, avg batch time: 0.4939, average train loss: 0.7258
[09/26 00:55:15 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1677, average loss: 0.6802
[09/26 00:55:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.00	rocauc: 86.33	
[09/26 00:55:15 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.1507684480352292
[09/26 00:55:21 visual_prompt]: Epoch 91 / 100: avg data time: 4.76e-02, avg batch time: 0.4943, average train loss: 0.7086
[09/26 00:55:23 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1678, average loss: 0.6989
[09/26 00:55:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.95	
[09/26 00:55:23 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.12235870926211617
[09/26 00:55:29 visual_prompt]: Epoch 92 / 100: avg data time: 5.13e-02, avg batch time: 0.4952, average train loss: 0.6944
[09/26 00:55:31 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1677, average loss: 0.6726
[09/26 00:55:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.91	
[09/26 00:55:31 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.09684576015420276
[09/26 00:55:37 visual_prompt]: Epoch 93 / 100: avg data time: 3.97e-02, avg batch time: 0.4849, average train loss: 0.7135
[09/26 00:55:39 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1674, average loss: 0.7197
[09/26 00:55:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 83.30	
[09/26 00:55:39 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.07426068431000882
[09/26 00:55:45 visual_prompt]: Epoch 94 / 100: avg data time: 4.50e-02, avg batch time: 0.4905, average train loss: 0.7016
[09/26 00:55:47 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1675, average loss: 0.6826
[09/26 00:55:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.85	
[09/26 00:55:47 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.05463099816548578
[09/26 00:55:54 visual_prompt]: Epoch 95 / 100: avg data time: 5.65e-02, avg batch time: 0.5017, average train loss: 0.6804
[09/26 00:55:55 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1677, average loss: 0.6428
[09/26 00:55:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 69.50	rocauc: 84.71	
[09/26 00:55:55 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.03798061746947995
[09/26 00:56:02 visual_prompt]: Epoch 96 / 100: avg data time: 4.88e-02, avg batch time: 0.4929, average train loss: 0.6465
[09/26 00:56:03 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1682, average loss: 0.6140
[09/26 00:56:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.50	rocauc: 87.81	
[09/26 00:56:03 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.024329828146074095
[09/26 00:56:10 visual_prompt]: Epoch 97 / 100: avg data time: 5.23e-02, avg batch time: 0.4976, average train loss: 0.6018
[09/26 00:56:11 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1682, average loss: 0.5674
[09/26 00:56:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.50	rocauc: 86.59	
[09/26 00:56:11 visual_prompt]: Best epoch 97: best metric: 0.725
[09/26 00:56:11 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.013695261579316775
[09/26 00:56:18 visual_prompt]: Epoch 98 / 100: avg data time: 4.27e-02, avg batch time: 0.4877, average train loss: 0.6004
[09/26 00:56:19 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1676, average loss: 0.5357
[09/26 00:56:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.00	rocauc: 90.60	
[09/26 00:56:19 visual_prompt]: Best epoch 98: best metric: 0.730
[09/26 00:56:19 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.006089874350439506
[09/26 00:56:26 visual_prompt]: Epoch 99 / 100: avg data time: 4.73e-02, avg batch time: 0.4918, average train loss: 0.5346
[09/26 00:56:27 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1679, average loss: 0.4851
[09/26 00:56:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 90.36	
[09/26 00:56:28 visual_prompt]: Best epoch 99: best metric: 0.780
[09/26 00:56:28 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0015229324522605947
[09/26 00:56:34 visual_prompt]: Epoch 100 / 100: avg data time: 4.14e-02, avg batch time: 0.4869, average train loss: 0.5015
[09/26 00:56:36 visual_prompt]: Inference (val):avg data time: 3.20e-05, avg batch time: 0.1679, average loss: 0.4614
[09/26 00:56:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 90.26	
[09/26 00:56:36 visual_prompt]: Best epoch 100: best metric: 0.795
[09/26 00:56:36 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 00:56:36 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 00:56:36 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 00:56:36 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 00:56:36 visual_prompt]: Training with config:
[09/26 00:56:36 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr5.0_wd0.001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 5.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 00:56:36 visual_prompt]: Loading training data...
[09/26 00:56:36 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 00:56:37 visual_prompt]: Number of images: 800
[09/26 00:56:37 visual_prompt]: Number of classes: 2 / 2
[09/26 00:56:37 visual_prompt]: Loading validation data...
[09/26 00:56:37 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 00:56:37 visual_prompt]: Number of images: 200
[09/26 00:56:37 visual_prompt]: Number of classes: 2 / 2
[09/26 00:56:37 visual_prompt]: Constructing models...
[09/26 00:56:40 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 00:56:40 visual_prompt]: tuned percent:0.536
[09/26 00:56:40 visual_prompt]: Device used for model: 0
[09/26 00:56:40 visual_prompt]: Setting up Evaluator...
[09/26 00:56:40 visual_prompt]: Setting up Trainer...
[09/26 00:56:40 visual_prompt]: 	Setting up the optimizer...
[09/26 00:56:40 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 00:56:46 visual_prompt]: Epoch 1 / 100: avg data time: 4.87e-02, avg batch time: 0.4926, average train loss: 1.9431
[09/26 00:56:48 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1667, average loss: 2.0033
[09/26 00:56:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 00:56:48 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 00:56:48 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.5
[09/26 00:56:54 visual_prompt]: Epoch 2 / 100: avg data time: 4.22e-02, avg batch time: 0.4867, average train loss: 10.4476
[09/26 00:56:56 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1668, average loss: 2.7687
[09/26 00:56:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 51.38	
[09/26 00:56:56 visual_prompt]: Training 3 / 100 epoch, with learning rate 1.0
[09/26 00:57:02 visual_prompt]: Epoch 3 / 100: avg data time: 3.91e-02, avg batch time: 0.4846, average train loss: 1.3259
[09/26 00:57:04 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1670, average loss: 1.8458
[09/26 00:57:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 79.30	
[09/26 00:57:04 visual_prompt]: Training 4 / 100 epoch, with learning rate 1.5
[09/26 00:57:10 visual_prompt]: Epoch 4 / 100: avg data time: 4.68e-02, avg batch time: 0.4899, average train loss: 1.6303
[09/26 00:57:12 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1669, average loss: 1.1750
[09/26 00:57:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 87.81	
[09/26 00:57:12 visual_prompt]: Training 5 / 100 epoch, with learning rate 2.0
[09/26 00:57:18 visual_prompt]: Epoch 5 / 100: avg data time: 4.01e-02, avg batch time: 0.4850, average train loss: 3.6592
[09/26 00:57:20 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1671, average loss: 4.5120
[09/26 00:57:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 51.50	rocauc: 80.59	
[09/26 00:57:20 visual_prompt]: Training 6 / 100 epoch, with learning rate 2.5
[09/26 00:57:26 visual_prompt]: Epoch 6 / 100: avg data time: 5.41e-02, avg batch time: 0.4973, average train loss: 2.4744
[09/26 00:57:28 visual_prompt]: Inference (val):avg data time: 2.10e-05, avg batch time: 0.1673, average loss: 1.9101
[09/26 00:57:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.64	
[09/26 00:57:28 visual_prompt]: Training 7 / 100 epoch, with learning rate 3.0
[09/26 00:57:34 visual_prompt]: Epoch 7 / 100: avg data time: 5.54e-02, avg batch time: 0.4994, average train loss: 3.8015
[09/26 00:57:36 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1673, average loss: 0.9227
[09/26 00:57:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 52.42	
[09/26 00:57:36 visual_prompt]: Training 8 / 100 epoch, with learning rate 3.5
[09/26 00:57:43 visual_prompt]: Epoch 8 / 100: avg data time: 4.32e-02, avg batch time: 0.4876, average train loss: 5.4060
[09/26 00:57:44 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1668, average loss: 6.0209
[09/26 00:57:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 69.38	
[09/26 00:57:44 visual_prompt]: Training 9 / 100 epoch, with learning rate 4.0
[09/26 00:57:51 visual_prompt]: Epoch 9 / 100: avg data time: 5.20e-02, avg batch time: 0.4958, average train loss: 2.4946
[09/26 00:57:52 visual_prompt]: Inference (val):avg data time: 3.46e-05, avg batch time: 0.1670, average loss: 1.8443
[09/26 00:57:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 69.62	
[09/26 00:57:52 visual_prompt]: Training 10 / 100 epoch, with learning rate 4.5
[09/26 00:57:59 visual_prompt]: Epoch 10 / 100: avg data time: 4.26e-02, avg batch time: 0.4877, average train loss: 5.0559
[09/26 00:58:00 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1675, average loss: 4.9847
[09/26 00:58:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 42.18	
[09/26 00:58:00 visual_prompt]: Training 11 / 100 epoch, with learning rate 5.0
[09/26 00:58:07 visual_prompt]: Epoch 11 / 100: avg data time: 5.16e-02, avg batch time: 0.4962, average train loss: 8.9218
[09/26 00:58:08 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1673, average loss: 12.9478
[09/26 00:58:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 82.98	
[09/26 00:58:08 visual_prompt]: Training 12 / 100 epoch, with learning rate 4.998477067547739
[09/26 00:58:15 visual_prompt]: Epoch 12 / 100: avg data time: 4.37e-02, avg batch time: 0.4889, average train loss: 13.9428
[09/26 00:58:16 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1676, average loss: 15.0421
[09/26 00:58:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.75	
[09/26 00:58:16 visual_prompt]: Training 13 / 100 epoch, with learning rate 4.993910125649561
[09/26 00:58:23 visual_prompt]: Epoch 13 / 100: avg data time: 4.73e-02, avg batch time: 0.4927, average train loss: 16.3671
[09/26 00:58:24 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1675, average loss: 18.5069
[09/26 00:58:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 88.46	
[09/26 00:58:24 visual_prompt]: Training 14 / 100 epoch, with learning rate 4.986304738420683
[09/26 00:58:31 visual_prompt]: Epoch 14 / 100: avg data time: 5.44e-02, avg batch time: 0.4976, average train loss: 8.3258
[09/26 00:58:33 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1674, average loss: 3.2258
[09/26 00:58:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 43.47	
[09/26 00:58:33 visual_prompt]: Training 15 / 100 epoch, with learning rate 4.975670171853926
[09/26 00:58:39 visual_prompt]: Epoch 15 / 100: avg data time: 5.89e-02, avg batch time: 0.5022, average train loss: 8.3728
[09/26 00:58:41 visual_prompt]: Inference (val):avg data time: 3.25e-05, avg batch time: 0.1671, average loss: 6.8811
[09/26 00:58:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 58.12	
[09/26 00:58:41 visual_prompt]: Training 16 / 100 epoch, with learning rate 4.962019382530521
[09/26 00:58:48 visual_prompt]: Epoch 16 / 100: avg data time: 4.88e-02, avg batch time: 0.4933, average train loss: 11.8701
[09/26 00:58:49 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1672, average loss: 15.6242
[09/26 00:58:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 57.98	
[09/26 00:58:49 visual_prompt]: Training 17 / 100 epoch, with learning rate 4.945369001834514
[09/26 00:58:56 visual_prompt]: Epoch 17 / 100: avg data time: 4.28e-02, avg batch time: 0.4885, average train loss: 6.9886
[09/26 00:58:57 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1675, average loss: 7.3247
[09/26 00:58:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 83.27	
[09/26 00:58:57 visual_prompt]: Training 18 / 100 epoch, with learning rate 4.925739315689991
[09/26 00:59:04 visual_prompt]: Epoch 18 / 100: avg data time: 4.95e-02, avg batch time: 0.4941, average train loss: 11.3370
[09/26 00:59:05 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1672, average loss: 16.9542
[09/26 00:59:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.32	
[09/26 00:59:05 visual_prompt]: Training 19 / 100 epoch, with learning rate 4.903154239845797
[09/26 00:59:12 visual_prompt]: Epoch 19 / 100: avg data time: 5.28e-02, avg batch time: 0.4965, average train loss: 13.1571
[09/26 00:59:13 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1673, average loss: 3.2773
[09/26 00:59:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 58.09	
[09/26 00:59:13 visual_prompt]: Training 20 / 100 epoch, with learning rate 4.877641290737884
[09/26 00:59:20 visual_prompt]: Epoch 20 / 100: avg data time: 4.73e-02, avg batch time: 0.4919, average train loss: 8.0445
[09/26 00:59:21 visual_prompt]: Inference (val):avg data time: 4.74e-05, avg batch time: 0.1675, average loss: 2.6289
[09/26 00:59:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 74.09	
[09/26 00:59:21 visual_prompt]: Training 21 / 100 epoch, with learning rate 4.849231551964771
[09/26 00:59:28 visual_prompt]: Epoch 21 / 100: avg data time: 5.41e-02, avg batch time: 0.4984, average train loss: 6.1252
[09/26 00:59:30 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1670, average loss: 11.3473
[09/26 00:59:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 67.50	
[09/26 00:59:30 visual_prompt]: Training 22 / 100 epoch, with learning rate 4.817959636416969
[09/26 00:59:36 visual_prompt]: Epoch 22 / 100: avg data time: 4.56e-02, avg batch time: 0.4899, average train loss: 5.0007
[09/26 00:59:38 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1674, average loss: 2.2082
[09/26 00:59:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 54.21	
[09/26 00:59:38 visual_prompt]: Training 23 / 100 epoch, with learning rate 4.783863644106502
[09/26 00:59:44 visual_prompt]: Epoch 23 / 100: avg data time: 5.12e-02, avg batch time: 0.4954, average train loss: 2.1744
[09/26 00:59:46 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1672, average loss: 9.1685
[09/26 00:59:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 72.58	
[09/26 00:59:46 visual_prompt]: Training 24 / 100 epoch, with learning rate 4.7469851157479175
[09/26 00:59:52 visual_prompt]: Epoch 24 / 100: avg data time: 4.75e-02, avg batch time: 0.4911, average train loss: 7.3668
[09/26 00:59:54 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1669, average loss: 5.0644
[09/26 00:59:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 70.23	
[09/26 00:59:54 visual_prompt]: Training 25 / 100 epoch, with learning rate 4.707368982147317
[09/26 01:00:01 visual_prompt]: Epoch 25 / 100: avg data time: 5.79e-02, avg batch time: 0.5017, average train loss: 6.6911
[09/26 01:00:02 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1671, average loss: 3.9211
[09/26 01:00:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 63.70	
[09/26 01:00:02 visual_prompt]: Training 26 / 100 epoch, with learning rate 4.665063509461097
[09/26 01:00:09 visual_prompt]: Epoch 26 / 100: avg data time: 5.20e-02, avg batch time: 0.4946, average train loss: 3.7322
[09/26 01:00:10 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1671, average loss: 1.5299
[09/26 01:00:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 77.28	
[09/26 01:00:10 visual_prompt]: Training 27 / 100 epoch, with learning rate 4.620120240391064
[09/26 01:00:17 visual_prompt]: Epoch 27 / 100: avg data time: 4.83e-02, avg batch time: 0.4913, average train loss: 6.0299
[09/26 01:00:18 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1674, average loss: 5.3163
[09/26 01:00:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 83.33	
[09/26 01:00:18 visual_prompt]: Training 28 / 100 epoch, with learning rate 4.572593931387604
[09/26 01:00:25 visual_prompt]: Epoch 28 / 100: avg data time: 4.97e-02, avg batch time: 0.4935, average train loss: 7.9303
[09/26 01:00:26 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1677, average loss: 2.9950
[09/26 01:00:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 58.79	
[09/26 01:00:26 visual_prompt]: Training 29 / 100 epoch, with learning rate 4.522542485937368
[09/26 01:00:33 visual_prompt]: Epoch 29 / 100: avg data time: 5.47e-02, avg batch time: 0.4984, average train loss: 10.5834
[09/26 01:00:34 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1675, average loss: 5.4673
[09/26 01:00:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 59.68	
[09/26 01:00:34 visual_prompt]: Training 30 / 100 epoch, with learning rate 4.4700268840168045
[09/26 01:00:41 visual_prompt]: Epoch 30 / 100: avg data time: 5.21e-02, avg batch time: 0.4963, average train loss: 5.9451
[09/26 01:00:42 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1675, average loss: 2.1214
[09/26 01:00:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 76.56	
[09/26 01:00:42 visual_prompt]: Training 31 / 100 epoch, with learning rate 4.415111107797445
[09/26 01:00:49 visual_prompt]: Epoch 31 / 100: avg data time: 4.17e-02, avg batch time: 0.4866, average train loss: 2.1660
[09/26 01:00:50 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1673, average loss: 6.8362
[09/26 01:00:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 78.80	
[09/26 01:00:51 visual_prompt]: Training 32 / 100 epoch, with learning rate 4.357862063693486
[09/26 01:00:57 visual_prompt]: Epoch 32 / 100: avg data time: 4.85e-02, avg batch time: 0.4957, average train loss: 4.6042
[09/26 01:00:59 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1672, average loss: 4.0623
[09/26 01:00:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 82.12	
[09/26 01:00:59 visual_prompt]: Training 33 / 100 epoch, with learning rate 4.298349500846628
[09/26 01:01:05 visual_prompt]: Epoch 33 / 100: avg data time: 5.96e-02, avg batch time: 0.5031, average train loss: 3.0093
[09/26 01:01:07 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1674, average loss: 1.8709
[09/26 01:01:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 78.83	
[09/26 01:01:07 visual_prompt]: Training 34 / 100 epoch, with learning rate 4.236645926147493
[09/26 01:01:14 visual_prompt]: Epoch 34 / 100: avg data time: 5.89e-02, avg batch time: 0.5019, average train loss: 2.4278
[09/26 01:01:15 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1673, average loss: 1.5107
[09/26 01:01:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 75.01	
[09/26 01:01:15 visual_prompt]: Training 35 / 100 epoch, with learning rate 4.172826515897146
[09/26 01:01:22 visual_prompt]: Epoch 35 / 100: avg data time: 5.01e-02, avg batch time: 0.4943, average train loss: 4.8661
[09/26 01:01:23 visual_prompt]: Inference (val):avg data time: 3.75e-05, avg batch time: 0.1673, average loss: 3.4967
[09/26 01:01:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 51.39	
[09/26 01:01:23 visual_prompt]: Training 36 / 100 epoch, with learning rate 4.106969024216348
[09/26 01:01:30 visual_prompt]: Epoch 36 / 100: avg data time: 5.18e-02, avg batch time: 0.4968, average train loss: 3.4743
[09/26 01:01:31 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1670, average loss: 1.3773
[09/26 01:01:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 66.81	
[09/26 01:01:31 visual_prompt]: Training 37 / 100 epoch, with learning rate 4.039153688314146
[09/26 01:01:38 visual_prompt]: Epoch 37 / 100: avg data time: 5.38e-02, avg batch time: 0.4966, average train loss: 1.1676
[09/26 01:01:40 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1675, average loss: 0.7868
[09/26 01:01:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.13	
[09/26 01:01:40 visual_prompt]: Training 38 / 100 epoch, with learning rate 3.969463130731183
[09/26 01:01:46 visual_prompt]: Epoch 38 / 100: avg data time: 4.78e-02, avg batch time: 0.4923, average train loss: 1.5516
[09/26 01:01:48 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1674, average loss: 3.1646
[09/26 01:01:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 47.56	
[09/26 01:01:48 visual_prompt]: Training 39 / 100 epoch, with learning rate 3.897982258676867
[09/26 01:01:54 visual_prompt]: Epoch 39 / 100: avg data time: 5.32e-02, avg batch time: 0.4957, average train loss: 1.4039
[09/26 01:01:56 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1673, average loss: 1.3260
[09/26 01:01:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 54.18	
[09/26 01:01:56 visual_prompt]: Training 40 / 100 epoch, with learning rate 3.824798160583012
[09/26 01:02:02 visual_prompt]: Epoch 40 / 100: avg data time: 4.83e-02, avg batch time: 0.4920, average train loss: 0.9212
[09/26 01:02:04 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1671, average loss: 1.4024
[09/26 01:02:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 68.18	
[09/26 01:02:04 visual_prompt]: Training 41 / 100 epoch, with learning rate 3.75
[09/26 01:02:11 visual_prompt]: Epoch 41 / 100: avg data time: 5.25e-02, avg batch time: 0.4959, average train loss: 1.1360
[09/26 01:02:12 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1670, average loss: 1.4678
[09/26 01:02:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 70.50	
[09/26 01:02:12 visual_prompt]: Training 42 / 100 epoch, with learning rate 3.673678906964727
[09/26 01:02:19 visual_prompt]: Epoch 42 / 100: avg data time: 5.26e-02, avg batch time: 0.4956, average train loss: 1.5618
[09/26 01:02:20 visual_prompt]: Inference (val):avg data time: 3.18e-05, avg batch time: 0.1666, average loss: 4.1441
[09/26 01:02:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 63.99	
[09/26 01:02:20 visual_prompt]: Training 43 / 100 epoch, with learning rate 3.5959278669726933
[09/26 01:02:27 visual_prompt]: Epoch 43 / 100: avg data time: 5.58e-02, avg batch time: 0.5001, average train loss: 3.3432
[09/26 01:02:28 visual_prompt]: Inference (val):avg data time: 3.64e-05, avg batch time: 0.1669, average loss: 3.8504
[09/26 01:02:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 77.55	
[09/26 01:02:28 visual_prompt]: Training 44 / 100 epoch, with learning rate 3.516841607689501
[09/26 01:02:35 visual_prompt]: Epoch 44 / 100: avg data time: 4.59e-02, avg batch time: 0.4923, average train loss: 2.3940
[09/26 01:02:37 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1674, average loss: 4.6564
[09/26 01:02:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.92	
[09/26 01:02:37 visual_prompt]: Training 45 / 100 epoch, with learning rate 3.4365164835397803
[09/26 01:02:43 visual_prompt]: Epoch 45 / 100: avg data time: 5.41e-02, avg batch time: 0.4977, average train loss: 3.1330
[09/26 01:02:45 visual_prompt]: Inference (val):avg data time: 3.21e-05, avg batch time: 0.1675, average loss: 3.3781
[09/26 01:02:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 78.84	
[09/26 01:02:45 visual_prompt]: Training 46 / 100 epoch, with learning rate 3.3550503583141724
[09/26 01:02:52 visual_prompt]: Epoch 46 / 100: avg data time: 5.65e-02, avg batch time: 0.5009, average train loss: 2.1305
[09/26 01:02:53 visual_prompt]: Inference (val):avg data time: 3.24e-05, avg batch time: 0.1676, average loss: 2.0279
[09/26 01:02:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 88.47	
[09/26 01:02:53 visual_prompt]: Training 47 / 100 epoch, with learning rate 3.2725424859373686
[09/26 01:03:00 visual_prompt]: Epoch 47 / 100: avg data time: 5.56e-02, avg batch time: 0.4992, average train loss: 1.8948
[09/26 01:03:01 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1677, average loss: 0.6410
[09/26 01:03:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 69.50	rocauc: 86.70	
[09/26 01:03:01 visual_prompt]: Best epoch 47: best metric: 0.695
[09/26 01:03:01 visual_prompt]: Training 48 / 100 epoch, with learning rate 3.1890933895424975
[09/26 01:03:08 visual_prompt]: Epoch 48 / 100: avg data time: 4.45e-02, avg batch time: 0.4916, average train loss: 1.4466
[09/26 01:03:09 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1676, average loss: 2.1667
[09/26 01:03:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 46.71	
[09/26 01:03:09 visual_prompt]: Training 49 / 100 epoch, with learning rate 3.104804738999169
[09/26 01:03:16 visual_prompt]: Epoch 49 / 100: avg data time: 4.01e-02, avg batch time: 0.4848, average train loss: 1.2492
[09/26 01:03:17 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1671, average loss: 1.4133
[09/26 01:03:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 62.58	
[09/26 01:03:17 visual_prompt]: Training 50 / 100 epoch, with learning rate 3.019779227044398
[09/26 01:03:24 visual_prompt]: Epoch 50 / 100: avg data time: 5.67e-02, avg batch time: 0.5015, average train loss: 0.9098
[09/26 01:03:25 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1675, average loss: 1.4235
[09/26 01:03:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 82.53	
[09/26 01:03:25 visual_prompt]: Training 51 / 100 epoch, with learning rate 2.934120444167326
[09/26 01:03:32 visual_prompt]: Epoch 51 / 100: avg data time: 5.74e-02, avg batch time: 0.5009, average train loss: 1.3874
[09/26 01:03:34 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1675, average loss: 1.7190
[09/26 01:03:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 42.18	
[09/26 01:03:34 visual_prompt]: Training 52 / 100 epoch, with learning rate 2.8479327524001636
[09/26 01:03:40 visual_prompt]: Epoch 52 / 100: avg data time: 5.16e-02, avg batch time: 0.4959, average train loss: 3.4341
[09/26 01:03:42 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1673, average loss: 1.1403
[09/26 01:03:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 71.85	
[09/26 01:03:42 visual_prompt]: Training 53 / 100 epoch, with learning rate 2.761321158169134
[09/26 01:03:48 visual_prompt]: Epoch 53 / 100: avg data time: 5.65e-02, avg batch time: 0.4992, average train loss: 3.0448
[09/26 01:03:50 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1674, average loss: 8.1637
[09/26 01:03:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 79.40	
[09/26 01:03:50 visual_prompt]: Training 54 / 100 epoch, with learning rate 2.6743911843603128
[09/26 01:03:57 visual_prompt]: Epoch 54 / 100: avg data time: 5.71e-02, avg batch time: 0.4999, average train loss: 9.0121
[09/26 01:03:58 visual_prompt]: Inference (val):avg data time: 3.62e-05, avg batch time: 0.1673, average loss: 15.9573
[09/26 01:03:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 20.91	
[09/26 01:03:58 visual_prompt]: Training 55 / 100 epoch, with learning rate 2.5872487417562526
[09/26 01:04:05 visual_prompt]: Epoch 55 / 100: avg data time: 3.85e-02, avg batch time: 0.4829, average train loss: 3.7259
[09/26 01:04:06 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1676, average loss: 1.7650
[09/26 01:04:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.62	
[09/26 01:04:06 visual_prompt]: Training 56 / 100 epoch, with learning rate 2.5
[09/26 01:04:13 visual_prompt]: Epoch 56 / 100: avg data time: 5.93e-02, avg batch time: 0.5037, average train loss: 1.5498
[09/26 01:04:14 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1673, average loss: 1.5768
[09/26 01:04:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.50	rocauc: 87.65	
[09/26 01:04:14 visual_prompt]: Training 57 / 100 epoch, with learning rate 2.4127512582437483
[09/26 01:04:21 visual_prompt]: Epoch 57 / 100: avg data time: 5.15e-02, avg batch time: 0.4968, average train loss: 1.0417
[09/26 01:04:23 visual_prompt]: Inference (val):avg data time: 3.10e-05, avg batch time: 0.1674, average loss: 1.3975
[09/26 01:04:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 54.50	rocauc: 89.40	
[09/26 01:04:23 visual_prompt]: Training 58 / 100 epoch, with learning rate 2.325608815639687
[09/26 01:04:29 visual_prompt]: Epoch 58 / 100: avg data time: 5.40e-02, avg batch time: 0.4989, average train loss: 0.8197
[09/26 01:04:31 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1678, average loss: 0.5142
[09/26 01:04:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 89.89	
[09/26 01:04:31 visual_prompt]: Best epoch 58: best metric: 0.800
[09/26 01:04:31 visual_prompt]: Training 59 / 100 epoch, with learning rate 2.2386788418308665
[09/26 01:04:38 visual_prompt]: Epoch 59 / 100: avg data time: 6.38e-02, avg batch time: 0.5084, average train loss: 0.7614
[09/26 01:04:39 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1676, average loss: 0.4497
[09/26 01:04:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 91.06	
[09/26 01:04:39 visual_prompt]: Training 60 / 100 epoch, with learning rate 2.1520672475998373
[09/26 01:04:46 visual_prompt]: Epoch 60 / 100: avg data time: 6.06e-02, avg batch time: 0.5050, average train loss: 1.1623
[09/26 01:04:47 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1674, average loss: 1.9665
[09/26 01:04:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 88.46	
[09/26 01:04:47 visual_prompt]: Training 61 / 100 epoch, with learning rate 2.0658795558326744
[09/26 01:04:54 visual_prompt]: Epoch 61 / 100: avg data time: 5.50e-02, avg batch time: 0.4990, average train loss: 2.0949
[09/26 01:04:55 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.1672, average loss: 0.8408
[09/26 01:04:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 90.17	
[09/26 01:04:55 visual_prompt]: Training 62 / 100 epoch, with learning rate 1.980220772955602
[09/26 01:05:02 visual_prompt]: Epoch 62 / 100: avg data time: 6.43e-02, avg batch time: 0.5086, average train loss: 1.9015
[09/26 01:05:04 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1675, average loss: 0.8854
[09/26 01:05:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 89.62	
[09/26 01:05:04 visual_prompt]: Training 63 / 100 epoch, with learning rate 1.895195261000831
[09/26 01:05:10 visual_prompt]: Epoch 63 / 100: avg data time: 5.64e-02, avg batch time: 0.5010, average train loss: 2.4183
[09/26 01:05:12 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1676, average loss: 4.3154
[09/26 01:05:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 90.44	
[09/26 01:05:12 visual_prompt]: Training 64 / 100 epoch, with learning rate 1.8109066104575022
[09/26 01:05:18 visual_prompt]: Epoch 64 / 100: avg data time: 4.63e-02, avg batch time: 0.4899, average train loss: 2.0304
[09/26 01:05:20 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1674, average loss: 0.6382
[09/26 01:05:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 88.15	
[09/26 01:05:20 visual_prompt]: Training 65 / 100 epoch, with learning rate 1.7274575140626316
[09/26 01:05:27 visual_prompt]: Epoch 65 / 100: avg data time: 5.75e-02, avg batch time: 0.5019, average train loss: 0.7458
[09/26 01:05:28 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1675, average loss: 0.5426
[09/26 01:05:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 69.50	rocauc: 89.76	
[09/26 01:05:28 visual_prompt]: Training 66 / 100 epoch, with learning rate 1.6449496416858285
[09/26 01:05:35 visual_prompt]: Epoch 66 / 100: avg data time: 4.49e-02, avg batch time: 0.4899, average train loss: 0.8083
[09/26 01:05:36 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.1675, average loss: 0.4873
[09/26 01:05:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.00	rocauc: 91.24	
[09/26 01:05:36 visual_prompt]: Training 67 / 100 epoch, with learning rate 1.5634835164602199
[09/26 01:05:43 visual_prompt]: Epoch 67 / 100: avg data time: 4.91e-02, avg batch time: 0.4938, average train loss: 1.0301
[09/26 01:05:44 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1671, average loss: 0.6001
[09/26 01:05:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 64.00	rocauc: 90.93	
[09/26 01:05:44 visual_prompt]: Training 68 / 100 epoch, with learning rate 1.4831583923104998
[09/26 01:05:51 visual_prompt]: Epoch 68 / 100: avg data time: 4.31e-02, avg batch time: 0.4885, average train loss: 0.6627
[09/26 01:05:52 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1672, average loss: 0.3982
[09/26 01:05:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.34	
[09/26 01:05:52 visual_prompt]: Best epoch 68: best metric: 0.860
[09/26 01:05:52 visual_prompt]: Training 69 / 100 epoch, with learning rate 1.4040721330273063
[09/26 01:05:59 visual_prompt]: Epoch 69 / 100: avg data time: 4.44e-02, avg batch time: 0.4898, average train loss: 0.6097
[09/26 01:06:00 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1674, average loss: 1.2198
[09/26 01:06:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 92.38	
[09/26 01:06:00 visual_prompt]: Training 70 / 100 epoch, with learning rate 1.3263210930352738
[09/26 01:06:07 visual_prompt]: Epoch 70 / 100: avg data time: 5.14e-02, avg batch time: 0.4953, average train loss: 0.7208
[09/26 01:06:08 visual_prompt]: Inference (val):avg data time: 2.11e-05, avg batch time: 0.1674, average loss: 0.4493
[09/26 01:06:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.12	
[09/26 01:06:08 visual_prompt]: Training 71 / 100 epoch, with learning rate 1.2500000000000004
[09/26 01:06:15 visual_prompt]: Epoch 71 / 100: avg data time: 5.10e-02, avg batch time: 0.4959, average train loss: 0.4809
[09/26 01:06:17 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1677, average loss: 0.3932
[09/26 01:06:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.27	
[09/26 01:06:17 visual_prompt]: Training 72 / 100 epoch, with learning rate 1.175201839416988
[09/26 01:06:24 visual_prompt]: Epoch 72 / 100: avg data time: 5.95e-02, avg batch time: 0.5031, average train loss: 0.7243
[09/26 01:06:25 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1673, average loss: 0.6264
[09/26 01:06:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 57.50	rocauc: 91.44	
[09/26 01:06:25 visual_prompt]: Training 73 / 100 epoch, with learning rate 1.1020177413231333
[09/26 01:06:32 visual_prompt]: Epoch 73 / 100: avg data time: 4.81e-02, avg batch time: 0.4936, average train loss: 0.5742
[09/26 01:06:33 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1672, average loss: 0.3955
[09/26 01:06:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.15	
[09/26 01:06:33 visual_prompt]: Training 74 / 100 epoch, with learning rate 1.0305368692688175
[09/26 01:06:40 visual_prompt]: Epoch 74 / 100: avg data time: 5.23e-02, avg batch time: 0.4968, average train loss: 0.4711
[09/26 01:06:41 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1675, average loss: 0.3706
[09/26 01:06:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.41	
[09/26 01:06:41 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.9608463116858543
[09/26 01:06:48 visual_prompt]: Epoch 75 / 100: avg data time: 4.04e-02, avg batch time: 0.4854, average train loss: 0.5442
[09/26 01:06:49 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1674, average loss: 0.3689
[09/26 01:06:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.40	
[09/26 01:06:49 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.8930309757836516
[09/26 01:06:56 visual_prompt]: Epoch 76 / 100: avg data time: 5.50e-02, avg batch time: 0.4998, average train loss: 0.5674
[09/26 01:06:58 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1671, average loss: 0.3487
[09/26 01:06:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.58	
[09/26 01:06:58 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.8271734841028553
[09/26 01:07:04 visual_prompt]: Epoch 77 / 100: avg data time: 5.61e-02, avg batch time: 0.5002, average train loss: 0.4066
[09/26 01:07:06 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1673, average loss: 0.4153
[09/26 01:07:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 93.64	
[09/26 01:07:06 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.7633540738525066
[09/26 01:07:12 visual_prompt]: Epoch 78 / 100: avg data time: 3.97e-02, avg batch time: 0.4859, average train loss: 0.4256
[09/26 01:07:14 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1673, average loss: 0.3318
[09/26 01:07:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.07	
[09/26 01:07:14 visual_prompt]: Best epoch 78: best metric: 0.870
[09/26 01:07:14 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.7016504991533725
[09/26 01:07:21 visual_prompt]: Epoch 79 / 100: avg data time: 4.78e-02, avg batch time: 0.4922, average train loss: 0.4550
[09/26 01:07:22 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1677, average loss: 0.3381
[09/26 01:07:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.36	
[09/26 01:07:22 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.6421379363065141
[09/26 01:07:29 visual_prompt]: Epoch 80 / 100: avg data time: 3.97e-02, avg batch time: 0.4857, average train loss: 0.5661
[09/26 01:07:30 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1677, average loss: 0.6391
[09/26 01:07:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 62.00	rocauc: 93.94	
[09/26 01:07:30 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.5848888922025552
[09/26 01:07:37 visual_prompt]: Epoch 81 / 100: avg data time: 4.61e-02, avg batch time: 0.4903, average train loss: 0.4728
[09/26 01:07:38 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1676, average loss: 0.5293
[09/26 01:07:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 93.98	
[09/26 01:07:38 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.5299731159831953
[09/26 01:07:45 visual_prompt]: Epoch 82 / 100: avg data time: 4.99e-02, avg batch time: 0.4942, average train loss: 0.3704
[09/26 01:07:46 visual_prompt]: Inference (val):avg data time: 3.15e-05, avg batch time: 0.1673, average loss: 0.3230
[09/26 01:07:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 94.11	
[09/26 01:07:46 visual_prompt]: Best epoch 82: best metric: 0.875
[09/26 01:07:46 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.47745751406263165
[09/26 01:07:53 visual_prompt]: Epoch 83 / 100: avg data time: 4.33e-02, avg batch time: 0.4900, average train loss: 0.3690
[09/26 01:07:54 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1676, average loss: 0.3768
[09/26 01:07:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.87	
[09/26 01:07:54 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.42740606861239594
[09/26 01:08:01 visual_prompt]: Epoch 84 / 100: avg data time: 6.40e-02, avg batch time: 0.5078, average train loss: 0.3075
[09/26 01:08:02 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1675, average loss: 0.2996
[09/26 01:08:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 95.32	
[09/26 01:08:02 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.3798797596089351
[09/26 01:08:09 visual_prompt]: Epoch 85 / 100: avg data time: 5.58e-02, avg batch time: 0.4993, average train loss: 0.3130
[09/26 01:08:11 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1678, average loss: 0.3990
[09/26 01:08:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 93.44	
[09/26 01:08:11 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.33493649053890323
[09/26 01:08:17 visual_prompt]: Epoch 86 / 100: avg data time: 4.41e-02, avg batch time: 0.4887, average train loss: 0.3634
[09/26 01:08:19 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1677, average loss: 0.3882
[09/26 01:08:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 95.28	
[09/26 01:08:19 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.29263101785268253
[09/26 01:08:25 visual_prompt]: Epoch 87 / 100: avg data time: 5.45e-02, avg batch time: 0.4984, average train loss: 0.3366
[09/26 01:08:27 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1675, average loss: 0.3314
[09/26 01:08:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 95.78	
[09/26 01:08:27 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.25301488425208296
[09/26 01:08:33 visual_prompt]: Epoch 88 / 100: avg data time: 5.20e-02, avg batch time: 0.4966, average train loss: 0.2799
[09/26 01:08:35 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1673, average loss: 0.2869
[09/26 01:08:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 95.33	
[09/26 01:08:35 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.21613635589349756
[09/26 01:08:41 visual_prompt]: Epoch 89 / 100: avg data time: 4.13e-02, avg batch time: 0.4871, average train loss: 0.1916
[09/26 01:08:43 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1674, average loss: 0.3848
[09/26 01:08:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 95.15	
[09/26 01:08:43 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.18204036358303172
[09/26 01:08:50 visual_prompt]: Epoch 90 / 100: avg data time: 5.23e-02, avg batch time: 0.4968, average train loss: 0.1814
[09/26 01:08:51 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1675, average loss: 0.3881
[09/26 01:08:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.34	
[09/26 01:08:51 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.1507684480352292
[09/26 01:08:58 visual_prompt]: Epoch 91 / 100: avg data time: 5.30e-02, avg batch time: 0.4972, average train loss: 0.2121
[09/26 01:08:59 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1673, average loss: 0.3162
[09/26 01:08:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 94.78	
[09/26 01:08:59 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.12235870926211617
[09/26 01:09:06 visual_prompt]: Epoch 92 / 100: avg data time: 4.57e-02, avg batch time: 0.4905, average train loss: 0.1589
[09/26 01:09:07 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1675, average loss: 0.3650
[09/26 01:09:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 95.73	
[09/26 01:09:07 visual_prompt]: Best epoch 92: best metric: 0.880
[09/26 01:09:07 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.09684576015420276
[09/26 01:09:14 visual_prompt]: Epoch 93 / 100: avg data time: 5.88e-02, avg batch time: 0.5041, average train loss: 0.1516
[09/26 01:09:16 visual_prompt]: Inference (val):avg data time: 3.13e-05, avg batch time: 0.1674, average loss: 0.5821
[09/26 01:09:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 94.92	
[09/26 01:09:16 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.07426068431000882
[09/26 01:09:22 visual_prompt]: Epoch 94 / 100: avg data time: 3.76e-02, avg batch time: 0.4825, average train loss: 0.1888
[09/26 01:09:24 visual_prompt]: Inference (val):avg data time: 3.03e-05, avg batch time: 0.1676, average loss: 0.3631
[09/26 01:09:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 94.59	
[09/26 01:09:24 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.05463099816548578
[09/26 01:09:30 visual_prompt]: Epoch 95 / 100: avg data time: 4.40e-02, avg batch time: 0.4906, average train loss: 0.0963
[09/26 01:09:32 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1674, average loss: 0.3715
[09/26 01:09:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 95.13	
[09/26 01:09:32 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.03798061746947995
[09/26 01:09:39 visual_prompt]: Epoch 96 / 100: avg data time: 6.98e-02, avg batch time: 0.5132, average train loss: 0.0741
[09/26 01:09:40 visual_prompt]: Inference (val):avg data time: 3.12e-05, avg batch time: 0.1673, average loss: 0.4508
[09/26 01:09:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 95.37	
[09/26 01:09:40 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.024329828146074095
[09/26 01:09:47 visual_prompt]: Epoch 97 / 100: avg data time: 5.81e-02, avg batch time: 0.5030, average train loss: 0.0475
[09/26 01:09:48 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1676, average loss: 0.4563
[09/26 01:09:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.87	
[09/26 01:09:48 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.013695261579316775
[09/26 01:09:55 visual_prompt]: Epoch 98 / 100: avg data time: 4.67e-02, avg batch time: 0.4920, average train loss: 0.0374
[09/26 01:09:56 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1674, average loss: 0.4818
[09/26 01:09:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 95.01	
[09/26 01:09:56 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.006089874350439506
[09/26 01:10:03 visual_prompt]: Epoch 99 / 100: avg data time: 5.37e-02, avg batch time: 0.4979, average train loss: 0.0318
[09/26 01:10:05 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1674, average loss: 0.4977
[09/26 01:10:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 95.07	
[09/26 01:10:05 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0015229324522605947
[09/26 01:10:11 visual_prompt]: Epoch 100 / 100: avg data time: 4.43e-02, avg batch time: 0.4888, average train loss: 0.0299
[09/26 01:10:13 visual_prompt]: Inference (val):avg data time: 3.46e-05, avg batch time: 0.1673, average loss: 0.5000
[09/26 01:10:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 95.06	
[09/26 01:10:13 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 01:10:13 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 01:10:13 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 01:10:13 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 01:10:13 visual_prompt]: Training with config:
[09/26 01:10:13 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr5.0_wd0.0001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 5.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 01:10:13 visual_prompt]: Loading training data...
[09/26 01:10:13 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 01:10:14 visual_prompt]: Number of images: 800
[09/26 01:10:14 visual_prompt]: Number of classes: 2 / 2
[09/26 01:10:14 visual_prompt]: Loading validation data...
[09/26 01:10:14 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 01:10:14 visual_prompt]: Number of images: 200
[09/26 01:10:14 visual_prompt]: Number of classes: 2 / 2
[09/26 01:10:14 visual_prompt]: Constructing models...
[09/26 01:10:17 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 01:10:17 visual_prompt]: tuned percent:0.536
[09/26 01:10:17 visual_prompt]: Device used for model: 0
[09/26 01:10:17 visual_prompt]: Setting up Evaluator...
[09/26 01:10:17 visual_prompt]: Setting up Trainer...
[09/26 01:10:17 visual_prompt]: 	Setting up the optimizer...
[09/26 01:10:17 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 01:10:23 visual_prompt]: Epoch 1 / 100: avg data time: 5.62e-02, avg batch time: 0.4989, average train loss: 1.9654
[09/26 01:10:25 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1671, average loss: 2.0033
[09/26 01:10:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 01:10:25 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 01:10:25 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.5
[09/26 01:10:32 visual_prompt]: Epoch 2 / 100: avg data time: 5.14e-02, avg batch time: 0.4948, average train loss: 9.7214
[09/26 01:10:33 visual_prompt]: Inference (val):avg data time: 2.79e-05, avg batch time: 0.1671, average loss: 1.3182
[09/26 01:10:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 65.53	
[09/26 01:10:33 visual_prompt]: Training 3 / 100 epoch, with learning rate 1.0
[09/26 01:10:40 visual_prompt]: Epoch 3 / 100: avg data time: 5.21e-02, avg batch time: 0.4956, average train loss: 3.5641
[09/26 01:10:41 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1669, average loss: 0.6174
[09/26 01:10:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.50	rocauc: 81.48	
[09/26 01:10:41 visual_prompt]: Best epoch 3: best metric: 0.735
[09/26 01:10:41 visual_prompt]: Training 4 / 100 epoch, with learning rate 1.5
[09/26 01:10:48 visual_prompt]: Epoch 4 / 100: avg data time: 5.61e-02, avg batch time: 0.4999, average train loss: 3.4122
[09/26 01:10:49 visual_prompt]: Inference (val):avg data time: 3.51e-05, avg batch time: 0.1670, average loss: 4.4113
[09/26 01:10:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.76	
[09/26 01:10:49 visual_prompt]: Training 5 / 100 epoch, with learning rate 2.0
[09/26 01:10:56 visual_prompt]: Epoch 5 / 100: avg data time: 5.46e-02, avg batch time: 0.4976, average train loss: 2.4557
[09/26 01:10:57 visual_prompt]: Inference (val):avg data time: 2.70e-05, avg batch time: 0.1671, average loss: 1.5623
[09/26 01:10:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 87.24	
[09/26 01:10:57 visual_prompt]: Training 6 / 100 epoch, with learning rate 2.5
[09/26 01:11:04 visual_prompt]: Epoch 6 / 100: avg data time: 3.89e-02, avg batch time: 0.4823, average train loss: 4.0375
[09/26 01:11:05 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1671, average loss: 2.8337
[09/26 01:11:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 87.89	
[09/26 01:11:05 visual_prompt]: Training 7 / 100 epoch, with learning rate 3.0
[09/26 01:11:12 visual_prompt]: Epoch 7 / 100: avg data time: 5.92e-02, avg batch time: 0.5031, average train loss: 4.9087
[09/26 01:11:14 visual_prompt]: Inference (val):avg data time: 3.93e-05, avg batch time: 0.1678, average loss: 5.4454
[09/26 01:11:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.16	
[09/26 01:11:14 visual_prompt]: Training 8 / 100 epoch, with learning rate 3.5
[09/26 01:11:21 visual_prompt]: Epoch 8 / 100: avg data time: 5.78e-02, avg batch time: 0.5026, average train loss: 3.3100
[09/26 01:11:22 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1673, average loss: 5.2610
[09/26 01:11:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 87.97	
[09/26 01:11:22 visual_prompt]: Training 9 / 100 epoch, with learning rate 4.0
[09/26 01:11:29 visual_prompt]: Epoch 9 / 100: avg data time: 5.03e-02, avg batch time: 0.4948, average train loss: 3.3233
[09/26 01:11:31 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1673, average loss: 0.9051
[09/26 01:11:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.50	rocauc: 88.83	
[09/26 01:11:31 visual_prompt]: Training 10 / 100 epoch, with learning rate 4.5
[09/26 01:11:37 visual_prompt]: Epoch 10 / 100: avg data time: 5.50e-02, avg batch time: 0.4988, average train loss: 3.0414
[09/26 01:11:39 visual_prompt]: Inference (val):avg data time: 2.98e-05, avg batch time: 0.1667, average loss: 1.9249
[09/26 01:11:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 62.00	rocauc: 85.64	
[09/26 01:11:39 visual_prompt]: Training 11 / 100 epoch, with learning rate 5.0
[09/26 01:11:46 visual_prompt]: Epoch 11 / 100: avg data time: 5.60e-02, avg batch time: 0.4996, average train loss: 3.3947
[09/26 01:11:47 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1673, average loss: 1.1503
[09/26 01:11:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 69.00	rocauc: 89.97	
[09/26 01:11:47 visual_prompt]: Training 12 / 100 epoch, with learning rate 4.998477067547739
[09/26 01:11:54 visual_prompt]: Epoch 12 / 100: avg data time: 5.20e-02, avg batch time: 0.4978, average train loss: 2.1491
[09/26 01:11:55 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1674, average loss: 1.6295
[09/26 01:11:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.50	rocauc: 91.15	
[09/26 01:11:55 visual_prompt]: Training 13 / 100 epoch, with learning rate 4.993910125649561
[09/26 01:12:02 visual_prompt]: Epoch 13 / 100: avg data time: 5.95e-02, avg batch time: 0.5021, average train loss: 1.4857
[09/26 01:12:04 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1674, average loss: 0.4226
[09/26 01:12:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 90.99	
[09/26 01:12:04 visual_prompt]: Best epoch 13: best metric: 0.820
[09/26 01:12:04 visual_prompt]: Training 14 / 100 epoch, with learning rate 4.986304738420683
[09/26 01:12:10 visual_prompt]: Epoch 14 / 100: avg data time: 3.97e-02, avg batch time: 0.4846, average train loss: 1.7191
[09/26 01:12:12 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1671, average loss: 2.3990
[09/26 01:12:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 57.50	rocauc: 91.59	
[09/26 01:12:12 visual_prompt]: Training 15 / 100 epoch, with learning rate 4.975670171853926
[09/26 01:12:18 visual_prompt]: Epoch 15 / 100: avg data time: 5.13e-02, avg batch time: 0.4949, average train loss: 2.4381
[09/26 01:12:20 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1673, average loss: 1.6966
[09/26 01:12:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.50	rocauc: 88.20	
[09/26 01:12:20 visual_prompt]: Training 16 / 100 epoch, with learning rate 4.962019382530521
[09/26 01:12:26 visual_prompt]: Epoch 16 / 100: avg data time: 4.46e-02, avg batch time: 0.4887, average train loss: 1.9025
[09/26 01:12:28 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1673, average loss: 4.8909
[09/26 01:12:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 91.06	
[09/26 01:12:28 visual_prompt]: Training 17 / 100 epoch, with learning rate 4.945369001834514
[09/26 01:12:35 visual_prompt]: Epoch 17 / 100: avg data time: 4.93e-02, avg batch time: 0.4941, average train loss: 2.2337
[09/26 01:12:36 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1675, average loss: 3.2222
[09/26 01:12:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 90.37	
[09/26 01:12:36 visual_prompt]: Training 18 / 100 epoch, with learning rate 4.925739315689991
[09/26 01:12:43 visual_prompt]: Epoch 18 / 100: avg data time: 4.97e-02, avg batch time: 0.4930, average train loss: 2.8157
[09/26 01:12:44 visual_prompt]: Inference (val):avg data time: 4.43e-05, avg batch time: 0.1673, average loss: 2.1947
[09/26 01:12:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.50	rocauc: 92.33	
[09/26 01:12:44 visual_prompt]: Training 19 / 100 epoch, with learning rate 4.903154239845797
[09/26 01:12:51 visual_prompt]: Epoch 19 / 100: avg data time: 5.86e-02, avg batch time: 0.5018, average train loss: 2.8384
[09/26 01:12:52 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1673, average loss: 0.5246
[09/26 01:12:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.69	
[09/26 01:12:52 visual_prompt]: Best epoch 19: best metric: 0.840
[09/26 01:12:52 visual_prompt]: Training 20 / 100 epoch, with learning rate 4.877641290737884
[09/26 01:12:59 visual_prompt]: Epoch 20 / 100: avg data time: 6.58e-02, avg batch time: 0.5089, average train loss: 1.1165
[09/26 01:13:01 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1676, average loss: 0.7681
[09/26 01:13:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.50	rocauc: 93.46	
[09/26 01:13:01 visual_prompt]: Training 21 / 100 epoch, with learning rate 4.849231551964771
[09/26 01:13:07 visual_prompt]: Epoch 21 / 100: avg data time: 4.12e-02, avg batch time: 0.4863, average train loss: 0.8470
[09/26 01:13:09 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1674, average loss: 1.1594
[09/26 01:13:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.00	rocauc: 93.20	
[09/26 01:13:09 visual_prompt]: Training 22 / 100 epoch, with learning rate 4.817959636416969
[09/26 01:13:15 visual_prompt]: Epoch 22 / 100: avg data time: 5.84e-02, avg batch time: 0.5029, average train loss: 0.8674
[09/26 01:13:17 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1674, average loss: 0.5860
[09/26 01:13:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 93.07	
[09/26 01:13:17 visual_prompt]: Training 23 / 100 epoch, with learning rate 4.783863644106502
[09/26 01:13:24 visual_prompt]: Epoch 23 / 100: avg data time: 4.41e-02, avg batch time: 0.4895, average train loss: 0.6904
[09/26 01:13:25 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1675, average loss: 0.6319
[09/26 01:13:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 92.06	
[09/26 01:13:25 visual_prompt]: Training 24 / 100 epoch, with learning rate 4.7469851157479175
[09/26 01:13:31 visual_prompt]: Epoch 24 / 100: avg data time: 3.99e-02, avg batch time: 0.4862, average train loss: 1.0004
[09/26 01:13:33 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1673, average loss: 0.5036
[09/26 01:13:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.36	
[09/26 01:13:33 visual_prompt]: Training 25 / 100 epoch, with learning rate 4.707368982147317
[09/26 01:13:40 visual_prompt]: Epoch 25 / 100: avg data time: 4.40e-02, avg batch time: 0.4889, average train loss: 2.5077
[09/26 01:13:41 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1676, average loss: 5.7753
[09/26 01:13:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 93.80	
[09/26 01:13:41 visual_prompt]: Training 26 / 100 epoch, with learning rate 4.665063509461097
[09/26 01:13:48 visual_prompt]: Epoch 26 / 100: avg data time: 4.80e-02, avg batch time: 0.4924, average train loss: 3.7299
[09/26 01:13:49 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1673, average loss: 3.1039
[09/26 01:13:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 89.00	
[09/26 01:13:49 visual_prompt]: Training 27 / 100 epoch, with learning rate 4.620120240391064
[09/26 01:13:56 visual_prompt]: Epoch 27 / 100: avg data time: 5.32e-02, avg batch time: 0.4979, average train loss: 4.8138
[09/26 01:13:57 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1671, average loss: 2.2599
[09/26 01:13:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 89.89	
[09/26 01:13:57 visual_prompt]: Training 28 / 100 epoch, with learning rate 4.572593931387604
[09/26 01:14:04 visual_prompt]: Epoch 28 / 100: avg data time: 4.85e-02, avg batch time: 0.4926, average train loss: 4.1833
[09/26 01:14:05 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1677, average loss: 0.8311
[09/26 01:14:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.85	
[09/26 01:14:05 visual_prompt]: Training 29 / 100 epoch, with learning rate 4.522542485937368
[09/26 01:14:12 visual_prompt]: Epoch 29 / 100: avg data time: 4.32e-02, avg batch time: 0.4885, average train loss: 1.3530
[09/26 01:14:13 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1673, average loss: 0.4840
[09/26 01:14:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 90.54	
[09/26 01:14:13 visual_prompt]: Training 30 / 100 epoch, with learning rate 4.4700268840168045
[09/26 01:14:20 visual_prompt]: Epoch 30 / 100: avg data time: 4.97e-02, avg batch time: 0.4940, average train loss: 1.2726
[09/26 01:14:21 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1675, average loss: 1.4077
[09/26 01:14:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.00	rocauc: 91.43	
[09/26 01:14:21 visual_prompt]: Training 31 / 100 epoch, with learning rate 4.415111107797445
[09/26 01:14:28 visual_prompt]: Epoch 31 / 100: avg data time: 4.12e-02, avg batch time: 0.4873, average train loss: 0.8358
[09/26 01:14:29 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1674, average loss: 0.4669
[09/26 01:14:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 92.73	
[09/26 01:14:29 visual_prompt]: Training 32 / 100 epoch, with learning rate 4.357862063693486
[09/26 01:14:36 visual_prompt]: Epoch 32 / 100: avg data time: 4.69e-02, avg batch time: 0.4918, average train loss: 0.9993
[09/26 01:14:37 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1678, average loss: 0.5235
[09/26 01:14:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.43	
[09/26 01:14:37 visual_prompt]: Training 33 / 100 epoch, with learning rate 4.298349500846628
[09/26 01:14:44 visual_prompt]: Epoch 33 / 100: avg data time: 4.57e-02, avg batch time: 0.4916, average train loss: 0.6832
[09/26 01:14:46 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1676, average loss: 0.7325
[09/26 01:14:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.00	rocauc: 91.47	
[09/26 01:14:46 visual_prompt]: Training 34 / 100 epoch, with learning rate 4.236645926147493
[09/26 01:14:52 visual_prompt]: Epoch 34 / 100: avg data time: 4.99e-02, avg batch time: 0.4948, average train loss: 0.8245
[09/26 01:14:54 visual_prompt]: Inference (val):avg data time: 3.41e-05, avg batch time: 0.1669, average loss: 2.0354
[09/26 01:14:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 92.37	
[09/26 01:14:54 visual_prompt]: Training 35 / 100 epoch, with learning rate 4.172826515897146
[09/26 01:15:01 visual_prompt]: Epoch 35 / 100: avg data time: 5.21e-02, avg batch time: 0.4960, average train loss: 1.0292
[09/26 01:15:02 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1675, average loss: 0.4787
[09/26 01:15:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.00	rocauc: 90.27	
[09/26 01:15:02 visual_prompt]: Training 36 / 100 epoch, with learning rate 4.106969024216348
[09/26 01:15:09 visual_prompt]: Epoch 36 / 100: avg data time: 5.76e-02, avg batch time: 0.5014, average train loss: 0.5873
[09/26 01:15:10 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1673, average loss: 0.5604
[09/26 01:15:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 92.33	
[09/26 01:15:10 visual_prompt]: Training 37 / 100 epoch, with learning rate 4.039153688314146
[09/26 01:15:17 visual_prompt]: Epoch 37 / 100: avg data time: 4.88e-02, avg batch time: 0.4932, average train loss: 0.5367
[09/26 01:15:18 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1675, average loss: 0.5823
[09/26 01:15:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.00	rocauc: 91.07	
[09/26 01:15:18 visual_prompt]: Training 38 / 100 epoch, with learning rate 3.969463130731183
[09/26 01:15:25 visual_prompt]: Epoch 38 / 100: avg data time: 4.76e-02, avg batch time: 0.4929, average train loss: 0.6205
[09/26 01:15:26 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1673, average loss: 0.4811
[09/26 01:15:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 89.78	
[09/26 01:15:26 visual_prompt]: Training 39 / 100 epoch, with learning rate 3.897982258676867
[09/26 01:15:33 visual_prompt]: Epoch 39 / 100: avg data time: 4.13e-02, avg batch time: 0.4850, average train loss: 0.7234
[09/26 01:15:34 visual_prompt]: Inference (val):avg data time: 3.25e-05, avg batch time: 0.1671, average loss: 0.4531
[09/26 01:15:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 93.31	
[09/26 01:15:34 visual_prompt]: Training 40 / 100 epoch, with learning rate 3.824798160583012
[09/26 01:15:41 visual_prompt]: Epoch 40 / 100: avg data time: 4.27e-02, avg batch time: 0.4872, average train loss: 0.9158
[09/26 01:15:42 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1676, average loss: 1.6671
[09/26 01:15:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 57.50	rocauc: 92.54	
[09/26 01:15:42 visual_prompt]: Training 41 / 100 epoch, with learning rate 3.75
[09/26 01:15:49 visual_prompt]: Epoch 41 / 100: avg data time: 6.28e-02, avg batch time: 0.5066, average train loss: 1.2362
[09/26 01:15:51 visual_prompt]: Inference (val):avg data time: 3.74e-05, avg batch time: 0.1679, average loss: 0.5136
[09/26 01:15:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.62	
[09/26 01:15:51 visual_prompt]: Best epoch 41: best metric: 0.845
[09/26 01:15:51 visual_prompt]: Training 42 / 100 epoch, with learning rate 3.673678906964727
[09/26 01:15:57 visual_prompt]: Epoch 42 / 100: avg data time: 5.06e-02, avg batch time: 0.4947, average train loss: 0.8216
[09/26 01:15:59 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1677, average loss: 0.5339
[09/26 01:15:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 94.04	
[09/26 01:15:59 visual_prompt]: Training 43 / 100 epoch, with learning rate 3.5959278669726933
[09/26 01:16:05 visual_prompt]: Epoch 43 / 100: avg data time: 3.71e-02, avg batch time: 0.4828, average train loss: 0.5300
[09/26 01:16:07 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1677, average loss: 0.3799
[09/26 01:16:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.43	
[09/26 01:16:07 visual_prompt]: Training 44 / 100 epoch, with learning rate 3.516841607689501
[09/26 01:16:14 visual_prompt]: Epoch 44 / 100: avg data time: 6.06e-02, avg batch time: 0.5049, average train loss: 0.3643
[09/26 01:16:15 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1673, average loss: 0.3735
[09/26 01:16:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.64	
[09/26 01:16:15 visual_prompt]: Training 45 / 100 epoch, with learning rate 3.4365164835397803
[09/26 01:16:22 visual_prompt]: Epoch 45 / 100: avg data time: 5.09e-02, avg batch time: 0.4947, average train loss: 0.4799
[09/26 01:16:23 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1674, average loss: 0.5165
[09/26 01:16:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.47	
[09/26 01:16:23 visual_prompt]: Training 46 / 100 epoch, with learning rate 3.3550503583141724
[09/26 01:16:30 visual_prompt]: Epoch 46 / 100: avg data time: 5.02e-02, avg batch time: 0.4946, average train loss: 0.6992
[09/26 01:16:31 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1673, average loss: 0.8753
[09/26 01:16:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 68.00	rocauc: 92.96	
[09/26 01:16:31 visual_prompt]: Training 47 / 100 epoch, with learning rate 3.2725424859373686
[09/26 01:16:38 visual_prompt]: Epoch 47 / 100: avg data time: 4.69e-02, avg batch time: 0.4911, average train loss: 0.6640
[09/26 01:16:40 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1676, average loss: 0.4376
[09/26 01:16:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.83	
[09/26 01:16:40 visual_prompt]: Best epoch 47: best metric: 0.850
[09/26 01:16:40 visual_prompt]: Training 48 / 100 epoch, with learning rate 3.1890933895424975
[09/26 01:16:46 visual_prompt]: Epoch 48 / 100: avg data time: 4.59e-02, avg batch time: 0.4907, average train loss: 0.4582
[09/26 01:16:48 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1673, average loss: 0.7559
[09/26 01:16:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.50	rocauc: 91.97	
[09/26 01:16:48 visual_prompt]: Training 49 / 100 epoch, with learning rate 3.104804738999169
[09/26 01:16:54 visual_prompt]: Epoch 49 / 100: avg data time: 5.12e-02, avg batch time: 0.4958, average train loss: 0.3250
[09/26 01:16:56 visual_prompt]: Inference (val):avg data time: 2.73e-05, avg batch time: 0.1674, average loss: 0.5407
[09/26 01:16:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 92.21	
[09/26 01:16:56 visual_prompt]: Training 50 / 100 epoch, with learning rate 3.019779227044398
[09/26 01:17:02 visual_prompt]: Epoch 50 / 100: avg data time: 4.34e-02, avg batch time: 0.4885, average train loss: 0.4344
[09/26 01:17:04 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1673, average loss: 0.5562
[09/26 01:17:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 92.72	
[09/26 01:17:04 visual_prompt]: Training 51 / 100 epoch, with learning rate 2.934120444167326
[09/26 01:17:10 visual_prompt]: Epoch 51 / 100: avg data time: 4.72e-02, avg batch time: 0.4924, average train loss: 0.3217
[09/26 01:17:12 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1673, average loss: 0.3704
[09/26 01:17:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.68	
[09/26 01:17:12 visual_prompt]: Training 52 / 100 epoch, with learning rate 2.8479327524001636
[09/26 01:17:18 visual_prompt]: Epoch 52 / 100: avg data time: 4.70e-02, avg batch time: 0.4935, average train loss: 0.2953
[09/26 01:17:20 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1672, average loss: 0.6736
[09/26 01:17:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 92.94	
[09/26 01:17:20 visual_prompt]: Training 53 / 100 epoch, with learning rate 2.761321158169134
[09/26 01:17:27 visual_prompt]: Epoch 53 / 100: avg data time: 4.26e-02, avg batch time: 0.4880, average train loss: 0.3064
[09/26 01:17:28 visual_prompt]: Inference (val):avg data time: 3.13e-05, avg batch time: 0.1674, average loss: 0.4553
[09/26 01:17:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 91.84	
[09/26 01:17:28 visual_prompt]: Training 54 / 100 epoch, with learning rate 2.6743911843603128
[09/26 01:17:35 visual_prompt]: Epoch 54 / 100: avg data time: 4.99e-02, avg batch time: 0.4939, average train loss: 0.2552
[09/26 01:17:36 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1676, average loss: 0.3579
[09/26 01:17:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.76	
[09/26 01:17:36 visual_prompt]: Training 55 / 100 epoch, with learning rate 2.5872487417562526
[09/26 01:17:43 visual_prompt]: Epoch 55 / 100: avg data time: 5.48e-02, avg batch time: 0.4997, average train loss: 0.2083
[09/26 01:17:44 visual_prompt]: Inference (val):avg data time: 3.07e-05, avg batch time: 0.1670, average loss: 0.5251
[09/26 01:17:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.11	
[09/26 01:17:44 visual_prompt]: Training 56 / 100 epoch, with learning rate 2.5
[09/26 01:17:51 visual_prompt]: Epoch 56 / 100: avg data time: 4.51e-02, avg batch time: 0.4897, average train loss: 0.4590
[09/26 01:17:52 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1679, average loss: 0.5242
[09/26 01:17:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 93.58	
[09/26 01:17:52 visual_prompt]: Training 57 / 100 epoch, with learning rate 2.4127512582437483
[09/26 01:17:59 visual_prompt]: Epoch 57 / 100: avg data time: 5.55e-02, avg batch time: 0.5003, average train loss: 0.4234
[09/26 01:18:01 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1679, average loss: 0.4509
[09/26 01:18:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 90.46	
[09/26 01:18:01 visual_prompt]: Training 58 / 100 epoch, with learning rate 2.325608815639687
[09/26 01:18:07 visual_prompt]: Epoch 58 / 100: avg data time: 4.76e-02, avg batch time: 0.4930, average train loss: 0.3388
[09/26 01:18:09 visual_prompt]: Inference (val):avg data time: 2.95e-05, avg batch time: 0.1676, average loss: 0.4145
[09/26 01:18:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 91.47	
[09/26 01:18:09 visual_prompt]: Training 59 / 100 epoch, with learning rate 2.2386788418308665
[09/26 01:18:16 visual_prompt]: Epoch 59 / 100: avg data time: 6.00e-02, avg batch time: 0.5042, average train loss: 0.2285
[09/26 01:18:17 visual_prompt]: Inference (val):avg data time: 3.69e-05, avg batch time: 0.1676, average loss: 0.4574
[09/26 01:18:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.40	
[09/26 01:18:17 visual_prompt]: Training 60 / 100 epoch, with learning rate 2.1520672475998373
[09/26 01:18:24 visual_prompt]: Epoch 60 / 100: avg data time: 4.34e-02, avg batch time: 0.4887, average train loss: 0.1860
[09/26 01:18:25 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1673, average loss: 0.5627
[09/26 01:18:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.00	rocauc: 88.64	
[09/26 01:18:25 visual_prompt]: Training 61 / 100 epoch, with learning rate 2.0658795558326744
[09/26 01:18:32 visual_prompt]: Epoch 61 / 100: avg data time: 5.49e-02, avg batch time: 0.4987, average train loss: 0.2290
[09/26 01:18:33 visual_prompt]: Inference (val):avg data time: 3.67e-05, avg batch time: 0.1672, average loss: 1.1461
[09/26 01:18:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.00	rocauc: 92.01	
[09/26 01:18:33 visual_prompt]: Training 62 / 100 epoch, with learning rate 1.980220772955602
[09/26 01:18:40 visual_prompt]: Epoch 62 / 100: avg data time: 5.10e-02, avg batch time: 0.4947, average train loss: 0.3455
[09/26 01:18:42 visual_prompt]: Inference (val):avg data time: 4.38e-05, avg batch time: 0.1674, average loss: 0.4868
[09/26 01:18:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.56	
[09/26 01:18:42 visual_prompt]: Training 63 / 100 epoch, with learning rate 1.895195261000831
[09/26 01:18:48 visual_prompt]: Epoch 63 / 100: avg data time: 5.57e-02, avg batch time: 0.4995, average train loss: 0.2244
[09/26 01:18:50 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1673, average loss: 0.5416
[09/26 01:18:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.50	rocauc: 90.14	
[09/26 01:18:50 visual_prompt]: Training 64 / 100 epoch, with learning rate 1.8109066104575022
[09/26 01:18:57 visual_prompt]: Epoch 64 / 100: avg data time: 5.13e-02, avg batch time: 0.4952, average train loss: 0.2905
[09/26 01:18:58 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1675, average loss: 0.8654
[09/26 01:18:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.00	rocauc: 92.00	
[09/26 01:18:58 visual_prompt]: Training 65 / 100 epoch, with learning rate 1.7274575140626316
[09/26 01:19:05 visual_prompt]: Epoch 65 / 100: avg data time: 5.88e-02, avg batch time: 0.5022, average train loss: 0.2855
[09/26 01:19:06 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1674, average loss: 0.4691
[09/26 01:19:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 92.19	
[09/26 01:19:06 visual_prompt]: Training 66 / 100 epoch, with learning rate 1.6449496416858285
[09/26 01:19:13 visual_prompt]: Epoch 66 / 100: avg data time: 4.27e-02, avg batch time: 0.4876, average train loss: 0.1994
[09/26 01:19:14 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1675, average loss: 0.6562
[09/26 01:19:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.50	rocauc: 91.76	
[09/26 01:19:14 visual_prompt]: Training 67 / 100 epoch, with learning rate 1.5634835164602199
[09/26 01:19:21 visual_prompt]: Epoch 67 / 100: avg data time: 6.33e-02, avg batch time: 0.5067, average train loss: 0.2863
[09/26 01:19:23 visual_prompt]: Inference (val):avg data time: 3.01e-05, avg batch time: 0.1675, average loss: 0.3799
[09/26 01:19:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 92.14	
[09/26 01:19:23 visual_prompt]: Training 68 / 100 epoch, with learning rate 1.4831583923104998
[09/26 01:19:29 visual_prompt]: Epoch 68 / 100: avg data time: 5.30e-02, avg batch time: 0.4973, average train loss: 0.1805
[09/26 01:19:31 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1671, average loss: 0.4100
[09/26 01:19:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.40	
[09/26 01:19:31 visual_prompt]: Training 69 / 100 epoch, with learning rate 1.4040721330273063
[09/26 01:19:38 visual_prompt]: Epoch 69 / 100: avg data time: 5.35e-02, avg batch time: 0.4988, average train loss: 0.0925
[09/26 01:19:39 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1673, average loss: 0.9410
[09/26 01:19:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 91.15	
[09/26 01:19:39 visual_prompt]: Training 70 / 100 epoch, with learning rate 1.3263210930352738
[09/26 01:19:46 visual_prompt]: Epoch 70 / 100: avg data time: 6.76e-02, avg batch time: 0.5109, average train loss: 0.2057
[09/26 01:19:48 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1676, average loss: 0.4567
[09/26 01:19:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.23	
[09/26 01:19:48 visual_prompt]: Training 71 / 100 epoch, with learning rate 1.2500000000000004
[09/26 01:19:54 visual_prompt]: Epoch 71 / 100: avg data time: 4.63e-02, avg batch time: 0.4913, average train loss: 0.0885
[09/26 01:19:56 visual_prompt]: Inference (val):avg data time: 3.66e-05, avg batch time: 0.1671, average loss: 0.5767
[09/26 01:19:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 91.32	
[09/26 01:19:56 visual_prompt]: Training 72 / 100 epoch, with learning rate 1.175201839416988
[09/26 01:20:02 visual_prompt]: Epoch 72 / 100: avg data time: 5.49e-02, avg batch time: 0.4988, average train loss: 0.0541
[09/26 01:20:04 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1674, average loss: 0.6519
[09/26 01:20:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.94	
[09/26 01:20:04 visual_prompt]: Training 73 / 100 epoch, with learning rate 1.1020177413231333
[09/26 01:20:11 visual_prompt]: Epoch 73 / 100: avg data time: 6.21e-02, avg batch time: 0.5067, average train loss: 0.0269
[09/26 01:20:12 visual_prompt]: Inference (val):avg data time: 3.37e-05, avg batch time: 0.1673, average loss: 0.8366
[09/26 01:20:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 91.92	
[09/26 01:20:12 visual_prompt]: Training 74 / 100 epoch, with learning rate 1.0305368692688175
[09/26 01:20:19 visual_prompt]: Epoch 74 / 100: avg data time: 4.54e-02, avg batch time: 0.4908, average train loss: 0.0389
[09/26 01:20:20 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1675, average loss: 0.8822
[09/26 01:20:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.39	
[09/26 01:20:20 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.9608463116858543
[09/26 01:20:27 visual_prompt]: Epoch 75 / 100: avg data time: 4.65e-02, avg batch time: 0.4901, average train loss: 0.0790
[09/26 01:20:28 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1676, average loss: 0.6509
[09/26 01:20:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.58	
[09/26 01:20:28 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.8930309757836516
[09/26 01:20:35 visual_prompt]: Epoch 76 / 100: avg data time: 6.20e-02, avg batch time: 0.5056, average train loss: 0.1204
[09/26 01:20:37 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1673, average loss: 0.5612
[09/26 01:20:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.48	
[09/26 01:20:37 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.8271734841028553
[09/26 01:20:43 visual_prompt]: Epoch 77 / 100: avg data time: 6.10e-02, avg batch time: 0.5045, average train loss: 0.0693
[09/26 01:20:45 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1677, average loss: 0.5527
[09/26 01:20:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.67	
[09/26 01:20:45 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.7633540738525066
[09/26 01:20:52 visual_prompt]: Epoch 78 / 100: avg data time: 7.05e-02, avg batch time: 0.5142, average train loss: 0.0593
[09/26 01:20:53 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1673, average loss: 1.0141
[09/26 01:20:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 91.81	
[09/26 01:20:53 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.7016504991533725
[09/26 01:21:00 visual_prompt]: Epoch 79 / 100: avg data time: 6.28e-02, avg batch time: 0.5065, average train loss: 0.0328
[09/26 01:21:01 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1675, average loss: 0.8821
[09/26 01:21:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 93.27	
[09/26 01:21:01 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.6421379363065141
[09/26 01:21:08 visual_prompt]: Epoch 80 / 100: avg data time: 5.13e-02, avg batch time: 0.4961, average train loss: 0.0257
[09/26 01:21:09 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1675, average loss: 0.8596
[09/26 01:21:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.85	
[09/26 01:21:09 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.5848888922025552
[09/26 01:21:16 visual_prompt]: Epoch 81 / 100: avg data time: 4.62e-02, avg batch time: 0.4906, average train loss: 0.0313
[09/26 01:21:18 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1671, average loss: 0.8376
[09/26 01:21:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.04	
[09/26 01:21:18 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.5299731159831953
[09/26 01:21:24 visual_prompt]: Epoch 82 / 100: avg data time: 5.10e-02, avg batch time: 0.4965, average train loss: 0.0587
[09/26 01:21:26 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1675, average loss: 0.7789
[09/26 01:21:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.15	
[09/26 01:21:26 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.47745751406263165
[09/26 01:21:32 visual_prompt]: Epoch 83 / 100: avg data time: 5.17e-02, avg batch time: 0.4963, average train loss: 0.0293
[09/26 01:21:34 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1676, average loss: 0.8524
[09/26 01:21:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 91.22	
[09/26 01:21:34 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.42740606861239594
[09/26 01:21:40 visual_prompt]: Epoch 84 / 100: avg data time: 4.50e-02, avg batch time: 0.4915, average train loss: 0.0337
[09/26 01:21:42 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1678, average loss: 0.7854
[09/26 01:21:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.71	
[09/26 01:21:42 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.3798797596089351
[09/26 01:21:48 visual_prompt]: Epoch 85 / 100: avg data time: 4.82e-02, avg batch time: 0.4932, average train loss: 0.0091
[09/26 01:21:50 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1674, average loss: 0.9482
[09/26 01:21:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 92.09	
[09/26 01:21:50 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.33493649053890323
[09/26 01:21:57 visual_prompt]: Epoch 86 / 100: avg data time: 4.19e-02, avg batch time: 0.4877, average train loss: 0.0085
[09/26 01:21:58 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.1675, average loss: 0.9039
[09/26 01:21:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.25	
[09/26 01:21:58 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.29263101785268253
[09/26 01:22:05 visual_prompt]: Epoch 87 / 100: avg data time: 5.19e-02, avg batch time: 0.4968, average train loss: 0.0057
[09/26 01:22:06 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1674, average loss: 1.0624
[09/26 01:22:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 91.60	
[09/26 01:22:06 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.25301488425208296
[09/26 01:22:13 visual_prompt]: Epoch 88 / 100: avg data time: 4.13e-02, avg batch time: 0.4863, average train loss: 0.0054
[09/26 01:22:14 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1676, average loss: 0.9625
[09/26 01:22:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 91.88	
[09/26 01:22:14 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.21613635589349756
[09/26 01:22:21 visual_prompt]: Epoch 89 / 100: avg data time: 5.00e-02, avg batch time: 0.4946, average train loss: 0.0013
[09/26 01:22:22 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1676, average loss: 0.9030
[09/26 01:22:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.06	
[09/26 01:22:22 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.18204036358303172
[09/26 01:22:29 visual_prompt]: Epoch 90 / 100: avg data time: 4.89e-02, avg batch time: 0.4929, average train loss: 0.0014
[09/26 01:22:30 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1681, average loss: 0.9371
[09/26 01:22:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.30	
[09/26 01:22:30 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.1507684480352292
[09/26 01:22:37 visual_prompt]: Epoch 91 / 100: avg data time: 4.73e-02, avg batch time: 0.4923, average train loss: 0.0012
[09/26 01:22:38 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1674, average loss: 0.9553
[09/26 01:22:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 92.37	
[09/26 01:22:38 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.12235870926211617
[09/26 01:22:45 visual_prompt]: Epoch 92 / 100: avg data time: 4.09e-02, avg batch time: 0.4862, average train loss: 0.0014
[09/26 01:22:47 visual_prompt]: Inference (val):avg data time: 3.08e-05, avg batch time: 0.1677, average loss: 0.9526
[09/26 01:22:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.23	
[09/26 01:22:47 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.09684576015420276
[09/26 01:22:53 visual_prompt]: Epoch 93 / 100: avg data time: 4.12e-02, avg batch time: 0.4883, average train loss: 0.0008
[09/26 01:22:55 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1675, average loss: 0.9514
[09/26 01:22:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.13	
[09/26 01:22:55 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.07426068431000882
[09/26 01:23:01 visual_prompt]: Epoch 94 / 100: avg data time: 4.28e-02, avg batch time: 0.4888, average train loss: 0.0006
[09/26 01:23:03 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1675, average loss: 0.9569
[09/26 01:23:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 92.10	
[09/26 01:23:03 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.05463099816548578
[09/26 01:23:10 visual_prompt]: Epoch 95 / 100: avg data time: 5.18e-02, avg batch time: 0.4966, average train loss: 0.0007
[09/26 01:23:11 visual_prompt]: Inference (val):avg data time: 3.69e-05, avg batch time: 0.1674, average loss: 0.9612
[09/26 01:23:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 92.11	
[09/26 01:23:11 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.03798061746947995
[09/26 01:23:18 visual_prompt]: Epoch 96 / 100: avg data time: 4.71e-02, avg batch time: 0.4911, average train loss: 0.0006
[09/26 01:23:19 visual_prompt]: Inference (val):avg data time: 3.50e-05, avg batch time: 0.1676, average loss: 0.9651
[09/26 01:23:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 92.11	
[09/26 01:23:19 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.024329828146074095
[09/26 01:23:26 visual_prompt]: Epoch 97 / 100: avg data time: 5.61e-02, avg batch time: 0.5005, average train loss: 0.0008
[09/26 01:23:28 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1674, average loss: 0.9690
[09/26 01:23:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.12	
[09/26 01:23:28 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.013695261579316775
[09/26 01:23:34 visual_prompt]: Epoch 98 / 100: avg data time: 5.80e-02, avg batch time: 0.5024, average train loss: 0.0008
[09/26 01:23:36 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1675, average loss: 0.9707
[09/26 01:23:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.12	
[09/26 01:23:36 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.006089874350439506
[09/26 01:23:43 visual_prompt]: Epoch 99 / 100: avg data time: 5.47e-02, avg batch time: 0.4992, average train loss: 0.0008
[09/26 01:23:44 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1676, average loss: 0.9716
[09/26 01:23:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.12	
[09/26 01:23:44 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0015229324522605947
[09/26 01:23:51 visual_prompt]: Epoch 100 / 100: avg data time: 4.88e-02, avg batch time: 0.5135, average train loss: 0.0006
[09/26 01:23:52 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1676, average loss: 0.9717
[09/26 01:23:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.12	
[09/26 01:23:52 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 01:23:52 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 01:23:52 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 01:23:52 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 01:23:52 visual_prompt]: Training with config:
[09/26 01:23:52 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr5.0_wd0.0/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 5.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 01:23:52 visual_prompt]: Loading training data...
[09/26 01:23:52 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 01:23:54 visual_prompt]: Number of images: 800
[09/26 01:23:54 visual_prompt]: Number of classes: 2 / 2
[09/26 01:23:54 visual_prompt]: Loading validation data...
[09/26 01:23:54 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 01:23:54 visual_prompt]: Number of images: 200
[09/26 01:23:54 visual_prompt]: Number of classes: 2 / 2
[09/26 01:23:54 visual_prompt]: Constructing models...
[09/26 01:23:56 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 01:23:56 visual_prompt]: tuned percent:0.536
[09/26 01:23:56 visual_prompt]: Device used for model: 0
[09/26 01:23:56 visual_prompt]: Setting up Evaluator...
[09/26 01:23:56 visual_prompt]: Setting up Trainer...
[09/26 01:23:56 visual_prompt]: 	Setting up the optimizer...
[09/26 01:23:56 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 01:24:03 visual_prompt]: Epoch 1 / 100: avg data time: 5.01e-02, avg batch time: 0.4934, average train loss: 1.9788
[09/26 01:24:05 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1668, average loss: 2.0033
[09/26 01:24:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 01:24:05 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 01:24:05 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.5
[09/26 01:24:11 visual_prompt]: Epoch 2 / 100: avg data time: 4.84e-02, avg batch time: 0.4908, average train loss: 9.9107
[09/26 01:24:13 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1670, average loss: 3.0695
[09/26 01:24:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 74.99	
[09/26 01:24:13 visual_prompt]: Training 3 / 100 epoch, with learning rate 1.0
[09/26 01:24:19 visual_prompt]: Epoch 3 / 100: avg data time: 4.37e-02, avg batch time: 0.4881, average train loss: 3.9328
[09/26 01:24:21 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1669, average loss: 3.1838
[09/26 01:24:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.58	
[09/26 01:24:21 visual_prompt]: Training 4 / 100 epoch, with learning rate 1.5
[09/26 01:24:27 visual_prompt]: Epoch 4 / 100: avg data time: 4.98e-02, avg batch time: 0.4930, average train loss: 1.4822
[09/26 01:24:29 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1671, average loss: 0.7832
[09/26 01:24:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 88.06	
[09/26 01:24:29 visual_prompt]: Training 5 / 100 epoch, with learning rate 2.0
[09/26 01:24:35 visual_prompt]: Epoch 5 / 100: avg data time: 4.34e-02, avg batch time: 0.4880, average train loss: 1.0405
[09/26 01:24:37 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1669, average loss: 0.7072
[09/26 01:24:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 89.26	
[09/26 01:24:37 visual_prompt]: Training 6 / 100 epoch, with learning rate 2.5
[09/26 01:24:44 visual_prompt]: Epoch 6 / 100: avg data time: 4.44e-02, avg batch time: 0.4881, average train loss: 4.6188
[09/26 01:24:45 visual_prompt]: Inference (val):avg data time: 4.08e-05, avg batch time: 0.1676, average loss: 9.3501
[09/26 01:24:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.61	
[09/26 01:24:45 visual_prompt]: Training 7 / 100 epoch, with learning rate 3.0
[09/26 01:24:52 visual_prompt]: Epoch 7 / 100: avg data time: 5.31e-02, avg batch time: 0.4966, average train loss: 5.3021
[09/26 01:24:53 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1671, average loss: 6.0603
[09/26 01:24:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 87.80	
[09/26 01:24:53 visual_prompt]: Training 8 / 100 epoch, with learning rate 3.5
[09/26 01:25:00 visual_prompt]: Epoch 8 / 100: avg data time: 5.43e-02, avg batch time: 0.4973, average train loss: 5.3701
[09/26 01:25:02 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1669, average loss: 1.6147
[09/26 01:25:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.16	
[09/26 01:25:02 visual_prompt]: Training 9 / 100 epoch, with learning rate 4.0
[09/26 01:25:08 visual_prompt]: Epoch 9 / 100: avg data time: 5.01e-02, avg batch time: 0.4935, average train loss: 6.2012
[09/26 01:25:10 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1668, average loss: 17.7159
[09/26 01:25:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 86.90	
[09/26 01:25:10 visual_prompt]: Training 10 / 100 epoch, with learning rate 4.5
[09/26 01:25:17 visual_prompt]: Epoch 10 / 100: avg data time: 4.77e-02, avg batch time: 0.4911, average train loss: 13.3704
[09/26 01:25:18 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1671, average loss: 15.6219
[09/26 01:25:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 87.17	
[09/26 01:25:18 visual_prompt]: Training 11 / 100 epoch, with learning rate 5.0
[09/26 01:25:25 visual_prompt]: Epoch 11 / 100: avg data time: 5.96e-02, avg batch time: 0.5036, average train loss: 10.7676
[09/26 01:25:27 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1675, average loss: 11.8949
[09/26 01:25:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 87.88	
[09/26 01:25:27 visual_prompt]: Training 12 / 100 epoch, with learning rate 4.998477067547739
[09/26 01:25:33 visual_prompt]: Epoch 12 / 100: avg data time: 5.79e-02, avg batch time: 0.5036, average train loss: 12.8949
[09/26 01:25:35 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1671, average loss: 12.8671
[09/26 01:25:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 88.39	
[09/26 01:25:35 visual_prompt]: Training 13 / 100 epoch, with learning rate 4.993910125649561
[09/26 01:25:42 visual_prompt]: Epoch 13 / 100: avg data time: 5.59e-02, avg batch time: 0.5007, average train loss: 5.1827
[09/26 01:25:43 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1671, average loss: 0.5532
[09/26 01:25:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 88.58	
[09/26 01:25:43 visual_prompt]: Best epoch 13: best metric: 0.795
[09/26 01:25:43 visual_prompt]: Training 14 / 100 epoch, with learning rate 4.986304738420683
[09/26 01:25:50 visual_prompt]: Epoch 14 / 100: avg data time: 5.99e-02, avg batch time: 0.5037, average train loss: 2.0846
[09/26 01:25:52 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1673, average loss: 1.3024
[09/26 01:25:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.00	rocauc: 88.60	
[09/26 01:25:52 visual_prompt]: Training 15 / 100 epoch, with learning rate 4.975670171853926
[09/26 01:25:59 visual_prompt]: Epoch 15 / 100: avg data time: 6.15e-02, avg batch time: 0.5040, average train loss: 2.3319
[09/26 01:26:00 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1671, average loss: 0.8106
[09/26 01:26:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.50	rocauc: 88.43	
[09/26 01:26:00 visual_prompt]: Training 16 / 100 epoch, with learning rate 4.962019382530521
[09/26 01:26:07 visual_prompt]: Epoch 16 / 100: avg data time: 6.00e-02, avg batch time: 0.5034, average train loss: 1.3855
[09/26 01:26:09 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1669, average loss: 0.5630
[09/26 01:26:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 90.94	
[09/26 01:26:09 visual_prompt]: Training 17 / 100 epoch, with learning rate 4.945369001834514
[09/26 01:26:15 visual_prompt]: Epoch 17 / 100: avg data time: 5.82e-02, avg batch time: 0.5009, average train loss: 1.6866
[09/26 01:26:17 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1673, average loss: 0.8625
[09/26 01:26:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 91.87	
[09/26 01:26:17 visual_prompt]: Training 18 / 100 epoch, with learning rate 4.925739315689991
[09/26 01:26:24 visual_prompt]: Epoch 18 / 100: avg data time: 5.48e-02, avg batch time: 0.4978, average train loss: 0.9470
[09/26 01:26:25 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1673, average loss: 0.4109
[09/26 01:26:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.99	
[09/26 01:26:25 visual_prompt]: Best epoch 18: best metric: 0.820
[09/26 01:26:25 visual_prompt]: Training 19 / 100 epoch, with learning rate 4.903154239845797
[09/26 01:26:32 visual_prompt]: Epoch 19 / 100: avg data time: 5.57e-02, avg batch time: 0.4982, average train loss: 0.8146
[09/26 01:26:34 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1671, average loss: 0.4317
[09/26 01:26:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.54	
[09/26 01:26:34 visual_prompt]: Training 20 / 100 epoch, with learning rate 4.877641290737884
[09/26 01:26:40 visual_prompt]: Epoch 20 / 100: avg data time: 5.78e-02, avg batch time: 0.5017, average train loss: 0.7654
[09/26 01:26:42 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1670, average loss: 2.0622
[09/26 01:26:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.50	rocauc: 91.95	
[09/26 01:26:42 visual_prompt]: Training 21 / 100 epoch, with learning rate 4.849231551964771
[09/26 01:26:49 visual_prompt]: Epoch 21 / 100: avg data time: 4.08e-02, avg batch time: 0.4856, average train loss: 1.1544
[09/26 01:26:50 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1671, average loss: 0.5354
[09/26 01:26:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 93.36	
[09/26 01:26:50 visual_prompt]: Best epoch 21: best metric: 0.825
[09/26 01:26:50 visual_prompt]: Training 22 / 100 epoch, with learning rate 4.817959636416969
[09/26 01:26:57 visual_prompt]: Epoch 22 / 100: avg data time: 5.77e-02, avg batch time: 0.5008, average train loss: 0.9129
[09/26 01:26:58 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1672, average loss: 0.9395
[09/26 01:26:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.00	rocauc: 90.88	
[09/26 01:26:58 visual_prompt]: Training 23 / 100 epoch, with learning rate 4.783863644106502
[09/26 01:27:05 visual_prompt]: Epoch 23 / 100: avg data time: 5.98e-02, avg batch time: 0.5038, average train loss: 1.6702
[09/26 01:27:06 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1670, average loss: 0.7642
[09/26 01:27:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 91.43	
[09/26 01:27:06 visual_prompt]: Training 24 / 100 epoch, with learning rate 4.7469851157479175
[09/26 01:27:13 visual_prompt]: Epoch 24 / 100: avg data time: 5.31e-02, avg batch time: 0.4962, average train loss: 0.9167
[09/26 01:27:15 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1671, average loss: 0.7527
[09/26 01:27:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 94.13	
[09/26 01:27:15 visual_prompt]: Training 25 / 100 epoch, with learning rate 4.707368982147317
[09/26 01:27:22 visual_prompt]: Epoch 25 / 100: avg data time: 6.10e-02, avg batch time: 0.5055, average train loss: 0.7187
[09/26 01:27:23 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1672, average loss: 0.7836
[09/26 01:27:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.50	rocauc: 91.89	
[09/26 01:27:23 visual_prompt]: Training 26 / 100 epoch, with learning rate 4.665063509461097
[09/26 01:27:30 visual_prompt]: Epoch 26 / 100: avg data time: 6.22e-02, avg batch time: 0.5057, average train loss: 0.7839
[09/26 01:27:31 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1670, average loss: 0.3924
[09/26 01:27:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.78	
[09/26 01:27:31 visual_prompt]: Training 27 / 100 epoch, with learning rate 4.620120240391064
[09/26 01:27:38 visual_prompt]: Epoch 27 / 100: avg data time: 4.58e-02, avg batch time: 0.4913, average train loss: 0.4620
[09/26 01:27:39 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1671, average loss: 0.4723
[09/26 01:27:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 91.38	
[09/26 01:27:39 visual_prompt]: Training 28 / 100 epoch, with learning rate 4.572593931387604
[09/26 01:27:46 visual_prompt]: Epoch 28 / 100: avg data time: 4.66e-02, avg batch time: 0.4912, average train loss: 1.4820
[09/26 01:27:48 visual_prompt]: Inference (val):avg data time: 2.99e-05, avg batch time: 0.1674, average loss: 0.7620
[09/26 01:27:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 93.60	
[09/26 01:27:48 visual_prompt]: Training 29 / 100 epoch, with learning rate 4.522542485937368
[09/26 01:27:54 visual_prompt]: Epoch 29 / 100: avg data time: 4.76e-02, avg batch time: 0.4940, average train loss: 2.0157
[09/26 01:27:56 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1674, average loss: 1.2250
[09/26 01:27:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 91.70	
[09/26 01:27:56 visual_prompt]: Training 30 / 100 epoch, with learning rate 4.4700268840168045
[09/26 01:28:02 visual_prompt]: Epoch 30 / 100: avg data time: 5.36e-02, avg batch time: 0.4970, average train loss: 1.3787
[09/26 01:28:04 visual_prompt]: Inference (val):avg data time: 3.34e-05, avg batch time: 0.1673, average loss: 0.8760
[09/26 01:28:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 92.75	
[09/26 01:28:04 visual_prompt]: Training 31 / 100 epoch, with learning rate 4.415111107797445
[09/26 01:28:10 visual_prompt]: Epoch 31 / 100: avg data time: 4.29e-02, avg batch time: 0.4888, average train loss: 0.7609
[09/26 01:28:12 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1675, average loss: 0.4659
[09/26 01:28:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.18	
[09/26 01:28:12 visual_prompt]: Training 32 / 100 epoch, with learning rate 4.357862063693486
[09/26 01:28:19 visual_prompt]: Epoch 32 / 100: avg data time: 4.40e-02, avg batch time: 0.4884, average train loss: 0.6207
[09/26 01:28:20 visual_prompt]: Inference (val):avg data time: 3.10e-05, avg batch time: 0.1667, average loss: 0.4365
[09/26 01:28:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.03	
[09/26 01:28:20 visual_prompt]: Best epoch 32: best metric: 0.830
[09/26 01:28:20 visual_prompt]: Training 33 / 100 epoch, with learning rate 4.298349500846628
[09/26 01:28:27 visual_prompt]: Epoch 33 / 100: avg data time: 4.43e-02, avg batch time: 0.4886, average train loss: 1.0014
[09/26 01:28:28 visual_prompt]: Inference (val):avg data time: 3.10e-05, avg batch time: 0.1675, average loss: 0.5347
[09/26 01:28:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 93.03	
[09/26 01:28:28 visual_prompt]: Training 34 / 100 epoch, with learning rate 4.236645926147493
[09/26 01:28:35 visual_prompt]: Epoch 34 / 100: avg data time: 4.55e-02, avg batch time: 0.4895, average train loss: 0.7982
[09/26 01:28:37 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1673, average loss: 0.5220
[09/26 01:28:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.57	
[09/26 01:28:37 visual_prompt]: Training 35 / 100 epoch, with learning rate 4.172826515897146
[09/26 01:28:43 visual_prompt]: Epoch 35 / 100: avg data time: 4.91e-02, avg batch time: 0.4926, average train loss: 0.4556
[09/26 01:28:45 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1673, average loss: 0.6270
[09/26 01:28:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 90.68	
[09/26 01:28:45 visual_prompt]: Training 36 / 100 epoch, with learning rate 4.106969024216348
[09/26 01:28:51 visual_prompt]: Epoch 36 / 100: avg data time: 5.81e-02, avg batch time: 0.5015, average train loss: 0.4150
[09/26 01:28:53 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1673, average loss: 0.8395
[09/26 01:28:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.00	rocauc: 89.51	
[09/26 01:28:53 visual_prompt]: Training 37 / 100 epoch, with learning rate 4.039153688314146
[09/26 01:29:00 visual_prompt]: Epoch 37 / 100: avg data time: 6.29e-02, avg batch time: 0.5062, average train loss: 0.3492
[09/26 01:29:01 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1672, average loss: 0.4882
[09/26 01:29:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 90.72	
[09/26 01:29:01 visual_prompt]: Training 38 / 100 epoch, with learning rate 3.969463130731183
[09/26 01:29:08 visual_prompt]: Epoch 38 / 100: avg data time: 5.42e-02, avg batch time: 0.4980, average train loss: 0.3626
[09/26 01:29:10 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1673, average loss: 0.5129
[09/26 01:29:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 89.27	
[09/26 01:29:10 visual_prompt]: Training 39 / 100 epoch, with learning rate 3.897982258676867
[09/26 01:29:16 visual_prompt]: Epoch 39 / 100: avg data time: 5.16e-02, avg batch time: 0.4963, average train loss: 0.3349
[09/26 01:29:18 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1674, average loss: 0.4841
[09/26 01:29:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 90.99	
[09/26 01:29:18 visual_prompt]: Training 40 / 100 epoch, with learning rate 3.824798160583012
[09/26 01:29:24 visual_prompt]: Epoch 40 / 100: avg data time: 5.04e-02, avg batch time: 0.4936, average train loss: 0.3259
[09/26 01:29:26 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1671, average loss: 0.6703
[09/26 01:29:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 90.52	
[09/26 01:29:26 visual_prompt]: Training 41 / 100 epoch, with learning rate 3.75
[09/26 01:29:32 visual_prompt]: Epoch 41 / 100: avg data time: 4.39e-02, avg batch time: 0.4891, average train loss: 0.3424
[09/26 01:29:34 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1674, average loss: 1.2890
[09/26 01:29:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 71.00	rocauc: 91.90	
[09/26 01:29:34 visual_prompt]: Training 42 / 100 epoch, with learning rate 3.673678906964727
[09/26 01:29:41 visual_prompt]: Epoch 42 / 100: avg data time: 5.75e-02, avg batch time: 0.5011, average train loss: 0.5633
[09/26 01:29:42 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.1674, average loss: 0.4661
[09/26 01:29:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.82	
[09/26 01:29:42 visual_prompt]: Training 43 / 100 epoch, with learning rate 3.5959278669726933
[09/26 01:29:49 visual_prompt]: Epoch 43 / 100: avg data time: 5.64e-02, avg batch time: 0.5004, average train loss: 0.3169
[09/26 01:29:50 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1673, average loss: 0.5433
[09/26 01:29:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.21	
[09/26 01:29:50 visual_prompt]: Training 44 / 100 epoch, with learning rate 3.516841607689501
[09/26 01:29:57 visual_prompt]: Epoch 44 / 100: avg data time: 4.99e-02, avg batch time: 0.4942, average train loss: 0.6456
[09/26 01:29:58 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1672, average loss: 0.5989
[09/26 01:29:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.98	
[09/26 01:29:58 visual_prompt]: Best epoch 44: best metric: 0.835
[09/26 01:29:58 visual_prompt]: Training 45 / 100 epoch, with learning rate 3.4365164835397803
[09/26 01:30:05 visual_prompt]: Epoch 45 / 100: avg data time: 4.80e-02, avg batch time: 0.4935, average train loss: 0.5027
[09/26 01:30:06 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1673, average loss: 0.8148
[09/26 01:30:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 92.88	
[09/26 01:30:06 visual_prompt]: Training 46 / 100 epoch, with learning rate 3.3550503583141724
[09/26 01:30:13 visual_prompt]: Epoch 46 / 100: avg data time: 4.69e-02, avg batch time: 0.4911, average train loss: 0.2967
[09/26 01:30:14 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1672, average loss: 0.5123
[09/26 01:30:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 90.64	
[09/26 01:30:14 visual_prompt]: Training 47 / 100 epoch, with learning rate 3.2725424859373686
[09/26 01:30:21 visual_prompt]: Epoch 47 / 100: avg data time: 4.81e-02, avg batch time: 0.4929, average train loss: 0.3273
[09/26 01:30:23 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1671, average loss: 0.6714
[09/26 01:30:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 92.03	
[09/26 01:30:23 visual_prompt]: Training 48 / 100 epoch, with learning rate 3.1890933895424975
[09/26 01:30:29 visual_prompt]: Epoch 48 / 100: avg data time: 4.40e-02, avg batch time: 0.4891, average train loss: 0.2360
[09/26 01:30:31 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1673, average loss: 0.5531
[09/26 01:30:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 90.34	
[09/26 01:30:31 visual_prompt]: Training 49 / 100 epoch, with learning rate 3.104804738999169
[09/26 01:30:37 visual_prompt]: Epoch 49 / 100: avg data time: 5.88e-02, avg batch time: 0.5028, average train loss: 0.2506
[09/26 01:30:39 visual_prompt]: Inference (val):avg data time: 2.11e-05, avg batch time: 0.1673, average loss: 0.5764
[09/26 01:30:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 91.79	
[09/26 01:30:39 visual_prompt]: Best epoch 49: best metric: 0.845
[09/26 01:30:39 visual_prompt]: Training 50 / 100 epoch, with learning rate 3.019779227044398
[09/26 01:30:45 visual_prompt]: Epoch 50 / 100: avg data time: 4.37e-02, avg batch time: 0.4885, average train loss: 0.2896
[09/26 01:30:47 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1672, average loss: 0.5733
[09/26 01:30:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.94	
[09/26 01:30:47 visual_prompt]: Training 51 / 100 epoch, with learning rate 2.934120444167326
[09/26 01:30:54 visual_prompt]: Epoch 51 / 100: avg data time: 4.23e-02, avg batch time: 0.4870, average train loss: 0.1886
[09/26 01:30:55 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1674, average loss: 0.6764
[09/26 01:30:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.26	
[09/26 01:30:55 visual_prompt]: Training 52 / 100 epoch, with learning rate 2.8479327524001636
[09/26 01:31:02 visual_prompt]: Epoch 52 / 100: avg data time: 4.65e-02, avg batch time: 0.4910, average train loss: 0.1765
[09/26 01:31:03 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1675, average loss: 0.5877
[09/26 01:31:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.58	
[09/26 01:31:03 visual_prompt]: Training 53 / 100 epoch, with learning rate 2.761321158169134
[09/26 01:31:10 visual_prompt]: Epoch 53 / 100: avg data time: 4.23e-02, avg batch time: 0.4862, average train loss: 0.1508
[09/26 01:31:11 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1674, average loss: 0.6390
[09/26 01:31:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 89.88	
[09/26 01:31:11 visual_prompt]: Training 54 / 100 epoch, with learning rate 2.6743911843603128
[09/26 01:31:18 visual_prompt]: Epoch 54 / 100: avg data time: 4.74e-02, avg batch time: 0.4922, average train loss: 0.1816
[09/26 01:31:20 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1675, average loss: 0.7017
[09/26 01:31:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.74	
[09/26 01:31:20 visual_prompt]: Training 55 / 100 epoch, with learning rate 2.5872487417562526
[09/26 01:31:26 visual_prompt]: Epoch 55 / 100: avg data time: 4.86e-02, avg batch time: 0.4936, average train loss: 0.2227
[09/26 01:31:28 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1678, average loss: 0.6132
[09/26 01:31:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.51	
[09/26 01:31:28 visual_prompt]: Training 56 / 100 epoch, with learning rate 2.5
[09/26 01:31:34 visual_prompt]: Epoch 56 / 100: avg data time: 5.74e-02, avg batch time: 0.5008, average train loss: 0.1506
[09/26 01:31:36 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1676, average loss: 0.7059
[09/26 01:31:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.21	
[09/26 01:31:36 visual_prompt]: Training 57 / 100 epoch, with learning rate 2.4127512582437483
[09/26 01:31:43 visual_prompt]: Epoch 57 / 100: avg data time: 5.34e-02, avg batch time: 0.4987, average train loss: 0.1246
[09/26 01:31:44 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1677, average loss: 0.7622
[09/26 01:31:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 90.68	
[09/26 01:31:44 visual_prompt]: Training 58 / 100 epoch, with learning rate 2.325608815639687
[09/26 01:31:51 visual_prompt]: Epoch 58 / 100: avg data time: 4.87e-02, avg batch time: 0.4921, average train loss: 0.1310
[09/26 01:31:52 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1672, average loss: 0.8001
[09/26 01:31:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 90.45	
[09/26 01:31:52 visual_prompt]: Training 59 / 100 epoch, with learning rate 2.2386788418308665
[09/26 01:31:59 visual_prompt]: Epoch 59 / 100: avg data time: 5.44e-02, avg batch time: 0.4978, average train loss: 0.1000
[09/26 01:32:01 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1676, average loss: 0.6913
[09/26 01:32:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.87	
[09/26 01:32:01 visual_prompt]: Training 60 / 100 epoch, with learning rate 2.1520672475998373
[09/26 01:32:07 visual_prompt]: Epoch 60 / 100: avg data time: 6.30e-02, avg batch time: 0.5064, average train loss: 0.1196
[09/26 01:32:09 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1674, average loss: 0.7755
[09/26 01:32:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 90.58	
[09/26 01:32:09 visual_prompt]: Training 61 / 100 epoch, with learning rate 2.0658795558326744
[09/26 01:32:16 visual_prompt]: Epoch 61 / 100: avg data time: 4.84e-02, avg batch time: 0.4944, average train loss: 0.0782
[09/26 01:32:17 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1673, average loss: 0.7580
[09/26 01:32:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 90.08	
[09/26 01:32:17 visual_prompt]: Training 62 / 100 epoch, with learning rate 1.980220772955602
[09/26 01:32:24 visual_prompt]: Epoch 62 / 100: avg data time: 4.62e-02, avg batch time: 0.4906, average train loss: 0.0708
[09/26 01:32:25 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1675, average loss: 0.7123
[09/26 01:32:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.76	
[09/26 01:32:25 visual_prompt]: Training 63 / 100 epoch, with learning rate 1.895195261000831
[09/26 01:32:32 visual_prompt]: Epoch 63 / 100: avg data time: 5.48e-02, avg batch time: 0.4994, average train loss: 0.1133
[09/26 01:32:34 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1674, average loss: 0.7292
[09/26 01:32:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 91.46	
[09/26 01:32:34 visual_prompt]: Training 64 / 100 epoch, with learning rate 1.8109066104575022
[09/26 01:32:40 visual_prompt]: Epoch 64 / 100: avg data time: 5.91e-02, avg batch time: 0.5026, average train loss: 0.1523
[09/26 01:32:42 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1671, average loss: 0.8769
[09/26 01:32:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.48	
[09/26 01:32:42 visual_prompt]: Training 65 / 100 epoch, with learning rate 1.7274575140626316
[09/26 01:32:49 visual_prompt]: Epoch 65 / 100: avg data time: 5.08e-02, avg batch time: 0.4947, average train loss: 0.1144
[09/26 01:32:50 visual_prompt]: Inference (val):avg data time: 2.14e-05, avg batch time: 0.1673, average loss: 0.9778
[09/26 01:32:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.03	
[09/26 01:32:50 visual_prompt]: Training 66 / 100 epoch, with learning rate 1.6449496416858285
[09/26 01:32:57 visual_prompt]: Epoch 66 / 100: avg data time: 4.41e-02, avg batch time: 0.4904, average train loss: 0.0754
[09/26 01:32:58 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1673, average loss: 0.7955
[09/26 01:32:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.40	
[09/26 01:32:58 visual_prompt]: Training 67 / 100 epoch, with learning rate 1.5634835164602199
[09/26 01:33:05 visual_prompt]: Epoch 67 / 100: avg data time: 4.40e-02, avg batch time: 0.4887, average train loss: 0.0410
[09/26 01:33:07 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.1671, average loss: 0.7877
[09/26 01:33:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.14	
[09/26 01:33:07 visual_prompt]: Training 68 / 100 epoch, with learning rate 1.4831583923104998
[09/26 01:33:13 visual_prompt]: Epoch 68 / 100: avg data time: 4.43e-02, avg batch time: 0.4912, average train loss: 0.0438
[09/26 01:33:15 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1684, average loss: 0.7776
[09/26 01:33:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.69	
[09/26 01:33:15 visual_prompt]: Training 69 / 100 epoch, with learning rate 1.4040721330273063
[09/26 01:33:22 visual_prompt]: Epoch 69 / 100: avg data time: 6.38e-02, avg batch time: 0.5076, average train loss: 0.0285
[09/26 01:33:23 visual_prompt]: Inference (val):avg data time: 2.09e-05, avg batch time: 0.1674, average loss: 0.7270
[09/26 01:33:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.96	
[09/26 01:33:23 visual_prompt]: Training 70 / 100 epoch, with learning rate 1.3263210930352738
[09/26 01:33:30 visual_prompt]: Epoch 70 / 100: avg data time: 5.57e-02, avg batch time: 0.4992, average train loss: 0.0335
[09/26 01:33:31 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1672, average loss: 0.8039
[09/26 01:33:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.49	
[09/26 01:33:31 visual_prompt]: Training 71 / 100 epoch, with learning rate 1.2500000000000004
[09/26 01:33:38 visual_prompt]: Epoch 71 / 100: avg data time: 5.51e-02, avg batch time: 0.4994, average train loss: 0.0309
[09/26 01:33:40 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1674, average loss: 0.7980
[09/26 01:33:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.76	
[09/26 01:33:40 visual_prompt]: Training 72 / 100 epoch, with learning rate 1.175201839416988
[09/26 01:33:46 visual_prompt]: Epoch 72 / 100: avg data time: 4.05e-02, avg batch time: 0.4844, average train loss: 0.0342
[09/26 01:33:48 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1672, average loss: 0.8753
[09/26 01:33:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.20	
[09/26 01:33:48 visual_prompt]: Training 73 / 100 epoch, with learning rate 1.1020177413231333
[09/26 01:33:55 visual_prompt]: Epoch 73 / 100: avg data time: 6.33e-02, avg batch time: 0.5070, average train loss: 0.0425
[09/26 01:33:56 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.1672, average loss: 0.8181
[09/26 01:33:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.44	
[09/26 01:33:56 visual_prompt]: Training 74 / 100 epoch, with learning rate 1.0305368692688175
[09/26 01:34:03 visual_prompt]: Epoch 74 / 100: avg data time: 5.08e-02, avg batch time: 0.4943, average train loss: 0.0279
[09/26 01:34:05 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1671, average loss: 0.9312
[09/26 01:34:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 90.76	
[09/26 01:34:05 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.9608463116858543
[09/26 01:34:11 visual_prompt]: Epoch 75 / 100: avg data time: 4.90e-02, avg batch time: 0.4932, average train loss: 0.0154
[09/26 01:34:13 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1673, average loss: 0.9495
[09/26 01:34:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 90.33	
[09/26 01:34:13 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.8930309757836516
[09/26 01:34:20 visual_prompt]: Epoch 76 / 100: avg data time: 5.77e-02, avg batch time: 0.5024, average train loss: 0.0137
[09/26 01:34:21 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1672, average loss: 0.8623
[09/26 01:34:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.89	
[09/26 01:34:21 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.8271734841028553
[09/26 01:34:28 visual_prompt]: Epoch 77 / 100: avg data time: 5.28e-02, avg batch time: 0.4971, average train loss: 0.0103
[09/26 01:34:29 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.1674, average loss: 0.8631
[09/26 01:34:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.85	
[09/26 01:34:29 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.7633540738525066
[09/26 01:34:36 visual_prompt]: Epoch 78 / 100: avg data time: 4.82e-02, avg batch time: 0.4931, average train loss: 0.0075
[09/26 01:34:38 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.1670, average loss: 0.8888
[09/26 01:34:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.47	
[09/26 01:34:38 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.7016504991533725
[09/26 01:34:44 visual_prompt]: Epoch 79 / 100: avg data time: 5.81e-02, avg batch time: 0.5015, average train loss: 0.0069
[09/26 01:34:46 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1674, average loss: 0.8693
[09/26 01:34:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.95	
[09/26 01:34:46 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.6421379363065141
[09/26 01:34:52 visual_prompt]: Epoch 80 / 100: avg data time: 4.35e-02, avg batch time: 0.4884, average train loss: 0.0052
[09/26 01:34:54 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1674, average loss: 0.8764
[09/26 01:34:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.00	
[09/26 01:34:54 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.5848888922025552
[09/26 01:35:01 visual_prompt]: Epoch 81 / 100: avg data time: 5.49e-02, avg batch time: 0.4984, average train loss: 0.0079
[09/26 01:35:02 visual_prompt]: Inference (val):avg data time: 2.23e-05, avg batch time: 0.1673, average loss: 0.8974
[09/26 01:35:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.67	
[09/26 01:35:02 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.5299731159831953
[09/26 01:35:09 visual_prompt]: Epoch 82 / 100: avg data time: 6.13e-02, avg batch time: 0.5052, average train loss: 0.0067
[09/26 01:35:11 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1672, average loss: 0.9609
[09/26 01:35:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 90.55	
[09/26 01:35:11 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.47745751406263165
[09/26 01:35:17 visual_prompt]: Epoch 83 / 100: avg data time: 4.58e-02, avg batch time: 0.4921, average train loss: 0.0052
[09/26 01:35:19 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1675, average loss: 0.9304
[09/26 01:35:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.02	
[09/26 01:35:19 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.42740606861239594
[09/26 01:35:25 visual_prompt]: Epoch 84 / 100: avg data time: 5.15e-02, avg batch time: 0.4960, average train loss: 0.0072
[09/26 01:35:27 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1675, average loss: 0.9091
[09/26 01:35:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.52	
[09/26 01:35:27 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.3798797596089351
[09/26 01:35:34 visual_prompt]: Epoch 85 / 100: avg data time: 6.36e-02, avg batch time: 0.5071, average train loss: 0.0048
[09/26 01:35:35 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1676, average loss: 0.9413
[09/26 01:35:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.38	
[09/26 01:35:35 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.33493649053890323
[09/26 01:35:42 visual_prompt]: Epoch 86 / 100: avg data time: 5.61e-02, avg batch time: 0.4997, average train loss: 0.0034
[09/26 01:35:44 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1672, average loss: 0.9165
[09/26 01:35:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.56	
[09/26 01:35:44 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.29263101785268253
[09/26 01:35:50 visual_prompt]: Epoch 87 / 100: avg data time: 5.82e-02, avg batch time: 0.5012, average train loss: 0.0052
[09/26 01:35:52 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1668, average loss: 0.9037
[09/26 01:35:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.83	
[09/26 01:35:52 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.25301488425208296
[09/26 01:35:59 visual_prompt]: Epoch 88 / 100: avg data time: 5.19e-02, avg batch time: 0.4974, average train loss: 0.0037
[09/26 01:36:00 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1673, average loss: 0.9058
[09/26 01:36:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.83	
[09/26 01:36:00 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.21613635589349756
[09/26 01:36:07 visual_prompt]: Epoch 89 / 100: avg data time: 5.48e-02, avg batch time: 0.4978, average train loss: 0.0048
[09/26 01:36:09 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1674, average loss: 0.9197
[09/26 01:36:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.78	
[09/26 01:36:09 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.18204036358303172
[09/26 01:36:15 visual_prompt]: Epoch 90 / 100: avg data time: 5.53e-02, avg batch time: 0.4994, average train loss: 0.0075
[09/26 01:36:17 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1676, average loss: 0.9156
[09/26 01:36:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.71	
[09/26 01:36:17 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.1507684480352292
[09/26 01:36:24 visual_prompt]: Epoch 91 / 100: avg data time: 5.29e-02, avg batch time: 0.4975, average train loss: 0.0045
[09/26 01:36:25 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1675, average loss: 0.9196
[09/26 01:36:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.71	
[09/26 01:36:25 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.12235870926211617
[09/26 01:36:32 visual_prompt]: Epoch 92 / 100: avg data time: 5.22e-02, avg batch time: 0.4960, average train loss: 0.0033
[09/26 01:36:34 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1670, average loss: 0.9196
[09/26 01:36:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.71	
[09/26 01:36:34 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.09684576015420276
[09/26 01:36:40 visual_prompt]: Epoch 93 / 100: avg data time: 5.46e-02, avg batch time: 0.4982, average train loss: 0.0033
[09/26 01:36:42 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1672, average loss: 0.9192
[09/26 01:36:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.74	
[09/26 01:36:42 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.07426068431000882
[09/26 01:36:48 visual_prompt]: Epoch 94 / 100: avg data time: 5.05e-02, avg batch time: 0.4946, average train loss: 0.0029
[09/26 01:36:50 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1673, average loss: 0.9187
[09/26 01:36:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.75	
[09/26 01:36:50 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.05463099816548578
[09/26 01:36:57 visual_prompt]: Epoch 95 / 100: avg data time: 5.25e-02, avg batch time: 0.4966, average train loss: 0.0050
[09/26 01:36:58 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1673, average loss: 0.9183
[09/26 01:36:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.77	
[09/26 01:36:58 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.03798061746947995
[09/26 01:37:05 visual_prompt]: Epoch 96 / 100: avg data time: 5.36e-02, avg batch time: 0.4980, average train loss: 0.0038
[09/26 01:37:07 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1674, average loss: 0.9199
[09/26 01:37:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.73	
[09/26 01:37:07 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.024329828146074095
[09/26 01:37:13 visual_prompt]: Epoch 97 / 100: avg data time: 5.36e-02, avg batch time: 0.4972, average train loss: 0.0027
[09/26 01:37:15 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1673, average loss: 0.9204
[09/26 01:37:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.72	
[09/26 01:37:15 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.013695261579316775
[09/26 01:37:22 visual_prompt]: Epoch 98 / 100: avg data time: 6.13e-02, avg batch time: 0.5047, average train loss: 0.0036
[09/26 01:37:23 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1673, average loss: 0.9203
[09/26 01:37:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.73	
[09/26 01:37:23 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.006089874350439506
[09/26 01:37:30 visual_prompt]: Epoch 99 / 100: avg data time: 5.93e-02, avg batch time: 0.5023, average train loss: 0.0026
[09/26 01:37:32 visual_prompt]: Inference (val):avg data time: 2.73e-05, avg batch time: 0.1675, average loss: 0.9204
[09/26 01:37:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.73	
[09/26 01:37:32 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0015229324522605947
[09/26 01:37:38 visual_prompt]: Epoch 100 / 100: avg data time: 4.87e-02, avg batch time: 0.4921, average train loss: 0.0024
[09/26 01:37:40 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1673, average loss: 0.9204
[09/26 01:37:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.73	
[09/26 01:37:40 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 01:37:40 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 01:37:40 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 01:37:40 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 01:37:40 visual_prompt]: Training with config:
[09/26 01:37:40 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr2.5_wd0.01/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.01, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 2.5, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 01:37:40 visual_prompt]: Loading training data...
[09/26 01:37:40 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 01:37:41 visual_prompt]: Number of images: 800
[09/26 01:37:41 visual_prompt]: Number of classes: 2 / 2
[09/26 01:37:41 visual_prompt]: Loading validation data...
[09/26 01:37:41 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 01:37:42 visual_prompt]: Number of images: 200
[09/26 01:37:42 visual_prompt]: Number of classes: 2 / 2
[09/26 01:37:42 visual_prompt]: Constructing models...
[09/26 01:37:44 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 01:37:44 visual_prompt]: tuned percent:0.536
[09/26 01:37:44 visual_prompt]: Device used for model: 0
[09/26 01:37:44 visual_prompt]: Setting up Evaluator...
[09/26 01:37:44 visual_prompt]: Setting up Trainer...
[09/26 01:37:44 visual_prompt]: 	Setting up the optimizer...
[09/26 01:37:44 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 01:37:51 visual_prompt]: Epoch 1 / 100: avg data time: 5.58e-02, avg batch time: 0.4996, average train loss: 1.9743
[09/26 01:37:52 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1665, average loss: 2.0033
[09/26 01:37:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 01:37:52 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 01:37:52 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.25
[09/26 01:37:59 visual_prompt]: Epoch 2 / 100: avg data time: 5.01e-02, avg batch time: 0.4936, average train loss: 6.0338
[09/26 01:38:01 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1667, average loss: 1.0557
[09/26 01:38:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 76.11	
[09/26 01:38:01 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.5
[09/26 01:38:07 visual_prompt]: Epoch 3 / 100: avg data time: 5.31e-02, avg batch time: 0.4954, average train loss: 1.0290
[09/26 01:38:09 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1668, average loss: 0.7511
[09/26 01:38:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.85	
[09/26 01:38:09 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.75
[09/26 01:38:15 visual_prompt]: Epoch 4 / 100: avg data time: 5.40e-02, avg batch time: 0.4980, average train loss: 0.7383
[09/26 01:38:17 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1670, average loss: 0.6513
[09/26 01:38:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.00	rocauc: 86.73	
[09/26 01:38:17 visual_prompt]: Best epoch 4: best metric: 0.660
[09/26 01:38:17 visual_prompt]: Training 5 / 100 epoch, with learning rate 1.0
[09/26 01:38:24 visual_prompt]: Epoch 5 / 100: avg data time: 5.18e-02, avg batch time: 0.4942, average train loss: 0.8055
[09/26 01:38:25 visual_prompt]: Inference (val):avg data time: 3.18e-05, avg batch time: 0.1674, average loss: 0.7705
[09/26 01:38:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 51.16	
[09/26 01:38:25 visual_prompt]: Training 6 / 100 epoch, with learning rate 1.25
[09/26 01:38:32 visual_prompt]: Epoch 6 / 100: avg data time: 4.44e-02, avg batch time: 0.4884, average train loss: 1.0418
[09/26 01:38:33 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1670, average loss: 0.7076
[09/26 01:38:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 34.97	
[09/26 01:38:33 visual_prompt]: Training 7 / 100 epoch, with learning rate 1.5
[09/26 01:38:40 visual_prompt]: Epoch 7 / 100: avg data time: 6.12e-02, avg batch time: 0.5037, average train loss: 1.0134
[09/26 01:38:41 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1668, average loss: 1.1538
[09/26 01:38:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 48.86	
[09/26 01:38:41 visual_prompt]: Training 8 / 100 epoch, with learning rate 1.75
[09/26 01:38:48 visual_prompt]: Epoch 8 / 100: avg data time: 4.40e-02, avg batch time: 0.4874, average train loss: 1.5951
[09/26 01:38:50 visual_prompt]: Inference (val):avg data time: 2.92e-05, avg batch time: 0.1669, average loss: 0.7160
[09/26 01:38:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 54.84	
[09/26 01:38:50 visual_prompt]: Training 9 / 100 epoch, with learning rate 2.0
[09/26 01:38:56 visual_prompt]: Epoch 9 / 100: avg data time: 5.29e-02, avg batch time: 0.4967, average train loss: 1.1363
[09/26 01:38:58 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1672, average loss: 1.2248
[09/26 01:38:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 46.37	
[09/26 01:38:58 visual_prompt]: Training 10 / 100 epoch, with learning rate 2.25
[09/26 01:39:04 visual_prompt]: Epoch 10 / 100: avg data time: 4.49e-02, avg batch time: 0.4878, average train loss: 3.9263
[09/26 01:39:06 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1673, average loss: 0.7380
[09/26 01:39:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 47.83	
[09/26 01:39:06 visual_prompt]: Training 11 / 100 epoch, with learning rate 2.5
[09/26 01:39:13 visual_prompt]: Epoch 11 / 100: avg data time: 5.56e-02, avg batch time: 0.4988, average train loss: 3.6050
[09/26 01:39:14 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1673, average loss: 1.0759
[09/26 01:39:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 65.40	
[09/26 01:39:14 visual_prompt]: Training 12 / 100 epoch, with learning rate 2.4992385337738696
[09/26 01:39:21 visual_prompt]: Epoch 12 / 100: avg data time: 4.84e-02, avg batch time: 0.4936, average train loss: 4.2351
[09/26 01:39:23 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1670, average loss: 1.8288
[09/26 01:39:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 71.35	
[09/26 01:39:23 visual_prompt]: Training 13 / 100 epoch, with learning rate 2.4969550628247803
[09/26 01:39:29 visual_prompt]: Epoch 13 / 100: avg data time: 5.11e-02, avg batch time: 0.4952, average train loss: 17.2021
[09/26 01:39:31 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1672, average loss: 6.0860
[09/26 01:39:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 77.85	
[09/26 01:39:31 visual_prompt]: Training 14 / 100 epoch, with learning rate 2.4931523692103417
[09/26 01:39:37 visual_prompt]: Epoch 14 / 100: avg data time: 4.43e-02, avg batch time: 0.4877, average train loss: 4.7409
[09/26 01:39:39 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1672, average loss: 6.7896
[09/26 01:39:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 47.43	
[09/26 01:39:39 visual_prompt]: Training 15 / 100 epoch, with learning rate 2.487835085926963
[09/26 01:39:46 visual_prompt]: Epoch 15 / 100: avg data time: 6.64e-02, avg batch time: 0.5106, average train loss: 4.4841
[09/26 01:39:47 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1672, average loss: 0.9291
[09/26 01:39:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 40.84	
[09/26 01:39:47 visual_prompt]: Training 16 / 100 epoch, with learning rate 2.4810096912652604
[09/26 01:39:54 visual_prompt]: Epoch 16 / 100: avg data time: 5.99e-02, avg batch time: 0.5028, average train loss: 2.8254
[09/26 01:39:56 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1671, average loss: 1.8628
[09/26 01:39:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 32.67	
[09/26 01:39:56 visual_prompt]: Training 17 / 100 epoch, with learning rate 2.472684500917257
[09/26 01:40:02 visual_prompt]: Epoch 17 / 100: avg data time: 4.87e-02, avg batch time: 0.4938, average train loss: 3.3448
[09/26 01:40:04 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1673, average loss: 3.1618
[09/26 01:40:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 70.76	
[09/26 01:40:04 visual_prompt]: Training 18 / 100 epoch, with learning rate 2.4628696578449953
[09/26 01:40:10 visual_prompt]: Epoch 18 / 100: avg data time: 4.51e-02, avg batch time: 0.4900, average train loss: 2.9377
[09/26 01:40:12 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1673, average loss: 2.3382
[09/26 01:40:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 54.03	
[09/26 01:40:12 visual_prompt]: Training 19 / 100 epoch, with learning rate 2.4515771199228986
[09/26 01:40:19 visual_prompt]: Epoch 19 / 100: avg data time: 6.23e-02, avg batch time: 0.5064, average train loss: 3.7960
[09/26 01:40:20 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1672, average loss: 2.7470
[09/26 01:40:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 67.61	
[09/26 01:40:20 visual_prompt]: Training 20 / 100 epoch, with learning rate 2.438820645368942
[09/26 01:40:27 visual_prompt]: Epoch 20 / 100: avg data time: 4.81e-02, avg batch time: 0.4927, average train loss: 2.9216
[09/26 01:40:28 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1673, average loss: 4.5388
[09/26 01:40:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 38.17	
[09/26 01:40:28 visual_prompt]: Training 21 / 100 epoch, with learning rate 2.4246157759823856
[09/26 01:40:35 visual_prompt]: Epoch 21 / 100: avg data time: 5.14e-02, avg batch time: 0.4958, average train loss: 2.5414
[09/26 01:40:36 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.1672, average loss: 0.7848
[09/26 01:40:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 80.42	
[09/26 01:40:36 visual_prompt]: Training 22 / 100 epoch, with learning rate 2.4089798182084845
[09/26 01:40:43 visual_prompt]: Epoch 22 / 100: avg data time: 4.63e-02, avg batch time: 0.4898, average train loss: 3.0609
[09/26 01:40:45 visual_prompt]: Inference (val):avg data time: 3.25e-05, avg batch time: 0.1675, average loss: 2.9887
[09/26 01:40:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 32.89	
[09/26 01:40:45 visual_prompt]: Training 23 / 100 epoch, with learning rate 2.391931822053251
[09/26 01:40:51 visual_prompt]: Epoch 23 / 100: avg data time: 4.43e-02, avg batch time: 0.4882, average train loss: 1.6016
[09/26 01:40:53 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1674, average loss: 2.1414
[09/26 01:40:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 49.23	
[09/26 01:40:53 visual_prompt]: Training 24 / 100 epoch, with learning rate 2.3734925578739587
[09/26 01:40:59 visual_prompt]: Epoch 24 / 100: avg data time: 4.11e-02, avg batch time: 0.4877, average train loss: 5.3923
[09/26 01:41:01 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.1673, average loss: 6.1422
[09/26 01:41:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 74.66	
[09/26 01:41:01 visual_prompt]: Training 25 / 100 epoch, with learning rate 2.3536844910736585
[09/26 01:41:07 visual_prompt]: Epoch 25 / 100: avg data time: 4.29e-02, avg batch time: 0.4882, average train loss: 3.5169
[09/26 01:41:09 visual_prompt]: Inference (val):avg data time: 4.74e-05, avg batch time: 0.1673, average loss: 4.8653
[09/26 01:41:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.36	
[09/26 01:41:09 visual_prompt]: Training 26 / 100 epoch, with learning rate 2.3325317547305486
[09/26 01:41:15 visual_prompt]: Epoch 26 / 100: avg data time: 4.30e-02, avg batch time: 0.4884, average train loss: 3.1075
[09/26 01:41:17 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1675, average loss: 3.7873
[09/26 01:41:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.29	
[09/26 01:41:17 visual_prompt]: Training 27 / 100 epoch, with learning rate 2.310060120195532
[09/26 01:41:23 visual_prompt]: Epoch 27 / 100: avg data time: 4.26e-02, avg batch time: 0.4869, average train loss: 2.3584
[09/26 01:41:25 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1678, average loss: 1.7323
[09/26 01:41:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 45.71	
[09/26 01:41:25 visual_prompt]: Training 28 / 100 epoch, with learning rate 2.286296965693802
[09/26 01:41:32 visual_prompt]: Epoch 28 / 100: avg data time: 5.16e-02, avg batch time: 0.4945, average train loss: 2.1552
[09/26 01:41:33 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1676, average loss: 1.8014
[09/26 01:41:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 67.88	
[09/26 01:41:33 visual_prompt]: Training 29 / 100 epoch, with learning rate 2.261271242968684
[09/26 01:41:40 visual_prompt]: Epoch 29 / 100: avg data time: 4.82e-02, avg batch time: 0.4918, average train loss: 2.8499
[09/26 01:41:41 visual_prompt]: Inference (val):avg data time: 5.10e-05, avg batch time: 0.1676, average loss: 1.7094
[09/26 01:41:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 47.34	
[09/26 01:41:41 visual_prompt]: Training 30 / 100 epoch, with learning rate 2.2350134420084022
[09/26 01:41:48 visual_prompt]: Epoch 30 / 100: avg data time: 4.17e-02, avg batch time: 0.4876, average train loss: 2.8844
[09/26 01:41:49 visual_prompt]: Inference (val):avg data time: 2.73e-05, avg batch time: 0.1672, average loss: 0.7082
[09/26 01:41:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 35.22	
[09/26 01:41:49 visual_prompt]: Training 31 / 100 epoch, with learning rate 2.2075555538987226
[09/26 01:41:56 visual_prompt]: Epoch 31 / 100: avg data time: 5.30e-02, avg batch time: 0.4977, average train loss: 3.4455
[09/26 01:41:57 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1674, average loss: 17.8577
[09/26 01:41:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 67.64	
[09/26 01:41:57 visual_prompt]: Training 32 / 100 epoch, with learning rate 2.178931031846743
[09/26 01:42:04 visual_prompt]: Epoch 32 / 100: avg data time: 5.20e-02, avg batch time: 0.4966, average train loss: 7.0831
[09/26 01:42:05 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1671, average loss: 4.6879
[09/26 01:42:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 69.54	
[09/26 01:42:05 visual_prompt]: Training 33 / 100 epoch, with learning rate 2.149174750423314
[09/26 01:42:12 visual_prompt]: Epoch 33 / 100: avg data time: 4.30e-02, avg batch time: 0.4865, average train loss: 3.8061
[09/26 01:42:13 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.1670, average loss: 2.0323
[09/26 01:42:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 29.23	
[09/26 01:42:14 visual_prompt]: Training 34 / 100 epoch, with learning rate 2.1183229630737466
[09/26 01:42:20 visual_prompt]: Epoch 34 / 100: avg data time: 5.85e-02, avg batch time: 0.5027, average train loss: 4.4853
[09/26 01:42:22 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.1670, average loss: 3.0233
[09/26 01:42:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 68.67	
[09/26 01:42:22 visual_prompt]: Training 35 / 100 epoch, with learning rate 2.086413257948573
[09/26 01:42:29 visual_prompt]: Epoch 35 / 100: avg data time: 5.70e-02, avg batch time: 0.5027, average train loss: 1.9415
[09/26 01:42:30 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1675, average loss: 3.1806
[09/26 01:42:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 51.51	
[09/26 01:42:30 visual_prompt]: Training 36 / 100 epoch, with learning rate 2.053484512108174
[09/26 01:42:37 visual_prompt]: Epoch 36 / 100: avg data time: 6.01e-02, avg batch time: 0.5040, average train loss: 2.4231
[09/26 01:42:38 visual_prompt]: Inference (val):avg data time: 2.07e-05, avg batch time: 0.1672, average loss: 4.8502
[09/26 01:42:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 55.88	
[09/26 01:42:38 visual_prompt]: Training 37 / 100 epoch, with learning rate 2.019576844157073
[09/26 01:42:45 visual_prompt]: Epoch 37 / 100: avg data time: 5.87e-02, avg batch time: 0.5026, average train loss: 1.8531
[09/26 01:42:47 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1673, average loss: 2.0692
[09/26 01:42:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 27.36	
[09/26 01:42:47 visual_prompt]: Training 38 / 100 epoch, with learning rate 1.9847315653655915
[09/26 01:42:53 visual_prompt]: Epoch 38 / 100: avg data time: 4.64e-02, avg batch time: 0.4918, average train loss: 1.4099
[09/26 01:42:55 visual_prompt]: Inference (val):avg data time: 2.03e-05, avg batch time: 0.1672, average loss: 0.7502
[09/26 01:42:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 40.90	
[09/26 01:42:55 visual_prompt]: Training 39 / 100 epoch, with learning rate 1.9489911293384334
[09/26 01:43:02 visual_prompt]: Epoch 39 / 100: avg data time: 5.98e-02, avg batch time: 0.5034, average train loss: 3.0312
[09/26 01:43:03 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1670, average loss: 1.4755
[09/26 01:43:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 32.71	
[09/26 01:43:03 visual_prompt]: Training 40 / 100 epoch, with learning rate 1.912399080291506
[09/26 01:43:10 visual_prompt]: Epoch 40 / 100: avg data time: 5.52e-02, avg batch time: 0.4992, average train loss: 2.9708
[09/26 01:43:11 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1672, average loss: 4.5909
[09/26 01:43:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 71.37	
[09/26 01:43:11 visual_prompt]: Training 41 / 100 epoch, with learning rate 1.875
[09/26 01:43:18 visual_prompt]: Epoch 41 / 100: avg data time: 5.39e-02, avg batch time: 0.4969, average train loss: 2.2985
[09/26 01:43:20 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1672, average loss: 1.3016
[09/26 01:43:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 34.40	
[09/26 01:43:20 visual_prompt]: Training 42 / 100 epoch, with learning rate 1.8368394534823635
[09/26 01:43:26 visual_prompt]: Epoch 42 / 100: avg data time: 6.40e-02, avg batch time: 0.5069, average train loss: 1.2198
[09/26 01:43:28 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1675, average loss: 1.3306
[09/26 01:43:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 63.61	
[09/26 01:43:28 visual_prompt]: Training 43 / 100 epoch, with learning rate 1.7979639334863466
[09/26 01:43:35 visual_prompt]: Epoch 43 / 100: avg data time: 4.93e-02, avg batch time: 0.4946, average train loss: 3.7905
[09/26 01:43:36 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1670, average loss: 6.7229
[09/26 01:43:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 32.24	
[09/26 01:43:36 visual_prompt]: Training 44 / 100 epoch, with learning rate 1.7584208038447504
[09/26 01:43:43 visual_prompt]: Epoch 44 / 100: avg data time: 6.18e-02, avg batch time: 0.5057, average train loss: 3.6181
[09/26 01:43:45 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1672, average loss: 2.3180
[09/26 01:43:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 48.44	
[09/26 01:43:45 visual_prompt]: Training 45 / 100 epoch, with learning rate 1.7182582417698902
[09/26 01:43:51 visual_prompt]: Epoch 45 / 100: avg data time: 4.66e-02, avg batch time: 0.4914, average train loss: 2.9832
[09/26 01:43:53 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1669, average loss: 1.7825
[09/26 01:43:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 35.45	
[09/26 01:43:53 visual_prompt]: Training 46 / 100 epoch, with learning rate 1.6775251791570862
[09/26 01:44:00 visual_prompt]: Epoch 46 / 100: avg data time: 5.71e-02, avg batch time: 0.5011, average train loss: 3.2135
[09/26 01:44:01 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1669, average loss: 2.7710
[09/26 01:44:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 66.26	
[09/26 01:44:01 visual_prompt]: Training 47 / 100 epoch, with learning rate 1.6362712429686843
[09/26 01:44:08 visual_prompt]: Epoch 47 / 100: avg data time: 6.04e-02, avg batch time: 0.5049, average train loss: 4.0238
[09/26 01:44:10 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1672, average loss: 3.0259
[09/26 01:44:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 60.98	
[09/26 01:44:10 visual_prompt]: Training 48 / 100 epoch, with learning rate 1.5945466947712488
[09/26 01:44:17 visual_prompt]: Epoch 48 / 100: avg data time: 5.47e-02, avg batch time: 0.4990, average train loss: 1.8305
[09/26 01:44:18 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1670, average loss: 1.8676
[09/26 01:44:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 78.00	
[09/26 01:44:18 visual_prompt]: Training 49 / 100 epoch, with learning rate 1.5524023694995845
[09/26 01:44:25 visual_prompt]: Epoch 49 / 100: avg data time: 5.72e-02, avg batch time: 0.5014, average train loss: 1.3838
[09/26 01:44:26 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1674, average loss: 1.6401
[09/26 01:44:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 66.72	
[09/26 01:44:26 visual_prompt]: Training 50 / 100 epoch, with learning rate 1.509889613522199
[09/26 01:44:33 visual_prompt]: Epoch 50 / 100: avg data time: 6.05e-02, avg batch time: 0.5033, average train loss: 3.1231
[09/26 01:44:35 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1670, average loss: 0.6773
[09/26 01:44:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.00	rocauc: 73.84	
[09/26 01:44:35 visual_prompt]: Training 51 / 100 epoch, with learning rate 1.467060222083663
[09/26 01:44:42 visual_prompt]: Epoch 51 / 100: avg data time: 5.93e-02, avg batch time: 0.5025, average train loss: 1.8324
[09/26 01:44:43 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1673, average loss: 1.0111
[09/26 01:44:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 74.43	
[09/26 01:44:43 visual_prompt]: Training 52 / 100 epoch, with learning rate 1.4239663762000818
[09/26 01:44:50 visual_prompt]: Epoch 52 / 100: avg data time: 5.85e-02, avg batch time: 0.5032, average train loss: 1.5028
[09/26 01:44:51 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1671, average loss: 0.8321
[09/26 01:44:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 67.16	
[09/26 01:44:51 visual_prompt]: Training 53 / 100 epoch, with learning rate 1.380660579084567
[09/26 01:44:58 visual_prompt]: Epoch 53 / 100: avg data time: 6.00e-02, avg batch time: 0.5028, average train loss: 1.7636
[09/26 01:45:00 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1668, average loss: 2.2661
[09/26 01:45:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 62.55	
[09/26 01:45:00 visual_prompt]: Training 54 / 100 epoch, with learning rate 1.3371955921801564
[09/26 01:45:06 visual_prompt]: Epoch 54 / 100: avg data time: 5.08e-02, avg batch time: 0.4943, average train loss: 3.6991
[09/26 01:45:08 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1670, average loss: 2.4782
[09/26 01:45:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 72.11	
[09/26 01:45:08 visual_prompt]: Training 55 / 100 epoch, with learning rate 1.2936243708781263
[09/26 01:45:15 visual_prompt]: Epoch 55 / 100: avg data time: 5.69e-02, avg batch time: 0.5006, average train loss: 2.5774
[09/26 01:45:16 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1672, average loss: 1.3836
[09/26 01:45:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 80.75	
[09/26 01:45:16 visual_prompt]: Training 56 / 100 epoch, with learning rate 1.25
[09/26 01:45:23 visual_prompt]: Epoch 56 / 100: avg data time: 5.81e-02, avg batch time: 0.5026, average train loss: 1.4394
[09/26 01:45:25 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1670, average loss: 2.5372
[09/26 01:45:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 56.02	
[09/26 01:45:25 visual_prompt]: Training 57 / 100 epoch, with learning rate 1.2063756291218741
[09/26 01:45:31 visual_prompt]: Epoch 57 / 100: avg data time: 5.55e-02, avg batch time: 0.5020, average train loss: 1.5098
[09/26 01:45:33 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1671, average loss: 0.6691
[09/26 01:45:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.50	rocauc: 67.96	
[09/26 01:45:33 visual_prompt]: Training 58 / 100 epoch, with learning rate 1.1628044078198434
[09/26 01:45:40 visual_prompt]: Epoch 58 / 100: avg data time: 6.25e-02, avg batch time: 0.5052, average train loss: 1.2561
[09/26 01:45:41 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1672, average loss: 0.6965
[09/26 01:45:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 59.76	
[09/26 01:45:41 visual_prompt]: Training 59 / 100 epoch, with learning rate 1.1193394209154333
[09/26 01:45:48 visual_prompt]: Epoch 59 / 100: avg data time: 5.62e-02, avg batch time: 0.5016, average train loss: 0.7744
[09/26 01:45:50 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1674, average loss: 0.6848
[09/26 01:45:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.33	
[09/26 01:45:50 visual_prompt]: Training 60 / 100 epoch, with learning rate 1.0760336237999186
[09/26 01:45:56 visual_prompt]: Epoch 60 / 100: avg data time: 4.65e-02, avg batch time: 0.4904, average train loss: 0.9638
[09/26 01:45:58 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1668, average loss: 2.4429
[09/26 01:45:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 45.93	
[09/26 01:45:58 visual_prompt]: Training 61 / 100 epoch, with learning rate 1.0329397779163372
[09/26 01:46:04 visual_prompt]: Epoch 61 / 100: avg data time: 4.88e-02, avg batch time: 0.4928, average train loss: 1.4092
[09/26 01:46:06 visual_prompt]: Inference (val):avg data time: 2.70e-05, avg batch time: 0.1668, average loss: 0.9793
[09/26 01:46:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 45.17	
[09/26 01:46:06 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.990110386477801
[09/26 01:46:13 visual_prompt]: Epoch 62 / 100: avg data time: 5.75e-02, avg batch time: 0.4997, average train loss: 1.0999
[09/26 01:46:14 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1675, average loss: 0.8309
[09/26 01:46:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 37.76	
[09/26 01:46:14 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.9475976305004155
[09/26 01:46:21 visual_prompt]: Epoch 63 / 100: avg data time: 4.06e-02, avg batch time: 0.4843, average train loss: 0.9145
[09/26 01:46:22 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1670, average loss: 1.0118
[09/26 01:46:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 48.69	
[09/26 01:46:22 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.9054533052287511
[09/26 01:46:29 visual_prompt]: Epoch 64 / 100: avg data time: 5.88e-02, avg batch time: 0.5013, average train loss: 0.7814
[09/26 01:46:30 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1672, average loss: 0.6888
[09/26 01:46:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 56.50	rocauc: 57.44	
[09/26 01:46:30 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.8637287570313158
[09/26 01:46:37 visual_prompt]: Epoch 65 / 100: avg data time: 5.83e-02, avg batch time: 0.5012, average train loss: 0.7138
[09/26 01:46:39 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1673, average loss: 0.6917
[09/26 01:46:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 62.75	
[09/26 01:46:39 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.8224748208429142
[09/26 01:46:45 visual_prompt]: Epoch 66 / 100: avg data time: 5.18e-02, avg batch time: 0.4949, average train loss: 0.9221
[09/26 01:46:47 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1674, average loss: 0.7464
[09/26 01:46:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 62.62	
[09/26 01:46:47 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.7817417582301099
[09/26 01:46:54 visual_prompt]: Epoch 67 / 100: avg data time: 6.02e-02, avg batch time: 0.5044, average train loss: 0.7289
[09/26 01:46:56 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1669, average loss: 0.7771
[09/26 01:46:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 26.07	
[09/26 01:46:56 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.7415791961552499
[09/26 01:47:02 visual_prompt]: Epoch 68 / 100: avg data time: 5.36e-02, avg batch time: 0.4962, average train loss: 0.9497
[09/26 01:47:04 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1672, average loss: 1.3447
[09/26 01:47:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 57.06	
[09/26 01:47:04 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.7020360665136531
[09/26 01:47:11 visual_prompt]: Epoch 69 / 100: avg data time: 5.44e-02, avg batch time: 0.4980, average train loss: 1.1127
[09/26 01:47:12 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1670, average loss: 0.6987
[09/26 01:47:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 51.56	
[09/26 01:47:12 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.6631605465176369
[09/26 01:47:19 visual_prompt]: Epoch 70 / 100: avg data time: 6.00e-02, avg batch time: 0.5025, average train loss: 0.9491
[09/26 01:47:21 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1672, average loss: 0.9229
[09/26 01:47:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.59	
[09/26 01:47:21 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.6250000000000002
[09/26 01:47:27 visual_prompt]: Epoch 71 / 100: avg data time: 5.97e-02, avg batch time: 0.5022, average train loss: 0.8636
[09/26 01:47:29 visual_prompt]: Inference (val):avg data time: 3.04e-05, avg batch time: 0.1673, average loss: 0.7152
[09/26 01:47:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.82	
[09/26 01:47:29 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.587600919708494
[09/26 01:47:35 visual_prompt]: Epoch 72 / 100: avg data time: 4.67e-02, avg batch time: 0.4909, average train loss: 0.7425
[09/26 01:47:37 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1674, average loss: 0.7123
[09/26 01:47:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 81.66	
[09/26 01:47:37 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.5510088706615667
[09/26 01:47:44 visual_prompt]: Epoch 73 / 100: avg data time: 5.76e-02, avg batch time: 0.5004, average train loss: 0.7077
[09/26 01:47:45 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1671, average loss: 0.7392
[09/26 01:47:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 79.77	
[09/26 01:47:45 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.5152684346344087
[09/26 01:47:52 visual_prompt]: Epoch 74 / 100: avg data time: 6.15e-02, avg batch time: 0.5049, average train loss: 0.6961
[09/26 01:47:54 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1674, average loss: 0.8971
[09/26 01:47:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 68.04	
[09/26 01:47:54 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.48042315584292716
[09/26 01:48:00 visual_prompt]: Epoch 75 / 100: avg data time: 6.10e-02, avg batch time: 0.5056, average train loss: 0.7916
[09/26 01:48:02 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1672, average loss: 0.8193
[09/26 01:48:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 45.21	
[09/26 01:48:02 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.4465154878918258
[09/26 01:48:09 visual_prompt]: Epoch 76 / 100: avg data time: 6.01e-02, avg batch time: 0.5035, average train loss: 0.7245
[09/26 01:48:10 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1671, average loss: 0.7034
[09/26 01:48:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.67	
[09/26 01:48:10 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.41358674205142765
[09/26 01:48:17 visual_prompt]: Epoch 77 / 100: avg data time: 6.31e-02, avg batch time: 0.5065, average train loss: 0.6933
[09/26 01:48:19 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1676, average loss: 0.7176
[09/26 01:48:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 80.28	
[09/26 01:48:19 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.3816770369262533
[09/26 01:48:25 visual_prompt]: Epoch 78 / 100: avg data time: 4.97e-02, avg batch time: 0.4929, average train loss: 0.6937
[09/26 01:48:27 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1673, average loss: 0.6808
[09/26 01:48:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 50.00	rocauc: 82.83	
[09/26 01:48:27 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.35082524957668626
[09/26 01:48:33 visual_prompt]: Epoch 79 / 100: avg data time: 4.74e-02, avg batch time: 0.4932, average train loss: 0.7008
[09/26 01:48:35 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1674, average loss: 0.7701
[09/26 01:48:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 71.10	
[09/26 01:48:35 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.32106896815325703
[09/26 01:48:42 visual_prompt]: Epoch 80 / 100: avg data time: 5.55e-02, avg batch time: 0.4989, average train loss: 0.7337
[09/26 01:48:43 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1672, average loss: 0.7002
[09/26 01:48:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.12	
[09/26 01:48:43 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.2924444461012776
[09/26 01:48:50 visual_prompt]: Epoch 81 / 100: avg data time: 7.13e-02, avg batch time: 0.5144, average train loss: 0.6935
[09/26 01:48:51 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1671, average loss: 0.6953
[09/26 01:48:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 79.02	
[09/26 01:48:51 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.26498655799159765
[09/26 01:48:58 visual_prompt]: Epoch 82 / 100: avg data time: 6.41e-02, avg batch time: 0.5068, average train loss: 0.7602
[09/26 01:49:00 visual_prompt]: Inference (val):avg data time: 2.10e-05, avg batch time: 0.1670, average loss: 0.7565
[09/26 01:49:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 55.95	
[09/26 01:49:00 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.23872875703131582
[09/26 01:49:07 visual_prompt]: Epoch 83 / 100: avg data time: 6.61e-02, avg batch time: 0.5097, average train loss: 0.7792
[09/26 01:49:08 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.1670, average loss: 0.7091
[09/26 01:49:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 72.80	
[09/26 01:49:08 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.21370303430619797
[09/26 01:49:15 visual_prompt]: Epoch 84 / 100: avg data time: 5.56e-02, avg batch time: 0.4998, average train loss: 0.7298
[09/26 01:49:16 visual_prompt]: Inference (val):avg data time: 2.06e-05, avg batch time: 0.1674, average loss: 0.6943
[09/26 01:49:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 32.14	
[09/26 01:49:16 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.18993987980446755
[09/26 01:49:23 visual_prompt]: Epoch 85 / 100: avg data time: 4.59e-02, avg batch time: 0.4896, average train loss: 0.7334
[09/26 01:49:24 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1668, average loss: 0.7167
[09/26 01:49:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 76.18	
[09/26 01:49:24 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.16746824526945162
[09/26 01:49:31 visual_prompt]: Epoch 86 / 100: avg data time: 4.27e-02, avg batch time: 0.4862, average train loss: 0.7253
[09/26 01:49:32 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1672, average loss: 0.6877
[09/26 01:49:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.76	
[09/26 01:49:32 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.14631550892634126
[09/26 01:49:39 visual_prompt]: Epoch 87 / 100: avg data time: 4.73e-02, avg batch time: 0.4912, average train loss: 0.6890
[09/26 01:49:40 visual_prompt]: Inference (val):avg data time: 2.10e-05, avg batch time: 0.1672, average loss: 0.6786
[09/26 01:49:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 65.18	
[09/26 01:49:40 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.12650744212604148
[09/26 01:49:47 visual_prompt]: Epoch 88 / 100: avg data time: 4.77e-02, avg batch time: 0.4928, average train loss: 0.7081
[09/26 01:49:49 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1675, average loss: 0.7229
[09/26 01:49:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 83.65	
[09/26 01:49:49 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.10806817794674878
[09/26 01:49:55 visual_prompt]: Epoch 89 / 100: avg data time: 5.40e-02, avg batch time: 0.4983, average train loss: 0.6788
[09/26 01:49:57 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1673, average loss: 0.6676
[09/26 01:49:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.83	
[09/26 01:49:57 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.09102018179151586
[09/26 01:50:04 visual_prompt]: Epoch 90 / 100: avg data time: 6.45e-02, avg batch time: 0.5079, average train loss: 0.6805
[09/26 01:50:05 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.1674, average loss: 0.6362
[09/26 01:50:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 78.26	
[09/26 01:50:05 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.0753842240176146
[09/26 01:50:12 visual_prompt]: Epoch 91 / 100: avg data time: 4.60e-02, avg batch time: 0.4906, average train loss: 0.6864
[09/26 01:50:13 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1670, average loss: 0.6817
[09/26 01:50:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 79.56	
[09/26 01:50:13 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.061179354631058086
[09/26 01:50:20 visual_prompt]: Epoch 92 / 100: avg data time: 4.79e-02, avg batch time: 0.4924, average train loss: 0.6900
[09/26 01:50:21 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1674, average loss: 0.6715
[09/26 01:50:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 76.35	
[09/26 01:50:21 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.04842288007710138
[09/26 01:50:28 visual_prompt]: Epoch 93 / 100: avg data time: 6.03e-02, avg batch time: 0.5052, average train loss: 0.6774
[09/26 01:50:29 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1677, average loss: 0.6307
[09/26 01:50:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 65.43	
[09/26 01:50:29 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.03713034215500441
[09/26 01:50:36 visual_prompt]: Epoch 94 / 100: avg data time: 6.07e-02, avg batch time: 0.5038, average train loss: 0.6661
[09/26 01:50:38 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1672, average loss: 0.6431
[09/26 01:50:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 67.00	rocauc: 86.78	
[09/26 01:50:38 visual_prompt]: Best epoch 94: best metric: 0.670
[09/26 01:50:38 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.02731549908274289
[09/26 01:50:44 visual_prompt]: Epoch 95 / 100: avg data time: 4.38e-02, avg batch time: 0.4880, average train loss: 0.6505
[09/26 01:50:46 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1672, average loss: 0.6257
[09/26 01:50:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.00	rocauc: 87.62	
[09/26 01:50:46 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.018990308734739975
[09/26 01:50:53 visual_prompt]: Epoch 96 / 100: avg data time: 5.33e-02, avg batch time: 0.4972, average train loss: 0.6331
[09/26 01:50:54 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1674, average loss: 0.6460
[09/26 01:50:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 57.50	rocauc: 86.67	
[09/26 01:50:54 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.012164914073037048
[09/26 01:51:01 visual_prompt]: Epoch 97 / 100: avg data time: 4.72e-02, avg batch time: 0.4913, average train loss: 0.5950
[09/26 01:51:02 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1675, average loss: 0.5315
[09/26 01:51:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 91.17	
[09/26 01:51:02 visual_prompt]: Best epoch 97: best metric: 0.795
[09/26 01:51:02 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.006847630789658388
[09/26 01:51:09 visual_prompt]: Epoch 98 / 100: avg data time: 4.16e-02, avg batch time: 0.4853, average train loss: 0.5515
[09/26 01:51:10 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1673, average loss: 0.4652
[09/26 01:51:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 89.96	
[09/26 01:51:10 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.003044937175219753
[09/26 01:51:17 visual_prompt]: Epoch 99 / 100: avg data time: 5.75e-02, avg batch time: 0.5008, average train loss: 0.5073
[09/26 01:51:19 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1675, average loss: 0.5676
[09/26 01:51:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 89.68	
[09/26 01:51:19 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0007614662261302974
[09/26 01:51:25 visual_prompt]: Epoch 100 / 100: avg data time: 5.79e-02, avg batch time: 0.5013, average train loss: 0.5225
[09/26 01:51:27 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1673, average loss: 0.4807
[09/26 01:51:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 89.90	
[09/26 01:51:27 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 01:51:27 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 01:51:27 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 01:51:27 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 01:51:27 visual_prompt]: Training with config:
[09/26 01:51:27 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr2.5_wd0.001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 2.5, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 01:51:27 visual_prompt]: Loading training data...
[09/26 01:51:27 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 01:51:28 visual_prompt]: Number of images: 800
[09/26 01:51:28 visual_prompt]: Number of classes: 2 / 2
[09/26 01:51:28 visual_prompt]: Loading validation data...
[09/26 01:51:28 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 01:51:28 visual_prompt]: Number of images: 200
[09/26 01:51:28 visual_prompt]: Number of classes: 2 / 2
[09/26 01:51:28 visual_prompt]: Constructing models...
[09/26 01:51:31 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 01:51:31 visual_prompt]: tuned percent:0.536
[09/26 01:51:31 visual_prompt]: Device used for model: 0
[09/26 01:51:31 visual_prompt]: Setting up Evaluator...
[09/26 01:51:31 visual_prompt]: Setting up Trainer...
[09/26 01:51:31 visual_prompt]: 	Setting up the optimizer...
[09/26 01:51:31 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 01:51:38 visual_prompt]: Epoch 1 / 100: avg data time: 5.83e-02, avg batch time: 0.5007, average train loss: 1.9567
[09/26 01:51:39 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.1667, average loss: 2.0033
[09/26 01:51:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 01:51:39 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 01:51:39 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.25
[09/26 01:51:46 visual_prompt]: Epoch 2 / 100: avg data time: 5.80e-02, avg batch time: 0.5015, average train loss: 5.8001
[09/26 01:51:48 visual_prompt]: Inference (val):avg data time: 2.05e-05, avg batch time: 0.1668, average loss: 0.9696
[09/26 01:51:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 69.62	
[09/26 01:51:48 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.5
[09/26 01:51:54 visual_prompt]: Epoch 3 / 100: avg data time: 6.03e-02, avg batch time: 0.5045, average train loss: 0.9218
[09/26 01:51:56 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1667, average loss: 0.7763
[09/26 01:51:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.43	
[09/26 01:51:56 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.75
[09/26 01:52:03 visual_prompt]: Epoch 4 / 100: avg data time: 7.03e-02, avg batch time: 0.5130, average train loss: 0.7220
[09/26 01:52:04 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1668, average loss: 0.6171
[09/26 01:52:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.50	rocauc: 89.30	
[09/26 01:52:04 visual_prompt]: Best epoch 4: best metric: 0.605
[09/26 01:52:04 visual_prompt]: Training 5 / 100 epoch, with learning rate 1.0
[09/26 01:52:11 visual_prompt]: Epoch 5 / 100: avg data time: 5.60e-02, avg batch time: 0.4988, average train loss: 0.6914
[09/26 01:52:13 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.1670, average loss: 0.7453
[09/26 01:52:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 88.38	
[09/26 01:52:13 visual_prompt]: Training 6 / 100 epoch, with learning rate 1.25
[09/26 01:52:19 visual_prompt]: Epoch 6 / 100: avg data time: 5.64e-02, avg batch time: 0.4993, average train loss: 0.7981
[09/26 01:52:21 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.1669, average loss: 0.8588
[09/26 01:52:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 89.38	
[09/26 01:52:21 visual_prompt]: Training 7 / 100 epoch, with learning rate 1.5
[09/26 01:52:28 visual_prompt]: Epoch 7 / 100: avg data time: 5.25e-02, avg batch time: 0.4952, average train loss: 0.7409
[09/26 01:52:29 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1672, average loss: 0.5776
[09/26 01:52:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 68.50	rocauc: 89.85	
[09/26 01:52:29 visual_prompt]: Best epoch 7: best metric: 0.685
[09/26 01:52:29 visual_prompt]: Training 8 / 100 epoch, with learning rate 1.75
[09/26 01:52:36 visual_prompt]: Epoch 8 / 100: avg data time: 4.83e-02, avg batch time: 0.4910, average train loss: 0.5967
[09/26 01:52:37 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1671, average loss: 0.5207
[09/26 01:52:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 89.10	
[09/26 01:52:37 visual_prompt]: Best epoch 8: best metric: 0.785
[09/26 01:52:37 visual_prompt]: Training 9 / 100 epoch, with learning rate 2.0
[09/26 01:52:44 visual_prompt]: Epoch 9 / 100: avg data time: 6.65e-02, avg batch time: 0.5097, average train loss: 0.9728
[09/26 01:52:46 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1671, average loss: 0.4388
[09/26 01:52:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.26	
[09/26 01:52:46 visual_prompt]: Best epoch 9: best metric: 0.855
[09/26 01:52:46 visual_prompt]: Training 10 / 100 epoch, with learning rate 2.25
[09/26 01:52:52 visual_prompt]: Epoch 10 / 100: avg data time: 5.00e-02, avg batch time: 0.4941, average train loss: 0.7679
[09/26 01:52:54 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1672, average loss: 0.5802
[09/26 01:52:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 92.43	
[09/26 01:52:54 visual_prompt]: Training 11 / 100 epoch, with learning rate 2.5
[09/26 01:53:01 visual_prompt]: Epoch 11 / 100: avg data time: 5.40e-02, avg batch time: 0.4978, average train loss: 0.8067
[09/26 01:53:02 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1672, average loss: 1.9751
[09/26 01:53:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 91.51	
[09/26 01:53:02 visual_prompt]: Training 12 / 100 epoch, with learning rate 2.4992385337738696
[09/26 01:53:09 visual_prompt]: Epoch 12 / 100: avg data time: 4.40e-02, avg batch time: 0.4875, average train loss: 1.9797
[09/26 01:53:10 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1671, average loss: 1.9041
[09/26 01:53:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 82.07	
[09/26 01:53:10 visual_prompt]: Training 13 / 100 epoch, with learning rate 2.4969550628247803
[09/26 01:53:17 visual_prompt]: Epoch 13 / 100: avg data time: 5.12e-02, avg batch time: 0.4962, average train loss: 3.3799
[09/26 01:53:18 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1677, average loss: 2.0393
[09/26 01:53:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 63.89	
[09/26 01:53:18 visual_prompt]: Training 14 / 100 epoch, with learning rate 2.4931523692103417
[09/26 01:53:25 visual_prompt]: Epoch 14 / 100: avg data time: 5.97e-02, avg batch time: 0.5031, average train loss: 1.7199
[09/26 01:53:27 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1672, average loss: 3.9178
[09/26 01:53:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 87.45	
[09/26 01:53:27 visual_prompt]: Training 15 / 100 epoch, with learning rate 2.487835085926963
[09/26 01:53:33 visual_prompt]: Epoch 15 / 100: avg data time: 5.12e-02, avg batch time: 0.4957, average train loss: 2.7076
[09/26 01:53:35 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1674, average loss: 0.7680
[09/26 01:53:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 87.41	
[09/26 01:53:35 visual_prompt]: Training 16 / 100 epoch, with learning rate 2.4810096912652604
[09/26 01:53:41 visual_prompt]: Epoch 16 / 100: avg data time: 4.77e-02, avg batch time: 0.4917, average train loss: 1.1434
[09/26 01:53:43 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1674, average loss: 0.6804
[09/26 01:53:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.50	rocauc: 89.22	
[09/26 01:53:43 visual_prompt]: Training 17 / 100 epoch, with learning rate 2.472684500917257
[09/26 01:53:50 visual_prompt]: Epoch 17 / 100: avg data time: 5.69e-02, avg batch time: 0.5005, average train loss: 3.7600
[09/26 01:53:52 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1671, average loss: 2.6701
[09/26 01:53:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 35.66	
[09/26 01:53:52 visual_prompt]: Training 18 / 100 epoch, with learning rate 2.4628696578449953
[09/26 01:53:58 visual_prompt]: Epoch 18 / 100: avg data time: 4.13e-02, avg batch time: 0.4861, average train loss: 3.8309
[09/26 01:54:00 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1671, average loss: 6.4658
[09/26 01:54:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 47.07	
[09/26 01:54:00 visual_prompt]: Training 19 / 100 epoch, with learning rate 2.4515771199228986
[09/26 01:54:07 visual_prompt]: Epoch 19 / 100: avg data time: 5.80e-02, avg batch time: 0.5006, average train loss: 2.7566
[09/26 01:54:08 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1671, average loss: 3.8211
[09/26 01:54:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 76.80	
[09/26 01:54:08 visual_prompt]: Training 20 / 100 epoch, with learning rate 2.438820645368942
[09/26 01:54:15 visual_prompt]: Epoch 20 / 100: avg data time: 5.82e-02, avg batch time: 0.5015, average train loss: 2.2878
[09/26 01:54:17 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1669, average loss: 1.1629
[09/26 01:54:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 78.39	
[09/26 01:54:17 visual_prompt]: Training 21 / 100 epoch, with learning rate 2.4246157759823856
[09/26 01:54:23 visual_prompt]: Epoch 21 / 100: avg data time: 5.92e-02, avg batch time: 0.5033, average train loss: 1.5201
[09/26 01:54:25 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1669, average loss: 2.6706
[09/26 01:54:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 75.12	
[09/26 01:54:25 visual_prompt]: Training 22 / 100 epoch, with learning rate 2.4089798182084845
[09/26 01:54:32 visual_prompt]: Epoch 22 / 100: avg data time: 5.09e-02, avg batch time: 0.4942, average train loss: 1.6502
[09/26 01:54:33 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.1672, average loss: 4.2776
[09/26 01:54:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 58.78	
[09/26 01:54:33 visual_prompt]: Training 23 / 100 epoch, with learning rate 2.391931822053251
[09/26 01:54:40 visual_prompt]: Epoch 23 / 100: avg data time: 4.99e-02, avg batch time: 0.4932, average train loss: 2.9804
[09/26 01:54:41 visual_prompt]: Inference (val):avg data time: 3.17e-05, avg batch time: 0.1668, average loss: 0.8778
[09/26 01:54:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 75.22	
[09/26 01:54:41 visual_prompt]: Training 24 / 100 epoch, with learning rate 2.3734925578739587
[09/26 01:54:48 visual_prompt]: Epoch 24 / 100: avg data time: 5.50e-02, avg batch time: 0.4979, average train loss: 1.8085
[09/26 01:54:49 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1670, average loss: 4.0402
[09/26 01:54:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.69	
[09/26 01:54:49 visual_prompt]: Training 25 / 100 epoch, with learning rate 2.3536844910736585
[09/26 01:54:56 visual_prompt]: Epoch 25 / 100: avg data time: 4.62e-02, avg batch time: 0.4910, average train loss: 3.3576
[09/26 01:54:58 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1674, average loss: 0.9124
[09/26 01:54:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 40.58	
[09/26 01:54:58 visual_prompt]: Training 26 / 100 epoch, with learning rate 2.3325317547305486
[09/26 01:55:04 visual_prompt]: Epoch 26 / 100: avg data time: 6.17e-02, avg batch time: 0.5058, average train loss: 1.3334
[09/26 01:55:06 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.1673, average loss: 1.5646
[09/26 01:55:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 67.04	
[09/26 01:55:06 visual_prompt]: Training 27 / 100 epoch, with learning rate 2.310060120195532
[09/26 01:55:13 visual_prompt]: Epoch 27 / 100: avg data time: 6.68e-02, avg batch time: 0.5094, average train loss: 3.2772
[09/26 01:55:14 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1671, average loss: 1.3301
[09/26 01:55:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 79.99	
[09/26 01:55:14 visual_prompt]: Training 28 / 100 epoch, with learning rate 2.286296965693802
[09/26 01:55:21 visual_prompt]: Epoch 28 / 100: avg data time: 6.55e-02, avg batch time: 0.5086, average train loss: 1.6110
[09/26 01:55:22 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1671, average loss: 1.5437
[09/26 01:55:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.27	
[09/26 01:55:22 visual_prompt]: Training 29 / 100 epoch, with learning rate 2.261271242968684
[09/26 01:55:29 visual_prompt]: Epoch 29 / 100: avg data time: 6.40e-02, avg batch time: 0.5073, average train loss: 1.4097
[09/26 01:55:31 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.1671, average loss: 1.4743
[09/26 01:55:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 80.92	
[09/26 01:55:31 visual_prompt]: Training 30 / 100 epoch, with learning rate 2.2350134420084022
[09/26 01:55:38 visual_prompt]: Epoch 30 / 100: avg data time: 6.32e-02, avg batch time: 0.5056, average train loss: 0.8596
[09/26 01:55:39 visual_prompt]: Inference (val):avg data time: 3.44e-05, avg batch time: 0.1675, average loss: 0.7007
[09/26 01:55:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 78.96	
[09/26 01:55:39 visual_prompt]: Training 31 / 100 epoch, with learning rate 2.2075555538987226
[09/26 01:55:46 visual_prompt]: Epoch 31 / 100: avg data time: 5.61e-02, avg batch time: 0.4989, average train loss: 1.5031
[09/26 01:55:47 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.1673, average loss: 1.4354
[09/26 01:55:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 75.35	
[09/26 01:55:47 visual_prompt]: Training 32 / 100 epoch, with learning rate 2.178931031846743
[09/26 01:55:54 visual_prompt]: Epoch 32 / 100: avg data time: 4.85e-02, avg batch time: 0.4934, average train loss: 1.1865
[09/26 01:55:56 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1670, average loss: 0.7109
[09/26 01:55:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 74.01	
[09/26 01:55:56 visual_prompt]: Training 33 / 100 epoch, with learning rate 2.149174750423314
[09/26 01:56:02 visual_prompt]: Epoch 33 / 100: avg data time: 5.00e-02, avg batch time: 0.4947, average train loss: 0.8428
[09/26 01:56:04 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1670, average loss: 0.7399
[09/26 01:56:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 72.52	
[09/26 01:56:04 visual_prompt]: Training 34 / 100 epoch, with learning rate 2.1183229630737466
[09/26 01:56:11 visual_prompt]: Epoch 34 / 100: avg data time: 6.08e-02, avg batch time: 0.5053, average train loss: 1.1266
[09/26 01:56:12 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1672, average loss: 1.9257
[09/26 01:56:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 82.77	
[09/26 01:56:12 visual_prompt]: Training 35 / 100 epoch, with learning rate 2.086413257948573
[09/26 01:56:19 visual_prompt]: Epoch 35 / 100: avg data time: 6.19e-02, avg batch time: 0.5048, average train loss: 1.0971
[09/26 01:56:21 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1670, average loss: 1.1822
[09/26 01:56:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 65.01	
[09/26 01:56:21 visual_prompt]: Training 36 / 100 epoch, with learning rate 2.053484512108174
[09/26 01:56:28 visual_prompt]: Epoch 36 / 100: avg data time: 6.13e-02, avg batch time: 0.5049, average train loss: 0.7459
[09/26 01:56:29 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1677, average loss: 0.6966
[09/26 01:56:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.87	
[09/26 01:56:29 visual_prompt]: Training 37 / 100 epoch, with learning rate 2.019576844157073
[09/26 01:56:36 visual_prompt]: Epoch 37 / 100: avg data time: 6.48e-02, avg batch time: 0.5079, average train loss: 0.7420
[09/26 01:56:37 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1672, average loss: 0.6930
[09/26 01:56:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.09	
[09/26 01:56:37 visual_prompt]: Training 38 / 100 epoch, with learning rate 1.9847315653655915
[09/26 01:56:44 visual_prompt]: Epoch 38 / 100: avg data time: 5.94e-02, avg batch time: 0.5039, average train loss: 0.7412
[09/26 01:56:46 visual_prompt]: Inference (val):avg data time: 2.23e-05, avg batch time: 0.1674, average loss: 0.6709
[09/26 01:56:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.23	
[09/26 01:56:46 visual_prompt]: Training 39 / 100 epoch, with learning rate 1.9489911293384334
[09/26 01:56:52 visual_prompt]: Epoch 39 / 100: avg data time: 5.25e-02, avg batch time: 0.4966, average train loss: 1.1779
[09/26 01:56:54 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.1669, average loss: 1.3712
[09/26 01:56:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 67.32	
[09/26 01:56:54 visual_prompt]: Training 40 / 100 epoch, with learning rate 1.912399080291506
[09/26 01:57:01 visual_prompt]: Epoch 40 / 100: avg data time: 6.65e-02, avg batch time: 0.5107, average train loss: 0.8828
[09/26 01:57:02 visual_prompt]: Inference (val):avg data time: 3.14e-05, avg batch time: 0.1676, average loss: 0.6887
[09/26 01:57:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.73	
[09/26 01:57:02 visual_prompt]: Training 41 / 100 epoch, with learning rate 1.875
[09/26 01:57:09 visual_prompt]: Epoch 41 / 100: avg data time: 7.39e-02, avg batch time: 0.5173, average train loss: 0.7330
[09/26 01:57:10 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1671, average loss: 0.8020
[09/26 01:57:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.39	
[09/26 01:57:10 visual_prompt]: Training 42 / 100 epoch, with learning rate 1.8368394534823635
[09/26 01:57:17 visual_prompt]: Epoch 42 / 100: avg data time: 5.06e-02, avg batch time: 0.4954, average train loss: 0.8010
[09/26 01:57:19 visual_prompt]: Inference (val):avg data time: 2.10e-05, avg batch time: 0.1673, average loss: 0.9593
[09/26 01:57:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 73.05	
[09/26 01:57:19 visual_prompt]: Training 43 / 100 epoch, with learning rate 1.7979639334863466
[09/26 01:57:26 visual_prompt]: Epoch 43 / 100: avg data time: 6.19e-02, avg batch time: 0.5051, average train loss: 0.8901
[09/26 01:57:27 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1674, average loss: 0.8636
[09/26 01:57:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.27	
[09/26 01:57:27 visual_prompt]: Training 44 / 100 epoch, with learning rate 1.7584208038447504
[09/26 01:57:34 visual_prompt]: Epoch 44 / 100: avg data time: 4.14e-02, avg batch time: 0.4859, average train loss: 0.9867
[09/26 01:57:35 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.1668, average loss: 0.7804
[09/26 01:57:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 68.56	
[09/26 01:57:35 visual_prompt]: Training 45 / 100 epoch, with learning rate 1.7182582417698902
[09/26 01:57:42 visual_prompt]: Epoch 45 / 100: avg data time: 5.83e-02, avg batch time: 0.5025, average train loss: 0.7412
[09/26 01:57:43 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1671, average loss: 0.8445
[09/26 01:57:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 76.93	
[09/26 01:57:43 visual_prompt]: Training 46 / 100 epoch, with learning rate 1.6775251791570862
[09/26 01:57:50 visual_prompt]: Epoch 46 / 100: avg data time: 5.03e-02, avg batch time: 0.4952, average train loss: 0.8086
[09/26 01:57:51 visual_prompt]: Inference (val):avg data time: 2.23e-05, avg batch time: 0.1673, average loss: 0.6449
[09/26 01:57:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 81.23	
[09/26 01:57:51 visual_prompt]: Training 47 / 100 epoch, with learning rate 1.6362712429686843
[09/26 01:57:58 visual_prompt]: Epoch 47 / 100: avg data time: 5.52e-02, avg batch time: 0.4997, average train loss: 0.7055
[09/26 01:57:59 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1675, average loss: 0.5829
[09/26 01:57:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 69.00	rocauc: 81.68	
[09/26 01:57:59 visual_prompt]: Training 48 / 100 epoch, with learning rate 1.5945466947712488
[09/26 01:58:06 visual_prompt]: Epoch 48 / 100: avg data time: 4.04e-02, avg batch time: 0.4855, average train loss: 0.7101
[09/26 01:58:08 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.1673, average loss: 0.6372
[09/26 01:58:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.00	rocauc: 88.42	
[09/26 01:58:08 visual_prompt]: Training 49 / 100 epoch, with learning rate 1.5524023694995845
[09/26 01:58:14 visual_prompt]: Epoch 49 / 100: avg data time: 3.95e-02, avg batch time: 0.4839, average train loss: 0.7233
[09/26 01:58:16 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1672, average loss: 0.6418
[09/26 01:58:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 88.97	
[09/26 01:58:16 visual_prompt]: Training 50 / 100 epoch, with learning rate 1.509889613522199
[09/26 01:58:22 visual_prompt]: Epoch 50 / 100: avg data time: 5.55e-02, avg batch time: 0.4999, average train loss: 0.6441
[09/26 01:58:24 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1674, average loss: 0.5984
[09/26 01:58:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.00	rocauc: 89.58	
[09/26 01:58:24 visual_prompt]: Training 51 / 100 epoch, with learning rate 1.467060222083663
[09/26 01:58:30 visual_prompt]: Epoch 51 / 100: avg data time: 5.03e-02, avg batch time: 0.4942, average train loss: 0.9340
[09/26 01:58:32 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1672, average loss: 0.6934
[09/26 01:58:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 80.75	
[09/26 01:58:32 visual_prompt]: Training 52 / 100 epoch, with learning rate 1.4239663762000818
[09/26 01:58:39 visual_prompt]: Epoch 52 / 100: avg data time: 4.73e-02, avg batch time: 0.4923, average train loss: 0.7183
[09/26 01:58:40 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1673, average loss: 0.7469
[09/26 01:58:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 79.69	
[09/26 01:58:40 visual_prompt]: Training 53 / 100 epoch, with learning rate 1.380660579084567
[09/26 01:58:47 visual_prompt]: Epoch 53 / 100: avg data time: 4.56e-02, avg batch time: 0.4918, average train loss: 0.7278
[09/26 01:58:48 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1673, average loss: 0.7340
[09/26 01:58:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.07	
[09/26 01:58:48 visual_prompt]: Training 54 / 100 epoch, with learning rate 1.3371955921801564
[09/26 01:58:55 visual_prompt]: Epoch 54 / 100: avg data time: 4.45e-02, avg batch time: 0.4888, average train loss: 0.6846
[09/26 01:58:56 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1675, average loss: 0.6902
[09/26 01:58:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 49.50	rocauc: 85.07	
[09/26 01:58:56 visual_prompt]: Training 55 / 100 epoch, with learning rate 1.2936243708781263
[09/26 01:59:03 visual_prompt]: Epoch 55 / 100: avg data time: 4.57e-02, avg batch time: 0.4898, average train loss: 0.6420
[09/26 01:59:04 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1674, average loss: 0.5413
[09/26 01:59:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.50	rocauc: 88.37	
[09/26 01:59:04 visual_prompt]: Training 56 / 100 epoch, with learning rate 1.25
[09/26 01:59:11 visual_prompt]: Epoch 56 / 100: avg data time: 5.53e-02, avg batch time: 0.4996, average train loss: 0.6192
[09/26 01:59:12 visual_prompt]: Inference (val):avg data time: 3.04e-05, avg batch time: 0.1678, average loss: 0.5078
[09/26 01:59:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 88.11	
[09/26 01:59:12 visual_prompt]: Training 57 / 100 epoch, with learning rate 1.2063756291218741
[09/26 01:59:19 visual_prompt]: Epoch 57 / 100: avg data time: 6.33e-02, avg batch time: 0.5084, average train loss: 0.7861
[09/26 01:59:21 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1675, average loss: 1.7960
[09/26 01:59:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.04	
[09/26 01:59:21 visual_prompt]: Training 58 / 100 epoch, with learning rate 1.1628044078198434
[09/26 01:59:28 visual_prompt]: Epoch 58 / 100: avg data time: 5.89e-02, avg batch time: 0.5040, average train loss: 0.9537
[09/26 01:59:29 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1673, average loss: 0.8359
[09/26 01:59:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 88.06	
[09/26 01:59:29 visual_prompt]: Training 59 / 100 epoch, with learning rate 1.1193394209154333
[09/26 01:59:36 visual_prompt]: Epoch 59 / 100: avg data time: 5.72e-02, avg batch time: 0.5016, average train loss: 0.7543
[09/26 01:59:37 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1672, average loss: 0.7304
[09/26 01:59:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 87.75	
[09/26 01:59:37 visual_prompt]: Training 60 / 100 epoch, with learning rate 1.0760336237999186
[09/26 01:59:44 visual_prompt]: Epoch 60 / 100: avg data time: 6.49e-02, avg batch time: 0.5081, average train loss: 0.9209
[09/26 01:59:46 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1668, average loss: 1.3567
[09/26 01:59:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.02	
[09/26 01:59:46 visual_prompt]: Training 61 / 100 epoch, with learning rate 1.0329397779163372
[09/26 01:59:53 visual_prompt]: Epoch 61 / 100: avg data time: 4.20e-02, avg batch time: 0.4863, average train loss: 1.1048
[09/26 01:59:54 visual_prompt]: Inference (val):avg data time: 3.19e-05, avg batch time: 0.1674, average loss: 0.6482
[09/26 01:59:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 64.50	rocauc: 82.88	
[09/26 01:59:54 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.990110386477801
[09/26 02:00:01 visual_prompt]: Epoch 62 / 100: avg data time: 6.20e-02, avg batch time: 0.5057, average train loss: 0.7192
[09/26 02:00:02 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1673, average loss: 0.8692
[09/26 02:00:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.10	
[09/26 02:00:02 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.9475976305004155
[09/26 02:00:09 visual_prompt]: Epoch 63 / 100: avg data time: 4.50e-02, avg batch time: 0.4909, average train loss: 0.7853
[09/26 02:00:10 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1673, average loss: 0.8588
[09/26 02:00:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 55.50	rocauc: 88.38	
[09/26 02:00:10 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.9054533052287511
[09/26 02:00:17 visual_prompt]: Epoch 64 / 100: avg data time: 5.59e-02, avg batch time: 0.4989, average train loss: 0.8373
[09/26 02:00:19 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1673, average loss: 0.9050
[09/26 02:00:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 88.27	
[09/26 02:00:19 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.8637287570313158
[09/26 02:00:25 visual_prompt]: Epoch 65 / 100: avg data time: 4.46e-02, avg batch time: 0.4891, average train loss: 0.7996
[09/26 02:00:27 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.1671, average loss: 0.6126
[09/26 02:00:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 63.50	rocauc: 89.52	
[09/26 02:00:27 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.8224748208429142
[09/26 02:00:33 visual_prompt]: Epoch 66 / 100: avg data time: 5.45e-02, avg batch time: 0.4984, average train loss: 0.6882
[09/26 02:00:35 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1673, average loss: 0.7175
[09/26 02:00:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 88.22	
[09/26 02:00:35 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.7817417582301099
[09/26 02:00:41 visual_prompt]: Epoch 67 / 100: avg data time: 4.23e-02, avg batch time: 0.4868, average train loss: 0.6809
[09/26 02:00:43 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1671, average loss: 0.5069
[09/26 02:00:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.00	rocauc: 90.57	
[09/26 02:00:43 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.7415791961552499
[09/26 02:00:50 visual_prompt]: Epoch 68 / 100: avg data time: 4.01e-02, avg batch time: 0.4849, average train loss: 0.6793
[09/26 02:00:51 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.1672, average loss: 0.5978
[09/26 02:00:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.00	rocauc: 90.15	
[09/26 02:00:51 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.7020360665136531
[09/26 02:00:58 visual_prompt]: Epoch 69 / 100: avg data time: 4.51e-02, avg batch time: 0.4915, average train loss: 0.6141
[09/26 02:00:59 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1673, average loss: 0.7724
[09/26 02:00:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 54.00	rocauc: 92.21	
[09/26 02:00:59 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.6631605465176369
[09/26 02:01:06 visual_prompt]: Epoch 70 / 100: avg data time: 5.12e-02, avg batch time: 0.4957, average train loss: 0.6175
[09/26 02:01:07 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.1674, average loss: 0.5181
[09/26 02:01:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 71.50	rocauc: 90.09	
[09/26 02:01:07 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.6250000000000002
[09/26 02:01:14 visual_prompt]: Epoch 71 / 100: avg data time: 4.98e-02, avg batch time: 0.4951, average train loss: 0.5704
[09/26 02:01:15 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1672, average loss: 0.5073
[09/26 02:01:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.00	rocauc: 93.35	
[09/26 02:01:15 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.587600919708494
[09/26 02:01:22 visual_prompt]: Epoch 72 / 100: avg data time: 5.35e-02, avg batch time: 0.4981, average train loss: 0.6168
[09/26 02:01:24 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.1676, average loss: 0.4345
[09/26 02:01:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.41	
[09/26 02:01:24 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.5510088706615667
[09/26 02:01:30 visual_prompt]: Epoch 73 / 100: avg data time: 4.73e-02, avg batch time: 0.4925, average train loss: 0.5221
[09/26 02:01:32 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1676, average loss: 0.4152
[09/26 02:01:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 90.70	
[09/26 02:01:32 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.5152684346344087
[09/26 02:01:39 visual_prompt]: Epoch 74 / 100: avg data time: 5.72e-02, avg batch time: 0.5011, average train loss: 0.6216
[09/26 02:01:40 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1675, average loss: 0.5067
[09/26 02:01:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.50	rocauc: 91.52	
[09/26 02:01:40 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.48042315584292716
[09/26 02:01:47 visual_prompt]: Epoch 75 / 100: avg data time: 4.34e-02, avg batch time: 0.4899, average train loss: 0.5207
[09/26 02:01:48 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1675, average loss: 0.4475
[09/26 02:01:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.35	
[09/26 02:01:48 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.4465154878918258
[09/26 02:01:55 visual_prompt]: Epoch 76 / 100: avg data time: 4.86e-02, avg batch time: 0.4931, average train loss: 0.5719
[09/26 02:01:56 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1675, average loss: 0.4245
[09/26 02:01:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.64	
[09/26 02:01:56 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.41358674205142765
[09/26 02:02:03 visual_prompt]: Epoch 77 / 100: avg data time: 4.21e-02, avg batch time: 0.4879, average train loss: 0.5546
[09/26 02:02:04 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1678, average loss: 0.4342
[09/26 02:02:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.71	
[09/26 02:02:04 visual_prompt]: Best epoch 77: best metric: 0.860
[09/26 02:02:04 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.3816770369262533
[09/26 02:02:11 visual_prompt]: Epoch 78 / 100: avg data time: 4.56e-02, avg batch time: 0.4895, average train loss: 0.4812
[09/26 02:02:12 visual_prompt]: Inference (val):avg data time: 3.15e-05, avg batch time: 0.1677, average loss: 0.6010
[09/26 02:02:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.00	rocauc: 85.03	
[09/26 02:02:12 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.35082524957668626
[09/26 02:02:19 visual_prompt]: Epoch 79 / 100: avg data time: 5.48e-02, avg batch time: 0.4990, average train loss: 0.5316
[09/26 02:02:21 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1673, average loss: 0.4306
[09/26 02:02:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 90.27	
[09/26 02:02:21 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.32106896815325703
[09/26 02:02:27 visual_prompt]: Epoch 80 / 100: avg data time: 4.68e-02, avg batch time: 0.4927, average train loss: 0.4668
[09/26 02:02:29 visual_prompt]: Inference (val):avg data time: 3.42e-05, avg batch time: 0.1676, average loss: 0.4038
[09/26 02:02:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.71	
[09/26 02:02:29 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.2924444461012776
[09/26 02:02:35 visual_prompt]: Epoch 81 / 100: avg data time: 5.07e-02, avg batch time: 0.4948, average train loss: 0.4430
[09/26 02:02:37 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1676, average loss: 0.6519
[09/26 02:02:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.50	rocauc: 92.37	
[09/26 02:02:37 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.26498655799159765
[09/26 02:02:44 visual_prompt]: Epoch 82 / 100: avg data time: 5.91e-02, avg batch time: 0.5045, average train loss: 0.5299
[09/26 02:02:45 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1674, average loss: 0.4178
[09/26 02:02:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.34	
[09/26 02:02:45 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.23872875703131582
[09/26 02:02:52 visual_prompt]: Epoch 83 / 100: avg data time: 5.01e-02, avg batch time: 0.4951, average train loss: 0.4126
[09/26 02:02:54 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1673, average loss: 0.4561
[09/26 02:02:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.00	rocauc: 90.82	
[09/26 02:02:54 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.21370303430619797
[09/26 02:03:00 visual_prompt]: Epoch 84 / 100: avg data time: 6.08e-02, avg batch time: 0.5045, average train loss: 0.4519
[09/26 02:03:02 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1673, average loss: 0.3757
[09/26 02:03:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.92	
[09/26 02:03:02 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.18993987980446755
[09/26 02:03:09 visual_prompt]: Epoch 85 / 100: avg data time: 4.93e-02, avg batch time: 0.4946, average train loss: 0.4272
[09/26 02:03:10 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1670, average loss: 0.3854
[09/26 02:03:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.78	
[09/26 02:03:10 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.16746824526945162
[09/26 02:03:17 visual_prompt]: Epoch 86 / 100: avg data time: 4.89e-02, avg batch time: 0.4925, average train loss: 0.3891
[09/26 02:03:19 visual_prompt]: Inference (val):avg data time: 2.98e-05, avg batch time: 0.1675, average loss: 0.3834
[09/26 02:03:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.60	
[09/26 02:03:19 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.14631550892634126
[09/26 02:03:25 visual_prompt]: Epoch 87 / 100: avg data time: 6.69e-02, avg batch time: 0.5103, average train loss: 0.3802
[09/26 02:03:27 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1673, average loss: 0.3802
[09/26 02:03:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.12	
[09/26 02:03:27 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.12650744212604148
[09/26 02:03:34 visual_prompt]: Epoch 88 / 100: avg data time: 6.74e-02, avg batch time: 0.5111, average train loss: 0.3597
[09/26 02:03:35 visual_prompt]: Inference (val):avg data time: 3.21e-05, avg batch time: 0.1676, average loss: 0.4231
[09/26 02:03:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 92.99	
[09/26 02:03:35 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.10806817794674878
[09/26 02:03:42 visual_prompt]: Epoch 89 / 100: avg data time: 5.83e-02, avg batch time: 0.5020, average train loss: 0.3624
[09/26 02:03:44 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1672, average loss: 0.4005
[09/26 02:03:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 90.89	
[09/26 02:03:44 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.09102018179151586
[09/26 02:03:50 visual_prompt]: Epoch 90 / 100: avg data time: 5.51e-02, avg batch time: 0.4991, average train loss: 0.3602
[09/26 02:03:52 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1676, average loss: 0.3837
[09/26 02:03:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.67	
[09/26 02:03:52 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.0753842240176146
[09/26 02:03:59 visual_prompt]: Epoch 91 / 100: avg data time: 7.34e-02, avg batch time: 0.5169, average train loss: 0.3569
[09/26 02:04:00 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1674, average loss: 0.3759
[09/26 02:04:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.52	
[09/26 02:04:00 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.061179354631058086
[09/26 02:04:07 visual_prompt]: Epoch 92 / 100: avg data time: 4.46e-02, avg batch time: 0.4912, average train loss: 0.3546
[09/26 02:04:08 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1677, average loss: 0.4050
[09/26 02:04:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.62	
[09/26 02:04:08 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.04842288007710138
[09/26 02:04:15 visual_prompt]: Epoch 93 / 100: avg data time: 7.47e-02, avg batch time: 0.5184, average train loss: 0.3261
[09/26 02:04:17 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1672, average loss: 0.3819
[09/26 02:04:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 90.27	
[09/26 02:04:17 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.03713034215500441
[09/26 02:04:23 visual_prompt]: Epoch 94 / 100: avg data time: 4.94e-02, avg batch time: 0.4937, average train loss: 0.3288
[09/26 02:04:25 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1673, average loss: 0.3914
[09/26 02:04:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 90.42	
[09/26 02:04:25 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.02731549908274289
[09/26 02:04:31 visual_prompt]: Epoch 95 / 100: avg data time: 4.76e-02, avg batch time: 0.4916, average train loss: 0.2967
[09/26 02:04:33 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1674, average loss: 0.3880
[09/26 02:04:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.47	
[09/26 02:04:33 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.018990308734739975
[09/26 02:04:40 visual_prompt]: Epoch 96 / 100: avg data time: 4.69e-02, avg batch time: 0.4925, average train loss: 0.2746
[09/26 02:04:41 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1673, average loss: 0.4265
[09/26 02:04:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.50	rocauc: 89.54	
[09/26 02:04:41 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.012164914073037048
[09/26 02:04:48 visual_prompt]: Epoch 97 / 100: avg data time: 4.89e-02, avg batch time: 0.4939, average train loss: 0.2551
[09/26 02:04:49 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1676, average loss: 0.4395
[09/26 02:04:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 89.67	
[09/26 02:04:49 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.006847630789658388
[09/26 02:04:56 visual_prompt]: Epoch 98 / 100: avg data time: 4.41e-02, avg batch time: 0.4897, average train loss: 0.2519
[09/26 02:04:57 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1675, average loss: 0.4424
[09/26 02:04:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.50	rocauc: 89.41	
[09/26 02:04:57 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.003044937175219753
[09/26 02:05:04 visual_prompt]: Epoch 99 / 100: avg data time: 3.94e-02, avg batch time: 0.4851, average train loss: 0.2377
[09/26 02:05:05 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1674, average loss: 0.4477
[09/26 02:05:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 89.44	
[09/26 02:05:05 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0007614662261302974
[09/26 02:05:12 visual_prompt]: Epoch 100 / 100: avg data time: 3.91e-02, avg batch time: 0.4846, average train loss: 0.2349
[09/26 02:05:13 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1674, average loss: 0.4481
[09/26 02:05:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 89.43	
[09/26 02:05:13 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 02:05:13 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 02:05:13 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 02:05:13 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 02:05:13 visual_prompt]: Training with config:
[09/26 02:05:13 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr2.5_wd0.0001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 2.5, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 02:05:13 visual_prompt]: Loading training data...
[09/26 02:05:13 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 02:05:14 visual_prompt]: Number of images: 800
[09/26 02:05:14 visual_prompt]: Number of classes: 2 / 2
[09/26 02:05:14 visual_prompt]: Loading validation data...
[09/26 02:05:14 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 02:05:15 visual_prompt]: Number of images: 200
[09/26 02:05:15 visual_prompt]: Number of classes: 2 / 2
[09/26 02:05:15 visual_prompt]: Constructing models...
[09/26 02:05:17 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 02:05:17 visual_prompt]: tuned percent:0.536
[09/26 02:05:17 visual_prompt]: Device used for model: 0
[09/26 02:05:17 visual_prompt]: Setting up Evaluator...
[09/26 02:05:17 visual_prompt]: Setting up Trainer...
[09/26 02:05:17 visual_prompt]: 	Setting up the optimizer...
[09/26 02:05:17 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 02:05:24 visual_prompt]: Epoch 1 / 100: avg data time: 4.75e-02, avg batch time: 0.4913, average train loss: 1.9702
[09/26 02:05:26 visual_prompt]: Inference (val):avg data time: 2.04e-05, avg batch time: 0.1668, average loss: 2.0033
[09/26 02:05:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 02:05:26 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 02:05:26 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.25
[09/26 02:05:32 visual_prompt]: Epoch 2 / 100: avg data time: 4.78e-02, avg batch time: 0.4931, average train loss: 5.9729
[09/26 02:05:34 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1668, average loss: 1.1754
[09/26 02:05:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 43.24	
[09/26 02:05:34 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.5
[09/26 02:05:40 visual_prompt]: Epoch 3 / 100: avg data time: 6.07e-02, avg batch time: 0.5049, average train loss: 1.1671
[09/26 02:05:42 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.1668, average loss: 1.1467
[09/26 02:05:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.79	
[09/26 02:05:42 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.75
[09/26 02:05:49 visual_prompt]: Epoch 4 / 100: avg data time: 6.05e-02, avg batch time: 0.5036, average train loss: 1.1667
[09/26 02:05:50 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1669, average loss: 1.4384
[09/26 02:05:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.14	
[09/26 02:05:50 visual_prompt]: Training 5 / 100 epoch, with learning rate 1.0
[09/26 02:05:57 visual_prompt]: Epoch 5 / 100: avg data time: 6.41e-02, avg batch time: 0.5068, average train loss: 1.0165
[09/26 02:05:58 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1670, average loss: 1.2126
[09/26 02:05:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 88.77	
[09/26 02:05:58 visual_prompt]: Training 6 / 100 epoch, with learning rate 1.25
[09/26 02:06:05 visual_prompt]: Epoch 6 / 100: avg data time: 4.38e-02, avg batch time: 0.4874, average train loss: 1.2489
[09/26 02:06:07 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1671, average loss: 0.6322
[09/26 02:06:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 88.95	
[09/26 02:06:07 visual_prompt]: Training 7 / 100 epoch, with learning rate 1.5
[09/26 02:06:13 visual_prompt]: Epoch 7 / 100: avg data time: 5.35e-02, avg batch time: 0.4967, average train loss: 1.2808
[09/26 02:06:15 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1670, average loss: 0.5346
[09/26 02:06:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 89.91	
[09/26 02:06:15 visual_prompt]: Best epoch 7: best metric: 0.820
[09/26 02:06:15 visual_prompt]: Training 8 / 100 epoch, with learning rate 1.75
[09/26 02:06:21 visual_prompt]: Epoch 8 / 100: avg data time: 4.60e-02, avg batch time: 0.4914, average train loss: 1.5012
[09/26 02:06:23 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1675, average loss: 1.0592
[09/26 02:06:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 61.00	rocauc: 91.81	
[09/26 02:06:23 visual_prompt]: Training 9 / 100 epoch, with learning rate 2.0
[09/26 02:06:30 visual_prompt]: Epoch 9 / 100: avg data time: 5.29e-02, avg batch time: 0.4972, average train loss: 0.7738
[09/26 02:06:31 visual_prompt]: Inference (val):avg data time: 2.17e-05, avg batch time: 0.1669, average loss: 1.0398
[09/26 02:06:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 89.67	
[09/26 02:06:31 visual_prompt]: Training 10 / 100 epoch, with learning rate 2.25
[09/26 02:06:38 visual_prompt]: Epoch 10 / 100: avg data time: 4.98e-02, avg batch time: 0.4932, average train loss: 0.9238
[09/26 02:06:39 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1671, average loss: 0.4308
[09/26 02:06:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 91.57	
[09/26 02:06:39 visual_prompt]: Training 11 / 100 epoch, with learning rate 2.5
[09/26 02:06:46 visual_prompt]: Epoch 11 / 100: avg data time: 5.86e-02, avg batch time: 0.5022, average train loss: 0.7543
[09/26 02:06:47 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1671, average loss: 0.8495
[09/26 02:06:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 64.50	rocauc: 92.33	
[09/26 02:06:47 visual_prompt]: Training 12 / 100 epoch, with learning rate 2.4992385337738696
[09/26 02:06:54 visual_prompt]: Epoch 12 / 100: avg data time: 5.72e-02, avg batch time: 0.5012, average train loss: 0.7260
[09/26 02:06:56 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1674, average loss: 0.6550
[09/26 02:06:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.00	rocauc: 92.17	
[09/26 02:06:56 visual_prompt]: Training 13 / 100 epoch, with learning rate 2.4969550628247803
[09/26 02:07:02 visual_prompt]: Epoch 13 / 100: avg data time: 6.03e-02, avg batch time: 0.5036, average train loss: 0.6789
[09/26 02:07:04 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1673, average loss: 1.7831
[09/26 02:07:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 88.73	
[09/26 02:07:04 visual_prompt]: Training 14 / 100 epoch, with learning rate 2.4931523692103417
[09/26 02:07:11 visual_prompt]: Epoch 14 / 100: avg data time: 5.20e-02, avg batch time: 0.4955, average train loss: 1.2144
[09/26 02:07:12 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1672, average loss: 0.5643
[09/26 02:07:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.94	
[09/26 02:07:12 visual_prompt]: Training 15 / 100 epoch, with learning rate 2.487835085926963
[09/26 02:07:19 visual_prompt]: Epoch 15 / 100: avg data time: 4.86e-02, avg batch time: 0.4941, average train loss: 1.6965
[09/26 02:07:21 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1670, average loss: 0.5985
[09/26 02:07:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.00	rocauc: 93.17	
[09/26 02:07:21 visual_prompt]: Training 16 / 100 epoch, with learning rate 2.4810096912652604
[09/26 02:07:27 visual_prompt]: Epoch 16 / 100: avg data time: 5.08e-02, avg batch time: 0.4951, average train loss: 1.4034
[09/26 02:07:29 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1672, average loss: 0.3786
[09/26 02:07:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.50	
[09/26 02:07:29 visual_prompt]: Best epoch 16: best metric: 0.830
[09/26 02:07:29 visual_prompt]: Training 17 / 100 epoch, with learning rate 2.472684500917257
[09/26 02:07:36 visual_prompt]: Epoch 17 / 100: avg data time: 4.43e-02, avg batch time: 0.4891, average train loss: 0.7508
[09/26 02:07:37 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1672, average loss: 0.4898
[09/26 02:07:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.72	
[09/26 02:07:37 visual_prompt]: Training 18 / 100 epoch, with learning rate 2.4628696578449953
[09/26 02:07:44 visual_prompt]: Epoch 18 / 100: avg data time: 4.68e-02, avg batch time: 0.4912, average train loss: 0.5039
[09/26 02:07:45 visual_prompt]: Inference (val):avg data time: 2.92e-05, avg batch time: 0.1676, average loss: 0.3417
[09/26 02:07:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.30	
[09/26 02:07:45 visual_prompt]: Best epoch 18: best metric: 0.855
[09/26 02:07:45 visual_prompt]: Training 19 / 100 epoch, with learning rate 2.4515771199228986
[09/26 02:07:52 visual_prompt]: Epoch 19 / 100: avg data time: 5.77e-02, avg batch time: 0.5011, average train loss: 0.7408
[09/26 02:07:53 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1677, average loss: 0.4956
[09/26 02:07:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 93.91	
[09/26 02:07:53 visual_prompt]: Training 20 / 100 epoch, with learning rate 2.438820645368942
[09/26 02:08:00 visual_prompt]: Epoch 20 / 100: avg data time: 5.34e-02, avg batch time: 0.4966, average train loss: 0.7851
[09/26 02:08:02 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1670, average loss: 0.4131
[09/26 02:08:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.16	
[09/26 02:08:02 visual_prompt]: Training 21 / 100 epoch, with learning rate 2.4246157759823856
[09/26 02:08:08 visual_prompt]: Epoch 21 / 100: avg data time: 5.72e-02, avg batch time: 0.5008, average train loss: 0.4799
[09/26 02:08:10 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1673, average loss: 1.1676
[09/26 02:08:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 59.50	rocauc: 89.89	
[09/26 02:08:10 visual_prompt]: Training 22 / 100 epoch, with learning rate 2.4089798182084845
[09/26 02:08:17 visual_prompt]: Epoch 22 / 100: avg data time: 5.31e-02, avg batch time: 0.4970, average train loss: 0.6741
[09/26 02:08:18 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1673, average loss: 0.3779
[09/26 02:08:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.63	
[09/26 02:08:18 visual_prompt]: Training 23 / 100 epoch, with learning rate 2.391931822053251
[09/26 02:08:25 visual_prompt]: Epoch 23 / 100: avg data time: 6.18e-02, avg batch time: 0.5048, average train loss: 0.5231
[09/26 02:08:26 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1669, average loss: 0.6463
[09/26 02:08:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 92.54	
[09/26 02:08:26 visual_prompt]: Training 24 / 100 epoch, with learning rate 2.3734925578739587
[09/26 02:08:33 visual_prompt]: Epoch 24 / 100: avg data time: 6.34e-02, avg batch time: 0.5068, average train loss: 0.7542
[09/26 02:08:35 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1673, average loss: 0.5161
[09/26 02:08:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.50	rocauc: 93.10	
[09/26 02:08:35 visual_prompt]: Training 25 / 100 epoch, with learning rate 2.3536844910736585
[09/26 02:08:42 visual_prompt]: Epoch 25 / 100: avg data time: 5.72e-02, avg batch time: 0.5013, average train loss: 0.5613
[09/26 02:08:43 visual_prompt]: Inference (val):avg data time: 3.87e-05, avg batch time: 0.1679, average loss: 0.7961
[09/26 02:08:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 93.60	
[09/26 02:08:43 visual_prompt]: Training 26 / 100 epoch, with learning rate 2.3325317547305486
[09/26 02:08:50 visual_prompt]: Epoch 26 / 100: avg data time: 5.62e-02, avg batch time: 0.5016, average train loss: 0.3811
[09/26 02:08:51 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1675, average loss: 0.4702
[09/26 02:08:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 90.21	
[09/26 02:08:51 visual_prompt]: Training 27 / 100 epoch, with learning rate 2.310060120195532
[09/26 02:08:58 visual_prompt]: Epoch 27 / 100: avg data time: 5.26e-02, avg batch time: 0.4970, average train loss: 0.3471
[09/26 02:09:00 visual_prompt]: Inference (val):avg data time: 2.17e-05, avg batch time: 0.1672, average loss: 0.3839
[09/26 02:09:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 90.67	
[09/26 02:09:00 visual_prompt]: Training 28 / 100 epoch, with learning rate 2.286296965693802
[09/26 02:09:06 visual_prompt]: Epoch 28 / 100: avg data time: 5.18e-02, avg batch time: 0.4955, average train loss: 0.3012
[09/26 02:09:08 visual_prompt]: Inference (val):avg data time: 2.06e-05, avg batch time: 0.1675, average loss: 0.4678
[09/26 02:09:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 91.20	
[09/26 02:09:08 visual_prompt]: Training 29 / 100 epoch, with learning rate 2.261271242968684
[09/26 02:09:15 visual_prompt]: Epoch 29 / 100: avg data time: 6.94e-02, avg batch time: 0.5126, average train loss: 0.2989
[09/26 02:09:16 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1672, average loss: 0.5289
[09/26 02:09:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.32	
[09/26 02:09:16 visual_prompt]: Training 30 / 100 epoch, with learning rate 2.2350134420084022
[09/26 02:09:23 visual_prompt]: Epoch 30 / 100: avg data time: 6.33e-02, avg batch time: 0.5066, average train loss: 0.3903
[09/26 02:09:24 visual_prompt]: Inference (val):avg data time: 2.05e-05, avg batch time: 0.1672, average loss: 0.3822
[09/26 02:09:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.71	
[09/26 02:09:24 visual_prompt]: Training 31 / 100 epoch, with learning rate 2.2075555538987226
[09/26 02:09:31 visual_prompt]: Epoch 31 / 100: avg data time: 4.42e-02, avg batch time: 0.4882, average train loss: 0.3801
[09/26 02:09:33 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1676, average loss: 0.3894
[09/26 02:09:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.91	
[09/26 02:09:33 visual_prompt]: Training 32 / 100 epoch, with learning rate 2.178931031846743
[09/26 02:09:39 visual_prompt]: Epoch 32 / 100: avg data time: 5.52e-02, avg batch time: 0.4990, average train loss: 0.3241
[09/26 02:09:41 visual_prompt]: Inference (val):avg data time: 2.00e-05, avg batch time: 0.1673, average loss: 0.3782
[09/26 02:09:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.29	
[09/26 02:09:41 visual_prompt]: Best epoch 32: best metric: 0.860
[09/26 02:09:41 visual_prompt]: Training 33 / 100 epoch, with learning rate 2.149174750423314
[09/26 02:09:48 visual_prompt]: Epoch 33 / 100: avg data time: 5.70e-02, avg batch time: 0.5003, average train loss: 0.2822
[09/26 02:09:49 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.1670, average loss: 0.5496
[09/26 02:09:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 91.16	
[09/26 02:09:49 visual_prompt]: Training 34 / 100 epoch, with learning rate 2.1183229630737466
[09/26 02:09:56 visual_prompt]: Epoch 34 / 100: avg data time: 4.43e-02, avg batch time: 0.4876, average train loss: 0.4069
[09/26 02:09:57 visual_prompt]: Inference (val):avg data time: 2.01e-05, avg batch time: 0.1670, average loss: 0.3789
[09/26 02:09:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 93.39	
[09/26 02:09:57 visual_prompt]: Training 35 / 100 epoch, with learning rate 2.086413257948573
[09/26 02:10:04 visual_prompt]: Epoch 35 / 100: avg data time: 6.44e-02, avg batch time: 0.5082, average train loss: 0.4516
[09/26 02:10:06 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1673, average loss: 0.4728
[09/26 02:10:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.16	
[09/26 02:10:06 visual_prompt]: Training 36 / 100 epoch, with learning rate 2.053484512108174
[09/26 02:10:13 visual_prompt]: Epoch 36 / 100: avg data time: 6.75e-02, avg batch time: 0.5126, average train loss: 0.3606
[09/26 02:10:14 visual_prompt]: Inference (val):avg data time: 2.08e-05, avg batch time: 0.1675, average loss: 0.3933
[09/26 02:10:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.40	
[09/26 02:10:14 visual_prompt]: Training 37 / 100 epoch, with learning rate 2.019576844157073
[09/26 02:10:21 visual_prompt]: Epoch 37 / 100: avg data time: 6.23e-02, avg batch time: 0.5068, average train loss: 0.3501
[09/26 02:10:23 visual_prompt]: Inference (val):avg data time: 3.46e-05, avg batch time: 0.1674, average loss: 0.7462
[09/26 02:10:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 94.43	
[09/26 02:10:23 visual_prompt]: Training 38 / 100 epoch, with learning rate 1.9847315653655915
[09/26 02:10:29 visual_prompt]: Epoch 38 / 100: avg data time: 5.87e-02, avg batch time: 0.5022, average train loss: 0.4129
[09/26 02:10:31 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1676, average loss: 0.6647
[09/26 02:10:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 94.24	
[09/26 02:10:31 visual_prompt]: Training 39 / 100 epoch, with learning rate 1.9489911293384334
[09/26 02:10:38 visual_prompt]: Epoch 39 / 100: avg data time: 6.14e-02, avg batch time: 0.5056, average train loss: 0.2689
[09/26 02:10:39 visual_prompt]: Inference (val):avg data time: 2.14e-05, avg batch time: 0.1673, average loss: 0.6726
[09/26 02:10:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 94.69	
[09/26 02:10:39 visual_prompt]: Training 40 / 100 epoch, with learning rate 1.912399080291506
[09/26 02:10:46 visual_prompt]: Epoch 40 / 100: avg data time: 6.57e-02, avg batch time: 0.5107, average train loss: 0.3382
[09/26 02:10:48 visual_prompt]: Inference (val):avg data time: 2.10e-05, avg batch time: 0.1674, average loss: 0.3870
[09/26 02:10:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.77	
[09/26 02:10:48 visual_prompt]: Training 41 / 100 epoch, with learning rate 1.875
[09/26 02:10:54 visual_prompt]: Epoch 41 / 100: avg data time: 5.53e-02, avg batch time: 0.4991, average train loss: 0.1705
[09/26 02:10:56 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1671, average loss: 0.4264
[09/26 02:10:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 94.40	
[09/26 02:10:56 visual_prompt]: Training 42 / 100 epoch, with learning rate 1.8368394534823635
[09/26 02:11:03 visual_prompt]: Epoch 42 / 100: avg data time: 5.64e-02, avg batch time: 0.5016, average train loss: 0.1490
[09/26 02:11:04 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1672, average loss: 0.6226
[09/26 02:11:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 92.24	
[09/26 02:11:04 visual_prompt]: Training 43 / 100 epoch, with learning rate 1.7979639334863466
[09/26 02:11:11 visual_prompt]: Epoch 43 / 100: avg data time: 5.47e-02, avg batch time: 0.4985, average train loss: 0.1737
[09/26 02:11:12 visual_prompt]: Inference (val):avg data time: 2.10e-05, avg batch time: 0.1672, average loss: 0.3890
[09/26 02:11:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.74	
[09/26 02:11:12 visual_prompt]: Training 44 / 100 epoch, with learning rate 1.7584208038447504
[09/26 02:11:19 visual_prompt]: Epoch 44 / 100: avg data time: 4.64e-02, avg batch time: 0.4918, average train loss: 0.1519
[09/26 02:11:21 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.1675, average loss: 0.8778
[09/26 02:11:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 93.21	
[09/26 02:11:21 visual_prompt]: Training 45 / 100 epoch, with learning rate 1.7182582417698902
[09/26 02:11:27 visual_prompt]: Epoch 45 / 100: avg data time: 4.51e-02, avg batch time: 0.4892, average train loss: 0.1699
[09/26 02:11:29 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1674, average loss: 0.3369
[09/26 02:11:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.05	
[09/26 02:11:29 visual_prompt]: Training 46 / 100 epoch, with learning rate 1.6775251791570862
[09/26 02:11:35 visual_prompt]: Epoch 46 / 100: avg data time: 5.98e-02, avg batch time: 0.5042, average train loss: 0.1167
[09/26 02:11:37 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.1672, average loss: 0.7494
[09/26 02:11:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 94.39	
[09/26 02:11:37 visual_prompt]: Training 47 / 100 epoch, with learning rate 1.6362712429686843
[09/26 02:11:44 visual_prompt]: Epoch 47 / 100: avg data time: 6.74e-02, avg batch time: 0.5113, average train loss: 0.3213
[09/26 02:11:45 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1671, average loss: 0.3306
[09/26 02:11:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.26	
[09/26 02:11:45 visual_prompt]: Training 48 / 100 epoch, with learning rate 1.5945466947712488
[09/26 02:11:52 visual_prompt]: Epoch 48 / 100: avg data time: 7.57e-02, avg batch time: 0.5192, average train loss: 0.1621
[09/26 02:11:54 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1674, average loss: 0.4225
[09/26 02:11:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 94.47	
[09/26 02:11:54 visual_prompt]: Training 49 / 100 epoch, with learning rate 1.5524023694995845
[09/26 02:12:01 visual_prompt]: Epoch 49 / 100: avg data time: 5.75e-02, avg batch time: 0.5008, average train loss: 0.1138
[09/26 02:12:02 visual_prompt]: Inference (val):avg data time: 2.17e-05, avg batch time: 0.1672, average loss: 0.4978
[09/26 02:12:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.32	
[09/26 02:12:02 visual_prompt]: Training 50 / 100 epoch, with learning rate 1.509889613522199
[09/26 02:12:09 visual_prompt]: Epoch 50 / 100: avg data time: 5.78e-02, avg batch time: 0.5023, average train loss: 0.1104
[09/26 02:12:11 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.1672, average loss: 0.3768
[09/26 02:12:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 94.49	
[09/26 02:12:11 visual_prompt]: Best epoch 50: best metric: 0.895
[09/26 02:12:11 visual_prompt]: Training 51 / 100 epoch, with learning rate 1.467060222083663
[09/26 02:12:17 visual_prompt]: Epoch 51 / 100: avg data time: 5.15e-02, avg batch time: 0.4971, average train loss: 0.1001
[09/26 02:12:19 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1672, average loss: 0.5327
[09/26 02:12:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.53	
[09/26 02:12:19 visual_prompt]: Training 52 / 100 epoch, with learning rate 1.4239663762000818
[09/26 02:12:26 visual_prompt]: Epoch 52 / 100: avg data time: 5.67e-02, avg batch time: 0.5004, average train loss: 0.0657
[09/26 02:12:27 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1671, average loss: 0.5112
[09/26 02:12:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 94.52	
[09/26 02:12:27 visual_prompt]: Training 53 / 100 epoch, with learning rate 1.380660579084567
[09/26 02:12:34 visual_prompt]: Epoch 53 / 100: avg data time: 4.45e-02, avg batch time: 0.4881, average train loss: 0.1051
[09/26 02:12:36 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1674, average loss: 0.4872
[09/26 02:12:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.82	
[09/26 02:12:36 visual_prompt]: Training 54 / 100 epoch, with learning rate 1.3371955921801564
[09/26 02:12:42 visual_prompt]: Epoch 54 / 100: avg data time: 6.15e-02, avg batch time: 0.5060, average train loss: 0.0587
[09/26 02:12:44 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1674, average loss: 0.5870
[09/26 02:12:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.58	
[09/26 02:12:44 visual_prompt]: Training 55 / 100 epoch, with learning rate 1.2936243708781263
[09/26 02:12:51 visual_prompt]: Epoch 55 / 100: avg data time: 6.39e-02, avg batch time: 0.5083, average train loss: 0.0868
[09/26 02:12:52 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1675, average loss: 0.6217
[09/26 02:12:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.52	
[09/26 02:12:52 visual_prompt]: Training 56 / 100 epoch, with learning rate 1.25
[09/26 02:12:59 visual_prompt]: Epoch 56 / 100: avg data time: 5.08e-02, avg batch time: 0.4947, average train loss: 0.2141
[09/26 02:13:01 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1674, average loss: 0.3962
[09/26 02:13:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.62	
[09/26 02:13:01 visual_prompt]: Training 57 / 100 epoch, with learning rate 1.2063756291218741
[09/26 02:13:07 visual_prompt]: Epoch 57 / 100: avg data time: 5.71e-02, avg batch time: 0.5025, average train loss: 0.1078
[09/26 02:13:09 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1672, average loss: 0.6385
[09/26 02:13:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 94.20	
[09/26 02:13:09 visual_prompt]: Training 58 / 100 epoch, with learning rate 1.1628044078198434
[09/26 02:13:16 visual_prompt]: Epoch 58 / 100: avg data time: 5.15e-02, avg batch time: 0.4956, average train loss: 0.1401
[09/26 02:13:17 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.1673, average loss: 0.5832
[09/26 02:13:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.98	
[09/26 02:13:17 visual_prompt]: Training 59 / 100 epoch, with learning rate 1.1193394209154333
[09/26 02:13:24 visual_prompt]: Epoch 59 / 100: avg data time: 6.15e-02, avg batch time: 0.5057, average train loss: 0.0987
[09/26 02:13:26 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.1674, average loss: 0.4787
[09/26 02:13:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 94.38	
[09/26 02:13:26 visual_prompt]: Training 60 / 100 epoch, with learning rate 1.0760336237999186
[09/26 02:13:32 visual_prompt]: Epoch 60 / 100: avg data time: 4.41e-02, avg batch time: 0.4892, average train loss: 0.0629
[09/26 02:13:34 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.1673, average loss: 0.5769
[09/26 02:13:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.37	
[09/26 02:13:34 visual_prompt]: Training 61 / 100 epoch, with learning rate 1.0329397779163372
[09/26 02:13:41 visual_prompt]: Epoch 61 / 100: avg data time: 6.48e-02, avg batch time: 0.5085, average train loss: 0.0460
[09/26 02:13:42 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1673, average loss: 0.6020
[09/26 02:13:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.54	
[09/26 02:13:42 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.990110386477801
[09/26 02:13:49 visual_prompt]: Epoch 62 / 100: avg data time: 6.57e-02, avg batch time: 0.5113, average train loss: 0.0273
[09/26 02:13:51 visual_prompt]: Inference (val):avg data time: 2.04e-05, avg batch time: 0.1672, average loss: 0.5440
[09/26 02:13:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.29	
[09/26 02:13:51 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.9475976305004155
[09/26 02:13:57 visual_prompt]: Epoch 63 / 100: avg data time: 4.27e-02, avg batch time: 0.4903, average train loss: 0.0154
[09/26 02:13:59 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1675, average loss: 0.5873
[09/26 02:13:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 94.51	
[09/26 02:13:59 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.9054533052287511
[09/26 02:14:06 visual_prompt]: Epoch 64 / 100: avg data time: 5.57e-02, avg batch time: 0.5002, average train loss: 0.0154
[09/26 02:14:07 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.1677, average loss: 0.6069
[09/26 02:14:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 94.76	
[09/26 02:14:07 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.8637287570313158
[09/26 02:14:14 visual_prompt]: Epoch 65 / 100: avg data time: 6.46e-02, avg batch time: 0.5090, average train loss: 0.0147
[09/26 02:14:15 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1675, average loss: 0.6067
[09/26 02:14:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 94.35	
[09/26 02:14:15 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.8224748208429142
[09/26 02:14:22 visual_prompt]: Epoch 66 / 100: avg data time: 5.00e-02, avg batch time: 0.4952, average train loss: 0.0292
[09/26 02:14:24 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.1672, average loss: 0.6023
[09/26 02:14:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.98	
[09/26 02:14:24 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.7817417582301099
[09/26 02:14:30 visual_prompt]: Epoch 67 / 100: avg data time: 5.51e-02, avg batch time: 0.4999, average train loss: 0.0317
[09/26 02:14:32 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1673, average loss: 0.7780
[09/26 02:14:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.90	
[09/26 02:14:32 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.7415791961552499
[09/26 02:14:39 visual_prompt]: Epoch 68 / 100: avg data time: 4.94e-02, avg batch time: 0.4932, average train loss: 0.0461
[09/26 02:14:40 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.1670, average loss: 0.6364
[09/26 02:14:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.16	
[09/26 02:14:40 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.7020360665136531
[09/26 02:14:47 visual_prompt]: Epoch 69 / 100: avg data time: 4.50e-02, avg batch time: 0.4903, average train loss: 0.0184
[09/26 02:14:48 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1673, average loss: 0.6937
[09/26 02:14:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.47	
[09/26 02:14:48 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.6631605465176369
[09/26 02:14:55 visual_prompt]: Epoch 70 / 100: avg data time: 5.59e-02, avg batch time: 0.5002, average train loss: 0.0086
[09/26 02:14:56 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1675, average loss: 0.7558
[09/26 02:14:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.89	
[09/26 02:14:56 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.6250000000000002
[09/26 02:15:03 visual_prompt]: Epoch 71 / 100: avg data time: 5.19e-02, avg batch time: 0.4956, average train loss: 0.0151
[09/26 02:15:04 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1679, average loss: 0.8446
[09/26 02:15:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.68	
[09/26 02:15:04 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.587600919708494
[09/26 02:15:11 visual_prompt]: Epoch 72 / 100: avg data time: 4.89e-02, avg batch time: 0.4932, average train loss: 0.0114
[09/26 02:15:13 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1676, average loss: 0.7606
[09/26 02:15:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 94.03	
[09/26 02:15:13 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.5510088706615667
[09/26 02:15:19 visual_prompt]: Epoch 73 / 100: avg data time: 5.90e-02, avg batch time: 0.5056, average train loss: 0.0127
[09/26 02:15:21 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1674, average loss: 0.8247
[09/26 02:15:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.43	
[09/26 02:15:21 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.5152684346344087
[09/26 02:15:28 visual_prompt]: Epoch 74 / 100: avg data time: 5.78e-02, avg batch time: 0.5014, average train loss: 0.0126
[09/26 02:15:29 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1674, average loss: 0.8556
[09/26 02:15:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.17	
[09/26 02:15:29 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.48042315584292716
[09/26 02:15:36 visual_prompt]: Epoch 75 / 100: avg data time: 5.96e-02, avg batch time: 0.5038, average train loss: 0.0051
[09/26 02:15:37 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1674, average loss: 0.7535
[09/26 02:15:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.04	
[09/26 02:15:37 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.4465154878918258
[09/26 02:15:44 visual_prompt]: Epoch 76 / 100: avg data time: 5.48e-02, avg batch time: 0.5001, average train loss: 0.0089
[09/26 02:15:46 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1673, average loss: 0.8111
[09/26 02:15:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.83	
[09/26 02:15:46 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.41358674205142765
[09/26 02:15:52 visual_prompt]: Epoch 77 / 100: avg data time: 5.84e-02, avg batch time: 0.5019, average train loss: 0.0020
[09/26 02:15:54 visual_prompt]: Inference (val):avg data time: 2.79e-05, avg batch time: 0.1675, average loss: 0.7941
[09/26 02:15:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.70	
[09/26 02:15:54 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.3816770369262533
[09/26 02:16:01 visual_prompt]: Epoch 78 / 100: avg data time: 4.67e-02, avg batch time: 0.4917, average train loss: 0.0011
[09/26 02:16:02 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1673, average loss: 0.7962
[09/26 02:16:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.71	
[09/26 02:16:02 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.35082524957668626
[09/26 02:16:09 visual_prompt]: Epoch 79 / 100: avg data time: 4.83e-02, avg batch time: 0.4947, average train loss: 0.0008
[09/26 02:16:10 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1675, average loss: 0.8117
[09/26 02:16:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.72	
[09/26 02:16:10 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.32106896815325703
[09/26 02:16:17 visual_prompt]: Epoch 80 / 100: avg data time: 5.68e-02, avg batch time: 0.5005, average train loss: 0.0007
[09/26 02:16:19 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1676, average loss: 0.8244
[09/26 02:16:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.74	
[09/26 02:16:19 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.2924444461012776
[09/26 02:16:25 visual_prompt]: Epoch 81 / 100: avg data time: 4.92e-02, avg batch time: 0.4938, average train loss: 0.0006
[09/26 02:16:27 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1672, average loss: 0.8286
[09/26 02:16:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.78	
[09/26 02:16:27 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.26498655799159765
[09/26 02:16:34 visual_prompt]: Epoch 82 / 100: avg data time: 5.36e-02, avg batch time: 0.4985, average train loss: 0.0007
[09/26 02:16:35 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1673, average loss: 0.8367
[09/26 02:16:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.87	
[09/26 02:16:35 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.23872875703131582
[09/26 02:16:42 visual_prompt]: Epoch 83 / 100: avg data time: 4.89e-02, avg batch time: 0.4926, average train loss: 0.0006
[09/26 02:16:44 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1675, average loss: 0.8380
[09/26 02:16:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.88	
[09/26 02:16:44 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.21370303430619797
[09/26 02:16:50 visual_prompt]: Epoch 84 / 100: avg data time: 5.23e-02, avg batch time: 0.4961, average train loss: 0.0005
[09/26 02:16:52 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1672, average loss: 0.8418
[09/26 02:16:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.89	
[09/26 02:16:52 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.18993987980446755
[09/26 02:16:59 visual_prompt]: Epoch 85 / 100: avg data time: 5.71e-02, avg batch time: 0.5015, average train loss: 0.0005
[09/26 02:17:00 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1676, average loss: 0.8431
[09/26 02:17:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.90	
[09/26 02:17:00 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.16746824526945162
[09/26 02:17:07 visual_prompt]: Epoch 86 / 100: avg data time: 5.61e-02, avg batch time: 0.4998, average train loss: 0.0006
[09/26 02:17:09 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1675, average loss: 0.8446
[09/26 02:17:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.90	
[09/26 02:17:09 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.14631550892634126
[09/26 02:17:15 visual_prompt]: Epoch 87 / 100: avg data time: 4.75e-02, avg batch time: 0.4928, average train loss: 0.0005
[09/26 02:17:17 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1677, average loss: 0.8483
[09/26 02:17:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.91	
[09/26 02:17:17 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.12650744212604148
[09/26 02:17:24 visual_prompt]: Epoch 88 / 100: avg data time: 6.15e-02, avg batch time: 0.5056, average train loss: 0.0005
[09/26 02:17:25 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1674, average loss: 0.8513
[09/26 02:17:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.90	
[09/26 02:17:25 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.10806817794674878
[09/26 02:17:32 visual_prompt]: Epoch 89 / 100: avg data time: 5.74e-02, avg batch time: 0.5016, average train loss: 0.0004
[09/26 02:17:34 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1671, average loss: 0.8528
[09/26 02:17:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.90	
[09/26 02:17:34 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.09102018179151586
[09/26 02:17:41 visual_prompt]: Epoch 90 / 100: avg data time: 5.62e-02, avg batch time: 0.5005, average train loss: 0.0006
[09/26 02:17:42 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1675, average loss: 0.8525
[09/26 02:17:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.90	
[09/26 02:17:42 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.0753842240176146
[09/26 02:17:49 visual_prompt]: Epoch 91 / 100: avg data time: 4.60e-02, avg batch time: 0.4920, average train loss: 0.0005
[09/26 02:17:50 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1673, average loss: 0.8525
[09/26 02:17:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.89	
[09/26 02:17:50 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.061179354631058086
[09/26 02:17:57 visual_prompt]: Epoch 92 / 100: avg data time: 6.07e-02, avg batch time: 0.5048, average train loss: 0.0004
[09/26 02:17:59 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1675, average loss: 0.8525
[09/26 02:17:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.89	
[09/26 02:17:59 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.04842288007710138
[09/26 02:18:05 visual_prompt]: Epoch 93 / 100: avg data time: 6.52e-02, avg batch time: 0.5087, average train loss: 0.0004
[09/26 02:18:07 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1674, average loss: 0.8531
[09/26 02:18:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.89	
[09/26 02:18:07 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.03713034215500441
[09/26 02:18:14 visual_prompt]: Epoch 94 / 100: avg data time: 5.42e-02, avg batch time: 0.4993, average train loss: 0.0005
[09/26 02:18:15 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1674, average loss: 0.8534
[09/26 02:18:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.90	
[09/26 02:18:15 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.02731549908274289
[09/26 02:18:22 visual_prompt]: Epoch 95 / 100: avg data time: 6.26e-02, avg batch time: 0.5064, average train loss: 0.0004
[09/26 02:18:23 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1673, average loss: 0.8537
[09/26 02:18:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.90	
[09/26 02:18:23 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.018990308734739975
[09/26 02:18:30 visual_prompt]: Epoch 96 / 100: avg data time: 5.78e-02, avg batch time: 0.5030, average train loss: 0.0007
[09/26 02:18:32 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1675, average loss: 0.8555
[09/26 02:18:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.90	
[09/26 02:18:32 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.012164914073037048
[09/26 02:18:38 visual_prompt]: Epoch 97 / 100: avg data time: 5.47e-02, avg batch time: 0.4982, average train loss: 0.0005
[09/26 02:18:40 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1676, average loss: 0.8575
[09/26 02:18:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.91	
[09/26 02:18:40 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.006847630789658388
[09/26 02:18:47 visual_prompt]: Epoch 98 / 100: avg data time: 6.25e-02, avg batch time: 0.5059, average train loss: 0.0004
[09/26 02:18:49 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1675, average loss: 0.8578
[09/26 02:18:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.91	
[09/26 02:18:49 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.003044937175219753
[09/26 02:18:55 visual_prompt]: Epoch 99 / 100: avg data time: 5.92e-02, avg batch time: 0.5031, average train loss: 0.0004
[09/26 02:18:57 visual_prompt]: Inference (val):avg data time: 3.16e-05, avg batch time: 0.1674, average loss: 0.8579
[09/26 02:18:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.91	
[09/26 02:18:57 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0007614662261302974
[09/26 02:19:04 visual_prompt]: Epoch 100 / 100: avg data time: 5.32e-02, avg batch time: 0.4981, average train loss: 0.0005
[09/26 02:19:05 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1675, average loss: 0.8579
[09/26 02:19:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.91	
[09/26 02:19:05 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 02:19:05 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 02:19:05 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 02:19:05 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 02:19:05 visual_prompt]: Training with config:
[09/26 02:19:05 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr2.5_wd0.0/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 2.5, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 02:19:05 visual_prompt]: Loading training data...
[09/26 02:19:05 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 02:19:06 visual_prompt]: Number of images: 800
[09/26 02:19:06 visual_prompt]: Number of classes: 2 / 2
[09/26 02:19:06 visual_prompt]: Loading validation data...
[09/26 02:19:06 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 02:19:06 visual_prompt]: Number of images: 200
[09/26 02:19:06 visual_prompt]: Number of classes: 2 / 2
[09/26 02:19:06 visual_prompt]: Constructing models...
[09/26 02:19:09 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 02:19:09 visual_prompt]: tuned percent:0.536
[09/26 02:19:09 visual_prompt]: Device used for model: 0
[09/26 02:19:09 visual_prompt]: Setting up Evaluator...
[09/26 02:19:09 visual_prompt]: Setting up Trainer...
[09/26 02:19:09 visual_prompt]: 	Setting up the optimizer...
[09/26 02:19:09 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 02:19:16 visual_prompt]: Epoch 1 / 100: avg data time: 5.09e-02, avg batch time: 0.4961, average train loss: 1.9813
[09/26 02:19:17 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1670, average loss: 2.0033
[09/26 02:19:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 02:19:17 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 02:19:17 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.25
[09/26 02:19:24 visual_prompt]: Epoch 2 / 100: avg data time: 3.99e-02, avg batch time: 0.4838, average train loss: 5.5909
[09/26 02:19:25 visual_prompt]: Inference (val):avg data time: 3.01e-05, avg batch time: 0.1672, average loss: 1.0333
[09/26 02:19:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 76.11	
[09/26 02:19:25 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.5
[09/26 02:19:32 visual_prompt]: Epoch 3 / 100: avg data time: 5.42e-02, avg batch time: 0.4993, average train loss: 1.0337
[09/26 02:19:33 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1669, average loss: 0.6580
[09/26 02:19:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.59	
[09/26 02:19:33 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.75
[09/26 02:19:40 visual_prompt]: Epoch 4 / 100: avg data time: 4.16e-02, avg batch time: 0.4844, average train loss: 0.7389
[09/26 02:19:41 visual_prompt]: Inference (val):avg data time: 2.99e-05, avg batch time: 0.1670, average loss: 0.5565
[09/26 02:19:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 67.50	rocauc: 89.52	
[09/26 02:19:41 visual_prompt]: Best epoch 4: best metric: 0.675
[09/26 02:19:41 visual_prompt]: Training 5 / 100 epoch, with learning rate 1.0
[09/26 02:19:48 visual_prompt]: Epoch 5 / 100: avg data time: 5.75e-02, avg batch time: 0.5015, average train loss: 0.6804
[09/26 02:19:50 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1673, average loss: 0.4461
[09/26 02:19:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 90.55	
[09/26 02:19:50 visual_prompt]: Best epoch 5: best metric: 0.855
[09/26 02:19:50 visual_prompt]: Training 6 / 100 epoch, with learning rate 1.25
[09/26 02:19:56 visual_prompt]: Epoch 6 / 100: avg data time: 5.40e-02, avg batch time: 0.4981, average train loss: 0.8746
[09/26 02:19:58 visual_prompt]: Inference (val):avg data time: 3.15e-05, avg batch time: 0.1674, average loss: 0.4615
[09/26 02:19:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.00	rocauc: 90.43	
[09/26 02:19:58 visual_prompt]: Training 7 / 100 epoch, with learning rate 1.5
[09/26 02:20:05 visual_prompt]: Epoch 7 / 100: avg data time: 5.48e-02, avg batch time: 0.4993, average train loss: 0.8575
[09/26 02:20:06 visual_prompt]: Inference (val):avg data time: 3.13e-05, avg batch time: 0.1675, average loss: 1.6758
[09/26 02:20:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 49.00	rocauc: 90.77	
[09/26 02:20:06 visual_prompt]: Training 8 / 100 epoch, with learning rate 1.75
[09/26 02:20:13 visual_prompt]: Epoch 8 / 100: avg data time: 4.49e-02, avg batch time: 0.4909, average train loss: 0.7936
[09/26 02:20:14 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1673, average loss: 0.4684
[09/26 02:20:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 90.49	
[09/26 02:20:14 visual_prompt]: Training 9 / 100 epoch, with learning rate 2.0
[09/26 02:20:21 visual_prompt]: Epoch 9 / 100: avg data time: 4.65e-02, avg batch time: 0.4904, average train loss: 0.8908
[09/26 02:20:22 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1673, average loss: 1.5725
[09/26 02:20:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 91.16	
[09/26 02:20:22 visual_prompt]: Training 10 / 100 epoch, with learning rate 2.25
[09/26 02:20:29 visual_prompt]: Epoch 10 / 100: avg data time: 4.77e-02, avg batch time: 0.4928, average train loss: 0.7303
[09/26 02:20:30 visual_prompt]: Inference (val):avg data time: 2.92e-05, avg batch time: 0.1677, average loss: 0.3483
[09/26 02:20:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.58	
[09/26 02:20:30 visual_prompt]: Training 11 / 100 epoch, with learning rate 2.5
[09/26 02:20:37 visual_prompt]: Epoch 11 / 100: avg data time: 5.09e-02, avg batch time: 0.4947, average train loss: 1.3971
[09/26 02:20:39 visual_prompt]: Inference (val):avg data time: 3.18e-05, avg batch time: 0.1674, average loss: 2.1935
[09/26 02:20:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 51.50	rocauc: 91.40	
[09/26 02:20:39 visual_prompt]: Training 12 / 100 epoch, with learning rate 2.4992385337738696
[09/26 02:20:45 visual_prompt]: Epoch 12 / 100: avg data time: 3.97e-02, avg batch time: 0.4852, average train loss: 1.3045
[09/26 02:20:47 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1675, average loss: 0.4649
[09/26 02:20:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.49	
[09/26 02:20:47 visual_prompt]: Training 13 / 100 epoch, with learning rate 2.4969550628247803
[09/26 02:20:53 visual_prompt]: Epoch 13 / 100: avg data time: 4.39e-02, avg batch time: 0.4879, average train loss: 0.7082
[09/26 02:20:54 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1673, average loss: 0.7166
[09/26 02:20:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.50	rocauc: 91.61	
[09/26 02:20:54 visual_prompt]: Training 14 / 100 epoch, with learning rate 2.4931523692103417
[09/26 02:21:01 visual_prompt]: Epoch 14 / 100: avg data time: 4.78e-02, avg batch time: 0.4923, average train loss: 0.8273
[09/26 02:21:03 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1678, average loss: 0.8562
[09/26 02:21:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 93.33	
[09/26 02:21:03 visual_prompt]: Training 15 / 100 epoch, with learning rate 2.487835085926963
[09/26 02:21:09 visual_prompt]: Epoch 15 / 100: avg data time: 4.42e-02, avg batch time: 0.4883, average train loss: 0.6348
[09/26 02:21:11 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1674, average loss: 0.8764
[09/26 02:21:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 67.50	rocauc: 90.36	
[09/26 02:21:11 visual_prompt]: Training 16 / 100 epoch, with learning rate 2.4810096912652604
[09/26 02:21:17 visual_prompt]: Epoch 16 / 100: avg data time: 4.22e-02, avg batch time: 0.4880, average train loss: 0.5648
[09/26 02:21:19 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1674, average loss: 1.1024
[09/26 02:21:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 59.00	rocauc: 92.42	
[09/26 02:21:19 visual_prompt]: Training 17 / 100 epoch, with learning rate 2.472684500917257
[09/26 02:21:25 visual_prompt]: Epoch 17 / 100: avg data time: 5.82e-02, avg batch time: 0.5021, average train loss: 0.5518
[09/26 02:21:27 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1670, average loss: 0.9584
[09/26 02:21:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.50	rocauc: 93.25	
[09/26 02:21:27 visual_prompt]: Training 18 / 100 epoch, with learning rate 2.4628696578449953
[09/26 02:21:34 visual_prompt]: Epoch 18 / 100: avg data time: 5.83e-02, avg batch time: 0.5022, average train loss: 0.6557
[09/26 02:21:35 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1676, average loss: 1.0199
[09/26 02:21:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.50	rocauc: 93.04	
[09/26 02:21:35 visual_prompt]: Training 19 / 100 epoch, with learning rate 2.4515771199228986
[09/26 02:21:42 visual_prompt]: Epoch 19 / 100: avg data time: 5.55e-02, avg batch time: 0.5010, average train loss: 0.5609
[09/26 02:21:43 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1677, average loss: 1.2718
[09/26 02:21:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.00	rocauc: 92.49	
[09/26 02:21:43 visual_prompt]: Training 20 / 100 epoch, with learning rate 2.438820645368942
[09/26 02:21:50 visual_prompt]: Epoch 20 / 100: avg data time: 5.55e-02, avg batch time: 0.4998, average train loss: 0.6734
[09/26 02:21:51 visual_prompt]: Inference (val):avg data time: 2.76e-05, avg batch time: 0.1674, average loss: 0.6530
[09/26 02:21:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.50	rocauc: 91.83	
[09/26 02:21:51 visual_prompt]: Training 21 / 100 epoch, with learning rate 2.4246157759823856
[09/26 02:21:58 visual_prompt]: Epoch 21 / 100: avg data time: 4.57e-02, avg batch time: 0.4909, average train loss: 0.3265
[09/26 02:22:00 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1674, average loss: 0.3712
[09/26 02:22:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.59	
[09/26 02:22:00 visual_prompt]: Training 22 / 100 epoch, with learning rate 2.4089798182084845
[09/26 02:22:06 visual_prompt]: Epoch 22 / 100: avg data time: 5.60e-02, avg batch time: 0.4997, average train loss: 0.3797
[09/26 02:22:08 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1674, average loss: 0.7146
[09/26 02:22:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 93.86	
[09/26 02:22:08 visual_prompt]: Training 23 / 100 epoch, with learning rate 2.391931822053251
[09/26 02:22:14 visual_prompt]: Epoch 23 / 100: avg data time: 5.28e-02, avg batch time: 0.4985, average train loss: 0.5809
[09/26 02:22:16 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1675, average loss: 0.4190
[09/26 02:22:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.23	
[09/26 02:22:16 visual_prompt]: Training 24 / 100 epoch, with learning rate 2.3734925578739587
[09/26 02:22:23 visual_prompt]: Epoch 24 / 100: avg data time: 5.35e-02, avg batch time: 0.4980, average train loss: 0.3599
[09/26 02:22:24 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1675, average loss: 0.4585
[09/26 02:22:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 93.51	
[09/26 02:22:24 visual_prompt]: Training 25 / 100 epoch, with learning rate 2.3536844910736585
[09/26 02:22:31 visual_prompt]: Epoch 25 / 100: avg data time: 4.61e-02, avg batch time: 0.4912, average train loss: 0.2844
[09/26 02:22:32 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1675, average loss: 0.4100
[09/26 02:22:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 93.17	
[09/26 02:22:32 visual_prompt]: Training 26 / 100 epoch, with learning rate 2.3325317547305486
[09/26 02:22:39 visual_prompt]: Epoch 26 / 100: avg data time: 5.43e-02, avg batch time: 0.4990, average train loss: 0.2712
[09/26 02:22:40 visual_prompt]: Inference (val):avg data time: 3.04e-05, avg batch time: 0.1675, average loss: 0.4467
[09/26 02:22:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 93.32	
[09/26 02:22:40 visual_prompt]: Training 27 / 100 epoch, with learning rate 2.310060120195532
[09/26 02:22:47 visual_prompt]: Epoch 27 / 100: avg data time: 5.31e-02, avg batch time: 0.4980, average train loss: 0.2220
[09/26 02:22:49 visual_prompt]: Inference (val):avg data time: 3.17e-05, avg batch time: 0.1674, average loss: 0.4048
[09/26 02:22:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.03	
[09/26 02:22:49 visual_prompt]: Training 28 / 100 epoch, with learning rate 2.286296965693802
[09/26 02:22:55 visual_prompt]: Epoch 28 / 100: avg data time: 4.37e-02, avg batch time: 0.4887, average train loss: 0.1537
[09/26 02:22:57 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1675, average loss: 0.4334
[09/26 02:22:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.71	
[09/26 02:22:57 visual_prompt]: Training 29 / 100 epoch, with learning rate 2.261271242968684
[09/26 02:23:03 visual_prompt]: Epoch 29 / 100: avg data time: 5.33e-02, avg batch time: 0.4985, average train loss: 0.1358
[09/26 02:23:05 visual_prompt]: Inference (val):avg data time: 3.58e-05, avg batch time: 0.1675, average loss: 0.4612
[09/26 02:23:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.03	
[09/26 02:23:05 visual_prompt]: Best epoch 29: best metric: 0.860
[09/26 02:23:05 visual_prompt]: Training 30 / 100 epoch, with learning rate 2.2350134420084022
[09/26 02:23:12 visual_prompt]: Epoch 30 / 100: avg data time: 4.83e-02, avg batch time: 0.4927, average train loss: 0.1587
[09/26 02:23:13 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1675, average loss: 0.5196
[09/26 02:23:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.17	
[09/26 02:23:13 visual_prompt]: Training 31 / 100 epoch, with learning rate 2.2075555538987226
[09/26 02:23:20 visual_prompt]: Epoch 31 / 100: avg data time: 5.41e-02, avg batch time: 0.4983, average train loss: 0.1262
[09/26 02:23:21 visual_prompt]: Inference (val):avg data time: 3.30e-05, avg batch time: 0.1676, average loss: 0.7054
[09/26 02:23:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 93.11	
[09/26 02:23:21 visual_prompt]: Training 32 / 100 epoch, with learning rate 2.178931031846743
[09/26 02:23:28 visual_prompt]: Epoch 32 / 100: avg data time: 5.38e-02, avg batch time: 0.4987, average train loss: 0.2021
[09/26 02:23:29 visual_prompt]: Inference (val):avg data time: 3.09e-05, avg batch time: 0.1676, average loss: 0.9241
[09/26 02:23:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.00	rocauc: 93.92	
[09/26 02:23:29 visual_prompt]: Training 33 / 100 epoch, with learning rate 2.149174750423314
[09/26 02:23:36 visual_prompt]: Epoch 33 / 100: avg data time: 4.19e-02, avg batch time: 0.4864, average train loss: 0.2840
[09/26 02:23:37 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1675, average loss: 0.5572
[09/26 02:23:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.34	
[09/26 02:23:38 visual_prompt]: Training 34 / 100 epoch, with learning rate 2.1183229630737466
[09/26 02:23:44 visual_prompt]: Epoch 34 / 100: avg data time: 5.32e-02, avg batch time: 0.4978, average train loss: 0.2346
[09/26 02:23:46 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1675, average loss: 0.5857
[09/26 02:23:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 90.64	
[09/26 02:23:46 visual_prompt]: Training 35 / 100 epoch, with learning rate 2.086413257948573
[09/26 02:23:52 visual_prompt]: Epoch 35 / 100: avg data time: 5.09e-02, avg batch time: 0.4956, average train loss: 0.1583
[09/26 02:23:54 visual_prompt]: Inference (val):avg data time: 3.17e-05, avg batch time: 0.1677, average loss: 0.7244
[09/26 02:23:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.09	
[09/26 02:23:54 visual_prompt]: Training 36 / 100 epoch, with learning rate 2.053484512108174
[09/26 02:24:00 visual_prompt]: Epoch 36 / 100: avg data time: 4.12e-02, avg batch time: 0.4895, average train loss: 0.1640
[09/26 02:24:02 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1676, average loss: 0.6557
[09/26 02:24:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 93.38	
[09/26 02:24:02 visual_prompt]: Training 37 / 100 epoch, with learning rate 2.019576844157073
[09/26 02:24:08 visual_prompt]: Epoch 37 / 100: avg data time: 4.48e-02, avg batch time: 0.4921, average train loss: 0.2029
[09/26 02:24:10 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1674, average loss: 0.6676
[09/26 02:24:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 93.84	
[09/26 02:24:10 visual_prompt]: Training 38 / 100 epoch, with learning rate 1.9847315653655915
[09/26 02:24:16 visual_prompt]: Epoch 38 / 100: avg data time: 4.48e-02, avg batch time: 0.4887, average train loss: 0.0852
[09/26 02:24:18 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1673, average loss: 0.7827
[09/26 02:24:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 92.81	
[09/26 02:24:18 visual_prompt]: Training 39 / 100 epoch, with learning rate 1.9489911293384334
[09/26 02:24:25 visual_prompt]: Epoch 39 / 100: avg data time: 4.72e-02, avg batch time: 0.4911, average train loss: 0.0876
[09/26 02:24:26 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1676, average loss: 0.6158
[09/26 02:24:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.78	
[09/26 02:24:26 visual_prompt]: Training 40 / 100 epoch, with learning rate 1.912399080291506
[09/26 02:24:33 visual_prompt]: Epoch 40 / 100: avg data time: 4.89e-02, avg batch time: 0.4943, average train loss: 0.0593
[09/26 02:24:34 visual_prompt]: Inference (val):avg data time: 3.12e-05, avg batch time: 0.1675, average loss: 0.5892
[09/26 02:24:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.02	
[09/26 02:24:34 visual_prompt]: Training 41 / 100 epoch, with learning rate 1.875
[09/26 02:24:41 visual_prompt]: Epoch 41 / 100: avg data time: 5.49e-02, avg batch time: 0.4986, average train loss: 0.0403
[09/26 02:24:42 visual_prompt]: Inference (val):avg data time: 4.52e-05, avg batch time: 0.1677, average loss: 0.6834
[09/26 02:24:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.01	
[09/26 02:24:42 visual_prompt]: Training 42 / 100 epoch, with learning rate 1.8368394534823635
[09/26 02:24:49 visual_prompt]: Epoch 42 / 100: avg data time: 5.15e-02, avg batch time: 0.4954, average train loss: 0.0495
[09/26 02:24:50 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1677, average loss: 0.6198
[09/26 02:24:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.34	
[09/26 02:24:50 visual_prompt]: Training 43 / 100 epoch, with learning rate 1.7979639334863466
[09/26 02:24:57 visual_prompt]: Epoch 43 / 100: avg data time: 4.38e-02, avg batch time: 0.4882, average train loss: 0.1280
[09/26 02:24:58 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1676, average loss: 0.6458
[09/26 02:24:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 89.83	
[09/26 02:24:58 visual_prompt]: Training 44 / 100 epoch, with learning rate 1.7584208038447504
[09/26 02:25:05 visual_prompt]: Epoch 44 / 100: avg data time: 4.09e-02, avg batch time: 0.4859, average train loss: 0.1617
[09/26 02:25:07 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1673, average loss: 0.6920
[09/26 02:25:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.35	
[09/26 02:25:07 visual_prompt]: Training 45 / 100 epoch, with learning rate 1.7182582417698902
[09/26 02:25:13 visual_prompt]: Epoch 45 / 100: avg data time: 5.07e-02, avg batch time: 0.4943, average train loss: 0.3838
[09/26 02:25:15 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1675, average loss: 0.8417
[09/26 02:25:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.76	
[09/26 02:25:15 visual_prompt]: Training 46 / 100 epoch, with learning rate 1.6775251791570862
[09/26 02:25:21 visual_prompt]: Epoch 46 / 100: avg data time: 5.78e-02, avg batch time: 0.5019, average train loss: 0.1418
[09/26 02:25:23 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1674, average loss: 0.6062
[09/26 02:25:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.64	
[09/26 02:25:23 visual_prompt]: Training 47 / 100 epoch, with learning rate 1.6362712429686843
[09/26 02:25:29 visual_prompt]: Epoch 47 / 100: avg data time: 4.41e-02, avg batch time: 0.4892, average train loss: 0.1186
[09/26 02:25:31 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1675, average loss: 0.7645
[09/26 02:25:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.83	
[09/26 02:25:31 visual_prompt]: Training 48 / 100 epoch, with learning rate 1.5945466947712488
[09/26 02:25:38 visual_prompt]: Epoch 48 / 100: avg data time: 4.47e-02, avg batch time: 0.4911, average train loss: 0.0706
[09/26 02:25:39 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1673, average loss: 0.5874
[09/26 02:25:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.33	
[09/26 02:25:39 visual_prompt]: Training 49 / 100 epoch, with learning rate 1.5524023694995845
[09/26 02:25:46 visual_prompt]: Epoch 49 / 100: avg data time: 4.23e-02, avg batch time: 0.4882, average train loss: 0.0194
[09/26 02:25:47 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1677, average loss: 0.6888
[09/26 02:25:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.99	
[09/26 02:25:47 visual_prompt]: Training 50 / 100 epoch, with learning rate 1.509889613522199
[09/26 02:25:53 visual_prompt]: Epoch 50 / 100: avg data time: 3.97e-02, avg batch time: 0.4850, average train loss: 0.0174
[09/26 02:25:55 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1676, average loss: 0.8204
[09/26 02:25:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.24	
[09/26 02:25:55 visual_prompt]: Training 51 / 100 epoch, with learning rate 1.467060222083663
[09/26 02:26:01 visual_prompt]: Epoch 51 / 100: avg data time: 4.08e-02, avg batch time: 0.4856, average train loss: 0.0133
[09/26 02:26:03 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1674, average loss: 0.8722
[09/26 02:26:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.95	
[09/26 02:26:03 visual_prompt]: Training 52 / 100 epoch, with learning rate 1.4239663762000818
[09/26 02:26:09 visual_prompt]: Epoch 52 / 100: avg data time: 4.20e-02, avg batch time: 0.4865, average train loss: 0.0065
[09/26 02:26:11 visual_prompt]: Inference (val):avg data time: 2.06e-05, avg batch time: 0.1674, average loss: 0.7493
[09/26 02:26:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.47	
[09/26 02:26:11 visual_prompt]: Training 53 / 100 epoch, with learning rate 1.380660579084567
[09/26 02:26:17 visual_prompt]: Epoch 53 / 100: avg data time: 4.23e-02, avg batch time: 0.4866, average train loss: 0.0029
[09/26 02:26:19 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1674, average loss: 0.7889
[09/26 02:26:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.40	
[09/26 02:26:19 visual_prompt]: Training 54 / 100 epoch, with learning rate 1.3371955921801564
[09/26 02:26:26 visual_prompt]: Epoch 54 / 100: avg data time: 4.64e-02, avg batch time: 0.4916, average train loss: 0.0046
[09/26 02:26:27 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1677, average loss: 0.8614
[09/26 02:26:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.43	
[09/26 02:26:27 visual_prompt]: Training 55 / 100 epoch, with learning rate 1.2936243708781263
[09/26 02:26:34 visual_prompt]: Epoch 55 / 100: avg data time: 5.41e-02, avg batch time: 0.4980, average train loss: 0.0057
[09/26 02:26:35 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1674, average loss: 0.7924
[09/26 02:26:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.76	
[09/26 02:26:35 visual_prompt]: Training 56 / 100 epoch, with learning rate 1.25
[09/26 02:26:42 visual_prompt]: Epoch 56 / 100: avg data time: 4.77e-02, avg batch time: 0.4928, average train loss: 0.0033
[09/26 02:26:43 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1675, average loss: 0.8775
[09/26 02:26:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.25	
[09/26 02:26:43 visual_prompt]: Training 57 / 100 epoch, with learning rate 1.2063756291218741
[09/26 02:26:50 visual_prompt]: Epoch 57 / 100: avg data time: 4.17e-02, avg batch time: 0.4875, average train loss: 0.0026
[09/26 02:26:51 visual_prompt]: Inference (val):avg data time: 4.61e-05, avg batch time: 0.1680, average loss: 0.8942
[09/26 02:26:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.99	
[09/26 02:26:51 visual_prompt]: Training 58 / 100 epoch, with learning rate 1.1628044078198434
[09/26 02:26:58 visual_prompt]: Epoch 58 / 100: avg data time: 4.07e-02, avg batch time: 0.4877, average train loss: 0.0018
[09/26 02:27:00 visual_prompt]: Inference (val):avg data time: 3.10e-05, avg batch time: 0.1677, average loss: 0.9809
[09/26 02:27:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.14	
[09/26 02:27:00 visual_prompt]: Training 59 / 100 epoch, with learning rate 1.1193394209154333
[09/26 02:27:06 visual_prompt]: Epoch 59 / 100: avg data time: 5.18e-02, avg batch time: 0.4963, average train loss: 0.0012
[09/26 02:27:08 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1677, average loss: 0.9431
[09/26 02:27:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.37	
[09/26 02:27:08 visual_prompt]: Training 60 / 100 epoch, with learning rate 1.0760336237999186
[09/26 02:27:14 visual_prompt]: Epoch 60 / 100: avg data time: 4.10e-02, avg batch time: 0.4865, average train loss: 0.0030
[09/26 02:27:16 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1677, average loss: 1.0509
[09/26 02:27:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.41	
[09/26 02:27:16 visual_prompt]: Training 61 / 100 epoch, with learning rate 1.0329397779163372
[09/26 02:27:23 visual_prompt]: Epoch 61 / 100: avg data time: 5.60e-02, avg batch time: 0.5006, average train loss: 0.0088
[09/26 02:27:24 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1674, average loss: 0.9915
[09/26 02:27:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.39	
[09/26 02:27:24 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.990110386477801
[09/26 02:27:31 visual_prompt]: Epoch 62 / 100: avg data time: 4.83e-02, avg batch time: 0.4919, average train loss: 0.0031
[09/26 02:27:32 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1676, average loss: 0.9417
[09/26 02:27:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.36	
[09/26 02:27:32 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.9475976305004155
[09/26 02:27:39 visual_prompt]: Epoch 63 / 100: avg data time: 5.36e-02, avg batch time: 0.4974, average train loss: 0.0021
[09/26 02:27:40 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1677, average loss: 1.0159
[09/26 02:27:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.98	
[09/26 02:27:40 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.9054533052287511
[09/26 02:27:47 visual_prompt]: Epoch 64 / 100: avg data time: 5.59e-02, avg batch time: 0.5013, average train loss: 0.0014
[09/26 02:27:49 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1675, average loss: 0.9648
[09/26 02:27:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.10	
[09/26 02:27:49 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.8637287570313158
[09/26 02:27:55 visual_prompt]: Epoch 65 / 100: avg data time: 5.80e-02, avg batch time: 0.5039, average train loss: 0.0010
[09/26 02:27:57 visual_prompt]: Inference (val):avg data time: 2.73e-05, avg batch time: 0.1677, average loss: 0.9720
[09/26 02:27:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.90	
[09/26 02:27:57 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.8224748208429142
[09/26 02:28:04 visual_prompt]: Epoch 66 / 100: avg data time: 5.44e-02, avg batch time: 0.4978, average train loss: 0.0013
[09/26 02:28:05 visual_prompt]: Inference (val):avg data time: 4.55e-05, avg batch time: 0.1676, average loss: 0.9951
[09/26 02:28:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.51	
[09/26 02:28:05 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.7817417582301099
[09/26 02:28:12 visual_prompt]: Epoch 67 / 100: avg data time: 5.57e-02, avg batch time: 0.4992, average train loss: 0.0015
[09/26 02:28:13 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1675, average loss: 1.0429
[09/26 02:28:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.31	
[09/26 02:28:13 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.7415791961552499
[09/26 02:28:20 visual_prompt]: Epoch 68 / 100: avg data time: 4.17e-02, avg batch time: 0.4865, average train loss: 0.0012
[09/26 02:28:21 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1676, average loss: 1.0830
[09/26 02:28:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.46	
[09/26 02:28:21 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.7020360665136531
[09/26 02:28:28 visual_prompt]: Epoch 69 / 100: avg data time: 5.62e-02, avg batch time: 0.4999, average train loss: 0.0005
[09/26 02:28:30 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1676, average loss: 1.0363
[09/26 02:28:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.17	
[09/26 02:28:30 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.6631605465176369
[09/26 02:28:36 visual_prompt]: Epoch 70 / 100: avg data time: 5.59e-02, avg batch time: 0.5009, average train loss: 0.0006
[09/26 02:28:38 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1674, average loss: 1.0391
[09/26 02:28:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.19	
[09/26 02:28:38 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.6250000000000002
[09/26 02:28:44 visual_prompt]: Epoch 71 / 100: avg data time: 4.26e-02, avg batch time: 0.4878, average train loss: 0.0004
[09/26 02:28:46 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1678, average loss: 1.0468
[09/26 02:28:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.21	
[09/26 02:28:46 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.587600919708494
[09/26 02:28:52 visual_prompt]: Epoch 72 / 100: avg data time: 4.32e-02, avg batch time: 0.4898, average train loss: 0.0004
[09/26 02:28:54 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1677, average loss: 1.0519
[09/26 02:28:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.32	
[09/26 02:28:54 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.5510088706615667
[09/26 02:29:00 visual_prompt]: Epoch 73 / 100: avg data time: 3.73e-02, avg batch time: 0.4826, average train loss: 0.0003
[09/26 02:29:02 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1673, average loss: 1.0504
[09/26 02:29:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.36	
[09/26 02:29:02 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.5152684346344087
[09/26 02:29:09 visual_prompt]: Epoch 74 / 100: avg data time: 5.56e-02, avg batch time: 0.4997, average train loss: 0.0003
[09/26 02:29:10 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1672, average loss: 1.0499
[09/26 02:29:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.40	
[09/26 02:29:10 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.48042315584292716
[09/26 02:29:17 visual_prompt]: Epoch 75 / 100: avg data time: 5.64e-02, avg batch time: 0.5015, average train loss: 0.0003
[09/26 02:29:18 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1677, average loss: 1.0488
[09/26 02:29:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.41	
[09/26 02:29:18 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.4465154878918258
[09/26 02:29:25 visual_prompt]: Epoch 76 / 100: avg data time: 5.58e-02, avg batch time: 0.5010, average train loss: 0.0003
[09/26 02:29:26 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1672, average loss: 1.0502
[09/26 02:29:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.43	
[09/26 02:29:26 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.41358674205142765
[09/26 02:29:33 visual_prompt]: Epoch 77 / 100: avg data time: 5.12e-02, avg batch time: 0.4951, average train loss: 0.0003
[09/26 02:29:35 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1672, average loss: 1.0535
[09/26 02:29:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.44	
[09/26 02:29:35 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.3816770369262533
[09/26 02:29:42 visual_prompt]: Epoch 78 / 100: avg data time: 5.06e-02, avg batch time: 0.4956, average train loss: 0.0002
[09/26 02:29:43 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1673, average loss: 1.0597
[09/26 02:29:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.48	
[09/26 02:29:43 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.35082524957668626
[09/26 02:29:50 visual_prompt]: Epoch 79 / 100: avg data time: 4.05e-02, avg batch time: 0.4860, average train loss: 0.0003
[09/26 02:29:51 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1676, average loss: 1.0631
[09/26 02:29:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.51	
[09/26 02:29:51 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.32106896815325703
[09/26 02:29:58 visual_prompt]: Epoch 80 / 100: avg data time: 5.52e-02, avg batch time: 0.4999, average train loss: 0.0002
[09/26 02:29:59 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1675, average loss: 1.0632
[09/26 02:29:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.51	
[09/26 02:29:59 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.2924444461012776
[09/26 02:30:06 visual_prompt]: Epoch 81 / 100: avg data time: 5.76e-02, avg batch time: 0.5013, average train loss: 0.0002
[09/26 02:30:07 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1674, average loss: 1.0624
[09/26 02:30:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.49	
[09/26 02:30:07 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.26498655799159765
[09/26 02:30:14 visual_prompt]: Epoch 82 / 100: avg data time: 4.35e-02, avg batch time: 0.4889, average train loss: 0.0002
[09/26 02:30:15 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1675, average loss: 1.0615
[09/26 02:30:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.49	
[09/26 02:30:15 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.23872875703131582
[09/26 02:30:22 visual_prompt]: Epoch 83 / 100: avg data time: 4.12e-02, avg batch time: 0.4893, average train loss: 0.0002
[09/26 02:30:24 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1675, average loss: 1.0611
[09/26 02:30:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.48	
[09/26 02:30:24 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.21370303430619797
[09/26 02:30:30 visual_prompt]: Epoch 84 / 100: avg data time: 5.55e-02, avg batch time: 0.4992, average train loss: 0.0003
[09/26 02:30:32 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1674, average loss: 1.0604
[09/26 02:30:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.48	
[09/26 02:30:32 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.18993987980446755
[09/26 02:30:38 visual_prompt]: Epoch 85 / 100: avg data time: 5.61e-02, avg batch time: 0.5008, average train loss: 0.0002
[09/26 02:30:40 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1671, average loss: 1.0583
[09/26 02:30:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.47	
[09/26 02:30:40 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.16746824526945162
[09/26 02:30:47 visual_prompt]: Epoch 86 / 100: avg data time: 4.60e-02, avg batch time: 0.4923, average train loss: 0.0002
[09/26 02:30:48 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1679, average loss: 1.0581
[09/26 02:30:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.47	
[09/26 02:30:48 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.14631550892634126
[09/26 02:30:55 visual_prompt]: Epoch 87 / 100: avg data time: 5.72e-02, avg batch time: 0.5024, average train loss: 0.0002
[09/26 02:30:56 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1676, average loss: 1.0583
[09/26 02:30:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.49	
[09/26 02:30:56 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.12650744212604148
[09/26 02:31:03 visual_prompt]: Epoch 88 / 100: avg data time: 5.35e-02, avg batch time: 0.4987, average train loss: 0.0002
[09/26 02:31:04 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1677, average loss: 1.0583
[09/26 02:31:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.48	
[09/26 02:31:05 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.10806817794674878
[09/26 02:31:11 visual_prompt]: Epoch 89 / 100: avg data time: 5.32e-02, avg batch time: 0.4971, average train loss: 0.0002
[09/26 02:31:13 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1674, average loss: 1.0582
[09/26 02:31:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.48	
[09/26 02:31:13 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.09102018179151586
[09/26 02:31:20 visual_prompt]: Epoch 90 / 100: avg data time: 5.96e-02, avg batch time: 0.5043, average train loss: 0.0002
[09/26 02:31:21 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1674, average loss: 1.0579
[09/26 02:31:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.47	
[09/26 02:31:21 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.0753842240176146
[09/26 02:31:28 visual_prompt]: Epoch 91 / 100: avg data time: 5.55e-02, avg batch time: 0.5008, average train loss: 0.0003
[09/26 02:31:29 visual_prompt]: Inference (val):avg data time: 2.98e-05, avg batch time: 0.1673, average loss: 1.0576
[09/26 02:31:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.47	
[09/26 02:31:29 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.061179354631058086
[09/26 02:31:36 visual_prompt]: Epoch 92 / 100: avg data time: 5.63e-02, avg batch time: 0.4999, average train loss: 0.0002
[09/26 02:31:37 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1678, average loss: 1.0573
[09/26 02:31:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.47	
[09/26 02:31:37 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.04842288007710138
[09/26 02:31:44 visual_prompt]: Epoch 93 / 100: avg data time: 4.95e-02, avg batch time: 0.4943, average train loss: 0.0002
[09/26 02:31:46 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1677, average loss: 1.0571
[09/26 02:31:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.47	
[09/26 02:31:46 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.03713034215500441
[09/26 02:31:52 visual_prompt]: Epoch 94 / 100: avg data time: 4.79e-02, avg batch time: 0.4920, average train loss: 0.0002
[09/26 02:31:54 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1677, average loss: 1.0571
[09/26 02:31:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.47	
[09/26 02:31:54 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.02731549908274289
[09/26 02:32:00 visual_prompt]: Epoch 95 / 100: avg data time: 5.39e-02, avg batch time: 0.4970, average train loss: 0.0002
[09/26 02:32:02 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1673, average loss: 1.0571
[09/26 02:32:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.47	
[09/26 02:32:02 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.018990308734739975
[09/26 02:32:09 visual_prompt]: Epoch 96 / 100: avg data time: 5.39e-02, avg batch time: 0.4980, average train loss: 0.0002
[09/26 02:32:10 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1676, average loss: 1.0571
[09/26 02:32:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.47	
[09/26 02:32:10 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.012164914073037048
[09/26 02:32:17 visual_prompt]: Epoch 97 / 100: avg data time: 5.62e-02, avg batch time: 0.5001, average train loss: 0.0002
[09/26 02:32:18 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1676, average loss: 1.0572
[09/26 02:32:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.47	
[09/26 02:32:18 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.006847630789658388
[09/26 02:32:25 visual_prompt]: Epoch 98 / 100: avg data time: 4.74e-02, avg batch time: 0.4921, average train loss: 0.0002
[09/26 02:32:26 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1677, average loss: 1.0573
[09/26 02:32:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.47	
[09/26 02:32:26 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.003044937175219753
[09/26 02:32:33 visual_prompt]: Epoch 99 / 100: avg data time: 5.29e-02, avg batch time: 0.4972, average train loss: 0.0003
[09/26 02:32:35 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1677, average loss: 1.0573
[09/26 02:32:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.47	
[09/26 02:32:35 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0007614662261302974
[09/26 02:32:41 visual_prompt]: Epoch 100 / 100: avg data time: 5.52e-02, avg batch time: 0.4999, average train loss: 0.0003
[09/26 02:32:43 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1674, average loss: 1.0573
[09/26 02:32:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.47	
[09/26 02:32:43 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 02:32:43 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 02:32:43 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 02:32:43 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 02:32:43 visual_prompt]: Training with config:
[09/26 02:32:43 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr1.0_wd0.01/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.01, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 1.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 02:32:43 visual_prompt]: Loading training data...
[09/26 02:32:43 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 02:32:44 visual_prompt]: Number of images: 800
[09/26 02:32:44 visual_prompt]: Number of classes: 2 / 2
[09/26 02:32:44 visual_prompt]: Loading validation data...
[09/26 02:32:44 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 02:32:44 visual_prompt]: Number of images: 200
[09/26 02:32:44 visual_prompt]: Number of classes: 2 / 2
[09/26 02:32:44 visual_prompt]: Constructing models...
[09/26 02:32:47 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 02:32:47 visual_prompt]: tuned percent:0.536
[09/26 02:32:47 visual_prompt]: Device used for model: 0
[09/26 02:32:47 visual_prompt]: Setting up Evaluator...
[09/26 02:32:47 visual_prompt]: Setting up Trainer...
[09/26 02:32:47 visual_prompt]: 	Setting up the optimizer...
[09/26 02:32:47 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 02:32:54 visual_prompt]: Epoch 1 / 100: avg data time: 5.32e-02, avg batch time: 0.4962, average train loss: 1.9713
[09/26 02:32:55 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1670, average loss: 2.0033
[09/26 02:32:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 02:32:55 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 02:32:55 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.1
[09/26 02:33:02 visual_prompt]: Epoch 2 / 100: avg data time: 5.00e-02, avg batch time: 0.4941, average train loss: 4.4031
[09/26 02:33:03 visual_prompt]: Inference (val):avg data time: 3.95e-05, avg batch time: 0.1672, average loss: 1.0041
[09/26 02:33:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 65.32	
[09/26 02:33:03 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.2
[09/26 02:33:10 visual_prompt]: Epoch 3 / 100: avg data time: 4.43e-02, avg batch time: 0.4877, average train loss: 0.7727
[09/26 02:33:11 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1671, average loss: 0.6488
[09/26 02:33:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 62.50	rocauc: 82.65	
[09/26 02:33:11 visual_prompt]: Best epoch 3: best metric: 0.625
[09/26 02:33:11 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.3
[09/26 02:33:18 visual_prompt]: Epoch 4 / 100: avg data time: 4.10e-02, avg batch time: 0.4858, average train loss: 0.6323
[09/26 02:33:19 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1667, average loss: 0.6095
[09/26 02:33:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.00	rocauc: 89.27	
[09/26 02:33:19 visual_prompt]: Training 5 / 100 epoch, with learning rate 0.4
[09/26 02:33:26 visual_prompt]: Epoch 5 / 100: avg data time: 5.62e-02, avg batch time: 0.4997, average train loss: 0.6880
[09/26 02:33:28 visual_prompt]: Inference (val):avg data time: 3.89e-05, avg batch time: 0.1675, average loss: 0.5956
[09/26 02:33:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.50	rocauc: 88.89	
[09/26 02:33:28 visual_prompt]: Best epoch 5: best metric: 0.705
[09/26 02:33:28 visual_prompt]: Training 6 / 100 epoch, with learning rate 0.5
[09/26 02:33:34 visual_prompt]: Epoch 6 / 100: avg data time: 5.35e-02, avg batch time: 0.4986, average train loss: 0.7370
[09/26 02:33:36 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1670, average loss: 0.7158
[09/26 02:33:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 87.99	
[09/26 02:33:36 visual_prompt]: Training 7 / 100 epoch, with learning rate 0.6
[09/26 02:33:42 visual_prompt]: Epoch 7 / 100: avg data time: 5.15e-02, avg batch time: 0.4940, average train loss: 0.7338
[09/26 02:33:44 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1675, average loss: 0.7113
[09/26 02:33:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.64	
[09/26 02:33:44 visual_prompt]: Training 8 / 100 epoch, with learning rate 0.7
[09/26 02:33:51 visual_prompt]: Epoch 8 / 100: avg data time: 4.09e-02, avg batch time: 0.4859, average train loss: 0.7272
[09/26 02:33:52 visual_prompt]: Inference (val):avg data time: 3.03e-05, avg batch time: 0.1671, average loss: 0.7972
[09/26 02:33:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 89.09	
[09/26 02:33:52 visual_prompt]: Training 9 / 100 epoch, with learning rate 0.8
[09/26 02:33:59 visual_prompt]: Epoch 9 / 100: avg data time: 5.20e-02, avg batch time: 0.4954, average train loss: 0.7136
[09/26 02:34:00 visual_prompt]: Inference (val):avg data time: 3.16e-05, avg batch time: 0.1671, average loss: 1.5699
[09/26 02:34:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 24.01	
[09/26 02:34:00 visual_prompt]: Training 10 / 100 epoch, with learning rate 0.9
[09/26 02:34:07 visual_prompt]: Epoch 10 / 100: avg data time: 4.98e-02, avg batch time: 0.4932, average train loss: 0.8374
[09/26 02:34:08 visual_prompt]: Inference (val):avg data time: 3.04e-05, avg batch time: 0.1674, average loss: 1.0090
[09/26 02:34:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 59.43	
[09/26 02:34:08 visual_prompt]: Training 11 / 100 epoch, with learning rate 1.0
[09/26 02:34:15 visual_prompt]: Epoch 11 / 100: avg data time: 4.63e-02, avg batch time: 0.4892, average train loss: 0.8726
[09/26 02:34:16 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1670, average loss: 0.7077
[09/26 02:34:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 86.06	
[09/26 02:34:16 visual_prompt]: Training 12 / 100 epoch, with learning rate 0.9996954135095479
[09/26 02:34:23 visual_prompt]: Epoch 12 / 100: avg data time: 4.66e-02, avg batch time: 0.4908, average train loss: 0.8596
[09/26 02:34:24 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1673, average loss: 0.7810
[09/26 02:34:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 54.50	rocauc: 49.57	
[09/26 02:34:24 visual_prompt]: Training 13 / 100 epoch, with learning rate 0.9987820251299121
[09/26 02:34:31 visual_prompt]: Epoch 13 / 100: avg data time: 5.64e-02, avg batch time: 0.4996, average train loss: 1.1038
[09/26 02:34:32 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1671, average loss: 0.7287
[09/26 02:34:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.29	
[09/26 02:34:32 visual_prompt]: Training 14 / 100 epoch, with learning rate 0.9972609476841366
[09/26 02:34:39 visual_prompt]: Epoch 14 / 100: avg data time: 4.46e-02, avg batch time: 0.4884, average train loss: 0.7900
[09/26 02:34:41 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1670, average loss: 0.8076
[09/26 02:34:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 88.54	
[09/26 02:34:41 visual_prompt]: Training 15 / 100 epoch, with learning rate 0.9951340343707852
[09/26 02:34:47 visual_prompt]: Epoch 15 / 100: avg data time: 5.28e-02, avg batch time: 0.4967, average train loss: 0.8473
[09/26 02:34:49 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1672, average loss: 1.0674
[09/26 02:34:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 41.40	
[09/26 02:34:49 visual_prompt]: Training 16 / 100 epoch, with learning rate 0.9924038765061041
[09/26 02:34:55 visual_prompt]: Epoch 16 / 100: avg data time: 4.19e-02, avg batch time: 0.4887, average train loss: 1.3420
[09/26 02:34:57 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1671, average loss: 0.7020
[09/26 02:34:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 76.72	
[09/26 02:34:57 visual_prompt]: Training 17 / 100 epoch, with learning rate 0.9890738003669028
[09/26 02:35:03 visual_prompt]: Epoch 17 / 100: avg data time: 4.16e-02, avg batch time: 0.4862, average train loss: 0.8274
[09/26 02:35:05 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1671, average loss: 1.1406
[09/26 02:35:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.51	
[09/26 02:35:05 visual_prompt]: Training 18 / 100 epoch, with learning rate 0.9851478631379982
[09/26 02:35:11 visual_prompt]: Epoch 18 / 100: avg data time: 4.18e-02, avg batch time: 0.4874, average train loss: 0.9300
[09/26 02:35:13 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1673, average loss: 1.1995
[09/26 02:35:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 81.10	
[09/26 02:35:13 visual_prompt]: Training 19 / 100 epoch, with learning rate 0.9806308479691594
[09/26 02:35:20 visual_prompt]: Epoch 19 / 100: avg data time: 4.49e-02, avg batch time: 0.4896, average train loss: 0.9402
[09/26 02:35:21 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1671, average loss: 0.6952
[09/26 02:35:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 41.26	
[09/26 02:35:21 visual_prompt]: Training 20 / 100 epoch, with learning rate 0.9755282581475768
[09/26 02:35:28 visual_prompt]: Epoch 20 / 100: avg data time: 4.86e-02, avg batch time: 0.4917, average train loss: 1.0605
[09/26 02:35:29 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1673, average loss: 0.7818
[09/26 02:35:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 75.93	
[09/26 02:35:29 visual_prompt]: Training 21 / 100 epoch, with learning rate 0.9698463103929542
[09/26 02:35:36 visual_prompt]: Epoch 21 / 100: avg data time: 4.29e-02, avg batch time: 0.4884, average train loss: 0.8589
[09/26 02:35:37 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1673, average loss: 0.7343
[09/26 02:35:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 69.31	
[09/26 02:35:37 visual_prompt]: Training 22 / 100 epoch, with learning rate 0.9635919272833937
[09/26 02:35:44 visual_prompt]: Epoch 22 / 100: avg data time: 5.52e-02, avg batch time: 0.4988, average train loss: 0.7935
[09/26 02:35:45 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1672, average loss: 0.7150
[09/26 02:35:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 81.51	
[09/26 02:35:45 visual_prompt]: Training 23 / 100 epoch, with learning rate 0.9567727288213004
[09/26 02:35:52 visual_prompt]: Epoch 23 / 100: avg data time: 5.01e-02, avg batch time: 0.4932, average train loss: 0.7954
[09/26 02:35:54 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1675, average loss: 0.6880
[09/26 02:35:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 82.08	
[09/26 02:35:54 visual_prompt]: Training 24 / 100 epoch, with learning rate 0.9493970231495835
[09/26 02:36:00 visual_prompt]: Epoch 24 / 100: avg data time: 4.61e-02, avg batch time: 0.4925, average train loss: 0.8352
[09/26 02:36:02 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1674, average loss: 1.0352
[09/26 02:36:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 73.23	
[09/26 02:36:02 visual_prompt]: Training 25 / 100 epoch, with learning rate 0.9414737964294635
[09/26 02:36:08 visual_prompt]: Epoch 25 / 100: avg data time: 4.40e-02, avg batch time: 0.4895, average train loss: 1.1704
[09/26 02:36:10 visual_prompt]: Inference (val):avg data time: 3.16e-05, avg batch time: 0.1676, average loss: 1.3337
[09/26 02:36:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 57.45	
[09/26 02:36:10 visual_prompt]: Training 26 / 100 epoch, with learning rate 0.9330127018922194
[09/26 02:36:17 visual_prompt]: Epoch 26 / 100: avg data time: 4.98e-02, avg batch time: 0.4965, average train loss: 1.1652
[09/26 02:36:18 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1674, average loss: 1.0026
[09/26 02:36:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 80.30	
[09/26 02:36:18 visual_prompt]: Training 27 / 100 epoch, with learning rate 0.9240240480782129
[09/26 02:36:25 visual_prompt]: Epoch 27 / 100: avg data time: 4.29e-02, avg batch time: 0.4888, average train loss: 1.3387
[09/26 02:36:26 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1674, average loss: 2.7144
[09/26 02:36:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 52.56	
[09/26 02:36:26 visual_prompt]: Training 28 / 100 epoch, with learning rate 0.9145187862775208
[09/26 02:36:33 visual_prompt]: Epoch 28 / 100: avg data time: 4.12e-02, avg batch time: 0.4864, average train loss: 0.9077
[09/26 02:36:34 visual_prompt]: Inference (val):avg data time: 3.15e-05, avg batch time: 0.1676, average loss: 0.6873
[09/26 02:36:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 64.10	
[09/26 02:36:34 visual_prompt]: Training 29 / 100 epoch, with learning rate 0.9045084971874737
[09/26 02:36:41 visual_prompt]: Epoch 29 / 100: avg data time: 5.52e-02, avg batch time: 0.4994, average train loss: 0.7121
[09/26 02:36:42 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1675, average loss: 0.6760
[09/26 02:36:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 57.00	rocauc: 82.21	
[09/26 02:36:42 visual_prompt]: Training 30 / 100 epoch, with learning rate 0.8940053768033609
[09/26 02:36:49 visual_prompt]: Epoch 30 / 100: avg data time: 5.70e-02, avg batch time: 0.5008, average train loss: 0.8305
[09/26 02:36:51 visual_prompt]: Inference (val):avg data time: 2.76e-05, avg batch time: 0.1676, average loss: 0.6983
[09/26 02:36:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 35.89	
[09/26 02:36:51 visual_prompt]: Training 31 / 100 epoch, with learning rate 0.883022221559489
[09/26 02:36:57 visual_prompt]: Epoch 31 / 100: avg data time: 4.01e-02, avg batch time: 0.4843, average train loss: 1.0874
[09/26 02:36:59 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1676, average loss: 0.6988
[09/26 02:36:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 52.45	
[09/26 02:36:59 visual_prompt]: Training 32 / 100 epoch, with learning rate 0.8715724127386971
[09/26 02:37:05 visual_prompt]: Epoch 32 / 100: avg data time: 5.13e-02, avg batch time: 0.4957, average train loss: 0.9726
[09/26 02:37:07 visual_prompt]: Inference (val):avg data time: 3.37e-05, avg batch time: 0.1677, average loss: 0.7233
[09/26 02:37:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 42.19	
[09/26 02:37:07 visual_prompt]: Training 33 / 100 epoch, with learning rate 0.8596699001693255
[09/26 02:37:13 visual_prompt]: Epoch 33 / 100: avg data time: 4.92e-02, avg batch time: 0.4943, average train loss: 0.7690
[09/26 02:37:15 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1673, average loss: 0.7280
[09/26 02:37:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 75.32	
[09/26 02:37:15 visual_prompt]: Training 34 / 100 epoch, with learning rate 0.8473291852294986
[09/26 02:37:22 visual_prompt]: Epoch 34 / 100: avg data time: 5.54e-02, avg batch time: 0.5001, average train loss: 0.8177
[09/26 02:37:23 visual_prompt]: Inference (val):avg data time: 4.76e-05, avg batch time: 0.1675, average loss: 0.7760
[09/26 02:37:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 48.68	
[09/26 02:37:23 visual_prompt]: Training 35 / 100 epoch, with learning rate 0.8345653031794291
[09/26 02:37:30 visual_prompt]: Epoch 35 / 100: avg data time: 5.84e-02, avg batch time: 0.5014, average train loss: 0.8002
[09/26 02:37:31 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1671, average loss: 0.9528
[09/26 02:37:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 69.29	
[09/26 02:37:31 visual_prompt]: Training 36 / 100 epoch, with learning rate 0.8213938048432696
[09/26 02:37:38 visual_prompt]: Epoch 36 / 100: avg data time: 5.28e-02, avg batch time: 0.4967, average train loss: 0.9079
[09/26 02:37:39 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1676, average loss: 0.6945
[09/26 02:37:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 44.58	
[09/26 02:37:39 visual_prompt]: Training 37 / 100 epoch, with learning rate 0.8078307376628291
[09/26 02:37:46 visual_prompt]: Epoch 37 / 100: avg data time: 5.10e-02, avg batch time: 0.4945, average train loss: 0.8003
[09/26 02:37:48 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1672, average loss: 0.6932
[09/26 02:37:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 53.77	
[09/26 02:37:48 visual_prompt]: Training 38 / 100 epoch, with learning rate 0.7938926261462366
[09/26 02:37:54 visual_prompt]: Epoch 38 / 100: avg data time: 4.53e-02, avg batch time: 0.4902, average train loss: 0.7857
[09/26 02:37:56 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1674, average loss: 0.6975
[09/26 02:37:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.10	
[09/26 02:37:56 visual_prompt]: Training 39 / 100 epoch, with learning rate 0.7795964517353734
[09/26 02:38:02 visual_prompt]: Epoch 39 / 100: avg data time: 5.42e-02, avg batch time: 0.4986, average train loss: 0.7135
[09/26 02:38:04 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1677, average loss: 0.7134
[09/26 02:38:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 82.47	
[09/26 02:38:04 visual_prompt]: Training 40 / 100 epoch, with learning rate 0.7649596321166025
[09/26 02:38:11 visual_prompt]: Epoch 40 / 100: avg data time: 5.47e-02, avg batch time: 0.4996, average train loss: 0.7611
[09/26 02:38:12 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1676, average loss: 0.7106
[09/26 02:38:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 81.37	
[09/26 02:38:12 visual_prompt]: Training 41 / 100 epoch, with learning rate 0.75
[09/26 02:38:19 visual_prompt]: Epoch 41 / 100: avg data time: 5.62e-02, avg batch time: 0.4998, average train loss: 0.7246
[09/26 02:38:20 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1674, average loss: 0.7381
[09/26 02:38:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 70.16	
[09/26 02:38:20 visual_prompt]: Training 42 / 100 epoch, with learning rate 0.7347357813929454
[09/26 02:38:27 visual_prompt]: Epoch 42 / 100: avg data time: 5.25e-02, avg batch time: 0.4975, average train loss: 0.7089
[09/26 02:38:28 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1671, average loss: 0.8161
[09/26 02:38:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.23	
[09/26 02:38:28 visual_prompt]: Training 43 / 100 epoch, with learning rate 0.7191855733945387
[09/26 02:38:35 visual_prompt]: Epoch 43 / 100: avg data time: 5.80e-02, avg batch time: 0.5014, average train loss: 0.7244
[09/26 02:38:37 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1675, average loss: 0.7691
[09/26 02:38:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 86.21	
[09/26 02:38:37 visual_prompt]: Training 44 / 100 epoch, with learning rate 0.7033683215379002
[09/26 02:38:43 visual_prompt]: Epoch 44 / 100: avg data time: 5.75e-02, avg batch time: 0.5030, average train loss: 0.7666
[09/26 02:38:45 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1672, average loss: 0.6885
[09/26 02:38:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.33	
[09/26 02:38:45 visual_prompt]: Training 45 / 100 epoch, with learning rate 0.6873032967079561
[09/26 02:38:52 visual_prompt]: Epoch 45 / 100: avg data time: 5.56e-02, avg batch time: 0.4996, average train loss: 0.7433
[09/26 02:38:53 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1672, average loss: 0.7036
[09/26 02:38:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.44	
[09/26 02:38:53 visual_prompt]: Training 46 / 100 epoch, with learning rate 0.6710100716628344
[09/26 02:39:00 visual_prompt]: Epoch 46 / 100: avg data time: 4.65e-02, avg batch time: 0.4908, average train loss: 0.7477
[09/26 02:39:01 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1672, average loss: 0.7517
[09/26 02:39:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 29.71	
[09/26 02:39:01 visual_prompt]: Training 47 / 100 epoch, with learning rate 0.6545084971874737
[09/26 02:39:08 visual_prompt]: Epoch 47 / 100: avg data time: 4.88e-02, avg batch time: 0.4924, average train loss: 1.1187
[09/26 02:39:09 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1672, average loss: 0.7002
[09/26 02:39:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 44.41	
[09/26 02:39:09 visual_prompt]: Training 48 / 100 epoch, with learning rate 0.6378186779084996
[09/26 02:39:16 visual_prompt]: Epoch 48 / 100: avg data time: 3.86e-02, avg batch time: 0.4837, average train loss: 0.8438
[09/26 02:39:17 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1673, average loss: 0.8870
[09/26 02:39:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.24	
[09/26 02:39:17 visual_prompt]: Training 49 / 100 epoch, with learning rate 0.6209609477998338
[09/26 02:39:24 visual_prompt]: Epoch 49 / 100: avg data time: 4.20e-02, avg batch time: 0.4871, average train loss: 0.7250
[09/26 02:39:25 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1675, average loss: 0.6947
[09/26 02:39:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.12	
[09/26 02:39:25 visual_prompt]: Training 50 / 100 epoch, with learning rate 0.6039558454088796
[09/26 02:39:32 visual_prompt]: Epoch 50 / 100: avg data time: 4.45e-02, avg batch time: 0.4903, average train loss: 0.7901
[09/26 02:39:33 visual_prompt]: Inference (val):avg data time: 3.50e-05, avg batch time: 0.1674, average loss: 0.8070
[09/26 02:39:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 75.16	
[09/26 02:39:33 visual_prompt]: Training 51 / 100 epoch, with learning rate 0.5868240888334653
[09/26 02:39:40 visual_prompt]: Epoch 51 / 100: avg data time: 4.14e-02, avg batch time: 0.4865, average train loss: 0.7799
[09/26 02:39:41 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1673, average loss: 0.7125
[09/26 02:39:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 40.97	
[09/26 02:39:41 visual_prompt]: Training 52 / 100 epoch, with learning rate 0.5695865504800327
[09/26 02:39:48 visual_prompt]: Epoch 52 / 100: avg data time: 5.82e-02, avg batch time: 0.5030, average train loss: 0.7069
[09/26 02:39:50 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1670, average loss: 0.6888
[09/26 02:39:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.36	
[09/26 02:39:50 visual_prompt]: Training 53 / 100 epoch, with learning rate 0.5522642316338268
[09/26 02:39:56 visual_prompt]: Epoch 53 / 100: avg data time: 5.64e-02, avg batch time: 0.5009, average train loss: 0.7472
[09/26 02:39:58 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1673, average loss: 0.6170
[09/26 02:39:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.50	rocauc: 83.17	
[09/26 02:39:58 visual_prompt]: Training 54 / 100 epoch, with learning rate 0.5348782368720626
[09/26 02:40:05 visual_prompt]: Epoch 54 / 100: avg data time: 5.00e-02, avg batch time: 0.4950, average train loss: 0.6907
[09/26 02:40:06 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1679, average loss: 0.7657
[09/26 02:40:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 81.49	
[09/26 02:40:06 visual_prompt]: Training 55 / 100 epoch, with learning rate 0.5174497483512506
[09/26 02:40:13 visual_prompt]: Epoch 55 / 100: avg data time: 6.22e-02, avg batch time: 0.5061, average train loss: 0.7152
[09/26 02:40:14 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1677, average loss: 0.7625
[09/26 02:40:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 67.49	
[09/26 02:40:14 visual_prompt]: Training 56 / 100 epoch, with learning rate 0.5
[09/26 02:40:21 visual_prompt]: Epoch 56 / 100: avg data time: 4.45e-02, avg batch time: 0.4887, average train loss: 0.7323
[09/26 02:40:22 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1669, average loss: 0.9175
[09/26 02:40:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 77.92	
[09/26 02:40:22 visual_prompt]: Training 57 / 100 epoch, with learning rate 0.48255025164874965
[09/26 02:40:29 visual_prompt]: Epoch 57 / 100: avg data time: 4.21e-02, avg batch time: 0.4864, average train loss: 0.7624
[09/26 02:40:30 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1676, average loss: 0.6916
[09/26 02:40:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 86.24	
[09/26 02:40:30 visual_prompt]: Training 58 / 100 epoch, with learning rate 0.46512176312793735
[09/26 02:40:37 visual_prompt]: Epoch 58 / 100: avg data time: 4.04e-02, avg batch time: 0.4856, average train loss: 0.7036
[09/26 02:40:38 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1673, average loss: 0.7523
[09/26 02:40:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 88.66	
[09/26 02:40:38 visual_prompt]: Training 59 / 100 epoch, with learning rate 0.44773576836617335
[09/26 02:40:45 visual_prompt]: Epoch 59 / 100: avg data time: 4.73e-02, avg batch time: 0.4913, average train loss: 0.7065
[09/26 02:40:46 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1675, average loss: 0.6697
[09/26 02:40:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.69	
[09/26 02:40:46 visual_prompt]: Training 60 / 100 epoch, with learning rate 0.4304134495199674
[09/26 02:40:53 visual_prompt]: Epoch 60 / 100: avg data time: 4.05e-02, avg batch time: 0.4851, average train loss: 0.7108
[09/26 02:40:54 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1675, average loss: 0.7025
[09/26 02:40:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 71.28	
[09/26 02:40:54 visual_prompt]: Training 61 / 100 epoch, with learning rate 0.41317591116653485
[09/26 02:41:01 visual_prompt]: Epoch 61 / 100: avg data time: 4.67e-02, avg batch time: 0.4902, average train loss: 0.7201
[09/26 02:41:02 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1675, average loss: 0.6888
[09/26 02:41:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.67	
[09/26 02:41:02 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.3960441545911204
[09/26 02:41:09 visual_prompt]: Epoch 62 / 100: avg data time: 4.36e-02, avg batch time: 0.4880, average train loss: 0.7211
[09/26 02:41:11 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1672, average loss: 0.6903
[09/26 02:41:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 81.29	
[09/26 02:41:11 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.3790390522001662
[09/26 02:41:17 visual_prompt]: Epoch 63 / 100: avg data time: 4.59e-02, avg batch time: 0.4918, average train loss: 0.7051
[09/26 02:41:19 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1674, average loss: 0.6961
[09/26 02:41:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 83.67	
[09/26 02:41:19 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.36218132209150045
[09/26 02:41:25 visual_prompt]: Epoch 64 / 100: avg data time: 4.16e-02, avg batch time: 0.4861, average train loss: 0.7031
[09/26 02:41:27 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1676, average loss: 0.6650
[09/26 02:41:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 63.50	rocauc: 84.94	
[09/26 02:41:27 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.34549150281252633
[09/26 02:41:33 visual_prompt]: Epoch 65 / 100: avg data time: 5.63e-02, avg batch time: 0.4993, average train loss: 0.6816
[09/26 02:41:35 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1674, average loss: 0.7494
[09/26 02:41:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.49	
[09/26 02:41:35 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.32898992833716567
[09/26 02:41:41 visual_prompt]: Epoch 66 / 100: avg data time: 5.27e-02, avg batch time: 0.4968, average train loss: 0.6891
[09/26 02:41:43 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1675, average loss: 0.6789
[09/26 02:41:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.04	
[09/26 02:41:43 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.31269670329204396
[09/26 02:41:50 visual_prompt]: Epoch 67 / 100: avg data time: 5.61e-02, avg batch time: 0.5006, average train loss: 0.7503
[09/26 02:41:51 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1674, average loss: 0.7830
[09/26 02:41:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 53.00	rocauc: 74.32	
[09/26 02:41:51 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.2966316784621
[09/26 02:41:58 visual_prompt]: Epoch 68 / 100: avg data time: 4.22e-02, avg batch time: 0.4870, average train loss: 0.7355
[09/26 02:41:59 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1679, average loss: 0.6893
[09/26 02:41:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.32	
[09/26 02:41:59 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.28081442660546124
[09/26 02:42:06 visual_prompt]: Epoch 69 / 100: avg data time: 5.50e-02, avg batch time: 0.4996, average train loss: 0.7030
[09/26 02:42:07 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1672, average loss: 0.6894
[09/26 02:42:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 79.38	
[09/26 02:42:07 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.26526421860705474
[09/26 02:42:14 visual_prompt]: Epoch 70 / 100: avg data time: 4.93e-02, avg batch time: 0.4927, average train loss: 0.7106
[09/26 02:42:16 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1674, average loss: 0.6871
[09/26 02:42:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 68.50	rocauc: 85.45	
[09/26 02:42:16 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.2500000000000001
[09/26 02:42:22 visual_prompt]: Epoch 71 / 100: avg data time: 4.78e-02, avg batch time: 0.4922, average train loss: 0.6942
[09/26 02:42:24 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1676, average loss: 0.6811
[09/26 02:42:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 72.36	
[09/26 02:42:24 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.2350403678833976
[09/26 02:42:30 visual_prompt]: Epoch 72 / 100: avg data time: 4.80e-02, avg batch time: 0.4915, average train loss: 0.7139
[09/26 02:42:32 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1676, average loss: 0.6848
[09/26 02:42:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 69.00	rocauc: 82.59	
[09/26 02:42:32 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.22040354826462666
[09/26 02:42:39 visual_prompt]: Epoch 73 / 100: avg data time: 5.65e-02, avg batch time: 0.5016, average train loss: 0.6934
[09/26 02:42:40 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1675, average loss: 0.6795
[09/26 02:42:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 54.00	rocauc: 83.51	
[09/26 02:42:40 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.2061073738537635
[09/26 02:42:47 visual_prompt]: Epoch 74 / 100: avg data time: 4.29e-02, avg batch time: 0.4866, average train loss: 0.6776
[09/26 02:42:48 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1673, average loss: 0.6217
[09/26 02:42:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 71.00	rocauc: 83.13	
[09/26 02:42:48 visual_prompt]: Best epoch 74: best metric: 0.710
[09/26 02:42:48 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.19216926233717085
[09/26 02:42:55 visual_prompt]: Epoch 75 / 100: avg data time: 5.34e-02, avg batch time: 0.4976, average train loss: 0.8411
[09/26 02:42:56 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1672, average loss: 0.6306
[09/26 02:42:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 50.50	rocauc: 64.75	
[09/26 02:42:56 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.17860619515673032
[09/26 02:43:03 visual_prompt]: Epoch 76 / 100: avg data time: 6.14e-02, avg batch time: 0.5045, average train loss: 0.7652
[09/26 02:43:05 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1674, average loss: 0.6705
[09/26 02:43:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.00	rocauc: 84.98	
[09/26 02:43:05 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.16543469682057105
[09/26 02:43:11 visual_prompt]: Epoch 77 / 100: avg data time: 4.51e-02, avg batch time: 0.4898, average train loss: 0.6436
[09/26 02:43:13 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1672, average loss: 0.5695
[09/26 02:43:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.50	rocauc: 87.32	
[09/26 02:43:13 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.15267081477050132
[09/26 02:43:19 visual_prompt]: Epoch 78 / 100: avg data time: 5.51e-02, avg batch time: 0.4993, average train loss: 0.6410
[09/26 02:43:21 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1672, average loss: 0.5215
[09/26 02:43:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 71.00	rocauc: 88.05	
[09/26 02:43:21 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.14033009983067452
[09/26 02:43:28 visual_prompt]: Epoch 79 / 100: avg data time: 5.02e-02, avg batch time: 0.4960, average train loss: 0.5942
[09/26 02:43:29 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1674, average loss: 0.5181
[09/26 02:43:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 89.27	
[09/26 02:43:29 visual_prompt]: Best epoch 79: best metric: 0.835
[09/26 02:43:29 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.12842758726130282
[09/26 02:43:35 visual_prompt]: Epoch 80 / 100: avg data time: 3.97e-02, avg batch time: 0.4858, average train loss: 0.5725
[09/26 02:43:37 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1672, average loss: 0.4681
[09/26 02:43:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 87.82	
[09/26 02:43:37 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.11697777844051105
[09/26 02:43:44 visual_prompt]: Epoch 81 / 100: avg data time: 4.06e-02, avg batch time: 0.4863, average train loss: 0.5738
[09/26 02:43:45 visual_prompt]: Inference (val):avg data time: 4.27e-05, avg batch time: 0.1673, average loss: 0.6043
[09/26 02:43:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 69.50	rocauc: 80.33	
[09/26 02:43:45 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.10599462319663905
[09/26 02:43:52 visual_prompt]: Epoch 82 / 100: avg data time: 4.80e-02, avg batch time: 0.4931, average train loss: 0.5954
[09/26 02:43:53 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1675, average loss: 0.4556
[09/26 02:43:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 91.22	
[09/26 02:43:53 visual_prompt]: Best epoch 82: best metric: 0.850
[09/26 02:43:53 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.09549150281252633
[09/26 02:44:00 visual_prompt]: Epoch 83 / 100: avg data time: 4.10e-02, avg batch time: 0.4860, average train loss: 0.6607
[09/26 02:44:01 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1674, average loss: 0.6786
[09/26 02:44:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 54.00	rocauc: 91.07	
[09/26 02:44:01 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.08548121372247919
[09/26 02:44:08 visual_prompt]: Epoch 84 / 100: avg data time: 4.57e-02, avg batch time: 0.4912, average train loss: 0.6717
[09/26 02:44:09 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1671, average loss: 0.5658
[09/26 02:44:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.50	rocauc: 90.84	
[09/26 02:44:09 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.07597595192178702
[09/26 02:44:16 visual_prompt]: Epoch 85 / 100: avg data time: 5.30e-02, avg batch time: 0.4976, average train loss: 0.5903
[09/26 02:44:17 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1675, average loss: 0.5011
[09/26 02:44:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 90.39	
[09/26 02:44:17 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.06698729810778065
[09/26 02:44:24 visual_prompt]: Epoch 86 / 100: avg data time: 4.48e-02, avg batch time: 0.4908, average train loss: 0.5631
[09/26 02:44:25 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1675, average loss: 0.5366
[09/26 02:44:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.50	rocauc: 91.14	
[09/26 02:44:25 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.058526203570536506
[09/26 02:44:32 visual_prompt]: Epoch 87 / 100: avg data time: 5.31e-02, avg batch time: 0.4980, average train loss: 0.5353
[09/26 02:44:34 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1675, average loss: 0.4302
[09/26 02:44:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 92.12	
[09/26 02:44:34 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.05060297685041659
[09/26 02:44:40 visual_prompt]: Epoch 88 / 100: avg data time: 4.85e-02, avg batch time: 0.4926, average train loss: 0.4846
[09/26 02:44:42 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1676, average loss: 0.4482
[09/26 02:44:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 91.59	
[09/26 02:44:42 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.04322727117869951
[09/26 02:44:48 visual_prompt]: Epoch 89 / 100: avg data time: 4.04e-02, avg batch time: 0.4861, average train loss: 0.4943
[09/26 02:44:50 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1674, average loss: 0.4308
[09/26 02:44:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.29	
[09/26 02:44:50 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.03640807271660634
[09/26 02:44:57 visual_prompt]: Epoch 90 / 100: avg data time: 5.67e-02, avg batch time: 0.5006, average train loss: 0.4388
[09/26 02:44:58 visual_prompt]: Inference (val):avg data time: 3.09e-05, avg batch time: 0.1674, average loss: 0.4114
[09/26 02:44:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.55	
[09/26 02:44:58 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.03015368960704584
[09/26 02:45:05 visual_prompt]: Epoch 91 / 100: avg data time: 5.18e-02, avg batch time: 0.4961, average train loss: 0.4036
[09/26 02:45:06 visual_prompt]: Inference (val):avg data time: 3.31e-05, avg batch time: 0.1674, average loss: 0.4231
[09/26 02:45:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 92.69	
[09/26 02:45:06 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.024471741852423234
[09/26 02:45:13 visual_prompt]: Epoch 92 / 100: avg data time: 5.37e-02, avg batch time: 0.5003, average train loss: 0.4041
[09/26 02:45:14 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1676, average loss: 0.3591
[09/26 02:45:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 92.47	
[09/26 02:45:14 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.019369152030840553
[09/26 02:45:21 visual_prompt]: Epoch 93 / 100: avg data time: 5.22e-02, avg batch time: 0.4961, average train loss: 0.3785
[09/26 02:45:23 visual_prompt]: Inference (val):avg data time: 3.52e-05, avg batch time: 0.1676, average loss: 0.3759
[09/26 02:45:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 92.53	
[09/26 02:45:23 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.014852136862001764
[09/26 02:45:29 visual_prompt]: Epoch 94 / 100: avg data time: 4.48e-02, avg batch time: 0.4906, average train loss: 0.3228
[09/26 02:45:31 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1674, average loss: 0.4106
[09/26 02:45:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.19	
[09/26 02:45:31 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.010926199633097156
[09/26 02:45:37 visual_prompt]: Epoch 95 / 100: avg data time: 5.16e-02, avg batch time: 0.4954, average train loss: 0.3146
[09/26 02:45:39 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1676, average loss: 0.4240
[09/26 02:45:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 92.41	
[09/26 02:45:39 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.00759612349389599
[09/26 02:45:45 visual_prompt]: Epoch 96 / 100: avg data time: 5.16e-02, avg batch time: 0.4953, average train loss: 0.3109
[09/26 02:45:47 visual_prompt]: Inference (val):avg data time: 3.73e-05, avg batch time: 0.1675, average loss: 0.4193
[09/26 02:45:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 93.24	
[09/26 02:45:47 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.004865965629214819
[09/26 02:45:54 visual_prompt]: Epoch 97 / 100: avg data time: 5.26e-02, avg batch time: 0.4971, average train loss: 0.2955
[09/26 02:45:55 visual_prompt]: Inference (val):avg data time: 3.13e-05, avg batch time: 0.1675, average loss: 0.3503
[09/26 02:45:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.90	
[09/26 02:45:55 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.002739052315863355
[09/26 02:46:02 visual_prompt]: Epoch 98 / 100: avg data time: 5.50e-02, avg batch time: 0.5001, average train loss: 0.2382
[09/26 02:46:03 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1679, average loss: 0.3757
[09/26 02:46:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.00	
[09/26 02:46:03 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.0012179748700879012
[09/26 02:46:10 visual_prompt]: Epoch 99 / 100: avg data time: 5.37e-02, avg batch time: 0.4985, average train loss: 0.2173
[09/26 02:46:11 visual_prompt]: Inference (val):avg data time: 2.70e-05, avg batch time: 0.1673, average loss: 0.3840
[09/26 02:46:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.01	
[09/26 02:46:11 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.00030458649045211894
[09/26 02:46:18 visual_prompt]: Epoch 100 / 100: avg data time: 5.77e-02, avg batch time: 0.5027, average train loss: 0.2174
[09/26 02:46:20 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1675, average loss: 0.3790
[09/26 02:46:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.13	
[09/26 02:46:20 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 02:46:20 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 02:46:20 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 02:46:20 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 02:46:20 visual_prompt]: Training with config:
[09/26 02:46:20 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr1.0_wd0.001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 1.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 02:46:20 visual_prompt]: Loading training data...
[09/26 02:46:20 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 02:46:21 visual_prompt]: Number of images: 800
[09/26 02:46:21 visual_prompt]: Number of classes: 2 / 2
[09/26 02:46:21 visual_prompt]: Loading validation data...
[09/26 02:46:21 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 02:46:21 visual_prompt]: Number of images: 200
[09/26 02:46:21 visual_prompt]: Number of classes: 2 / 2
[09/26 02:46:21 visual_prompt]: Constructing models...
[09/26 02:46:24 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 02:46:24 visual_prompt]: tuned percent:0.536
[09/26 02:46:24 visual_prompt]: Device used for model: 0
[09/26 02:46:24 visual_prompt]: Setting up Evaluator...
[09/26 02:46:24 visual_prompt]: Setting up Trainer...
[09/26 02:46:24 visual_prompt]: 	Setting up the optimizer...
[09/26 02:46:24 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 02:46:30 visual_prompt]: Epoch 1 / 100: avg data time: 4.47e-02, avg batch time: 0.4887, average train loss: 1.9690
[09/26 02:46:32 visual_prompt]: Inference (val):avg data time: 2.10e-05, avg batch time: 0.1668, average loss: 2.0033
[09/26 02:46:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 02:46:32 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 02:46:32 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.1
[09/26 02:46:38 visual_prompt]: Epoch 2 / 100: avg data time: 4.07e-02, avg batch time: 0.4842, average train loss: 4.5148
[09/26 02:46:40 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1672, average loss: 0.9952
[09/26 02:46:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 64.88	
[09/26 02:46:40 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.2
[09/26 02:46:46 visual_prompt]: Epoch 3 / 100: avg data time: 4.41e-02, avg batch time: 0.4885, average train loss: 0.8019
[09/26 02:46:48 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1671, average loss: 0.6947
[09/26 02:46:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.23	
[09/26 02:46:48 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.3
[09/26 02:46:54 visual_prompt]: Epoch 4 / 100: avg data time: 4.14e-02, avg batch time: 0.4846, average train loss: 0.6839
[09/26 02:46:56 visual_prompt]: Inference (val):avg data time: 2.99e-05, avg batch time: 0.1672, average loss: 0.6087
[09/26 02:46:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 89.47	
[09/26 02:46:56 visual_prompt]: Training 5 / 100 epoch, with learning rate 0.4
[09/26 02:47:03 visual_prompt]: Epoch 5 / 100: avg data time: 4.77e-02, avg batch time: 0.4923, average train loss: 0.5989
[09/26 02:47:04 visual_prompt]: Inference (val):avg data time: 3.12e-05, avg batch time: 0.1671, average loss: 0.9244
[09/26 02:47:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 90.29	
[09/26 02:47:04 visual_prompt]: Training 6 / 100 epoch, with learning rate 0.5
[09/26 02:47:11 visual_prompt]: Epoch 6 / 100: avg data time: 4.08e-02, avg batch time: 0.4854, average train loss: 0.6305
[09/26 02:47:12 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1674, average loss: 0.4759
[09/26 02:47:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 90.96	
[09/26 02:47:12 visual_prompt]: Best epoch 6: best metric: 0.800
[09/26 02:47:12 visual_prompt]: Training 7 / 100 epoch, with learning rate 0.6
[09/26 02:47:19 visual_prompt]: Epoch 7 / 100: avg data time: 4.77e-02, avg batch time: 0.4915, average train loss: 0.5898
[09/26 02:47:20 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1673, average loss: 0.6967
[09/26 02:47:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 89.58	
[09/26 02:47:20 visual_prompt]: Training 8 / 100 epoch, with learning rate 0.7
[09/26 02:47:27 visual_prompt]: Epoch 8 / 100: avg data time: 4.15e-02, avg batch time: 0.4867, average train loss: 0.6971
[09/26 02:47:28 visual_prompt]: Inference (val):avg data time: 4.63e-05, avg batch time: 0.1673, average loss: 0.5017
[09/26 02:47:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.50	rocauc: 91.47	
[09/26 02:47:28 visual_prompt]: Training 9 / 100 epoch, with learning rate 0.8
[09/26 02:47:35 visual_prompt]: Epoch 9 / 100: avg data time: 4.70e-02, avg batch time: 0.4925, average train loss: 0.5155
[09/26 02:47:36 visual_prompt]: Inference (val):avg data time: 3.22e-05, avg batch time: 0.1671, average loss: 0.4603
[09/26 02:47:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 92.39	
[09/26 02:47:36 visual_prompt]: Training 10 / 100 epoch, with learning rate 0.9
[09/26 02:47:43 visual_prompt]: Epoch 10 / 100: avg data time: 5.46e-02, avg batch time: 0.4990, average train loss: 0.5431
[09/26 02:47:45 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1677, average loss: 0.3863
[09/26 02:47:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.20	
[09/26 02:47:45 visual_prompt]: Best epoch 10: best metric: 0.835
[09/26 02:47:45 visual_prompt]: Training 11 / 100 epoch, with learning rate 1.0
[09/26 02:47:51 visual_prompt]: Epoch 11 / 100: avg data time: 4.17e-02, avg batch time: 0.4864, average train loss: 0.4646
[09/26 02:47:53 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1673, average loss: 0.3428
[09/26 02:47:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.69	
[09/26 02:47:53 visual_prompt]: Best epoch 11: best metric: 0.850
[09/26 02:47:53 visual_prompt]: Training 12 / 100 epoch, with learning rate 0.9996954135095479
[09/26 02:47:59 visual_prompt]: Epoch 12 / 100: avg data time: 5.74e-02, avg batch time: 0.5012, average train loss: 0.5039
[09/26 02:48:01 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1675, average loss: 1.6029
[09/26 02:48:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 92.50	
[09/26 02:48:01 visual_prompt]: Training 13 / 100 epoch, with learning rate 0.9987820251299121
[09/26 02:48:08 visual_prompt]: Epoch 13 / 100: avg data time: 5.86e-02, avg batch time: 0.5039, average train loss: 0.6684
[09/26 02:48:09 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1675, average loss: 0.5737
[09/26 02:48:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 64.00	rocauc: 93.07	
[09/26 02:48:09 visual_prompt]: Training 14 / 100 epoch, with learning rate 0.9972609476841366
[09/26 02:48:16 visual_prompt]: Epoch 14 / 100: avg data time: 5.74e-02, avg batch time: 0.5027, average train loss: 0.9508
[09/26 02:48:18 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1673, average loss: 0.8040
[09/26 02:48:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 88.83	
[09/26 02:48:18 visual_prompt]: Training 15 / 100 epoch, with learning rate 0.9951340343707852
[09/26 02:48:24 visual_prompt]: Epoch 15 / 100: avg data time: 5.09e-02, avg batch time: 0.4947, average train loss: 0.6820
[09/26 02:48:26 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1675, average loss: 0.9297
[09/26 02:48:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 50.50	rocauc: 92.14	
[09/26 02:48:26 visual_prompt]: Training 16 / 100 epoch, with learning rate 0.9924038765061041
[09/26 02:48:32 visual_prompt]: Epoch 16 / 100: avg data time: 5.61e-02, avg batch time: 0.5020, average train loss: 0.6912
[09/26 02:48:34 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1675, average loss: 0.7186
[09/26 02:48:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 93.25	
[09/26 02:48:34 visual_prompt]: Training 17 / 100 epoch, with learning rate 0.9890738003669028
[09/26 02:48:41 visual_prompt]: Epoch 17 / 100: avg data time: 4.39e-02, avg batch time: 0.4887, average train loss: 0.6066
[09/26 02:48:42 visual_prompt]: Inference (val):avg data time: 3.25e-05, avg batch time: 0.1676, average loss: 0.6128
[09/26 02:48:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 68.00	rocauc: 93.01	
[09/26 02:48:42 visual_prompt]: Training 18 / 100 epoch, with learning rate 0.9851478631379982
[09/26 02:48:49 visual_prompt]: Epoch 18 / 100: avg data time: 4.92e-02, avg batch time: 0.4961, average train loss: 0.5347
[09/26 02:48:50 visual_prompt]: Inference (val):avg data time: 3.20e-05, avg batch time: 0.1676, average loss: 0.4785
[09/26 02:48:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 90.93	
[09/26 02:48:50 visual_prompt]: Training 19 / 100 epoch, with learning rate 0.9806308479691594
[09/26 02:48:57 visual_prompt]: Epoch 19 / 100: avg data time: 4.49e-02, avg batch time: 0.4904, average train loss: 0.6061
[09/26 02:48:58 visual_prompt]: Inference (val):avg data time: 2.76e-05, avg batch time: 0.1675, average loss: 0.5849
[09/26 02:48:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.50	rocauc: 90.97	
[09/26 02:48:58 visual_prompt]: Training 20 / 100 epoch, with learning rate 0.9755282581475768
[09/26 02:49:05 visual_prompt]: Epoch 20 / 100: avg data time: 4.25e-02, avg batch time: 0.4877, average train loss: 0.4798
[09/26 02:49:06 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1674, average loss: 1.0323
[09/26 02:49:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 58.50	rocauc: 93.70	
[09/26 02:49:06 visual_prompt]: Training 21 / 100 epoch, with learning rate 0.9698463103929542
[09/26 02:49:13 visual_prompt]: Epoch 21 / 100: avg data time: 4.86e-02, avg batch time: 0.4939, average train loss: 0.6346
[09/26 02:49:14 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1675, average loss: 0.4765
[09/26 02:49:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 93.15	
[09/26 02:49:14 visual_prompt]: Training 22 / 100 epoch, with learning rate 0.9635919272833937
[09/26 02:49:21 visual_prompt]: Epoch 22 / 100: avg data time: 4.98e-02, avg batch time: 0.4943, average train loss: 0.4531
[09/26 02:49:23 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1675, average loss: 0.5043
[09/26 02:49:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 91.83	
[09/26 02:49:23 visual_prompt]: Training 23 / 100 epoch, with learning rate 0.9567727288213004
[09/26 02:49:29 visual_prompt]: Epoch 23 / 100: avg data time: 4.30e-02, avg batch time: 0.4878, average train loss: 0.4580
[09/26 02:49:31 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1677, average loss: 0.3726
[09/26 02:49:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.79	
[09/26 02:49:31 visual_prompt]: Training 24 / 100 epoch, with learning rate 0.9493970231495835
[09/26 02:49:37 visual_prompt]: Epoch 24 / 100: avg data time: 4.95e-02, avg batch time: 0.4954, average train loss: 0.5358
[09/26 02:49:39 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1671, average loss: 0.8045
[09/26 02:49:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 93.01	
[09/26 02:49:39 visual_prompt]: Training 25 / 100 epoch, with learning rate 0.9414737964294635
[09/26 02:49:46 visual_prompt]: Epoch 25 / 100: avg data time: 4.83e-02, avg batch time: 0.4937, average train loss: 0.6137
[09/26 02:49:47 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1674, average loss: 0.5370
[09/26 02:49:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 68.50	rocauc: 92.82	
[09/26 02:49:47 visual_prompt]: Training 26 / 100 epoch, with learning rate 0.9330127018922194
[09/26 02:49:54 visual_prompt]: Epoch 26 / 100: avg data time: 5.54e-02, avg batch time: 0.4988, average train loss: 0.7084
[09/26 02:49:55 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1673, average loss: 0.4488
[09/26 02:49:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.39	
[09/26 02:49:55 visual_prompt]: Training 27 / 100 epoch, with learning rate 0.9240240480782129
[09/26 02:50:02 visual_prompt]: Epoch 27 / 100: avg data time: 5.28e-02, avg batch time: 0.4975, average train loss: 0.5133
[09/26 02:50:03 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1675, average loss: 0.4709
[09/26 02:50:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 94.37	
[09/26 02:50:03 visual_prompt]: Training 28 / 100 epoch, with learning rate 0.9145187862775208
[09/26 02:50:10 visual_prompt]: Epoch 28 / 100: avg data time: 4.42e-02, avg batch time: 0.4890, average train loss: 0.4344
[09/26 02:50:11 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1674, average loss: 0.3669
[09/26 02:50:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 94.10	
[09/26 02:50:11 visual_prompt]: Training 29 / 100 epoch, with learning rate 0.9045084971874737
[09/26 02:50:18 visual_prompt]: Epoch 29 / 100: avg data time: 5.69e-02, avg batch time: 0.5019, average train loss: 0.4624
[09/26 02:50:20 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1674, average loss: 0.3684
[09/26 02:50:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 94.88	
[09/26 02:50:20 visual_prompt]: Training 30 / 100 epoch, with learning rate 0.8940053768033609
[09/26 02:50:26 visual_prompt]: Epoch 30 / 100: avg data time: 5.57e-02, avg batch time: 0.4996, average train loss: 0.3952
[09/26 02:50:28 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1674, average loss: 0.4876
[09/26 02:50:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.00	rocauc: 93.97	
[09/26 02:50:28 visual_prompt]: Training 31 / 100 epoch, with learning rate 0.883022221559489
[09/26 02:50:35 visual_prompt]: Epoch 31 / 100: avg data time: 4.45e-02, avg batch time: 0.4898, average train loss: 0.5096
[09/26 02:50:36 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1673, average loss: 0.4760
[09/26 02:50:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 93.67	
[09/26 02:50:36 visual_prompt]: Training 32 / 100 epoch, with learning rate 0.8715724127386971
[09/26 02:50:43 visual_prompt]: Epoch 32 / 100: avg data time: 4.90e-02, avg batch time: 0.4937, average train loss: 0.5446
[09/26 02:50:44 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1675, average loss: 0.9618
[09/26 02:50:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 92.03	
[09/26 02:50:44 visual_prompt]: Training 33 / 100 epoch, with learning rate 0.8596699001693255
[09/26 02:50:51 visual_prompt]: Epoch 33 / 100: avg data time: 6.13e-02, avg batch time: 0.5053, average train loss: 0.6741
[09/26 02:50:52 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1668, average loss: 0.5886
[09/26 02:50:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 94.00	
[09/26 02:50:52 visual_prompt]: Training 34 / 100 epoch, with learning rate 0.8473291852294986
[09/26 02:50:59 visual_prompt]: Epoch 34 / 100: avg data time: 4.84e-02, avg batch time: 0.4929, average train loss: 0.5884
[09/26 02:51:00 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1673, average loss: 0.6052
[09/26 02:51:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 69.50	rocauc: 94.25	
[09/26 02:51:00 visual_prompt]: Training 35 / 100 epoch, with learning rate 0.8345653031794291
[09/26 02:51:07 visual_prompt]: Epoch 35 / 100: avg data time: 4.29e-02, avg batch time: 0.4870, average train loss: 0.4719
[09/26 02:51:08 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1673, average loss: 0.4413
[09/26 02:51:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 93.80	
[09/26 02:51:08 visual_prompt]: Training 36 / 100 epoch, with learning rate 0.8213938048432696
[09/26 02:51:15 visual_prompt]: Epoch 36 / 100: avg data time: 4.15e-02, avg batch time: 0.4859, average train loss: 0.4962
[09/26 02:51:16 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1678, average loss: 0.3389
[09/26 02:51:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.58	
[09/26 02:51:16 visual_prompt]: Training 37 / 100 epoch, with learning rate 0.8078307376628291
[09/26 02:51:23 visual_prompt]: Epoch 37 / 100: avg data time: 4.31e-02, avg batch time: 0.4885, average train loss: 0.4393
[09/26 02:51:25 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1675, average loss: 0.6288
[09/26 02:51:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 67.00	rocauc: 94.39	
[09/26 02:51:25 visual_prompt]: Training 38 / 100 epoch, with learning rate 0.7938926261462366
[09/26 02:51:31 visual_prompt]: Epoch 38 / 100: avg data time: 5.30e-02, avg batch time: 0.4969, average train loss: 0.5487
[09/26 02:51:33 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1676, average loss: 0.6729
[09/26 02:51:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 92.67	
[09/26 02:51:33 visual_prompt]: Training 39 / 100 epoch, with learning rate 0.7795964517353734
[09/26 02:51:39 visual_prompt]: Epoch 39 / 100: avg data time: 4.54e-02, avg batch time: 0.4905, average train loss: 0.4724
[09/26 02:51:41 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1678, average loss: 0.4666
[09/26 02:51:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.00	rocauc: 90.44	
[09/26 02:51:41 visual_prompt]: Training 40 / 100 epoch, with learning rate 0.7649596321166025
[09/26 02:51:48 visual_prompt]: Epoch 40 / 100: avg data time: 5.58e-02, avg batch time: 0.4995, average train loss: 0.4208
[09/26 02:51:49 visual_prompt]: Inference (val):avg data time: 2.99e-05, avg batch time: 0.1677, average loss: 0.3857
[09/26 02:51:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.86	
[09/26 02:51:49 visual_prompt]: Training 41 / 100 epoch, with learning rate 0.75
[09/26 02:51:56 visual_prompt]: Epoch 41 / 100: avg data time: 4.81e-02, avg batch time: 0.4921, average train loss: 0.3577
[09/26 02:51:57 visual_prompt]: Inference (val):avg data time: 2.99e-05, avg batch time: 0.1675, average loss: 0.5910
[09/26 02:51:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.50	rocauc: 92.95	
[09/26 02:51:57 visual_prompt]: Training 42 / 100 epoch, with learning rate 0.7347357813929454
[09/26 02:52:04 visual_prompt]: Epoch 42 / 100: avg data time: 4.94e-02, avg batch time: 0.4948, average train loss: 0.4217
[09/26 02:52:05 visual_prompt]: Inference (val):avg data time: 3.10e-05, avg batch time: 0.1675, average loss: 0.3612
[09/26 02:52:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.15	
[09/26 02:52:05 visual_prompt]: Training 43 / 100 epoch, with learning rate 0.7191855733945387
[09/26 02:52:12 visual_prompt]: Epoch 43 / 100: avg data time: 4.15e-02, avg batch time: 0.4874, average train loss: 0.3882
[09/26 02:52:13 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1677, average loss: 0.5590
[09/26 02:52:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 93.33	
[09/26 02:52:13 visual_prompt]: Training 44 / 100 epoch, with learning rate 0.7033683215379002
[09/26 02:52:20 visual_prompt]: Epoch 44 / 100: avg data time: 5.39e-02, avg batch time: 0.4977, average train loss: 0.4452
[09/26 02:52:22 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1675, average loss: 0.3337
[09/26 02:52:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 94.69	
[09/26 02:52:22 visual_prompt]: Training 45 / 100 epoch, with learning rate 0.6873032967079561
[09/26 02:52:28 visual_prompt]: Epoch 45 / 100: avg data time: 5.80e-02, avg batch time: 0.5027, average train loss: 0.4194
[09/26 02:52:30 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1674, average loss: 0.3915
[09/26 02:52:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.08	
[09/26 02:52:30 visual_prompt]: Best epoch 45: best metric: 0.865
[09/26 02:52:30 visual_prompt]: Training 46 / 100 epoch, with learning rate 0.6710100716628344
[09/26 02:52:37 visual_prompt]: Epoch 46 / 100: avg data time: 4.72e-02, avg batch time: 0.4928, average train loss: 0.4494
[09/26 02:52:38 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1677, average loss: 0.3328
[09/26 02:52:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 95.57	
[09/26 02:52:38 visual_prompt]: Best epoch 46: best metric: 0.885
[09/26 02:52:38 visual_prompt]: Training 47 / 100 epoch, with learning rate 0.6545084971874737
[09/26 02:52:45 visual_prompt]: Epoch 47 / 100: avg data time: 5.86e-02, avg batch time: 0.5028, average train loss: 0.3669
[09/26 02:52:46 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1673, average loss: 0.3644
[09/26 02:52:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.48	
[09/26 02:52:46 visual_prompt]: Training 48 / 100 epoch, with learning rate 0.6378186779084996
[09/26 02:52:53 visual_prompt]: Epoch 48 / 100: avg data time: 4.95e-02, avg batch time: 0.4944, average train loss: 0.2984
[09/26 02:52:55 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1676, average loss: 0.3181
[09/26 02:52:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 95.06	
[09/26 02:52:55 visual_prompt]: Training 49 / 100 epoch, with learning rate 0.6209609477998338
[09/26 02:53:01 visual_prompt]: Epoch 49 / 100: avg data time: 4.13e-02, avg batch time: 0.4875, average train loss: 0.3881
[09/26 02:53:03 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1677, average loss: 0.4471
[09/26 02:53:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 93.24	
[09/26 02:53:03 visual_prompt]: Training 50 / 100 epoch, with learning rate 0.6039558454088796
[09/26 02:53:09 visual_prompt]: Epoch 50 / 100: avg data time: 5.09e-02, avg batch time: 0.4956, average train loss: 0.4021
[09/26 02:53:11 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1675, average loss: 0.4647
[09/26 02:53:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.82	
[09/26 02:53:11 visual_prompt]: Training 51 / 100 epoch, with learning rate 0.5868240888334653
[09/26 02:53:17 visual_prompt]: Epoch 51 / 100: avg data time: 4.21e-02, avg batch time: 0.4886, average train loss: 0.3759
[09/26 02:53:19 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1673, average loss: 0.3484
[09/26 02:53:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.29	
[09/26 02:53:19 visual_prompt]: Training 52 / 100 epoch, with learning rate 0.5695865504800327
[09/26 02:53:26 visual_prompt]: Epoch 52 / 100: avg data time: 5.10e-02, avg batch time: 0.4965, average train loss: 0.3059
[09/26 02:53:27 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1675, average loss: 0.5049
[09/26 02:53:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.00	rocauc: 93.91	
[09/26 02:53:27 visual_prompt]: Training 53 / 100 epoch, with learning rate 0.5522642316338268
[09/26 02:53:34 visual_prompt]: Epoch 53 / 100: avg data time: 3.97e-02, avg batch time: 0.4854, average train loss: 0.3354
[09/26 02:53:35 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1676, average loss: 0.9437
[09/26 02:53:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.00	rocauc: 93.18	
[09/26 02:53:35 visual_prompt]: Training 54 / 100 epoch, with learning rate 0.5348782368720626
[09/26 02:53:42 visual_prompt]: Epoch 54 / 100: avg data time: 4.09e-02, avg batch time: 0.4858, average train loss: 0.4651
[09/26 02:53:43 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1675, average loss: 0.3267
[09/26 02:53:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 94.94	
[09/26 02:53:43 visual_prompt]: Training 55 / 100 epoch, with learning rate 0.5174497483512506
[09/26 02:53:50 visual_prompt]: Epoch 55 / 100: avg data time: 4.75e-02, avg batch time: 0.4924, average train loss: 0.2966
[09/26 02:53:51 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1678, average loss: 0.3043
[09/26 02:53:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 95.03	
[09/26 02:53:51 visual_prompt]: Training 56 / 100 epoch, with learning rate 0.5
[09/26 02:53:58 visual_prompt]: Epoch 56 / 100: avg data time: 4.14e-02, avg batch time: 0.4876, average train loss: 0.5253
[09/26 02:54:00 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1675, average loss: 0.5611
[09/26 02:54:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 64.50	rocauc: 93.94	
[09/26 02:54:00 visual_prompt]: Training 57 / 100 epoch, with learning rate 0.48255025164874965
[09/26 02:54:07 visual_prompt]: Epoch 57 / 100: avg data time: 6.33e-02, avg batch time: 0.5071, average train loss: 0.4970
[09/26 02:54:08 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1678, average loss: 0.3837
[09/26 02:54:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 94.40	
[09/26 02:54:08 visual_prompt]: Training 58 / 100 epoch, with learning rate 0.46512176312793735
[09/26 02:54:15 visual_prompt]: Epoch 58 / 100: avg data time: 4.16e-02, avg batch time: 0.4872, average train loss: 0.3290
[09/26 02:54:16 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1676, average loss: 0.3437
[09/26 02:54:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.63	
[09/26 02:54:16 visual_prompt]: Training 59 / 100 epoch, with learning rate 0.44773576836617335
[09/26 02:54:23 visual_prompt]: Epoch 59 / 100: avg data time: 5.42e-02, avg batch time: 0.4987, average train loss: 0.2586
[09/26 02:54:24 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1675, average loss: 0.3426
[09/26 02:54:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 94.01	
[09/26 02:54:24 visual_prompt]: Training 60 / 100 epoch, with learning rate 0.4304134495199674
[09/26 02:54:31 visual_prompt]: Epoch 60 / 100: avg data time: 4.99e-02, avg batch time: 0.4949, average train loss: 1.0478
[09/26 02:54:32 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1675, average loss: 0.5355
[09/26 02:54:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.37	
[09/26 02:54:32 visual_prompt]: Training 61 / 100 epoch, with learning rate 0.41317591116653485
[09/26 02:54:39 visual_prompt]: Epoch 61 / 100: avg data time: 4.16e-02, avg batch time: 0.4860, average train loss: 0.6497
[09/26 02:54:40 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1672, average loss: 0.4266
[09/26 02:54:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.30	
[09/26 02:54:40 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.3960441545911204
[09/26 02:54:47 visual_prompt]: Epoch 62 / 100: avg data time: 5.74e-02, avg batch time: 0.5012, average train loss: 0.5273
[09/26 02:54:49 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1675, average loss: 0.4220
[09/26 02:54:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.09	
[09/26 02:54:49 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.3790390522001662
[09/26 02:54:55 visual_prompt]: Epoch 63 / 100: avg data time: 5.27e-02, avg batch time: 0.4971, average train loss: 0.4452
[09/26 02:54:57 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1676, average loss: 0.3995
[09/26 02:54:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.87	
[09/26 02:54:57 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.36218132209150045
[09/26 02:55:03 visual_prompt]: Epoch 64 / 100: avg data time: 4.66e-02, avg batch time: 0.4917, average train loss: 0.3422
[09/26 02:55:05 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1679, average loss: 0.3666
[09/26 02:55:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 93.22	
[09/26 02:55:05 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.34549150281252633
[09/26 02:55:11 visual_prompt]: Epoch 65 / 100: avg data time: 4.33e-02, avg batch time: 0.4880, average train loss: 0.2947
[09/26 02:55:13 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1677, average loss: 0.8689
[09/26 02:55:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.00	rocauc: 91.99	
[09/26 02:55:13 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.32898992833716567
[09/26 02:55:20 visual_prompt]: Epoch 66 / 100: avg data time: 3.84e-02, avg batch time: 0.4843, average train loss: 0.4063
[09/26 02:55:21 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1673, average loss: 0.3248
[09/26 02:55:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 94.81	
[09/26 02:55:21 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.31269670329204396
[09/26 02:55:28 visual_prompt]: Epoch 67 / 100: avg data time: 5.09e-02, avg batch time: 0.4963, average train loss: 0.2438
[09/26 02:55:29 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1674, average loss: 0.4241
[09/26 02:55:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 94.33	
[09/26 02:55:29 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.2966316784621
[09/26 02:55:36 visual_prompt]: Epoch 68 / 100: avg data time: 4.17e-02, avg batch time: 0.4894, average train loss: 0.2673
[09/26 02:55:37 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1678, average loss: 0.3702
[09/26 02:55:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 94.46	
[09/26 02:55:37 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.28081442660546124
[09/26 02:55:44 visual_prompt]: Epoch 69 / 100: avg data time: 4.07e-02, avg batch time: 0.4863, average train loss: 0.1968
[09/26 02:55:45 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1674, average loss: 0.3991
[09/26 02:55:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 94.51	
[09/26 02:55:45 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.26526421860705474
[09/26 02:55:52 visual_prompt]: Epoch 70 / 100: avg data time: 4.38e-02, avg batch time: 0.4882, average train loss: 0.1632
[09/26 02:55:53 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.1675, average loss: 0.3990
[09/26 02:55:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.40	
[09/26 02:55:53 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.2500000000000001
[09/26 02:56:00 visual_prompt]: Epoch 71 / 100: avg data time: 5.56e-02, avg batch time: 0.5006, average train loss: 0.1938
[09/26 02:56:02 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1672, average loss: 0.2874
[09/26 02:56:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 95.30	
[09/26 02:56:02 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.2350403678833976
[09/26 02:56:08 visual_prompt]: Epoch 72 / 100: avg data time: 3.90e-02, avg batch time: 0.4865, average train loss: 0.1723
[09/26 02:56:10 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1675, average loss: 0.3693
[09/26 02:56:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.95	
[09/26 02:56:10 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.22040354826462666
[09/26 02:56:16 visual_prompt]: Epoch 73 / 100: avg data time: 4.22e-02, avg batch time: 0.4872, average train loss: 0.1982
[09/26 02:56:18 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1675, average loss: 0.3812
[09/26 02:56:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.22	
[09/26 02:56:18 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.2061073738537635
[09/26 02:56:24 visual_prompt]: Epoch 74 / 100: avg data time: 4.32e-02, avg batch time: 0.4874, average train loss: 0.1739
[09/26 02:56:26 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1674, average loss: 0.4486
[09/26 02:56:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 95.16	
[09/26 02:56:26 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.19216926233717085
[09/26 02:56:32 visual_prompt]: Epoch 75 / 100: avg data time: 4.11e-02, avg batch time: 0.4887, average train loss: 0.0994
[09/26 02:56:34 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1676, average loss: 0.6190
[09/26 02:56:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 94.08	
[09/26 02:56:34 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.17860619515673032
[09/26 02:56:40 visual_prompt]: Epoch 76 / 100: avg data time: 5.01e-02, avg batch time: 0.4941, average train loss: 0.1578
[09/26 02:56:42 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1678, average loss: 0.2577
[09/26 02:56:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 96.50	
[09/26 02:56:42 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.16543469682057105
[09/26 02:56:49 visual_prompt]: Epoch 77 / 100: avg data time: 5.35e-02, avg batch time: 0.4983, average train loss: 0.1103
[09/26 02:56:50 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1678, average loss: 0.5074
[09/26 02:56:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 95.44	
[09/26 02:56:50 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.15267081477050132
[09/26 02:56:57 visual_prompt]: Epoch 78 / 100: avg data time: 5.69e-02, avg batch time: 0.5008, average train loss: 0.0820
[09/26 02:56:58 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1677, average loss: 0.4699
[09/26 02:56:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 95.39	
[09/26 02:56:58 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.14033009983067452
[09/26 02:57:05 visual_prompt]: Epoch 79 / 100: avg data time: 4.96e-02, avg batch time: 0.4956, average train loss: 0.1381
[09/26 02:57:06 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1674, average loss: 0.4168
[09/26 02:57:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.90	
[09/26 02:57:06 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.12842758726130282
[09/26 02:57:13 visual_prompt]: Epoch 80 / 100: avg data time: 5.66e-02, avg batch time: 0.5017, average train loss: 0.0819
[09/26 02:57:15 visual_prompt]: Inference (val):avg data time: 2.99e-05, avg batch time: 0.1672, average loss: 0.4556
[09/26 02:57:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 93.28	
[09/26 02:57:15 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.11697777844051105
[09/26 02:57:21 visual_prompt]: Epoch 81 / 100: avg data time: 5.41e-02, avg batch time: 0.4982, average train loss: 0.0808
[09/26 02:57:23 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1678, average loss: 0.5072
[09/26 02:57:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 94.87	
[09/26 02:57:23 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.10599462319663905
[09/26 02:57:30 visual_prompt]: Epoch 82 / 100: avg data time: 4.72e-02, avg batch time: 0.4927, average train loss: 0.0577
[09/26 02:57:31 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1677, average loss: 0.4510
[09/26 02:57:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.00	rocauc: 95.03	
[09/26 02:57:31 visual_prompt]: Best epoch 82: best metric: 0.890
[09/26 02:57:31 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.09549150281252633
[09/26 02:57:38 visual_prompt]: Epoch 83 / 100: avg data time: 5.63e-02, avg batch time: 0.5016, average train loss: 0.0786
[09/26 02:57:39 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1674, average loss: 0.4741
[09/26 02:57:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.91	
[09/26 02:57:39 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.08548121372247919
[09/26 02:57:46 visual_prompt]: Epoch 84 / 100: avg data time: 5.53e-02, avg batch time: 0.4992, average train loss: 0.0544
[09/26 02:57:48 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1676, average loss: 0.5058
[09/26 02:57:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 94.82	
[09/26 02:57:48 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.07597595192178702
[09/26 02:57:54 visual_prompt]: Epoch 85 / 100: avg data time: 4.35e-02, avg batch time: 0.4894, average train loss: 0.0375
[09/26 02:57:56 visual_prompt]: Inference (val):avg data time: 3.03e-05, avg batch time: 0.1677, average loss: 0.4851
[09/26 02:57:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 95.63	
[09/26 02:57:56 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.06698729810778065
[09/26 02:58:02 visual_prompt]: Epoch 86 / 100: avg data time: 4.81e-02, avg batch time: 0.4926, average train loss: 0.0404
[09/26 02:58:04 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1673, average loss: 0.4491
[09/26 02:58:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.00	rocauc: 96.03	
[09/26 02:58:04 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.058526203570536506
[09/26 02:58:10 visual_prompt]: Epoch 87 / 100: avg data time: 4.85e-02, avg batch time: 0.4936, average train loss: 0.0265
[09/26 02:58:12 visual_prompt]: Inference (val):avg data time: 3.16e-05, avg batch time: 0.1676, average loss: 0.5867
[09/26 02:58:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 95.57	
[09/26 02:58:12 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.05060297685041659
[09/26 02:58:19 visual_prompt]: Epoch 88 / 100: avg data time: 5.49e-02, avg batch time: 0.4985, average train loss: 0.0176
[09/26 02:58:20 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1676, average loss: 0.5094
[09/26 02:58:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 95.66	
[09/26 02:58:20 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.04322727117869951
[09/26 02:58:27 visual_prompt]: Epoch 89 / 100: avg data time: 4.82e-02, avg batch time: 0.4940, average train loss: 0.0211
[09/26 02:58:28 visual_prompt]: Inference (val):avg data time: 3.03e-05, avg batch time: 0.1675, average loss: 0.6007
[09/26 02:58:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 95.37	
[09/26 02:58:28 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.03640807271660634
[09/26 02:58:35 visual_prompt]: Epoch 90 / 100: avg data time: 4.01e-02, avg batch time: 0.4864, average train loss: 0.0105
[09/26 02:58:36 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1675, average loss: 0.5829
[09/26 02:58:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 95.28	
[09/26 02:58:36 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.03015368960704584
[09/26 02:58:43 visual_prompt]: Epoch 91 / 100: avg data time: 6.08e-02, avg batch time: 0.5056, average train loss: 0.0100
[09/26 02:58:45 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1675, average loss: 0.5942
[09/26 02:58:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 95.32	
[09/26 02:58:45 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.024471741852423234
[09/26 02:58:51 visual_prompt]: Epoch 92 / 100: avg data time: 4.90e-02, avg batch time: 0.4942, average train loss: 0.0101
[09/26 02:58:53 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1682, average loss: 0.5997
[09/26 02:58:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 95.30	
[09/26 02:58:53 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.019369152030840553
[09/26 02:59:00 visual_prompt]: Epoch 93 / 100: avg data time: 5.07e-02, avg batch time: 0.4951, average train loss: 0.0101
[09/26 02:59:01 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1677, average loss: 0.6034
[09/26 02:59:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 95.28	
[09/26 02:59:01 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.014852136862001764
[09/26 02:59:08 visual_prompt]: Epoch 94 / 100: avg data time: 5.63e-02, avg batch time: 0.5011, average train loss: 0.0094
[09/26 02:59:09 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1676, average loss: 0.6032
[09/26 02:59:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 95.30	
[09/26 02:59:09 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.010926199633097156
[09/26 02:59:16 visual_prompt]: Epoch 95 / 100: avg data time: 5.91e-02, avg batch time: 0.5031, average train loss: 0.0097
[09/26 02:59:17 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1677, average loss: 0.6028
[09/26 02:59:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 95.29	
[09/26 02:59:17 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.00759612349389599
[09/26 02:59:24 visual_prompt]: Epoch 96 / 100: avg data time: 5.43e-02, avg batch time: 0.4991, average train loss: 0.0094
[09/26 02:59:26 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1675, average loss: 0.6040
[09/26 02:59:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 95.28	
[09/26 02:59:26 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.004865965629214819
[09/26 02:59:32 visual_prompt]: Epoch 97 / 100: avg data time: 4.19e-02, avg batch time: 0.4876, average train loss: 0.0092
[09/26 02:59:34 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1675, average loss: 0.6052
[09/26 02:59:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 95.28	
[09/26 02:59:34 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.002739052315863355
[09/26 02:59:40 visual_prompt]: Epoch 98 / 100: avg data time: 5.43e-02, avg batch time: 0.4983, average train loss: 0.0093
[09/26 02:59:42 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.1673, average loss: 0.6057
[09/26 02:59:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 95.28	
[09/26 02:59:42 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.0012179748700879012
[09/26 02:59:48 visual_prompt]: Epoch 99 / 100: avg data time: 4.40e-02, avg batch time: 0.4891, average train loss: 0.0095
[09/26 02:59:50 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1678, average loss: 0.6059
[09/26 02:59:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 95.28	
[09/26 02:59:50 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.00030458649045211894
[09/26 02:59:56 visual_prompt]: Epoch 100 / 100: avg data time: 4.00e-02, avg batch time: 0.4856, average train loss: 0.0099
[09/26 02:59:58 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1675, average loss: 0.6059
[09/26 02:59:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 95.28	
[09/26 02:59:58 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 02:59:58 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 02:59:58 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 02:59:58 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 02:59:58 visual_prompt]: Training with config:
[09/26 02:59:58 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr1.0_wd0.0001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 1.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 02:59:58 visual_prompt]: Loading training data...
[09/26 02:59:58 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 02:59:59 visual_prompt]: Number of images: 800
[09/26 02:59:59 visual_prompt]: Number of classes: 2 / 2
[09/26 02:59:59 visual_prompt]: Loading validation data...
[09/26 02:59:59 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 02:59:59 visual_prompt]: Number of images: 200
[09/26 02:59:59 visual_prompt]: Number of classes: 2 / 2
[09/26 02:59:59 visual_prompt]: Constructing models...
[09/26 03:00:02 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 03:00:02 visual_prompt]: tuned percent:0.536
[09/26 03:00:02 visual_prompt]: Device used for model: 0
[09/26 03:00:02 visual_prompt]: Setting up Evaluator...
[09/26 03:00:02 visual_prompt]: Setting up Trainer...
[09/26 03:00:02 visual_prompt]: 	Setting up the optimizer...
[09/26 03:00:02 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 03:00:08 visual_prompt]: Epoch 1 / 100: avg data time: 3.98e-02, avg batch time: 0.4847, average train loss: 1.9724
[09/26 03:00:10 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1672, average loss: 2.0033
[09/26 03:00:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 03:00:10 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 03:00:10 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.1
[09/26 03:00:17 visual_prompt]: Epoch 2 / 100: avg data time: 5.28e-02, avg batch time: 0.4962, average train loss: 4.5643
[09/26 03:00:18 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1669, average loss: 1.2197
[09/26 03:00:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 56.21	
[09/26 03:00:18 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.2
[09/26 03:00:25 visual_prompt]: Epoch 3 / 100: avg data time: 3.89e-02, avg batch time: 0.4820, average train loss: 0.8443
[09/26 03:00:26 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1670, average loss: 0.8785
[09/26 03:00:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.05	
[09/26 03:00:26 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.3
[09/26 03:00:33 visual_prompt]: Epoch 4 / 100: avg data time: 5.71e-02, avg batch time: 0.4998, average train loss: 0.8127
[09/26 03:00:34 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1674, average loss: 0.6380
[09/26 03:00:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 89.88	
[09/26 03:00:34 visual_prompt]: Training 5 / 100 epoch, with learning rate 0.4
[09/26 03:00:41 visual_prompt]: Epoch 5 / 100: avg data time: 4.92e-02, avg batch time: 0.4935, average train loss: 0.7649
[09/26 03:00:43 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1674, average loss: 0.5476
[09/26 03:00:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 71.00	rocauc: 90.70	
[09/26 03:00:43 visual_prompt]: Best epoch 5: best metric: 0.710
[09/26 03:00:43 visual_prompt]: Training 6 / 100 epoch, with learning rate 0.5
[09/26 03:00:49 visual_prompt]: Epoch 6 / 100: avg data time: 5.76e-02, avg batch time: 0.4999, average train loss: 0.6295
[09/26 03:00:51 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1672, average loss: 0.4712
[09/26 03:00:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 90.51	
[09/26 03:00:51 visual_prompt]: Best epoch 6: best metric: 0.760
[09/26 03:00:51 visual_prompt]: Training 7 / 100 epoch, with learning rate 0.6
[09/26 03:00:57 visual_prompt]: Epoch 7 / 100: avg data time: 4.48e-02, avg batch time: 0.4881, average train loss: 0.5737
[09/26 03:00:59 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1676, average loss: 0.5996
[09/26 03:00:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.00	rocauc: 90.96	
[09/26 03:00:59 visual_prompt]: Training 8 / 100 epoch, with learning rate 0.7
[09/26 03:01:05 visual_prompt]: Epoch 8 / 100: avg data time: 4.87e-02, avg batch time: 0.4935, average train loss: 0.7250
[09/26 03:01:07 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1674, average loss: 0.4962
[09/26 03:01:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.00	rocauc: 90.31	
[09/26 03:01:07 visual_prompt]: Training 9 / 100 epoch, with learning rate 0.8
[09/26 03:01:13 visual_prompt]: Epoch 9 / 100: avg data time: 4.42e-02, avg batch time: 0.4876, average train loss: 0.6647
[09/26 03:01:15 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1675, average loss: 0.7161
[09/26 03:01:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 63.00	rocauc: 90.85	
[09/26 03:01:15 visual_prompt]: Training 10 / 100 epoch, with learning rate 0.9
[09/26 03:01:22 visual_prompt]: Epoch 10 / 100: avg data time: 4.42e-02, avg batch time: 0.4906, average train loss: 0.5469
[09/26 03:01:23 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1673, average loss: 0.4041
[09/26 03:01:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 90.04	
[09/26 03:01:23 visual_prompt]: Best epoch 10: best metric: 0.805
[09/26 03:01:23 visual_prompt]: Training 11 / 100 epoch, with learning rate 1.0
[09/26 03:01:30 visual_prompt]: Epoch 11 / 100: avg data time: 4.30e-02, avg batch time: 0.4880, average train loss: 0.5653
[09/26 03:01:31 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1676, average loss: 0.7817
[09/26 03:01:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 62.00	rocauc: 91.49	
[09/26 03:01:31 visual_prompt]: Training 12 / 100 epoch, with learning rate 0.9996954135095479
[09/26 03:01:38 visual_prompt]: Epoch 12 / 100: avg data time: 5.87e-02, avg batch time: 0.5025, average train loss: 0.5851
[09/26 03:01:39 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1674, average loss: 0.3519
[09/26 03:01:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.85	
[09/26 03:01:39 visual_prompt]: Best epoch 12: best metric: 0.835
[09/26 03:01:39 visual_prompt]: Training 13 / 100 epoch, with learning rate 0.9987820251299121
[09/26 03:01:46 visual_prompt]: Epoch 13 / 100: avg data time: 5.25e-02, avg batch time: 0.4972, average train loss: 0.5228
[09/26 03:01:47 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1673, average loss: 0.4086
[09/26 03:01:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 90.03	
[09/26 03:01:47 visual_prompt]: Training 14 / 100 epoch, with learning rate 0.9972609476841366
[09/26 03:01:54 visual_prompt]: Epoch 14 / 100: avg data time: 5.36e-02, avg batch time: 0.4980, average train loss: 0.6005
[09/26 03:01:56 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1674, average loss: 0.5869
[09/26 03:01:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.50	rocauc: 92.62	
[09/26 03:01:56 visual_prompt]: Training 15 / 100 epoch, with learning rate 0.9951340343707852
[09/26 03:02:02 visual_prompt]: Epoch 15 / 100: avg data time: 4.22e-02, avg batch time: 0.4880, average train loss: 0.4713
[09/26 03:02:04 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1672, average loss: 0.5923
[09/26 03:02:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.00	rocauc: 91.22	
[09/26 03:02:04 visual_prompt]: Training 16 / 100 epoch, with learning rate 0.9924038765061041
[09/26 03:02:10 visual_prompt]: Epoch 16 / 100: avg data time: 4.46e-02, avg batch time: 0.4918, average train loss: 0.5892
[09/26 03:02:12 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1677, average loss: 1.1218
[09/26 03:02:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.50	rocauc: 91.92	
[09/26 03:02:12 visual_prompt]: Training 17 / 100 epoch, with learning rate 0.9890738003669028
[09/26 03:02:18 visual_prompt]: Epoch 17 / 100: avg data time: 4.14e-02, avg batch time: 0.4885, average train loss: 0.7393
[09/26 03:02:20 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1672, average loss: 0.3697
[09/26 03:02:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.64	
[09/26 03:02:20 visual_prompt]: Best epoch 17: best metric: 0.840
[09/26 03:02:20 visual_prompt]: Training 18 / 100 epoch, with learning rate 0.9851478631379982
[09/26 03:02:27 visual_prompt]: Epoch 18 / 100: avg data time: 5.50e-02, avg batch time: 0.5000, average train loss: 0.4360
[09/26 03:02:28 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1674, average loss: 0.4619
[09/26 03:02:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 93.05	
[09/26 03:02:28 visual_prompt]: Training 19 / 100 epoch, with learning rate 0.9806308479691594
[09/26 03:02:35 visual_prompt]: Epoch 19 / 100: avg data time: 5.34e-02, avg batch time: 0.4983, average train loss: 0.5417
[09/26 03:02:36 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1674, average loss: 0.3447
[09/26 03:02:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 93.67	
[09/26 03:02:36 visual_prompt]: Training 20 / 100 epoch, with learning rate 0.9755282581475768
[09/26 03:02:43 visual_prompt]: Epoch 20 / 100: avg data time: 4.08e-02, avg batch time: 0.4873, average train loss: 0.3405
[09/26 03:02:44 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1676, average loss: 0.3894
[09/26 03:02:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.61	
[09/26 03:02:44 visual_prompt]: Training 21 / 100 epoch, with learning rate 0.9698463103929542
[09/26 03:02:51 visual_prompt]: Epoch 21 / 100: avg data time: 5.57e-02, avg batch time: 0.4997, average train loss: 0.2943
[09/26 03:02:52 visual_prompt]: Inference (val):avg data time: 3.12e-05, avg batch time: 0.1674, average loss: 0.3175
[09/26 03:02:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 94.05	
[09/26 03:02:52 visual_prompt]: Training 22 / 100 epoch, with learning rate 0.9635919272833937
[09/26 03:02:59 visual_prompt]: Epoch 22 / 100: avg data time: 5.37e-02, avg batch time: 0.4975, average train loss: 0.2734
[09/26 03:03:01 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1674, average loss: 0.9776
[09/26 03:03:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.50	rocauc: 93.84	
[09/26 03:03:01 visual_prompt]: Training 23 / 100 epoch, with learning rate 0.9567727288213004
[09/26 03:03:07 visual_prompt]: Epoch 23 / 100: avg data time: 4.44e-02, avg batch time: 0.4880, average train loss: 0.4219
[09/26 03:03:09 visual_prompt]: Inference (val):avg data time: 4.31e-05, avg batch time: 0.1675, average loss: 0.7278
[09/26 03:03:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.00	rocauc: 91.45	
[09/26 03:03:09 visual_prompt]: Training 24 / 100 epoch, with learning rate 0.9493970231495835
[09/26 03:03:15 visual_prompt]: Epoch 24 / 100: avg data time: 4.78e-02, avg batch time: 0.4913, average train loss: 0.3881
[09/26 03:03:17 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1674, average loss: 0.4107
[09/26 03:03:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.29	
[09/26 03:03:17 visual_prompt]: Training 25 / 100 epoch, with learning rate 0.9414737964294635
[09/26 03:03:23 visual_prompt]: Epoch 25 / 100: avg data time: 4.45e-02, avg batch time: 0.4900, average train loss: 0.3920
[09/26 03:03:25 visual_prompt]: Inference (val):avg data time: 3.12e-05, avg batch time: 0.1673, average loss: 0.3508
[09/26 03:03:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 94.23	
[09/26 03:03:25 visual_prompt]: Best epoch 25: best metric: 0.855
[09/26 03:03:25 visual_prompt]: Training 26 / 100 epoch, with learning rate 0.9330127018922194
[09/26 03:03:32 visual_prompt]: Epoch 26 / 100: avg data time: 3.93e-02, avg batch time: 0.4843, average train loss: 0.3184
[09/26 03:03:33 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1673, average loss: 0.3559
[09/26 03:03:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 94.27	
[09/26 03:03:33 visual_prompt]: Training 27 / 100 epoch, with learning rate 0.9240240480782129
[09/26 03:03:40 visual_prompt]: Epoch 27 / 100: avg data time: 5.18e-02, avg batch time: 0.4972, average train loss: 0.2484
[09/26 03:03:41 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1676, average loss: 0.3289
[09/26 03:03:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.61	
[09/26 03:03:41 visual_prompt]: Training 28 / 100 epoch, with learning rate 0.9145187862775208
[09/26 03:03:48 visual_prompt]: Epoch 28 / 100: avg data time: 4.80e-02, avg batch time: 0.4924, average train loss: 0.1776
[09/26 03:03:49 visual_prompt]: Inference (val):avg data time: 3.09e-05, avg batch time: 0.1673, average loss: 1.1120
[09/26 03:03:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.00	rocauc: 94.29	
[09/26 03:03:49 visual_prompt]: Training 29 / 100 epoch, with learning rate 0.9045084971874737
[09/26 03:03:56 visual_prompt]: Epoch 29 / 100: avg data time: 5.82e-02, avg batch time: 0.5033, average train loss: 0.2372
[09/26 03:03:58 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1673, average loss: 0.3799
[09/26 03:03:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 94.22	
[09/26 03:03:58 visual_prompt]: Training 30 / 100 epoch, with learning rate 0.8940053768033609
[09/26 03:04:05 visual_prompt]: Epoch 30 / 100: avg data time: 5.39e-02, avg batch time: 0.4978, average train loss: 0.1419
[09/26 03:04:06 visual_prompt]: Inference (val):avg data time: 3.18e-05, avg batch time: 0.1676, average loss: 0.4480
[09/26 03:04:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.95	
[09/26 03:04:06 visual_prompt]: Best epoch 30: best metric: 0.860
[09/26 03:04:06 visual_prompt]: Training 31 / 100 epoch, with learning rate 0.883022221559489
[09/26 03:04:13 visual_prompt]: Epoch 31 / 100: avg data time: 5.61e-02, avg batch time: 0.5027, average train loss: 0.1728
[09/26 03:04:14 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1675, average loss: 0.3866
[09/26 03:04:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.65	
[09/26 03:04:14 visual_prompt]: Training 32 / 100 epoch, with learning rate 0.8715724127386971
[09/26 03:04:21 visual_prompt]: Epoch 32 / 100: avg data time: 5.15e-02, avg batch time: 0.4952, average train loss: 0.1869
[09/26 03:04:23 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1674, average loss: 0.5209
[09/26 03:04:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 93.29	
[09/26 03:04:23 visual_prompt]: Training 33 / 100 epoch, with learning rate 0.8596699001693255
[09/26 03:04:29 visual_prompt]: Epoch 33 / 100: avg data time: 5.23e-02, avg batch time: 0.4980, average train loss: 0.1363
[09/26 03:04:31 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1676, average loss: 0.4064
[09/26 03:04:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.67	
[09/26 03:04:31 visual_prompt]: Training 34 / 100 epoch, with learning rate 0.8473291852294986
[09/26 03:04:38 visual_prompt]: Epoch 34 / 100: avg data time: 5.52e-02, avg batch time: 0.4996, average train loss: 0.0686
[09/26 03:04:39 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1674, average loss: 0.5078
[09/26 03:04:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.44	
[09/26 03:04:39 visual_prompt]: Training 35 / 100 epoch, with learning rate 0.8345653031794291
[09/26 03:04:46 visual_prompt]: Epoch 35 / 100: avg data time: 5.43e-02, avg batch time: 0.4987, average train loss: 0.0864
[09/26 03:04:47 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1675, average loss: 0.5551
[09/26 03:04:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.89	
[09/26 03:04:47 visual_prompt]: Training 36 / 100 epoch, with learning rate 0.8213938048432696
[09/26 03:04:54 visual_prompt]: Epoch 36 / 100: avg data time: 5.03e-02, avg batch time: 0.4950, average train loss: 0.1463
[09/26 03:04:55 visual_prompt]: Inference (val):avg data time: 3.10e-05, avg batch time: 0.1674, average loss: 0.7672
[09/26 03:04:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 94.35	
[09/26 03:04:55 visual_prompt]: Training 37 / 100 epoch, with learning rate 0.8078307376628291
[09/26 03:05:02 visual_prompt]: Epoch 37 / 100: avg data time: 5.57e-02, avg batch time: 0.5008, average train loss: 0.0993
[09/26 03:05:04 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1676, average loss: 0.4474
[09/26 03:05:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 94.87	
[09/26 03:05:04 visual_prompt]: Training 38 / 100 epoch, with learning rate 0.7938926261462366
[09/26 03:05:10 visual_prompt]: Epoch 38 / 100: avg data time: 5.50e-02, avg batch time: 0.4987, average train loss: 0.1345
[09/26 03:05:12 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1674, average loss: 0.4064
[09/26 03:05:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.83	
[09/26 03:05:12 visual_prompt]: Training 39 / 100 epoch, with learning rate 0.7795964517353734
[09/26 03:05:19 visual_prompt]: Epoch 39 / 100: avg data time: 5.73e-02, avg batch time: 0.5024, average train loss: 0.0854
[09/26 03:05:20 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1678, average loss: 0.6737
[09/26 03:05:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 94.05	
[09/26 03:05:20 visual_prompt]: Training 40 / 100 epoch, with learning rate 0.7649596321166025
[09/26 03:05:27 visual_prompt]: Epoch 40 / 100: avg data time: 5.55e-02, avg batch time: 0.5004, average train loss: 0.2181
[09/26 03:05:28 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1674, average loss: 0.7965
[09/26 03:05:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 92.81	
[09/26 03:05:28 visual_prompt]: Training 41 / 100 epoch, with learning rate 0.75
[09/26 03:05:35 visual_prompt]: Epoch 41 / 100: avg data time: 5.38e-02, avg batch time: 0.4989, average train loss: 0.5880
[09/26 03:05:36 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1675, average loss: 0.7290
[09/26 03:05:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.00	rocauc: 93.70	
[09/26 03:05:36 visual_prompt]: Training 42 / 100 epoch, with learning rate 0.7347357813929454
[09/26 03:05:43 visual_prompt]: Epoch 42 / 100: avg data time: 5.96e-02, avg batch time: 0.5038, average train loss: 0.3437
[09/26 03:05:45 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1673, average loss: 0.4277
[09/26 03:05:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 93.91	
[09/26 03:05:45 visual_prompt]: Training 43 / 100 epoch, with learning rate 0.7191855733945387
[09/26 03:05:51 visual_prompt]: Epoch 43 / 100: avg data time: 4.45e-02, avg batch time: 0.4900, average train loss: 0.1781
[09/26 03:05:53 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1676, average loss: 0.3949
[09/26 03:05:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.12	
[09/26 03:05:53 visual_prompt]: Training 44 / 100 epoch, with learning rate 0.7033683215379002
[09/26 03:05:59 visual_prompt]: Epoch 44 / 100: avg data time: 5.34e-02, avg batch time: 0.4976, average train loss: 0.1013
[09/26 03:06:01 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1676, average loss: 0.3465
[09/26 03:06:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 95.09	
[09/26 03:06:01 visual_prompt]: Best epoch 44: best metric: 0.875
[09/26 03:06:01 visual_prompt]: Training 45 / 100 epoch, with learning rate 0.6873032967079561
[09/26 03:06:07 visual_prompt]: Epoch 45 / 100: avg data time: 4.80e-02, avg batch time: 0.4933, average train loss: 0.0539
[09/26 03:06:09 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1675, average loss: 0.5195
[09/26 03:06:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.41	
[09/26 03:06:09 visual_prompt]: Training 46 / 100 epoch, with learning rate 0.6710100716628344
[09/26 03:06:16 visual_prompt]: Epoch 46 / 100: avg data time: 4.93e-02, avg batch time: 0.4943, average train loss: 0.0861
[09/26 03:06:17 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1677, average loss: 0.6573
[09/26 03:06:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 93.32	
[09/26 03:06:17 visual_prompt]: Training 47 / 100 epoch, with learning rate 0.6545084971874737
[09/26 03:06:24 visual_prompt]: Epoch 47 / 100: avg data time: 4.15e-02, avg batch time: 0.4877, average train loss: 0.0983
[09/26 03:06:25 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1677, average loss: 0.4272
[09/26 03:06:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.56	
[09/26 03:06:25 visual_prompt]: Training 48 / 100 epoch, with learning rate 0.6378186779084996
[09/26 03:06:32 visual_prompt]: Epoch 48 / 100: avg data time: 4.27e-02, avg batch time: 0.4894, average train loss: 0.0742
[09/26 03:06:33 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1674, average loss: 0.5809
[09/26 03:06:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.53	
[09/26 03:06:33 visual_prompt]: Training 49 / 100 epoch, with learning rate 0.6209609477998338
[09/26 03:06:40 visual_prompt]: Epoch 49 / 100: avg data time: 4.73e-02, avg batch time: 0.4924, average train loss: 0.1118
[09/26 03:06:41 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1675, average loss: 0.4529
[09/26 03:06:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 95.07	
[09/26 03:06:41 visual_prompt]: Training 50 / 100 epoch, with learning rate 0.6039558454088796
[09/26 03:06:48 visual_prompt]: Epoch 50 / 100: avg data time: 4.35e-02, avg batch time: 0.4879, average train loss: 0.0916
[09/26 03:06:49 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1675, average loss: 0.7625
[09/26 03:06:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 95.10	
[09/26 03:06:49 visual_prompt]: Training 51 / 100 epoch, with learning rate 0.5868240888334653
[09/26 03:06:56 visual_prompt]: Epoch 51 / 100: avg data time: 4.21e-02, avg batch time: 0.4876, average train loss: 0.0663
[09/26 03:06:57 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1675, average loss: 0.4802
[09/26 03:06:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 94.05	
[09/26 03:06:57 visual_prompt]: Training 52 / 100 epoch, with learning rate 0.5695865504800327
[09/26 03:07:04 visual_prompt]: Epoch 52 / 100: avg data time: 4.77e-02, avg batch time: 0.4927, average train loss: 0.0931
[09/26 03:07:06 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1675, average loss: 0.7338
[09/26 03:07:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 93.81	
[09/26 03:07:06 visual_prompt]: Training 53 / 100 epoch, with learning rate 0.5522642316338268
[09/26 03:07:12 visual_prompt]: Epoch 53 / 100: avg data time: 4.98e-02, avg batch time: 0.4942, average train loss: 0.0392
[09/26 03:07:14 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1676, average loss: 0.5802
[09/26 03:07:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 94.88	
[09/26 03:07:14 visual_prompt]: Training 54 / 100 epoch, with learning rate 0.5348782368720626
[09/26 03:07:20 visual_prompt]: Epoch 54 / 100: avg data time: 3.84e-02, avg batch time: 0.4830, average train loss: 0.0151
[09/26 03:07:22 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1674, average loss: 0.6051
[09/26 03:07:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 94.35	
[09/26 03:07:22 visual_prompt]: Training 55 / 100 epoch, with learning rate 0.5174497483512506
[09/26 03:07:28 visual_prompt]: Epoch 55 / 100: avg data time: 5.30e-02, avg batch time: 0.4992, average train loss: 0.0220
[09/26 03:07:30 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1675, average loss: 0.8688
[09/26 03:07:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.50	rocauc: 94.99	
[09/26 03:07:30 visual_prompt]: Training 56 / 100 epoch, with learning rate 0.5
[09/26 03:07:37 visual_prompt]: Epoch 56 / 100: avg data time: 4.17e-02, avg batch time: 0.4866, average train loss: 0.0589
[09/26 03:07:38 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1677, average loss: 0.4852
[09/26 03:07:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.84	
[09/26 03:07:38 visual_prompt]: Training 57 / 100 epoch, with learning rate 0.48255025164874965
[09/26 03:07:45 visual_prompt]: Epoch 57 / 100: avg data time: 4.73e-02, avg batch time: 0.4929, average train loss: 0.0424
[09/26 03:07:46 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1675, average loss: 0.4561
[09/26 03:07:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 95.03	
[09/26 03:07:46 visual_prompt]: Best epoch 57: best metric: 0.885
[09/26 03:07:46 visual_prompt]: Training 58 / 100 epoch, with learning rate 0.46512176312793735
[09/26 03:07:53 visual_prompt]: Epoch 58 / 100: avg data time: 4.20e-02, avg batch time: 0.4864, average train loss: 0.0132
[09/26 03:07:54 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1677, average loss: 0.5819
[09/26 03:07:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 94.75	
[09/26 03:07:54 visual_prompt]: Training 59 / 100 epoch, with learning rate 0.44773576836617335
[09/26 03:08:01 visual_prompt]: Epoch 59 / 100: avg data time: 5.56e-02, avg batch time: 0.5002, average train loss: 0.0038
[09/26 03:08:03 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1675, average loss: 0.6689
[09/26 03:08:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 94.62	
[09/26 03:08:03 visual_prompt]: Training 60 / 100 epoch, with learning rate 0.4304134495199674
[09/26 03:08:09 visual_prompt]: Epoch 60 / 100: avg data time: 5.10e-02, avg batch time: 0.4975, average train loss: 0.0028
[09/26 03:08:11 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1677, average loss: 0.7525
[09/26 03:08:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.03	
[09/26 03:08:11 visual_prompt]: Training 61 / 100 epoch, with learning rate 0.41317591116653485
[09/26 03:08:17 visual_prompt]: Epoch 61 / 100: avg data time: 5.06e-02, avg batch time: 0.4957, average train loss: 0.0019
[09/26 03:08:19 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1676, average loss: 0.6724
[09/26 03:08:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.90	
[09/26 03:08:19 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.3960441545911204
[09/26 03:08:26 visual_prompt]: Epoch 62 / 100: avg data time: 4.47e-02, avg batch time: 0.4900, average train loss: 0.0015
[09/26 03:08:27 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1676, average loss: 0.6880
[09/26 03:08:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.02	
[09/26 03:08:27 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.3790390522001662
[09/26 03:08:34 visual_prompt]: Epoch 63 / 100: avg data time: 4.60e-02, avg batch time: 0.4911, average train loss: 0.0015
[09/26 03:08:35 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1673, average loss: 0.7234
[09/26 03:08:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.26	
[09/26 03:08:35 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.36218132209150045
[09/26 03:08:42 visual_prompt]: Epoch 64 / 100: avg data time: 4.39e-02, avg batch time: 0.4877, average train loss: 0.0012
[09/26 03:08:43 visual_prompt]: Inference (val):avg data time: 3.21e-05, avg batch time: 0.1678, average loss: 0.7183
[09/26 03:08:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.29	
[09/26 03:08:43 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.34549150281252633
[09/26 03:08:50 visual_prompt]: Epoch 65 / 100: avg data time: 5.36e-02, avg batch time: 0.4972, average train loss: 0.0012
[09/26 03:08:52 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1678, average loss: 0.7125
[09/26 03:08:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.24	
[09/26 03:08:52 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.32898992833716567
[09/26 03:08:58 visual_prompt]: Epoch 66 / 100: avg data time: 3.99e-02, avg batch time: 0.4856, average train loss: 0.0012
[09/26 03:09:00 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1673, average loss: 0.7190
[09/26 03:09:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.24	
[09/26 03:09:00 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.31269670329204396
[09/26 03:09:06 visual_prompt]: Epoch 67 / 100: avg data time: 5.65e-02, avg batch time: 0.5008, average train loss: 0.0010
[09/26 03:09:08 visual_prompt]: Inference (val):avg data time: 3.22e-05, avg batch time: 0.1678, average loss: 0.7298
[09/26 03:09:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.24	
[09/26 03:09:08 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.2966316784621
[09/26 03:09:15 visual_prompt]: Epoch 68 / 100: avg data time: 5.35e-02, avg batch time: 0.4973, average train loss: 0.0011
[09/26 03:09:16 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1675, average loss: 0.7323
[09/26 03:09:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.23	
[09/26 03:09:16 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.28081442660546124
[09/26 03:09:23 visual_prompt]: Epoch 69 / 100: avg data time: 5.65e-02, avg batch time: 0.5006, average train loss: 0.0009
[09/26 03:09:24 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1679, average loss: 0.7391
[09/26 03:09:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.24	
[09/26 03:09:24 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.26526421860705474
[09/26 03:09:31 visual_prompt]: Epoch 70 / 100: avg data time: 5.68e-02, avg batch time: 0.5017, average train loss: 0.0010
[09/26 03:09:33 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1674, average loss: 0.7363
[09/26 03:09:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.23	
[09/26 03:09:33 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.2500000000000001
[09/26 03:09:39 visual_prompt]: Epoch 71 / 100: avg data time: 5.86e-02, avg batch time: 0.5043, average train loss: 0.0010
[09/26 03:09:41 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1676, average loss: 0.7393
[09/26 03:09:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.22	
[09/26 03:09:41 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.2350403678833976
[09/26 03:09:48 visual_prompt]: Epoch 72 / 100: avg data time: 5.13e-02, avg batch time: 0.4953, average train loss: 0.0008
[09/26 03:09:49 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1675, average loss: 0.7411
[09/26 03:09:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.23	
[09/26 03:09:49 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.22040354826462666
[09/26 03:09:56 visual_prompt]: Epoch 73 / 100: avg data time: 4.44e-02, avg batch time: 0.4918, average train loss: 0.0009
[09/26 03:09:57 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1679, average loss: 0.7469
[09/26 03:09:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.21	
[09/26 03:09:57 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.2061073738537635
[09/26 03:10:04 visual_prompt]: Epoch 74 / 100: avg data time: 5.12e-02, avg batch time: 0.4960, average train loss: 0.0008
[09/26 03:10:05 visual_prompt]: Inference (val):avg data time: 3.10e-05, avg batch time: 0.1677, average loss: 0.7507
[09/26 03:10:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.23	
[09/26 03:10:05 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.19216926233717085
[09/26 03:10:12 visual_prompt]: Epoch 75 / 100: avg data time: 5.11e-02, avg batch time: 0.4954, average train loss: 0.0008
[09/26 03:10:14 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1675, average loss: 0.7553
[09/26 03:10:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.24	
[09/26 03:10:14 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.17860619515673032
[09/26 03:10:20 visual_prompt]: Epoch 76 / 100: avg data time: 4.52e-02, avg batch time: 0.4911, average train loss: 0.0008
[09/26 03:10:22 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1673, average loss: 0.7595
[09/26 03:10:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.24	
[09/26 03:10:22 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.16543469682057105
[09/26 03:10:28 visual_prompt]: Epoch 77 / 100: avg data time: 5.40e-02, avg batch time: 0.4989, average train loss: 0.0008
[09/26 03:10:30 visual_prompt]: Inference (val):avg data time: 2.17e-05, avg batch time: 0.1675, average loss: 0.7612
[09/26 03:10:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.26	
[09/26 03:10:30 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.15267081477050132
[09/26 03:10:36 visual_prompt]: Epoch 78 / 100: avg data time: 4.17e-02, avg batch time: 0.4875, average train loss: 0.0008
[09/26 03:10:38 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1677, average loss: 0.7639
[09/26 03:10:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.26	
[09/26 03:10:38 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.14033009983067452
[09/26 03:10:45 visual_prompt]: Epoch 79 / 100: avg data time: 4.70e-02, avg batch time: 0.4927, average train loss: 0.0008
[09/26 03:10:46 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1676, average loss: 0.7651
[09/26 03:10:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.26	
[09/26 03:10:46 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.12842758726130282
[09/26 03:10:53 visual_prompt]: Epoch 80 / 100: avg data time: 4.62e-02, avg batch time: 0.4909, average train loss: 0.0008
[09/26 03:10:54 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1673, average loss: 0.7675
[09/26 03:10:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.25	
[09/26 03:10:54 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.11697777844051105
[09/26 03:11:01 visual_prompt]: Epoch 81 / 100: avg data time: 4.79e-02, avg batch time: 0.4922, average train loss: 0.0008
[09/26 03:11:02 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1677, average loss: 0.7701
[09/26 03:11:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.26	
[09/26 03:11:02 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.10599462319663905
[09/26 03:11:09 visual_prompt]: Epoch 82 / 100: avg data time: 5.04e-02, avg batch time: 0.4950, average train loss: 0.0007
[09/26 03:11:10 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.1675, average loss: 0.7711
[09/26 03:11:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.25	
[09/26 03:11:10 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.09549150281252633
[09/26 03:11:17 visual_prompt]: Epoch 83 / 100: avg data time: 4.84e-02, avg batch time: 0.4948, average train loss: 0.0008
[09/26 03:11:19 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1673, average loss: 0.7708
[09/26 03:11:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.26	
[09/26 03:11:19 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.08548121372247919
[09/26 03:11:25 visual_prompt]: Epoch 84 / 100: avg data time: 4.19e-02, avg batch time: 0.4878, average train loss: 0.0007
[09/26 03:11:27 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1672, average loss: 0.7733
[09/26 03:11:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.26	
[09/26 03:11:27 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.07597595192178702
[09/26 03:11:33 visual_prompt]: Epoch 85 / 100: avg data time: 4.35e-02, avg batch time: 0.4895, average train loss: 0.0011
[09/26 03:11:35 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1674, average loss: 0.7315
[09/26 03:11:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.25	
[09/26 03:11:35 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.06698729810778065
[09/26 03:11:41 visual_prompt]: Epoch 86 / 100: avg data time: 5.30e-02, avg batch time: 0.4967, average train loss: 0.0007
[09/26 03:11:43 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1672, average loss: 0.7188
[09/26 03:11:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 95.25	
[09/26 03:11:43 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.058526203570536506
[09/26 03:11:49 visual_prompt]: Epoch 87 / 100: avg data time: 4.84e-02, avg batch time: 0.4935, average train loss: 0.0008
[09/26 03:11:51 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1676, average loss: 0.7207
[09/26 03:11:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 95.25	
[09/26 03:11:51 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.05060297685041659
[09/26 03:11:58 visual_prompt]: Epoch 88 / 100: avg data time: 3.78e-02, avg batch time: 0.4835, average train loss: 0.0008
[09/26 03:11:59 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1675, average loss: 0.7253
[09/26 03:11:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 95.25	
[09/26 03:11:59 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.04322727117869951
[09/26 03:12:06 visual_prompt]: Epoch 89 / 100: avg data time: 4.93e-02, avg batch time: 0.4933, average train loss: 0.0008
[09/26 03:12:07 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1677, average loss: 0.7291
[09/26 03:12:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 95.25	
[09/26 03:12:07 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.03640807271660634
[09/26 03:12:14 visual_prompt]: Epoch 90 / 100: avg data time: 4.28e-02, avg batch time: 0.4885, average train loss: 0.0008
[09/26 03:12:15 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1673, average loss: 0.7326
[09/26 03:12:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 95.25	
[09/26 03:12:15 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.03015368960704584
[09/26 03:12:22 visual_prompt]: Epoch 91 / 100: avg data time: 4.23e-02, avg batch time: 0.4874, average train loss: 0.0008
[09/26 03:12:23 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1678, average loss: 0.7351
[09/26 03:12:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 95.26	
[09/26 03:12:23 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.024471741852423234
[09/26 03:12:30 visual_prompt]: Epoch 92 / 100: avg data time: 5.00e-02, avg batch time: 0.4943, average train loss: 0.0007
[09/26 03:12:32 visual_prompt]: Inference (val):avg data time: 3.03e-05, avg batch time: 0.1676, average loss: 0.7375
[09/26 03:12:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.26	
[09/26 03:12:32 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.019369152030840553
[09/26 03:12:38 visual_prompt]: Epoch 93 / 100: avg data time: 5.11e-02, avg batch time: 0.4960, average train loss: 0.0007
[09/26 03:12:40 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1675, average loss: 0.7387
[09/26 03:12:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.27	
[09/26 03:12:40 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.014852136862001764
[09/26 03:12:47 visual_prompt]: Epoch 94 / 100: avg data time: 5.47e-02, avg batch time: 0.4997, average train loss: 0.0008
[09/26 03:12:48 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1678, average loss: 0.7396
[09/26 03:12:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.27	
[09/26 03:12:48 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.010926199633097156
[09/26 03:12:55 visual_prompt]: Epoch 95 / 100: avg data time: 6.01e-02, avg batch time: 0.5038, average train loss: 0.0008
[09/26 03:12:56 visual_prompt]: Inference (val):avg data time: 3.13e-05, avg batch time: 0.1675, average loss: 0.7403
[09/26 03:12:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.26	
[09/26 03:12:56 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.00759612349389599
[09/26 03:13:03 visual_prompt]: Epoch 96 / 100: avg data time: 4.76e-02, avg batch time: 0.4936, average train loss: 0.0007
[09/26 03:13:04 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1675, average loss: 0.7406
[09/26 03:13:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.26	
[09/26 03:13:04 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.004865965629214819
[09/26 03:13:11 visual_prompt]: Epoch 97 / 100: avg data time: 5.63e-02, avg batch time: 0.5019, average train loss: 0.0007
[09/26 03:13:13 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1677, average loss: 0.7408
[09/26 03:13:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.26	
[09/26 03:13:13 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.002739052315863355
[09/26 03:13:19 visual_prompt]: Epoch 98 / 100: avg data time: 4.21e-02, avg batch time: 0.4876, average train loss: 0.0007
[09/26 03:13:21 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1674, average loss: 0.7409
[09/26 03:13:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.26	
[09/26 03:13:21 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.0012179748700879012
[09/26 03:13:27 visual_prompt]: Epoch 99 / 100: avg data time: 4.52e-02, avg batch time: 0.4893, average train loss: 0.0007
[09/26 03:13:29 visual_prompt]: Inference (val):avg data time: 3.50e-05, avg batch time: 0.1675, average loss: 0.7410
[09/26 03:13:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.26	
[09/26 03:13:29 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.00030458649045211894
[09/26 03:13:36 visual_prompt]: Epoch 100 / 100: avg data time: 5.45e-02, avg batch time: 0.4990, average train loss: 0.0007
[09/26 03:13:37 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1675, average loss: 0.7410
[09/26 03:13:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 95.26	
[09/26 03:13:37 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 03:13:37 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 03:13:37 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 03:13:37 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 03:13:37 visual_prompt]: Training with config:
[09/26 03:13:37 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr1.0_wd0.0/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 1.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 03:13:37 visual_prompt]: Loading training data...
[09/26 03:13:37 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 03:13:38 visual_prompt]: Number of images: 800
[09/26 03:13:38 visual_prompt]: Number of classes: 2 / 2
[09/26 03:13:38 visual_prompt]: Loading validation data...
[09/26 03:13:38 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 03:13:39 visual_prompt]: Number of images: 200
[09/26 03:13:39 visual_prompt]: Number of classes: 2 / 2
[09/26 03:13:39 visual_prompt]: Constructing models...
[09/26 03:13:41 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 03:13:41 visual_prompt]: tuned percent:0.536
[09/26 03:13:41 visual_prompt]: Device used for model: 0
[09/26 03:13:41 visual_prompt]: Setting up Evaluator...
[09/26 03:13:41 visual_prompt]: Setting up Trainer...
[09/26 03:13:41 visual_prompt]: 	Setting up the optimizer...
[09/26 03:13:41 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 03:13:48 visual_prompt]: Epoch 1 / 100: avg data time: 5.18e-02, avg batch time: 0.4957, average train loss: 1.9750
[09/26 03:13:49 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1672, average loss: 2.0033
[09/26 03:13:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 03:13:49 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 03:13:49 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.1
[09/26 03:13:56 visual_prompt]: Epoch 2 / 100: avg data time: 5.67e-02, avg batch time: 0.5000, average train loss: 4.2394
[09/26 03:13:58 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1669, average loss: 1.2718
[09/26 03:13:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 55.38	
[09/26 03:13:58 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.2
[09/26 03:14:04 visual_prompt]: Epoch 3 / 100: avg data time: 5.62e-02, avg batch time: 0.4995, average train loss: 0.8721
[09/26 03:14:06 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1671, average loss: 0.6652
[09/26 03:14:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 51.00	rocauc: 82.01	
[09/26 03:14:06 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.3
[09/26 03:14:12 visual_prompt]: Epoch 4 / 100: avg data time: 4.23e-02, avg batch time: 0.4867, average train loss: 0.7800
[09/26 03:14:14 visual_prompt]: Inference (val):avg data time: 3.03e-05, avg batch time: 0.1669, average loss: 0.6670
[09/26 03:14:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 51.00	rocauc: 89.51	
[09/26 03:14:14 visual_prompt]: Training 5 / 100 epoch, with learning rate 0.4
[09/26 03:14:21 visual_prompt]: Epoch 5 / 100: avg data time: 5.14e-02, avg batch time: 0.4952, average train loss: 0.6578
[09/26 03:14:22 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1672, average loss: 0.5158
[09/26 03:14:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 90.50	
[09/26 03:14:22 visual_prompt]: Best epoch 5: best metric: 0.825
[09/26 03:14:22 visual_prompt]: Training 6 / 100 epoch, with learning rate 0.5
[09/26 03:14:29 visual_prompt]: Epoch 6 / 100: avg data time: 4.15e-02, avg batch time: 0.4854, average train loss: 0.5704
[09/26 03:14:30 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1673, average loss: 0.4394
[09/26 03:14:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 90.48	
[09/26 03:14:30 visual_prompt]: Training 7 / 100 epoch, with learning rate 0.6
[09/26 03:14:37 visual_prompt]: Epoch 7 / 100: avg data time: 5.55e-02, avg batch time: 0.4988, average train loss: 0.5840
[09/26 03:14:38 visual_prompt]: Inference (val):avg data time: 3.17e-05, avg batch time: 0.1671, average loss: 0.5800
[09/26 03:14:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.50	rocauc: 90.79	
[09/26 03:14:38 visual_prompt]: Training 8 / 100 epoch, with learning rate 0.7
[09/26 03:14:45 visual_prompt]: Epoch 8 / 100: avg data time: 5.17e-02, avg batch time: 0.4945, average train loss: 1.0159
[09/26 03:14:47 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1674, average loss: 1.3464
[09/26 03:14:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 91.23	
[09/26 03:14:47 visual_prompt]: Training 9 / 100 epoch, with learning rate 0.8
[09/26 03:14:53 visual_prompt]: Epoch 9 / 100: avg data time: 4.35e-02, avg batch time: 0.4874, average train loss: 0.8301
[09/26 03:14:55 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1671, average loss: 0.4925
[09/26 03:14:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.50	rocauc: 91.25	
[09/26 03:14:55 visual_prompt]: Training 10 / 100 epoch, with learning rate 0.9
[09/26 03:15:01 visual_prompt]: Epoch 10 / 100: avg data time: 4.96e-02, avg batch time: 0.4938, average train loss: 0.5089
[09/26 03:15:03 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1679, average loss: 0.4381
[09/26 03:15:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 92.35	
[09/26 03:15:03 visual_prompt]: Training 11 / 100 epoch, with learning rate 1.0
[09/26 03:15:09 visual_prompt]: Epoch 11 / 100: avg data time: 5.57e-02, avg batch time: 0.4995, average train loss: 0.4436
[09/26 03:15:11 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1674, average loss: 0.5931
[09/26 03:15:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.50	rocauc: 90.98	
[09/26 03:15:11 visual_prompt]: Training 12 / 100 epoch, with learning rate 0.9996954135095479
[09/26 03:15:18 visual_prompt]: Epoch 12 / 100: avg data time: 4.75e-02, avg batch time: 0.4917, average train loss: 0.4166
[09/26 03:15:19 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1673, average loss: 0.5573
[09/26 03:15:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.50	rocauc: 91.84	
[09/26 03:15:19 visual_prompt]: Training 13 / 100 epoch, with learning rate 0.9987820251299121
[09/26 03:15:26 visual_prompt]: Epoch 13 / 100: avg data time: 5.66e-02, avg batch time: 0.5013, average train loss: 0.3980
[09/26 03:15:27 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1672, average loss: 0.4043
[09/26 03:15:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.33	
[09/26 03:15:27 visual_prompt]: Best epoch 13: best metric: 0.830
[09/26 03:15:27 visual_prompt]: Training 14 / 100 epoch, with learning rate 0.9972609476841366
[09/26 03:15:34 visual_prompt]: Epoch 14 / 100: avg data time: 5.26e-02, avg batch time: 0.4976, average train loss: 0.4395
[09/26 03:15:35 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.1672, average loss: 0.9616
[09/26 03:15:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 63.50	rocauc: 90.67	
[09/26 03:15:35 visual_prompt]: Training 15 / 100 epoch, with learning rate 0.9951340343707852
[09/26 03:15:42 visual_prompt]: Epoch 15 / 100: avg data time: 5.72e-02, avg batch time: 0.5016, average train loss: 0.6528
[09/26 03:15:44 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1675, average loss: 0.6555
[09/26 03:15:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.00	rocauc: 93.29	
[09/26 03:15:44 visual_prompt]: Training 16 / 100 epoch, with learning rate 0.9924038765061041
[09/26 03:15:51 visual_prompt]: Epoch 16 / 100: avg data time: 6.24e-02, avg batch time: 0.5068, average train loss: 0.4950
[09/26 03:15:52 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1675, average loss: 0.6002
[09/26 03:15:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 94.53	
[09/26 03:15:52 visual_prompt]: Training 17 / 100 epoch, with learning rate 0.9890738003669028
[09/26 03:15:59 visual_prompt]: Epoch 17 / 100: avg data time: 4.87e-02, avg batch time: 0.4948, average train loss: 0.4201
[09/26 03:16:00 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1673, average loss: 0.3932
[09/26 03:16:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 94.24	
[09/26 03:16:00 visual_prompt]: Training 18 / 100 epoch, with learning rate 0.9851478631379982
[09/26 03:16:07 visual_prompt]: Epoch 18 / 100: avg data time: 5.13e-02, avg batch time: 0.4962, average train loss: 0.3351
[09/26 03:16:08 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1675, average loss: 0.4330
[09/26 03:16:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 94.46	
[09/26 03:16:08 visual_prompt]: Training 19 / 100 epoch, with learning rate 0.9806308479691594
[09/26 03:16:15 visual_prompt]: Epoch 19 / 100: avg data time: 4.35e-02, avg batch time: 0.4888, average train loss: 0.3298
[09/26 03:16:16 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1674, average loss: 0.3969
[09/26 03:16:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 93.48	
[09/26 03:16:16 visual_prompt]: Training 20 / 100 epoch, with learning rate 0.9755282581475768
[09/26 03:16:23 visual_prompt]: Epoch 20 / 100: avg data time: 4.41e-02, avg batch time: 0.4892, average train loss: 0.2551
[09/26 03:16:24 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1673, average loss: 0.3574
[09/26 03:16:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 94.23	
[09/26 03:16:24 visual_prompt]: Best epoch 20: best metric: 0.860
[09/26 03:16:24 visual_prompt]: Training 21 / 100 epoch, with learning rate 0.9698463103929542
[09/26 03:16:31 visual_prompt]: Epoch 21 / 100: avg data time: 4.15e-02, avg batch time: 0.4872, average train loss: 0.2829
[09/26 03:16:32 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1673, average loss: 0.3437
[09/26 03:16:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 94.35	
[09/26 03:16:32 visual_prompt]: Training 22 / 100 epoch, with learning rate 0.9635919272833937
[09/26 03:16:39 visual_prompt]: Epoch 22 / 100: avg data time: 3.97e-02, avg batch time: 0.4852, average train loss: 0.2743
[09/26 03:16:40 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1675, average loss: 0.4028
[09/26 03:16:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.21	
[09/26 03:16:40 visual_prompt]: Best epoch 22: best metric: 0.865
[09/26 03:16:40 visual_prompt]: Training 23 / 100 epoch, with learning rate 0.9567727288213004
[09/26 03:16:47 visual_prompt]: Epoch 23 / 100: avg data time: 4.62e-02, avg batch time: 0.4903, average train loss: 0.2501
[09/26 03:16:48 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1674, average loss: 0.4765
[09/26 03:16:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 95.18	
[09/26 03:16:48 visual_prompt]: Training 24 / 100 epoch, with learning rate 0.9493970231495835
[09/26 03:16:55 visual_prompt]: Epoch 24 / 100: avg data time: 3.96e-02, avg batch time: 0.4873, average train loss: 0.3548
[09/26 03:16:57 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1674, average loss: 0.9052
[09/26 03:16:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.50	rocauc: 94.74	
[09/26 03:16:57 visual_prompt]: Training 25 / 100 epoch, with learning rate 0.9414737964294635
[09/26 03:17:03 visual_prompt]: Epoch 25 / 100: avg data time: 4.08e-02, avg batch time: 0.4868, average train loss: 0.4431
[09/26 03:17:05 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1674, average loss: 0.3960
[09/26 03:17:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 95.24	
[09/26 03:17:05 visual_prompt]: Training 26 / 100 epoch, with learning rate 0.9330127018922194
[09/26 03:17:11 visual_prompt]: Epoch 26 / 100: avg data time: 4.21e-02, avg batch time: 0.4863, average train loss: 0.1987
[09/26 03:17:13 visual_prompt]: Inference (val):avg data time: 3.07e-05, avg batch time: 0.1679, average loss: 0.4655
[09/26 03:17:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 94.97	
[09/26 03:17:13 visual_prompt]: Training 27 / 100 epoch, with learning rate 0.9240240480782129
[09/26 03:17:19 visual_prompt]: Epoch 27 / 100: avg data time: 4.41e-02, avg batch time: 0.4882, average train loss: 0.2702
[09/26 03:17:21 visual_prompt]: Inference (val):avg data time: 3.10e-05, avg batch time: 0.1684, average loss: 0.3568
[09/26 03:17:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.95	
[09/26 03:17:21 visual_prompt]: Best epoch 27: best metric: 0.870
[09/26 03:17:21 visual_prompt]: Training 28 / 100 epoch, with learning rate 0.9145187862775208
[09/26 03:17:28 visual_prompt]: Epoch 28 / 100: avg data time: 5.25e-02, avg batch time: 0.4967, average train loss: 0.1922
[09/26 03:17:29 visual_prompt]: Inference (val):avg data time: 4.82e-05, avg batch time: 0.1677, average loss: 0.3296
[09/26 03:17:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 94.46	
[09/26 03:17:29 visual_prompt]: Best epoch 28: best metric: 0.875
[09/26 03:17:29 visual_prompt]: Training 29 / 100 epoch, with learning rate 0.9045084971874737
[09/26 03:17:36 visual_prompt]: Epoch 29 / 100: avg data time: 4.17e-02, avg batch time: 0.4873, average train loss: 0.1404
[09/26 03:17:37 visual_prompt]: Inference (val):avg data time: 3.09e-05, avg batch time: 0.1678, average loss: 0.4197
[09/26 03:17:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.45	
[09/26 03:17:37 visual_prompt]: Training 30 / 100 epoch, with learning rate 0.8940053768033609
[09/26 03:17:44 visual_prompt]: Epoch 30 / 100: avg data time: 4.36e-02, avg batch time: 0.4885, average train loss: 0.1024
[09/26 03:17:45 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1676, average loss: 0.3908
[09/26 03:17:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 95.01	
[09/26 03:17:45 visual_prompt]: Training 31 / 100 epoch, with learning rate 0.883022221559489
[09/26 03:17:52 visual_prompt]: Epoch 31 / 100: avg data time: 5.58e-02, avg batch time: 0.4989, average train loss: 0.0978
[09/26 03:17:54 visual_prompt]: Inference (val):avg data time: 3.21e-05, avg batch time: 0.1675, average loss: 0.3975
[09/26 03:17:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.38	
[09/26 03:17:54 visual_prompt]: Training 32 / 100 epoch, with learning rate 0.8715724127386971
[09/26 03:18:00 visual_prompt]: Epoch 32 / 100: avg data time: 4.43e-02, avg batch time: 0.4896, average train loss: 0.1308
[09/26 03:18:02 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1674, average loss: 0.4928
[09/26 03:18:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 95.21	
[09/26 03:18:02 visual_prompt]: Training 33 / 100 epoch, with learning rate 0.8596699001693255
[09/26 03:18:08 visual_prompt]: Epoch 33 / 100: avg data time: 4.51e-02, avg batch time: 0.4911, average train loss: 0.1024
[09/26 03:18:10 visual_prompt]: Inference (val):avg data time: 4.33e-05, avg batch time: 0.1676, average loss: 0.5634
[09/26 03:18:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 94.87	
[09/26 03:18:10 visual_prompt]: Training 34 / 100 epoch, with learning rate 0.8473291852294986
[09/26 03:18:17 visual_prompt]: Epoch 34 / 100: avg data time: 5.64e-02, avg batch time: 0.5008, average train loss: 0.1086
[09/26 03:18:18 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1676, average loss: 0.6101
[09/26 03:18:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 94.78	
[09/26 03:18:18 visual_prompt]: Training 35 / 100 epoch, with learning rate 0.8345653031794291
[09/26 03:18:25 visual_prompt]: Epoch 35 / 100: avg data time: 5.13e-02, avg batch time: 0.4962, average train loss: 0.0899
[09/26 03:18:26 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1675, average loss: 0.5284
[09/26 03:18:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.08	
[09/26 03:18:26 visual_prompt]: Training 36 / 100 epoch, with learning rate 0.8213938048432696
[09/26 03:18:33 visual_prompt]: Epoch 36 / 100: avg data time: 5.73e-02, avg batch time: 0.5021, average train loss: 0.1064
[09/26 03:18:35 visual_prompt]: Inference (val):avg data time: 3.18e-05, avg batch time: 0.1675, average loss: 0.4871
[09/26 03:18:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.57	
[09/26 03:18:35 visual_prompt]: Training 37 / 100 epoch, with learning rate 0.8078307376628291
[09/26 03:18:41 visual_prompt]: Epoch 37 / 100: avg data time: 4.92e-02, avg batch time: 0.4929, average train loss: 0.0599
[09/26 03:18:43 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1674, average loss: 0.5653
[09/26 03:18:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 94.65	
[09/26 03:18:43 visual_prompt]: Training 38 / 100 epoch, with learning rate 0.7938926261462366
[09/26 03:18:50 visual_prompt]: Epoch 38 / 100: avg data time: 4.97e-02, avg batch time: 0.4945, average train loss: 0.0816
[09/26 03:18:51 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1676, average loss: 0.5946
[09/26 03:18:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.65	
[09/26 03:18:51 visual_prompt]: Training 39 / 100 epoch, with learning rate 0.7795964517353734
[09/26 03:18:58 visual_prompt]: Epoch 39 / 100: avg data time: 5.62e-02, avg batch time: 0.5011, average train loss: 0.0854
[09/26 03:18:59 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1674, average loss: 0.4315
[09/26 03:18:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 94.43	
[09/26 03:18:59 visual_prompt]: Training 40 / 100 epoch, with learning rate 0.7649596321166025
[09/26 03:19:06 visual_prompt]: Epoch 40 / 100: avg data time: 6.45e-02, avg batch time: 0.5083, average train loss: 0.0663
[09/26 03:19:07 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1677, average loss: 0.4510
[09/26 03:19:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 94.28	
[09/26 03:19:07 visual_prompt]: Best epoch 40: best metric: 0.885
[09/26 03:19:07 visual_prompt]: Training 41 / 100 epoch, with learning rate 0.75
[09/26 03:19:14 visual_prompt]: Epoch 41 / 100: avg data time: 5.59e-02, avg batch time: 0.5031, average train loss: 0.0848
[09/26 03:19:16 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1672, average loss: 0.6163
[09/26 03:19:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.31	
[09/26 03:19:16 visual_prompt]: Training 42 / 100 epoch, with learning rate 0.7347357813929454
[09/26 03:19:22 visual_prompt]: Epoch 42 / 100: avg data time: 5.10e-02, avg batch time: 0.4954, average train loss: 0.0426
[09/26 03:19:24 visual_prompt]: Inference (val):avg data time: 3.52e-05, avg batch time: 0.1674, average loss: 0.6082
[09/26 03:19:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.26	
[09/26 03:19:24 visual_prompt]: Training 43 / 100 epoch, with learning rate 0.7191855733945387
[09/26 03:19:30 visual_prompt]: Epoch 43 / 100: avg data time: 4.09e-02, avg batch time: 0.4862, average train loss: 0.0165
[09/26 03:19:32 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1673, average loss: 0.6156
[09/26 03:19:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.25	
[09/26 03:19:32 visual_prompt]: Training 44 / 100 epoch, with learning rate 0.7033683215379002
[09/26 03:19:39 visual_prompt]: Epoch 44 / 100: avg data time: 5.43e-02, avg batch time: 0.4980, average train loss: 0.0084
[09/26 03:19:40 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1672, average loss: 0.6403
[09/26 03:19:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.19	
[09/26 03:19:40 visual_prompt]: Training 45 / 100 epoch, with learning rate 0.6873032967079561
[09/26 03:19:47 visual_prompt]: Epoch 45 / 100: avg data time: 5.53e-02, avg batch time: 0.4990, average train loss: 0.0058
[09/26 03:19:48 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1674, average loss: 0.7074
[09/26 03:19:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 92.78	
[09/26 03:19:48 visual_prompt]: Training 46 / 100 epoch, with learning rate 0.6710100716628344
[09/26 03:19:55 visual_prompt]: Epoch 46 / 100: avg data time: 5.17e-02, avg batch time: 0.4968, average train loss: 0.0031
[09/26 03:19:56 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1675, average loss: 0.7376
[09/26 03:19:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 92.62	
[09/26 03:19:56 visual_prompt]: Training 47 / 100 epoch, with learning rate 0.6545084971874737
[09/26 03:20:03 visual_prompt]: Epoch 47 / 100: avg data time: 4.17e-02, avg batch time: 0.4864, average train loss: 0.0019
[09/26 03:20:04 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1673, average loss: 0.7564
[09/26 03:20:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 92.98	
[09/26 03:20:05 visual_prompt]: Training 48 / 100 epoch, with learning rate 0.6378186779084996
[09/26 03:20:11 visual_prompt]: Epoch 48 / 100: avg data time: 4.57e-02, avg batch time: 0.4908, average train loss: 0.0019
[09/26 03:20:13 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1677, average loss: 0.7679
[09/26 03:20:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.09	
[09/26 03:20:13 visual_prompt]: Training 49 / 100 epoch, with learning rate 0.6209609477998338
[09/26 03:20:19 visual_prompt]: Epoch 49 / 100: avg data time: 4.30e-02, avg batch time: 0.4876, average train loss: 0.0013
[09/26 03:20:21 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1678, average loss: 0.7852
[09/26 03:20:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.21	
[09/26 03:20:21 visual_prompt]: Training 50 / 100 epoch, with learning rate 0.6039558454088796
[09/26 03:20:27 visual_prompt]: Epoch 50 / 100: avg data time: 4.18e-02, avg batch time: 0.4877, average train loss: 0.0010
[09/26 03:20:29 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1672, average loss: 0.7951
[09/26 03:20:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.25	
[09/26 03:20:29 visual_prompt]: Training 51 / 100 epoch, with learning rate 0.5868240888334653
[09/26 03:20:35 visual_prompt]: Epoch 51 / 100: avg data time: 4.90e-02, avg batch time: 0.4936, average train loss: 0.0011
[09/26 03:20:37 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1676, average loss: 0.8023
[09/26 03:20:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.25	
[09/26 03:20:37 visual_prompt]: Training 52 / 100 epoch, with learning rate 0.5695865504800327
[09/26 03:20:44 visual_prompt]: Epoch 52 / 100: avg data time: 5.71e-02, avg batch time: 0.5009, average train loss: 0.0009
[09/26 03:20:45 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1673, average loss: 0.8282
[09/26 03:20:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 92.79	
[09/26 03:20:45 visual_prompt]: Training 53 / 100 epoch, with learning rate 0.5522642316338268
[09/26 03:20:52 visual_prompt]: Epoch 53 / 100: avg data time: 5.34e-02, avg batch time: 0.4974, average train loss: 0.0008
[09/26 03:20:53 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1677, average loss: 0.8252
[09/26 03:20:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 92.79	
[09/26 03:20:53 visual_prompt]: Training 54 / 100 epoch, with learning rate 0.5348782368720626
[09/26 03:21:00 visual_prompt]: Epoch 54 / 100: avg data time: 4.70e-02, avg batch time: 0.4912, average train loss: 0.0007
[09/26 03:21:01 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1673, average loss: 0.8315
[09/26 03:21:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 92.96	
[09/26 03:21:02 visual_prompt]: Training 55 / 100 epoch, with learning rate 0.5174497483512506
[09/26 03:21:08 visual_prompt]: Epoch 55 / 100: avg data time: 5.63e-02, avg batch time: 0.5012, average train loss: 0.0006
[09/26 03:21:10 visual_prompt]: Inference (val):avg data time: 3.33e-05, avg batch time: 0.1677, average loss: 0.8453
[09/26 03:21:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.01	
[09/26 03:21:10 visual_prompt]: Training 56 / 100 epoch, with learning rate 0.5
[09/26 03:21:16 visual_prompt]: Epoch 56 / 100: avg data time: 5.15e-02, avg batch time: 0.4957, average train loss: 0.0005
[09/26 03:21:18 visual_prompt]: Inference (val):avg data time: 2.20e-05, avg batch time: 0.1675, average loss: 0.8537
[09/26 03:21:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.06	
[09/26 03:21:18 visual_prompt]: Training 57 / 100 epoch, with learning rate 0.48255025164874965
[09/26 03:21:25 visual_prompt]: Epoch 57 / 100: avg data time: 5.21e-02, avg batch time: 0.4972, average train loss: 0.0005
[09/26 03:21:26 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1675, average loss: 0.8662
[09/26 03:21:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.07	
[09/26 03:21:26 visual_prompt]: Training 58 / 100 epoch, with learning rate 0.46512176312793735
[09/26 03:21:33 visual_prompt]: Epoch 58 / 100: avg data time: 4.39e-02, avg batch time: 0.4890, average train loss: 0.0005
[09/26 03:21:34 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1677, average loss: 0.8780
[09/26 03:21:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.08	
[09/26 03:21:34 visual_prompt]: Training 59 / 100 epoch, with learning rate 0.44773576836617335
[09/26 03:21:41 visual_prompt]: Epoch 59 / 100: avg data time: 4.17e-02, avg batch time: 0.4886, average train loss: 0.0006
[09/26 03:21:42 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1677, average loss: 0.9077
[09/26 03:21:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.09	
[09/26 03:21:42 visual_prompt]: Training 60 / 100 epoch, with learning rate 0.4304134495199674
[09/26 03:21:49 visual_prompt]: Epoch 60 / 100: avg data time: 4.34e-02, avg batch time: 0.4896, average train loss: 0.0005
[09/26 03:21:50 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1674, average loss: 0.9213
[09/26 03:21:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.04	
[09/26 03:21:50 visual_prompt]: Training 61 / 100 epoch, with learning rate 0.41317591116653485
[09/26 03:21:57 visual_prompt]: Epoch 61 / 100: avg data time: 4.80e-02, avg batch time: 0.4935, average train loss: 0.0004
[09/26 03:21:59 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1674, average loss: 0.9204
[09/26 03:21:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.06	
[09/26 03:21:59 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.3960441545911204
[09/26 03:22:05 visual_prompt]: Epoch 62 / 100: avg data time: 6.09e-02, avg batch time: 0.5047, average train loss: 0.0004
[09/26 03:22:07 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1674, average loss: 0.9236
[09/26 03:22:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.07	
[09/26 03:22:07 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.3790390522001662
[09/26 03:22:14 visual_prompt]: Epoch 63 / 100: avg data time: 5.30e-02, avg batch time: 0.4975, average train loss: 0.0004
[09/26 03:22:15 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1677, average loss: 0.9250
[09/26 03:22:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.02	
[09/26 03:22:15 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.36218132209150045
[09/26 03:22:22 visual_prompt]: Epoch 64 / 100: avg data time: 5.84e-02, avg batch time: 0.5045, average train loss: 0.0003
[09/26 03:22:23 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1675, average loss: 0.9384
[09/26 03:22:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.05	
[09/26 03:22:23 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.34549150281252633
[09/26 03:22:30 visual_prompt]: Epoch 65 / 100: avg data time: 3.86e-02, avg batch time: 0.4841, average train loss: 0.0003
[09/26 03:22:31 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1674, average loss: 0.9476
[09/26 03:22:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.06	
[09/26 03:22:31 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.32898992833716567
[09/26 03:22:38 visual_prompt]: Epoch 66 / 100: avg data time: 4.26e-02, avg batch time: 0.4884, average train loss: 0.0003
[09/26 03:22:39 visual_prompt]: Inference (val):avg data time: 2.70e-05, avg batch time: 0.1674, average loss: 0.9555
[09/26 03:22:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.08	
[09/26 03:22:39 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.31269670329204396
[09/26 03:22:46 visual_prompt]: Epoch 67 / 100: avg data time: 5.24e-02, avg batch time: 0.4976, average train loss: 0.0003
[09/26 03:22:48 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1675, average loss: 0.9608
[09/26 03:22:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.10	
[09/26 03:22:48 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.2966316784621
[09/26 03:22:54 visual_prompt]: Epoch 68 / 100: avg data time: 5.10e-02, avg batch time: 0.4953, average train loss: 0.0003
[09/26 03:22:56 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1675, average loss: 0.9666
[09/26 03:22:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.10	
[09/26 03:22:56 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.28081442660546124
[09/26 03:23:03 visual_prompt]: Epoch 69 / 100: avg data time: 5.72e-02, avg batch time: 0.5017, average train loss: 0.0002
[09/26 03:23:04 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1676, average loss: 0.9713
[09/26 03:23:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.10	
[09/26 03:23:04 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.26526421860705474
[09/26 03:23:11 visual_prompt]: Epoch 70 / 100: avg data time: 5.14e-02, avg batch time: 0.4967, average train loss: 0.0003
[09/26 03:23:12 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1677, average loss: 0.9795
[09/26 03:23:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.12	
[09/26 03:23:12 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.2500000000000001
[09/26 03:23:19 visual_prompt]: Epoch 71 / 100: avg data time: 5.29e-02, avg batch time: 0.4962, average train loss: 0.0002
[09/26 03:23:20 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1675, average loss: 0.9840
[09/26 03:23:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.14	
[09/26 03:23:20 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.2350403678833976
[09/26 03:23:27 visual_prompt]: Epoch 72 / 100: avg data time: 5.55e-02, avg batch time: 0.5001, average train loss: 0.0002
[09/26 03:23:29 visual_prompt]: Inference (val):avg data time: 3.08e-05, avg batch time: 0.1676, average loss: 0.9857
[09/26 03:23:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.16	
[09/26 03:23:29 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.22040354826462666
[09/26 03:23:35 visual_prompt]: Epoch 73 / 100: avg data time: 5.96e-02, avg batch time: 0.5045, average train loss: 0.0003
[09/26 03:23:37 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1672, average loss: 1.0063
[09/26 03:23:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.24	
[09/26 03:23:37 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.2061073738537635
[09/26 03:23:44 visual_prompt]: Epoch 74 / 100: avg data time: 5.65e-02, avg batch time: 0.5001, average train loss: 0.0002
[09/26 03:23:45 visual_prompt]: Inference (val):avg data time: 2.98e-05, avg batch time: 0.1673, average loss: 1.0131
[09/26 03:23:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.26	
[09/26 03:23:45 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.19216926233717085
[09/26 03:23:52 visual_prompt]: Epoch 75 / 100: avg data time: 5.28e-02, avg batch time: 0.4963, average train loss: 0.0002
[09/26 03:23:53 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1674, average loss: 1.0120
[09/26 03:23:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.27	
[09/26 03:23:53 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.17860619515673032
[09/26 03:24:00 visual_prompt]: Epoch 76 / 100: avg data time: 5.33e-02, avg batch time: 0.4983, average train loss: 0.0003
[09/26 03:24:02 visual_prompt]: Inference (val):avg data time: 4.18e-05, avg batch time: 0.1676, average loss: 1.0087
[09/26 03:24:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.26	
[09/26 03:24:02 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.16543469682057105
[09/26 03:24:08 visual_prompt]: Epoch 77 / 100: avg data time: 5.96e-02, avg batch time: 0.5030, average train loss: 0.0002
[09/26 03:24:10 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1676, average loss: 1.0058
[09/26 03:24:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.23	
[09/26 03:24:10 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.15267081477050132
[09/26 03:24:17 visual_prompt]: Epoch 78 / 100: avg data time: 6.03e-02, avg batch time: 0.5043, average train loss: 0.0005
[09/26 03:24:18 visual_prompt]: Inference (val):avg data time: 3.29e-05, avg batch time: 0.1676, average loss: 0.9917
[09/26 03:24:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.28	
[09/26 03:24:18 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.14033009983067452
[09/26 03:24:25 visual_prompt]: Epoch 79 / 100: avg data time: 5.58e-02, avg batch time: 0.4990, average train loss: 0.0002
[09/26 03:24:26 visual_prompt]: Inference (val):avg data time: 3.24e-05, avg batch time: 0.1676, average loss: 0.9694
[09/26 03:24:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.17	
[09/26 03:24:26 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.12842758726130282
[09/26 03:24:33 visual_prompt]: Epoch 80 / 100: avg data time: 5.75e-02, avg batch time: 0.5018, average train loss: 0.0002
[09/26 03:24:35 visual_prompt]: Inference (val):avg data time: 2.99e-05, avg batch time: 0.1677, average loss: 0.9677
[09/26 03:24:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.12	
[09/26 03:24:35 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.11697777844051105
[09/26 03:24:41 visual_prompt]: Epoch 81 / 100: avg data time: 5.25e-02, avg batch time: 0.4974, average train loss: 0.0003
[09/26 03:24:43 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1671, average loss: 0.9727
[09/26 03:24:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.19	
[09/26 03:24:43 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.10599462319663905
[09/26 03:24:50 visual_prompt]: Epoch 82 / 100: avg data time: 5.68e-02, avg batch time: 0.5002, average train loss: 0.0004
[09/26 03:24:51 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1675, average loss: 0.9834
[09/26 03:24:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.18	
[09/26 03:24:51 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.09549150281252633
[09/26 03:24:58 visual_prompt]: Epoch 83 / 100: avg data time: 5.91e-02, avg batch time: 0.5029, average train loss: 0.0002
[09/26 03:24:59 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1676, average loss: 0.9981
[09/26 03:24:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.19	
[09/26 03:24:59 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.08548121372247919
[09/26 03:25:06 visual_prompt]: Epoch 84 / 100: avg data time: 4.26e-02, avg batch time: 0.4888, average train loss: 0.0002
[09/26 03:25:07 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1673, average loss: 1.0009
[09/26 03:25:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.20	
[09/26 03:25:07 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.07597595192178702
[09/26 03:25:14 visual_prompt]: Epoch 85 / 100: avg data time: 4.40e-02, avg batch time: 0.4879, average train loss: 0.0002
[09/26 03:25:15 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1678, average loss: 1.0017
[09/26 03:25:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.21	
[09/26 03:25:15 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.06698729810778065
[09/26 03:25:22 visual_prompt]: Epoch 86 / 100: avg data time: 5.24e-02, avg batch time: 0.4967, average train loss: 0.0002
[09/26 03:25:24 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1675, average loss: 1.0023
[09/26 03:25:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.20	
[09/26 03:25:24 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.058526203570536506
[09/26 03:25:30 visual_prompt]: Epoch 87 / 100: avg data time: 4.36e-02, avg batch time: 0.4880, average train loss: 0.0002
[09/26 03:25:32 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1676, average loss: 1.0027
[09/26 03:25:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.20	
[09/26 03:25:32 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.05060297685041659
[09/26 03:25:38 visual_prompt]: Epoch 88 / 100: avg data time: 6.22e-02, avg batch time: 0.5077, average train loss: 0.0002
[09/26 03:25:40 visual_prompt]: Inference (val):avg data time: 3.77e-05, avg batch time: 0.1675, average loss: 1.0029
[09/26 03:25:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.21	
[09/26 03:25:40 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.04322727117869951
[09/26 03:25:47 visual_prompt]: Epoch 89 / 100: avg data time: 4.77e-02, avg batch time: 0.4951, average train loss: 0.0002
[09/26 03:25:48 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1673, average loss: 1.0029
[09/26 03:25:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.23	
[09/26 03:25:48 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.03640807271660634
[09/26 03:25:55 visual_prompt]: Epoch 90 / 100: avg data time: 5.30e-02, avg batch time: 0.4975, average train loss: 0.0002
[09/26 03:25:56 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1674, average loss: 1.0032
[09/26 03:25:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.23	
[09/26 03:25:56 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.03015368960704584
[09/26 03:26:03 visual_prompt]: Epoch 91 / 100: avg data time: 4.53e-02, avg batch time: 0.4908, average train loss: 0.0002
[09/26 03:26:04 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1676, average loss: 1.0033
[09/26 03:26:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.23	
[09/26 03:26:04 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.024471741852423234
[09/26 03:26:11 visual_prompt]: Epoch 92 / 100: avg data time: 4.31e-02, avg batch time: 0.4891, average train loss: 0.0002
[09/26 03:26:13 visual_prompt]: Inference (val):avg data time: 3.60e-05, avg batch time: 0.1675, average loss: 1.0034
[09/26 03:26:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.23	
[09/26 03:26:13 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.019369152030840553
[09/26 03:26:19 visual_prompt]: Epoch 93 / 100: avg data time: 4.69e-02, avg batch time: 0.4911, average train loss: 0.0002
[09/26 03:26:21 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1673, average loss: 1.0035
[09/26 03:26:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.23	
[09/26 03:26:21 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.014852136862001764
[09/26 03:26:27 visual_prompt]: Epoch 94 / 100: avg data time: 4.38e-02, avg batch time: 0.4886, average train loss: 0.0002
[09/26 03:26:29 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1673, average loss: 1.0036
[09/26 03:26:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.23	
[09/26 03:26:29 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.010926199633097156
[09/26 03:26:36 visual_prompt]: Epoch 95 / 100: avg data time: 5.41e-02, avg batch time: 0.4980, average train loss: 0.0002
[09/26 03:26:37 visual_prompt]: Inference (val):avg data time: 2.92e-05, avg batch time: 0.1677, average loss: 1.0036
[09/26 03:26:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.24	
[09/26 03:26:37 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.00759612349389599
[09/26 03:26:44 visual_prompt]: Epoch 96 / 100: avg data time: 5.48e-02, avg batch time: 0.4992, average train loss: 0.0002
[09/26 03:26:45 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1675, average loss: 1.0036
[09/26 03:26:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.24	
[09/26 03:26:45 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.004865965629214819
[09/26 03:26:52 visual_prompt]: Epoch 97 / 100: avg data time: 5.66e-02, avg batch time: 0.5013, average train loss: 0.0002
[09/26 03:26:54 visual_prompt]: Inference (val):avg data time: 2.99e-05, avg batch time: 0.1679, average loss: 1.0036
[09/26 03:26:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.24	
[09/26 03:26:54 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.002739052315863355
[09/26 03:27:00 visual_prompt]: Epoch 98 / 100: avg data time: 5.15e-02, avg batch time: 0.4952, average train loss: 0.0002
[09/26 03:27:02 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1675, average loss: 1.0035
[09/26 03:27:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.24	
[09/26 03:27:02 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.0012179748700879012
[09/26 03:27:08 visual_prompt]: Epoch 99 / 100: avg data time: 4.23e-02, avg batch time: 0.4868, average train loss: 0.0002
[09/26 03:27:10 visual_prompt]: Inference (val):avg data time: 3.89e-05, avg batch time: 0.1674, average loss: 1.0035
[09/26 03:27:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.23	
[09/26 03:27:10 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.00030458649045211894
[09/26 03:27:17 visual_prompt]: Epoch 100 / 100: avg data time: 5.56e-02, avg batch time: 0.4987, average train loss: 0.0002
[09/26 03:27:18 visual_prompt]: Inference (val):avg data time: 2.92e-05, avg batch time: 0.1672, average loss: 1.0035
[09/26 03:27:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.23	
[09/26 03:27:18 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 03:27:18 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 03:27:18 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 03:27:18 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 03:27:18 visual_prompt]: Training with config:
[09/26 03:27:18 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr0.5_wd0.01/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.01, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 0.5, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 03:27:18 visual_prompt]: Loading training data...
[09/26 03:27:18 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 03:27:19 visual_prompt]: Number of images: 800
[09/26 03:27:19 visual_prompt]: Number of classes: 2 / 2
[09/26 03:27:19 visual_prompt]: Loading validation data...
[09/26 03:27:19 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 03:27:20 visual_prompt]: Number of images: 200
[09/26 03:27:20 visual_prompt]: Number of classes: 2 / 2
[09/26 03:27:20 visual_prompt]: Constructing models...
[09/26 03:27:22 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 03:27:22 visual_prompt]: tuned percent:0.536
[09/26 03:27:22 visual_prompt]: Device used for model: 0
[09/26 03:27:22 visual_prompt]: Setting up Evaluator...
[09/26 03:27:22 visual_prompt]: Setting up Trainer...
[09/26 03:27:22 visual_prompt]: 	Setting up the optimizer...
[09/26 03:27:22 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 03:27:29 visual_prompt]: Epoch 1 / 100: avg data time: 5.72e-02, avg batch time: 0.5007, average train loss: 1.9345
[09/26 03:27:30 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1670, average loss: 2.0033
[09/26 03:27:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 03:27:30 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 03:27:30 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.05
[09/26 03:27:37 visual_prompt]: Epoch 2 / 100: avg data time: 5.55e-02, avg batch time: 0.4984, average train loss: 2.7786
[09/26 03:27:38 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1668, average loss: 0.6843
[09/26 03:27:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 50.50	rocauc: 53.73	
[09/26 03:27:38 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.1
[09/26 03:27:45 visual_prompt]: Epoch 3 / 100: avg data time: 4.73e-02, avg batch time: 0.4905, average train loss: 0.7658
[09/26 03:27:47 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1669, average loss: 0.6097
[09/26 03:27:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 69.00	rocauc: 88.21	
[09/26 03:27:47 visual_prompt]: Best epoch 3: best metric: 0.690
[09/26 03:27:47 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.15
[09/26 03:27:53 visual_prompt]: Epoch 4 / 100: avg data time: 5.98e-02, avg batch time: 0.5026, average train loss: 0.6190
[09/26 03:27:55 visual_prompt]: Inference (val):avg data time: 2.23e-05, avg batch time: 0.1669, average loss: 0.5334
[09/26 03:27:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.00	rocauc: 89.23	
[09/26 03:27:55 visual_prompt]: Best epoch 4: best metric: 0.700
[09/26 03:27:55 visual_prompt]: Training 5 / 100 epoch, with learning rate 0.2
[09/26 03:28:01 visual_prompt]: Epoch 5 / 100: avg data time: 5.08e-02, avg batch time: 0.4942, average train loss: 0.6264
[09/26 03:28:03 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1672, average loss: 0.7436
[09/26 03:28:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 90.84	
[09/26 03:28:03 visual_prompt]: Training 6 / 100 epoch, with learning rate 0.25
[09/26 03:28:10 visual_prompt]: Epoch 6 / 100: avg data time: 4.13e-02, avg batch time: 0.4856, average train loss: 0.6946
[09/26 03:28:11 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1674, average loss: 0.5752
[09/26 03:28:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.50	rocauc: 90.26	
[09/26 03:28:11 visual_prompt]: Best epoch 6: best metric: 0.745
[09/26 03:28:11 visual_prompt]: Training 7 / 100 epoch, with learning rate 0.3
[09/26 03:28:18 visual_prompt]: Epoch 7 / 100: avg data time: 5.22e-02, avg batch time: 0.4966, average train loss: 0.5770
[09/26 03:28:19 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1672, average loss: 0.6076
[09/26 03:28:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 63.00	rocauc: 91.40	
[09/26 03:28:19 visual_prompt]: Training 8 / 100 epoch, with learning rate 0.35
[09/26 03:28:26 visual_prompt]: Epoch 8 / 100: avg data time: 4.58e-02, avg batch time: 0.4916, average train loss: 0.6846
[09/26 03:28:27 visual_prompt]: Inference (val):avg data time: 4.55e-05, avg batch time: 0.1673, average loss: 0.6222
[09/26 03:28:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 67.50	rocauc: 90.55	
[09/26 03:28:27 visual_prompt]: Training 9 / 100 epoch, with learning rate 0.4
[09/26 03:28:34 visual_prompt]: Epoch 9 / 100: avg data time: 5.01e-02, avg batch time: 0.4952, average train loss: 1.0041
[09/26 03:28:35 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1671, average loss: 0.7789
[09/26 03:28:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 53.99	
[09/26 03:28:35 visual_prompt]: Training 10 / 100 epoch, with learning rate 0.45
[09/26 03:28:42 visual_prompt]: Epoch 10 / 100: avg data time: 5.44e-02, avg batch time: 0.4968, average train loss: 0.8734
[09/26 03:28:44 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1672, average loss: 0.7521
[09/26 03:28:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 52.79	
[09/26 03:28:44 visual_prompt]: Training 11 / 100 epoch, with learning rate 0.5
[09/26 03:28:50 visual_prompt]: Epoch 11 / 100: avg data time: 4.28e-02, avg batch time: 0.4865, average train loss: 0.7500
[09/26 03:28:52 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1672, average loss: 0.7775
[09/26 03:28:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 68.10	
[09/26 03:28:52 visual_prompt]: Training 12 / 100 epoch, with learning rate 0.49984770675477397
[09/26 03:28:59 visual_prompt]: Epoch 12 / 100: avg data time: 6.04e-02, avg batch time: 0.5032, average train loss: 0.6922
[09/26 03:29:00 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1673, average loss: 0.6283
[09/26 03:29:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 68.00	rocauc: 77.51	
[09/26 03:29:00 visual_prompt]: Training 13 / 100 epoch, with learning rate 0.49939101256495605
[09/26 03:29:07 visual_prompt]: Epoch 13 / 100: avg data time: 5.44e-02, avg batch time: 0.4975, average train loss: 0.7606
[09/26 03:29:08 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1676, average loss: 0.6910
[09/26 03:29:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 77.58	
[09/26 03:29:08 visual_prompt]: Training 14 / 100 epoch, with learning rate 0.4986304738420683
[09/26 03:29:15 visual_prompt]: Epoch 14 / 100: avg data time: 5.42e-02, avg batch time: 0.4984, average train loss: 0.7293
[09/26 03:29:16 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1674, average loss: 0.6931
[09/26 03:29:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.95	
[09/26 03:29:16 visual_prompt]: Training 15 / 100 epoch, with learning rate 0.4975670171853926
[09/26 03:29:23 visual_prompt]: Epoch 15 / 100: avg data time: 4.67e-02, avg batch time: 0.4905, average train loss: 0.8091
[09/26 03:29:24 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1675, average loss: 0.9056
[09/26 03:29:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.95	
[09/26 03:29:24 visual_prompt]: Training 16 / 100 epoch, with learning rate 0.49620193825305203
[09/26 03:29:31 visual_prompt]: Epoch 16 / 100: avg data time: 5.86e-02, avg batch time: 0.5039, average train loss: 0.7956
[09/26 03:29:33 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1673, average loss: 0.7012
[09/26 03:29:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 49.50	rocauc: 75.43	
[09/26 03:29:33 visual_prompt]: Training 17 / 100 epoch, with learning rate 0.4945369001834514
[09/26 03:29:40 visual_prompt]: Epoch 17 / 100: avg data time: 5.89e-02, avg batch time: 0.5022, average train loss: 0.7228
[09/26 03:29:41 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1674, average loss: 0.8507
[09/26 03:29:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 74.80	
[09/26 03:29:41 visual_prompt]: Training 18 / 100 epoch, with learning rate 0.4925739315689991
[09/26 03:29:48 visual_prompt]: Epoch 18 / 100: avg data time: 4.27e-02, avg batch time: 0.4873, average train loss: 0.7433
[09/26 03:29:49 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1674, average loss: 1.6206
[09/26 03:29:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.50	rocauc: 21.53	
[09/26 03:29:49 visual_prompt]: Training 19 / 100 epoch, with learning rate 0.4903154239845797
[09/26 03:29:56 visual_prompt]: Epoch 19 / 100: avg data time: 5.32e-02, avg batch time: 0.4994, average train loss: 1.1201
[09/26 03:29:57 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1672, average loss: 0.7274
[09/26 03:29:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 33.69	
[09/26 03:29:57 visual_prompt]: Training 20 / 100 epoch, with learning rate 0.4877641290737884
[09/26 03:30:04 visual_prompt]: Epoch 20 / 100: avg data time: 5.64e-02, avg batch time: 0.4998, average train loss: 1.3257
[09/26 03:30:06 visual_prompt]: Inference (val):avg data time: 3.46e-05, avg batch time: 0.1674, average loss: 0.7261
[09/26 03:30:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 61.24	
[09/26 03:30:06 visual_prompt]: Training 21 / 100 epoch, with learning rate 0.4849231551964771
[09/26 03:30:12 visual_prompt]: Epoch 21 / 100: avg data time: 5.04e-02, avg batch time: 0.4952, average train loss: 1.3090
[09/26 03:30:14 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1672, average loss: 0.6944
[09/26 03:30:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 81.72	
[09/26 03:30:14 visual_prompt]: Training 22 / 100 epoch, with learning rate 0.48179596364169686
[09/26 03:30:20 visual_prompt]: Epoch 22 / 100: avg data time: 5.00e-02, avg batch time: 0.4951, average train loss: 0.7332
[09/26 03:30:22 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1673, average loss: 0.8550
[09/26 03:30:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 74.78	
[09/26 03:30:22 visual_prompt]: Training 23 / 100 epoch, with learning rate 0.4783863644106502
[09/26 03:30:28 visual_prompt]: Epoch 23 / 100: avg data time: 4.25e-02, avg batch time: 0.4870, average train loss: 0.7561
[09/26 03:30:30 visual_prompt]: Inference (val):avg data time: 3.39e-05, avg batch time: 0.1676, average loss: 0.7845
[09/26 03:30:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.24	
[09/26 03:30:30 visual_prompt]: Training 24 / 100 epoch, with learning rate 0.47469851157479176
[09/26 03:30:37 visual_prompt]: Epoch 24 / 100: avg data time: 4.95e-02, avg batch time: 0.4934, average train loss: 0.7413
[09/26 03:30:38 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1670, average loss: 0.7577
[09/26 03:30:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 86.87	
[09/26 03:30:38 visual_prompt]: Training 25 / 100 epoch, with learning rate 0.47073689821473175
[09/26 03:30:45 visual_prompt]: Epoch 25 / 100: avg data time: 4.45e-02, avg batch time: 0.4890, average train loss: 0.7279
[09/26 03:30:46 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1676, average loss: 0.6918
[09/26 03:30:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.50	rocauc: 57.37	
[09/26 03:30:46 visual_prompt]: Training 26 / 100 epoch, with learning rate 0.4665063509461097
[09/26 03:30:53 visual_prompt]: Epoch 26 / 100: avg data time: 4.98e-02, avg batch time: 0.4945, average train loss: 0.7629
[09/26 03:30:54 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1670, average loss: 0.7134
[09/26 03:30:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 68.94	
[09/26 03:30:54 visual_prompt]: Training 27 / 100 epoch, with learning rate 0.46201202403910646
[09/26 03:31:01 visual_prompt]: Epoch 27 / 100: avg data time: 4.69e-02, avg batch time: 0.4915, average train loss: 0.7357
[09/26 03:31:02 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1673, average loss: 0.7319
[09/26 03:31:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 77.84	
[09/26 03:31:02 visual_prompt]: Training 28 / 100 epoch, with learning rate 0.4572593931387604
[09/26 03:31:09 visual_prompt]: Epoch 28 / 100: avg data time: 5.27e-02, avg batch time: 0.4962, average train loss: 0.7137
[09/26 03:31:10 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1672, average loss: 0.6879
[09/26 03:31:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.66	
[09/26 03:31:10 visual_prompt]: Training 29 / 100 epoch, with learning rate 0.45225424859373686
[09/26 03:31:17 visual_prompt]: Epoch 29 / 100: avg data time: 5.23e-02, avg batch time: 0.4968, average train loss: 0.7208
[09/26 03:31:19 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1675, average loss: 0.7395
[09/26 03:31:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.16	
[09/26 03:31:19 visual_prompt]: Training 30 / 100 epoch, with learning rate 0.44700268840168045
[09/26 03:31:25 visual_prompt]: Epoch 30 / 100: avg data time: 4.77e-02, avg batch time: 0.4916, average train loss: 0.7069
[09/26 03:31:27 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1674, average loss: 0.6896
[09/26 03:31:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.50	rocauc: 83.38	
[09/26 03:31:27 visual_prompt]: Training 31 / 100 epoch, with learning rate 0.4415111107797445
[09/26 03:31:33 visual_prompt]: Epoch 31 / 100: avg data time: 5.71e-02, avg batch time: 0.5006, average train loss: 0.7319
[09/26 03:31:35 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1675, average loss: 0.7387
[09/26 03:31:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 80.47	
[09/26 03:31:35 visual_prompt]: Training 32 / 100 epoch, with learning rate 0.43578620636934856
[09/26 03:31:42 visual_prompt]: Epoch 32 / 100: avg data time: 5.02e-02, avg batch time: 0.4942, average train loss: 0.7482
[09/26 03:31:43 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1674, average loss: 0.6954
[09/26 03:31:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 79.04	
[09/26 03:31:43 visual_prompt]: Training 33 / 100 epoch, with learning rate 0.42983495008466277
[09/26 03:31:50 visual_prompt]: Epoch 33 / 100: avg data time: 5.90e-02, avg batch time: 0.5024, average train loss: 0.7120
[09/26 03:31:51 visual_prompt]: Inference (val):avg data time: 3.15e-05, avg batch time: 0.1673, average loss: 0.7249
[09/26 03:31:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.51	
[09/26 03:31:51 visual_prompt]: Training 34 / 100 epoch, with learning rate 0.4236645926147493
[09/26 03:31:58 visual_prompt]: Epoch 34 / 100: avg data time: 4.58e-02, avg batch time: 0.4920, average train loss: 0.7084
[09/26 03:31:59 visual_prompt]: Inference (val):avg data time: 3.14e-05, avg batch time: 0.1670, average loss: 0.6904
[09/26 03:31:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 61.50	rocauc: 83.10	
[09/26 03:31:59 visual_prompt]: Training 35 / 100 epoch, with learning rate 0.41728265158971456
[09/26 03:32:06 visual_prompt]: Epoch 35 / 100: avg data time: 5.63e-02, avg batch time: 0.5005, average train loss: 0.7272
[09/26 03:32:08 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1676, average loss: 0.6924
[09/26 03:32:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.08	
[09/26 03:32:08 visual_prompt]: Training 36 / 100 epoch, with learning rate 0.4106969024216348
[09/26 03:32:14 visual_prompt]: Epoch 36 / 100: avg data time: 5.44e-02, avg batch time: 0.4991, average train loss: 0.6975
[09/26 03:32:16 visual_prompt]: Inference (val):avg data time: 3.15e-05, avg batch time: 0.1675, average loss: 0.7133
[09/26 03:32:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 65.56	
[09/26 03:32:16 visual_prompt]: Training 37 / 100 epoch, with learning rate 0.40391536883141455
[09/26 03:32:23 visual_prompt]: Epoch 37 / 100: avg data time: 5.18e-02, avg batch time: 0.4960, average train loss: 0.7271
[09/26 03:32:24 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1676, average loss: 0.7757
[09/26 03:32:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.44	
[09/26 03:32:24 visual_prompt]: Training 38 / 100 epoch, with learning rate 0.3969463130731183
[09/26 03:32:31 visual_prompt]: Epoch 38 / 100: avg data time: 5.33e-02, avg batch time: 0.4986, average train loss: 0.7309
[09/26 03:32:32 visual_prompt]: Inference (val):avg data time: 3.29e-05, avg batch time: 0.1676, average loss: 0.7060
[09/26 03:32:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 77.64	
[09/26 03:32:32 visual_prompt]: Training 39 / 100 epoch, with learning rate 0.3897982258676867
[09/26 03:32:39 visual_prompt]: Epoch 39 / 100: avg data time: 4.14e-02, avg batch time: 0.4874, average train loss: 0.7595
[09/26 03:32:40 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1675, average loss: 0.7072
[09/26 03:32:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 66.27	
[09/26 03:32:40 visual_prompt]: Training 40 / 100 epoch, with learning rate 0.3824798160583012
[09/26 03:32:47 visual_prompt]: Epoch 40 / 100: avg data time: 5.31e-02, avg batch time: 0.4956, average train loss: 1.0776
[09/26 03:32:48 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1674, average loss: 1.9238
[09/26 03:32:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 76.60	
[09/26 03:32:48 visual_prompt]: Training 41 / 100 epoch, with learning rate 0.375
[09/26 03:32:55 visual_prompt]: Epoch 41 / 100: avg data time: 4.32e-02, avg batch time: 0.4872, average train loss: 0.9225
[09/26 03:32:56 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1676, average loss: 0.9953
[09/26 03:32:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 89.09	
[09/26 03:32:56 visual_prompt]: Training 42 / 100 epoch, with learning rate 0.3673678906964727
[09/26 03:33:03 visual_prompt]: Epoch 42 / 100: avg data time: 5.72e-02, avg batch time: 0.5017, average train loss: 0.7866
[09/26 03:33:05 visual_prompt]: Inference (val):avg data time: 3.39e-05, avg batch time: 0.1675, average loss: 0.7149
[09/26 03:33:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 87.09	
[09/26 03:33:05 visual_prompt]: Training 43 / 100 epoch, with learning rate 0.35959278669726935
[09/26 03:33:11 visual_prompt]: Epoch 43 / 100: avg data time: 4.70e-02, avg batch time: 0.4937, average train loss: 0.7577
[09/26 03:33:13 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1675, average loss: 0.8151
[09/26 03:33:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.86	
[09/26 03:33:13 visual_prompt]: Training 44 / 100 epoch, with learning rate 0.3516841607689501
[09/26 03:33:20 visual_prompt]: Epoch 44 / 100: avg data time: 5.59e-02, avg batch time: 0.5010, average train loss: 0.7500
[09/26 03:33:21 visual_prompt]: Inference (val):avg data time: 3.50e-05, avg batch time: 0.1672, average loss: 0.6831
[09/26 03:33:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 50.50	rocauc: 83.59	
[09/26 03:33:21 visual_prompt]: Training 45 / 100 epoch, with learning rate 0.34365164835397805
[09/26 03:33:28 visual_prompt]: Epoch 45 / 100: avg data time: 5.32e-02, avg batch time: 0.4977, average train loss: 0.7077
[09/26 03:33:29 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1676, average loss: 0.6777
[09/26 03:33:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 59.50	rocauc: 85.89	
[09/26 03:33:29 visual_prompt]: Training 46 / 100 epoch, with learning rate 0.3355050358314172
[09/26 03:33:36 visual_prompt]: Epoch 46 / 100: avg data time: 5.08e-02, avg batch time: 0.4944, average train loss: 0.7040
[09/26 03:33:38 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1672, average loss: 0.6670
[09/26 03:33:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 55.00	rocauc: 83.20	
[09/26 03:33:38 visual_prompt]: Training 47 / 100 epoch, with learning rate 0.32725424859373686
[09/26 03:33:44 visual_prompt]: Epoch 47 / 100: avg data time: 5.61e-02, avg batch time: 0.5006, average train loss: 0.7015
[09/26 03:33:46 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1672, average loss: 0.6773
[09/26 03:33:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 49.00	rocauc: 84.65	
[09/26 03:33:46 visual_prompt]: Training 48 / 100 epoch, with learning rate 0.3189093389542498
[09/26 03:33:52 visual_prompt]: Epoch 48 / 100: avg data time: 5.17e-02, avg batch time: 0.4951, average train loss: 0.6756
[09/26 03:33:54 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1670, average loss: 0.9053
[09/26 03:33:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 88.24	
[09/26 03:33:54 visual_prompt]: Training 49 / 100 epoch, with learning rate 0.3104804738999169
[09/26 03:34:01 visual_prompt]: Epoch 49 / 100: avg data time: 5.18e-02, avg batch time: 0.4957, average train loss: 0.7824
[09/26 03:34:02 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1675, average loss: 0.7208
[09/26 03:34:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 53.00	rocauc: 76.40	
[09/26 03:34:02 visual_prompt]: Training 50 / 100 epoch, with learning rate 0.3019779227044398
[09/26 03:34:09 visual_prompt]: Epoch 50 / 100: avg data time: 5.75e-02, avg batch time: 0.5019, average train loss: 0.7796
[09/26 03:34:10 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1673, average loss: 0.8245
[09/26 03:34:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.66	
[09/26 03:34:10 visual_prompt]: Training 51 / 100 epoch, with learning rate 0.29341204441673263
[09/26 03:34:17 visual_prompt]: Epoch 51 / 100: avg data time: 4.84e-02, avg batch time: 0.4919, average train loss: 0.7194
[09/26 03:34:18 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1674, average loss: 0.6866
[09/26 03:34:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 49.50	rocauc: 86.76	
[09/26 03:34:18 visual_prompt]: Training 52 / 100 epoch, with learning rate 0.28479327524001635
[09/26 03:34:25 visual_prompt]: Epoch 52 / 100: avg data time: 4.67e-02, avg batch time: 0.4926, average train loss: 0.6799
[09/26 03:34:26 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.1673, average loss: 1.4346
[09/26 03:34:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 24.87	
[09/26 03:34:26 visual_prompt]: Training 53 / 100 epoch, with learning rate 0.2761321158169134
[09/26 03:34:33 visual_prompt]: Epoch 53 / 100: avg data time: 5.30e-02, avg batch time: 0.4972, average train loss: 0.8689
[09/26 03:34:35 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1674, average loss: 0.6058
[09/26 03:34:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 67.00	rocauc: 79.54	
[09/26 03:34:35 visual_prompt]: Training 54 / 100 epoch, with learning rate 0.2674391184360313
[09/26 03:34:41 visual_prompt]: Epoch 54 / 100: avg data time: 5.01e-02, avg batch time: 0.4938, average train loss: 0.9048
[09/26 03:34:43 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1672, average loss: 0.7157
[09/26 03:34:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 78.94	
[09/26 03:34:43 visual_prompt]: Training 55 / 100 epoch, with learning rate 0.2587248741756253
[09/26 03:34:49 visual_prompt]: Epoch 55 / 100: avg data time: 4.16e-02, avg batch time: 0.4870, average train loss: 0.7180
[09/26 03:34:51 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1675, average loss: 0.6990
[09/26 03:34:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 88.76	
[09/26 03:34:51 visual_prompt]: Training 56 / 100 epoch, with learning rate 0.25
[09/26 03:34:58 visual_prompt]: Epoch 56 / 100: avg data time: 5.83e-02, avg batch time: 0.5027, average train loss: 0.7151
[09/26 03:34:59 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1671, average loss: 0.8707
[09/26 03:34:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.61	
[09/26 03:34:59 visual_prompt]: Training 57 / 100 epoch, with learning rate 0.24127512582437483
[09/26 03:35:06 visual_prompt]: Epoch 57 / 100: avg data time: 6.10e-02, avg batch time: 0.5044, average train loss: 0.7214
[09/26 03:35:07 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1670, average loss: 0.6913
[09/26 03:35:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 89.44	
[09/26 03:35:07 visual_prompt]: Training 58 / 100 epoch, with learning rate 0.23256088156396867
[09/26 03:35:14 visual_prompt]: Epoch 58 / 100: avg data time: 6.07e-02, avg batch time: 0.5044, average train loss: 0.6893
[09/26 03:35:16 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1676, average loss: 0.6712
[09/26 03:35:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.50	rocauc: 88.35	
[09/26 03:35:16 visual_prompt]: Training 59 / 100 epoch, with learning rate 0.22386788418308667
[09/26 03:35:22 visual_prompt]: Epoch 59 / 100: avg data time: 5.64e-02, avg batch time: 0.5010, average train loss: 0.6857
[09/26 03:35:24 visual_prompt]: Inference (val):avg data time: 3.03e-05, avg batch time: 0.1674, average loss: 0.6946
[09/26 03:35:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.62	
[09/26 03:35:24 visual_prompt]: Training 60 / 100 epoch, with learning rate 0.2152067247599837
[09/26 03:35:31 visual_prompt]: Epoch 60 / 100: avg data time: 5.23e-02, avg batch time: 0.4957, average train loss: 0.7068
[09/26 03:35:32 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1674, average loss: 0.6958
[09/26 03:35:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 86.45	
[09/26 03:35:32 visual_prompt]: Training 61 / 100 epoch, with learning rate 0.20658795558326742
[09/26 03:35:39 visual_prompt]: Epoch 61 / 100: avg data time: 5.61e-02, avg batch time: 0.4997, average train loss: 0.6994
[09/26 03:35:40 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1671, average loss: 0.6937
[09/26 03:35:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.39	
[09/26 03:35:40 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.1980220772955602
[09/26 03:35:47 visual_prompt]: Epoch 62 / 100: avg data time: 5.54e-02, avg batch time: 0.4996, average train loss: 0.6909
[09/26 03:35:48 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1675, average loss: 0.6745
[09/26 03:35:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 88.23	
[09/26 03:35:48 visual_prompt]: Best epoch 62: best metric: 0.825
[09/26 03:35:48 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.1895195261000831
[09/26 03:35:55 visual_prompt]: Epoch 63 / 100: avg data time: 5.74e-02, avg batch time: 0.5005, average train loss: 0.7127
[09/26 03:35:57 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1672, average loss: 0.6803
[09/26 03:35:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 55.50	rocauc: 89.37	
[09/26 03:35:57 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.18109066104575022
[09/26 03:36:03 visual_prompt]: Epoch 64 / 100: avg data time: 5.52e-02, avg batch time: 0.4988, average train loss: 0.6874
[09/26 03:36:05 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.1672, average loss: 0.6144
[09/26 03:36:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 88.97	
[09/26 03:36:05 visual_prompt]: Best epoch 64: best metric: 0.830
[09/26 03:36:05 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.17274575140626316
[09/26 03:36:12 visual_prompt]: Epoch 65 / 100: avg data time: 5.19e-02, avg batch time: 0.4960, average train loss: 0.6819
[09/26 03:36:13 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1672, average loss: 0.6751
[09/26 03:36:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 59.00	rocauc: 87.41	
[09/26 03:36:13 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.16449496416858284
[09/26 03:36:20 visual_prompt]: Epoch 66 / 100: avg data time: 4.64e-02, avg batch time: 0.4911, average train loss: 0.6638
[09/26 03:36:21 visual_prompt]: Inference (val):avg data time: 3.09e-05, avg batch time: 0.1672, average loss: 0.7768
[09/26 03:36:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 51.50	rocauc: 89.18	
[09/26 03:36:21 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.15634835164602198
[09/26 03:36:28 visual_prompt]: Epoch 67 / 100: avg data time: 5.68e-02, avg batch time: 0.5003, average train loss: 0.6760
[09/26 03:36:29 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1674, average loss: 0.6254
[09/26 03:36:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 88.94	
[09/26 03:36:29 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.14831583923105
[09/26 03:36:36 visual_prompt]: Epoch 68 / 100: avg data time: 5.84e-02, avg batch time: 0.5030, average train loss: 0.6673
[09/26 03:36:38 visual_prompt]: Inference (val):avg data time: 3.68e-05, avg batch time: 0.1671, average loss: 0.6288
[09/26 03:36:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 88.05	
[09/26 03:36:38 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.14040721330273062
[09/26 03:36:45 visual_prompt]: Epoch 69 / 100: avg data time: 5.66e-02, avg batch time: 0.5019, average train loss: 0.6690
[09/26 03:36:46 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1673, average loss: 0.6482
[09/26 03:36:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 88.00	
[09/26 03:36:46 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.13263210930352737
[09/26 03:36:53 visual_prompt]: Epoch 70 / 100: avg data time: 5.29e-02, avg batch time: 0.4980, average train loss: 0.6417
[09/26 03:36:54 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1675, average loss: 0.8089
[09/26 03:36:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 51.50	rocauc: 88.93	
[09/26 03:36:54 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.12500000000000006
[09/26 03:37:01 visual_prompt]: Epoch 71 / 100: avg data time: 5.70e-02, avg batch time: 0.5011, average train loss: 0.6758
[09/26 03:37:03 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1672, average loss: 0.6714
[09/26 03:37:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 89.43	
[09/26 03:37:03 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.1175201839416988
[09/26 03:37:09 visual_prompt]: Epoch 72 / 100: avg data time: 6.20e-02, avg batch time: 0.5061, average train loss: 0.6518
[09/26 03:37:11 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1673, average loss: 0.6044
[09/26 03:37:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.50	rocauc: 88.35	
[09/26 03:37:11 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.11020177413231333
[09/26 03:37:17 visual_prompt]: Epoch 73 / 100: avg data time: 4.18e-02, avg batch time: 0.4873, average train loss: 0.6448
[09/26 03:37:19 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1672, average loss: 0.5866
[09/26 03:37:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.50	rocauc: 83.87	
[09/26 03:37:19 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.10305368692688174
[09/26 03:37:26 visual_prompt]: Epoch 74 / 100: avg data time: 5.74e-02, avg batch time: 0.5023, average train loss: 0.6387
[09/26 03:37:27 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1675, average loss: 0.6932
[09/26 03:37:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.00	rocauc: 86.29	
[09/26 03:37:27 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.09608463116858543
[09/26 03:37:34 visual_prompt]: Epoch 75 / 100: avg data time: 4.91e-02, avg batch time: 0.4941, average train loss: 0.6214
[09/26 03:37:35 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1674, average loss: 0.5832
[09/26 03:37:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 62.00	rocauc: 88.84	
[09/26 03:37:35 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.08930309757836516
[09/26 03:37:42 visual_prompt]: Epoch 76 / 100: avg data time: 5.77e-02, avg batch time: 0.5034, average train loss: 0.5900
[09/26 03:37:44 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1676, average loss: 0.4813
[09/26 03:37:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 88.95	
[09/26 03:37:44 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.08271734841028552
[09/26 03:37:50 visual_prompt]: Epoch 77 / 100: avg data time: 5.36e-02, avg batch time: 0.4968, average train loss: 0.5382
[09/26 03:37:52 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1675, average loss: 0.4263
[09/26 03:37:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 89.86	
[09/26 03:37:52 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.07633540738525066
[09/26 03:37:59 visual_prompt]: Epoch 78 / 100: avg data time: 5.68e-02, avg batch time: 0.5011, average train loss: 0.6322
[09/26 03:38:00 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1673, average loss: 0.4522
[09/26 03:38:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 89.95	
[09/26 03:38:00 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.07016504991533726
[09/26 03:38:07 visual_prompt]: Epoch 79 / 100: avg data time: 4.28e-02, avg batch time: 0.4869, average train loss: 0.5472
[09/26 03:38:08 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1670, average loss: 0.5429
[09/26 03:38:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 69.50	rocauc: 90.55	
[09/26 03:38:08 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.06421379363065141
[09/26 03:38:15 visual_prompt]: Epoch 80 / 100: avg data time: 5.10e-02, avg batch time: 0.4946, average train loss: 0.5588
[09/26 03:38:16 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1675, average loss: 0.7568
[09/26 03:38:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 55.50	rocauc: 90.24	
[09/26 03:38:16 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.058488889220255524
[09/26 03:38:23 visual_prompt]: Epoch 81 / 100: avg data time: 4.25e-02, avg batch time: 0.4873, average train loss: 0.6714
[09/26 03:38:24 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1675, average loss: 0.5433
[09/26 03:38:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.00	rocauc: 90.30	
[09/26 03:38:24 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.052997311598319524
[09/26 03:38:31 visual_prompt]: Epoch 82 / 100: avg data time: 4.38e-02, avg batch time: 0.4883, average train loss: 0.5818
[09/26 03:38:33 visual_prompt]: Inference (val):avg data time: 3.47e-05, avg batch time: 0.1676, average loss: 0.5380
[09/26 03:38:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 88.74	
[09/26 03:38:33 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.047745751406263165
[09/26 03:38:39 visual_prompt]: Epoch 83 / 100: avg data time: 4.08e-02, avg batch time: 0.4869, average train loss: 0.5642
[09/26 03:38:41 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1674, average loss: 0.5154
[09/26 03:38:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.50	rocauc: 90.82	
[09/26 03:38:41 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.042740606861239594
[09/26 03:38:47 visual_prompt]: Epoch 84 / 100: avg data time: 6.00e-02, avg batch time: 0.5037, average train loss: 0.5534
[09/26 03:38:49 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1674, average loss: 0.4178
[09/26 03:38:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 90.06	
[09/26 03:38:49 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.03798797596089351
[09/26 03:38:56 visual_prompt]: Epoch 85 / 100: avg data time: 5.80e-02, avg batch time: 0.5031, average train loss: 0.4823
[09/26 03:38:57 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1675, average loss: 0.4279
[09/26 03:38:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.29	
[09/26 03:38:57 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.03349364905389032
[09/26 03:39:04 visual_prompt]: Epoch 86 / 100: avg data time: 6.04e-02, avg batch time: 0.5049, average train loss: 0.4906
[09/26 03:39:06 visual_prompt]: Inference (val):avg data time: 2.76e-05, avg batch time: 0.1673, average loss: 0.4043
[09/26 03:39:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.59	
[09/26 03:39:06 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.029263101785268253
[09/26 03:39:12 visual_prompt]: Epoch 87 / 100: avg data time: 5.61e-02, avg batch time: 0.4997, average train loss: 0.4892
[09/26 03:39:14 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1672, average loss: 0.4856
[09/26 03:39:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 92.63	
[09/26 03:39:14 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.025301488425208296
[09/26 03:39:21 visual_prompt]: Epoch 88 / 100: avg data time: 4.87e-02, avg batch time: 0.4930, average train loss: 0.5272
[09/26 03:39:22 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1675, average loss: 0.4549
[09/26 03:39:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 91.60	
[09/26 03:39:22 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.021613635589349756
[09/26 03:39:29 visual_prompt]: Epoch 89 / 100: avg data time: 5.99e-02, avg batch time: 0.5042, average train loss: 0.4819
[09/26 03:39:30 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1676, average loss: 0.3829
[09/26 03:39:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.31	
[09/26 03:39:30 visual_prompt]: Best epoch 89: best metric: 0.840
[09/26 03:39:30 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.01820403635830317
[09/26 03:39:37 visual_prompt]: Epoch 90 / 100: avg data time: 4.16e-02, avg batch time: 0.4866, average train loss: 0.4589
[09/26 03:39:38 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1676, average loss: 0.3778
[09/26 03:39:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.06	
[09/26 03:39:38 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.01507684480352292
[09/26 03:39:45 visual_prompt]: Epoch 91 / 100: avg data time: 5.37e-02, avg batch time: 0.4981, average train loss: 0.4297
[09/26 03:39:46 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1674, average loss: 0.3664
[09/26 03:39:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.03	
[09/26 03:39:46 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.012235870926211617
[09/26 03:39:53 visual_prompt]: Epoch 92 / 100: avg data time: 4.36e-02, avg batch time: 0.4882, average train loss: 0.4377
[09/26 03:39:54 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1675, average loss: 0.3655
[09/26 03:39:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.59	
[09/26 03:39:54 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.009684576015420276
[09/26 03:40:01 visual_prompt]: Epoch 93 / 100: avg data time: 5.50e-02, avg batch time: 0.4999, average train loss: 0.4461
[09/26 03:40:03 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1677, average loss: 0.3654
[09/26 03:40:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 93.26	
[09/26 03:40:03 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.007426068431000882
[09/26 03:40:09 visual_prompt]: Epoch 94 / 100: avg data time: 5.94e-02, avg batch time: 0.5037, average train loss: 0.4153
[09/26 03:40:11 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1676, average loss: 0.3315
[09/26 03:40:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.41	
[09/26 03:40:11 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.005463099816548578
[09/26 03:40:18 visual_prompt]: Epoch 95 / 100: avg data time: 5.31e-02, avg batch time: 0.4971, average train loss: 0.4016
[09/26 03:40:19 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1673, average loss: 0.3603
[09/26 03:40:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.54	
[09/26 03:40:19 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.003798061746947995
[09/26 03:40:26 visual_prompt]: Epoch 96 / 100: avg data time: 4.58e-02, avg batch time: 0.4923, average train loss: 0.4018
[09/26 03:40:27 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1673, average loss: 0.3296
[09/26 03:40:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.51	
[09/26 03:40:27 visual_prompt]: Best epoch 96: best metric: 0.865
[09/26 03:40:27 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.0024329828146074095
[09/26 03:40:34 visual_prompt]: Epoch 97 / 100: avg data time: 5.64e-02, avg batch time: 0.5001, average train loss: 0.3913
[09/26 03:40:36 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1677, average loss: 0.3362
[09/26 03:40:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.42	
[09/26 03:40:36 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.0013695261579316775
[09/26 03:40:42 visual_prompt]: Epoch 98 / 100: avg data time: 4.31e-02, avg batch time: 0.4901, average train loss: 0.3937
[09/26 03:40:44 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1678, average loss: 0.3489
[09/26 03:40:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.61	
[09/26 03:40:44 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.0006089874350439506
[09/26 03:40:50 visual_prompt]: Epoch 99 / 100: avg data time: 6.01e-02, avg batch time: 0.5042, average train loss: 0.3727
[09/26 03:40:52 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1676, average loss: 0.3322
[09/26 03:40:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.42	
[09/26 03:40:52 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.00015229324522605947
[09/26 03:40:59 visual_prompt]: Epoch 100 / 100: avg data time: 5.30e-02, avg batch time: 0.4970, average train loss: 0.3746
[09/26 03:41:00 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1673, average loss: 0.3331
[09/26 03:41:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.44	
[09/26 03:41:00 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 03:41:00 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 03:41:00 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 03:41:00 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 03:41:00 visual_prompt]: Training with config:
[09/26 03:41:00 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr0.5_wd0.001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 0.5, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 03:41:00 visual_prompt]: Loading training data...
[09/26 03:41:00 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 03:41:01 visual_prompt]: Number of images: 800
[09/26 03:41:01 visual_prompt]: Number of classes: 2 / 2
[09/26 03:41:01 visual_prompt]: Loading validation data...
[09/26 03:41:01 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 03:41:01 visual_prompt]: Number of images: 200
[09/26 03:41:01 visual_prompt]: Number of classes: 2 / 2
[09/26 03:41:01 visual_prompt]: Constructing models...
[09/26 03:41:04 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 03:41:04 visual_prompt]: tuned percent:0.536
[09/26 03:41:04 visual_prompt]: Device used for model: 0
[09/26 03:41:04 visual_prompt]: Setting up Evaluator...
[09/26 03:41:04 visual_prompt]: Setting up Trainer...
[09/26 03:41:04 visual_prompt]: 	Setting up the optimizer...
[09/26 03:41:04 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 03:41:11 visual_prompt]: Epoch 1 / 100: avg data time: 5.41e-02, avg batch time: 0.4997, average train loss: 1.9597
[09/26 03:41:12 visual_prompt]: Inference (val):avg data time: 3.08e-05, avg batch time: 0.1669, average loss: 2.0033
[09/26 03:41:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 03:41:12 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 03:41:12 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.05
[09/26 03:41:19 visual_prompt]: Epoch 2 / 100: avg data time: 5.80e-02, avg batch time: 0.5003, average train loss: 3.1944
[09/26 03:41:20 visual_prompt]: Inference (val):avg data time: 2.73e-05, avg batch time: 0.1670, average loss: 0.7682
[09/26 03:41:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 61.71	
[09/26 03:41:20 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.1
[09/26 03:41:27 visual_prompt]: Epoch 3 / 100: avg data time: 5.32e-02, avg batch time: 0.4955, average train loss: 0.8681
[09/26 03:41:29 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1673, average loss: 0.7075
[09/26 03:41:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.87	
[09/26 03:41:29 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.15
[09/26 03:41:35 visual_prompt]: Epoch 4 / 100: avg data time: 4.80e-02, avg batch time: 0.4919, average train loss: 0.7254
[09/26 03:41:37 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1672, average loss: 0.6914
[09/26 03:41:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 88.89	
[09/26 03:41:37 visual_prompt]: Training 5 / 100 epoch, with learning rate 0.2
[09/26 03:41:43 visual_prompt]: Epoch 5 / 100: avg data time: 4.37e-02, avg batch time: 0.4889, average train loss: 0.6741
[09/26 03:41:45 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1672, average loss: 0.4837
[09/26 03:41:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 89.67	
[09/26 03:41:45 visual_prompt]: Best epoch 5: best metric: 0.845
[09/26 03:41:45 visual_prompt]: Training 6 / 100 epoch, with learning rate 0.25
[09/26 03:41:51 visual_prompt]: Epoch 6 / 100: avg data time: 4.35e-02, avg batch time: 0.4907, average train loss: 0.5451
[09/26 03:41:53 visual_prompt]: Inference (val):avg data time: 2.76e-05, avg batch time: 0.1671, average loss: 0.4829
[09/26 03:41:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 89.46	
[09/26 03:41:53 visual_prompt]: Training 7 / 100 epoch, with learning rate 0.3
[09/26 03:41:59 visual_prompt]: Epoch 7 / 100: avg data time: 4.44e-02, avg batch time: 0.4880, average train loss: 0.5061
[09/26 03:42:01 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1673, average loss: 0.3989
[09/26 03:42:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 90.57	
[09/26 03:42:01 visual_prompt]: Training 8 / 100 epoch, with learning rate 0.35
[09/26 03:42:07 visual_prompt]: Epoch 8 / 100: avg data time: 4.12e-02, avg batch time: 0.4858, average train loss: 0.5074
[09/26 03:42:09 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1674, average loss: 0.4936
[09/26 03:42:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.50	rocauc: 91.97	
[09/26 03:42:09 visual_prompt]: Training 9 / 100 epoch, with learning rate 0.4
[09/26 03:42:15 visual_prompt]: Epoch 9 / 100: avg data time: 4.22e-02, avg batch time: 0.4870, average train loss: 0.5412
[09/26 03:42:17 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1676, average loss: 0.4187
[09/26 03:42:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.69	
[09/26 03:42:17 visual_prompt]: Training 10 / 100 epoch, with learning rate 0.45
[09/26 03:42:23 visual_prompt]: Epoch 10 / 100: avg data time: 5.21e-02, avg batch time: 0.4959, average train loss: 0.4628
[09/26 03:42:25 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1676, average loss: 0.3577
[09/26 03:42:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.70	
[09/26 03:42:25 visual_prompt]: Training 11 / 100 epoch, with learning rate 0.5
[09/26 03:42:31 visual_prompt]: Epoch 11 / 100: avg data time: 4.71e-02, avg batch time: 0.4922, average train loss: 0.4752
[09/26 03:42:33 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1676, average loss: 0.3528
[09/26 03:42:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.07	
[09/26 03:42:33 visual_prompt]: Best epoch 11: best metric: 0.850
[09/26 03:42:33 visual_prompt]: Training 12 / 100 epoch, with learning rate 0.49984770675477397
[09/26 03:42:40 visual_prompt]: Epoch 12 / 100: avg data time: 4.24e-02, avg batch time: 0.4880, average train loss: 0.6095
[09/26 03:42:41 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1676, average loss: 0.3402
[09/26 03:42:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 94.18	
[09/26 03:42:41 visual_prompt]: Training 13 / 100 epoch, with learning rate 0.49939101256495605
[09/26 03:42:48 visual_prompt]: Epoch 13 / 100: avg data time: 4.23e-02, avg batch time: 0.4863, average train loss: 0.4776
[09/26 03:42:49 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1675, average loss: 0.4077
[09/26 03:42:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 94.11	
[09/26 03:42:49 visual_prompt]: Training 14 / 100 epoch, with learning rate 0.4986304738420683
[09/26 03:42:56 visual_prompt]: Epoch 14 / 100: avg data time: 4.65e-02, avg batch time: 0.4923, average train loss: 0.3744
[09/26 03:42:57 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1679, average loss: 0.3434
[09/26 03:42:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.74	
[09/26 03:42:57 visual_prompt]: Best epoch 14: best metric: 0.860
[09/26 03:42:57 visual_prompt]: Training 15 / 100 epoch, with learning rate 0.4975670171853926
[09/26 03:43:04 visual_prompt]: Epoch 15 / 100: avg data time: 3.93e-02, avg batch time: 0.4839, average train loss: 0.4776
[09/26 03:43:05 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1679, average loss: 0.3929
[09/26 03:43:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.60	
[09/26 03:43:05 visual_prompt]: Training 16 / 100 epoch, with learning rate 0.49620193825305203
[09/26 03:43:12 visual_prompt]: Epoch 16 / 100: avg data time: 4.14e-02, avg batch time: 0.4864, average train loss: 0.3553
[09/26 03:43:13 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1676, average loss: 0.3419
[09/26 03:43:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.88	
[09/26 03:43:13 visual_prompt]: Best epoch 16: best metric: 0.865
[09/26 03:43:13 visual_prompt]: Training 17 / 100 epoch, with learning rate 0.4945369001834514
[09/26 03:43:20 visual_prompt]: Epoch 17 / 100: avg data time: 4.49e-02, avg batch time: 0.4892, average train loss: 0.4643
[09/26 03:43:21 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1677, average loss: 0.7542
[09/26 03:43:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 67.00	rocauc: 94.08	
[09/26 03:43:21 visual_prompt]: Training 18 / 100 epoch, with learning rate 0.4925739315689991
[09/26 03:43:28 visual_prompt]: Epoch 18 / 100: avg data time: 6.33e-02, avg batch time: 0.5081, average train loss: 0.5042
[09/26 03:43:30 visual_prompt]: Inference (val):avg data time: 2.79e-05, avg batch time: 0.1671, average loss: 0.3333
[09/26 03:43:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 94.37	
[09/26 03:43:30 visual_prompt]: Training 19 / 100 epoch, with learning rate 0.4903154239845797
[09/26 03:43:37 visual_prompt]: Epoch 19 / 100: avg data time: 5.82e-02, avg batch time: 0.5016, average train loss: 0.3207
[09/26 03:43:38 visual_prompt]: Inference (val):avg data time: 3.03e-05, avg batch time: 0.1676, average loss: 0.4927
[09/26 03:43:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.67	
[09/26 03:43:38 visual_prompt]: Training 20 / 100 epoch, with learning rate 0.4877641290737884
[09/26 03:43:45 visual_prompt]: Epoch 20 / 100: avg data time: 4.63e-02, avg batch time: 0.4926, average train loss: 0.3367
[09/26 03:43:46 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1677, average loss: 0.3817
[09/26 03:43:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.33	
[09/26 03:43:46 visual_prompt]: Training 21 / 100 epoch, with learning rate 0.4849231551964771
[09/26 03:43:53 visual_prompt]: Epoch 21 / 100: avg data time: 5.11e-02, avg batch time: 0.4955, average train loss: 0.3446
[09/26 03:43:54 visual_prompt]: Inference (val):avg data time: 3.12e-05, avg batch time: 0.1675, average loss: 0.6206
[09/26 03:43:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.00	rocauc: 93.64	
[09/26 03:43:54 visual_prompt]: Training 22 / 100 epoch, with learning rate 0.48179596364169686
[09/26 03:44:01 visual_prompt]: Epoch 22 / 100: avg data time: 4.79e-02, avg batch time: 0.4932, average train loss: 0.3800
[09/26 03:44:03 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1678, average loss: 0.4070
[09/26 03:44:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.07	
[09/26 03:44:03 visual_prompt]: Training 23 / 100 epoch, with learning rate 0.4783863644106502
[09/26 03:44:09 visual_prompt]: Epoch 23 / 100: avg data time: 5.68e-02, avg batch time: 0.5025, average train loss: 0.2931
[09/26 03:44:11 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1674, average loss: 0.3615
[09/26 03:44:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.91	
[09/26 03:44:11 visual_prompt]: Training 24 / 100 epoch, with learning rate 0.47469851157479176
[09/26 03:44:18 visual_prompt]: Epoch 24 / 100: avg data time: 5.94e-02, avg batch time: 0.5037, average train loss: 0.3705
[09/26 03:44:19 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.1670, average loss: 0.6577
[09/26 03:44:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 54.00	rocauc: 81.22	
[09/26 03:44:19 visual_prompt]: Training 25 / 100 epoch, with learning rate 0.47073689821473175
[09/26 03:44:26 visual_prompt]: Epoch 25 / 100: avg data time: 5.14e-02, avg batch time: 0.4951, average train loss: 0.6986
[09/26 03:44:27 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1675, average loss: 0.8357
[09/26 03:44:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.50	rocauc: 88.76	
[09/26 03:44:27 visual_prompt]: Training 26 / 100 epoch, with learning rate 0.4665063509461097
[09/26 03:44:34 visual_prompt]: Epoch 26 / 100: avg data time: 5.12e-02, avg batch time: 0.4958, average train loss: 0.6184
[09/26 03:44:35 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1675, average loss: 0.4081
[09/26 03:44:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.00	
[09/26 03:44:35 visual_prompt]: Training 27 / 100 epoch, with learning rate 0.46201202403910646
[09/26 03:44:42 visual_prompt]: Epoch 27 / 100: avg data time: 4.22e-02, avg batch time: 0.4880, average train loss: 0.4785
[09/26 03:44:43 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1674, average loss: 0.6748
[09/26 03:44:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.50	rocauc: 93.46	
[09/26 03:44:43 visual_prompt]: Training 28 / 100 epoch, with learning rate 0.4572593931387604
[09/26 03:44:50 visual_prompt]: Epoch 28 / 100: avg data time: 5.73e-02, avg batch time: 0.5021, average train loss: 0.4319
[09/26 03:44:52 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1674, average loss: 0.3955
[09/26 03:44:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 93.94	
[09/26 03:44:52 visual_prompt]: Training 29 / 100 epoch, with learning rate 0.45225424859373686
[09/26 03:44:58 visual_prompt]: Epoch 29 / 100: avg data time: 5.23e-02, avg batch time: 0.4975, average train loss: 0.3736
[09/26 03:45:00 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1676, average loss: 0.3883
[09/26 03:45:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.83	
[09/26 03:45:00 visual_prompt]: Training 30 / 100 epoch, with learning rate 0.44700268840168045
[09/26 03:45:07 visual_prompt]: Epoch 30 / 100: avg data time: 4.28e-02, avg batch time: 0.4877, average train loss: 0.4458
[09/26 03:45:08 visual_prompt]: Inference (val):avg data time: 3.55e-05, avg batch time: 0.1675, average loss: 0.3348
[09/26 03:45:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 94.14	
[09/26 03:45:08 visual_prompt]: Training 31 / 100 epoch, with learning rate 0.4415111107797445
[09/26 03:45:15 visual_prompt]: Epoch 31 / 100: avg data time: 4.29e-02, avg batch time: 0.4884, average train loss: 0.3232
[09/26 03:45:16 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1675, average loss: 0.4227
[09/26 03:45:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 94.11	
[09/26 03:45:16 visual_prompt]: Training 32 / 100 epoch, with learning rate 0.43578620636934856
[09/26 03:45:23 visual_prompt]: Epoch 32 / 100: avg data time: 4.15e-02, avg batch time: 0.4871, average train loss: 0.2663
[09/26 03:45:24 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1674, average loss: 0.4756
[09/26 03:45:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 94.65	
[09/26 03:45:24 visual_prompt]: Training 33 / 100 epoch, with learning rate 0.42983495008466277
[09/26 03:45:31 visual_prompt]: Epoch 33 / 100: avg data time: 4.21e-02, avg batch time: 0.4888, average train loss: 0.2859
[09/26 03:45:32 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1675, average loss: 0.4527
[09/26 03:45:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 94.40	
[09/26 03:45:32 visual_prompt]: Training 34 / 100 epoch, with learning rate 0.4236645926147493
[09/26 03:45:39 visual_prompt]: Epoch 34 / 100: avg data time: 5.24e-02, avg batch time: 0.4962, average train loss: 0.3055
[09/26 03:45:40 visual_prompt]: Inference (val):avg data time: 3.31e-05, avg batch time: 0.1674, average loss: 0.3608
[09/26 03:45:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.84	
[09/26 03:45:40 visual_prompt]: Training 35 / 100 epoch, with learning rate 0.41728265158971456
[09/26 03:45:47 visual_prompt]: Epoch 35 / 100: avg data time: 5.70e-02, avg batch time: 0.5009, average train loss: 0.2888
[09/26 03:45:49 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1672, average loss: 0.3662
[09/26 03:45:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.19	
[09/26 03:45:49 visual_prompt]: Training 36 / 100 epoch, with learning rate 0.4106969024216348
[09/26 03:45:56 visual_prompt]: Epoch 36 / 100: avg data time: 5.26e-02, avg batch time: 0.4976, average train loss: 0.3383
[09/26 03:45:57 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1674, average loss: 0.3957
[09/26 03:45:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 94.19	
[09/26 03:45:57 visual_prompt]: Training 37 / 100 epoch, with learning rate 0.40391536883141455
[09/26 03:46:04 visual_prompt]: Epoch 37 / 100: avg data time: 4.10e-02, avg batch time: 0.4873, average train loss: 0.2593
[09/26 03:46:05 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1675, average loss: 0.4390
[09/26 03:46:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.58	
[09/26 03:46:05 visual_prompt]: Training 38 / 100 epoch, with learning rate 0.3969463130731183
[09/26 03:46:12 visual_prompt]: Epoch 38 / 100: avg data time: 5.66e-02, avg batch time: 0.5011, average train loss: 0.2775
[09/26 03:46:13 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1675, average loss: 0.3616
[09/26 03:46:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.09	
[09/26 03:46:13 visual_prompt]: Training 39 / 100 epoch, with learning rate 0.3897982258676867
[09/26 03:46:20 visual_prompt]: Epoch 39 / 100: avg data time: 4.87e-02, avg batch time: 0.4931, average train loss: 0.2511
[09/26 03:46:22 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1679, average loss: 0.6196
[09/26 03:46:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.96	
[09/26 03:46:22 visual_prompt]: Training 40 / 100 epoch, with learning rate 0.3824798160583012
[09/26 03:46:28 visual_prompt]: Epoch 40 / 100: avg data time: 4.60e-02, avg batch time: 0.4919, average train loss: 0.3693
[09/26 03:46:30 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1676, average loss: 0.3536
[09/26 03:46:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.60	
[09/26 03:46:30 visual_prompt]: Training 41 / 100 epoch, with learning rate 0.375
[09/26 03:46:36 visual_prompt]: Epoch 41 / 100: avg data time: 5.29e-02, avg batch time: 0.4965, average train loss: 0.2517
[09/26 03:46:38 visual_prompt]: Inference (val):avg data time: 2.73e-05, avg batch time: 0.1677, average loss: 0.3262
[09/26 03:46:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.83	
[09/26 03:46:38 visual_prompt]: Training 42 / 100 epoch, with learning rate 0.3673678906964727
[09/26 03:46:45 visual_prompt]: Epoch 42 / 100: avg data time: 4.50e-02, avg batch time: 0.4907, average train loss: 0.1790
[09/26 03:46:46 visual_prompt]: Inference (val):avg data time: 2.70e-05, avg batch time: 0.1677, average loss: 0.4374
[09/26 03:46:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.49	
[09/26 03:46:46 visual_prompt]: Training 43 / 100 epoch, with learning rate 0.35959278669726935
[09/26 03:46:53 visual_prompt]: Epoch 43 / 100: avg data time: 4.21e-02, avg batch time: 0.4890, average train loss: 0.2277
[09/26 03:46:54 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1671, average loss: 0.4756
[09/26 03:46:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.93	
[09/26 03:46:54 visual_prompt]: Training 44 / 100 epoch, with learning rate 0.3516841607689501
[09/26 03:47:01 visual_prompt]: Epoch 44 / 100: avg data time: 5.45e-02, avg batch time: 0.4993, average train loss: 0.1971
[09/26 03:47:02 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1674, average loss: 0.3137
[09/26 03:47:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 94.87	
[09/26 03:47:02 visual_prompt]: Best epoch 44: best metric: 0.885
[09/26 03:47:02 visual_prompt]: Training 45 / 100 epoch, with learning rate 0.34365164835397805
[09/26 03:47:09 visual_prompt]: Epoch 45 / 100: avg data time: 5.21e-02, avg batch time: 0.4960, average train loss: 0.1394
[09/26 03:47:11 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1676, average loss: 0.3791
[09/26 03:47:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 94.94	
[09/26 03:47:11 visual_prompt]: Training 46 / 100 epoch, with learning rate 0.3355050358314172
[09/26 03:47:17 visual_prompt]: Epoch 46 / 100: avg data time: 5.21e-02, avg batch time: 0.4960, average train loss: 0.1092
[09/26 03:47:19 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1675, average loss: 0.4578
[09/26 03:47:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.12	
[09/26 03:47:19 visual_prompt]: Training 47 / 100 epoch, with learning rate 0.32725424859373686
[09/26 03:47:26 visual_prompt]: Epoch 47 / 100: avg data time: 5.83e-02, avg batch time: 0.5022, average train loss: 0.0919
[09/26 03:47:27 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1676, average loss: 0.4825
[09/26 03:47:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 91.04	
[09/26 03:47:27 visual_prompt]: Training 48 / 100 epoch, with learning rate 0.3189093389542498
[09/26 03:47:34 visual_prompt]: Epoch 48 / 100: avg data time: 6.14e-02, avg batch time: 0.5055, average train loss: 0.2857
[09/26 03:47:36 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1677, average loss: 0.3726
[09/26 03:47:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.91	
[09/26 03:47:36 visual_prompt]: Training 49 / 100 epoch, with learning rate 0.3104804738999169
[09/26 03:47:42 visual_prompt]: Epoch 49 / 100: avg data time: 5.15e-02, avg batch time: 0.4954, average train loss: 0.1660
[09/26 03:47:44 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1674, average loss: 0.6129
[09/26 03:47:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.47	
[09/26 03:47:44 visual_prompt]: Training 50 / 100 epoch, with learning rate 0.3019779227044398
[09/26 03:47:50 visual_prompt]: Epoch 50 / 100: avg data time: 5.30e-02, avg batch time: 0.4977, average train loss: 0.1147
[09/26 03:47:52 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1674, average loss: 0.8675
[09/26 03:47:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.50	rocauc: 94.40	
[09/26 03:47:52 visual_prompt]: Training 51 / 100 epoch, with learning rate 0.29341204441673263
[09/26 03:47:59 visual_prompt]: Epoch 51 / 100: avg data time: 5.76e-02, avg batch time: 0.5018, average train loss: 0.1395
[09/26 03:48:00 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1673, average loss: 0.5831
[09/26 03:48:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 92.92	
[09/26 03:48:00 visual_prompt]: Training 52 / 100 epoch, with learning rate 0.28479327524001635
[09/26 03:48:07 visual_prompt]: Epoch 52 / 100: avg data time: 4.80e-02, avg batch time: 0.4921, average train loss: 0.1601
[09/26 03:48:08 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1671, average loss: 0.3428
[09/26 03:48:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.39	
[09/26 03:48:08 visual_prompt]: Training 53 / 100 epoch, with learning rate 0.2761321158169134
[09/26 03:48:15 visual_prompt]: Epoch 53 / 100: avg data time: 4.69e-02, avg batch time: 0.4908, average train loss: 0.1373
[09/26 03:48:16 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1675, average loss: 0.4554
[09/26 03:48:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.08	
[09/26 03:48:16 visual_prompt]: Training 54 / 100 epoch, with learning rate 0.2674391184360313
[09/26 03:48:23 visual_prompt]: Epoch 54 / 100: avg data time: 5.50e-02, avg batch time: 0.5001, average train loss: 0.1103
[09/26 03:48:25 visual_prompt]: Inference (val):avg data time: 2.95e-05, avg batch time: 0.1672, average loss: 0.4546
[09/26 03:48:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.80	
[09/26 03:48:25 visual_prompt]: Training 55 / 100 epoch, with learning rate 0.2587248741756253
[09/26 03:48:31 visual_prompt]: Epoch 55 / 100: avg data time: 5.09e-02, avg batch time: 0.4957, average train loss: 0.1145
[09/26 03:48:33 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1673, average loss: 0.7623
[09/26 03:48:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 93.66	
[09/26 03:48:33 visual_prompt]: Training 56 / 100 epoch, with learning rate 0.25
[09/26 03:48:39 visual_prompt]: Epoch 56 / 100: avg data time: 4.95e-02, avg batch time: 0.4956, average train loss: 0.1647
[09/26 03:48:41 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1676, average loss: 0.5039
[09/26 03:48:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.50	
[09/26 03:48:41 visual_prompt]: Training 57 / 100 epoch, with learning rate 0.24127512582437483
[09/26 03:48:48 visual_prompt]: Epoch 57 / 100: avg data time: 5.44e-02, avg batch time: 0.4985, average train loss: 0.0989
[09/26 03:48:49 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1675, average loss: 0.6971
[09/26 03:48:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.29	
[09/26 03:48:49 visual_prompt]: Training 58 / 100 epoch, with learning rate 0.23256088156396867
[09/26 03:48:56 visual_prompt]: Epoch 58 / 100: avg data time: 4.08e-02, avg batch time: 0.4876, average train loss: 0.1030
[09/26 03:48:57 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1677, average loss: 0.7146
[09/26 03:48:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.06	
[09/26 03:48:57 visual_prompt]: Training 59 / 100 epoch, with learning rate 0.22386788418308667
[09/26 03:49:04 visual_prompt]: Epoch 59 / 100: avg data time: 5.38e-02, avg batch time: 0.4987, average train loss: 0.1332
[09/26 03:49:05 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1679, average loss: 0.4611
[09/26 03:49:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.47	
[09/26 03:49:05 visual_prompt]: Training 60 / 100 epoch, with learning rate 0.2152067247599837
[09/26 03:49:12 visual_prompt]: Epoch 60 / 100: avg data time: 4.23e-02, avg batch time: 0.4878, average train loss: 0.0467
[09/26 03:49:13 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1676, average loss: 0.7252
[09/26 03:49:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.31	
[09/26 03:49:13 visual_prompt]: Training 61 / 100 epoch, with learning rate 0.20658795558326742
[09/26 03:49:20 visual_prompt]: Epoch 61 / 100: avg data time: 4.56e-02, avg batch time: 0.4918, average train loss: 0.1013
[09/26 03:49:22 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1677, average loss: 0.6269
[09/26 03:49:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.79	
[09/26 03:49:22 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.1980220772955602
[09/26 03:49:28 visual_prompt]: Epoch 62 / 100: avg data time: 4.08e-02, avg batch time: 0.4869, average train loss: 0.0832
[09/26 03:49:30 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1675, average loss: 0.5628
[09/26 03:49:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.27	
[09/26 03:49:30 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.1895195261000831
[09/26 03:49:36 visual_prompt]: Epoch 63 / 100: avg data time: 4.70e-02, avg batch time: 0.4923, average train loss: 0.0973
[09/26 03:49:38 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1674, average loss: 0.6644
[09/26 03:49:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.64	
[09/26 03:49:38 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.18109066104575022
[09/26 03:49:44 visual_prompt]: Epoch 64 / 100: avg data time: 4.41e-02, avg batch time: 0.4900, average train loss: 0.1092
[09/26 03:49:46 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1676, average loss: 0.5277
[09/26 03:49:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 93.00	
[09/26 03:49:46 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.17274575140626316
[09/26 03:49:53 visual_prompt]: Epoch 65 / 100: avg data time: 3.99e-02, avg batch time: 0.4886, average train loss: 0.1235
[09/26 03:49:54 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1674, average loss: 0.5806
[09/26 03:49:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.12	
[09/26 03:49:54 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.16449496416858284
[09/26 03:50:01 visual_prompt]: Epoch 66 / 100: avg data time: 4.17e-02, avg batch time: 0.4886, average train loss: 0.1188
[09/26 03:50:02 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1674, average loss: 0.4723
[09/26 03:50:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.41	
[09/26 03:50:02 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.15634835164602198
[09/26 03:50:09 visual_prompt]: Epoch 67 / 100: avg data time: 4.25e-02, avg batch time: 0.4882, average train loss: 0.0500
[09/26 03:50:10 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1678, average loss: 0.5836
[09/26 03:50:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.82	
[09/26 03:50:10 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.14831583923105
[09/26 03:50:17 visual_prompt]: Epoch 68 / 100: avg data time: 5.00e-02, avg batch time: 0.4954, average train loss: 0.0244
[09/26 03:50:18 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1674, average loss: 0.7795
[09/26 03:50:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.67	
[09/26 03:50:18 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.14040721330273062
[09/26 03:50:25 visual_prompt]: Epoch 69 / 100: avg data time: 3.77e-02, avg batch time: 0.4823, average train loss: 0.0244
[09/26 03:50:26 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1676, average loss: 1.0093
[09/26 03:50:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 94.47	
[09/26 03:50:26 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.13263210930352737
[09/26 03:50:33 visual_prompt]: Epoch 70 / 100: avg data time: 4.79e-02, avg batch time: 0.4945, average train loss: 0.0809
[09/26 03:50:34 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1677, average loss: 0.5373
[09/26 03:50:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.92	
[09/26 03:50:34 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.12500000000000006
[09/26 03:50:41 visual_prompt]: Epoch 71 / 100: avg data time: 5.06e-02, avg batch time: 0.4947, average train loss: 0.0404
[09/26 03:50:43 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1675, average loss: 0.8986
[09/26 03:50:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 92.49	
[09/26 03:50:43 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.1175201839416988
[09/26 03:50:49 visual_prompt]: Epoch 72 / 100: avg data time: 4.53e-02, avg batch time: 0.4904, average train loss: 0.0193
[09/26 03:50:51 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1676, average loss: 0.8537
[09/26 03:50:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.90	
[09/26 03:50:51 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.11020177413231333
[09/26 03:50:58 visual_prompt]: Epoch 73 / 100: avg data time: 5.40e-02, avg batch time: 0.5033, average train loss: 0.0495
[09/26 03:50:59 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1675, average loss: 0.7908
[09/26 03:50:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 90.86	
[09/26 03:50:59 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.10305368692688174
[09/26 03:51:06 visual_prompt]: Epoch 74 / 100: avg data time: 5.27e-02, avg batch time: 0.4976, average train loss: 0.1173
[09/26 03:51:07 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1677, average loss: 0.6882
[09/26 03:51:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 90.50	
[09/26 03:51:07 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.09608463116858543
[09/26 03:51:14 visual_prompt]: Epoch 75 / 100: avg data time: 5.80e-02, avg batch time: 0.5018, average train loss: 0.0974
[09/26 03:51:15 visual_prompt]: Inference (val):avg data time: 2.92e-05, avg batch time: 0.1679, average loss: 0.5706
[09/26 03:51:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.86	
[09/26 03:51:15 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.08930309757836516
[09/26 03:51:22 visual_prompt]: Epoch 76 / 100: avg data time: 4.39e-02, avg batch time: 0.4915, average train loss: 0.0289
[09/26 03:51:24 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1676, average loss: 0.7274
[09/26 03:51:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.70	
[09/26 03:51:24 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.08271734841028552
[09/26 03:51:30 visual_prompt]: Epoch 77 / 100: avg data time: 4.86e-02, avg batch time: 0.4929, average train loss: 0.0155
[09/26 03:51:32 visual_prompt]: Inference (val):avg data time: 3.42e-05, avg batch time: 0.1676, average loss: 0.8917
[09/26 03:51:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 92.83	
[09/26 03:51:32 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.07633540738525066
[09/26 03:51:38 visual_prompt]: Epoch 78 / 100: avg data time: 5.66e-02, avg batch time: 0.5005, average train loss: 0.0056
[09/26 03:51:40 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1676, average loss: 0.9107
[09/26 03:51:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.00	
[09/26 03:51:40 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.07016504991533726
[09/26 03:51:47 visual_prompt]: Epoch 79 / 100: avg data time: 4.59e-02, avg batch time: 0.4899, average train loss: 0.0039
[09/26 03:51:48 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1674, average loss: 0.9246
[09/26 03:51:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.59	
[09/26 03:51:48 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.06421379363065141
[09/26 03:51:55 visual_prompt]: Epoch 80 / 100: avg data time: 5.26e-02, avg batch time: 0.4971, average train loss: 0.0007
[09/26 03:51:56 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1675, average loss: 0.9282
[09/26 03:51:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.40	
[09/26 03:51:56 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.058488889220255524
[09/26 03:52:03 visual_prompt]: Epoch 81 / 100: avg data time: 5.15e-02, avg batch time: 0.4962, average train loss: 0.0006
[09/26 03:52:04 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1673, average loss: 0.9636
[09/26 03:52:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.23	
[09/26 03:52:04 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.052997311598319524
[09/26 03:52:11 visual_prompt]: Epoch 82 / 100: avg data time: 5.60e-02, avg batch time: 0.5012, average train loss: 0.0004
[09/26 03:52:13 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1673, average loss: 1.0336
[09/26 03:52:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.24	
[09/26 03:52:13 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.047745751406263165
[09/26 03:52:19 visual_prompt]: Epoch 83 / 100: avg data time: 5.74e-02, avg batch time: 0.5024, average train loss: 0.0003
[09/26 03:52:21 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1674, average loss: 1.0693
[09/26 03:52:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.13	
[09/26 03:52:21 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.042740606861239594
[09/26 03:52:28 visual_prompt]: Epoch 84 / 100: avg data time: 5.77e-02, avg batch time: 0.5016, average train loss: 0.0003
[09/26 03:52:29 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1674, average loss: 1.0887
[09/26 03:52:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.06	
[09/26 03:52:29 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.03798797596089351
[09/26 03:52:36 visual_prompt]: Epoch 85 / 100: avg data time: 4.17e-02, avg batch time: 0.4883, average train loss: 0.0003
[09/26 03:52:37 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1679, average loss: 1.1075
[09/26 03:52:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 91.93	
[09/26 03:52:37 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.03349364905389032
[09/26 03:52:44 visual_prompt]: Epoch 86 / 100: avg data time: 6.27e-02, avg batch time: 0.5065, average train loss: 0.0002
[09/26 03:52:45 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1675, average loss: 1.1257
[09/26 03:52:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 91.86	
[09/26 03:52:45 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.029263101785268253
[09/26 03:52:52 visual_prompt]: Epoch 87 / 100: avg data time: 5.36e-02, avg batch time: 0.4978, average train loss: 0.0002
[09/26 03:52:54 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1675, average loss: 1.1395
[09/26 03:52:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.85	
[09/26 03:52:54 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.025301488425208296
[09/26 03:53:00 visual_prompt]: Epoch 88 / 100: avg data time: 4.17e-02, avg batch time: 0.4873, average train loss: 0.0002
[09/26 03:53:02 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1677, average loss: 1.1502
[09/26 03:53:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.98	
[09/26 03:53:02 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.021613635589349756
[09/26 03:53:08 visual_prompt]: Epoch 89 / 100: avg data time: 4.64e-02, avg batch time: 0.4908, average train loss: 0.0003
[09/26 03:53:10 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1673, average loss: 1.1558
[09/26 03:53:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.04	
[09/26 03:53:10 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.01820403635830317
[09/26 03:53:17 visual_prompt]: Epoch 90 / 100: avg data time: 4.58e-02, avg batch time: 0.4925, average train loss: 0.0002
[09/26 03:53:18 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1676, average loss: 1.1612
[09/26 03:53:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.08	
[09/26 03:53:18 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.01507684480352292
[09/26 03:53:25 visual_prompt]: Epoch 91 / 100: avg data time: 5.76e-02, avg batch time: 0.5018, average train loss: 0.0002
[09/26 03:53:26 visual_prompt]: Inference (val):avg data time: 2.03e-05, avg batch time: 0.1676, average loss: 1.1650
[09/26 03:53:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.10	
[09/26 03:53:26 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.012235870926211617
[09/26 03:53:33 visual_prompt]: Epoch 92 / 100: avg data time: 4.23e-02, avg batch time: 0.4881, average train loss: 0.0002
[09/26 03:53:34 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1676, average loss: 1.1685
[09/26 03:53:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.09	
[09/26 03:53:34 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.009684576015420276
[09/26 03:53:41 visual_prompt]: Epoch 93 / 100: avg data time: 4.83e-02, avg batch time: 0.4931, average train loss: 0.0002
[09/26 03:53:42 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1673, average loss: 1.1704
[09/26 03:53:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.06	
[09/26 03:53:42 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.007426068431000882
[09/26 03:53:49 visual_prompt]: Epoch 94 / 100: avg data time: 5.94e-02, avg batch time: 0.5051, average train loss: 0.0002
[09/26 03:53:51 visual_prompt]: Inference (val):avg data time: 2.79e-05, avg batch time: 0.1676, average loss: 1.1721
[09/26 03:53:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.05	
[09/26 03:53:51 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.005463099816548578
[09/26 03:53:57 visual_prompt]: Epoch 95 / 100: avg data time: 4.47e-02, avg batch time: 0.4899, average train loss: 0.0002
[09/26 03:53:59 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1674, average loss: 1.1741
[09/26 03:53:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.05	
[09/26 03:53:59 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.003798061746947995
[09/26 03:54:06 visual_prompt]: Epoch 96 / 100: avg data time: 5.42e-02, avg batch time: 0.4996, average train loss: 0.0002
[09/26 03:54:07 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1675, average loss: 1.1761
[09/26 03:54:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.04	
[09/26 03:54:07 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.0024329828146074095
[09/26 03:54:14 visual_prompt]: Epoch 97 / 100: avg data time: 5.66e-02, avg batch time: 0.5007, average train loss: 0.0002
[09/26 03:54:15 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1679, average loss: 1.1769
[09/26 03:54:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.04	
[09/26 03:54:15 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.0013695261579316775
[09/26 03:54:22 visual_prompt]: Epoch 98 / 100: avg data time: 5.59e-02, avg batch time: 0.5000, average train loss: 0.0002
[09/26 03:54:24 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1675, average loss: 1.1772
[09/26 03:54:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.04	
[09/26 03:54:24 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.0006089874350439506
[09/26 03:54:30 visual_prompt]: Epoch 99 / 100: avg data time: 5.87e-02, avg batch time: 0.5027, average train loss: 0.0002
[09/26 03:54:32 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1680, average loss: 1.1774
[09/26 03:54:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.04	
[09/26 03:54:32 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.00015229324522605947
[09/26 03:54:39 visual_prompt]: Epoch 100 / 100: avg data time: 5.71e-02, avg batch time: 0.5001, average train loss: 0.0002
[09/26 03:54:40 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1674, average loss: 1.1774
[09/26 03:54:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.04	
[09/26 03:54:40 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 03:54:40 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 03:54:40 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 03:54:40 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 03:54:40 visual_prompt]: Training with config:
[09/26 03:54:40 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr0.5_wd0.0001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 0.5, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 03:54:40 visual_prompt]: Loading training data...
[09/26 03:54:40 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 03:54:42 visual_prompt]: Number of images: 800
[09/26 03:54:42 visual_prompt]: Number of classes: 2 / 2
[09/26 03:54:42 visual_prompt]: Loading validation data...
[09/26 03:54:42 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 03:54:42 visual_prompt]: Number of images: 200
[09/26 03:54:42 visual_prompt]: Number of classes: 2 / 2
[09/26 03:54:42 visual_prompt]: Constructing models...
[09/26 03:54:44 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 03:54:44 visual_prompt]: tuned percent:0.536
[09/26 03:54:45 visual_prompt]: Device used for model: 0
[09/26 03:54:45 visual_prompt]: Setting up Evaluator...
[09/26 03:54:45 visual_prompt]: Setting up Trainer...
[09/26 03:54:45 visual_prompt]: 	Setting up the optimizer...
[09/26 03:54:45 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 03:54:51 visual_prompt]: Epoch 1 / 100: avg data time: 5.10e-02, avg batch time: 0.4968, average train loss: 1.9856
[09/26 03:54:53 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1670, average loss: 2.0033
[09/26 03:54:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 03:54:53 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 03:54:53 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.05
[09/26 03:54:59 visual_prompt]: Epoch 2 / 100: avg data time: 4.81e-02, avg batch time: 0.4930, average train loss: 3.1372
[09/26 03:55:01 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1667, average loss: 0.6812
[09/26 03:55:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 55.50	rocauc: 58.90	
[09/26 03:55:01 visual_prompt]: Best epoch 2: best metric: 0.555
[09/26 03:55:01 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.1
[09/26 03:55:08 visual_prompt]: Epoch 3 / 100: avg data time: 4.28e-02, avg batch time: 0.4881, average train loss: 0.7752
[09/26 03:55:09 visual_prompt]: Inference (val):avg data time: 3.79e-05, avg batch time: 0.1670, average loss: 0.6095
[09/26 03:55:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.00	rocauc: 87.24	
[09/26 03:55:09 visual_prompt]: Best epoch 3: best metric: 0.650
[09/26 03:55:09 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.15
[09/26 03:55:16 visual_prompt]: Epoch 4 / 100: avg data time: 5.37e-02, avg batch time: 0.4992, average train loss: 0.5971
[09/26 03:55:17 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1672, average loss: 0.4276
[09/26 03:55:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 90.48	
[09/26 03:55:17 visual_prompt]: Best epoch 4: best metric: 0.785
[09/26 03:55:17 visual_prompt]: Training 5 / 100 epoch, with learning rate 0.2
[09/26 03:55:24 visual_prompt]: Epoch 5 / 100: avg data time: 5.60e-02, avg batch time: 0.5000, average train loss: 0.5378
[09/26 03:55:25 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1673, average loss: 0.4284
[09/26 03:55:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.44	
[09/26 03:55:25 visual_prompt]: Best epoch 5: best metric: 0.810
[09/26 03:55:25 visual_prompt]: Training 6 / 100 epoch, with learning rate 0.25
[09/26 03:55:32 visual_prompt]: Epoch 6 / 100: avg data time: 5.04e-02, avg batch time: 0.4945, average train loss: 0.5240
[09/26 03:55:34 visual_prompt]: Inference (val):avg data time: 4.46e-05, avg batch time: 0.1674, average loss: 0.5165
[09/26 03:55:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.00	rocauc: 90.26	
[09/26 03:55:34 visual_prompt]: Training 7 / 100 epoch, with learning rate 0.3
[09/26 03:55:40 visual_prompt]: Epoch 7 / 100: avg data time: 4.98e-02, avg batch time: 0.4957, average train loss: 0.5731
[09/26 03:55:42 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1673, average loss: 0.4134
[09/26 03:55:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 91.57	
[09/26 03:55:42 visual_prompt]: Training 8 / 100 epoch, with learning rate 0.35
[09/26 03:55:49 visual_prompt]: Epoch 8 / 100: avg data time: 4.46e-02, avg batch time: 0.4898, average train loss: 0.5603
[09/26 03:55:50 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1673, average loss: 0.5433
[09/26 03:55:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.50	rocauc: 92.26	
[09/26 03:55:50 visual_prompt]: Training 9 / 100 epoch, with learning rate 0.4
[09/26 03:55:57 visual_prompt]: Epoch 9 / 100: avg data time: 5.18e-02, avg batch time: 0.4953, average train loss: 0.5889
[09/26 03:55:58 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1671, average loss: 0.7154
[09/26 03:55:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 62.00	rocauc: 91.81	
[09/26 03:55:58 visual_prompt]: Training 10 / 100 epoch, with learning rate 0.45
[09/26 03:56:05 visual_prompt]: Epoch 10 / 100: avg data time: 4.48e-02, avg batch time: 0.4886, average train loss: 0.5348
[09/26 03:56:06 visual_prompt]: Inference (val):avg data time: 2.76e-05, avg batch time: 0.1672, average loss: 0.4369
[09/26 03:56:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.50	rocauc: 90.93	
[09/26 03:56:06 visual_prompt]: Training 11 / 100 epoch, with learning rate 0.5
[09/26 03:56:13 visual_prompt]: Epoch 11 / 100: avg data time: 5.58e-02, avg batch time: 0.4998, average train loss: 0.4434
[09/26 03:56:15 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1688, average loss: 0.5471
[09/26 03:56:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.00	rocauc: 92.62	
[09/26 03:56:15 visual_prompt]: Training 12 / 100 epoch, with learning rate 0.49984770675477397
[09/26 03:56:21 visual_prompt]: Epoch 12 / 100: avg data time: 6.05e-02, avg batch time: 0.5046, average train loss: 0.4316
[09/26 03:56:23 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1672, average loss: 0.3507
[09/26 03:56:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.01	
[09/26 03:56:23 visual_prompt]: Best epoch 12: best metric: 0.835
[09/26 03:56:23 visual_prompt]: Training 13 / 100 epoch, with learning rate 0.49939101256495605
[09/26 03:56:30 visual_prompt]: Epoch 13 / 100: avg data time: 5.69e-02, avg batch time: 0.5012, average train loss: 0.4133
[09/26 03:56:31 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1673, average loss: 0.3605
[09/26 03:56:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 93.12	
[09/26 03:56:31 visual_prompt]: Training 14 / 100 epoch, with learning rate 0.4986304738420683
[09/26 03:56:38 visual_prompt]: Epoch 14 / 100: avg data time: 4.04e-02, avg batch time: 0.4880, average train loss: 0.3447
[09/26 03:56:39 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1671, average loss: 0.4050
[09/26 03:56:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.26	
[09/26 03:56:39 visual_prompt]: Training 15 / 100 epoch, with learning rate 0.4975670171853926
[09/26 03:56:46 visual_prompt]: Epoch 15 / 100: avg data time: 4.22e-02, avg batch time: 0.4880, average train loss: 0.3833
[09/26 03:56:47 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1675, average loss: 0.3391
[09/26 03:56:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.36	
[09/26 03:56:47 visual_prompt]: Best epoch 15: best metric: 0.840
[09/26 03:56:47 visual_prompt]: Training 16 / 100 epoch, with learning rate 0.49620193825305203
[09/26 03:56:54 visual_prompt]: Epoch 16 / 100: avg data time: 5.94e-02, avg batch time: 0.5037, average train loss: 0.3353
[09/26 03:56:56 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1677, average loss: 0.5917
[09/26 03:56:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 93.05	
[09/26 03:56:56 visual_prompt]: Training 17 / 100 epoch, with learning rate 0.4945369001834514
[09/26 03:57:02 visual_prompt]: Epoch 17 / 100: avg data time: 4.33e-02, avg batch time: 0.4896, average train loss: 0.4037
[09/26 03:57:04 visual_prompt]: Inference (val):avg data time: 3.25e-05, avg batch time: 0.1677, average loss: 0.3135
[09/26 03:57:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 94.54	
[09/26 03:57:04 visual_prompt]: Best epoch 17: best metric: 0.860
[09/26 03:57:04 visual_prompt]: Training 18 / 100 epoch, with learning rate 0.4925739315689991
[09/26 03:57:10 visual_prompt]: Epoch 18 / 100: avg data time: 5.34e-02, avg batch time: 0.4987, average train loss: 0.2775
[09/26 03:57:12 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1674, average loss: 0.5146
[09/26 03:57:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 92.28	
[09/26 03:57:12 visual_prompt]: Training 19 / 100 epoch, with learning rate 0.4903154239845797
[09/26 03:57:19 visual_prompt]: Epoch 19 / 100: avg data time: 5.39e-02, avg batch time: 0.4993, average train loss: 0.3085
[09/26 03:57:20 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1674, average loss: 0.3124
[09/26 03:57:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 94.23	
[09/26 03:57:20 visual_prompt]: Training 20 / 100 epoch, with learning rate 0.4877641290737884
[09/26 03:57:27 visual_prompt]: Epoch 20 / 100: avg data time: 5.04e-02, avg batch time: 0.4940, average train loss: 0.2468
[09/26 03:57:28 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1672, average loss: 0.4068
[09/26 03:57:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.27	
[09/26 03:57:28 visual_prompt]: Training 21 / 100 epoch, with learning rate 0.4849231551964771
[09/26 03:57:35 visual_prompt]: Epoch 21 / 100: avg data time: 5.26e-02, avg batch time: 0.4969, average train loss: 0.3425
[09/26 03:57:36 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1672, average loss: 0.9699
[09/26 03:57:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.50	rocauc: 94.92	
[09/26 03:57:36 visual_prompt]: Training 22 / 100 epoch, with learning rate 0.48179596364169686
[09/26 03:57:43 visual_prompt]: Epoch 22 / 100: avg data time: 4.96e-02, avg batch time: 0.4957, average train loss: 0.4236
[09/26 03:57:45 visual_prompt]: Inference (val):avg data time: 5.20e-05, avg batch time: 0.1672, average loss: 0.3478
[09/26 03:57:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 95.53	
[09/26 03:57:45 visual_prompt]: Training 23 / 100 epoch, with learning rate 0.4783863644106502
[09/26 03:57:51 visual_prompt]: Epoch 23 / 100: avg data time: 5.58e-02, avg batch time: 0.4998, average train loss: 0.2680
[09/26 03:57:53 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1672, average loss: 0.3565
[09/26 03:57:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.52	
[09/26 03:57:53 visual_prompt]: Training 24 / 100 epoch, with learning rate 0.47469851157479176
[09/26 03:58:00 visual_prompt]: Epoch 24 / 100: avg data time: 5.46e-02, avg batch time: 0.4991, average train loss: 0.1950
[09/26 03:58:01 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1673, average loss: 0.3665
[09/26 03:58:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.25	
[09/26 03:58:01 visual_prompt]: Training 25 / 100 epoch, with learning rate 0.47073689821473175
[09/26 03:58:08 visual_prompt]: Epoch 25 / 100: avg data time: 5.75e-02, avg batch time: 0.5015, average train loss: 0.1674
[09/26 03:58:09 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1673, average loss: 0.3912
[09/26 03:58:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.79	
[09/26 03:58:09 visual_prompt]: Training 26 / 100 epoch, with learning rate 0.4665063509461097
[09/26 03:58:16 visual_prompt]: Epoch 26 / 100: avg data time: 4.32e-02, avg batch time: 0.4901, average train loss: 0.1697
[09/26 03:58:17 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1673, average loss: 0.5078
[09/26 03:58:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.99	
[09/26 03:58:17 visual_prompt]: Training 27 / 100 epoch, with learning rate 0.46201202403910646
[09/26 03:58:24 visual_prompt]: Epoch 27 / 100: avg data time: 4.73e-02, avg batch time: 0.4924, average train loss: 0.2087
[09/26 03:58:25 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1676, average loss: 0.3829
[09/26 03:58:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.69	
[09/26 03:58:25 visual_prompt]: Training 28 / 100 epoch, with learning rate 0.4572593931387604
[09/26 03:58:32 visual_prompt]: Epoch 28 / 100: avg data time: 5.50e-02, avg batch time: 0.4994, average train loss: 0.1722
[09/26 03:58:34 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1675, average loss: 0.4204
[09/26 03:58:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.46	
[09/26 03:58:34 visual_prompt]: Training 29 / 100 epoch, with learning rate 0.45225424859373686
[09/26 03:58:40 visual_prompt]: Epoch 29 / 100: avg data time: 4.18e-02, avg batch time: 0.4862, average train loss: 0.1089
[09/26 03:58:42 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1672, average loss: 0.4710
[09/26 03:58:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 92.71	
[09/26 03:58:42 visual_prompt]: Best epoch 29: best metric: 0.870
[09/26 03:58:42 visual_prompt]: Training 30 / 100 epoch, with learning rate 0.44700268840168045
[09/26 03:58:48 visual_prompt]: Epoch 30 / 100: avg data time: 4.41e-02, avg batch time: 0.4893, average train loss: 0.1064
[09/26 03:58:50 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1673, average loss: 0.4178
[09/26 03:58:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.36	
[09/26 03:58:50 visual_prompt]: Training 31 / 100 epoch, with learning rate 0.4415111107797445
[09/26 03:58:56 visual_prompt]: Epoch 31 / 100: avg data time: 4.71e-02, avg batch time: 0.4935, average train loss: 0.0921
[09/26 03:58:58 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1679, average loss: 0.7103
[09/26 03:58:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 90.40	
[09/26 03:58:58 visual_prompt]: Training 32 / 100 epoch, with learning rate 0.43578620636934856
[09/26 03:59:04 visual_prompt]: Epoch 32 / 100: avg data time: 4.74e-02, avg batch time: 0.4932, average train loss: 0.2260
[09/26 03:59:06 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1674, average loss: 0.4281
[09/26 03:59:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.79	
[09/26 03:59:06 visual_prompt]: Training 33 / 100 epoch, with learning rate 0.42983495008466277
[09/26 03:59:13 visual_prompt]: Epoch 33 / 100: avg data time: 5.64e-02, avg batch time: 0.5005, average train loss: 0.1455
[09/26 03:59:14 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1672, average loss: 0.4533
[09/26 03:59:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 94.09	
[09/26 03:59:14 visual_prompt]: Training 34 / 100 epoch, with learning rate 0.4236645926147493
[09/26 03:59:21 visual_prompt]: Epoch 34 / 100: avg data time: 5.76e-02, avg batch time: 0.5021, average train loss: 0.1323
[09/26 03:59:22 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1674, average loss: 0.4836
[09/26 03:59:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.31	
[09/26 03:59:22 visual_prompt]: Training 35 / 100 epoch, with learning rate 0.41728265158971456
[09/26 03:59:29 visual_prompt]: Epoch 35 / 100: avg data time: 4.61e-02, avg batch time: 0.4923, average train loss: 0.0814
[09/26 03:59:30 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1675, average loss: 0.5304
[09/26 03:59:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 94.14	
[09/26 03:59:30 visual_prompt]: Best epoch 35: best metric: 0.875
[09/26 03:59:30 visual_prompt]: Training 36 / 100 epoch, with learning rate 0.4106969024216348
[09/26 03:59:37 visual_prompt]: Epoch 36 / 100: avg data time: 5.54e-02, avg batch time: 0.4993, average train loss: 0.0836
[09/26 03:59:39 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1674, average loss: 0.5355
[09/26 03:59:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.43	
[09/26 03:59:39 visual_prompt]: Training 37 / 100 epoch, with learning rate 0.40391536883141455
[09/26 03:59:45 visual_prompt]: Epoch 37 / 100: avg data time: 4.45e-02, avg batch time: 0.4904, average train loss: 0.1067
[09/26 03:59:47 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1676, average loss: 0.4163
[09/26 03:59:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 94.00	
[09/26 03:59:47 visual_prompt]: Training 38 / 100 epoch, with learning rate 0.3969463130731183
[09/26 03:59:53 visual_prompt]: Epoch 38 / 100: avg data time: 5.49e-02, avg batch time: 0.4987, average train loss: 0.0789
[09/26 03:59:55 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1676, average loss: 0.5135
[09/26 03:59:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.88	
[09/26 03:59:55 visual_prompt]: Training 39 / 100 epoch, with learning rate 0.3897982258676867
[09/26 04:00:02 visual_prompt]: Epoch 39 / 100: avg data time: 4.83e-02, avg batch time: 0.4922, average train loss: 0.0482
[09/26 04:00:03 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1676, average loss: 0.5240
[09/26 04:00:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.79	
[09/26 04:00:03 visual_prompt]: Training 40 / 100 epoch, with learning rate 0.3824798160583012
[09/26 04:00:10 visual_prompt]: Epoch 40 / 100: avg data time: 5.22e-02, avg batch time: 0.4976, average train loss: 0.0395
[09/26 04:00:11 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1676, average loss: 0.4952
[09/26 04:00:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 95.33	
[09/26 04:00:11 visual_prompt]: Best epoch 40: best metric: 0.880
[09/26 04:00:11 visual_prompt]: Training 41 / 100 epoch, with learning rate 0.375
[09/26 04:00:18 visual_prompt]: Epoch 41 / 100: avg data time: 4.40e-02, avg batch time: 0.4890, average train loss: 0.0816
[09/26 04:00:19 visual_prompt]: Inference (val):avg data time: 2.99e-05, avg batch time: 0.1675, average loss: 0.6751
[09/26 04:00:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 93.36	
[09/26 04:00:19 visual_prompt]: Training 42 / 100 epoch, with learning rate 0.3673678906964727
[09/26 04:00:26 visual_prompt]: Epoch 42 / 100: avg data time: 5.19e-02, avg batch time: 0.4974, average train loss: 0.0805
[09/26 04:00:28 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1678, average loss: 0.7811
[09/26 04:00:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 95.06	
[09/26 04:00:28 visual_prompt]: Training 43 / 100 epoch, with learning rate 0.35959278669726935
[09/26 04:00:34 visual_prompt]: Epoch 43 / 100: avg data time: 5.71e-02, avg batch time: 0.5008, average train loss: 0.2984
[09/26 04:00:36 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1673, average loss: 0.4361
[09/26 04:00:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.87	
[09/26 04:00:36 visual_prompt]: Training 44 / 100 epoch, with learning rate 0.3516841607689501
[09/26 04:00:43 visual_prompt]: Epoch 44 / 100: avg data time: 5.74e-02, avg batch time: 0.5021, average train loss: 0.0909
[09/26 04:00:44 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1673, average loss: 0.4261
[09/26 04:00:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 93.93	
[09/26 04:00:44 visual_prompt]: Training 45 / 100 epoch, with learning rate 0.34365164835397805
[09/26 04:00:51 visual_prompt]: Epoch 45 / 100: avg data time: 4.77e-02, avg batch time: 0.4936, average train loss: 0.0365
[09/26 04:00:52 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1673, average loss: 0.5010
[09/26 04:00:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 94.49	
[09/26 04:00:52 visual_prompt]: Best epoch 45: best metric: 0.885
[09/26 04:00:52 visual_prompt]: Training 46 / 100 epoch, with learning rate 0.3355050358314172
[09/26 04:00:59 visual_prompt]: Epoch 46 / 100: avg data time: 5.58e-02, avg batch time: 0.5010, average train loss: 0.0230
[09/26 04:01:01 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1675, average loss: 0.5921
[09/26 04:01:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.28	
[09/26 04:01:01 visual_prompt]: Training 47 / 100 epoch, with learning rate 0.32725424859373686
[09/26 04:01:07 visual_prompt]: Epoch 47 / 100: avg data time: 5.21e-02, avg batch time: 0.4973, average train loss: 0.0149
[09/26 04:01:09 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1676, average loss: 0.5616
[09/26 04:01:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.00	rocauc: 94.38	
[09/26 04:01:09 visual_prompt]: Best epoch 47: best metric: 0.890
[09/26 04:01:09 visual_prompt]: Training 48 / 100 epoch, with learning rate 0.3189093389542498
[09/26 04:01:16 visual_prompt]: Epoch 48 / 100: avg data time: 5.28e-02, avg batch time: 0.4976, average train loss: 0.0084
[09/26 04:01:17 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1673, average loss: 0.6219
[09/26 04:01:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 94.16	
[09/26 04:01:17 visual_prompt]: Training 49 / 100 epoch, with learning rate 0.3104804738999169
[09/26 04:01:24 visual_prompt]: Epoch 49 / 100: avg data time: 4.45e-02, avg batch time: 0.4907, average train loss: 0.0026
[09/26 04:01:25 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1673, average loss: 0.6548
[09/26 04:01:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 94.24	
[09/26 04:01:25 visual_prompt]: Training 50 / 100 epoch, with learning rate 0.3019779227044398
[09/26 04:01:32 visual_prompt]: Epoch 50 / 100: avg data time: 6.08e-02, avg batch time: 0.5046, average train loss: 0.0021
[09/26 04:01:33 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1678, average loss: 0.6857
[09/26 04:01:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.79	
[09/26 04:01:33 visual_prompt]: Training 51 / 100 epoch, with learning rate 0.29341204441673263
[09/26 04:01:40 visual_prompt]: Epoch 51 / 100: avg data time: 4.45e-02, avg batch time: 0.4914, average train loss: 0.0031
[09/26 04:01:42 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1675, average loss: 0.6590
[09/26 04:01:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 94.34	
[09/26 04:01:42 visual_prompt]: Training 52 / 100 epoch, with learning rate 0.28479327524001635
[09/26 04:01:48 visual_prompt]: Epoch 52 / 100: avg data time: 5.64e-02, avg batch time: 0.5019, average train loss: 0.0030
[09/26 04:01:50 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1673, average loss: 0.7017
[09/26 04:01:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.22	
[09/26 04:01:50 visual_prompt]: Training 53 / 100 epoch, with learning rate 0.2761321158169134
[09/26 04:01:57 visual_prompt]: Epoch 53 / 100: avg data time: 4.92e-02, avg batch time: 0.4932, average train loss: 0.0078
[09/26 04:01:58 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1675, average loss: 0.6352
[09/26 04:01:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 95.01	
[09/26 04:01:58 visual_prompt]: Training 54 / 100 epoch, with learning rate 0.2674391184360313
[09/26 04:02:05 visual_prompt]: Epoch 54 / 100: avg data time: 4.27e-02, avg batch time: 0.4879, average train loss: 0.0805
[09/26 04:02:06 visual_prompt]: Inference (val):avg data time: 2.76e-05, avg batch time: 0.1672, average loss: 0.5325
[09/26 04:02:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 94.41	
[09/26 04:02:06 visual_prompt]: Training 55 / 100 epoch, with learning rate 0.2587248741756253
[09/26 04:02:13 visual_prompt]: Epoch 55 / 100: avg data time: 5.30e-02, avg batch time: 0.4981, average train loss: 0.0543
[09/26 04:02:15 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1676, average loss: 0.5459
[09/26 04:02:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.25	
[09/26 04:02:15 visual_prompt]: Training 56 / 100 epoch, with learning rate 0.25
[09/26 04:02:21 visual_prompt]: Epoch 56 / 100: avg data time: 4.62e-02, avg batch time: 0.4914, average train loss: 0.0155
[09/26 04:02:23 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.1671, average loss: 0.5877
[09/26 04:02:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 94.15	
[09/26 04:02:23 visual_prompt]: Training 57 / 100 epoch, with learning rate 0.24127512582437483
[09/26 04:02:29 visual_prompt]: Epoch 57 / 100: avg data time: 5.32e-02, avg batch time: 0.4990, average train loss: 0.0046
[09/26 04:02:31 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1674, average loss: 0.6433
[09/26 04:02:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 94.54	
[09/26 04:02:31 visual_prompt]: Training 58 / 100 epoch, with learning rate 0.23256088156396867
[09/26 04:02:37 visual_prompt]: Epoch 58 / 100: avg data time: 4.40e-02, avg batch time: 0.4890, average train loss: 0.0062
[09/26 04:02:39 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1673, average loss: 0.6190
[09/26 04:02:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.76	
[09/26 04:02:39 visual_prompt]: Training 59 / 100 epoch, with learning rate 0.22386788418308667
[09/26 04:02:46 visual_prompt]: Epoch 59 / 100: avg data time: 4.56e-02, avg batch time: 0.4912, average train loss: 0.0022
[09/26 04:02:47 visual_prompt]: Inference (val):avg data time: 2.73e-05, avg batch time: 0.1676, average loss: 0.6483
[09/26 04:02:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.79	
[09/26 04:02:47 visual_prompt]: Training 60 / 100 epoch, with learning rate 0.2152067247599837
[09/26 04:02:54 visual_prompt]: Epoch 60 / 100: avg data time: 5.06e-02, avg batch time: 0.4958, average train loss: 0.0013
[09/26 04:02:55 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1674, average loss: 0.6650
[09/26 04:02:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 94.48	
[09/26 04:02:55 visual_prompt]: Training 61 / 100 epoch, with learning rate 0.20658795558326742
[09/26 04:03:02 visual_prompt]: Epoch 61 / 100: avg data time: 4.31e-02, avg batch time: 0.4893, average train loss: 0.0013
[09/26 04:03:03 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1673, average loss: 0.6670
[09/26 04:03:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 94.47	
[09/26 04:03:03 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.1980220772955602
[09/26 04:03:10 visual_prompt]: Epoch 62 / 100: avg data time: 4.85e-02, avg batch time: 0.4924, average train loss: 0.0010
[09/26 04:03:12 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1678, average loss: 0.6516
[09/26 04:03:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 94.29	
[09/26 04:03:12 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.1895195261000831
[09/26 04:03:18 visual_prompt]: Epoch 63 / 100: avg data time: 5.97e-02, avg batch time: 0.5032, average train loss: 0.0010
[09/26 04:03:20 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1674, average loss: 0.6524
[09/26 04:03:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.23	
[09/26 04:03:20 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.18109066104575022
[09/26 04:03:27 visual_prompt]: Epoch 64 / 100: avg data time: 6.43e-02, avg batch time: 0.5080, average train loss: 0.0008
[09/26 04:03:28 visual_prompt]: Inference (val):avg data time: 3.17e-05, avg batch time: 0.1677, average loss: 0.6590
[09/26 04:03:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.33	
[09/26 04:03:28 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.17274575140626316
[09/26 04:03:35 visual_prompt]: Epoch 65 / 100: avg data time: 5.86e-02, avg batch time: 0.5034, average train loss: 0.0009
[09/26 04:03:36 visual_prompt]: Inference (val):avg data time: 3.30e-05, avg batch time: 0.1676, average loss: 0.6694
[09/26 04:03:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 94.40	
[09/26 04:03:36 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.16449496416858284
[09/26 04:03:43 visual_prompt]: Epoch 66 / 100: avg data time: 5.24e-02, avg batch time: 0.4967, average train loss: 0.0007
[09/26 04:03:45 visual_prompt]: Inference (val):avg data time: 3.19e-05, avg batch time: 0.1676, average loss: 0.6743
[09/26 04:03:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.38	
[09/26 04:03:45 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.15634835164602198
[09/26 04:03:51 visual_prompt]: Epoch 67 / 100: avg data time: 5.22e-02, avg batch time: 0.4972, average train loss: 0.0007
[09/26 04:03:53 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1674, average loss: 0.6786
[09/26 04:03:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.38	
[09/26 04:03:53 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.14831583923105
[09/26 04:04:00 visual_prompt]: Epoch 68 / 100: avg data time: 4.23e-02, avg batch time: 0.4881, average train loss: 0.0007
[09/26 04:04:01 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1676, average loss: 0.6822
[09/26 04:04:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.39	
[09/26 04:04:01 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.14040721330273062
[09/26 04:04:08 visual_prompt]: Epoch 69 / 100: avg data time: 4.92e-02, avg batch time: 0.4942, average train loss: 0.0006
[09/26 04:04:09 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1676, average loss: 0.6872
[09/26 04:04:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.46	
[09/26 04:04:09 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.13263210930352737
[09/26 04:04:16 visual_prompt]: Epoch 70 / 100: avg data time: 4.90e-02, avg batch time: 0.4940, average train loss: 0.0006
[09/26 04:04:17 visual_prompt]: Inference (val):avg data time: 3.01e-05, avg batch time: 0.1675, average loss: 0.6926
[09/26 04:04:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.49	
[09/26 04:04:17 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.12500000000000006
[09/26 04:04:24 visual_prompt]: Epoch 71 / 100: avg data time: 4.17e-02, avg batch time: 0.4872, average train loss: 0.0006
[09/26 04:04:25 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1677, average loss: 0.6946
[09/26 04:04:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.52	
[09/26 04:04:25 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.1175201839416988
[09/26 04:04:32 visual_prompt]: Epoch 72 / 100: avg data time: 4.90e-02, avg batch time: 0.4937, average train loss: 0.0006
[09/26 04:04:33 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1675, average loss: 0.6954
[09/26 04:04:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.50	
[09/26 04:04:33 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.11020177413231333
[09/26 04:04:40 visual_prompt]: Epoch 73 / 100: avg data time: 4.65e-02, avg batch time: 0.4926, average train loss: 0.0005
[09/26 04:04:42 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1676, average loss: 0.6998
[09/26 04:04:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.48	
[09/26 04:04:42 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.10305368692688174
[09/26 04:04:48 visual_prompt]: Epoch 74 / 100: avg data time: 5.98e-02, avg batch time: 0.5041, average train loss: 0.0006
[09/26 04:04:50 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1675, average loss: 0.7006
[09/26 04:04:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.49	
[09/26 04:04:50 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.09608463116858543
[09/26 04:04:57 visual_prompt]: Epoch 75 / 100: avg data time: 5.63e-02, avg batch time: 0.5007, average train loss: 0.0005
[09/26 04:04:58 visual_prompt]: Inference (val):avg data time: 2.95e-05, avg batch time: 0.1675, average loss: 0.6998
[09/26 04:04:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.48	
[09/26 04:04:58 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.08930309757836516
[09/26 04:05:05 visual_prompt]: Epoch 76 / 100: avg data time: 5.63e-02, avg batch time: 0.5006, average train loss: 0.0005
[09/26 04:05:06 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1674, average loss: 0.7005
[09/26 04:05:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.47	
[09/26 04:05:06 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.08271734841028552
[09/26 04:05:13 visual_prompt]: Epoch 77 / 100: avg data time: 5.52e-02, avg batch time: 0.4998, average train loss: 0.0005
[09/26 04:05:14 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1674, average loss: 0.7027
[09/26 04:05:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.48	
[09/26 04:05:14 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.07633540738525066
[09/26 04:05:21 visual_prompt]: Epoch 78 / 100: avg data time: 5.97e-02, avg batch time: 0.5033, average train loss: 0.0005
[09/26 04:05:23 visual_prompt]: Inference (val):avg data time: 3.03e-05, avg batch time: 0.1675, average loss: 0.7046
[09/26 04:05:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.47	
[09/26 04:05:23 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.07016504991533726
[09/26 04:05:29 visual_prompt]: Epoch 79 / 100: avg data time: 5.44e-02, avg batch time: 0.4998, average train loss: 0.0005
[09/26 04:05:31 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1676, average loss: 0.7061
[09/26 04:05:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.48	
[09/26 04:05:31 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.06421379363065141
[09/26 04:05:38 visual_prompt]: Epoch 80 / 100: avg data time: 5.92e-02, avg batch time: 0.5031, average train loss: 0.0005
[09/26 04:05:39 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1675, average loss: 0.7075
[09/26 04:05:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.48	
[09/26 04:05:39 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.058488889220255524
[09/26 04:05:46 visual_prompt]: Epoch 81 / 100: avg data time: 4.29e-02, avg batch time: 0.4907, average train loss: 0.0005
[09/26 04:05:47 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1672, average loss: 0.7078
[09/26 04:05:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.47	
[09/26 04:05:47 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.052997311598319524
[09/26 04:05:54 visual_prompt]: Epoch 82 / 100: avg data time: 5.59e-02, avg batch time: 0.5009, average train loss: 0.0005
[09/26 04:05:55 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.1672, average loss: 0.7070
[09/26 04:05:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.46	
[09/26 04:05:55 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.047745751406263165
[09/26 04:06:02 visual_prompt]: Epoch 83 / 100: avg data time: 4.63e-02, avg batch time: 0.4925, average train loss: 0.0005
[09/26 04:06:04 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1674, average loss: 0.7075
[09/26 04:06:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.46	
[09/26 04:06:04 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.042740606861239594
[09/26 04:06:10 visual_prompt]: Epoch 84 / 100: avg data time: 4.46e-02, avg batch time: 0.4905, average train loss: 0.0005
[09/26 04:06:12 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1675, average loss: 0.7080
[09/26 04:06:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.45	
[09/26 04:06:12 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.03798797596089351
[09/26 04:06:18 visual_prompt]: Epoch 85 / 100: avg data time: 5.35e-02, avg batch time: 0.4987, average train loss: 0.0004
[09/26 04:06:20 visual_prompt]: Inference (val):avg data time: 3.41e-05, avg batch time: 0.1676, average loss: 0.7090
[09/26 04:06:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.45	
[09/26 04:06:20 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.03349364905389032
[09/26 04:06:27 visual_prompt]: Epoch 86 / 100: avg data time: 4.29e-02, avg batch time: 0.4883, average train loss: 0.0005
[09/26 04:06:28 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1676, average loss: 0.7096
[09/26 04:06:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.45	
[09/26 04:06:28 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.029263101785268253
[09/26 04:06:35 visual_prompt]: Epoch 87 / 100: avg data time: 5.35e-02, avg batch time: 0.4990, average train loss: 0.0005
[09/26 04:06:36 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1674, average loss: 0.7100
[09/26 04:06:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.45	
[09/26 04:06:36 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.025301488425208296
[09/26 04:06:43 visual_prompt]: Epoch 88 / 100: avg data time: 4.36e-02, avg batch time: 0.4883, average train loss: 0.0005
[09/26 04:06:44 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1673, average loss: 0.7103
[09/26 04:06:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.46	
[09/26 04:06:44 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.021613635589349756
[09/26 04:06:51 visual_prompt]: Epoch 89 / 100: avg data time: 4.59e-02, avg batch time: 0.4915, average train loss: 0.0004
[09/26 04:06:52 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1673, average loss: 0.7104
[09/26 04:06:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.46	
[09/26 04:06:52 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.01820403635830317
[09/26 04:06:59 visual_prompt]: Epoch 90 / 100: avg data time: 4.03e-02, avg batch time: 0.4865, average train loss: 0.0004
[09/26 04:07:01 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1674, average loss: 0.7105
[09/26 04:07:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.46	
[09/26 04:07:01 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.01507684480352292
[09/26 04:07:07 visual_prompt]: Epoch 91 / 100: avg data time: 4.15e-02, avg batch time: 0.4872, average train loss: 0.0005
[09/26 04:07:09 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1677, average loss: 0.7109
[09/26 04:07:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.47	
[09/26 04:07:09 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.012235870926211617
[09/26 04:07:15 visual_prompt]: Epoch 92 / 100: avg data time: 4.16e-02, avg batch time: 0.4877, average train loss: 0.0004
[09/26 04:07:17 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1673, average loss: 0.7112
[09/26 04:07:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.47	
[09/26 04:07:17 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.009684576015420276
[09/26 04:07:23 visual_prompt]: Epoch 93 / 100: avg data time: 5.51e-02, avg batch time: 0.4989, average train loss: 0.0005
[09/26 04:07:25 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1674, average loss: 0.7117
[09/26 04:07:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.47	
[09/26 04:07:25 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.007426068431000882
[09/26 04:07:32 visual_prompt]: Epoch 94 / 100: avg data time: 4.86e-02, avg batch time: 0.4927, average train loss: 0.0005
[09/26 04:07:33 visual_prompt]: Inference (val):avg data time: 2.98e-05, avg batch time: 0.1673, average loss: 0.7119
[09/26 04:07:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.47	
[09/26 04:07:33 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.005463099816548578
[09/26 04:07:40 visual_prompt]: Epoch 95 / 100: avg data time: 5.53e-02, avg batch time: 0.5004, average train loss: 0.0005
[09/26 04:07:41 visual_prompt]: Inference (val):avg data time: 3.53e-05, avg batch time: 0.1675, average loss: 0.7120
[09/26 04:07:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.47	
[09/26 04:07:41 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.003798061746947995
[09/26 04:07:48 visual_prompt]: Epoch 96 / 100: avg data time: 5.59e-02, avg batch time: 0.5000, average train loss: 0.0004
[09/26 04:07:50 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1677, average loss: 0.7121
[09/26 04:07:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.47	
[09/26 04:07:50 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.0024329828146074095
[09/26 04:07:56 visual_prompt]: Epoch 97 / 100: avg data time: 4.51e-02, avg batch time: 0.4915, average train loss: 0.0004
[09/26 04:07:58 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1675, average loss: 0.7121
[09/26 04:07:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.47	
[09/26 04:07:58 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.0013695261579316775
[09/26 04:08:05 visual_prompt]: Epoch 98 / 100: avg data time: 5.81e-02, avg batch time: 0.5024, average train loss: 0.0004
[09/26 04:08:06 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1678, average loss: 0.7122
[09/26 04:08:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.47	
[09/26 04:08:06 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.0006089874350439506
[09/26 04:08:13 visual_prompt]: Epoch 99 / 100: avg data time: 4.89e-02, avg batch time: 0.4947, average train loss: 0.0005
[09/26 04:08:14 visual_prompt]: Inference (val):avg data time: 4.59e-05, avg batch time: 0.1676, average loss: 0.7122
[09/26 04:08:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.47	
[09/26 04:08:14 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.00015229324522605947
[09/26 04:08:21 visual_prompt]: Epoch 100 / 100: avg data time: 4.80e-02, avg batch time: 0.4928, average train loss: 0.0005
[09/26 04:08:22 visual_prompt]: Inference (val):avg data time: 3.27e-05, avg batch time: 0.1676, average loss: 0.7122
[09/26 04:08:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.47	
[09/26 04:08:23 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 04:08:23 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 04:08:23 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 04:08:23 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 04:08:23 visual_prompt]: Training with config:
[09/26 04:08:23 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr0.5_wd0.0/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 0.5, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 04:08:23 visual_prompt]: Loading training data...
[09/26 04:08:23 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 04:08:24 visual_prompt]: Number of images: 800
[09/26 04:08:24 visual_prompt]: Number of classes: 2 / 2
[09/26 04:08:24 visual_prompt]: Loading validation data...
[09/26 04:08:24 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 04:08:24 visual_prompt]: Number of images: 200
[09/26 04:08:24 visual_prompt]: Number of classes: 2 / 2
[09/26 04:08:24 visual_prompt]: Constructing models...
[09/26 04:08:27 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 04:08:27 visual_prompt]: tuned percent:0.536
[09/26 04:08:27 visual_prompt]: Device used for model: 0
[09/26 04:08:27 visual_prompt]: Setting up Evaluator...
[09/26 04:08:27 visual_prompt]: Setting up Trainer...
[09/26 04:08:27 visual_prompt]: 	Setting up the optimizer...
[09/26 04:08:27 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 04:08:33 visual_prompt]: Epoch 1 / 100: avg data time: 5.54e-02, avg batch time: 0.5010, average train loss: 1.9697
[09/26 04:08:35 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1668, average loss: 2.0033
[09/26 04:08:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 04:08:35 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 04:08:35 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.05
[09/26 04:08:41 visual_prompt]: Epoch 2 / 100: avg data time: 3.84e-02, avg batch time: 0.4826, average train loss: 3.0420
[09/26 04:08:43 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1672, average loss: 0.9685
[09/26 04:08:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 65.78	
[09/26 04:08:43 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.1
[09/26 04:08:50 visual_prompt]: Epoch 3 / 100: avg data time: 4.24e-02, avg batch time: 0.4881, average train loss: 0.7471
[09/26 04:08:51 visual_prompt]: Inference (val):avg data time: 2.76e-05, avg batch time: 0.1671, average loss: 0.7461
[09/26 04:08:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.47	
[09/26 04:08:51 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.15
[09/26 04:08:58 visual_prompt]: Epoch 4 / 100: avg data time: 5.33e-02, avg batch time: 0.4970, average train loss: 0.6514
[09/26 04:08:59 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1670, average loss: 0.5886
[09/26 04:08:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 62.50	rocauc: 89.31	
[09/26 04:08:59 visual_prompt]: Best epoch 4: best metric: 0.625
[09/26 04:08:59 visual_prompt]: Training 5 / 100 epoch, with learning rate 0.2
[09/26 04:09:06 visual_prompt]: Epoch 5 / 100: avg data time: 4.34e-02, avg batch time: 0.4893, average train loss: 0.5566
[09/26 04:09:07 visual_prompt]: Inference (val):avg data time: 3.18e-05, avg batch time: 0.1674, average loss: 0.4846
[09/26 04:09:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 90.04	
[09/26 04:09:07 visual_prompt]: Best epoch 5: best metric: 0.795
[09/26 04:09:07 visual_prompt]: Training 6 / 100 epoch, with learning rate 0.25
[09/26 04:09:14 visual_prompt]: Epoch 6 / 100: avg data time: 4.94e-02, avg batch time: 0.4943, average train loss: 0.5038
[09/26 04:09:16 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1676, average loss: 0.4040
[09/26 04:09:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 90.55	
[09/26 04:09:16 visual_prompt]: Best epoch 6: best metric: 0.815
[09/26 04:09:16 visual_prompt]: Training 7 / 100 epoch, with learning rate 0.3
[09/26 04:09:22 visual_prompt]: Epoch 7 / 100: avg data time: 5.85e-02, avg batch time: 0.5025, average train loss: 0.4747
[09/26 04:09:24 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1673, average loss: 0.4244
[09/26 04:09:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.24	
[09/26 04:09:24 visual_prompt]: Training 8 / 100 epoch, with learning rate 0.35
[09/26 04:09:31 visual_prompt]: Epoch 8 / 100: avg data time: 4.44e-02, avg batch time: 0.4907, average train loss: 0.4858
[09/26 04:09:32 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1671, average loss: 0.4250
[09/26 04:09:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 92.20	
[09/26 04:09:32 visual_prompt]: Training 9 / 100 epoch, with learning rate 0.4
[09/26 04:09:39 visual_prompt]: Epoch 9 / 100: avg data time: 5.43e-02, avg batch time: 0.4974, average train loss: 0.4537
[09/26 04:09:40 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1675, average loss: 0.4853
[09/26 04:09:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.00	rocauc: 93.32	
[09/26 04:09:40 visual_prompt]: Training 10 / 100 epoch, with learning rate 0.45
[09/26 04:09:47 visual_prompt]: Epoch 10 / 100: avg data time: 4.46e-02, avg batch time: 0.4888, average train loss: 0.4638
[09/26 04:09:48 visual_prompt]: Inference (val):avg data time: 3.41e-05, avg batch time: 0.1674, average loss: 0.9770
[09/26 04:09:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 61.50	rocauc: 93.02	
[09/26 04:09:48 visual_prompt]: Training 11 / 100 epoch, with learning rate 0.5
[09/26 04:09:55 visual_prompt]: Epoch 11 / 100: avg data time: 4.61e-02, avg batch time: 0.4914, average train loss: 0.5620
[09/26 04:09:57 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1674, average loss: 0.4404
[09/26 04:09:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 92.64	
[09/26 04:09:57 visual_prompt]: Training 12 / 100 epoch, with learning rate 0.49984770675477397
[09/26 04:10:03 visual_prompt]: Epoch 12 / 100: avg data time: 4.31e-02, avg batch time: 0.4866, average train loss: 0.4240
[09/26 04:10:05 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1675, average loss: 0.3442
[09/26 04:10:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.15	
[09/26 04:10:05 visual_prompt]: Best epoch 12: best metric: 0.850
[09/26 04:10:05 visual_prompt]: Training 13 / 100 epoch, with learning rate 0.49939101256495605
[09/26 04:10:11 visual_prompt]: Epoch 13 / 100: avg data time: 5.18e-02, avg batch time: 0.4952, average train loss: 0.3685
[09/26 04:10:13 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1674, average loss: 0.3955
[09/26 04:10:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 91.63	
[09/26 04:10:13 visual_prompt]: Training 14 / 100 epoch, with learning rate 0.4986304738420683
[09/26 04:10:19 visual_prompt]: Epoch 14 / 100: avg data time: 4.11e-02, avg batch time: 0.4861, average train loss: 0.4450
[09/26 04:10:21 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1672, average loss: 0.3316
[09/26 04:10:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 94.31	
[09/26 04:10:21 visual_prompt]: Training 15 / 100 epoch, with learning rate 0.4975670171853926
[09/26 04:10:27 visual_prompt]: Epoch 15 / 100: avg data time: 5.46e-02, avg batch time: 0.4980, average train loss: 0.3315
[09/26 04:10:29 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1673, average loss: 0.3632
[09/26 04:10:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.63	
[09/26 04:10:29 visual_prompt]: Best epoch 15: best metric: 0.860
[09/26 04:10:29 visual_prompt]: Training 16 / 100 epoch, with learning rate 0.49620193825305203
[09/26 04:10:36 visual_prompt]: Epoch 16 / 100: avg data time: 5.36e-02, avg batch time: 0.4979, average train loss: 0.3221
[09/26 04:10:37 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1672, average loss: 0.4377
[09/26 04:10:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 92.78	
[09/26 04:10:37 visual_prompt]: Training 17 / 100 epoch, with learning rate 0.4945369001834514
[09/26 04:10:44 visual_prompt]: Epoch 17 / 100: avg data time: 4.18e-02, avg batch time: 0.4894, average train loss: 0.4044
[09/26 04:10:45 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1674, average loss: 0.7191
[09/26 04:10:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.00	rocauc: 92.53	
[09/26 04:10:45 visual_prompt]: Training 18 / 100 epoch, with learning rate 0.4925739315689991
[09/26 04:10:52 visual_prompt]: Epoch 18 / 100: avg data time: 4.21e-02, avg batch time: 0.4889, average train loss: 0.4246
[09/26 04:10:53 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1674, average loss: 0.3807
[09/26 04:10:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 94.43	
[09/26 04:10:53 visual_prompt]: Training 19 / 100 epoch, with learning rate 0.4903154239845797
[09/26 04:11:00 visual_prompt]: Epoch 19 / 100: avg data time: 4.40e-02, avg batch time: 0.4892, average train loss: 0.2812
[09/26 04:11:01 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1676, average loss: 0.3269
[09/26 04:11:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.64	
[09/26 04:11:01 visual_prompt]: Training 20 / 100 epoch, with learning rate 0.4877641290737884
[09/26 04:11:08 visual_prompt]: Epoch 20 / 100: avg data time: 6.03e-02, avg batch time: 0.5044, average train loss: 0.2597
[09/26 04:11:09 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1675, average loss: 0.4604
[09/26 04:11:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 94.37	
[09/26 04:11:09 visual_prompt]: Training 21 / 100 epoch, with learning rate 0.4849231551964771
[09/26 04:11:16 visual_prompt]: Epoch 21 / 100: avg data time: 4.31e-02, avg batch time: 0.4885, average train loss: 0.2687
[09/26 04:11:17 visual_prompt]: Inference (val):avg data time: 4.05e-05, avg batch time: 0.1680, average loss: 0.3969
[09/26 04:11:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 94.31	
[09/26 04:11:17 visual_prompt]: Training 22 / 100 epoch, with learning rate 0.48179596364169686
[09/26 04:11:24 visual_prompt]: Epoch 22 / 100: avg data time: 4.78e-02, avg batch time: 0.4930, average train loss: 0.2328
[09/26 04:11:26 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1672, average loss: 0.4106
[09/26 04:11:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 94.20	
[09/26 04:11:26 visual_prompt]: Training 23 / 100 epoch, with learning rate 0.4783863644106502
[09/26 04:11:32 visual_prompt]: Epoch 23 / 100: avg data time: 4.35e-02, avg batch time: 0.4882, average train loss: 0.1767
[09/26 04:11:34 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1675, average loss: 0.3455
[09/26 04:11:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 94.98	
[09/26 04:11:34 visual_prompt]: Best epoch 23: best metric: 0.875
[09/26 04:11:34 visual_prompt]: Training 24 / 100 epoch, with learning rate 0.47469851157479176
[09/26 04:11:41 visual_prompt]: Epoch 24 / 100: avg data time: 4.57e-02, avg batch time: 0.4930, average train loss: 0.1933
[09/26 04:11:42 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1677, average loss: 1.0633
[09/26 04:11:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.50	rocauc: 88.20	
[09/26 04:11:42 visual_prompt]: Training 25 / 100 epoch, with learning rate 0.47073689821473175
[09/26 04:11:49 visual_prompt]: Epoch 25 / 100: avg data time: 5.21e-02, avg batch time: 0.4965, average train loss: 0.3634
[09/26 04:11:50 visual_prompt]: Inference (val):avg data time: 3.12e-05, avg batch time: 0.1680, average loss: 0.3504
[09/26 04:11:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 95.91	
[09/26 04:11:50 visual_prompt]: Training 26 / 100 epoch, with learning rate 0.4665063509461097
[09/26 04:11:57 visual_prompt]: Epoch 26 / 100: avg data time: 5.82e-02, avg batch time: 0.5023, average train loss: 0.2253
[09/26 04:11:59 visual_prompt]: Inference (val):avg data time: 3.08e-05, avg batch time: 0.1671, average loss: 0.4720
[09/26 04:11:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 95.34	
[09/26 04:11:59 visual_prompt]: Training 27 / 100 epoch, with learning rate 0.46201202403910646
[09/26 04:12:05 visual_prompt]: Epoch 27 / 100: avg data time: 6.01e-02, avg batch time: 0.5032, average train loss: 0.2344
[09/26 04:12:07 visual_prompt]: Inference (val):avg data time: 3.18e-05, avg batch time: 0.1675, average loss: 0.3620
[09/26 04:12:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 94.88	
[09/26 04:12:07 visual_prompt]: Best epoch 27: best metric: 0.885
[09/26 04:12:07 visual_prompt]: Training 28 / 100 epoch, with learning rate 0.4572593931387604
[09/26 04:12:13 visual_prompt]: Epoch 28 / 100: avg data time: 4.81e-02, avg batch time: 0.4918, average train loss: 0.2340
[09/26 04:12:15 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1673, average loss: 0.3161
[09/26 04:12:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 94.32	
[09/26 04:12:15 visual_prompt]: Training 29 / 100 epoch, with learning rate 0.45225424859373686
[09/26 04:12:22 visual_prompt]: Epoch 29 / 100: avg data time: 5.71e-02, avg batch time: 0.5028, average train loss: 0.1452
[09/26 04:12:23 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1674, average loss: 0.3577
[09/26 04:12:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.96	
[09/26 04:12:23 visual_prompt]: Training 30 / 100 epoch, with learning rate 0.44700268840168045
[09/26 04:12:30 visual_prompt]: Epoch 30 / 100: avg data time: 5.86e-02, avg batch time: 0.5031, average train loss: 0.1202
[09/26 04:12:31 visual_prompt]: Inference (val):avg data time: 3.15e-05, avg batch time: 0.1675, average loss: 0.4938
[09/26 04:12:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.70	
[09/26 04:12:31 visual_prompt]: Training 31 / 100 epoch, with learning rate 0.4415111107797445
[09/26 04:12:38 visual_prompt]: Epoch 31 / 100: avg data time: 5.56e-02, avg batch time: 0.4990, average train loss: 0.1067
[09/26 04:12:40 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1678, average loss: 0.4094
[09/26 04:12:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.52	
[09/26 04:12:40 visual_prompt]: Training 32 / 100 epoch, with learning rate 0.43578620636934856
[09/26 04:12:47 visual_prompt]: Epoch 32 / 100: avg data time: 5.77e-02, avg batch time: 0.5023, average train loss: 0.0842
[09/26 04:12:48 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1674, average loss: 0.4850
[09/26 04:12:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.09	
[09/26 04:12:48 visual_prompt]: Training 33 / 100 epoch, with learning rate 0.42983495008466277
[09/26 04:12:55 visual_prompt]: Epoch 33 / 100: avg data time: 4.77e-02, avg batch time: 0.4922, average train loss: 0.1352
[09/26 04:12:56 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1673, average loss: 0.4573
[09/26 04:12:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.64	
[09/26 04:12:56 visual_prompt]: Training 34 / 100 epoch, with learning rate 0.4236645926147493
[09/26 04:13:03 visual_prompt]: Epoch 34 / 100: avg data time: 6.03e-02, avg batch time: 0.5049, average train loss: 0.1093
[09/26 04:13:04 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1675, average loss: 0.3919
[09/26 04:13:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.57	
[09/26 04:13:04 visual_prompt]: Training 35 / 100 epoch, with learning rate 0.41728265158971456
[09/26 04:13:11 visual_prompt]: Epoch 35 / 100: avg data time: 5.25e-02, avg batch time: 0.4960, average train loss: 0.0504
[09/26 04:13:13 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1673, average loss: 0.8365
[09/26 04:13:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 90.80	
[09/26 04:13:13 visual_prompt]: Training 36 / 100 epoch, with learning rate 0.4106969024216348
[09/26 04:13:19 visual_prompt]: Epoch 36 / 100: avg data time: 5.76e-02, avg batch time: 0.5032, average train loss: 0.1105
[09/26 04:13:21 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1674, average loss: 0.4488
[09/26 04:13:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.65	
[09/26 04:13:21 visual_prompt]: Training 37 / 100 epoch, with learning rate 0.40391536883141455
[09/26 04:13:28 visual_prompt]: Epoch 37 / 100: avg data time: 5.36e-02, avg batch time: 0.4980, average train loss: 0.0673
[09/26 04:13:29 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1674, average loss: 0.4803
[09/26 04:13:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.84	
[09/26 04:13:29 visual_prompt]: Training 38 / 100 epoch, with learning rate 0.3969463130731183
[09/26 04:13:36 visual_prompt]: Epoch 38 / 100: avg data time: 5.00e-02, avg batch time: 0.4954, average train loss: 0.0857
[09/26 04:13:37 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1672, average loss: 0.7162
[09/26 04:13:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.79	
[09/26 04:13:37 visual_prompt]: Training 39 / 100 epoch, with learning rate 0.3897982258676867
[09/26 04:13:44 visual_prompt]: Epoch 39 / 100: avg data time: 4.27e-02, avg batch time: 0.4875, average train loss: 0.1010
[09/26 04:13:45 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1677, average loss: 0.3946
[09/26 04:13:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 95.85	
[09/26 04:13:45 visual_prompt]: Training 40 / 100 epoch, with learning rate 0.3824798160583012
[09/26 04:13:52 visual_prompt]: Epoch 40 / 100: avg data time: 4.71e-02, avg batch time: 0.4933, average train loss: 0.0817
[09/26 04:13:54 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1674, average loss: 0.5293
[09/26 04:13:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.17	
[09/26 04:13:54 visual_prompt]: Training 41 / 100 epoch, with learning rate 0.375
[09/26 04:14:00 visual_prompt]: Epoch 41 / 100: avg data time: 4.05e-02, avg batch time: 0.4861, average train loss: 0.0702
[09/26 04:14:02 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1672, average loss: 0.6642
[09/26 04:14:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.84	
[09/26 04:14:02 visual_prompt]: Training 42 / 100 epoch, with learning rate 0.3673678906964727
[09/26 04:14:08 visual_prompt]: Epoch 42 / 100: avg data time: 4.42e-02, avg batch time: 0.4898, average train loss: 0.0449
[09/26 04:14:10 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1674, average loss: 0.6594
[09/26 04:14:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.46	
[09/26 04:14:10 visual_prompt]: Training 43 / 100 epoch, with learning rate 0.35959278669726935
[09/26 04:14:17 visual_prompt]: Epoch 43 / 100: avg data time: 6.43e-02, avg batch time: 0.5079, average train loss: 0.0391
[09/26 04:14:18 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1676, average loss: 0.7833
[09/26 04:14:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.75	
[09/26 04:14:18 visual_prompt]: Training 44 / 100 epoch, with learning rate 0.3516841607689501
[09/26 04:14:25 visual_prompt]: Epoch 44 / 100: avg data time: 5.55e-02, avg batch time: 0.4996, average train loss: 0.0214
[09/26 04:14:26 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1679, average loss: 0.6341
[09/26 04:14:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.54	
[09/26 04:14:26 visual_prompt]: Training 45 / 100 epoch, with learning rate 0.34365164835397805
[09/26 04:14:33 visual_prompt]: Epoch 45 / 100: avg data time: 5.54e-02, avg batch time: 0.5002, average train loss: 0.0173
[09/26 04:14:35 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1675, average loss: 0.6834
[09/26 04:14:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 92.17	
[09/26 04:14:35 visual_prompt]: Training 46 / 100 epoch, with learning rate 0.3355050358314172
[09/26 04:14:41 visual_prompt]: Epoch 46 / 100: avg data time: 5.06e-02, avg batch time: 0.4947, average train loss: 0.0189
[09/26 04:14:43 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1674, average loss: 0.8343
[09/26 04:14:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.69	
[09/26 04:14:43 visual_prompt]: Training 47 / 100 epoch, with learning rate 0.32725424859373686
[09/26 04:14:50 visual_prompt]: Epoch 47 / 100: avg data time: 5.92e-02, avg batch time: 0.5032, average train loss: 0.0381
[09/26 04:14:51 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1673, average loss: 0.8330
[09/26 04:14:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.09	
[09/26 04:14:51 visual_prompt]: Training 48 / 100 epoch, with learning rate 0.3189093389542498
[09/26 04:14:58 visual_prompt]: Epoch 48 / 100: avg data time: 4.91e-02, avg batch time: 0.4933, average train loss: 0.0287
[09/26 04:14:59 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1676, average loss: 0.8390
[09/26 04:14:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.63	
[09/26 04:14:59 visual_prompt]: Training 49 / 100 epoch, with learning rate 0.3104804738999169
[09/26 04:15:06 visual_prompt]: Epoch 49 / 100: avg data time: 5.64e-02, avg batch time: 0.5028, average train loss: 0.0272
[09/26 04:15:08 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1677, average loss: 0.8563
[09/26 04:15:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 90.90	
[09/26 04:15:08 visual_prompt]: Training 50 / 100 epoch, with learning rate 0.3019779227044398
[09/26 04:15:14 visual_prompt]: Epoch 50 / 100: avg data time: 4.79e-02, avg batch time: 0.4921, average train loss: 0.0239
[09/26 04:15:16 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1676, average loss: 0.8236
[09/26 04:15:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.60	
[09/26 04:15:16 visual_prompt]: Training 51 / 100 epoch, with learning rate 0.29341204441673263
[09/26 04:15:23 visual_prompt]: Epoch 51 / 100: avg data time: 5.78e-02, avg batch time: 0.5015, average train loss: 0.0190
[09/26 04:15:24 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1674, average loss: 0.8027
[09/26 04:15:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 92.72	
[09/26 04:15:24 visual_prompt]: Training 52 / 100 epoch, with learning rate 0.28479327524001635
[09/26 04:15:31 visual_prompt]: Epoch 52 / 100: avg data time: 4.61e-02, avg batch time: 0.4905, average train loss: 0.0092
[09/26 04:15:32 visual_prompt]: Inference (val):avg data time: 4.82e-05, avg batch time: 0.1676, average loss: 0.8213
[09/26 04:15:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.26	
[09/26 04:15:32 visual_prompt]: Training 53 / 100 epoch, with learning rate 0.2761321158169134
[09/26 04:15:39 visual_prompt]: Epoch 53 / 100: avg data time: 5.39e-02, avg batch time: 0.4975, average train loss: 0.0020
[09/26 04:15:41 visual_prompt]: Inference (val):avg data time: 4.76e-05, avg batch time: 0.1677, average loss: 0.8913
[09/26 04:15:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 91.83	
[09/26 04:15:41 visual_prompt]: Training 54 / 100 epoch, with learning rate 0.2674391184360313
[09/26 04:15:47 visual_prompt]: Epoch 54 / 100: avg data time: 5.99e-02, avg batch time: 0.5043, average train loss: 0.0028
[09/26 04:15:49 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1676, average loss: 0.9302
[09/26 04:15:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.02	
[09/26 04:15:49 visual_prompt]: Training 55 / 100 epoch, with learning rate 0.2587248741756253
[09/26 04:15:56 visual_prompt]: Epoch 55 / 100: avg data time: 5.89e-02, avg batch time: 0.5035, average train loss: 0.0020
[09/26 04:15:57 visual_prompt]: Inference (val):avg data time: 3.13e-05, avg batch time: 0.1675, average loss: 0.9869
[09/26 04:15:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.68	
[09/26 04:15:57 visual_prompt]: Training 56 / 100 epoch, with learning rate 0.25
[09/26 04:16:04 visual_prompt]: Epoch 56 / 100: avg data time: 4.81e-02, avg batch time: 0.4922, average train loss: 0.0067
[09/26 04:16:05 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1674, average loss: 1.0389
[09/26 04:16:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.51	
[09/26 04:16:05 visual_prompt]: Training 57 / 100 epoch, with learning rate 0.24127512582437483
[09/26 04:16:12 visual_prompt]: Epoch 57 / 100: avg data time: 4.48e-02, avg batch time: 0.4905, average train loss: 0.1171
[09/26 04:16:13 visual_prompt]: Inference (val):avg data time: 3.54e-05, avg batch time: 0.1677, average loss: 1.1406
[09/26 04:16:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.50	rocauc: 92.54	
[09/26 04:16:13 visual_prompt]: Training 58 / 100 epoch, with learning rate 0.23256088156396867
[09/26 04:16:20 visual_prompt]: Epoch 58 / 100: avg data time: 4.34e-02, avg batch time: 0.4880, average train loss: 0.0765
[09/26 04:16:22 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1674, average loss: 0.5974
[09/26 04:16:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.39	
[09/26 04:16:22 visual_prompt]: Training 59 / 100 epoch, with learning rate 0.22386788418308667
[09/26 04:16:28 visual_prompt]: Epoch 59 / 100: avg data time: 5.72e-02, avg batch time: 0.5010, average train loss: 0.0247
[09/26 04:16:30 visual_prompt]: Inference (val):avg data time: 2.70e-05, avg batch time: 0.1678, average loss: 0.6977
[09/26 04:16:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.36	
[09/26 04:16:30 visual_prompt]: Training 60 / 100 epoch, with learning rate 0.2152067247599837
[09/26 04:16:37 visual_prompt]: Epoch 60 / 100: avg data time: 5.76e-02, avg batch time: 0.5012, average train loss: 0.0114
[09/26 04:16:38 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1676, average loss: 0.7823
[09/26 04:16:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.17	
[09/26 04:16:38 visual_prompt]: Training 61 / 100 epoch, with learning rate 0.20658795558326742
[09/26 04:16:45 visual_prompt]: Epoch 61 / 100: avg data time: 5.88e-02, avg batch time: 0.5024, average train loss: 0.0078
[09/26 04:16:46 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1673, average loss: 0.7246
[09/26 04:16:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.05	
[09/26 04:16:46 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.1980220772955602
[09/26 04:16:53 visual_prompt]: Epoch 62 / 100: avg data time: 4.36e-02, avg batch time: 0.4878, average train loss: 0.0128
[09/26 04:16:54 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1669, average loss: 0.8060
[09/26 04:16:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.68	
[09/26 04:16:54 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.1895195261000831
[09/26 04:17:01 visual_prompt]: Epoch 63 / 100: avg data time: 4.08e-02, avg batch time: 0.4895, average train loss: 0.0169
[09/26 04:17:02 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1673, average loss: 0.7014
[09/26 04:17:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 94.22	
[09/26 04:17:02 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.18109066104575022
[09/26 04:17:09 visual_prompt]: Epoch 64 / 100: avg data time: 5.60e-02, avg batch time: 0.5008, average train loss: 0.0031
[09/26 04:17:11 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1672, average loss: 0.7100
[09/26 04:17:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 94.12	
[09/26 04:17:11 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.17274575140626316
[09/26 04:17:17 visual_prompt]: Epoch 65 / 100: avg data time: 4.06e-02, avg batch time: 0.4856, average train loss: 0.0018
[09/26 04:17:19 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1672, average loss: 0.7112
[09/26 04:17:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 94.09	
[09/26 04:17:19 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.16449496416858284
[09/26 04:17:25 visual_prompt]: Epoch 66 / 100: avg data time: 5.99e-02, avg batch time: 0.5039, average train loss: 0.0010
[09/26 04:17:27 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1675, average loss: 0.7208
[09/26 04:17:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 94.05	
[09/26 04:17:27 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.15634835164602198
[09/26 04:17:34 visual_prompt]: Epoch 67 / 100: avg data time: 4.91e-02, avg batch time: 0.4934, average train loss: 0.0009
[09/26 04:17:35 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1672, average loss: 0.7343
[09/26 04:17:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 93.95	
[09/26 04:17:35 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.14831583923105
[09/26 04:17:42 visual_prompt]: Epoch 68 / 100: avg data time: 4.39e-02, avg batch time: 0.4895, average train loss: 0.0007
[09/26 04:17:43 visual_prompt]: Inference (val):avg data time: 4.70e-05, avg batch time: 0.1669, average loss: 0.7576
[09/26 04:17:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.84	
[09/26 04:17:43 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.14040721330273062
[09/26 04:17:50 visual_prompt]: Epoch 69 / 100: avg data time: 5.28e-02, avg batch time: 0.4970, average train loss: 0.0008
[09/26 04:17:51 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1678, average loss: 0.7663
[09/26 04:17:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.79	
[09/26 04:17:51 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.13263210930352737
[09/26 04:17:58 visual_prompt]: Epoch 70 / 100: avg data time: 4.38e-02, avg batch time: 0.4890, average train loss: 0.0008
[09/26 04:18:00 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1675, average loss: 0.7733
[09/26 04:18:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 93.79	
[09/26 04:18:00 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.12500000000000006
[09/26 04:18:06 visual_prompt]: Epoch 71 / 100: avg data time: 4.13e-02, avg batch time: 0.4878, average train loss: 0.0006
[09/26 04:18:08 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1674, average loss: 0.7800
[09/26 04:18:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 93.76	
[09/26 04:18:08 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.1175201839416988
[09/26 04:18:14 visual_prompt]: Epoch 72 / 100: avg data time: 3.84e-02, avg batch time: 0.4845, average train loss: 0.0005
[09/26 04:18:16 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1676, average loss: 0.7856
[09/26 04:18:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 93.75	
[09/26 04:18:16 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.11020177413231333
[09/26 04:18:22 visual_prompt]: Epoch 73 / 100: avg data time: 5.08e-02, avg batch time: 0.4951, average train loss: 0.0005
[09/26 04:18:24 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1674, average loss: 0.7903
[09/26 04:18:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.73	
[09/26 04:18:24 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.10305368692688174
[09/26 04:18:30 visual_prompt]: Epoch 74 / 100: avg data time: 4.22e-02, avg batch time: 0.4892, average train loss: 0.0005
[09/26 04:18:32 visual_prompt]: Inference (val):avg data time: 3.01e-05, avg batch time: 0.1673, average loss: 0.7943
[09/26 04:18:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.72	
[09/26 04:18:32 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.09608463116858543
[09/26 04:18:39 visual_prompt]: Epoch 75 / 100: avg data time: 6.24e-02, avg batch time: 0.5065, average train loss: 0.0005
[09/26 04:18:40 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1677, average loss: 0.7985
[09/26 04:18:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.71	
[09/26 04:18:40 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.08930309757836516
[09/26 04:18:47 visual_prompt]: Epoch 76 / 100: avg data time: 4.06e-02, avg batch time: 0.4854, average train loss: 0.0005
[09/26 04:18:48 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1679, average loss: 0.8017
[09/26 04:18:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.71	
[09/26 04:18:48 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.08271734841028552
[09/26 04:18:55 visual_prompt]: Epoch 77 / 100: avg data time: 5.74e-02, avg batch time: 0.5017, average train loss: 0.0005
[09/26 04:18:56 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1674, average loss: 0.8040
[09/26 04:18:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.73	
[09/26 04:18:56 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.07633540738525066
[09/26 04:19:03 visual_prompt]: Epoch 78 / 100: avg data time: 4.22e-02, avg batch time: 0.4867, average train loss: 0.0005
[09/26 04:19:05 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1674, average loss: 0.8059
[09/26 04:19:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.72	
[09/26 04:19:05 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.07016504991533726
[09/26 04:19:11 visual_prompt]: Epoch 79 / 100: avg data time: 4.61e-02, avg batch time: 0.4907, average train loss: 0.0004
[09/26 04:19:13 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1673, average loss: 0.8083
[09/26 04:19:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.70	
[09/26 04:19:13 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.06421379363065141
[09/26 04:19:19 visual_prompt]: Epoch 80 / 100: avg data time: 4.11e-02, avg batch time: 0.4872, average train loss: 0.0004
[09/26 04:19:21 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1677, average loss: 0.8121
[09/26 04:19:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.68	
[09/26 04:19:21 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.058488889220255524
[09/26 04:19:27 visual_prompt]: Epoch 81 / 100: avg data time: 4.15e-02, avg batch time: 0.4863, average train loss: 0.0005
[09/26 04:19:29 visual_prompt]: Inference (val):avg data time: 4.67e-05, avg batch time: 0.1676, average loss: 0.8141
[09/26 04:19:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.69	
[09/26 04:19:29 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.052997311598319524
[09/26 04:19:36 visual_prompt]: Epoch 82 / 100: avg data time: 5.24e-02, avg batch time: 0.4979, average train loss: 0.0004
[09/26 04:19:37 visual_prompt]: Inference (val):avg data time: 3.23e-05, avg batch time: 0.1674, average loss: 0.8158
[09/26 04:19:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.69	
[09/26 04:19:37 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.047745751406263165
[09/26 04:19:44 visual_prompt]: Epoch 83 / 100: avg data time: 5.26e-02, avg batch time: 0.4971, average train loss: 0.0005
[09/26 04:19:45 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1677, average loss: 0.8172
[09/26 04:19:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.69	
[09/26 04:19:45 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.042740606861239594
[09/26 04:19:52 visual_prompt]: Epoch 84 / 100: avg data time: 5.71e-02, avg batch time: 0.5019, average train loss: 0.0004
[09/26 04:19:54 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1675, average loss: 0.8187
[09/26 04:19:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.68	
[09/26 04:19:54 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.03798797596089351
[09/26 04:20:00 visual_prompt]: Epoch 85 / 100: avg data time: 5.50e-02, avg batch time: 0.4988, average train loss: 0.0004
[09/26 04:20:02 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1674, average loss: 0.8199
[09/26 04:20:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.67	
[09/26 04:20:02 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.03349364905389032
[09/26 04:20:09 visual_prompt]: Epoch 86 / 100: avg data time: 5.51e-02, avg batch time: 0.4988, average train loss: 0.0004
[09/26 04:20:10 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1674, average loss: 0.8209
[09/26 04:20:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.65	
[09/26 04:20:10 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.029263101785268253
[09/26 04:20:17 visual_prompt]: Epoch 87 / 100: avg data time: 5.99e-02, avg batch time: 0.5038, average train loss: 0.0004
[09/26 04:20:18 visual_prompt]: Inference (val):avg data time: 3.12e-05, avg batch time: 0.1682, average loss: 0.8216
[09/26 04:20:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.65	
[09/26 04:20:18 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.025301488425208296
[09/26 04:20:25 visual_prompt]: Epoch 88 / 100: avg data time: 4.18e-02, avg batch time: 0.4863, average train loss: 0.0004
[09/26 04:20:26 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1674, average loss: 0.8223
[09/26 04:20:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.64	
[09/26 04:20:26 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.021613635589349756
[09/26 04:20:33 visual_prompt]: Epoch 89 / 100: avg data time: 5.94e-02, avg batch time: 0.5034, average train loss: 0.0004
[09/26 04:20:35 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1674, average loss: 0.8230
[09/26 04:20:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.64	
[09/26 04:20:35 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.01820403635830317
[09/26 04:20:41 visual_prompt]: Epoch 90 / 100: avg data time: 4.94e-02, avg batch time: 0.4949, average train loss: 0.0004
[09/26 04:20:43 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1673, average loss: 0.8236
[09/26 04:20:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.63	
[09/26 04:20:43 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.01507684480352292
[09/26 04:20:49 visual_prompt]: Epoch 91 / 100: avg data time: 4.85e-02, avg batch time: 0.4940, average train loss: 0.0004
[09/26 04:20:51 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1675, average loss: 0.8240
[09/26 04:20:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.63	
[09/26 04:20:51 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.012235870926211617
[09/26 04:20:58 visual_prompt]: Epoch 92 / 100: avg data time: 6.39e-02, avg batch time: 0.5077, average train loss: 0.0004
[09/26 04:20:59 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1675, average loss: 0.8244
[09/26 04:20:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.63	
[09/26 04:20:59 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.009684576015420276
[09/26 04:21:06 visual_prompt]: Epoch 93 / 100: avg data time: 4.24e-02, avg batch time: 0.4874, average train loss: 0.0004
[09/26 04:21:07 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1673, average loss: 0.8247
[09/26 04:21:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.63	
[09/26 04:21:07 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.007426068431000882
[09/26 04:21:14 visual_prompt]: Epoch 94 / 100: avg data time: 5.49e-02, avg batch time: 0.5001, average train loss: 0.0004
[09/26 04:21:16 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1674, average loss: 0.8249
[09/26 04:21:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.64	
[09/26 04:21:16 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.005463099816548578
[09/26 04:21:22 visual_prompt]: Epoch 95 / 100: avg data time: 5.89e-02, avg batch time: 0.5034, average train loss: 0.0004
[09/26 04:21:24 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1671, average loss: 0.8250
[09/26 04:21:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.64	
[09/26 04:21:24 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.003798061746947995
[09/26 04:21:30 visual_prompt]: Epoch 96 / 100: avg data time: 4.49e-02, avg batch time: 0.4894, average train loss: 0.0004
[09/26 04:21:32 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1671, average loss: 0.8252
[09/26 04:21:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.64	
[09/26 04:21:32 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.0024329828146074095
[09/26 04:21:39 visual_prompt]: Epoch 97 / 100: avg data time: 4.73e-02, avg batch time: 0.4927, average train loss: 0.0004
[09/26 04:21:40 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1676, average loss: 0.8252
[09/26 04:21:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.64	
[09/26 04:21:40 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.0013695261579316775
[09/26 04:21:47 visual_prompt]: Epoch 98 / 100: avg data time: 4.96e-02, avg batch time: 0.4945, average train loss: 0.0004
[09/26 04:21:48 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1678, average loss: 0.8252
[09/26 04:21:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.64	
[09/26 04:21:48 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.0006089874350439506
[09/26 04:21:55 visual_prompt]: Epoch 99 / 100: avg data time: 5.85e-02, avg batch time: 0.5031, average train loss: 0.0004
[09/26 04:21:57 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1676, average loss: 0.8253
[09/26 04:21:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.64	
[09/26 04:21:57 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.00015229324522605947
[09/26 04:22:03 visual_prompt]: Epoch 100 / 100: avg data time: 4.72e-02, avg batch time: 0.4928, average train loss: 0.0004
[09/26 04:22:05 visual_prompt]: Inference (val):avg data time: 2.73e-05, avg batch time: 0.1673, average loss: 0.8253
[09/26 04:22:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.64	
[09/26 04:22:05 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 04:22:05 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 04:22:05 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 04:22:05 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 04:22:05 visual_prompt]: Training with config:
[09/26 04:22:05 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr0.25_wd0.01/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.01, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 0.25, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 04:22:05 visual_prompt]: Loading training data...
[09/26 04:22:05 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 04:22:06 visual_prompt]: Number of images: 800
[09/26 04:22:06 visual_prompt]: Number of classes: 2 / 2
[09/26 04:22:06 visual_prompt]: Loading validation data...
[09/26 04:22:06 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 04:22:06 visual_prompt]: Number of images: 200
[09/26 04:22:06 visual_prompt]: Number of classes: 2 / 2
[09/26 04:22:06 visual_prompt]: Constructing models...
[09/26 04:22:09 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 04:22:09 visual_prompt]: tuned percent:0.536
[09/26 04:22:09 visual_prompt]: Device used for model: 0
[09/26 04:22:09 visual_prompt]: Setting up Evaluator...
[09/26 04:22:09 visual_prompt]: Setting up Trainer...
[09/26 04:22:09 visual_prompt]: 	Setting up the optimizer...
[09/26 04:22:09 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 04:22:15 visual_prompt]: Epoch 1 / 100: avg data time: 4.29e-02, avg batch time: 0.4867, average train loss: 1.9680
[09/26 04:22:17 visual_prompt]: Inference (val):avg data time: 3.27e-05, avg batch time: 0.1669, average loss: 2.0033
[09/26 04:22:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 04:22:17 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 04:22:17 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.025
[09/26 04:22:24 visual_prompt]: Epoch 2 / 100: avg data time: 5.51e-02, avg batch time: 0.4992, average train loss: 2.1966
[09/26 04:22:25 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1671, average loss: 0.6549
[09/26 04:22:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.00	rocauc: 70.28	
[09/26 04:22:25 visual_prompt]: Best epoch 2: best metric: 0.650
[09/26 04:22:25 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.05
[09/26 04:22:32 visual_prompt]: Epoch 3 / 100: avg data time: 4.37e-02, avg batch time: 0.4889, average train loss: 0.7278
[09/26 04:22:33 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1672, average loss: 0.6185
[09/26 04:22:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.50	rocauc: 85.51	
[09/26 04:22:33 visual_prompt]: Best epoch 3: best metric: 0.775
[09/26 04:22:33 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.075
[09/26 04:22:40 visual_prompt]: Epoch 4 / 100: avg data time: 5.86e-02, avg batch time: 0.5020, average train loss: 0.6831
[09/26 04:22:41 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1672, average loss: 0.6919
[09/26 04:22:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 88.97	
[09/26 04:22:41 visual_prompt]: Training 5 / 100 epoch, with learning rate 0.1
[09/26 04:22:48 visual_prompt]: Epoch 5 / 100: avg data time: 5.63e-02, avg batch time: 0.5000, average train loss: 0.6066
[09/26 04:22:50 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1670, average loss: 0.5061
[09/26 04:22:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.00	rocauc: 90.37	
[09/26 04:22:50 visual_prompt]: Training 6 / 100 epoch, with learning rate 0.125
[09/26 04:22:56 visual_prompt]: Epoch 6 / 100: avg data time: 4.02e-02, avg batch time: 0.4834, average train loss: 0.5489
[09/26 04:22:58 visual_prompt]: Inference (val):avg data time: 3.79e-05, avg batch time: 0.1671, average loss: 0.5072
[09/26 04:22:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.50	rocauc: 90.74	
[09/26 04:22:58 visual_prompt]: Training 7 / 100 epoch, with learning rate 0.15
[09/26 04:23:04 visual_prompt]: Epoch 7 / 100: avg data time: 5.34e-02, avg batch time: 0.4969, average train loss: 0.5333
[09/26 04:23:06 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1670, average loss: 0.4060
[09/26 04:23:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.66	
[09/26 04:23:06 visual_prompt]: Best epoch 7: best metric: 0.825
[09/26 04:23:06 visual_prompt]: Training 8 / 100 epoch, with learning rate 0.175
[09/26 04:23:13 visual_prompt]: Epoch 8 / 100: avg data time: 5.43e-02, avg batch time: 0.4990, average train loss: 0.5346
[09/26 04:23:14 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1673, average loss: 0.7682
[09/26 04:23:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.50	rocauc: 91.59	
[09/26 04:23:14 visual_prompt]: Training 9 / 100 epoch, with learning rate 0.2
[09/26 04:23:21 visual_prompt]: Epoch 9 / 100: avg data time: 4.22e-02, avg batch time: 0.4875, average train loss: 0.5819
[09/26 04:23:22 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1677, average loss: 0.4065
[09/26 04:23:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.33	
[09/26 04:23:22 visual_prompt]: Best epoch 9: best metric: 0.835
[09/26 04:23:22 visual_prompt]: Training 10 / 100 epoch, with learning rate 0.225
[09/26 04:23:29 visual_prompt]: Epoch 10 / 100: avg data time: 4.81e-02, avg batch time: 0.4927, average train loss: 0.6473
[09/26 04:23:30 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1672, average loss: 0.6366
[09/26 04:23:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 87.61	
[09/26 04:23:30 visual_prompt]: Training 11 / 100 epoch, with learning rate 0.25
[09/26 04:23:37 visual_prompt]: Epoch 11 / 100: avg data time: 4.39e-02, avg batch time: 0.4874, average train loss: 0.6841
[09/26 04:23:38 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1674, average loss: 0.5841
[09/26 04:23:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 71.50	rocauc: 90.09	
[09/26 04:23:38 visual_prompt]: Training 12 / 100 epoch, with learning rate 0.24992385337738698
[09/26 04:23:45 visual_prompt]: Epoch 12 / 100: avg data time: 4.45e-02, avg batch time: 0.4893, average train loss: 0.6202
[09/26 04:23:47 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1674, average loss: 0.6187
[09/26 04:23:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.50	rocauc: 77.07	
[09/26 04:23:47 visual_prompt]: Training 13 / 100 epoch, with learning rate 0.24969550628247802
[09/26 04:23:53 visual_prompt]: Epoch 13 / 100: avg data time: 5.00e-02, avg batch time: 0.4940, average train loss: 0.8443
[09/26 04:23:55 visual_prompt]: Inference (val):avg data time: 2.79e-05, avg batch time: 0.1671, average loss: 0.6792
[09/26 04:23:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 62.00	rocauc: 86.06	
[09/26 04:23:55 visual_prompt]: Training 14 / 100 epoch, with learning rate 0.24931523692103416
[09/26 04:24:01 visual_prompt]: Epoch 14 / 100: avg data time: 5.02e-02, avg batch time: 0.4930, average train loss: 0.7238
[09/26 04:24:03 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1676, average loss: 0.6613
[09/26 04:24:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.00	rocauc: 86.06	
[09/26 04:24:03 visual_prompt]: Training 15 / 100 epoch, with learning rate 0.2487835085926963
[09/26 04:24:10 visual_prompt]: Epoch 15 / 100: avg data time: 5.78e-02, avg batch time: 0.5012, average train loss: 0.6886
[09/26 04:24:11 visual_prompt]: Inference (val):avg data time: 3.12e-05, avg batch time: 0.1671, average loss: 0.6806
[09/26 04:24:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 56.50	rocauc: 88.13	
[09/26 04:24:11 visual_prompt]: Training 16 / 100 epoch, with learning rate 0.24810096912652602
[09/26 04:24:18 visual_prompt]: Epoch 16 / 100: avg data time: 5.50e-02, avg batch time: 0.5001, average train loss: 0.6343
[09/26 04:24:19 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1674, average loss: 0.7321
[09/26 04:24:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 87.30	
[09/26 04:24:19 visual_prompt]: Training 17 / 100 epoch, with learning rate 0.2472684500917257
[09/26 04:24:26 visual_prompt]: Epoch 17 / 100: avg data time: 5.58e-02, avg batch time: 0.4990, average train loss: 0.7175
[09/26 04:24:28 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1673, average loss: 0.6781
[09/26 04:24:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.25	
[09/26 04:24:28 visual_prompt]: Training 18 / 100 epoch, with learning rate 0.24628696578449955
[09/26 04:24:35 visual_prompt]: Epoch 18 / 100: avg data time: 6.09e-02, avg batch time: 0.5043, average train loss: 0.6780
[09/26 04:24:36 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1672, average loss: 0.6906
[09/26 04:24:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 88.09	
[09/26 04:24:36 visual_prompt]: Training 19 / 100 epoch, with learning rate 0.24515771199228986
[09/26 04:24:43 visual_prompt]: Epoch 19 / 100: avg data time: 4.18e-02, avg batch time: 0.4856, average train loss: 0.6995
[09/26 04:24:44 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1675, average loss: 0.8064
[09/26 04:24:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.11	
[09/26 04:24:44 visual_prompt]: Training 20 / 100 epoch, with learning rate 0.2438820645368942
[09/26 04:24:51 visual_prompt]: Epoch 20 / 100: avg data time: 4.80e-02, avg batch time: 0.4938, average train loss: 0.6616
[09/26 04:24:52 visual_prompt]: Inference (val):avg data time: 3.15e-05, avg batch time: 0.1676, average loss: 0.6626
[09/26 04:24:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.00	rocauc: 90.91	
[09/26 04:24:52 visual_prompt]: Training 21 / 100 epoch, with learning rate 0.24246157759823855
[09/26 04:24:59 visual_prompt]: Epoch 21 / 100: avg data time: 4.41e-02, avg batch time: 0.4904, average train loss: 0.6841
[09/26 04:25:00 visual_prompt]: Inference (val):avg data time: 2.79e-05, avg batch time: 0.1676, average loss: 0.6782
[09/26 04:25:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 81.94	
[09/26 04:25:00 visual_prompt]: Training 22 / 100 epoch, with learning rate 0.24089798182084843
[09/26 04:25:07 visual_prompt]: Epoch 22 / 100: avg data time: 6.32e-02, avg batch time: 0.5073, average train loss: 0.7008
[09/26 04:25:09 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1673, average loss: 0.6876
[09/26 04:25:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.63	
[09/26 04:25:09 visual_prompt]: Training 23 / 100 epoch, with learning rate 0.2391931822053251
[09/26 04:25:16 visual_prompt]: Epoch 23 / 100: avg data time: 5.50e-02, avg batch time: 0.4988, average train loss: 0.6986
[09/26 04:25:17 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1675, average loss: 0.6215
[09/26 04:25:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 68.50	rocauc: 83.56	
[09/26 04:25:17 visual_prompt]: Training 24 / 100 epoch, with learning rate 0.23734925578739588
[09/26 04:25:24 visual_prompt]: Epoch 24 / 100: avg data time: 5.98e-02, avg batch time: 0.5031, average train loss: 0.7060
[09/26 04:25:25 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1674, average loss: 0.7006
[09/26 04:25:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 81.39	
[09/26 04:25:25 visual_prompt]: Training 25 / 100 epoch, with learning rate 0.23536844910736587
[09/26 04:25:32 visual_prompt]: Epoch 25 / 100: avg data time: 5.23e-02, avg batch time: 0.4956, average train loss: 0.7043
[09/26 04:25:34 visual_prompt]: Inference (val):avg data time: 3.24e-05, avg batch time: 0.1674, average loss: 0.6554
[09/26 04:25:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 64.50	rocauc: 86.46	
[09/26 04:25:34 visual_prompt]: Training 26 / 100 epoch, with learning rate 0.23325317547305485
[09/26 04:25:40 visual_prompt]: Epoch 26 / 100: avg data time: 5.47e-02, avg batch time: 0.4989, average train loss: 0.6888
[09/26 04:25:42 visual_prompt]: Inference (val):avg data time: 2.95e-05, avg batch time: 0.1675, average loss: 0.6768
[09/26 04:25:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 55.00	rocauc: 86.21	
[09/26 04:25:42 visual_prompt]: Training 27 / 100 epoch, with learning rate 0.23100601201955323
[09/26 04:25:48 visual_prompt]: Epoch 27 / 100: avg data time: 4.76e-02, avg batch time: 0.4938, average train loss: 0.6601
[09/26 04:25:50 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1672, average loss: 0.5962
[09/26 04:25:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 69.00	rocauc: 85.09	
[09/26 04:25:50 visual_prompt]: Training 28 / 100 epoch, with learning rate 0.2286296965693802
[09/26 04:25:57 visual_prompt]: Epoch 28 / 100: avg data time: 5.98e-02, avg batch time: 0.5033, average train loss: 0.6841
[09/26 04:25:58 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1672, average loss: 0.6444
[09/26 04:25:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.50	rocauc: 88.04	
[09/26 04:25:58 visual_prompt]: Training 29 / 100 epoch, with learning rate 0.22612712429686843
[09/26 04:26:05 visual_prompt]: Epoch 29 / 100: avg data time: 5.75e-02, avg batch time: 0.5013, average train loss: 0.6772
[09/26 04:26:06 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1672, average loss: 0.6262
[09/26 04:26:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.50	rocauc: 89.65	
[09/26 04:26:06 visual_prompt]: Training 30 / 100 epoch, with learning rate 0.22350134420084022
[09/26 04:26:13 visual_prompt]: Epoch 30 / 100: avg data time: 6.08e-02, avg batch time: 0.5045, average train loss: 0.6561
[09/26 04:26:15 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1673, average loss: 0.6148
[09/26 04:26:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 56.50	rocauc: 89.22	
[09/26 04:26:15 visual_prompt]: Training 31 / 100 epoch, with learning rate 0.22075555538987224
[09/26 04:26:21 visual_prompt]: Epoch 31 / 100: avg data time: 4.91e-02, avg batch time: 0.4931, average train loss: 0.6642
[09/26 04:26:23 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1674, average loss: 0.5899
[09/26 04:26:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 91.22	
[09/26 04:26:23 visual_prompt]: Best epoch 31: best metric: 0.855
[09/26 04:26:23 visual_prompt]: Training 32 / 100 epoch, with learning rate 0.21789310318467428
[09/26 04:26:30 visual_prompt]: Epoch 32 / 100: avg data time: 5.42e-02, avg batch time: 0.4981, average train loss: 0.6365
[09/26 04:26:31 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1675, average loss: 0.6039
[09/26 04:26:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 61.50	rocauc: 87.44	
[09/26 04:26:31 visual_prompt]: Training 33 / 100 epoch, with learning rate 0.21491747504233139
[09/26 04:26:38 visual_prompt]: Epoch 33 / 100: avg data time: 5.65e-02, avg batch time: 0.5008, average train loss: 0.7107
[09/26 04:26:39 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1671, average loss: 0.6608
[09/26 04:26:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.00	rocauc: 86.66	
[09/26 04:26:39 visual_prompt]: Training 34 / 100 epoch, with learning rate 0.21183229630737466
[09/26 04:26:46 visual_prompt]: Epoch 34 / 100: avg data time: 5.33e-02, avg batch time: 0.4979, average train loss: 0.6562
[09/26 04:26:47 visual_prompt]: Inference (val):avg data time: 2.95e-05, avg batch time: 0.1673, average loss: 0.7425
[09/26 04:26:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 83.86	
[09/26 04:26:47 visual_prompt]: Training 35 / 100 epoch, with learning rate 0.20864132579485728
[09/26 04:26:54 visual_prompt]: Epoch 35 / 100: avg data time: 6.05e-02, avg batch time: 0.5036, average train loss: 0.6815
[09/26 04:26:56 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1671, average loss: 0.6538
[09/26 04:26:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.50	rocauc: 86.36	
[09/26 04:26:56 visual_prompt]: Training 36 / 100 epoch, with learning rate 0.2053484512108174
[09/26 04:27:02 visual_prompt]: Epoch 36 / 100: avg data time: 5.01e-02, avg batch time: 0.4942, average train loss: 0.6406
[09/26 04:27:04 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1670, average loss: 0.8477
[09/26 04:27:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 61.00	rocauc: 89.45	
[09/26 04:27:04 visual_prompt]: Training 37 / 100 epoch, with learning rate 0.20195768441570727
[09/26 04:27:10 visual_prompt]: Epoch 37 / 100: avg data time: 5.51e-02, avg batch time: 0.5005, average train loss: 0.7140
[09/26 04:27:12 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1671, average loss: 0.8968
[09/26 04:27:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 87.96	
[09/26 04:27:12 visual_prompt]: Training 38 / 100 epoch, with learning rate 0.19847315653655914
[09/26 04:27:19 visual_prompt]: Epoch 38 / 100: avg data time: 5.74e-02, avg batch time: 0.5004, average train loss: 0.8008
[09/26 04:27:20 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1676, average loss: 0.6642
[09/26 04:27:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.50	rocauc: 84.73	
[09/26 04:27:20 visual_prompt]: Training 39 / 100 epoch, with learning rate 0.19489911293384335
[09/26 04:27:27 visual_prompt]: Epoch 39 / 100: avg data time: 4.40e-02, avg batch time: 0.4899, average train loss: 0.6808
[09/26 04:27:28 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1674, average loss: 0.6246
[09/26 04:27:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 56.00	rocauc: 82.77	
[09/26 04:27:28 visual_prompt]: Training 40 / 100 epoch, with learning rate 0.1912399080291506
[09/26 04:27:35 visual_prompt]: Epoch 40 / 100: avg data time: 5.45e-02, avg batch time: 0.4982, average train loss: 0.6581
[09/26 04:27:37 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1674, average loss: 0.5827
[09/26 04:27:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 69.50	rocauc: 88.11	
[09/26 04:27:37 visual_prompt]: Training 41 / 100 epoch, with learning rate 0.1875
[09/26 04:27:43 visual_prompt]: Epoch 41 / 100: avg data time: 5.43e-02, avg batch time: 0.4975, average train loss: 0.6907
[09/26 04:27:45 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1672, average loss: 0.6656
[09/26 04:27:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 61.50	rocauc: 73.71	
[09/26 04:27:45 visual_prompt]: Training 42 / 100 epoch, with learning rate 0.18368394534823634
[09/26 04:27:52 visual_prompt]: Epoch 42 / 100: avg data time: 5.83e-02, avg batch time: 0.5023, average train loss: 0.6769
[09/26 04:27:53 visual_prompt]: Inference (val):avg data time: 3.10e-05, avg batch time: 0.1672, average loss: 0.5964
[09/26 04:27:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 69.50	rocauc: 85.27	
[09/26 04:27:53 visual_prompt]: Training 43 / 100 epoch, with learning rate 0.17979639334863468
[09/26 04:28:00 visual_prompt]: Epoch 43 / 100: avg data time: 5.23e-02, avg batch time: 0.4960, average train loss: 0.6899
[09/26 04:28:01 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1672, average loss: 0.6864
[09/26 04:28:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.40	
[09/26 04:28:01 visual_prompt]: Training 44 / 100 epoch, with learning rate 0.17584208038447505
[09/26 04:28:08 visual_prompt]: Epoch 44 / 100: avg data time: 4.81e-02, avg batch time: 0.4924, average train loss: 0.6874
[09/26 04:28:09 visual_prompt]: Inference (val):avg data time: 3.08e-05, avg batch time: 0.1677, average loss: 0.7319
[09/26 04:28:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 63.34	
[09/26 04:28:09 visual_prompt]: Training 45 / 100 epoch, with learning rate 0.17182582417698902
[09/26 04:28:16 visual_prompt]: Epoch 45 / 100: avg data time: 5.62e-02, avg batch time: 0.4997, average train loss: 0.6999
[09/26 04:28:18 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1673, average loss: 0.8097
[09/26 04:28:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 83.78	
[09/26 04:28:18 visual_prompt]: Training 46 / 100 epoch, with learning rate 0.1677525179157086
[09/26 04:28:24 visual_prompt]: Epoch 46 / 100: avg data time: 5.86e-02, avg batch time: 0.5015, average train loss: 0.7321
[09/26 04:28:26 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1675, average loss: 0.7161
[09/26 04:28:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 82.29	
[09/26 04:28:26 visual_prompt]: Training 47 / 100 epoch, with learning rate 0.16362712429686843
[09/26 04:28:33 visual_prompt]: Epoch 47 / 100: avg data time: 5.45e-02, avg batch time: 0.4975, average train loss: 0.7040
[09/26 04:28:34 visual_prompt]: Inference (val):avg data time: 3.04e-05, avg batch time: 0.1673, average loss: 0.7155
[09/26 04:28:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 81.85	
[09/26 04:28:34 visual_prompt]: Training 48 / 100 epoch, with learning rate 0.1594546694771249
[09/26 04:28:41 visual_prompt]: Epoch 48 / 100: avg data time: 4.18e-02, avg batch time: 0.4857, average train loss: 0.6927
[09/26 04:28:42 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1672, average loss: 0.6704
[09/26 04:28:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 62.00	rocauc: 83.04	
[09/26 04:28:42 visual_prompt]: Training 49 / 100 epoch, with learning rate 0.15524023694995845
[09/26 04:28:49 visual_prompt]: Epoch 49 / 100: avg data time: 5.54e-02, avg batch time: 0.4991, average train loss: 0.6800
[09/26 04:28:51 visual_prompt]: Inference (val):avg data time: 3.08e-05, avg batch time: 0.1673, average loss: 0.7348
[09/26 04:28:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.50	
[09/26 04:28:51 visual_prompt]: Training 50 / 100 epoch, with learning rate 0.1509889613522199
[09/26 04:28:57 visual_prompt]: Epoch 50 / 100: avg data time: 5.50e-02, avg batch time: 0.4998, average train loss: 0.7077
[09/26 04:28:59 visual_prompt]: Inference (val):avg data time: 3.04e-05, avg batch time: 0.1675, average loss: 0.6865
[09/26 04:28:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 61.50	rocauc: 65.30	
[09/26 04:28:59 visual_prompt]: Training 51 / 100 epoch, with learning rate 0.14670602220836632
[09/26 04:29:06 visual_prompt]: Epoch 51 / 100: avg data time: 5.54e-02, avg batch time: 0.4987, average train loss: 0.7072
[09/26 04:29:07 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1673, average loss: 0.7386
[09/26 04:29:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 86.33	
[09/26 04:29:07 visual_prompt]: Training 52 / 100 epoch, with learning rate 0.14239663762000818
[09/26 04:29:14 visual_prompt]: Epoch 52 / 100: avg data time: 4.64e-02, avg batch time: 0.4916, average train loss: 0.7253
[09/26 04:29:15 visual_prompt]: Inference (val):avg data time: 3.15e-05, avg batch time: 0.1673, average loss: 0.6947
[09/26 04:29:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.81	
[09/26 04:29:15 visual_prompt]: Training 53 / 100 epoch, with learning rate 0.1380660579084567
[09/26 04:29:22 visual_prompt]: Epoch 53 / 100: avg data time: 4.83e-02, avg batch time: 0.4928, average train loss: 0.7024
[09/26 04:29:23 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1671, average loss: 0.6817
[09/26 04:29:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 81.59	
[09/26 04:29:23 visual_prompt]: Training 54 / 100 epoch, with learning rate 0.13371955921801565
[09/26 04:29:30 visual_prompt]: Epoch 54 / 100: avg data time: 6.10e-02, avg batch time: 0.5053, average train loss: 0.6896
[09/26 04:29:32 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1670, average loss: 0.6943
[09/26 04:29:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 82.57	
[09/26 04:29:32 visual_prompt]: Training 55 / 100 epoch, with learning rate 0.12936243708781264
[09/26 04:29:38 visual_prompt]: Epoch 55 / 100: avg data time: 4.89e-02, avg batch time: 0.4930, average train loss: 0.6834
[09/26 04:29:40 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1672, average loss: 0.6169
[09/26 04:29:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 68.50	rocauc: 80.43	
[09/26 04:29:40 visual_prompt]: Training 56 / 100 epoch, with learning rate 0.125
[09/26 04:29:47 visual_prompt]: Epoch 56 / 100: avg data time: 4.95e-02, avg batch time: 0.4933, average train loss: 0.6948
[09/26 04:29:48 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1673, average loss: 0.6523
[09/26 04:29:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 53.50	rocauc: 86.13	
[09/26 04:29:48 visual_prompt]: Training 57 / 100 epoch, with learning rate 0.12063756291218741
[09/26 04:29:55 visual_prompt]: Epoch 57 / 100: avg data time: 4.30e-02, avg batch time: 0.4898, average train loss: 0.6956
[09/26 04:29:56 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1673, average loss: 0.6879
[09/26 04:29:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 49.00	rocauc: 80.85	
[09/26 04:29:56 visual_prompt]: Training 58 / 100 epoch, with learning rate 0.11628044078198434
[09/26 04:30:03 visual_prompt]: Epoch 58 / 100: avg data time: 4.22e-02, avg batch time: 0.4859, average train loss: 0.6922
[09/26 04:30:04 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1676, average loss: 0.6448
[09/26 04:30:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 80.78	
[09/26 04:30:04 visual_prompt]: Training 59 / 100 epoch, with learning rate 0.11193394209154334
[09/26 04:30:11 visual_prompt]: Epoch 59 / 100: avg data time: 4.50e-02, avg batch time: 0.4892, average train loss: 0.6876
[09/26 04:30:12 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1672, average loss: 0.6953
[09/26 04:30:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 87.49	
[09/26 04:30:12 visual_prompt]: Training 60 / 100 epoch, with learning rate 0.10760336237999185
[09/26 04:30:19 visual_prompt]: Epoch 60 / 100: avg data time: 4.19e-02, avg batch time: 0.4874, average train loss: 0.7603
[09/26 04:30:20 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1670, average loss: 0.7160
[09/26 04:30:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 85.42	
[09/26 04:30:20 visual_prompt]: Training 61 / 100 epoch, with learning rate 0.10329397779163371
[09/26 04:30:27 visual_prompt]: Epoch 61 / 100: avg data time: 4.20e-02, avg batch time: 0.4865, average train loss: 0.7033
[09/26 04:30:28 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1673, average loss: 0.7412
[09/26 04:30:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.47	
[09/26 04:30:28 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.0990110386477801
[09/26 04:30:35 visual_prompt]: Epoch 62 / 100: avg data time: 4.23e-02, avg batch time: 0.4862, average train loss: 0.7163
[09/26 04:30:36 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1672, average loss: 0.7036
[09/26 04:30:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 83.34	
[09/26 04:30:36 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.09475976305004155
[09/26 04:30:43 visual_prompt]: Epoch 63 / 100: avg data time: 4.68e-02, avg batch time: 0.4904, average train loss: 0.6948
[09/26 04:30:44 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1671, average loss: 0.6727
[09/26 04:30:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 63.50	rocauc: 84.74	
[09/26 04:30:44 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.09054533052287511
[09/26 04:30:51 visual_prompt]: Epoch 64 / 100: avg data time: 4.15e-02, avg batch time: 0.4852, average train loss: 0.6700
[09/26 04:30:52 visual_prompt]: Inference (val):avg data time: 3.59e-05, avg batch time: 0.1675, average loss: 0.6087
[09/26 04:30:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 69.00	rocauc: 85.47	
[09/26 04:30:52 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.08637287570313158
[09/26 04:30:59 visual_prompt]: Epoch 65 / 100: avg data time: 4.70e-02, avg batch time: 0.4916, average train loss: 0.6908
[09/26 04:31:01 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1673, average loss: 0.6728
[09/26 04:31:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.10	
[09/26 04:31:01 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.08224748208429142
[09/26 04:31:07 visual_prompt]: Epoch 66 / 100: avg data time: 4.50e-02, avg batch time: 0.4899, average train loss: 0.7051
[09/26 04:31:09 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1676, average loss: 0.6886
[09/26 04:31:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 78.98	
[09/26 04:31:09 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.07817417582301099
[09/26 04:31:15 visual_prompt]: Epoch 67 / 100: avg data time: 5.83e-02, avg batch time: 0.5017, average train loss: 0.6850
[09/26 04:31:17 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1675, average loss: 0.6567
[09/26 04:31:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.50	rocauc: 82.68	
[09/26 04:31:17 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.074157919615525
[09/26 04:31:24 visual_prompt]: Epoch 68 / 100: avg data time: 4.70e-02, avg batch time: 0.4928, average train loss: 0.6582
[09/26 04:31:25 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1674, average loss: 0.6149
[09/26 04:31:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 64.50	rocauc: 81.81	
[09/26 04:31:25 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.07020360665136531
[09/26 04:31:32 visual_prompt]: Epoch 69 / 100: avg data time: 5.35e-02, avg batch time: 0.4983, average train loss: 0.6563
[09/26 04:31:33 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1675, average loss: 0.5968
[09/26 04:31:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.50	rocauc: 84.82	
[09/26 04:31:33 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.06631605465176368
[09/26 04:31:40 visual_prompt]: Epoch 70 / 100: avg data time: 5.55e-02, avg batch time: 0.4987, average train loss: 0.6491
[09/26 04:31:42 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1671, average loss: 0.6015
[09/26 04:31:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 87.51	
[09/26 04:31:42 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.06250000000000003
[09/26 04:31:48 visual_prompt]: Epoch 71 / 100: avg data time: 5.53e-02, avg batch time: 0.4993, average train loss: 0.6373
[09/26 04:31:50 visual_prompt]: Inference (val):avg data time: 3.10e-05, avg batch time: 0.1673, average loss: 0.6483
[09/26 04:31:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 62.00	rocauc: 87.37	
[09/26 04:31:50 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.0587600919708494
[09/26 04:31:57 visual_prompt]: Epoch 72 / 100: avg data time: 4.48e-02, avg batch time: 0.4911, average train loss: 0.6339
[09/26 04:31:58 visual_prompt]: Inference (val):avg data time: 3.07e-05, avg batch time: 0.1674, average loss: 0.6183
[09/26 04:31:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 49.50	rocauc: 87.23	
[09/26 04:31:58 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.055100887066156665
[09/26 04:32:05 visual_prompt]: Epoch 73 / 100: avg data time: 3.93e-02, avg batch time: 0.4874, average train loss: 0.5560
[09/26 04:32:06 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1675, average loss: 0.5111
[09/26 04:32:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.50	rocauc: 88.17	
[09/26 04:32:06 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.05152684346344087
[09/26 04:32:13 visual_prompt]: Epoch 74 / 100: avg data time: 5.53e-02, avg batch time: 0.4990, average train loss: 0.5892
[09/26 04:32:14 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1675, average loss: 0.8217
[09/26 04:32:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 59.00	rocauc: 89.62	
[09/26 04:32:14 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.048042315584292714
[09/26 04:32:21 visual_prompt]: Epoch 75 / 100: avg data time: 4.67e-02, avg batch time: 0.4929, average train loss: 0.5593
[09/26 04:32:22 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1674, average loss: 0.4710
[09/26 04:32:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.50	rocauc: 89.70	
[09/26 04:32:22 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.04465154878918258
[09/26 04:32:29 visual_prompt]: Epoch 76 / 100: avg data time: 4.88e-02, avg batch time: 0.4928, average train loss: 0.5532
[09/26 04:32:30 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1674, average loss: 0.5230
[09/26 04:32:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.50	rocauc: 89.82	
[09/26 04:32:30 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.04135867420514276
[09/26 04:32:37 visual_prompt]: Epoch 77 / 100: avg data time: 5.67e-02, avg batch time: 0.5015, average train loss: 0.5848
[09/26 04:32:39 visual_prompt]: Inference (val):avg data time: 3.19e-05, avg batch time: 0.1675, average loss: 0.4789
[09/26 04:32:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 89.69	
[09/26 04:32:39 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.03816770369262533
[09/26 04:32:45 visual_prompt]: Epoch 78 / 100: avg data time: 5.66e-02, avg batch time: 0.5002, average train loss: 0.5413
[09/26 04:32:47 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1677, average loss: 0.6802
[09/26 04:32:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 64.00	rocauc: 90.60	
[09/26 04:32:47 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.03508252495766863
[09/26 04:32:54 visual_prompt]: Epoch 79 / 100: avg data time: 4.69e-02, avg batch time: 0.4915, average train loss: 0.5538
[09/26 04:32:55 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1675, average loss: 0.4224
[09/26 04:32:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 90.97	
[09/26 04:32:55 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.032106896815325706
[09/26 04:33:02 visual_prompt]: Epoch 80 / 100: avg data time: 4.53e-02, avg batch time: 0.4913, average train loss: 0.4965
[09/26 04:33:03 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1672, average loss: 0.5373
[09/26 04:33:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.50	rocauc: 90.85	
[09/26 04:33:03 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.029244444610127762
[09/26 04:33:10 visual_prompt]: Epoch 81 / 100: avg data time: 4.89e-02, avg batch time: 0.4947, average train loss: 0.4956
[09/26 04:33:11 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1677, average loss: 0.4346
[09/26 04:33:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.00	rocauc: 91.07	
[09/26 04:33:11 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.026498655799159762
[09/26 04:33:18 visual_prompt]: Epoch 82 / 100: avg data time: 4.19e-02, avg batch time: 0.4870, average train loss: 0.5225
[09/26 04:33:19 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1674, average loss: 0.4387
[09/26 04:33:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 91.28	
[09/26 04:33:19 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.023872875703131582
[09/26 04:33:26 visual_prompt]: Epoch 83 / 100: avg data time: 4.87e-02, avg batch time: 0.4945, average train loss: 0.5013
[09/26 04:33:28 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1673, average loss: 0.3986
[09/26 04:33:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 91.46	
[09/26 04:33:28 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.021370303430619797
[09/26 04:33:34 visual_prompt]: Epoch 84 / 100: avg data time: 4.31e-02, avg batch time: 0.4897, average train loss: 0.5402
[09/26 04:33:36 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1673, average loss: 0.4174
[09/26 04:33:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.17	
[09/26 04:33:36 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.018993987980446755
[09/26 04:33:42 visual_prompt]: Epoch 85 / 100: avg data time: 5.93e-02, avg batch time: 0.5033, average train loss: 0.4891
[09/26 04:33:44 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1674, average loss: 0.4152
[09/26 04:33:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.38	
[09/26 04:33:44 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.01674682452694516
[09/26 04:33:51 visual_prompt]: Epoch 86 / 100: avg data time: 5.51e-02, avg batch time: 0.4994, average train loss: 0.4653
[09/26 04:33:52 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1672, average loss: 0.3999
[09/26 04:33:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 90.92	
[09/26 04:33:52 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.014631550892634126
[09/26 04:33:59 visual_prompt]: Epoch 87 / 100: avg data time: 5.21e-02, avg batch time: 0.4976, average train loss: 0.4534
[09/26 04:34:00 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1672, average loss: 0.3827
[09/26 04:34:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.42	
[09/26 04:34:00 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.012650744212604148
[09/26 04:34:07 visual_prompt]: Epoch 88 / 100: avg data time: 4.78e-02, avg batch time: 0.4921, average train loss: 0.4832
[09/26 04:34:08 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1677, average loss: 0.4519
[09/26 04:34:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 91.70	
[09/26 04:34:08 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.010806817794674878
[09/26 04:34:15 visual_prompt]: Epoch 89 / 100: avg data time: 4.02e-02, avg batch time: 0.4865, average train loss: 0.4513
[09/26 04:34:17 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1673, average loss: 0.3930
[09/26 04:34:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.47	
[09/26 04:34:17 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.009102018179151586
[09/26 04:34:23 visual_prompt]: Epoch 90 / 100: avg data time: 4.42e-02, avg batch time: 0.4879, average train loss: 0.4483
[09/26 04:34:25 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1677, average loss: 0.3852
[09/26 04:34:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.77	
[09/26 04:34:25 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.00753842240176146
[09/26 04:34:31 visual_prompt]: Epoch 91 / 100: avg data time: 3.88e-02, avg batch time: 0.4858, average train loss: 0.4419
[09/26 04:34:33 visual_prompt]: Inference (val):avg data time: 3.30e-05, avg batch time: 0.1678, average loss: 0.3737
[09/26 04:34:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.23	
[09/26 04:34:33 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.006117935463105809
[09/26 04:34:39 visual_prompt]: Epoch 92 / 100: avg data time: 4.06e-02, avg batch time: 0.4865, average train loss: 0.4269
[09/26 04:34:41 visual_prompt]: Inference (val):avg data time: 3.10e-05, avg batch time: 0.1673, average loss: 0.4361
[09/26 04:34:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 92.38	
[09/26 04:34:41 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.004842288007710138
[09/26 04:34:48 visual_prompt]: Epoch 93 / 100: avg data time: 5.91e-02, avg batch time: 0.5037, average train loss: 0.4192
[09/26 04:34:49 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1673, average loss: 0.4419
[09/26 04:34:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 92.11	
[09/26 04:34:49 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.003713034215500441
[09/26 04:34:56 visual_prompt]: Epoch 94 / 100: avg data time: 4.37e-02, avg batch time: 0.4896, average train loss: 0.4051
[09/26 04:34:57 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1674, average loss: 0.3645
[09/26 04:34:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 92.04	
[09/26 04:34:57 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.002731549908274289
[09/26 04:35:04 visual_prompt]: Epoch 95 / 100: avg data time: 4.63e-02, avg batch time: 0.4911, average train loss: 0.3969
[09/26 04:35:05 visual_prompt]: Inference (val):avg data time: 3.20e-05, avg batch time: 0.1676, average loss: 0.3859
[09/26 04:35:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 91.29	
[09/26 04:35:05 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.0018990308734739975
[09/26 04:35:12 visual_prompt]: Epoch 96 / 100: avg data time: 4.60e-02, avg batch time: 0.4897, average train loss: 0.4124
[09/26 04:35:13 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1679, average loss: 0.3835
[09/26 04:35:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.96	
[09/26 04:35:13 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.0012164914073037048
[09/26 04:35:20 visual_prompt]: Epoch 97 / 100: avg data time: 5.75e-02, avg batch time: 0.5013, average train loss: 0.3727
[09/26 04:35:22 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1676, average loss: 0.3798
[09/26 04:35:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.87	
[09/26 04:35:22 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.0006847630789658388
[09/26 04:35:28 visual_prompt]: Epoch 98 / 100: avg data time: 5.82e-02, avg batch time: 0.5019, average train loss: 0.3690
[09/26 04:35:30 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1676, average loss: 0.4129
[09/26 04:35:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.91	
[09/26 04:35:30 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.0003044937175219753
[09/26 04:35:37 visual_prompt]: Epoch 99 / 100: avg data time: 5.40e-02, avg batch time: 0.4984, average train loss: 0.3578
[09/26 04:35:38 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1676, average loss: 0.4080
[09/26 04:35:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.85	
[09/26 04:35:38 visual_prompt]: Training 100 / 100 epoch, with learning rate 7.614662261302974e-05
[09/26 04:35:45 visual_prompt]: Epoch 100 / 100: avg data time: 6.27e-02, avg batch time: 0.5068, average train loss: 0.3581
[09/26 04:35:47 visual_prompt]: Inference (val):avg data time: 3.36e-05, avg batch time: 0.1673, average loss: 0.4112
[09/26 04:35:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.84	
[09/26 04:35:47 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 04:35:47 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 04:35:47 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 04:35:47 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 04:35:47 visual_prompt]: Training with config:
[09/26 04:35:47 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr0.25_wd0.001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 0.25, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 04:35:47 visual_prompt]: Loading training data...
[09/26 04:35:47 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 04:35:48 visual_prompt]: Number of images: 800
[09/26 04:35:48 visual_prompt]: Number of classes: 2 / 2
[09/26 04:35:48 visual_prompt]: Loading validation data...
[09/26 04:35:48 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 04:35:48 visual_prompt]: Number of images: 200
[09/26 04:35:48 visual_prompt]: Number of classes: 2 / 2
[09/26 04:35:48 visual_prompt]: Constructing models...
[09/26 04:35:51 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 04:35:51 visual_prompt]: tuned percent:0.536
[09/26 04:35:51 visual_prompt]: Device used for model: 0
[09/26 04:35:51 visual_prompt]: Setting up Evaluator...
[09/26 04:35:51 visual_prompt]: Setting up Trainer...
[09/26 04:35:51 visual_prompt]: 	Setting up the optimizer...
[09/26 04:35:51 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 04:35:57 visual_prompt]: Epoch 1 / 100: avg data time: 5.13e-02, avg batch time: 0.4950, average train loss: 1.9923
[09/26 04:35:59 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1666, average loss: 2.0033
[09/26 04:35:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 04:35:59 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 04:35:59 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.025
[09/26 04:36:06 visual_prompt]: Epoch 2 / 100: avg data time: 5.93e-02, avg batch time: 0.5035, average train loss: 2.1638
[09/26 04:36:07 visual_prompt]: Inference (val):avg data time: 6.86e-05, avg batch time: 0.1672, average loss: 0.7053
[09/26 04:36:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 49.50	rocauc: 63.48	
[09/26 04:36:07 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.05
[09/26 04:36:14 visual_prompt]: Epoch 3 / 100: avg data time: 4.77e-02, avg batch time: 0.4904, average train loss: 0.7315
[09/26 04:36:15 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1671, average loss: 0.6179
[09/26 04:36:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 63.50	rocauc: 84.95	
[09/26 04:36:15 visual_prompt]: Best epoch 3: best metric: 0.635
[09/26 04:36:15 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.075
[09/26 04:36:22 visual_prompt]: Epoch 4 / 100: avg data time: 5.47e-02, avg batch time: 0.4987, average train loss: 0.6245
[09/26 04:36:23 visual_prompt]: Inference (val):avg data time: 3.17e-05, avg batch time: 0.1671, average loss: 0.4682
[09/26 04:36:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 89.59	
[09/26 04:36:23 visual_prompt]: Best epoch 4: best metric: 0.800
[09/26 04:36:23 visual_prompt]: Training 5 / 100 epoch, with learning rate 0.1
[09/26 04:36:30 visual_prompt]: Epoch 5 / 100: avg data time: 4.62e-02, avg batch time: 0.4888, average train loss: 0.5976
[09/26 04:36:31 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1671, average loss: 0.5220
[09/26 04:36:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 89.87	
[09/26 04:36:31 visual_prompt]: Training 6 / 100 epoch, with learning rate 0.125
[09/26 04:36:38 visual_prompt]: Epoch 6 / 100: avg data time: 4.08e-02, avg batch time: 0.4865, average train loss: 0.4987
[09/26 04:36:40 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1672, average loss: 0.4133
[09/26 04:36:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 90.20	
[09/26 04:36:40 visual_prompt]: Best epoch 6: best metric: 0.805
[09/26 04:36:40 visual_prompt]: Training 7 / 100 epoch, with learning rate 0.15
[09/26 04:36:46 visual_prompt]: Epoch 7 / 100: avg data time: 4.78e-02, avg batch time: 0.4931, average train loss: 0.5076
[09/26 04:36:48 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1672, average loss: 0.6571
[09/26 04:36:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.00	rocauc: 90.20	
[09/26 04:36:48 visual_prompt]: Training 8 / 100 epoch, with learning rate 0.175
[09/26 04:36:54 visual_prompt]: Epoch 8 / 100: avg data time: 4.38e-02, avg batch time: 0.4891, average train loss: 0.5992
[09/26 04:36:56 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1672, average loss: 0.6667
[09/26 04:36:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 64.00	rocauc: 91.77	
[09/26 04:36:56 visual_prompt]: Training 9 / 100 epoch, with learning rate 0.2
[09/26 04:37:03 visual_prompt]: Epoch 9 / 100: avg data time: 4.67e-02, avg batch time: 0.4927, average train loss: 0.5421
[09/26 04:37:04 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1673, average loss: 0.4633
[09/26 04:37:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 91.02	
[09/26 04:37:04 visual_prompt]: Training 10 / 100 epoch, with learning rate 0.225
[09/26 04:37:11 visual_prompt]: Epoch 10 / 100: avg data time: 4.99e-02, avg batch time: 0.4933, average train loss: 0.5180
[09/26 04:37:12 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1672, average loss: 0.5068
[09/26 04:37:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.50	rocauc: 91.23	
[09/26 04:37:12 visual_prompt]: Training 11 / 100 epoch, with learning rate 0.25
[09/26 04:37:19 visual_prompt]: Epoch 11 / 100: avg data time: 4.72e-02, avg batch time: 0.4923, average train loss: 0.5335
[09/26 04:37:20 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1672, average loss: 0.3717
[09/26 04:37:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.20	
[09/26 04:37:20 visual_prompt]: Best epoch 11: best metric: 0.855
[09/26 04:37:20 visual_prompt]: Training 12 / 100 epoch, with learning rate 0.24992385337738698
[09/26 04:37:27 visual_prompt]: Epoch 12 / 100: avg data time: 5.33e-02, avg batch time: 0.4976, average train loss: 0.4199
[09/26 04:37:29 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1673, average loss: 0.3467
[09/26 04:37:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.40	
[09/26 04:37:29 visual_prompt]: Training 13 / 100 epoch, with learning rate 0.24969550628247802
[09/26 04:37:35 visual_prompt]: Epoch 13 / 100: avg data time: 4.21e-02, avg batch time: 0.4878, average train loss: 0.3857
[09/26 04:37:37 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1673, average loss: 0.4353
[09/26 04:37:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 92.97	
[09/26 04:37:37 visual_prompt]: Training 14 / 100 epoch, with learning rate 0.24931523692103416
[09/26 04:37:43 visual_prompt]: Epoch 14 / 100: avg data time: 4.33e-02, avg batch time: 0.4891, average train loss: 0.4487
[09/26 04:37:45 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1673, average loss: 0.5346
[09/26 04:37:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 93.15	
[09/26 04:37:45 visual_prompt]: Training 15 / 100 epoch, with learning rate 0.2487835085926963
[09/26 04:37:51 visual_prompt]: Epoch 15 / 100: avg data time: 5.09e-02, avg batch time: 0.4952, average train loss: 0.4298
[09/26 04:37:53 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1674, average loss: 0.3886
[09/26 04:37:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 93.49	
[09/26 04:37:53 visual_prompt]: Training 16 / 100 epoch, with learning rate 0.24810096912652602
[09/26 04:38:00 visual_prompt]: Epoch 16 / 100: avg data time: 5.82e-02, avg batch time: 0.5021, average train loss: 0.4945
[09/26 04:38:01 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1670, average loss: 0.4507
[09/26 04:38:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.50	rocauc: 94.11	
[09/26 04:38:01 visual_prompt]: Training 17 / 100 epoch, with learning rate 0.2472684500917257
[09/26 04:38:08 visual_prompt]: Epoch 17 / 100: avg data time: 4.69e-02, avg batch time: 0.4921, average train loss: 0.3828
[09/26 04:38:09 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1673, average loss: 0.3641
[09/26 04:38:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.75	
[09/26 04:38:09 visual_prompt]: Training 18 / 100 epoch, with learning rate 0.24628696578449955
[09/26 04:38:16 visual_prompt]: Epoch 18 / 100: avg data time: 4.78e-02, avg batch time: 0.4927, average train loss: 0.3342
[09/26 04:38:17 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1674, average loss: 0.3840
[09/26 04:38:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.02	
[09/26 04:38:17 visual_prompt]: Training 19 / 100 epoch, with learning rate 0.24515771199228986
[09/26 04:38:24 visual_prompt]: Epoch 19 / 100: avg data time: 5.43e-02, avg batch time: 0.4980, average train loss: 0.3257
[09/26 04:38:26 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1675, average loss: 0.3395
[09/26 04:38:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.42	
[09/26 04:38:26 visual_prompt]: Training 20 / 100 epoch, with learning rate 0.2438820645368942
[09/26 04:38:32 visual_prompt]: Epoch 20 / 100: avg data time: 4.68e-02, avg batch time: 0.4918, average train loss: 0.3005
[09/26 04:38:34 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1676, average loss: 0.4173
[09/26 04:38:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 93.87	
[09/26 04:38:34 visual_prompt]: Training 21 / 100 epoch, with learning rate 0.24246157759823855
[09/26 04:38:40 visual_prompt]: Epoch 21 / 100: avg data time: 5.77e-02, avg batch time: 0.5018, average train loss: 0.3404
[09/26 04:38:42 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1672, average loss: 0.3453
[09/26 04:38:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.45	
[09/26 04:38:42 visual_prompt]: Best epoch 21: best metric: 0.860
[09/26 04:38:42 visual_prompt]: Training 22 / 100 epoch, with learning rate 0.24089798182084843
[09/26 04:38:49 visual_prompt]: Epoch 22 / 100: avg data time: 4.46e-02, avg batch time: 0.4894, average train loss: 0.2747
[09/26 04:38:50 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1678, average loss: 0.5109
[09/26 04:38:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 92.65	
[09/26 04:38:50 visual_prompt]: Training 23 / 100 epoch, with learning rate 0.2391931822053251
[09/26 04:38:57 visual_prompt]: Epoch 23 / 100: avg data time: 4.79e-02, avg batch time: 0.4931, average train loss: 0.3180
[09/26 04:38:58 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1671, average loss: 0.3066
[09/26 04:38:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 95.45	
[09/26 04:38:58 visual_prompt]: Training 24 / 100 epoch, with learning rate 0.23734925578739588
[09/26 04:39:05 visual_prompt]: Epoch 24 / 100: avg data time: 4.33e-02, avg batch time: 0.4876, average train loss: 0.2367
[09/26 04:39:06 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1675, average loss: 0.4187
[09/26 04:39:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.46	
[09/26 04:39:06 visual_prompt]: Training 25 / 100 epoch, with learning rate 0.23536844910736587
[09/26 04:39:13 visual_prompt]: Epoch 25 / 100: avg data time: 4.20e-02, avg batch time: 0.4879, average train loss: 0.2175
[09/26 04:39:14 visual_prompt]: Inference (val):avg data time: 2.76e-05, avg batch time: 0.1675, average loss: 0.4271
[09/26 04:39:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.71	
[09/26 04:39:14 visual_prompt]: Training 26 / 100 epoch, with learning rate 0.23325317547305485
[09/26 04:39:21 visual_prompt]: Epoch 26 / 100: avg data time: 4.38e-02, avg batch time: 0.4890, average train loss: 0.3285
[09/26 04:39:22 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1676, average loss: 0.3116
[09/26 04:39:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.28	
[09/26 04:39:22 visual_prompt]: Best epoch 26: best metric: 0.870
[09/26 04:39:22 visual_prompt]: Training 27 / 100 epoch, with learning rate 0.23100601201955323
[09/26 04:39:29 visual_prompt]: Epoch 27 / 100: avg data time: 4.48e-02, avg batch time: 0.4904, average train loss: 0.2491
[09/26 04:39:31 visual_prompt]: Inference (val):avg data time: 5.84e-05, avg batch time: 0.1686, average loss: 0.3407
[09/26 04:39:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.88	
[09/26 04:39:31 visual_prompt]: Training 28 / 100 epoch, with learning rate 0.2286296965693802
[09/26 04:39:37 visual_prompt]: Epoch 28 / 100: avg data time: 4.12e-02, avg batch time: 0.4873, average train loss: 0.2376
[09/26 04:39:39 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1675, average loss: 0.3592
[09/26 04:39:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.62	
[09/26 04:39:39 visual_prompt]: Training 29 / 100 epoch, with learning rate 0.22612712429686843
[09/26 04:39:45 visual_prompt]: Epoch 29 / 100: avg data time: 4.95e-02, avg batch time: 0.4942, average train loss: 0.2034
[09/26 04:39:47 visual_prompt]: Inference (val):avg data time: 3.23e-05, avg batch time: 0.1674, average loss: 0.5082
[09/26 04:39:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.78	
[09/26 04:39:47 visual_prompt]: Training 30 / 100 epoch, with learning rate 0.22350134420084022
[09/26 04:39:54 visual_prompt]: Epoch 30 / 100: avg data time: 4.79e-02, avg batch time: 0.4919, average train loss: 0.1893
[09/26 04:39:55 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1677, average loss: 0.3832
[09/26 04:39:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.62	
[09/26 04:39:55 visual_prompt]: Training 31 / 100 epoch, with learning rate 0.22075555538987224
[09/26 04:40:02 visual_prompt]: Epoch 31 / 100: avg data time: 5.91e-02, avg batch time: 0.5028, average train loss: 0.1711
[09/26 04:40:03 visual_prompt]: Inference (val):avg data time: 4.24e-05, avg batch time: 0.1677, average loss: 0.3322
[09/26 04:40:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 95.15	
[09/26 04:40:03 visual_prompt]: Best epoch 31: best metric: 0.875
[09/26 04:40:03 visual_prompt]: Training 32 / 100 epoch, with learning rate 0.21789310318467428
[09/26 04:40:10 visual_prompt]: Epoch 32 / 100: avg data time: 6.16e-02, avg batch time: 0.5053, average train loss: 0.2357
[09/26 04:40:12 visual_prompt]: Inference (val):avg data time: 3.50e-05, avg batch time: 0.1675, average loss: 0.3893
[09/26 04:40:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 93.66	
[09/26 04:40:12 visual_prompt]: Training 33 / 100 epoch, with learning rate 0.21491747504233139
[09/26 04:40:18 visual_prompt]: Epoch 33 / 100: avg data time: 5.43e-02, avg batch time: 0.4991, average train loss: 0.2265
[09/26 04:40:20 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1675, average loss: 0.3884
[09/26 04:40:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.31	
[09/26 04:40:20 visual_prompt]: Training 34 / 100 epoch, with learning rate 0.21183229630737466
[09/26 04:40:27 visual_prompt]: Epoch 34 / 100: avg data time: 5.97e-02, avg batch time: 0.5039, average train loss: 0.1655
[09/26 04:40:28 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1677, average loss: 1.0668
[09/26 04:40:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.00	rocauc: 93.99	
[09/26 04:40:28 visual_prompt]: Training 35 / 100 epoch, with learning rate 0.20864132579485728
[09/26 04:40:35 visual_prompt]: Epoch 35 / 100: avg data time: 4.31e-02, avg batch time: 0.4875, average train loss: 0.2952
[09/26 04:40:36 visual_prompt]: Inference (val):avg data time: 3.08e-05, avg batch time: 0.1673, average loss: 0.3823
[09/26 04:40:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.19	
[09/26 04:40:36 visual_prompt]: Training 36 / 100 epoch, with learning rate 0.2053484512108174
[09/26 04:40:43 visual_prompt]: Epoch 36 / 100: avg data time: 6.12e-02, avg batch time: 0.5044, average train loss: 0.1417
[09/26 04:40:45 visual_prompt]: Inference (val):avg data time: 5.18e-05, avg batch time: 0.1678, average loss: 0.4590
[09/26 04:40:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.03	
[09/26 04:40:45 visual_prompt]: Training 37 / 100 epoch, with learning rate 0.20195768441570727
[09/26 04:40:51 visual_prompt]: Epoch 37 / 100: avg data time: 4.46e-02, avg batch time: 0.4895, average train loss: 0.1078
[09/26 04:40:53 visual_prompt]: Inference (val):avg data time: 4.05e-05, avg batch time: 0.1675, average loss: 0.5199
[09/26 04:40:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.92	
[09/26 04:40:53 visual_prompt]: Training 38 / 100 epoch, with learning rate 0.19847315653655914
[09/26 04:40:59 visual_prompt]: Epoch 38 / 100: avg data time: 4.83e-02, avg batch time: 0.4937, average train loss: 0.1170
[09/26 04:41:01 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1671, average loss: 0.3775
[09/26 04:41:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.90	
[09/26 04:41:01 visual_prompt]: Training 39 / 100 epoch, with learning rate 0.19489911293384335
[09/26 04:41:08 visual_prompt]: Epoch 39 / 100: avg data time: 4.35e-02, avg batch time: 0.4889, average train loss: 0.1193
[09/26 04:41:09 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1677, average loss: 0.4476
[09/26 04:41:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 90.58	
[09/26 04:41:09 visual_prompt]: Training 40 / 100 epoch, with learning rate 0.1912399080291506
[09/26 04:41:16 visual_prompt]: Epoch 40 / 100: avg data time: 4.28e-02, avg batch time: 0.4878, average train loss: 0.1476
[09/26 04:41:17 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1673, average loss: 0.3526
[09/26 04:41:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 96.10	
[09/26 04:41:17 visual_prompt]: Best epoch 40: best metric: 0.880
[09/26 04:41:17 visual_prompt]: Training 41 / 100 epoch, with learning rate 0.1875
[09/26 04:41:24 visual_prompt]: Epoch 41 / 100: avg data time: 4.85e-02, avg batch time: 0.4924, average train loss: 0.0919
[09/26 04:41:25 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1677, average loss: 0.9851
[09/26 04:41:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.50	rocauc: 93.40	
[09/26 04:41:25 visual_prompt]: Training 42 / 100 epoch, with learning rate 0.18368394534823634
[09/26 04:41:32 visual_prompt]: Epoch 42 / 100: avg data time: 6.27e-02, avg batch time: 0.5068, average train loss: 0.2438
[09/26 04:41:34 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1675, average loss: 0.4138
[09/26 04:41:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.90	
[09/26 04:41:34 visual_prompt]: Training 43 / 100 epoch, with learning rate 0.17979639334863468
[09/26 04:41:40 visual_prompt]: Epoch 43 / 100: avg data time: 4.31e-02, avg batch time: 0.4880, average train loss: 0.1422
[09/26 04:41:42 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.1675, average loss: 0.4743
[09/26 04:41:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 91.86	
[09/26 04:41:42 visual_prompt]: Training 44 / 100 epoch, with learning rate 0.17584208038447505
[09/26 04:41:49 visual_prompt]: Epoch 44 / 100: avg data time: 6.41e-02, avg batch time: 0.5085, average train loss: 0.1256
[09/26 04:41:50 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1672, average loss: 0.4089
[09/26 04:41:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 95.43	
[09/26 04:41:50 visual_prompt]: Training 45 / 100 epoch, with learning rate 0.17182582417698902
[09/26 04:41:57 visual_prompt]: Epoch 45 / 100: avg data time: 5.67e-02, avg batch time: 0.5012, average train loss: 0.1186
[09/26 04:41:58 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1671, average loss: 0.3140
[09/26 04:41:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 90.00	rocauc: 94.70	
[09/26 04:41:58 visual_prompt]: Best epoch 45: best metric: 0.900
[09/26 04:41:58 visual_prompt]: Training 46 / 100 epoch, with learning rate 0.1677525179157086
[09/26 04:42:05 visual_prompt]: Epoch 46 / 100: avg data time: 4.52e-02, avg batch time: 0.4913, average train loss: 0.1329
[09/26 04:42:06 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1673, average loss: 0.5395
[09/26 04:42:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 90.67	
[09/26 04:42:06 visual_prompt]: Training 47 / 100 epoch, with learning rate 0.16362712429686843
[09/26 04:42:13 visual_prompt]: Epoch 47 / 100: avg data time: 6.37e-02, avg batch time: 0.5086, average train loss: 0.0642
[09/26 04:42:15 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1674, average loss: 0.4838
[09/26 04:42:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.13	
[09/26 04:42:15 visual_prompt]: Training 48 / 100 epoch, with learning rate 0.1594546694771249
[09/26 04:42:21 visual_prompt]: Epoch 48 / 100: avg data time: 4.04e-02, avg batch time: 0.4854, average train loss: 0.0304
[09/26 04:42:23 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1677, average loss: 0.7690
[09/26 04:42:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 87.84	
[09/26 04:42:23 visual_prompt]: Training 49 / 100 epoch, with learning rate 0.15524023694995845
[09/26 04:42:30 visual_prompt]: Epoch 49 / 100: avg data time: 5.37e-02, avg batch time: 0.4991, average train loss: 0.0977
[09/26 04:42:31 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1677, average loss: 0.8559
[09/26 04:42:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 91.95	
[09/26 04:42:31 visual_prompt]: Training 50 / 100 epoch, with learning rate 0.1509889613522199
[09/26 04:42:38 visual_prompt]: Epoch 50 / 100: avg data time: 5.71e-02, avg batch time: 0.5024, average train loss: 0.1731
[09/26 04:42:39 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1675, average loss: 0.4133
[09/26 04:42:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.78	
[09/26 04:42:39 visual_prompt]: Training 51 / 100 epoch, with learning rate 0.14670602220836632
[09/26 04:42:46 visual_prompt]: Epoch 51 / 100: avg data time: 4.61e-02, avg batch time: 0.4920, average train loss: 0.1130
[09/26 04:42:48 visual_prompt]: Inference (val):avg data time: 2.08e-05, avg batch time: 0.1674, average loss: 0.4296
[09/26 04:42:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 94.38	
[09/26 04:42:48 visual_prompt]: Training 52 / 100 epoch, with learning rate 0.14239663762000818
[09/26 04:42:54 visual_prompt]: Epoch 52 / 100: avg data time: 5.10e-02, avg batch time: 0.4962, average train loss: 0.0537
[09/26 04:42:56 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1679, average loss: 0.5128
[09/26 04:42:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.31	
[09/26 04:42:56 visual_prompt]: Training 53 / 100 epoch, with learning rate 0.1380660579084567
[09/26 04:43:02 visual_prompt]: Epoch 53 / 100: avg data time: 4.23e-02, avg batch time: 0.4886, average train loss: 0.0381
[09/26 04:43:04 visual_prompt]: Inference (val):avg data time: 2.79e-05, avg batch time: 0.1676, average loss: 0.5838
[09/26 04:43:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 91.82	
[09/26 04:43:04 visual_prompt]: Training 54 / 100 epoch, with learning rate 0.13371955921801565
[09/26 04:43:10 visual_prompt]: Epoch 54 / 100: avg data time: 5.34e-02, avg batch time: 0.4977, average train loss: 0.0240
[09/26 04:43:12 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1672, average loss: 0.5903
[09/26 04:43:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 92.22	
[09/26 04:43:12 visual_prompt]: Training 55 / 100 epoch, with learning rate 0.12936243708781264
[09/26 04:43:19 visual_prompt]: Epoch 55 / 100: avg data time: 4.36e-02, avg batch time: 0.4908, average train loss: 0.0961
[09/26 04:43:20 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1674, average loss: 0.5187
[09/26 04:43:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.86	
[09/26 04:43:20 visual_prompt]: Training 56 / 100 epoch, with learning rate 0.125
[09/26 04:43:27 visual_prompt]: Epoch 56 / 100: avg data time: 5.52e-02, avg batch time: 0.4991, average train loss: 0.0700
[09/26 04:43:28 visual_prompt]: Inference (val):avg data time: 3.91e-05, avg batch time: 0.1675, average loss: 0.5101
[09/26 04:43:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.95	
[09/26 04:43:28 visual_prompt]: Training 57 / 100 epoch, with learning rate 0.12063756291218741
[09/26 04:43:35 visual_prompt]: Epoch 57 / 100: avg data time: 5.79e-02, avg batch time: 0.5032, average train loss: 0.1317
[09/26 04:43:37 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1674, average loss: 0.3773
[09/26 04:43:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 94.02	
[09/26 04:43:37 visual_prompt]: Training 58 / 100 epoch, with learning rate 0.11628044078198434
[09/26 04:43:43 visual_prompt]: Epoch 58 / 100: avg data time: 4.83e-02, avg batch time: 0.4936, average train loss: 0.0645
[09/26 04:43:45 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1674, average loss: 0.5604
[09/26 04:43:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.21	
[09/26 04:43:45 visual_prompt]: Training 59 / 100 epoch, with learning rate 0.11193394209154334
[09/26 04:43:52 visual_prompt]: Epoch 59 / 100: avg data time: 5.73e-02, avg batch time: 0.5026, average train loss: 0.0659
[09/26 04:43:53 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1676, average loss: 0.4314
[09/26 04:43:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 95.02	
[09/26 04:43:53 visual_prompt]: Training 60 / 100 epoch, with learning rate 0.10760336237999185
[09/26 04:44:00 visual_prompt]: Epoch 60 / 100: avg data time: 4.83e-02, avg batch time: 0.4922, average train loss: 0.0381
[09/26 04:44:01 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1676, average loss: 0.5392
[09/26 04:44:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.28	
[09/26 04:44:01 visual_prompt]: Training 61 / 100 epoch, with learning rate 0.10329397779163371
[09/26 04:44:08 visual_prompt]: Epoch 61 / 100: avg data time: 5.45e-02, avg batch time: 0.4989, average train loss: 0.0313
[09/26 04:44:10 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1675, average loss: 0.5912
[09/26 04:44:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.85	
[09/26 04:44:10 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.0990110386477801
[09/26 04:44:16 visual_prompt]: Epoch 62 / 100: avg data time: 4.55e-02, avg batch time: 0.4916, average train loss: 0.0558
[09/26 04:44:18 visual_prompt]: Inference (val):avg data time: 3.25e-05, avg batch time: 0.1676, average loss: 0.5426
[09/26 04:44:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.79	
[09/26 04:44:18 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.09475976305004155
[09/26 04:44:24 visual_prompt]: Epoch 63 / 100: avg data time: 5.54e-02, avg batch time: 0.4993, average train loss: 0.0638
[09/26 04:44:26 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1674, average loss: 0.5773
[09/26 04:44:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.71	
[09/26 04:44:26 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.09054533052287511
[09/26 04:44:33 visual_prompt]: Epoch 64 / 100: avg data time: 4.84e-02, avg batch time: 0.4920, average train loss: 0.0282
[09/26 04:44:34 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1675, average loss: 0.5163
[09/26 04:44:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 94.90	
[09/26 04:44:34 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.08637287570313158
[09/26 04:44:41 visual_prompt]: Epoch 65 / 100: avg data time: 5.28e-02, avg batch time: 0.4973, average train loss: 0.0347
[09/26 04:44:42 visual_prompt]: Inference (val):avg data time: 3.22e-05, avg batch time: 0.1677, average loss: 0.8312
[09/26 04:44:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 88.02	
[09/26 04:44:42 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.08224748208429142
[09/26 04:44:49 visual_prompt]: Epoch 66 / 100: avg data time: 5.62e-02, avg batch time: 0.5012, average train loss: 0.0254
[09/26 04:44:50 visual_prompt]: Inference (val):avg data time: 2.99e-05, avg batch time: 0.1673, average loss: 0.4855
[09/26 04:44:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.00	rocauc: 94.06	
[09/26 04:44:51 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.07817417582301099
[09/26 04:44:57 visual_prompt]: Epoch 67 / 100: avg data time: 5.60e-02, avg batch time: 0.5004, average train loss: 0.0347
[09/26 04:44:59 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1679, average loss: 0.6223
[09/26 04:44:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.47	
[09/26 04:44:59 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.074157919615525
[09/26 04:45:05 visual_prompt]: Epoch 68 / 100: avg data time: 5.75e-02, avg batch time: 0.5032, average train loss: 0.0244
[09/26 04:45:07 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1677, average loss: 0.5744
[09/26 04:45:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 92.99	
[09/26 04:45:07 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.07020360665136531
[09/26 04:45:14 visual_prompt]: Epoch 69 / 100: avg data time: 5.12e-02, avg batch time: 0.4964, average train loss: 0.0068
[09/26 04:45:15 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1676, average loss: 0.6471
[09/26 04:45:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 94.29	
[09/26 04:45:15 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.06631605465176368
[09/26 04:45:22 visual_prompt]: Epoch 70 / 100: avg data time: 5.76e-02, avg batch time: 0.5022, average train loss: 0.0059
[09/26 04:45:23 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1674, average loss: 0.7143
[09/26 04:45:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.29	
[09/26 04:45:23 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.06250000000000003
[09/26 04:45:30 visual_prompt]: Epoch 71 / 100: avg data time: 5.34e-02, avg batch time: 0.4983, average train loss: 0.0040
[09/26 04:45:31 visual_prompt]: Inference (val):avg data time: 2.23e-05, avg batch time: 0.1677, average loss: 0.7316
[09/26 04:45:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.39	
[09/26 04:45:31 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.0587600919708494
[09/26 04:45:38 visual_prompt]: Epoch 72 / 100: avg data time: 5.58e-02, avg batch time: 0.5001, average train loss: 0.0027
[09/26 04:45:40 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1675, average loss: 0.7564
[09/26 04:45:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.42	
[09/26 04:45:40 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.055100887066156665
[09/26 04:45:46 visual_prompt]: Epoch 73 / 100: avg data time: 4.95e-02, avg batch time: 0.4964, average train loss: 0.0017
[09/26 04:45:48 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1675, average loss: 0.7416
[09/26 04:45:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.13	
[09/26 04:45:48 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.05152684346344087
[09/26 04:45:55 visual_prompt]: Epoch 74 / 100: avg data time: 5.63e-02, avg batch time: 0.5018, average train loss: 0.0015
[09/26 04:45:56 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1676, average loss: 0.7387
[09/26 04:45:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.04	
[09/26 04:45:56 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.048042315584292714
[09/26 04:46:03 visual_prompt]: Epoch 75 / 100: avg data time: 4.12e-02, avg batch time: 0.4869, average train loss: 0.0013
[09/26 04:46:04 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1674, average loss: 0.7444
[09/26 04:46:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 93.00	
[09/26 04:46:04 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.04465154878918258
[09/26 04:46:11 visual_prompt]: Epoch 76 / 100: avg data time: 5.62e-02, avg batch time: 0.5003, average train loss: 0.0012
[09/26 04:46:12 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1677, average loss: 0.7495
[09/26 04:46:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.95	
[09/26 04:46:12 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.04135867420514276
[09/26 04:46:19 visual_prompt]: Epoch 77 / 100: avg data time: 5.81e-02, avg batch time: 0.5038, average train loss: 0.0011
[09/26 04:46:21 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1674, average loss: 0.7546
[09/26 04:46:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.90	
[09/26 04:46:21 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.03816770369262533
[09/26 04:46:27 visual_prompt]: Epoch 78 / 100: avg data time: 4.29e-02, avg batch time: 0.4884, average train loss: 0.0011
[09/26 04:46:29 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1673, average loss: 0.7590
[09/26 04:46:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.88	
[09/26 04:46:29 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.03508252495766863
[09/26 04:46:36 visual_prompt]: Epoch 79 / 100: avg data time: 4.87e-02, avg batch time: 0.4929, average train loss: 0.0010
[09/26 04:46:37 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1674, average loss: 0.7640
[09/26 04:46:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.85	
[09/26 04:46:37 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.032106896815325706
[09/26 04:46:44 visual_prompt]: Epoch 80 / 100: avg data time: 5.79e-02, avg batch time: 0.5030, average train loss: 0.0010
[09/26 04:46:45 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1677, average loss: 0.7693
[09/26 04:46:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.80	
[09/26 04:46:45 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.029244444610127762
[09/26 04:46:52 visual_prompt]: Epoch 81 / 100: avg data time: 4.18e-02, avg batch time: 0.4872, average train loss: 0.0010
[09/26 04:46:53 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1679, average loss: 0.7743
[09/26 04:46:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.75	
[09/26 04:46:53 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.026498655799159762
[09/26 04:47:00 visual_prompt]: Epoch 82 / 100: avg data time: 4.24e-02, avg batch time: 0.4891, average train loss: 0.0010
[09/26 04:47:01 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1673, average loss: 0.7792
[09/26 04:47:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.68	
[09/26 04:47:01 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.023872875703131582
[09/26 04:47:08 visual_prompt]: Epoch 83 / 100: avg data time: 5.53e-02, avg batch time: 0.4998, average train loss: 0.0009
[09/26 04:47:10 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.1675, average loss: 0.7839
[09/26 04:47:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.63	
[09/26 04:47:10 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.021370303430619797
[09/26 04:47:16 visual_prompt]: Epoch 84 / 100: avg data time: 4.99e-02, avg batch time: 0.4948, average train loss: 0.0009
[09/26 04:47:18 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1675, average loss: 0.7889
[09/26 04:47:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.62	
[09/26 04:47:18 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.018993987980446755
[09/26 04:47:24 visual_prompt]: Epoch 85 / 100: avg data time: 4.21e-02, avg batch time: 0.4883, average train loss: 0.0009
[09/26 04:47:26 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.1674, average loss: 0.7933
[09/26 04:47:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.62	
[09/26 04:47:26 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.01674682452694516
[09/26 04:47:33 visual_prompt]: Epoch 86 / 100: avg data time: 4.39e-02, avg batch time: 0.4921, average train loss: 0.0008
[09/26 04:47:34 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1672, average loss: 0.7977
[09/26 04:47:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.61	
[09/26 04:47:34 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.014631550892634126
[09/26 04:47:41 visual_prompt]: Epoch 87 / 100: avg data time: 4.62e-02, avg batch time: 0.4940, average train loss: 0.0009
[09/26 04:47:42 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1676, average loss: 0.8016
[09/26 04:47:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.62	
[09/26 04:47:42 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.012650744212604148
[09/26 04:47:49 visual_prompt]: Epoch 88 / 100: avg data time: 5.59e-02, avg batch time: 0.5008, average train loss: 0.0009
[09/26 04:47:50 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1676, average loss: 0.8065
[09/26 04:47:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.60	
[09/26 04:47:50 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.010806817794674878
[09/26 04:47:57 visual_prompt]: Epoch 89 / 100: avg data time: 4.45e-02, avg batch time: 0.4906, average train loss: 0.0008
[09/26 04:47:58 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1679, average loss: 0.8104
[09/26 04:47:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.59	
[09/26 04:47:58 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.009102018179151586
[09/26 04:48:05 visual_prompt]: Epoch 90 / 100: avg data time: 5.22e-02, avg batch time: 0.4963, average train loss: 0.0008
[09/26 04:48:07 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1674, average loss: 0.8131
[09/26 04:48:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.60	
[09/26 04:48:07 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.00753842240176146
[09/26 04:48:13 visual_prompt]: Epoch 91 / 100: avg data time: 4.92e-02, avg batch time: 0.4945, average train loss: 0.0008
[09/26 04:48:15 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1673, average loss: 0.8154
[09/26 04:48:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.59	
[09/26 04:48:15 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.006117935463105809
[09/26 04:48:22 visual_prompt]: Epoch 92 / 100: avg data time: 5.77e-02, avg batch time: 0.5023, average train loss: 0.0008
[09/26 04:48:23 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1674, average loss: 0.8172
[09/26 04:48:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.60	
[09/26 04:48:23 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.004842288007710138
[09/26 04:48:30 visual_prompt]: Epoch 93 / 100: avg data time: 4.18e-02, avg batch time: 0.4876, average train loss: 0.0008
[09/26 04:48:31 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1678, average loss: 0.8190
[09/26 04:48:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.61	
[09/26 04:48:31 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.003713034215500441
[09/26 04:48:38 visual_prompt]: Epoch 94 / 100: avg data time: 4.66e-02, avg batch time: 0.4907, average train loss: 0.0008
[09/26 04:48:39 visual_prompt]: Inference (val):avg data time: 3.22e-05, avg batch time: 0.1680, average loss: 0.8203
[09/26 04:48:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.61	
[09/26 04:48:39 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.002731549908274289
[09/26 04:48:46 visual_prompt]: Epoch 95 / 100: avg data time: 5.64e-02, avg batch time: 0.5001, average train loss: 0.0008
[09/26 04:48:48 visual_prompt]: Inference (val):avg data time: 3.37e-05, avg batch time: 0.1674, average loss: 0.8211
[09/26 04:48:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.61	
[09/26 04:48:48 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.0018990308734739975
[09/26 04:48:54 visual_prompt]: Epoch 96 / 100: avg data time: 4.48e-02, avg batch time: 0.4896, average train loss: 0.0007
[09/26 04:48:56 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1676, average loss: 0.8217
[09/26 04:48:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.61	
[09/26 04:48:56 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.0012164914073037048
[09/26 04:49:02 visual_prompt]: Epoch 97 / 100: avg data time: 4.86e-02, avg batch time: 0.4934, average train loss: 0.0008
[09/26 04:49:04 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1677, average loss: 0.8221
[09/26 04:49:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.61	
[09/26 04:49:04 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.0006847630789658388
[09/26 04:49:11 visual_prompt]: Epoch 98 / 100: avg data time: 4.33e-02, avg batch time: 0.4875, average train loss: 0.0008
[09/26 04:49:12 visual_prompt]: Inference (val):avg data time: 2.99e-05, avg batch time: 0.1676, average loss: 0.8224
[09/26 04:49:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.61	
[09/26 04:49:12 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.0003044937175219753
[09/26 04:49:19 visual_prompt]: Epoch 99 / 100: avg data time: 5.64e-02, avg batch time: 0.5007, average train loss: 0.0008
[09/26 04:49:20 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1678, average loss: 0.8225
[09/26 04:49:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.61	
[09/26 04:49:20 visual_prompt]: Training 100 / 100 epoch, with learning rate 7.614662261302974e-05
[09/26 04:49:27 visual_prompt]: Epoch 100 / 100: avg data time: 5.73e-02, avg batch time: 0.5022, average train loss: 0.0008
[09/26 04:49:29 visual_prompt]: Inference (val):avg data time: 2.76e-05, avg batch time: 0.1679, average loss: 0.8225
[09/26 04:49:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.61	
[09/26 04:49:29 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 04:49:29 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 04:49:29 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 04:49:29 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 04:49:29 visual_prompt]: Training with config:
[09/26 04:49:29 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr0.25_wd0.0001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 0.25, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 04:49:29 visual_prompt]: Loading training data...
[09/26 04:49:29 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 04:49:30 visual_prompt]: Number of images: 800
[09/26 04:49:30 visual_prompt]: Number of classes: 2 / 2
[09/26 04:49:30 visual_prompt]: Loading validation data...
[09/26 04:49:30 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 04:49:30 visual_prompt]: Number of images: 200
[09/26 04:49:30 visual_prompt]: Number of classes: 2 / 2
[09/26 04:49:30 visual_prompt]: Constructing models...
[09/26 04:49:33 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 04:49:33 visual_prompt]: tuned percent:0.536
[09/26 04:49:33 visual_prompt]: Device used for model: 0
[09/26 04:49:33 visual_prompt]: Setting up Evaluator...
[09/26 04:49:33 visual_prompt]: Setting up Trainer...
[09/26 04:49:33 visual_prompt]: 	Setting up the optimizer...
[09/26 04:49:33 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 04:49:39 visual_prompt]: Epoch 1 / 100: avg data time: 4.47e-02, avg batch time: 0.4888, average train loss: 1.9424
[09/26 04:49:41 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1668, average loss: 2.0033
[09/26 04:49:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 04:49:41 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 04:49:41 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.025
[09/26 04:49:47 visual_prompt]: Epoch 2 / 100: avg data time: 4.23e-02, avg batch time: 0.4865, average train loss: 2.2129
[09/26 04:49:49 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1669, average loss: 0.6831
[09/26 04:49:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 53.00	rocauc: 62.19	
[09/26 04:49:49 visual_prompt]: Best epoch 2: best metric: 0.530
[09/26 04:49:49 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.05
[09/26 04:49:56 visual_prompt]: Epoch 3 / 100: avg data time: 4.20e-02, avg batch time: 0.4851, average train loss: 0.8169
[09/26 04:49:57 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1673, average loss: 0.6635
[09/26 04:49:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 82.30	
[09/26 04:49:57 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.075
[09/26 04:50:04 visual_prompt]: Epoch 4 / 100: avg data time: 5.11e-02, avg batch time: 0.4947, average train loss: 0.6745
[09/26 04:50:05 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1672, average loss: 0.5650
[09/26 04:50:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 71.50	rocauc: 88.74	
[09/26 04:50:05 visual_prompt]: Best epoch 4: best metric: 0.715
[09/26 04:50:05 visual_prompt]: Training 5 / 100 epoch, with learning rate 0.1
[09/26 04:50:12 visual_prompt]: Epoch 5 / 100: avg data time: 4.30e-02, avg batch time: 0.4891, average train loss: 0.5535
[09/26 04:50:13 visual_prompt]: Inference (val):avg data time: 3.15e-05, avg batch time: 0.1672, average loss: 0.4366
[09/26 04:50:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 90.05	
[09/26 04:50:13 visual_prompt]: Best epoch 5: best metric: 0.780
[09/26 04:50:13 visual_prompt]: Training 6 / 100 epoch, with learning rate 0.125
[09/26 04:50:20 visual_prompt]: Epoch 6 / 100: avg data time: 5.56e-02, avg batch time: 0.4991, average train loss: 0.5364
[09/26 04:50:21 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1672, average loss: 0.7473
[09/26 04:50:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 63.50	rocauc: 91.19	
[09/26 04:50:21 visual_prompt]: Training 7 / 100 epoch, with learning rate 0.15
[09/26 04:50:28 visual_prompt]: Epoch 7 / 100: avg data time: 5.64e-02, avg batch time: 0.5026, average train loss: 0.6119
[09/26 04:50:30 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1673, average loss: 0.6706
[09/26 04:50:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 62.00	rocauc: 88.90	
[09/26 04:50:30 visual_prompt]: Training 8 / 100 epoch, with learning rate 0.175
[09/26 04:50:36 visual_prompt]: Epoch 8 / 100: avg data time: 4.30e-02, avg batch time: 0.4878, average train loss: 0.5378
[09/26 04:50:38 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1673, average loss: 0.3877
[09/26 04:50:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 91.53	
[09/26 04:50:38 visual_prompt]: Best epoch 8: best metric: 0.845
[09/26 04:50:38 visual_prompt]: Training 9 / 100 epoch, with learning rate 0.2
[09/26 04:50:44 visual_prompt]: Epoch 9 / 100: avg data time: 4.13e-02, avg batch time: 0.4857, average train loss: 0.4795
[09/26 04:50:46 visual_prompt]: Inference (val):avg data time: 3.22e-05, avg batch time: 0.1675, average loss: 0.4132
[09/26 04:50:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 91.89	
[09/26 04:50:46 visual_prompt]: Training 10 / 100 epoch, with learning rate 0.225
[09/26 04:50:53 visual_prompt]: Epoch 10 / 100: avg data time: 5.42e-02, avg batch time: 0.4979, average train loss: 0.7448
[09/26 04:50:54 visual_prompt]: Inference (val):avg data time: 3.03e-05, avg batch time: 0.1672, average loss: 0.5301
[09/26 04:50:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.50	rocauc: 90.86	
[09/26 04:50:54 visual_prompt]: Training 11 / 100 epoch, with learning rate 0.25
[09/26 04:51:01 visual_prompt]: Epoch 11 / 100: avg data time: 5.74e-02, avg batch time: 0.5013, average train loss: 0.4511
[09/26 04:51:02 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1674, average loss: 0.4268
[09/26 04:51:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.80	
[09/26 04:51:02 visual_prompt]: Training 12 / 100 epoch, with learning rate 0.24992385337738698
[09/26 04:51:09 visual_prompt]: Epoch 12 / 100: avg data time: 5.45e-02, avg batch time: 0.4980, average train loss: 0.4367
[09/26 04:51:10 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1673, average loss: 0.3652
[09/26 04:51:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.43	
[09/26 04:51:11 visual_prompt]: Training 13 / 100 epoch, with learning rate 0.24969550628247802
[09/26 04:51:17 visual_prompt]: Epoch 13 / 100: avg data time: 4.95e-02, avg batch time: 0.4954, average train loss: 0.4031
[09/26 04:51:19 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1672, average loss: 0.3656
[09/26 04:51:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.91	
[09/26 04:51:19 visual_prompt]: Training 14 / 100 epoch, with learning rate 0.24931523692103416
[09/26 04:51:25 visual_prompt]: Epoch 14 / 100: avg data time: 4.45e-02, avg batch time: 0.4920, average train loss: 0.4140
[09/26 04:51:27 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1673, average loss: 0.3623
[09/26 04:51:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.38	
[09/26 04:51:27 visual_prompt]: Training 15 / 100 epoch, with learning rate 0.2487835085926963
[09/26 04:51:33 visual_prompt]: Epoch 15 / 100: avg data time: 4.92e-02, avg batch time: 0.4926, average train loss: 0.3675
[09/26 04:51:35 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1671, average loss: 0.7643
[09/26 04:51:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 67.50	rocauc: 91.24	
[09/26 04:51:35 visual_prompt]: Training 16 / 100 epoch, with learning rate 0.24810096912652602
[09/26 04:51:42 visual_prompt]: Epoch 16 / 100: avg data time: 4.33e-02, avg batch time: 0.4879, average train loss: 0.4845
[09/26 04:51:43 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1672, average loss: 0.3598
[09/26 04:51:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.80	
[09/26 04:51:43 visual_prompt]: Best epoch 16: best metric: 0.860
[09/26 04:51:43 visual_prompt]: Training 17 / 100 epoch, with learning rate 0.2472684500917257
[09/26 04:51:50 visual_prompt]: Epoch 17 / 100: avg data time: 5.51e-02, avg batch time: 0.4996, average train loss: 0.3820
[09/26 04:51:51 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1672, average loss: 0.3640
[09/26 04:51:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.03	
[09/26 04:51:51 visual_prompt]: Training 18 / 100 epoch, with learning rate 0.24628696578449955
[09/26 04:51:58 visual_prompt]: Epoch 18 / 100: avg data time: 4.87e-02, avg batch time: 0.4939, average train loss: 0.3504
[09/26 04:51:59 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1674, average loss: 0.3816
[09/26 04:51:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.35	
[09/26 04:51:59 visual_prompt]: Training 19 / 100 epoch, with learning rate 0.24515771199228986
[09/26 04:52:06 visual_prompt]: Epoch 19 / 100: avg data time: 4.45e-02, avg batch time: 0.4897, average train loss: 0.3577
[09/26 04:52:08 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1671, average loss: 0.3722
[09/26 04:52:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.39	
[09/26 04:52:08 visual_prompt]: Training 20 / 100 epoch, with learning rate 0.2438820645368942
[09/26 04:52:14 visual_prompt]: Epoch 20 / 100: avg data time: 5.08e-02, avg batch time: 0.4957, average train loss: 0.2877
[09/26 04:52:16 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1675, average loss: 0.3538
[09/26 04:52:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.20	
[09/26 04:52:16 visual_prompt]: Training 21 / 100 epoch, with learning rate 0.24246157759823855
[09/26 04:52:22 visual_prompt]: Epoch 21 / 100: avg data time: 5.21e-02, avg batch time: 0.4965, average train loss: 0.2611
[09/26 04:52:24 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1674, average loss: 0.4512
[09/26 04:52:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.44	
[09/26 04:52:24 visual_prompt]: Training 22 / 100 epoch, with learning rate 0.24089798182084843
[09/26 04:52:31 visual_prompt]: Epoch 22 / 100: avg data time: 5.77e-02, avg batch time: 0.5025, average train loss: 0.2794
[09/26 04:52:32 visual_prompt]: Inference (val):avg data time: 3.03e-05, avg batch time: 0.1676, average loss: 0.3581
[09/26 04:52:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.05	
[09/26 04:52:32 visual_prompt]: Training 23 / 100 epoch, with learning rate 0.2391931822053251
[09/26 04:52:39 visual_prompt]: Epoch 23 / 100: avg data time: 5.14e-02, avg batch time: 0.4967, average train loss: 0.2310
[09/26 04:52:40 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1673, average loss: 0.4117
[09/26 04:52:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.61	
[09/26 04:52:40 visual_prompt]: Training 24 / 100 epoch, with learning rate 0.23734925578739588
[09/26 04:52:47 visual_prompt]: Epoch 24 / 100: avg data time: 5.45e-02, avg batch time: 0.4988, average train loss: 0.2381
[09/26 04:52:48 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1673, average loss: 0.3219
[09/26 04:52:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 94.07	
[09/26 04:52:48 visual_prompt]: Training 25 / 100 epoch, with learning rate 0.23536844910736587
[09/26 04:52:55 visual_prompt]: Epoch 25 / 100: avg data time: 5.14e-02, avg batch time: 0.4961, average train loss: 0.2691
[09/26 04:52:57 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1675, average loss: 0.5500
[09/26 04:52:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.50	rocauc: 92.58	
[09/26 04:52:57 visual_prompt]: Training 26 / 100 epoch, with learning rate 0.23325317547305485
[09/26 04:53:03 visual_prompt]: Epoch 26 / 100: avg data time: 3.75e-02, avg batch time: 0.4813, average train loss: 0.2338
[09/26 04:53:05 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1675, average loss: 0.4573
[09/26 04:53:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.13	
[09/26 04:53:05 visual_prompt]: Training 27 / 100 epoch, with learning rate 0.23100601201955323
[09/26 04:53:11 visual_prompt]: Epoch 27 / 100: avg data time: 4.93e-02, avg batch time: 0.4929, average train loss: 0.1859
[09/26 04:53:13 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1676, average loss: 0.5476
[09/26 04:53:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 94.30	
[09/26 04:53:13 visual_prompt]: Training 28 / 100 epoch, with learning rate 0.2286296965693802
[09/26 04:53:19 visual_prompt]: Epoch 28 / 100: avg data time: 4.51e-02, avg batch time: 0.4913, average train loss: 0.2496
[09/26 04:53:21 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1675, average loss: 0.4346
[09/26 04:53:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.09	
[09/26 04:53:21 visual_prompt]: Training 29 / 100 epoch, with learning rate 0.22612712429686843
[09/26 04:53:28 visual_prompt]: Epoch 29 / 100: avg data time: 5.52e-02, avg batch time: 0.4996, average train loss: 0.1509
[09/26 04:53:29 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1674, average loss: 0.4889
[09/26 04:53:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.52	
[09/26 04:53:29 visual_prompt]: Training 30 / 100 epoch, with learning rate 0.22350134420084022
[09/26 04:53:36 visual_prompt]: Epoch 30 / 100: avg data time: 5.08e-02, avg batch time: 0.4953, average train loss: 0.1361
[09/26 04:53:37 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1674, average loss: 0.6814
[09/26 04:53:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 91.56	
[09/26 04:53:37 visual_prompt]: Training 31 / 100 epoch, with learning rate 0.22075555538987224
[09/26 04:53:44 visual_prompt]: Epoch 31 / 100: avg data time: 4.57e-02, avg batch time: 0.4896, average train loss: 0.1029
[09/26 04:53:46 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1674, average loss: 0.6973
[09/26 04:53:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 92.74	
[09/26 04:53:46 visual_prompt]: Training 32 / 100 epoch, with learning rate 0.21789310318467428
[09/26 04:53:52 visual_prompt]: Epoch 32 / 100: avg data time: 4.45e-02, avg batch time: 0.4903, average train loss: 0.2285
[09/26 04:53:54 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1676, average loss: 0.4811
[09/26 04:53:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 89.81	
[09/26 04:53:54 visual_prompt]: Training 33 / 100 epoch, with learning rate 0.21491747504233139
[09/26 04:54:00 visual_prompt]: Epoch 33 / 100: avg data time: 4.94e-02, avg batch time: 0.4943, average train loss: 0.1300
[09/26 04:54:02 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1678, average loss: 0.5335
[09/26 04:54:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.42	
[09/26 04:54:02 visual_prompt]: Training 34 / 100 epoch, with learning rate 0.21183229630737466
[09/26 04:54:09 visual_prompt]: Epoch 34 / 100: avg data time: 5.93e-02, avg batch time: 0.5039, average train loss: 0.1417
[09/26 04:54:10 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1673, average loss: 0.5592
[09/26 04:54:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 89.80	
[09/26 04:54:10 visual_prompt]: Training 35 / 100 epoch, with learning rate 0.20864132579485728
[09/26 04:54:17 visual_prompt]: Epoch 35 / 100: avg data time: 6.08e-02, avg batch time: 0.5042, average train loss: 0.1257
[09/26 04:54:18 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.1673, average loss: 0.5167
[09/26 04:54:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.21	
[09/26 04:54:18 visual_prompt]: Training 36 / 100 epoch, with learning rate 0.2053484512108174
[09/26 04:54:25 visual_prompt]: Epoch 36 / 100: avg data time: 4.90e-02, avg batch time: 0.4925, average train loss: 0.0880
[09/26 04:54:26 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1676, average loss: 0.6511
[09/26 04:54:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.89	
[09/26 04:54:26 visual_prompt]: Training 37 / 100 epoch, with learning rate 0.20195768441570727
[09/26 04:54:33 visual_prompt]: Epoch 37 / 100: avg data time: 4.84e-02, avg batch time: 0.4928, average train loss: 0.0692
[09/26 04:54:35 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1677, average loss: 0.9372
[09/26 04:54:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 92.12	
[09/26 04:54:35 visual_prompt]: Training 38 / 100 epoch, with learning rate 0.19847315653655914
[09/26 04:54:41 visual_prompt]: Epoch 38 / 100: avg data time: 4.07e-02, avg batch time: 0.4859, average train loss: 0.1521
[09/26 04:54:43 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1673, average loss: 0.4915
[09/26 04:54:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.54	
[09/26 04:54:43 visual_prompt]: Best epoch 38: best metric: 0.865
[09/26 04:54:43 visual_prompt]: Training 39 / 100 epoch, with learning rate 0.19489911293384335
[09/26 04:54:49 visual_prompt]: Epoch 39 / 100: avg data time: 4.81e-02, avg batch time: 0.4922, average train loss: 0.0883
[09/26 04:54:51 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1675, average loss: 0.4291
[09/26 04:54:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.97	
[09/26 04:54:51 visual_prompt]: Training 40 / 100 epoch, with learning rate 0.1912399080291506
[09/26 04:54:57 visual_prompt]: Epoch 40 / 100: avg data time: 4.32e-02, avg batch time: 0.4883, average train loss: 0.0394
[09/26 04:54:59 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1678, average loss: 0.6607
[09/26 04:54:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.44	
[09/26 04:54:59 visual_prompt]: Training 41 / 100 epoch, with learning rate 0.1875
[09/26 04:55:05 visual_prompt]: Epoch 41 / 100: avg data time: 4.39e-02, avg batch time: 0.4887, average train loss: 0.0289
[09/26 04:55:07 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1674, average loss: 0.6199
[09/26 04:55:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 91.32	
[09/26 04:55:07 visual_prompt]: Training 42 / 100 epoch, with learning rate 0.18368394534823634
[09/26 04:55:13 visual_prompt]: Epoch 42 / 100: avg data time: 4.94e-02, avg batch time: 0.4944, average train loss: 0.0158
[09/26 04:55:15 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1674, average loss: 0.8444
[09/26 04:55:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 90.13	
[09/26 04:55:15 visual_prompt]: Training 43 / 100 epoch, with learning rate 0.17979639334863468
[09/26 04:55:22 visual_prompt]: Epoch 43 / 100: avg data time: 3.66e-02, avg batch time: 0.4822, average train loss: 0.0226
[09/26 04:55:23 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1676, average loss: 0.7130
[09/26 04:55:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.20	
[09/26 04:55:23 visual_prompt]: Training 44 / 100 epoch, with learning rate 0.17584208038447505
[09/26 04:55:30 visual_prompt]: Epoch 44 / 100: avg data time: 4.10e-02, avg batch time: 0.4877, average train loss: 0.0998
[09/26 04:55:31 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1676, average loss: 0.6415
[09/26 04:55:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.42	
[09/26 04:55:31 visual_prompt]: Training 45 / 100 epoch, with learning rate 0.17182582417698902
[09/26 04:55:38 visual_prompt]: Epoch 45 / 100: avg data time: 4.27e-02, avg batch time: 0.4891, average train loss: 0.1669
[09/26 04:55:39 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1673, average loss: 0.4110
[09/26 04:55:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.10	
[09/26 04:55:39 visual_prompt]: Training 46 / 100 epoch, with learning rate 0.1677525179157086
[09/26 04:55:46 visual_prompt]: Epoch 46 / 100: avg data time: 4.17e-02, avg batch time: 0.4856, average train loss: 0.0881
[09/26 04:55:48 visual_prompt]: Inference (val):avg data time: 3.55e-04, avg batch time: 0.2704, average loss: 0.4989
[09/26 04:55:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.71	
[09/26 04:55:48 visual_prompt]: Training 47 / 100 epoch, with learning rate 0.16362712429686843
[09/26 04:55:54 visual_prompt]: Epoch 47 / 100: avg data time: 4.90e-02, avg batch time: 0.4928, average train loss: 0.0493
[09/26 04:55:56 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1679, average loss: 0.6659
[09/26 04:55:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 90.05	
[09/26 04:55:56 visual_prompt]: Training 48 / 100 epoch, with learning rate 0.1594546694771249
[09/26 04:56:02 visual_prompt]: Epoch 48 / 100: avg data time: 5.57e-02, avg batch time: 0.4994, average train loss: 0.0430
[09/26 04:56:04 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1676, average loss: 0.4698
[09/26 04:56:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 93.66	
[09/26 04:56:04 visual_prompt]: Best epoch 48: best metric: 0.875
[09/26 04:56:04 visual_prompt]: Training 49 / 100 epoch, with learning rate 0.15524023694995845
[09/26 04:56:11 visual_prompt]: Epoch 49 / 100: avg data time: 4.72e-02, avg batch time: 0.4908, average train loss: 0.0222
[09/26 04:56:12 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1675, average loss: 0.5612
[09/26 04:56:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.44	
[09/26 04:56:12 visual_prompt]: Training 50 / 100 epoch, with learning rate 0.1509889613522199
[09/26 04:56:19 visual_prompt]: Epoch 50 / 100: avg data time: 5.57e-02, avg batch time: 0.5011, average train loss: 0.0154
[09/26 04:56:20 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1674, average loss: 0.6464
[09/26 04:56:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.41	
[09/26 04:56:20 visual_prompt]: Training 51 / 100 epoch, with learning rate 0.14670602220836632
[09/26 04:56:27 visual_prompt]: Epoch 51 / 100: avg data time: 5.86e-02, avg batch time: 0.5024, average train loss: 0.0171
[09/26 04:56:29 visual_prompt]: Inference (val):avg data time: 3.83e-05, avg batch time: 0.1672, average loss: 0.8023
[09/26 04:56:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 90.68	
[09/26 04:56:29 visual_prompt]: Training 52 / 100 epoch, with learning rate 0.14239663762000818
[09/26 04:56:35 visual_prompt]: Epoch 52 / 100: avg data time: 4.32e-02, avg batch time: 0.4895, average train loss: 0.0153
[09/26 04:56:37 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1673, average loss: 0.7771
[09/26 04:56:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.85	
[09/26 04:56:37 visual_prompt]: Training 53 / 100 epoch, with learning rate 0.1380660579084567
[09/26 04:56:43 visual_prompt]: Epoch 53 / 100: avg data time: 4.51e-02, avg batch time: 0.4890, average train loss: 0.0092
[09/26 04:56:45 visual_prompt]: Inference (val):avg data time: 2.99e-05, avg batch time: 0.1680, average loss: 0.7733
[09/26 04:56:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 91.08	
[09/26 04:56:45 visual_prompt]: Training 54 / 100 epoch, with learning rate 0.13371955921801565
[09/26 04:56:51 visual_prompt]: Epoch 54 / 100: avg data time: 4.16e-02, avg batch time: 0.4880, average train loss: 0.0037
[09/26 04:56:53 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1678, average loss: 0.8484
[09/26 04:56:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 90.12	
[09/26 04:56:53 visual_prompt]: Training 55 / 100 epoch, with learning rate 0.12936243708781264
[09/26 04:57:00 visual_prompt]: Epoch 55 / 100: avg data time: 5.54e-02, avg batch time: 0.5008, average train loss: 0.0025
[09/26 04:57:01 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1674, average loss: 0.9199
[09/26 04:57:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 90.69	
[09/26 04:57:01 visual_prompt]: Training 56 / 100 epoch, with learning rate 0.125
[09/26 04:57:08 visual_prompt]: Epoch 56 / 100: avg data time: 4.90e-02, avg batch time: 0.4943, average train loss: 0.0019
[09/26 04:57:09 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1673, average loss: 0.8943
[09/26 04:57:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 90.77	
[09/26 04:57:09 visual_prompt]: Training 57 / 100 epoch, with learning rate 0.12063756291218741
[09/26 04:57:16 visual_prompt]: Epoch 57 / 100: avg data time: 5.75e-02, avg batch time: 0.5012, average train loss: 0.0018
[09/26 04:57:17 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1675, average loss: 0.8426
[09/26 04:57:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 90.92	
[09/26 04:57:17 visual_prompt]: Training 58 / 100 epoch, with learning rate 0.11628044078198434
[09/26 04:57:24 visual_prompt]: Epoch 58 / 100: avg data time: 4.93e-02, avg batch time: 0.4935, average train loss: 0.0013
[09/26 04:57:26 visual_prompt]: Inference (val):avg data time: 2.20e-05, avg batch time: 0.1676, average loss: 0.8929
[09/26 04:57:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.22	
[09/26 04:57:26 visual_prompt]: Training 59 / 100 epoch, with learning rate 0.11193394209154334
[09/26 04:57:32 visual_prompt]: Epoch 59 / 100: avg data time: 5.66e-02, avg batch time: 0.5010, average train loss: 0.0013
[09/26 04:57:34 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1673, average loss: 0.8729
[09/26 04:57:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.11	
[09/26 04:57:34 visual_prompt]: Training 60 / 100 epoch, with learning rate 0.10760336237999185
[09/26 04:57:40 visual_prompt]: Epoch 60 / 100: avg data time: 4.21e-02, avg batch time: 0.4878, average train loss: 0.0013
[09/26 04:57:42 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1677, average loss: 0.8538
[09/26 04:57:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 90.83	
[09/26 04:57:42 visual_prompt]: Training 61 / 100 epoch, with learning rate 0.10329397779163371
[09/26 04:57:49 visual_prompt]: Epoch 61 / 100: avg data time: 5.72e-02, avg batch time: 0.5016, average train loss: 0.0011
[09/26 04:57:50 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1675, average loss: 0.8856
[09/26 04:57:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.09	
[09/26 04:57:50 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.0990110386477801
[09/26 04:57:57 visual_prompt]: Epoch 62 / 100: avg data time: 5.46e-02, avg batch time: 0.4982, average train loss: 0.0009
[09/26 04:57:58 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1676, average loss: 0.9039
[09/26 04:57:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.10	
[09/26 04:57:58 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.09475976305004155
[09/26 04:58:05 visual_prompt]: Epoch 63 / 100: avg data time: 5.95e-02, avg batch time: 0.5040, average train loss: 0.0009
[09/26 04:58:07 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1677, average loss: 0.9055
[09/26 04:58:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.08	
[09/26 04:58:07 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.09054533052287511
[09/26 04:58:13 visual_prompt]: Epoch 64 / 100: avg data time: 4.79e-02, avg batch time: 0.4919, average train loss: 0.0008
[09/26 04:58:15 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1673, average loss: 0.9091
[09/26 04:58:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.07	
[09/26 04:58:15 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.08637287570313158
[09/26 04:58:21 visual_prompt]: Epoch 65 / 100: avg data time: 4.84e-02, avg batch time: 0.4939, average train loss: 0.0009
[09/26 04:58:23 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1675, average loss: 0.9221
[09/26 04:58:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.01	
[09/26 04:58:23 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.08224748208429142
[09/26 04:58:30 visual_prompt]: Epoch 66 / 100: avg data time: 4.80e-02, avg batch time: 0.4933, average train loss: 0.0015
[09/26 04:58:31 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1675, average loss: 0.9571
[09/26 04:58:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.66	
[09/26 04:58:31 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.07817417582301099
[09/26 04:58:38 visual_prompt]: Epoch 67 / 100: avg data time: 6.19e-02, avg batch time: 0.5063, average train loss: 0.0011
[09/26 04:58:39 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1671, average loss: 0.8813
[09/26 04:58:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.82	
[09/26 04:58:39 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.074157919615525
[09/26 04:58:46 visual_prompt]: Epoch 68 / 100: avg data time: 3.98e-02, avg batch time: 0.4851, average train loss: 0.0007
[09/26 04:58:48 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1673, average loss: 0.8530
[09/26 04:58:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 91.75	
[09/26 04:58:48 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.07020360665136531
[09/26 04:58:54 visual_prompt]: Epoch 69 / 100: avg data time: 5.65e-02, avg batch time: 0.5014, average train loss: 0.0010
[09/26 04:58:56 visual_prompt]: Inference (val):avg data time: 2.70e-05, avg batch time: 0.1676, average loss: 0.8757
[09/26 04:58:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.70	
[09/26 04:58:56 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.06631605465176368
[09/26 04:59:03 visual_prompt]: Epoch 70 / 100: avg data time: 5.04e-02, avg batch time: 0.4956, average train loss: 0.0008
[09/26 04:59:04 visual_prompt]: Inference (val):avg data time: 4.51e-05, avg batch time: 0.1672, average loss: 0.8897
[09/26 04:59:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.60	
[09/26 04:59:04 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.06250000000000003
[09/26 04:59:11 visual_prompt]: Epoch 71 / 100: avg data time: 4.16e-02, avg batch time: 0.4881, average train loss: 0.0007
[09/26 04:59:12 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1672, average loss: 0.8864
[09/26 04:59:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.56	
[09/26 04:59:12 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.0587600919708494
[09/26 04:59:19 visual_prompt]: Epoch 72 / 100: avg data time: 5.58e-02, avg batch time: 0.5006, average train loss: 0.0006
[09/26 04:59:20 visual_prompt]: Inference (val):avg data time: 3.01e-05, avg batch time: 0.1674, average loss: 0.8961
[09/26 04:59:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.54	
[09/26 04:59:20 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.055100887066156665
[09/26 04:59:27 visual_prompt]: Epoch 73 / 100: avg data time: 5.86e-02, avg batch time: 0.5036, average train loss: 0.0006
[09/26 04:59:29 visual_prompt]: Inference (val):avg data time: 4.82e-05, avg batch time: 0.1674, average loss: 0.9031
[09/26 04:59:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.52	
[09/26 04:59:29 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.05152684346344087
[09/26 04:59:35 visual_prompt]: Epoch 74 / 100: avg data time: 4.57e-02, avg batch time: 0.4907, average train loss: 0.0006
[09/26 04:59:37 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1673, average loss: 0.9073
[09/26 04:59:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.48	
[09/26 04:59:37 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.048042315584292714
[09/26 04:59:44 visual_prompt]: Epoch 75 / 100: avg data time: 5.91e-02, avg batch time: 0.5033, average train loss: 0.0006
[09/26 04:59:45 visual_prompt]: Inference (val):avg data time: 3.08e-05, avg batch time: 0.1677, average loss: 0.9056
[09/26 04:59:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.43	
[09/26 04:59:45 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.04465154878918258
[09/26 04:59:52 visual_prompt]: Epoch 76 / 100: avg data time: 4.48e-02, avg batch time: 0.4900, average train loss: 0.0006
[09/26 04:59:53 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1675, average loss: 0.9075
[09/26 04:59:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.39	
[09/26 04:59:53 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.04135867420514276
[09/26 05:00:00 visual_prompt]: Epoch 77 / 100: avg data time: 5.39e-02, avg batch time: 0.4980, average train loss: 0.0006
[09/26 05:00:02 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1672, average loss: 0.9112
[09/26 05:00:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.38	
[09/26 05:00:02 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.03816770369262533
[09/26 05:00:08 visual_prompt]: Epoch 78 / 100: avg data time: 4.89e-02, avg batch time: 0.4940, average train loss: 0.0007
[09/26 05:00:10 visual_prompt]: Inference (val):avg data time: 2.98e-05, avg batch time: 0.1673, average loss: 0.9200
[09/26 05:00:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.37	
[09/26 05:00:10 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.03508252495766863
[09/26 05:00:16 visual_prompt]: Epoch 79 / 100: avg data time: 5.05e-02, avg batch time: 0.4942, average train loss: 0.0005
[09/26 05:00:18 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1676, average loss: 0.9246
[09/26 05:00:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.34	
[09/26 05:00:18 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.032106896815325706
[09/26 05:00:25 visual_prompt]: Epoch 80 / 100: avg data time: 4.72e-02, avg batch time: 0.4929, average train loss: 0.0005
[09/26 05:00:26 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1675, average loss: 0.9270
[09/26 05:00:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.34	
[09/26 05:00:26 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.029244444610127762
[09/26 05:00:33 visual_prompt]: Epoch 81 / 100: avg data time: 6.12e-02, avg batch time: 0.5050, average train loss: 0.0005
[09/26 05:00:34 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1675, average loss: 0.9291
[09/26 05:00:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.33	
[09/26 05:00:34 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.026498655799159762
[09/26 05:00:41 visual_prompt]: Epoch 82 / 100: avg data time: 5.61e-02, avg batch time: 0.5013, average train loss: 0.0005
[09/26 05:00:43 visual_prompt]: Inference (val):avg data time: 3.99e-05, avg batch time: 0.1671, average loss: 0.9285
[09/26 05:00:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.31	
[09/26 05:00:43 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.023872875703131582
[09/26 05:00:49 visual_prompt]: Epoch 83 / 100: avg data time: 5.30e-02, avg batch time: 0.4974, average train loss: 0.0005
[09/26 05:00:51 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1677, average loss: 0.9269
[09/26 05:00:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.28	
[09/26 05:00:51 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.021370303430619797
[09/26 05:00:57 visual_prompt]: Epoch 84 / 100: avg data time: 4.23e-02, avg batch time: 0.4877, average train loss: 0.0006
[09/26 05:00:59 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1674, average loss: 0.9220
[09/26 05:00:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 91.22	
[09/26 05:00:59 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.018993987980446755
[09/26 05:01:05 visual_prompt]: Epoch 85 / 100: avg data time: 4.41e-02, avg batch time: 0.4893, average train loss: 0.0005
[09/26 05:01:07 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.1673, average loss: 0.9225
[09/26 05:01:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 91.21	
[09/26 05:01:07 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.01674682452694516
[09/26 05:01:14 visual_prompt]: Epoch 86 / 100: avg data time: 4.52e-02, avg batch time: 0.4902, average train loss: 0.0005
[09/26 05:01:15 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1677, average loss: 0.9327
[09/26 05:01:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.25	
[09/26 05:01:15 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.014631550892634126
[09/26 05:01:22 visual_prompt]: Epoch 87 / 100: avg data time: 5.47e-02, avg batch time: 0.4985, average train loss: 0.0005
[09/26 05:01:23 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1676, average loss: 0.9387
[09/26 05:01:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.26	
[09/26 05:01:23 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.012650744212604148
[09/26 05:01:30 visual_prompt]: Epoch 88 / 100: avg data time: 4.39e-02, avg batch time: 0.4885, average train loss: 0.0005
[09/26 05:01:31 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1679, average loss: 0.9407
[09/26 05:01:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.27	
[09/26 05:01:31 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.010806817794674878
[09/26 05:01:38 visual_prompt]: Epoch 89 / 100: avg data time: 5.62e-02, avg batch time: 0.5003, average train loss: 0.0004
[09/26 05:01:40 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1676, average loss: 0.9414
[09/26 05:01:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.27	
[09/26 05:01:40 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.009102018179151586
[09/26 05:01:46 visual_prompt]: Epoch 90 / 100: avg data time: 4.36e-02, avg batch time: 0.4897, average train loss: 0.0005
[09/26 05:01:48 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1673, average loss: 0.9423
[09/26 05:01:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.27	
[09/26 05:01:48 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.00753842240176146
[09/26 05:01:54 visual_prompt]: Epoch 91 / 100: avg data time: 4.97e-02, avg batch time: 0.4940, average train loss: 0.0005
[09/26 05:01:56 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1670, average loss: 0.9428
[09/26 05:01:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.27	
[09/26 05:01:56 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.006117935463105809
[09/26 05:02:03 visual_prompt]: Epoch 92 / 100: avg data time: 4.63e-02, avg batch time: 0.4918, average train loss: 0.0005
[09/26 05:02:04 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1674, average loss: 0.9434
[09/26 05:02:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.27	
[09/26 05:02:04 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.004842288007710138
[09/26 05:02:11 visual_prompt]: Epoch 93 / 100: avg data time: 4.27e-02, avg batch time: 0.4895, average train loss: 0.0005
[09/26 05:02:12 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1680, average loss: 0.9440
[09/26 05:02:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.27	
[09/26 05:02:12 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.003713034215500441
[09/26 05:02:19 visual_prompt]: Epoch 94 / 100: avg data time: 5.85e-02, avg batch time: 0.5034, average train loss: 0.0005
[09/26 05:02:20 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1673, average loss: 0.9442
[09/26 05:02:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.28	
[09/26 05:02:20 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.002731549908274289
[09/26 05:02:27 visual_prompt]: Epoch 95 / 100: avg data time: 4.08e-02, avg batch time: 0.4880, average train loss: 0.0005
[09/26 05:02:29 visual_prompt]: Inference (val):avg data time: 3.14e-05, avg batch time: 0.1672, average loss: 0.9443
[09/26 05:02:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.28	
[09/26 05:02:29 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.0018990308734739975
[09/26 05:02:35 visual_prompt]: Epoch 96 / 100: avg data time: 4.60e-02, avg batch time: 0.4914, average train loss: 0.0005
[09/26 05:02:37 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1675, average loss: 0.9446
[09/26 05:02:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.28	
[09/26 05:02:37 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.0012164914073037048
[09/26 05:02:43 visual_prompt]: Epoch 97 / 100: avg data time: 4.56e-02, avg batch time: 0.4921, average train loss: 0.0005
[09/26 05:02:45 visual_prompt]: Inference (val):avg data time: 3.33e-05, avg batch time: 0.1673, average loss: 0.9448
[09/26 05:02:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.28	
[09/26 05:02:45 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.0006847630789658388
[09/26 05:02:52 visual_prompt]: Epoch 98 / 100: avg data time: 5.57e-02, avg batch time: 0.5011, average train loss: 0.0005
[09/26 05:02:53 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1670, average loss: 0.9449
[09/26 05:02:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.28	
[09/26 05:02:53 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.0003044937175219753
[09/26 05:03:00 visual_prompt]: Epoch 99 / 100: avg data time: 5.59e-02, avg batch time: 0.5003, average train loss: 0.0005
[09/26 05:03:01 visual_prompt]: Inference (val):avg data time: 4.07e-05, avg batch time: 0.1676, average loss: 0.9449
[09/26 05:03:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.28	
[09/26 05:03:01 visual_prompt]: Training 100 / 100 epoch, with learning rate 7.614662261302974e-05
[09/26 05:03:08 visual_prompt]: Epoch 100 / 100: avg data time: 5.38e-02, avg batch time: 0.4982, average train loss: 0.0005
[09/26 05:03:10 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1674, average loss: 0.9449
[09/26 05:03:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.28	
[09/26 05:03:10 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 05:03:10 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 05:03:10 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 05:03:10 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 05:03:10 visual_prompt]: Training with config:
[09/26 05:03:10 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr0.25_wd0.0/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 0.25, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 05:03:10 visual_prompt]: Loading training data...
[09/26 05:03:10 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 05:03:11 visual_prompt]: Number of images: 800
[09/26 05:03:11 visual_prompt]: Number of classes: 2 / 2
[09/26 05:03:11 visual_prompt]: Loading validation data...
[09/26 05:03:11 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 05:03:11 visual_prompt]: Number of images: 200
[09/26 05:03:11 visual_prompt]: Number of classes: 2 / 2
[09/26 05:03:11 visual_prompt]: Constructing models...
[09/26 05:03:14 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 05:03:14 visual_prompt]: tuned percent:0.536
[09/26 05:03:14 visual_prompt]: Device used for model: 0
[09/26 05:03:14 visual_prompt]: Setting up Evaluator...
[09/26 05:03:14 visual_prompt]: Setting up Trainer...
[09/26 05:03:14 visual_prompt]: 	Setting up the optimizer...
[09/26 05:03:14 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 05:03:20 visual_prompt]: Epoch 1 / 100: avg data time: 4.21e-02, avg batch time: 0.4891, average train loss: 1.9887
[09/26 05:03:22 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1669, average loss: 2.0033
[09/26 05:03:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 05:03:22 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 05:03:22 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.025
[09/26 05:03:28 visual_prompt]: Epoch 2 / 100: avg data time: 5.23e-02, avg batch time: 0.4950, average train loss: 2.1621
[09/26 05:03:30 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1670, average loss: 0.6586
[09/26 05:03:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.00	rocauc: 70.45	
[09/26 05:03:30 visual_prompt]: Best epoch 2: best metric: 0.650
[09/26 05:03:30 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.05
[09/26 05:03:37 visual_prompt]: Epoch 3 / 100: avg data time: 5.67e-02, avg batch time: 0.4990, average train loss: 0.7599
[09/26 05:03:38 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1669, average loss: 0.7038
[09/26 05:03:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.11	
[09/26 05:03:38 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.075
[09/26 05:03:45 visual_prompt]: Epoch 4 / 100: avg data time: 5.26e-02, avg batch time: 0.4958, average train loss: 0.6677
[09/26 05:03:46 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1672, average loss: 0.5685
[09/26 05:03:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 67.00	rocauc: 89.51	
[09/26 05:03:46 visual_prompt]: Best epoch 4: best metric: 0.670
[09/26 05:03:46 visual_prompt]: Training 5 / 100 epoch, with learning rate 0.1
[09/26 05:03:53 visual_prompt]: Epoch 5 / 100: avg data time: 4.87e-02, avg batch time: 0.4926, average train loss: 0.6030
[09/26 05:03:54 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1671, average loss: 0.4867
[09/26 05:03:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.00	rocauc: 90.34	
[09/26 05:03:54 visual_prompt]: Best epoch 5: best metric: 0.750
[09/26 05:03:54 visual_prompt]: Training 6 / 100 epoch, with learning rate 0.125
[09/26 05:04:01 visual_prompt]: Epoch 6 / 100: avg data time: 6.42e-02, avg batch time: 0.5070, average train loss: 0.5435
[09/26 05:04:03 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1673, average loss: 0.4554
[09/26 05:04:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.50	rocauc: 90.59	
[09/26 05:04:03 visual_prompt]: Best epoch 6: best metric: 0.765
[09/26 05:04:03 visual_prompt]: Training 7 / 100 epoch, with learning rate 0.15
[09/26 05:04:10 visual_prompt]: Epoch 7 / 100: avg data time: 5.35e-02, avg batch time: 0.4973, average train loss: 0.5342
[09/26 05:04:11 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1673, average loss: 0.5062
[09/26 05:04:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.00	rocauc: 91.07	
[09/26 05:04:11 visual_prompt]: Best epoch 7: best metric: 0.770
[09/26 05:04:11 visual_prompt]: Training 8 / 100 epoch, with learning rate 0.175
[09/26 05:04:18 visual_prompt]: Epoch 8 / 100: avg data time: 5.20e-02, avg batch time: 0.4957, average train loss: 0.4993
[09/26 05:04:19 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1672, average loss: 0.3800
[09/26 05:04:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.52	
[09/26 05:04:19 visual_prompt]: Best epoch 8: best metric: 0.820
[09/26 05:04:19 visual_prompt]: Training 9 / 100 epoch, with learning rate 0.2
[09/26 05:04:26 visual_prompt]: Epoch 9 / 100: avg data time: 4.61e-02, avg batch time: 0.4893, average train loss: 0.5029
[09/26 05:04:27 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1672, average loss: 0.4765
[09/26 05:04:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 91.81	
[09/26 05:04:27 visual_prompt]: Training 10 / 100 epoch, with learning rate 0.225
[09/26 05:04:34 visual_prompt]: Epoch 10 / 100: avg data time: 4.23e-02, avg batch time: 0.4860, average train loss: 0.4711
[09/26 05:04:35 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1676, average loss: 0.3965
[09/26 05:04:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.31	
[09/26 05:04:35 visual_prompt]: Training 11 / 100 epoch, with learning rate 0.25
[09/26 05:04:42 visual_prompt]: Epoch 11 / 100: avg data time: 5.39e-02, avg batch time: 0.4965, average train loss: 0.4915
[09/26 05:04:44 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1670, average loss: 0.3755
[09/26 05:04:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 92.65	
[09/26 05:04:44 visual_prompt]: Training 12 / 100 epoch, with learning rate 0.24992385337738698
[09/26 05:04:50 visual_prompt]: Epoch 12 / 100: avg data time: 4.87e-02, avg batch time: 0.4928, average train loss: 0.4121
[09/26 05:04:52 visual_prompt]: Inference (val):avg data time: 3.26e-05, avg batch time: 0.1676, average loss: 0.5814
[09/26 05:04:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 90.96	
[09/26 05:04:52 visual_prompt]: Training 13 / 100 epoch, with learning rate 0.24969550628247802
[09/26 05:04:59 visual_prompt]: Epoch 13 / 100: avg data time: 5.16e-02, avg batch time: 0.4967, average train loss: 0.4070
[09/26 05:05:00 visual_prompt]: Inference (val):avg data time: 3.18e-05, avg batch time: 0.1677, average loss: 0.4292
[09/26 05:05:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 92.33	
[09/26 05:05:00 visual_prompt]: Training 14 / 100 epoch, with learning rate 0.24931523692103416
[09/26 05:05:07 visual_prompt]: Epoch 14 / 100: avg data time: 6.20e-02, avg batch time: 0.5051, average train loss: 0.3855
[09/26 05:05:08 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1672, average loss: 0.3843
[09/26 05:05:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.97	
[09/26 05:05:08 visual_prompt]: Best epoch 14: best metric: 0.830
[09/26 05:05:08 visual_prompt]: Training 15 / 100 epoch, with learning rate 0.2487835085926963
[09/26 05:05:15 visual_prompt]: Epoch 15 / 100: avg data time: 5.78e-02, avg batch time: 0.5006, average train loss: 0.4338
[09/26 05:05:17 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1674, average loss: 0.4623
[09/26 05:05:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 92.46	
[09/26 05:05:17 visual_prompt]: Training 16 / 100 epoch, with learning rate 0.24810096912652602
[09/26 05:05:23 visual_prompt]: Epoch 16 / 100: avg data time: 5.87e-02, avg batch time: 0.5027, average train loss: 0.4616
[09/26 05:05:25 visual_prompt]: Inference (val):avg data time: 3.29e-05, avg batch time: 0.1675, average loss: 0.3483
[09/26 05:05:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.48	
[09/26 05:05:25 visual_prompt]: Best epoch 16: best metric: 0.840
[09/26 05:05:25 visual_prompt]: Training 17 / 100 epoch, with learning rate 0.2472684500917257
[09/26 05:05:32 visual_prompt]: Epoch 17 / 100: avg data time: 5.15e-02, avg batch time: 0.4953, average train loss: 0.3416
[09/26 05:05:33 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1673, average loss: 0.3639
[09/26 05:05:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.34	
[09/26 05:05:33 visual_prompt]: Training 18 / 100 epoch, with learning rate 0.24628696578449955
[09/26 05:05:40 visual_prompt]: Epoch 18 / 100: avg data time: 5.36e-02, avg batch time: 0.4974, average train loss: 0.3163
[09/26 05:05:41 visual_prompt]: Inference (val):avg data time: 2.92e-05, avg batch time: 0.1674, average loss: 0.4119
[09/26 05:05:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 93.10	
[09/26 05:05:41 visual_prompt]: Training 19 / 100 epoch, with learning rate 0.24515771199228986
[09/26 05:05:48 visual_prompt]: Epoch 19 / 100: avg data time: 4.61e-02, avg batch time: 0.4910, average train loss: 0.3285
[09/26 05:05:49 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1672, average loss: 0.5003
[09/26 05:05:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.27	
[09/26 05:05:49 visual_prompt]: Training 20 / 100 epoch, with learning rate 0.2438820645368942
[09/26 05:05:56 visual_prompt]: Epoch 20 / 100: avg data time: 5.63e-02, avg batch time: 0.5006, average train loss: 0.2979
[09/26 05:05:58 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1672, average loss: 0.3164
[09/26 05:05:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 94.03	
[09/26 05:05:58 visual_prompt]: Best epoch 20: best metric: 0.875
[09/26 05:05:58 visual_prompt]: Training 21 / 100 epoch, with learning rate 0.24246157759823855
[09/26 05:06:04 visual_prompt]: Epoch 21 / 100: avg data time: 4.94e-02, avg batch time: 0.4930, average train loss: 0.3230
[09/26 05:06:06 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1675, average loss: 0.3227
[09/26 05:06:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 94.19	
[09/26 05:06:06 visual_prompt]: Training 22 / 100 epoch, with learning rate 0.24089798182084843
[09/26 05:06:12 visual_prompt]: Epoch 22 / 100: avg data time: 5.44e-02, avg batch time: 0.4982, average train loss: 0.2729
[09/26 05:06:14 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1673, average loss: 0.3557
[09/26 05:06:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.74	
[09/26 05:06:14 visual_prompt]: Training 23 / 100 epoch, with learning rate 0.2391931822053251
[09/26 05:06:21 visual_prompt]: Epoch 23 / 100: avg data time: 6.04e-02, avg batch time: 0.5038, average train loss: 0.2269
[09/26 05:06:22 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1673, average loss: 0.3675
[09/26 05:06:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 94.36	
[09/26 05:06:22 visual_prompt]: Training 24 / 100 epoch, with learning rate 0.23734925578739588
[09/26 05:06:29 visual_prompt]: Epoch 24 / 100: avg data time: 5.99e-02, avg batch time: 0.5031, average train loss: 0.2259
[09/26 05:06:30 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1671, average loss: 0.3346
[09/26 05:06:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.88	
[09/26 05:06:30 visual_prompt]: Training 25 / 100 epoch, with learning rate 0.23536844910736587
[09/26 05:06:37 visual_prompt]: Epoch 25 / 100: avg data time: 5.85e-02, avg batch time: 0.5016, average train loss: 0.2139
[09/26 05:06:39 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1673, average loss: 0.3723
[09/26 05:06:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.14	
[09/26 05:06:39 visual_prompt]: Training 26 / 100 epoch, with learning rate 0.23325317547305485
[09/26 05:06:45 visual_prompt]: Epoch 26 / 100: avg data time: 4.32e-02, avg batch time: 0.4894, average train loss: 0.1977
[09/26 05:06:47 visual_prompt]: Inference (val):avg data time: 4.09e-05, avg batch time: 0.1678, average loss: 0.4164
[09/26 05:06:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.71	
[09/26 05:06:47 visual_prompt]: Training 27 / 100 epoch, with learning rate 0.23100601201955323
[09/26 05:06:54 visual_prompt]: Epoch 27 / 100: avg data time: 6.00e-02, avg batch time: 0.5034, average train loss: 0.2033
[09/26 05:06:55 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1673, average loss: 0.3599
[09/26 05:06:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.08	
[09/26 05:06:55 visual_prompt]: Training 28 / 100 epoch, with learning rate 0.2286296965693802
[09/26 05:07:02 visual_prompt]: Epoch 28 / 100: avg data time: 4.92e-02, avg batch time: 0.4944, average train loss: 0.1583
[09/26 05:07:03 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1674, average loss: 0.4220
[09/26 05:07:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 94.19	
[09/26 05:07:03 visual_prompt]: Training 29 / 100 epoch, with learning rate 0.22612712429686843
[09/26 05:07:10 visual_prompt]: Epoch 29 / 100: avg data time: 5.69e-02, avg batch time: 0.5015, average train loss: 0.1742
[09/26 05:07:12 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1674, average loss: 0.7492
[09/26 05:07:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 92.17	
[09/26 05:07:12 visual_prompt]: Training 30 / 100 epoch, with learning rate 0.22350134420084022
[09/26 05:07:18 visual_prompt]: Epoch 30 / 100: avg data time: 4.29e-02, avg batch time: 0.4886, average train loss: 0.2889
[09/26 05:07:20 visual_prompt]: Inference (val):avg data time: 2.73e-05, avg batch time: 0.1674, average loss: 0.4120
[09/26 05:07:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.63	
[09/26 05:07:20 visual_prompt]: Training 31 / 100 epoch, with learning rate 0.22075555538987224
[09/26 05:07:27 visual_prompt]: Epoch 31 / 100: avg data time: 6.18e-02, avg batch time: 0.5055, average train loss: 0.1906
[09/26 05:07:28 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1671, average loss: 0.5632
[09/26 05:07:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 92.83	
[09/26 05:07:28 visual_prompt]: Training 32 / 100 epoch, with learning rate 0.21789310318467428
[09/26 05:07:35 visual_prompt]: Epoch 32 / 100: avg data time: 4.37e-02, avg batch time: 0.4890, average train loss: 0.1476
[09/26 05:07:36 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1675, average loss: 0.4758
[09/26 05:07:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.10	
[09/26 05:07:36 visual_prompt]: Training 33 / 100 epoch, with learning rate 0.21491747504233139
[09/26 05:07:43 visual_prompt]: Epoch 33 / 100: avg data time: 5.33e-02, avg batch time: 0.4976, average train loss: 0.1665
[09/26 05:07:44 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1672, average loss: 0.4972
[09/26 05:07:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.22	
[09/26 05:07:44 visual_prompt]: Training 34 / 100 epoch, with learning rate 0.21183229630737466
[09/26 05:07:51 visual_prompt]: Epoch 34 / 100: avg data time: 4.18e-02, avg batch time: 0.4876, average train loss: 0.1818
[09/26 05:07:53 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1674, average loss: 0.4415
[09/26 05:07:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.68	
[09/26 05:07:53 visual_prompt]: Training 35 / 100 epoch, with learning rate 0.20864132579485728
[09/26 05:07:59 visual_prompt]: Epoch 35 / 100: avg data time: 5.60e-02, avg batch time: 0.4996, average train loss: 0.2024
[09/26 05:08:01 visual_prompt]: Inference (val):avg data time: 3.04e-05, avg batch time: 0.1673, average loss: 0.3954
[09/26 05:08:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.56	
[09/26 05:08:01 visual_prompt]: Training 36 / 100 epoch, with learning rate 0.2053484512108174
[09/26 05:08:08 visual_prompt]: Epoch 36 / 100: avg data time: 5.01e-02, avg batch time: 0.4943, average train loss: 0.1488
[09/26 05:08:09 visual_prompt]: Inference (val):avg data time: 3.07e-05, avg batch time: 0.1677, average loss: 0.4845
[09/26 05:08:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.57	
[09/26 05:08:09 visual_prompt]: Training 37 / 100 epoch, with learning rate 0.20195768441570727
[09/26 05:08:16 visual_prompt]: Epoch 37 / 100: avg data time: 5.64e-02, avg batch time: 0.5011, average train loss: 0.1683
[09/26 05:08:17 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1677, average loss: 0.7854
[09/26 05:08:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 90.57	
[09/26 05:08:17 visual_prompt]: Training 38 / 100 epoch, with learning rate 0.19847315653655914
[09/26 05:08:24 visual_prompt]: Epoch 38 / 100: avg data time: 5.11e-02, avg batch time: 0.4971, average train loss: 0.1412
[09/26 05:08:26 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1672, average loss: 0.3890
[09/26 05:08:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.71	
[09/26 05:08:26 visual_prompt]: Best epoch 38: best metric: 0.880
[09/26 05:08:26 visual_prompt]: Training 39 / 100 epoch, with learning rate 0.19489911293384335
[09/26 05:08:32 visual_prompt]: Epoch 39 / 100: avg data time: 6.37e-02, avg batch time: 0.5081, average train loss: 0.0826
[09/26 05:08:34 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1674, average loss: 0.4667
[09/26 05:08:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.34	
[09/26 05:08:34 visual_prompt]: Training 40 / 100 epoch, with learning rate 0.1912399080291506
[09/26 05:08:41 visual_prompt]: Epoch 40 / 100: avg data time: 4.78e-02, avg batch time: 0.4940, average train loss: 0.0584
[09/26 05:08:42 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1675, average loss: 0.4894
[09/26 05:08:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.58	
[09/26 05:08:42 visual_prompt]: Training 41 / 100 epoch, with learning rate 0.1875
[09/26 05:08:49 visual_prompt]: Epoch 41 / 100: avg data time: 4.94e-02, avg batch time: 0.4958, average train loss: 0.0435
[09/26 05:08:50 visual_prompt]: Inference (val):avg data time: 3.18e-05, avg batch time: 0.1672, average loss: 0.5112
[09/26 05:08:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.29	
[09/26 05:08:50 visual_prompt]: Training 42 / 100 epoch, with learning rate 0.18368394534823634
[09/26 05:08:57 visual_prompt]: Epoch 42 / 100: avg data time: 4.22e-02, avg batch time: 0.4869, average train loss: 0.0583
[09/26 05:08:59 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1675, average loss: 0.4867
[09/26 05:08:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.25	
[09/26 05:08:59 visual_prompt]: Training 43 / 100 epoch, with learning rate 0.17979639334863468
[09/26 05:09:05 visual_prompt]: Epoch 43 / 100: avg data time: 5.08e-02, avg batch time: 0.4955, average train loss: 0.0298
[09/26 05:09:07 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1671, average loss: 0.5623
[09/26 05:09:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.14	
[09/26 05:09:07 visual_prompt]: Training 44 / 100 epoch, with learning rate 0.17584208038447505
[09/26 05:09:13 visual_prompt]: Epoch 44 / 100: avg data time: 5.31e-02, avg batch time: 0.4994, average train loss: 0.0167
[09/26 05:09:15 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1675, average loss: 0.5857
[09/26 05:09:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 94.72	
[09/26 05:09:15 visual_prompt]: Training 45 / 100 epoch, with learning rate 0.17182582417698902
[09/26 05:09:22 visual_prompt]: Epoch 45 / 100: avg data time: 5.91e-02, avg batch time: 0.5027, average train loss: 0.0540
[09/26 05:09:23 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1672, average loss: 0.7365
[09/26 05:09:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.07	
[09/26 05:09:23 visual_prompt]: Training 46 / 100 epoch, with learning rate 0.1677525179157086
[09/26 05:09:30 visual_prompt]: Epoch 46 / 100: avg data time: 5.88e-02, avg batch time: 0.5023, average train loss: 0.0372
[09/26 05:09:31 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1676, average loss: 0.5336
[09/26 05:09:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.73	
[09/26 05:09:31 visual_prompt]: Training 47 / 100 epoch, with learning rate 0.16362712429686843
[09/26 05:09:38 visual_prompt]: Epoch 47 / 100: avg data time: 5.07e-02, avg batch time: 0.4958, average train loss: 0.0266
[09/26 05:09:40 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1673, average loss: 0.5787
[09/26 05:09:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.58	
[09/26 05:09:40 visual_prompt]: Training 48 / 100 epoch, with learning rate 0.1594546694771249
[09/26 05:09:46 visual_prompt]: Epoch 48 / 100: avg data time: 4.11e-02, avg batch time: 0.4887, average train loss: 0.0417
[09/26 05:09:48 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1671, average loss: 0.6601
[09/26 05:09:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.21	
[09/26 05:09:48 visual_prompt]: Training 49 / 100 epoch, with learning rate 0.15524023694995845
[09/26 05:09:54 visual_prompt]: Epoch 49 / 100: avg data time: 5.33e-02, avg batch time: 0.4975, average train loss: 0.0380
[09/26 05:09:56 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1672, average loss: 0.8308
[09/26 05:09:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 91.27	
[09/26 05:09:56 visual_prompt]: Training 50 / 100 epoch, with learning rate 0.1509889613522199
[09/26 05:10:03 visual_prompt]: Epoch 50 / 100: avg data time: 4.30e-02, avg batch time: 0.4880, average train loss: 0.0598
[09/26 05:10:04 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1672, average loss: 0.6486
[09/26 05:10:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.25	
[09/26 05:10:04 visual_prompt]: Training 51 / 100 epoch, with learning rate 0.14670602220836632
[09/26 05:10:11 visual_prompt]: Epoch 51 / 100: avg data time: 4.18e-02, avg batch time: 0.4875, average train loss: 0.0371
[09/26 05:10:12 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1674, average loss: 0.7042
[09/26 05:10:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.10	
[09/26 05:10:12 visual_prompt]: Training 52 / 100 epoch, with learning rate 0.14239663762000818
[09/26 05:10:19 visual_prompt]: Epoch 52 / 100: avg data time: 5.96e-02, avg batch time: 0.5051, average train loss: 0.0359
[09/26 05:10:20 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1675, average loss: 0.6743
[09/26 05:10:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.05	
[09/26 05:10:20 visual_prompt]: Training 53 / 100 epoch, with learning rate 0.1380660579084567
[09/26 05:10:27 visual_prompt]: Epoch 53 / 100: avg data time: 4.32e-02, avg batch time: 0.4874, average train loss: 0.0195
[09/26 05:10:28 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1680, average loss: 0.6353
[09/26 05:10:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 92.99	
[09/26 05:10:28 visual_prompt]: Training 54 / 100 epoch, with learning rate 0.13371955921801565
[09/26 05:10:35 visual_prompt]: Epoch 54 / 100: avg data time: 5.79e-02, avg batch time: 0.5021, average train loss: 0.0091
[09/26 05:10:37 visual_prompt]: Inference (val):avg data time: 2.95e-05, avg batch time: 0.1678, average loss: 0.6929
[09/26 05:10:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 92.92	
[09/26 05:10:37 visual_prompt]: Training 55 / 100 epoch, with learning rate 0.12936243708781264
[09/26 05:10:43 visual_prompt]: Epoch 55 / 100: avg data time: 5.48e-02, avg batch time: 0.4985, average train loss: 0.0041
[09/26 05:10:45 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1676, average loss: 0.8061
[09/26 05:10:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.51	
[09/26 05:10:45 visual_prompt]: Training 56 / 100 epoch, with learning rate 0.125
[09/26 05:10:51 visual_prompt]: Epoch 56 / 100: avg data time: 4.07e-02, avg batch time: 0.4856, average train loss: 0.0049
[09/26 05:10:53 visual_prompt]: Inference (val):avg data time: 2.92e-05, avg batch time: 0.1675, average loss: 0.8310
[09/26 05:10:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.81	
[09/26 05:10:53 visual_prompt]: Training 57 / 100 epoch, with learning rate 0.12063756291218741
[09/26 05:11:00 visual_prompt]: Epoch 57 / 100: avg data time: 5.74e-02, avg batch time: 0.5031, average train loss: 0.0422
[09/26 05:11:01 visual_prompt]: Inference (val):avg data time: 3.07e-05, avg batch time: 0.1678, average loss: 0.6383
[09/26 05:11:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 95.02	
[09/26 05:11:01 visual_prompt]: Training 58 / 100 epoch, with learning rate 0.11628044078198434
[09/26 05:11:08 visual_prompt]: Epoch 58 / 100: avg data time: 5.06e-02, avg batch time: 0.4952, average train loss: 0.0674
[09/26 05:11:10 visual_prompt]: Inference (val):avg data time: 3.21e-05, avg batch time: 0.1674, average loss: 0.5440
[09/26 05:11:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.76	
[09/26 05:11:10 visual_prompt]: Training 59 / 100 epoch, with learning rate 0.11193394209154334
[09/26 05:11:16 visual_prompt]: Epoch 59 / 100: avg data time: 5.69e-02, avg batch time: 0.5012, average train loss: 0.0400
[09/26 05:11:18 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1676, average loss: 0.5077
[09/26 05:11:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 94.24	
[09/26 05:11:18 visual_prompt]: Training 60 / 100 epoch, with learning rate 0.10760336237999185
[09/26 05:11:24 visual_prompt]: Epoch 60 / 100: avg data time: 4.25e-02, avg batch time: 0.4875, average train loss: 0.0217
[09/26 05:11:26 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1676, average loss: 0.4903
[09/26 05:11:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 94.60	
[09/26 05:11:26 visual_prompt]: Best epoch 60: best metric: 0.885
[09/26 05:11:26 visual_prompt]: Training 61 / 100 epoch, with learning rate 0.10329397779163371
[09/26 05:11:33 visual_prompt]: Epoch 61 / 100: avg data time: 5.85e-02, avg batch time: 0.5034, average train loss: 0.0113
[09/26 05:11:34 visual_prompt]: Inference (val):avg data time: 3.26e-05, avg batch time: 0.1678, average loss: 0.5472
[09/26 05:11:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 94.42	
[09/26 05:11:34 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.0990110386477801
[09/26 05:11:41 visual_prompt]: Epoch 62 / 100: avg data time: 4.28e-02, avg batch time: 0.4882, average train loss: 0.0200
[09/26 05:11:42 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1676, average loss: 0.5644
[09/26 05:11:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 94.10	
[09/26 05:11:42 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.09475976305004155
[09/26 05:11:49 visual_prompt]: Epoch 63 / 100: avg data time: 5.38e-02, avg batch time: 0.4982, average train loss: 0.0303
[09/26 05:11:50 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1672, average loss: 0.5297
[09/26 05:11:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 95.40	
[09/26 05:11:50 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.09054533052287511
[09/26 05:11:57 visual_prompt]: Epoch 64 / 100: avg data time: 5.42e-02, avg batch time: 0.4980, average train loss: 0.0098
[09/26 05:11:59 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1674, average loss: 0.4676
[09/26 05:11:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 91.50	rocauc: 95.54	
[09/26 05:11:59 visual_prompt]: Best epoch 64: best metric: 0.915
[09/26 05:11:59 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.08637287570313158
[09/26 05:12:05 visual_prompt]: Epoch 65 / 100: avg data time: 5.69e-02, avg batch time: 0.5005, average train loss: 0.0028
[09/26 05:12:07 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1675, average loss: 0.5561
[09/26 05:12:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 95.30	
[09/26 05:12:07 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.08224748208429142
[09/26 05:12:14 visual_prompt]: Epoch 66 / 100: avg data time: 5.82e-02, avg batch time: 0.5032, average train loss: 0.0023
[09/26 05:12:15 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1672, average loss: 0.5063
[09/26 05:12:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 90.00	rocauc: 95.43	
[09/26 05:12:15 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.07817417582301099
[09/26 05:12:22 visual_prompt]: Epoch 67 / 100: avg data time: 4.63e-02, avg batch time: 0.4907, average train loss: 0.0015
[09/26 05:12:23 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1677, average loss: 0.5190
[09/26 05:12:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 90.00	rocauc: 95.34	
[09/26 05:12:23 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.074157919615525
[09/26 05:12:30 visual_prompt]: Epoch 68 / 100: avg data time: 4.90e-02, avg batch time: 0.4928, average train loss: 0.0015
[09/26 05:12:32 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1672, average loss: 0.5282
[09/26 05:12:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 90.00	rocauc: 95.31	
[09/26 05:12:32 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.07020360665136531
[09/26 05:12:38 visual_prompt]: Epoch 69 / 100: avg data time: 4.62e-02, avg batch time: 0.4911, average train loss: 0.0016
[09/26 05:12:40 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1673, average loss: 0.5563
[09/26 05:12:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.29	
[09/26 05:12:40 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.06631605465176368
[09/26 05:12:46 visual_prompt]: Epoch 70 / 100: avg data time: 5.71e-02, avg batch time: 0.5018, average train loss: 0.0011
[09/26 05:12:48 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1674, average loss: 0.5692
[09/26 05:12:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.00	rocauc: 95.31	
[09/26 05:12:48 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.06250000000000003
[09/26 05:12:55 visual_prompt]: Epoch 71 / 100: avg data time: 4.49e-02, avg batch time: 0.4892, average train loss: 0.0012
[09/26 05:12:56 visual_prompt]: Inference (val):avg data time: 2.70e-05, avg batch time: 0.1676, average loss: 0.5697
[09/26 05:12:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 95.32	
[09/26 05:12:56 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.0587600919708494
[09/26 05:13:03 visual_prompt]: Epoch 72 / 100: avg data time: 5.87e-02, avg batch time: 0.5026, average train loss: 0.0008
[09/26 05:13:04 visual_prompt]: Inference (val):avg data time: 2.70e-05, avg batch time: 0.1675, average loss: 0.5784
[09/26 05:13:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 95.31	
[09/26 05:13:04 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.055100887066156665
[09/26 05:13:11 visual_prompt]: Epoch 73 / 100: avg data time: 4.56e-02, avg batch time: 0.4908, average train loss: 0.0014
[09/26 05:13:12 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1678, average loss: 0.6280
[09/26 05:13:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.28	
[09/26 05:13:12 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.05152684346344087
[09/26 05:13:19 visual_prompt]: Epoch 74 / 100: avg data time: 5.28e-02, avg batch time: 0.4966, average train loss: 0.0013
[09/26 05:13:21 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1673, average loss: 0.6454
[09/26 05:13:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.20	
[09/26 05:13:21 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.048042315584292714
[09/26 05:13:27 visual_prompt]: Epoch 75 / 100: avg data time: 4.95e-02, avg batch time: 0.4950, average train loss: 0.0011
[09/26 05:13:29 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1676, average loss: 0.6042
[09/26 05:13:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.19	
[09/26 05:13:29 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.04465154878918258
[09/26 05:13:35 visual_prompt]: Epoch 76 / 100: avg data time: 5.46e-02, avg batch time: 0.4978, average train loss: 0.0008
[09/26 05:13:37 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1676, average loss: 0.5940
[09/26 05:13:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.22	
[09/26 05:13:37 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.04135867420514276
[09/26 05:13:44 visual_prompt]: Epoch 77 / 100: avg data time: 4.48e-02, avg batch time: 0.4900, average train loss: 0.0008
[09/26 05:13:45 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1674, average loss: 0.5932
[09/26 05:13:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 90.00	rocauc: 95.24	
[09/26 05:13:45 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.03816770369262533
[09/26 05:13:52 visual_prompt]: Epoch 78 / 100: avg data time: 6.24e-02, avg batch time: 0.5075, average train loss: 0.0008
[09/26 05:13:53 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1680, average loss: 0.5975
[09/26 05:13:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 90.00	rocauc: 95.20	
[09/26 05:13:53 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.03508252495766863
[09/26 05:14:00 visual_prompt]: Epoch 79 / 100: avg data time: 4.62e-02, avg batch time: 0.4903, average train loss: 0.0006
[09/26 05:14:02 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1671, average loss: 0.6032
[09/26 05:14:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.21	
[09/26 05:14:02 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.032106896815325706
[09/26 05:14:08 visual_prompt]: Epoch 80 / 100: avg data time: 6.00e-02, avg batch time: 0.5049, average train loss: 0.0007
[09/26 05:14:10 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1675, average loss: 0.6064
[09/26 05:14:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.22	
[09/26 05:14:10 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.029244444610127762
[09/26 05:14:17 visual_prompt]: Epoch 81 / 100: avg data time: 5.89e-02, avg batch time: 0.5036, average train loss: 0.0006
[09/26 05:14:18 visual_prompt]: Inference (val):avg data time: 3.04e-05, avg batch time: 0.1674, average loss: 0.6090
[09/26 05:14:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.22	
[09/26 05:14:18 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.026498655799159762
[09/26 05:14:25 visual_prompt]: Epoch 82 / 100: avg data time: 5.71e-02, avg batch time: 0.5003, average train loss: 0.0006
[09/26 05:14:26 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1676, average loss: 0.6111
[09/26 05:14:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.22	
[09/26 05:14:26 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.023872875703131582
[09/26 05:14:33 visual_prompt]: Epoch 83 / 100: avg data time: 4.36e-02, avg batch time: 0.4874, average train loss: 0.0005
[09/26 05:14:35 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1674, average loss: 0.6130
[09/26 05:14:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.22	
[09/26 05:14:35 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.021370303430619797
[09/26 05:14:41 visual_prompt]: Epoch 84 / 100: avg data time: 5.34e-02, avg batch time: 0.4970, average train loss: 0.0006
[09/26 05:14:43 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1673, average loss: 0.6139
[09/26 05:14:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.23	
[09/26 05:14:43 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.018993987980446755
[09/26 05:14:50 visual_prompt]: Epoch 85 / 100: avg data time: 5.90e-02, avg batch time: 0.5025, average train loss: 0.0006
[09/26 05:14:51 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1673, average loss: 0.6148
[09/26 05:14:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.23	
[09/26 05:14:51 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.01674682452694516
[09/26 05:14:58 visual_prompt]: Epoch 86 / 100: avg data time: 4.95e-02, avg batch time: 0.4953, average train loss: 0.0005
[09/26 05:14:59 visual_prompt]: Inference (val):avg data time: 2.95e-05, avg batch time: 0.1677, average loss: 0.6155
[09/26 05:14:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.22	
[09/26 05:14:59 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.014631550892634126
[09/26 05:15:06 visual_prompt]: Epoch 87 / 100: avg data time: 4.67e-02, avg batch time: 0.4911, average train loss: 0.0005
[09/26 05:15:07 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1676, average loss: 0.6162
[09/26 05:15:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.22	
[09/26 05:15:07 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.012650744212604148
[09/26 05:15:14 visual_prompt]: Epoch 88 / 100: avg data time: 5.75e-02, avg batch time: 0.5024, average train loss: 0.0004
[09/26 05:15:15 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1676, average loss: 0.6168
[09/26 05:15:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.22	
[09/26 05:15:15 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.010806817794674878
[09/26 05:15:22 visual_prompt]: Epoch 89 / 100: avg data time: 5.21e-02, avg batch time: 0.4971, average train loss: 0.0005
[09/26 05:15:24 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.1676, average loss: 0.6173
[09/26 05:15:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.22	
[09/26 05:15:24 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.009102018179151586
[09/26 05:15:30 visual_prompt]: Epoch 90 / 100: avg data time: 5.76e-02, avg batch time: 0.5019, average train loss: 0.0006
[09/26 05:15:32 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1675, average loss: 0.6174
[09/26 05:15:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.00	rocauc: 95.22	
[09/26 05:15:32 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.00753842240176146
[09/26 05:15:39 visual_prompt]: Epoch 91 / 100: avg data time: 5.01e-02, avg batch time: 0.4949, average train loss: 0.0006
[09/26 05:15:40 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1677, average loss: 0.6182
[09/26 05:15:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.00	rocauc: 95.23	
[09/26 05:15:40 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.006117935463105809
[09/26 05:15:47 visual_prompt]: Epoch 92 / 100: avg data time: 5.27e-02, avg batch time: 0.4977, average train loss: 0.0005
[09/26 05:15:48 visual_prompt]: Inference (val):avg data time: 3.36e-05, avg batch time: 0.1677, average loss: 0.6210
[09/26 05:15:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.22	
[09/26 05:15:48 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.004842288007710138
[09/26 05:15:55 visual_prompt]: Epoch 93 / 100: avg data time: 4.28e-02, avg batch time: 0.4880, average train loss: 0.0004
[09/26 05:15:56 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1674, average loss: 0.6216
[09/26 05:15:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.23	
[09/26 05:15:56 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.003713034215500441
[09/26 05:16:03 visual_prompt]: Epoch 94 / 100: avg data time: 5.80e-02, avg batch time: 0.5026, average train loss: 0.0005
[09/26 05:16:05 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1676, average loss: 0.6217
[09/26 05:16:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.23	
[09/26 05:16:05 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.002731549908274289
[09/26 05:16:11 visual_prompt]: Epoch 95 / 100: avg data time: 5.31e-02, avg batch time: 0.4986, average train loss: 0.0006
[09/26 05:16:13 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1673, average loss: 0.6218
[09/26 05:16:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.23	
[09/26 05:16:13 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.0018990308734739975
[09/26 05:16:20 visual_prompt]: Epoch 96 / 100: avg data time: 5.59e-02, avg batch time: 0.5004, average train loss: 0.0005
[09/26 05:16:21 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1672, average loss: 0.6220
[09/26 05:16:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.23	
[09/26 05:16:21 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.0012164914073037048
[09/26 05:16:28 visual_prompt]: Epoch 97 / 100: avg data time: 4.95e-02, avg batch time: 0.4956, average train loss: 0.0005
[09/26 05:16:29 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1671, average loss: 0.6220
[09/26 05:16:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.23	
[09/26 05:16:29 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.0006847630789658388
[09/26 05:16:36 visual_prompt]: Epoch 98 / 100: avg data time: 4.52e-02, avg batch time: 0.4901, average train loss: 0.0005
[09/26 05:16:37 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1673, average loss: 0.6221
[09/26 05:16:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.23	
[09/26 05:16:37 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.0003044937175219753
[09/26 05:16:44 visual_prompt]: Epoch 99 / 100: avg data time: 5.26e-02, avg batch time: 0.4989, average train loss: 0.0005
[09/26 05:16:46 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1672, average loss: 0.6221
[09/26 05:16:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.23	
[09/26 05:16:46 visual_prompt]: Training 100 / 100 epoch, with learning rate 7.614662261302974e-05
[09/26 05:16:52 visual_prompt]: Epoch 100 / 100: avg data time: 4.88e-02, avg batch time: 0.4944, average train loss: 0.0005
[09/26 05:16:54 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1674, average loss: 0.6221
[09/26 05:16:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.50	rocauc: 95.23	
[09/26 05:16:54 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 05:16:54 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 05:16:54 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 05:16:54 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 05:16:54 visual_prompt]: Training with config:
[09/26 05:16:54 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr0.1_wd0.01/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.01, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 0.1, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 05:16:54 visual_prompt]: Loading training data...
[09/26 05:16:54 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 05:16:55 visual_prompt]: Number of images: 800
[09/26 05:16:55 visual_prompt]: Number of classes: 2 / 2
[09/26 05:16:55 visual_prompt]: Loading validation data...
[09/26 05:16:55 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 05:16:55 visual_prompt]: Number of images: 200
[09/26 05:16:55 visual_prompt]: Number of classes: 2 / 2
[09/26 05:16:55 visual_prompt]: Constructing models...
[09/26 05:16:58 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 05:16:58 visual_prompt]: tuned percent:0.536
[09/26 05:16:58 visual_prompt]: Device used for model: 0
[09/26 05:16:58 visual_prompt]: Setting up Evaluator...
[09/26 05:16:58 visual_prompt]: Setting up Trainer...
[09/26 05:16:58 visual_prompt]: 	Setting up the optimizer...
[09/26 05:16:58 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 05:17:05 visual_prompt]: Epoch 1 / 100: avg data time: 5.98e-02, avg batch time: 0.5030, average train loss: 1.9523
[09/26 05:17:06 visual_prompt]: Inference (val):avg data time: 2.92e-05, avg batch time: 0.1669, average loss: 2.0033
[09/26 05:17:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 05:17:06 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 05:17:06 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.010000000000000002
[09/26 05:17:13 visual_prompt]: Epoch 2 / 100: avg data time: 5.16e-02, avg batch time: 0.4946, average train loss: 1.4364
[09/26 05:17:14 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1672, average loss: 0.7157
[09/26 05:17:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 50.00	rocauc: 63.66	
[09/26 05:17:14 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.020000000000000004
[09/26 05:17:21 visual_prompt]: Epoch 3 / 100: avg data time: 4.41e-02, avg batch time: 0.4891, average train loss: 0.7391
[09/26 05:17:23 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1671, average loss: 0.6457
[09/26 05:17:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 59.00	rocauc: 86.32	
[09/26 05:17:23 visual_prompt]: Best epoch 3: best metric: 0.590
[09/26 05:17:23 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.03
[09/26 05:17:29 visual_prompt]: Epoch 4 / 100: avg data time: 4.76e-02, avg batch time: 0.4899, average train loss: 0.6494
[09/26 05:17:31 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1671, average loss: 0.5178
[09/26 05:17:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.50	rocauc: 89.58	
[09/26 05:17:31 visual_prompt]: Best epoch 4: best metric: 0.755
[09/26 05:17:31 visual_prompt]: Training 5 / 100 epoch, with learning rate 0.04000000000000001
[09/26 05:17:37 visual_prompt]: Epoch 5 / 100: avg data time: 5.59e-02, avg batch time: 0.5000, average train loss: 0.5375
[09/26 05:17:39 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1671, average loss: 0.4343
[09/26 05:17:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.50	rocauc: 89.76	
[09/26 05:17:39 visual_prompt]: Best epoch 5: best metric: 0.775
[09/26 05:17:39 visual_prompt]: Training 6 / 100 epoch, with learning rate 0.05
[09/26 05:17:46 visual_prompt]: Epoch 6 / 100: avg data time: 4.39e-02, avg batch time: 0.4887, average train loss: 0.6235
[09/26 05:17:47 visual_prompt]: Inference (val):avg data time: 2.73e-05, avg batch time: 0.1674, average loss: 0.4477
[09/26 05:17:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 90.16	
[09/26 05:17:47 visual_prompt]: Best epoch 6: best metric: 0.780
[09/26 05:17:47 visual_prompt]: Training 7 / 100 epoch, with learning rate 0.06
[09/26 05:17:54 visual_prompt]: Epoch 7 / 100: avg data time: 5.39e-02, avg batch time: 0.4971, average train loss: 0.4763
[09/26 05:17:55 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1672, average loss: 0.4732
[09/26 05:17:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.50	rocauc: 90.33	
[09/26 05:17:55 visual_prompt]: Training 8 / 100 epoch, with learning rate 0.06999999999999999
[09/26 05:18:02 visual_prompt]: Epoch 8 / 100: avg data time: 6.23e-02, avg batch time: 0.5058, average train loss: 0.4722
[09/26 05:18:04 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1670, average loss: 0.4075
[09/26 05:18:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 91.20	
[09/26 05:18:04 visual_prompt]: Best epoch 8: best metric: 0.795
[09/26 05:18:04 visual_prompt]: Training 9 / 100 epoch, with learning rate 0.08000000000000002
[09/26 05:18:10 visual_prompt]: Epoch 9 / 100: avg data time: 4.18e-02, avg batch time: 0.4869, average train loss: 0.4738
[09/26 05:18:12 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1671, average loss: 0.4682
[09/26 05:18:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.00	rocauc: 91.00	
[09/26 05:18:12 visual_prompt]: Training 10 / 100 epoch, with learning rate 0.09000000000000001
[09/26 05:18:18 visual_prompt]: Epoch 10 / 100: avg data time: 4.26e-02, avg batch time: 0.4878, average train loss: 0.4953
[09/26 05:18:20 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1673, average loss: 0.3937
[09/26 05:18:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.58	
[09/26 05:18:20 visual_prompt]: Best epoch 10: best metric: 0.825
[09/26 05:18:20 visual_prompt]: Training 11 / 100 epoch, with learning rate 0.1
[09/26 05:18:27 visual_prompt]: Epoch 11 / 100: avg data time: 5.48e-02, avg batch time: 0.4984, average train loss: 0.4459
[09/26 05:18:28 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1672, average loss: 0.3999
[09/26 05:18:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.29	
[09/26 05:18:28 visual_prompt]: Best epoch 11: best metric: 0.835
[09/26 05:18:28 visual_prompt]: Training 12 / 100 epoch, with learning rate 0.0999695413509548
[09/26 05:18:35 visual_prompt]: Epoch 12 / 100: avg data time: 4.22e-02, avg batch time: 0.4872, average train loss: 0.4679
[09/26 05:18:36 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1670, average loss: 0.5115
[09/26 05:18:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.00	rocauc: 91.62	
[09/26 05:18:36 visual_prompt]: Training 13 / 100 epoch, with learning rate 0.09987820251299122
[09/26 05:18:43 visual_prompt]: Epoch 13 / 100: avg data time: 4.37e-02, avg batch time: 0.4895, average train loss: 0.4778
[09/26 05:18:44 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1675, average loss: 0.5180
[09/26 05:18:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.50	rocauc: 91.11	
[09/26 05:18:44 visual_prompt]: Training 14 / 100 epoch, with learning rate 0.09972609476841367
[09/26 05:18:51 visual_prompt]: Epoch 14 / 100: avg data time: 5.46e-02, avg batch time: 0.4994, average train loss: 0.4473
[09/26 05:18:52 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1679, average loss: 0.4245
[09/26 05:18:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 93.47	
[09/26 05:18:52 visual_prompt]: Training 15 / 100 epoch, with learning rate 0.09951340343707853
[09/26 05:18:59 visual_prompt]: Epoch 15 / 100: avg data time: 4.17e-02, avg batch time: 0.4864, average train loss: 0.4321
[09/26 05:19:01 visual_prompt]: Inference (val):avg data time: 4.61e-05, avg batch time: 0.1675, average loss: 0.3599
[09/26 05:19:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.11	
[09/26 05:19:01 visual_prompt]: Best epoch 15: best metric: 0.865
[09/26 05:19:01 visual_prompt]: Training 16 / 100 epoch, with learning rate 0.09924038765061041
[09/26 05:19:07 visual_prompt]: Epoch 16 / 100: avg data time: 4.72e-02, avg batch time: 0.4920, average train loss: 0.3642
[09/26 05:19:09 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1676, average loss: 0.3733
[09/26 05:19:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 91.42	
[09/26 05:19:09 visual_prompt]: Training 17 / 100 epoch, with learning rate 0.09890738003669029
[09/26 05:19:15 visual_prompt]: Epoch 17 / 100: avg data time: 4.17e-02, avg batch time: 0.4856, average train loss: 0.4033
[09/26 05:19:17 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1674, average loss: 0.4091
[09/26 05:19:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.46	
[09/26 05:19:17 visual_prompt]: Training 18 / 100 epoch, with learning rate 0.09851478631379983
[09/26 05:19:23 visual_prompt]: Epoch 18 / 100: avg data time: 4.42e-02, avg batch time: 0.4886, average train loss: 0.4405
[09/26 05:19:25 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1672, average loss: 0.7587
[09/26 05:19:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 61.00	rocauc: 84.67	
[09/26 05:19:25 visual_prompt]: Training 19 / 100 epoch, with learning rate 0.09806308479691594
[09/26 05:19:32 visual_prompt]: Epoch 19 / 100: avg data time: 5.71e-02, avg batch time: 0.5017, average train loss: 0.6085
[09/26 05:19:33 visual_prompt]: Inference (val):avg data time: 3.03e-05, avg batch time: 0.1673, average loss: 0.8516
[09/26 05:19:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 83.13	
[09/26 05:19:33 visual_prompt]: Training 20 / 100 epoch, with learning rate 0.09755282581475769
[09/26 05:19:40 visual_prompt]: Epoch 20 / 100: avg data time: 5.43e-02, avg batch time: 0.4975, average train loss: 0.6861
[09/26 05:19:41 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1677, average loss: 0.6816
[09/26 05:19:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 49.00	rocauc: 92.32	
[09/26 05:19:41 visual_prompt]: Training 21 / 100 epoch, with learning rate 0.09698463103929543
[09/26 05:19:48 visual_prompt]: Epoch 21 / 100: avg data time: 5.77e-02, avg batch time: 0.5010, average train loss: 0.5300
[09/26 05:19:50 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1673, average loss: 0.4991
[09/26 05:19:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 93.26	
[09/26 05:19:50 visual_prompt]: Training 22 / 100 epoch, with learning rate 0.09635919272833937
[09/26 05:19:57 visual_prompt]: Epoch 22 / 100: avg data time: 5.85e-02, avg batch time: 0.5016, average train loss: 0.4619
[09/26 05:19:58 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1675, average loss: 0.4519
[09/26 05:19:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 89.89	
[09/26 05:19:58 visual_prompt]: Training 23 / 100 epoch, with learning rate 0.09567727288213004
[09/26 05:20:05 visual_prompt]: Epoch 23 / 100: avg data time: 6.28e-02, avg batch time: 0.5064, average train loss: 0.5288
[09/26 05:20:06 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1676, average loss: 0.4303
[09/26 05:20:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.26	
[09/26 05:20:06 visual_prompt]: Training 24 / 100 epoch, with learning rate 0.09493970231495835
[09/26 05:20:13 visual_prompt]: Epoch 24 / 100: avg data time: 5.81e-02, avg batch time: 0.5022, average train loss: 0.4341
[09/26 05:20:15 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1674, average loss: 0.2984
[09/26 05:20:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 95.47	
[09/26 05:20:15 visual_prompt]: Training 25 / 100 epoch, with learning rate 0.09414737964294635
[09/26 05:20:21 visual_prompt]: Epoch 25 / 100: avg data time: 4.67e-02, avg batch time: 0.4918, average train loss: 0.5670
[09/26 05:20:23 visual_prompt]: Inference (val):avg data time: 3.18e-05, avg batch time: 0.1677, average loss: 0.5341
[09/26 05:20:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 94.14	
[09/26 05:20:23 visual_prompt]: Training 26 / 100 epoch, with learning rate 0.09330127018922195
[09/26 05:20:30 visual_prompt]: Epoch 26 / 100: avg data time: 4.49e-02, avg batch time: 0.4919, average train loss: 0.6301
[09/26 05:20:31 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1673, average loss: 0.6438
[09/26 05:20:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 59.50	rocauc: 89.85	
[09/26 05:20:31 visual_prompt]: Training 27 / 100 epoch, with learning rate 0.0924024048078213
[09/26 05:20:38 visual_prompt]: Epoch 27 / 100: avg data time: 5.44e-02, avg batch time: 0.4985, average train loss: 0.5916
[09/26 05:20:39 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1676, average loss: 0.4105
[09/26 05:20:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 94.15	
[09/26 05:20:39 visual_prompt]: Training 28 / 100 epoch, with learning rate 0.09145187862775209
[09/26 05:20:46 visual_prompt]: Epoch 28 / 100: avg data time: 5.51e-02, avg batch time: 0.4999, average train loss: 0.4508
[09/26 05:20:48 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1677, average loss: 0.6484
[09/26 05:20:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.00	rocauc: 91.81	
[09/26 05:20:48 visual_prompt]: Training 29 / 100 epoch, with learning rate 0.09045084971874738
[09/26 05:20:55 visual_prompt]: Epoch 29 / 100: avg data time: 7.11e-02, avg batch time: 0.5145, average train loss: 0.4822
[09/26 05:20:56 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1675, average loss: 0.4259
[09/26 05:20:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 94.11	
[09/26 05:20:56 visual_prompt]: Training 30 / 100 epoch, with learning rate 0.0894005376803361
[09/26 05:21:03 visual_prompt]: Epoch 30 / 100: avg data time: 4.07e-02, avg batch time: 0.4869, average train loss: 0.4380
[09/26 05:21:04 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1674, average loss: 0.4811
[09/26 05:21:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 91.64	
[09/26 05:21:04 visual_prompt]: Training 31 / 100 epoch, with learning rate 0.0883022221559489
[09/26 05:21:11 visual_prompt]: Epoch 31 / 100: avg data time: 5.33e-02, avg batch time: 0.4974, average train loss: 0.4310
[09/26 05:21:12 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1675, average loss: 0.5031
[09/26 05:21:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 94.56	
[09/26 05:21:12 visual_prompt]: Training 32 / 100 epoch, with learning rate 0.08715724127386971
[09/26 05:21:19 visual_prompt]: Epoch 32 / 100: avg data time: 5.62e-02, avg batch time: 0.5002, average train loss: 0.4880
[09/26 05:21:21 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1673, average loss: 0.4413
[09/26 05:21:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 95.44	
[09/26 05:21:21 visual_prompt]: Training 33 / 100 epoch, with learning rate 0.08596699001693256
[09/26 05:21:27 visual_prompt]: Epoch 33 / 100: avg data time: 5.54e-02, avg batch time: 0.5007, average train loss: 0.4073
[09/26 05:21:29 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1676, average loss: 0.6607
[09/26 05:21:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 67.00	rocauc: 91.09	
[09/26 05:21:29 visual_prompt]: Training 34 / 100 epoch, with learning rate 0.08473291852294987
[09/26 05:21:35 visual_prompt]: Epoch 34 / 100: avg data time: 4.78e-02, avg batch time: 0.4951, average train loss: 0.5552
[09/26 05:21:37 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1677, average loss: 0.6023
[09/26 05:21:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.50	rocauc: 92.76	
[09/26 05:21:37 visual_prompt]: Training 35 / 100 epoch, with learning rate 0.08345653031794292
[09/26 05:21:44 visual_prompt]: Epoch 35 / 100: avg data time: 4.78e-02, avg batch time: 0.4930, average train loss: 0.5240
[09/26 05:21:45 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1677, average loss: 0.3680
[09/26 05:21:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.45	
[09/26 05:21:45 visual_prompt]: Best epoch 35: best metric: 0.870
[09/26 05:21:45 visual_prompt]: Training 36 / 100 epoch, with learning rate 0.08213938048432697
[09/26 05:21:52 visual_prompt]: Epoch 36 / 100: avg data time: 6.00e-02, avg batch time: 0.5039, average train loss: 0.3904
[09/26 05:21:53 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1673, average loss: 0.3044
[09/26 05:21:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 95.42	
[09/26 05:21:53 visual_prompt]: Training 37 / 100 epoch, with learning rate 0.08078307376628291
[09/26 05:22:00 visual_prompt]: Epoch 37 / 100: avg data time: 5.84e-02, avg batch time: 0.5026, average train loss: 0.5818
[09/26 05:22:02 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1674, average loss: 0.6723
[09/26 05:22:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 92.00	
[09/26 05:22:02 visual_prompt]: Training 38 / 100 epoch, with learning rate 0.07938926261462366
[09/26 05:22:08 visual_prompt]: Epoch 38 / 100: avg data time: 5.85e-02, avg batch time: 0.5030, average train loss: 0.6836
[09/26 05:22:10 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1672, average loss: 0.6820
[09/26 05:22:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.50	rocauc: 86.22	
[09/26 05:22:10 visual_prompt]: Training 39 / 100 epoch, with learning rate 0.07795964517353735
[09/26 05:22:16 visual_prompt]: Epoch 39 / 100: avg data time: 4.14e-02, avg batch time: 0.4855, average train loss: 0.6762
[09/26 05:22:18 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1677, average loss: 0.6589
[09/26 05:22:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.50	rocauc: 89.43	
[09/26 05:22:18 visual_prompt]: Training 40 / 100 epoch, with learning rate 0.07649596321166025
[09/26 05:22:25 visual_prompt]: Epoch 40 / 100: avg data time: 5.63e-02, avg batch time: 0.5004, average train loss: 0.6212
[09/26 05:22:26 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1676, average loss: 0.6074
[09/26 05:22:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 67.50	rocauc: 88.99	
[09/26 05:22:26 visual_prompt]: Training 41 / 100 epoch, with learning rate 0.07500000000000001
[09/26 05:22:33 visual_prompt]: Epoch 41 / 100: avg data time: 4.10e-02, avg batch time: 0.4865, average train loss: 0.5481
[09/26 05:22:34 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1672, average loss: 0.7721
[09/26 05:22:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.50	rocauc: 88.74	
[09/26 05:22:34 visual_prompt]: Training 42 / 100 epoch, with learning rate 0.07347357813929455
[09/26 05:22:41 visual_prompt]: Epoch 42 / 100: avg data time: 4.32e-02, avg batch time: 0.4887, average train loss: 0.7071
[09/26 05:22:42 visual_prompt]: Inference (val):avg data time: 3.56e-05, avg batch time: 0.1675, average loss: 0.6447
[09/26 05:22:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 63.00	rocauc: 89.52	
[09/26 05:22:42 visual_prompt]: Training 43 / 100 epoch, with learning rate 0.07191855733945388
[09/26 05:22:49 visual_prompt]: Epoch 43 / 100: avg data time: 4.49e-02, avg batch time: 0.4896, average train loss: 0.6504
[09/26 05:22:50 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1674, average loss: 0.5921
[09/26 05:22:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.50	rocauc: 92.48	
[09/26 05:22:50 visual_prompt]: Training 44 / 100 epoch, with learning rate 0.07033683215379002
[09/26 05:22:57 visual_prompt]: Epoch 44 / 100: avg data time: 5.75e-02, avg batch time: 0.5008, average train loss: 0.5810
[09/26 05:22:59 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1678, average loss: 0.4938
[09/26 05:22:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 91.80	
[09/26 05:22:59 visual_prompt]: Training 45 / 100 epoch, with learning rate 0.0687303296707956
[09/26 05:23:05 visual_prompt]: Epoch 45 / 100: avg data time: 5.13e-02, avg batch time: 0.4958, average train loss: 0.5803
[09/26 05:23:07 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1674, average loss: 0.6005
[09/26 05:23:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 67.50	rocauc: 89.47	
[09/26 05:23:07 visual_prompt]: Training 46 / 100 epoch, with learning rate 0.06710100716628345
[09/26 05:23:14 visual_prompt]: Epoch 46 / 100: avg data time: 4.81e-02, avg batch time: 0.4937, average train loss: 0.5949
[09/26 05:23:15 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1679, average loss: 0.7142
[09/26 05:23:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 56.50	rocauc: 83.94	
[09/26 05:23:15 visual_prompt]: Training 47 / 100 epoch, with learning rate 0.06545084971874737
[09/26 05:23:22 visual_prompt]: Epoch 47 / 100: avg data time: 4.13e-02, avg batch time: 0.4871, average train loss: 0.7208
[09/26 05:23:23 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1670, average loss: 0.6902
[09/26 05:23:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 80.20	
[09/26 05:23:23 visual_prompt]: Training 48 / 100 epoch, with learning rate 0.06378186779084996
[09/26 05:23:30 visual_prompt]: Epoch 48 / 100: avg data time: 6.02e-02, avg batch time: 0.5040, average train loss: 0.6984
[09/26 05:23:32 visual_prompt]: Inference (val):avg data time: 3.15e-05, avg batch time: 0.1671, average loss: 0.7108
[09/26 05:23:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 79.82	
[09/26 05:23:32 visual_prompt]: Training 49 / 100 epoch, with learning rate 0.06209609477998338
[09/26 05:23:38 visual_prompt]: Epoch 49 / 100: avg data time: 5.45e-02, avg batch time: 0.4979, average train loss: 0.7015
[09/26 05:23:40 visual_prompt]: Inference (val):avg data time: 3.15e-05, avg batch time: 0.1671, average loss: 0.7222
[09/26 05:23:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 81.74	
[09/26 05:23:40 visual_prompt]: Training 50 / 100 epoch, with learning rate 0.06039558454088796
[09/26 05:23:47 visual_prompt]: Epoch 50 / 100: avg data time: 4.11e-02, avg batch time: 0.4872, average train loss: 0.6822
[09/26 05:23:48 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1673, average loss: 0.6413
[09/26 05:23:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 71.00	rocauc: 86.02	
[09/26 05:23:48 visual_prompt]: Training 51 / 100 epoch, with learning rate 0.058682408883346526
[09/26 05:23:55 visual_prompt]: Epoch 51 / 100: avg data time: 5.60e-02, avg batch time: 0.5002, average train loss: 0.6585
[09/26 05:23:56 visual_prompt]: Inference (val):avg data time: 3.79e-05, avg batch time: 0.1673, average loss: 0.6810
[09/26 05:23:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 84.73	
[09/26 05:23:56 visual_prompt]: Training 52 / 100 epoch, with learning rate 0.05695865504800327
[09/26 05:24:03 visual_prompt]: Epoch 52 / 100: avg data time: 6.13e-02, avg batch time: 0.5052, average train loss: 0.6769
[09/26 05:24:05 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1672, average loss: 0.7169
[09/26 05:24:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 84.81	
[09/26 05:24:05 visual_prompt]: Training 53 / 100 epoch, with learning rate 0.05522642316338268
[09/26 05:24:11 visual_prompt]: Epoch 53 / 100: avg data time: 4.47e-02, avg batch time: 0.4906, average train loss: 0.6906
[09/26 05:24:13 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1672, average loss: 0.7011
[09/26 05:24:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 83.16	
[09/26 05:24:13 visual_prompt]: Training 54 / 100 epoch, with learning rate 0.05348782368720626
[09/26 05:24:19 visual_prompt]: Epoch 54 / 100: avg data time: 5.52e-02, avg batch time: 0.4990, average train loss: 0.6747
[09/26 05:24:21 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1669, average loss: 0.6459
[09/26 05:24:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.00	rocauc: 88.54	
[09/26 05:24:21 visual_prompt]: Training 55 / 100 epoch, with learning rate 0.05174497483512506
[09/26 05:24:28 visual_prompt]: Epoch 55 / 100: avg data time: 4.95e-02, avg batch time: 0.4951, average train loss: 0.6668
[09/26 05:24:29 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1677, average loss: 0.6803
[09/26 05:24:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 70.70	
[09/26 05:24:29 visual_prompt]: Training 56 / 100 epoch, with learning rate 0.05
[09/26 05:24:36 visual_prompt]: Epoch 56 / 100: avg data time: 5.32e-02, avg batch time: 0.4971, average train loss: 0.6775
[09/26 05:24:37 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1674, average loss: 0.6679
[09/26 05:24:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 69.00	rocauc: 87.79	
[09/26 05:24:37 visual_prompt]: Training 57 / 100 epoch, with learning rate 0.04825502516487497
[09/26 05:24:44 visual_prompt]: Epoch 57 / 100: avg data time: 5.60e-02, avg batch time: 0.5001, average train loss: 0.6412
[09/26 05:24:46 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1674, average loss: 0.6114
[09/26 05:24:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 64.00	rocauc: 86.46	
[09/26 05:24:46 visual_prompt]: Training 58 / 100 epoch, with learning rate 0.04651217631279374
[09/26 05:24:52 visual_prompt]: Epoch 58 / 100: avg data time: 5.19e-02, avg batch time: 0.4955, average train loss: 0.6387
[09/26 05:24:54 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1674, average loss: 0.6851
[09/26 05:24:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 50.50	rocauc: 89.67	
[09/26 05:24:54 visual_prompt]: Training 59 / 100 epoch, with learning rate 0.04477357683661734
[09/26 05:25:00 visual_prompt]: Epoch 59 / 100: avg data time: 5.41e-02, avg batch time: 0.4996, average train loss: 0.6745
[09/26 05:25:02 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1674, average loss: 0.6893
[09/26 05:25:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 88.34	
[09/26 05:25:02 visual_prompt]: Training 60 / 100 epoch, with learning rate 0.04304134495199674
[09/26 05:25:09 visual_prompt]: Epoch 60 / 100: avg data time: 5.95e-02, avg batch time: 0.5033, average train loss: 0.6567
[09/26 05:25:10 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1671, average loss: 0.5973
[09/26 05:25:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 68.00	rocauc: 90.84	
[09/26 05:25:10 visual_prompt]: Training 61 / 100 epoch, with learning rate 0.041317591116653486
[09/26 05:25:17 visual_prompt]: Epoch 61 / 100: avg data time: 5.07e-02, avg batch time: 0.4958, average train loss: 0.6389
[09/26 05:25:18 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1674, average loss: 0.5412
[09/26 05:25:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 90.79	
[09/26 05:25:18 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.039604415459112044
[09/26 05:25:25 visual_prompt]: Epoch 62 / 100: avg data time: 3.98e-02, avg batch time: 0.4840, average train loss: 0.5894
[09/26 05:25:26 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1674, average loss: 0.4994
[09/26 05:25:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 92.77	
[09/26 05:25:26 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.037903905220016625
[09/26 05:25:33 visual_prompt]: Epoch 63 / 100: avg data time: 4.29e-02, avg batch time: 0.4867, average train loss: 0.5632
[09/26 05:25:35 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1672, average loss: 0.7045
[09/26 05:25:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 89.17	
[09/26 05:25:35 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.036218132209150045
[09/26 05:25:41 visual_prompt]: Epoch 64 / 100: avg data time: 6.17e-02, avg batch time: 0.5049, average train loss: 0.6780
[09/26 05:25:43 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1670, average loss: 0.6692
[09/26 05:25:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 64.00	rocauc: 80.37	
[09/26 05:25:43 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.03454915028125263
[09/26 05:25:50 visual_prompt]: Epoch 65 / 100: avg data time: 5.58e-02, avg batch time: 0.5002, average train loss: 0.6648
[09/26 05:25:51 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1677, average loss: 0.6651
[09/26 05:25:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 87.25	
[09/26 05:25:51 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.03289899283371657
[09/26 05:25:58 visual_prompt]: Epoch 66 / 100: avg data time: 4.73e-02, avg batch time: 0.4919, average train loss: 0.6448
[09/26 05:25:59 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1678, average loss: 0.5990
[09/26 05:25:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 69.50	rocauc: 87.58	
[09/26 05:25:59 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.0312696703292044
[09/26 05:26:06 visual_prompt]: Epoch 67 / 100: avg data time: 4.59e-02, avg batch time: 0.4896, average train loss: 0.5885
[09/26 05:26:07 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1671, average loss: 0.5054
[09/26 05:26:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 92.50	
[09/26 05:26:07 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.02966316784621
[09/26 05:26:14 visual_prompt]: Epoch 68 / 100: avg data time: 4.46e-02, avg batch time: 0.4906, average train loss: 0.5733
[09/26 05:26:16 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1672, average loss: 0.4974
[09/26 05:26:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.00	rocauc: 91.05	
[09/26 05:26:16 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.028081442660546126
[09/26 05:26:22 visual_prompt]: Epoch 69 / 100: avg data time: 5.74e-02, avg batch time: 0.5014, average train loss: 0.5320
[09/26 05:26:24 visual_prompt]: Inference (val):avg data time: 2.99e-05, avg batch time: 0.1674, average loss: 0.5769
[09/26 05:26:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.00	rocauc: 92.10	
[09/26 05:26:24 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.026526421860705474
[09/26 05:26:31 visual_prompt]: Epoch 70 / 100: avg data time: 5.54e-02, avg batch time: 0.4996, average train loss: 0.4928
[09/26 05:26:32 visual_prompt]: Inference (val):avg data time: 3.12e-05, avg batch time: 0.1673, average loss: 0.4439
[09/26 05:26:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 92.55	
[09/26 05:26:32 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.025000000000000012
[09/26 05:26:39 visual_prompt]: Epoch 71 / 100: avg data time: 5.51e-02, avg batch time: 0.4984, average train loss: 0.4306
[09/26 05:26:40 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1672, average loss: 0.3583
[09/26 05:26:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.40	
[09/26 05:26:40 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.02350403678833976
[09/26 05:26:47 visual_prompt]: Epoch 72 / 100: avg data time: 5.54e-02, avg batch time: 0.4995, average train loss: 0.4921
[09/26 05:26:48 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1674, average loss: 0.4268
[09/26 05:26:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.21	
[09/26 05:26:48 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.022040354826462667
[09/26 05:26:55 visual_prompt]: Epoch 73 / 100: avg data time: 5.40e-02, avg batch time: 0.4989, average train loss: 0.4383
[09/26 05:26:57 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1674, average loss: 0.4295
[09/26 05:26:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 92.49	
[09/26 05:26:57 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.02061073738537635
[09/26 05:27:04 visual_prompt]: Epoch 74 / 100: avg data time: 5.32e-02, avg batch time: 0.4970, average train loss: 0.4372
[09/26 05:27:05 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1675, average loss: 0.3582
[09/26 05:27:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.62	
[09/26 05:27:05 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.019216926233717086
[09/26 05:27:12 visual_prompt]: Epoch 75 / 100: avg data time: 5.33e-02, avg batch time: 0.4976, average train loss: 0.3636
[09/26 05:27:13 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1673, average loss: 0.4124
[09/26 05:27:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.47	
[09/26 05:27:13 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.017860619515673033
[09/26 05:27:20 visual_prompt]: Epoch 76 / 100: avg data time: 5.15e-02, avg batch time: 0.4960, average train loss: 0.3481
[09/26 05:27:21 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1675, average loss: 0.4745
[09/26 05:27:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 92.50	
[09/26 05:27:21 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.016543469682057107
[09/26 05:27:28 visual_prompt]: Epoch 77 / 100: avg data time: 5.00e-02, avg batch time: 0.4961, average train loss: 0.3369
[09/26 05:27:29 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1676, average loss: 0.4173
[09/26 05:27:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.26	
[09/26 05:27:29 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.015267081477050132
[09/26 05:27:36 visual_prompt]: Epoch 78 / 100: avg data time: 4.09e-02, avg batch time: 0.4863, average train loss: 0.3313
[09/26 05:27:38 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1672, average loss: 0.3573
[09/26 05:27:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.91	
[09/26 05:27:38 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.014033009983067453
[09/26 05:27:44 visual_prompt]: Epoch 79 / 100: avg data time: 3.91e-02, avg batch time: 0.4846, average train loss: 0.2904
[09/26 05:27:46 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1673, average loss: 0.4320
[09/26 05:27:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.44	
[09/26 05:27:46 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.012842758726130284
[09/26 05:27:52 visual_prompt]: Epoch 80 / 100: avg data time: 5.19e-02, avg batch time: 0.4961, average train loss: 0.2577
[09/26 05:27:54 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1674, average loss: 0.3768
[09/26 05:27:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.04	
[09/26 05:27:54 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.011697777844051106
[09/26 05:28:00 visual_prompt]: Epoch 81 / 100: avg data time: 4.44e-02, avg batch time: 0.4892, average train loss: 0.2195
[09/26 05:28:02 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1676, average loss: 0.4947
[09/26 05:28:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.81	
[09/26 05:28:02 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.010599462319663905
[09/26 05:28:08 visual_prompt]: Epoch 82 / 100: avg data time: 4.25e-02, avg batch time: 0.4872, average train loss: 0.2260
[09/26 05:28:10 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1674, average loss: 0.4098
[09/26 05:28:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.52	
[09/26 05:28:10 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.009549150281252633
[09/26 05:28:16 visual_prompt]: Epoch 83 / 100: avg data time: 4.44e-02, avg batch time: 0.4889, average train loss: 0.1926
[09/26 05:28:18 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1675, average loss: 0.5592
[09/26 05:28:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 93.55	
[09/26 05:28:18 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.008548121372247919
[09/26 05:28:25 visual_prompt]: Epoch 84 / 100: avg data time: 5.04e-02, avg batch time: 0.4956, average train loss: 0.1934
[09/26 05:28:26 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1673, average loss: 0.5141
[09/26 05:28:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 92.45	
[09/26 05:28:26 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.007597595192178702
[09/26 05:28:33 visual_prompt]: Epoch 85 / 100: avg data time: 4.62e-02, avg batch time: 0.4902, average train loss: 0.2034
[09/26 05:28:34 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1675, average loss: 0.3825
[09/26 05:28:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.91	
[09/26 05:28:34 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.006698729810778065
[09/26 05:28:41 visual_prompt]: Epoch 86 / 100: avg data time: 5.00e-02, avg batch time: 0.4954, average train loss: 0.1413
[09/26 05:28:43 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1676, average loss: 0.4633
[09/26 05:28:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.64	
[09/26 05:28:43 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.005852620357053651
[09/26 05:28:49 visual_prompt]: Epoch 87 / 100: avg data time: 5.26e-02, avg batch time: 0.4964, average train loss: 0.1184
[09/26 05:28:51 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1673, average loss: 0.4772
[09/26 05:28:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.81	
[09/26 05:28:51 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.00506029768504166
[09/26 05:28:57 visual_prompt]: Epoch 88 / 100: avg data time: 4.74e-02, avg batch time: 0.4916, average train loss: 0.0935
[09/26 05:28:59 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1680, average loss: 0.4874
[09/26 05:28:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.66	
[09/26 05:28:59 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.004322727117869951
[09/26 05:29:06 visual_prompt]: Epoch 89 / 100: avg data time: 5.01e-02, avg batch time: 0.4945, average train loss: 0.0675
[09/26 05:29:07 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1677, average loss: 0.6538
[09/26 05:29:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 93.26	
[09/26 05:29:07 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.0036408072716606343
[09/26 05:29:14 visual_prompt]: Epoch 90 / 100: avg data time: 5.50e-02, avg batch time: 0.4996, average train loss: 0.0679
[09/26 05:29:15 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1677, average loss: 0.6281
[09/26 05:29:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.58	
[09/26 05:29:15 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.0030153689607045845
[09/26 05:29:22 visual_prompt]: Epoch 91 / 100: avg data time: 5.44e-02, avg batch time: 0.4989, average train loss: 0.1063
[09/26 05:29:24 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1674, average loss: 0.5211
[09/26 05:29:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.28	
[09/26 05:29:24 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.0024471741852423235
[09/26 05:29:30 visual_prompt]: Epoch 92 / 100: avg data time: 4.79e-02, avg batch time: 0.4939, average train loss: 0.0906
[09/26 05:29:32 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1676, average loss: 0.5234
[09/26 05:29:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 93.33	
[09/26 05:29:32 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.0019369152030840554
[09/26 05:29:39 visual_prompt]: Epoch 93 / 100: avg data time: 5.72e-02, avg batch time: 0.5009, average train loss: 0.0559
[09/26 05:29:40 visual_prompt]: Inference (val):avg data time: 3.25e-05, avg batch time: 0.1673, average loss: 0.6146
[09/26 05:29:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 93.24	
[09/26 05:29:40 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.0014852136862001765
[09/26 05:29:47 visual_prompt]: Epoch 94 / 100: avg data time: 5.81e-02, avg batch time: 0.5024, average train loss: 0.0284
[09/26 05:29:48 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1675, average loss: 0.6664
[09/26 05:29:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 92.89	
[09/26 05:29:48 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.0010926199633097156
[09/26 05:29:55 visual_prompt]: Epoch 95 / 100: avg data time: 4.64e-02, avg batch time: 0.4910, average train loss: 0.0279
[09/26 05:29:56 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1676, average loss: 0.6884
[09/26 05:29:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 93.04	
[09/26 05:29:56 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.0007596123493895991
[09/26 05:30:03 visual_prompt]: Epoch 96 / 100: avg data time: 5.54e-02, avg batch time: 0.5001, average train loss: 0.0221
[09/26 05:30:05 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1675, average loss: 0.7101
[09/26 05:30:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 93.06	
[09/26 05:30:05 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.00048659656292148194
[09/26 05:30:11 visual_prompt]: Epoch 97 / 100: avg data time: 4.03e-02, avg batch time: 0.4847, average train loss: 0.0225
[09/26 05:30:13 visual_prompt]: Inference (val):avg data time: 3.21e-05, avg batch time: 0.1678, average loss: 0.7089
[09/26 05:30:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 93.15	
[09/26 05:30:13 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.0002739052315863355
[09/26 05:30:19 visual_prompt]: Epoch 98 / 100: avg data time: 5.21e-02, avg batch time: 0.4969, average train loss: 0.0203
[09/26 05:30:21 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1677, average loss: 0.7189
[09/26 05:30:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 93.11	
[09/26 05:30:21 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.00012179748700879012
[09/26 05:30:28 visual_prompt]: Epoch 99 / 100: avg data time: 5.92e-02, avg batch time: 0.5039, average train loss: 0.0216
[09/26 05:30:29 visual_prompt]: Inference (val):avg data time: 3.04e-05, avg batch time: 0.1677, average loss: 0.7234
[09/26 05:30:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 93.07	
[09/26 05:30:29 visual_prompt]: Training 100 / 100 epoch, with learning rate 3.0458649045211895e-05
[09/26 05:30:36 visual_prompt]: Epoch 100 / 100: avg data time: 5.65e-02, avg batch time: 0.5008, average train loss: 0.0203
[09/26 05:30:38 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1679, average loss: 0.7241
[09/26 05:30:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 93.08	
[09/26 05:30:38 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 05:30:38 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 05:30:38 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 05:30:38 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 05:30:38 visual_prompt]: Training with config:
[09/26 05:30:38 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr0.1_wd0.001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 0.1, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 05:30:38 visual_prompt]: Loading training data...
[09/26 05:30:38 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 05:30:39 visual_prompt]: Number of images: 800
[09/26 05:30:39 visual_prompt]: Number of classes: 2 / 2
[09/26 05:30:39 visual_prompt]: Loading validation data...
[09/26 05:30:39 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 05:30:39 visual_prompt]: Number of images: 200
[09/26 05:30:39 visual_prompt]: Number of classes: 2 / 2
[09/26 05:30:39 visual_prompt]: Constructing models...
[09/26 05:30:42 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 05:30:42 visual_prompt]: tuned percent:0.536
[09/26 05:30:42 visual_prompt]: Device used for model: 0
[09/26 05:30:42 visual_prompt]: Setting up Evaluator...
[09/26 05:30:42 visual_prompt]: Setting up Trainer...
[09/26 05:30:42 visual_prompt]: 	Setting up the optimizer...
[09/26 05:30:42 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 05:30:48 visual_prompt]: Epoch 1 / 100: avg data time: 4.79e-02, avg batch time: 0.4938, average train loss: 1.9873
[09/26 05:30:50 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.1666, average loss: 2.0033
[09/26 05:30:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 05:30:50 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 05:30:50 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.010000000000000002
[09/26 05:30:56 visual_prompt]: Epoch 2 / 100: avg data time: 4.92e-02, avg batch time: 0.4917, average train loss: 1.4265
[09/26 05:30:58 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1669, average loss: 0.7479
[09/26 05:30:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 69.67	
[09/26 05:30:58 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.020000000000000004
[09/26 05:31:05 visual_prompt]: Epoch 3 / 100: avg data time: 4.84e-02, avg batch time: 0.4914, average train loss: 0.6965
[09/26 05:31:06 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1669, average loss: 0.5989
[09/26 05:31:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 62.00	rocauc: 88.39	
[09/26 05:31:06 visual_prompt]: Best epoch 3: best metric: 0.620
[09/26 05:31:06 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.03
[09/26 05:31:13 visual_prompt]: Epoch 4 / 100: avg data time: 5.45e-02, avg batch time: 0.4973, average train loss: 0.5993
[09/26 05:31:14 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1670, average loss: 0.6277
[09/26 05:31:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 59.00	rocauc: 90.55	
[09/26 05:31:14 visual_prompt]: Training 5 / 100 epoch, with learning rate 0.04000000000000001
[09/26 05:31:21 visual_prompt]: Epoch 5 / 100: avg data time: 4.18e-02, avg batch time: 0.4850, average train loss: 0.5920
[09/26 05:31:22 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1669, average loss: 0.6289
[09/26 05:31:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 61.00	rocauc: 89.13	
[09/26 05:31:22 visual_prompt]: Training 6 / 100 epoch, with learning rate 0.05
[09/26 05:31:29 visual_prompt]: Epoch 6 / 100: avg data time: 6.27e-02, avg batch time: 0.5059, average train loss: 0.5977
[09/26 05:31:31 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1672, average loss: 0.4415
[09/26 05:31:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 89.99	
[09/26 05:31:31 visual_prompt]: Best epoch 6: best metric: 0.785
[09/26 05:31:31 visual_prompt]: Training 7 / 100 epoch, with learning rate 0.06
[09/26 05:31:37 visual_prompt]: Epoch 7 / 100: avg data time: 4.44e-02, avg batch time: 0.4888, average train loss: 0.5262
[09/26 05:31:39 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1671, average loss: 0.4331
[09/26 05:31:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 89.32	
[09/26 05:31:39 visual_prompt]: Best epoch 7: best metric: 0.830
[09/26 05:31:39 visual_prompt]: Training 8 / 100 epoch, with learning rate 0.06999999999999999
[09/26 05:31:45 visual_prompt]: Epoch 8 / 100: avg data time: 5.00e-02, avg batch time: 0.4937, average train loss: 0.5083
[09/26 05:31:47 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1681, average loss: 0.4058
[09/26 05:31:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 90.41	
[09/26 05:31:47 visual_prompt]: Training 9 / 100 epoch, with learning rate 0.08000000000000002
[09/26 05:31:54 visual_prompt]: Epoch 9 / 100: avg data time: 4.90e-02, avg batch time: 0.4940, average train loss: 0.4929
[09/26 05:31:55 visual_prompt]: Inference (val):avg data time: 4.65e-05, avg batch time: 0.1676, average loss: 0.4281
[09/26 05:31:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 90.18	
[09/26 05:31:55 visual_prompt]: Training 10 / 100 epoch, with learning rate 0.09000000000000001
[09/26 05:32:02 visual_prompt]: Epoch 10 / 100: avg data time: 5.66e-02, avg batch time: 0.5009, average train loss: 0.5131
[09/26 05:32:04 visual_prompt]: Inference (val):avg data time: 5.01e-05, avg batch time: 0.1679, average loss: 0.3966
[09/26 05:32:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 90.74	
[09/26 05:32:04 visual_prompt]: Best epoch 10: best metric: 0.845
[09/26 05:32:04 visual_prompt]: Training 11 / 100 epoch, with learning rate 0.1
[09/26 05:32:10 visual_prompt]: Epoch 11 / 100: avg data time: 4.94e-02, avg batch time: 0.4938, average train loss: 0.4740
[09/26 05:32:12 visual_prompt]: Inference (val):avg data time: 3.24e-05, avg batch time: 0.1676, average loss: 0.4522
[09/26 05:32:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.50	rocauc: 91.11	
[09/26 05:32:12 visual_prompt]: Training 12 / 100 epoch, with learning rate 0.0999695413509548
[09/26 05:32:19 visual_prompt]: Epoch 12 / 100: avg data time: 5.87e-02, avg batch time: 0.5023, average train loss: 0.4500
[09/26 05:32:20 visual_prompt]: Inference (val):avg data time: 3.42e-05, avg batch time: 0.1674, average loss: 0.4067
[09/26 05:32:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.34	
[09/26 05:32:20 visual_prompt]: Training 13 / 100 epoch, with learning rate 0.09987820251299122
[09/26 05:32:27 visual_prompt]: Epoch 13 / 100: avg data time: 5.79e-02, avg batch time: 0.5007, average train loss: 0.4255
[09/26 05:32:28 visual_prompt]: Inference (val):avg data time: 2.95e-05, avg batch time: 0.1673, average loss: 0.3997
[09/26 05:32:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.17	
[09/26 05:32:28 visual_prompt]: Training 14 / 100 epoch, with learning rate 0.09972609476841367
[09/26 05:32:35 visual_prompt]: Epoch 14 / 100: avg data time: 4.97e-02, avg batch time: 0.4937, average train loss: 0.4086
[09/26 05:32:37 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1673, average loss: 0.4012
[09/26 05:32:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 90.02	
[09/26 05:32:37 visual_prompt]: Training 15 / 100 epoch, with learning rate 0.09951340343707853
[09/26 05:32:43 visual_prompt]: Epoch 15 / 100: avg data time: 4.58e-02, avg batch time: 0.4899, average train loss: 0.3756
[09/26 05:32:45 visual_prompt]: Inference (val):avg data time: 3.12e-05, avg batch time: 0.1673, average loss: 0.4040
[09/26 05:32:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.30	
[09/26 05:32:45 visual_prompt]: Training 16 / 100 epoch, with learning rate 0.09924038765061041
[09/26 05:32:51 visual_prompt]: Epoch 16 / 100: avg data time: 5.28e-02, avg batch time: 0.4967, average train loss: 0.4727
[09/26 05:32:53 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1673, average loss: 0.6698
[09/26 05:32:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 63.00	rocauc: 90.71	
[09/26 05:32:53 visual_prompt]: Training 17 / 100 epoch, with learning rate 0.09890738003669029
[09/26 05:32:59 visual_prompt]: Epoch 17 / 100: avg data time: 4.61e-02, avg batch time: 0.4922, average train loss: 0.4632
[09/26 05:33:01 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1672, average loss: 0.4671
[09/26 05:33:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.50	rocauc: 91.10	
[09/26 05:33:01 visual_prompt]: Training 18 / 100 epoch, with learning rate 0.09851478631379983
[09/26 05:33:08 visual_prompt]: Epoch 18 / 100: avg data time: 5.34e-02, avg batch time: 0.4972, average train loss: 0.3683
[09/26 05:33:09 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1672, average loss: 0.4095
[09/26 05:33:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 92.61	
[09/26 05:33:09 visual_prompt]: Training 19 / 100 epoch, with learning rate 0.09806308479691594
[09/26 05:33:16 visual_prompt]: Epoch 19 / 100: avg data time: 4.71e-02, avg batch time: 0.4923, average train loss: 0.3787
[09/26 05:33:17 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1673, average loss: 0.4668
[09/26 05:33:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.75	
[09/26 05:33:17 visual_prompt]: Training 20 / 100 epoch, with learning rate 0.09755282581475769
[09/26 05:33:24 visual_prompt]: Epoch 20 / 100: avg data time: 5.33e-02, avg batch time: 0.4979, average train loss: 0.3880
[09/26 05:33:25 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1671, average loss: 0.3589
[09/26 05:33:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.40	
[09/26 05:33:25 visual_prompt]: Training 21 / 100 epoch, with learning rate 0.09698463103929543
[09/26 05:33:32 visual_prompt]: Epoch 21 / 100: avg data time: 4.23e-02, avg batch time: 0.4895, average train loss: 0.3510
[09/26 05:33:34 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1673, average loss: 0.4164
[09/26 05:33:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 92.58	
[09/26 05:33:34 visual_prompt]: Training 22 / 100 epoch, with learning rate 0.09635919272833937
[09/26 05:33:40 visual_prompt]: Epoch 22 / 100: avg data time: 4.20e-02, avg batch time: 0.4864, average train loss: 0.3051
[09/26 05:33:42 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1674, average loss: 0.3771
[09/26 05:33:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.94	
[09/26 05:33:42 visual_prompt]: Best epoch 22: best metric: 0.855
[09/26 05:33:42 visual_prompt]: Training 23 / 100 epoch, with learning rate 0.09567727288213004
[09/26 05:33:48 visual_prompt]: Epoch 23 / 100: avg data time: 5.46e-02, avg batch time: 0.4981, average train loss: 0.3054
[09/26 05:33:50 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1680, average loss: 0.3626
[09/26 05:33:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.80	
[09/26 05:33:50 visual_prompt]: Training 24 / 100 epoch, with learning rate 0.09493970231495835
[09/26 05:33:56 visual_prompt]: Epoch 24 / 100: avg data time: 4.60e-02, avg batch time: 0.4902, average train loss: 0.2877
[09/26 05:33:58 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1675, average loss: 0.4773
[09/26 05:33:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 93.14	
[09/26 05:33:58 visual_prompt]: Training 25 / 100 epoch, with learning rate 0.09414737964294635
[09/26 05:34:05 visual_prompt]: Epoch 25 / 100: avg data time: 4.64e-02, avg batch time: 0.4924, average train loss: 0.2959
[09/26 05:34:06 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1674, average loss: 0.3899
[09/26 05:34:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 94.18	
[09/26 05:34:06 visual_prompt]: Training 26 / 100 epoch, with learning rate 0.09330127018922195
[09/26 05:34:13 visual_prompt]: Epoch 26 / 100: avg data time: 4.12e-02, avg batch time: 0.4861, average train loss: 0.2458
[09/26 05:34:14 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1673, average loss: 0.4391
[09/26 05:34:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 94.09	
[09/26 05:34:14 visual_prompt]: Training 27 / 100 epoch, with learning rate 0.0924024048078213
[09/26 05:34:21 visual_prompt]: Epoch 27 / 100: avg data time: 5.17e-02, avg batch time: 0.4968, average train loss: 0.2725
[09/26 05:34:22 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1676, average loss: 0.4072
[09/26 05:34:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 93.15	
[09/26 05:34:22 visual_prompt]: Training 28 / 100 epoch, with learning rate 0.09145187862775209
[09/26 05:34:29 visual_prompt]: Epoch 28 / 100: avg data time: 4.57e-02, avg batch time: 0.4909, average train loss: 0.2558
[09/26 05:34:30 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1674, average loss: 0.4550
[09/26 05:34:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 75.00	rocauc: 90.19	
[09/26 05:34:30 visual_prompt]: Training 29 / 100 epoch, with learning rate 0.09045084971874738
[09/26 05:34:37 visual_prompt]: Epoch 29 / 100: avg data time: 4.73e-02, avg batch time: 0.4922, average train loss: 0.3304
[09/26 05:34:39 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1673, average loss: 0.4340
[09/26 05:34:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 93.61	
[09/26 05:34:39 visual_prompt]: Training 30 / 100 epoch, with learning rate 0.0894005376803361
[09/26 05:34:45 visual_prompt]: Epoch 30 / 100: avg data time: 4.75e-02, avg batch time: 0.4917, average train loss: 0.2295
[09/26 05:34:47 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1676, average loss: 0.3491
[09/26 05:34:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.71	
[09/26 05:34:47 visual_prompt]: Training 31 / 100 epoch, with learning rate 0.0883022221559489
[09/26 05:34:53 visual_prompt]: Epoch 31 / 100: avg data time: 5.16e-02, avg batch time: 0.4949, average train loss: 0.1963
[09/26 05:34:55 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1672, average loss: 0.4557
[09/26 05:34:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.32	
[09/26 05:34:55 visual_prompt]: Training 32 / 100 epoch, with learning rate 0.08715724127386971
[09/26 05:35:02 visual_prompt]: Epoch 32 / 100: avg data time: 4.43e-02, avg batch time: 0.4910, average train loss: 0.2137
[09/26 05:35:03 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1674, average loss: 0.4191
[09/26 05:35:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 94.31	
[09/26 05:35:03 visual_prompt]: Training 33 / 100 epoch, with learning rate 0.08596699001693256
[09/26 05:35:10 visual_prompt]: Epoch 33 / 100: avg data time: 4.65e-02, avg batch time: 0.4910, average train loss: 0.2073
[09/26 05:35:11 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1675, average loss: 0.5195
[09/26 05:35:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.26	
[09/26 05:35:11 visual_prompt]: Training 34 / 100 epoch, with learning rate 0.08473291852294987
[09/26 05:35:18 visual_prompt]: Epoch 34 / 100: avg data time: 5.22e-02, avg batch time: 0.4969, average train loss: 0.2040
[09/26 05:35:19 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1673, average loss: 0.3341
[09/26 05:35:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.48	
[09/26 05:35:19 visual_prompt]: Best epoch 34: best metric: 0.865
[09/26 05:35:19 visual_prompt]: Training 35 / 100 epoch, with learning rate 0.08345653031794292
[09/26 05:35:26 visual_prompt]: Epoch 35 / 100: avg data time: 5.14e-02, avg batch time: 0.4965, average train loss: 0.1834
[09/26 05:35:28 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1677, average loss: 0.4643
[09/26 05:35:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.20	
[09/26 05:35:28 visual_prompt]: Training 36 / 100 epoch, with learning rate 0.08213938048432697
[09/26 05:35:34 visual_prompt]: Epoch 36 / 100: avg data time: 5.03e-02, avg batch time: 0.4946, average train loss: 0.1271
[09/26 05:35:36 visual_prompt]: Inference (val):avg data time: 2.92e-05, avg batch time: 0.1675, average loss: 0.6221
[09/26 05:35:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 90.40	
[09/26 05:35:36 visual_prompt]: Training 37 / 100 epoch, with learning rate 0.08078307376628291
[09/26 05:35:43 visual_prompt]: Epoch 37 / 100: avg data time: 5.90e-02, avg batch time: 0.5035, average train loss: 0.1777
[09/26 05:35:44 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1673, average loss: 0.6697
[09/26 05:35:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.50	rocauc: 91.10	
[09/26 05:35:44 visual_prompt]: Training 38 / 100 epoch, with learning rate 0.07938926261462366
[09/26 05:35:51 visual_prompt]: Epoch 38 / 100: avg data time: 4.18e-02, avg batch time: 0.4884, average train loss: 0.3029
[09/26 05:35:52 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1673, average loss: 0.4000
[09/26 05:35:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.78	
[09/26 05:35:52 visual_prompt]: Training 39 / 100 epoch, with learning rate 0.07795964517353735
[09/26 05:35:59 visual_prompt]: Epoch 39 / 100: avg data time: 4.38e-02, avg batch time: 0.4884, average train loss: 0.1584
[09/26 05:36:00 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1674, average loss: 0.4692
[09/26 05:36:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.02	
[09/26 05:36:00 visual_prompt]: Training 40 / 100 epoch, with learning rate 0.07649596321166025
[09/26 05:36:07 visual_prompt]: Epoch 40 / 100: avg data time: 4.80e-02, avg batch time: 0.4942, average train loss: 0.1035
[09/26 05:36:08 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1676, average loss: 0.4892
[09/26 05:36:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.59	
[09/26 05:36:08 visual_prompt]: Training 41 / 100 epoch, with learning rate 0.07500000000000001
[09/26 05:36:15 visual_prompt]: Epoch 41 / 100: avg data time: 5.89e-02, avg batch time: 0.5038, average train loss: 0.1054
[09/26 05:36:17 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1674, average loss: 0.6139
[09/26 05:36:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 90.67	
[09/26 05:36:17 visual_prompt]: Training 42 / 100 epoch, with learning rate 0.07347357813929455
[09/26 05:36:23 visual_prompt]: Epoch 42 / 100: avg data time: 5.04e-02, avg batch time: 0.4957, average train loss: 0.1031
[09/26 05:36:25 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1673, average loss: 0.6315
[09/26 05:36:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.91	
[09/26 05:36:25 visual_prompt]: Training 43 / 100 epoch, with learning rate 0.07191855733945388
[09/26 05:36:32 visual_prompt]: Epoch 43 / 100: avg data time: 5.29e-02, avg batch time: 0.4973, average train loss: 0.1067
[09/26 05:36:33 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1674, average loss: 0.6402
[09/26 05:36:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.23	
[09/26 05:36:33 visual_prompt]: Training 44 / 100 epoch, with learning rate 0.07033683215379002
[09/26 05:36:40 visual_prompt]: Epoch 44 / 100: avg data time: 4.45e-02, avg batch time: 0.4891, average train loss: 0.1533
[09/26 05:36:41 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1673, average loss: 0.5253
[09/26 05:36:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.47	
[09/26 05:36:41 visual_prompt]: Training 45 / 100 epoch, with learning rate 0.0687303296707956
[09/26 05:36:48 visual_prompt]: Epoch 45 / 100: avg data time: 5.28e-02, avg batch time: 0.4979, average train loss: 0.1130
[09/26 05:36:49 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1675, average loss: 0.5835
[09/26 05:36:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.57	
[09/26 05:36:49 visual_prompt]: Training 46 / 100 epoch, with learning rate 0.06710100716628345
[09/26 05:36:56 visual_prompt]: Epoch 46 / 100: avg data time: 4.77e-02, avg batch time: 0.4917, average train loss: 0.0793
[09/26 05:36:57 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1674, average loss: 0.5848
[09/26 05:36:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.21	
[09/26 05:36:57 visual_prompt]: Training 47 / 100 epoch, with learning rate 0.06545084971874737
[09/26 05:37:04 visual_prompt]: Epoch 47 / 100: avg data time: 4.29e-02, avg batch time: 0.4868, average train loss: 0.0550
[09/26 05:37:06 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1678, average loss: 0.8101
[09/26 05:37:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.90	
[09/26 05:37:06 visual_prompt]: Training 48 / 100 epoch, with learning rate 0.06378186779084996
[09/26 05:37:12 visual_prompt]: Epoch 48 / 100: avg data time: 4.75e-02, avg batch time: 0.4912, average train loss: 0.1078
[09/26 05:37:14 visual_prompt]: Inference (val):avg data time: 3.18e-05, avg batch time: 0.1678, average loss: 0.4217
[09/26 05:37:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.58	
[09/26 05:37:14 visual_prompt]: Training 49 / 100 epoch, with learning rate 0.06209609477998338
[09/26 05:37:20 visual_prompt]: Epoch 49 / 100: avg data time: 4.19e-02, avg batch time: 0.4867, average train loss: 0.0968
[09/26 05:37:22 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1675, average loss: 0.6135
[09/26 05:37:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 93.32	
[09/26 05:37:22 visual_prompt]: Training 50 / 100 epoch, with learning rate 0.06039558454088796
[09/26 05:37:29 visual_prompt]: Epoch 50 / 100: avg data time: 5.28e-02, avg batch time: 0.4967, average train loss: 0.0524
[09/26 05:37:30 visual_prompt]: Inference (val):avg data time: 3.42e-05, avg batch time: 0.1678, average loss: 0.7337
[09/26 05:37:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.04	
[09/26 05:37:30 visual_prompt]: Training 51 / 100 epoch, with learning rate 0.058682408883346526
[09/26 05:37:37 visual_prompt]: Epoch 51 / 100: avg data time: 5.61e-02, avg batch time: 0.5012, average train loss: 0.0357
[09/26 05:37:38 visual_prompt]: Inference (val):avg data time: 2.76e-05, avg batch time: 0.1672, average loss: 0.6403
[09/26 05:37:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.37	
[09/26 05:37:38 visual_prompt]: Training 52 / 100 epoch, with learning rate 0.05695865504800327
[09/26 05:37:45 visual_prompt]: Epoch 52 / 100: avg data time: 5.75e-02, avg batch time: 0.5007, average train loss: 0.0309
[09/26 05:37:47 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1672, average loss: 0.8522
[09/26 05:37:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.33	
[09/26 05:37:47 visual_prompt]: Training 53 / 100 epoch, with learning rate 0.05522642316338268
[09/26 05:37:53 visual_prompt]: Epoch 53 / 100: avg data time: 4.41e-02, avg batch time: 0.4891, average train loss: 0.0101
[09/26 05:37:55 visual_prompt]: Inference (val):avg data time: 2.95e-05, avg batch time: 0.1675, average loss: 1.0557
[09/26 05:37:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.76	
[09/26 05:37:55 visual_prompt]: Training 54 / 100 epoch, with learning rate 0.05348782368720626
[09/26 05:38:01 visual_prompt]: Epoch 54 / 100: avg data time: 4.90e-02, avg batch time: 0.4942, average train loss: 0.0450
[09/26 05:38:03 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1675, average loss: 0.6391
[09/26 05:38:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 92.19	
[09/26 05:38:03 visual_prompt]: Best epoch 54: best metric: 0.875
[09/26 05:38:03 visual_prompt]: Training 55 / 100 epoch, with learning rate 0.05174497483512506
[09/26 05:38:10 visual_prompt]: Epoch 55 / 100: avg data time: 5.51e-02, avg batch time: 0.4992, average train loss: 0.1409
[09/26 05:38:11 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1675, average loss: 0.5480
[09/26 05:38:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 93.08	
[09/26 05:38:11 visual_prompt]: Training 56 / 100 epoch, with learning rate 0.05
[09/26 05:38:18 visual_prompt]: Epoch 56 / 100: avg data time: 5.60e-02, avg batch time: 0.5008, average train loss: 0.1413
[09/26 05:38:19 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1675, average loss: 0.6153
[09/26 05:38:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 92.30	
[09/26 05:38:19 visual_prompt]: Training 57 / 100 epoch, with learning rate 0.04825502516487497
[09/26 05:38:26 visual_prompt]: Epoch 57 / 100: avg data time: 4.71e-02, avg batch time: 0.4912, average train loss: 0.0821
[09/26 05:38:28 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1671, average loss: 0.4800
[09/26 05:38:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.80	
[09/26 05:38:28 visual_prompt]: Training 58 / 100 epoch, with learning rate 0.04651217631279374
[09/26 05:38:34 visual_prompt]: Epoch 58 / 100: avg data time: 5.75e-02, avg batch time: 0.5017, average train loss: 0.0380
[09/26 05:38:36 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1674, average loss: 0.5252
[09/26 05:38:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.84	
[09/26 05:38:36 visual_prompt]: Training 59 / 100 epoch, with learning rate 0.04477357683661734
[09/26 05:38:43 visual_prompt]: Epoch 59 / 100: avg data time: 5.76e-02, avg batch time: 0.5014, average train loss: 0.0143
[09/26 05:38:44 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1673, average loss: 0.6217
[09/26 05:38:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.12	
[09/26 05:38:44 visual_prompt]: Training 60 / 100 epoch, with learning rate 0.04304134495199674
[09/26 05:38:51 visual_prompt]: Epoch 60 / 100: avg data time: 4.53e-02, avg batch time: 0.4913, average train loss: 0.0119
[09/26 05:38:52 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1674, average loss: 0.7402
[09/26 05:38:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 91.59	
[09/26 05:38:52 visual_prompt]: Training 61 / 100 epoch, with learning rate 0.041317591116653486
[09/26 05:38:59 visual_prompt]: Epoch 61 / 100: avg data time: 5.25e-02, avg batch time: 0.4967, average train loss: 0.0196
[09/26 05:39:01 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1674, average loss: 0.7859
[09/26 05:39:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.33	
[09/26 05:39:01 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.039604415459112044
[09/26 05:39:07 visual_prompt]: Epoch 62 / 100: avg data time: 4.39e-02, avg batch time: 0.4885, average train loss: 0.0481
[09/26 05:39:09 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1673, average loss: 0.8090
[09/26 05:39:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.08	
[09/26 05:39:09 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.037903905220016625
[09/26 05:39:15 visual_prompt]: Epoch 63 / 100: avg data time: 4.68e-02, avg batch time: 0.4928, average train loss: 0.0411
[09/26 05:39:17 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1672, average loss: 0.8737
[09/26 05:39:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.96	
[09/26 05:39:17 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.036218132209150045
[09/26 05:39:23 visual_prompt]: Epoch 64 / 100: avg data time: 5.23e-02, avg batch time: 0.4981, average train loss: 0.0237
[09/26 05:39:25 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1674, average loss: 0.8071
[09/26 05:39:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.58	
[09/26 05:39:25 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.03454915028125263
[09/26 05:39:32 visual_prompt]: Epoch 65 / 100: avg data time: 4.99e-02, avg batch time: 0.4935, average train loss: 0.0105
[09/26 05:39:33 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1673, average loss: 0.7638
[09/26 05:39:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.92	
[09/26 05:39:33 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.03289899283371657
[09/26 05:39:40 visual_prompt]: Epoch 66 / 100: avg data time: 5.54e-02, avg batch time: 0.5003, average train loss: 0.0120
[09/26 05:39:41 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1673, average loss: 0.6675
[09/26 05:39:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.49	
[09/26 05:39:41 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.0312696703292044
[09/26 05:39:48 visual_prompt]: Epoch 67 / 100: avg data time: 5.73e-02, avg batch time: 0.5010, average train loss: 0.0078
[09/26 05:39:50 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1674, average loss: 0.7472
[09/26 05:39:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.36	
[09/26 05:39:50 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.02966316784621
[09/26 05:39:56 visual_prompt]: Epoch 68 / 100: avg data time: 5.72e-02, avg batch time: 0.5031, average train loss: 0.0053
[09/26 05:39:58 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1674, average loss: 0.8482
[09/26 05:39:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.83	
[09/26 05:39:58 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.028081442660546126
[09/26 05:40:05 visual_prompt]: Epoch 69 / 100: avg data time: 4.90e-02, avg batch time: 0.4933, average train loss: 0.0031
[09/26 05:40:06 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1676, average loss: 0.9614
[09/26 05:40:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.66	
[09/26 05:40:06 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.026526421860705474
[09/26 05:40:13 visual_prompt]: Epoch 70 / 100: avg data time: 4.29e-02, avg batch time: 0.4887, average train loss: 0.0018
[09/26 05:40:14 visual_prompt]: Inference (val):avg data time: 3.27e-05, avg batch time: 0.1673, average loss: 0.9654
[09/26 05:40:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.07	
[09/26 05:40:14 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.025000000000000012
[09/26 05:40:21 visual_prompt]: Epoch 71 / 100: avg data time: 5.25e-02, avg batch time: 0.4969, average train loss: 0.0012
[09/26 05:40:22 visual_prompt]: Inference (val):avg data time: 3.07e-05, avg batch time: 0.1675, average loss: 1.0456
[09/26 05:40:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.00	
[09/26 05:40:22 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.02350403678833976
[09/26 05:40:29 visual_prompt]: Epoch 72 / 100: avg data time: 4.81e-02, avg batch time: 0.4944, average train loss: 0.0010
[09/26 05:40:31 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1672, average loss: 1.1309
[09/26 05:40:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.08	
[09/26 05:40:31 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.022040354826462667
[09/26 05:40:37 visual_prompt]: Epoch 73 / 100: avg data time: 4.76e-02, avg batch time: 0.4922, average train loss: 0.0010
[09/26 05:40:39 visual_prompt]: Inference (val):avg data time: 5.04e-05, avg batch time: 0.1674, average loss: 1.1748
[09/26 05:40:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.14	
[09/26 05:40:39 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.02061073738537635
[09/26 05:40:46 visual_prompt]: Epoch 74 / 100: avg data time: 5.80e-02, avg batch time: 0.5017, average train loss: 0.0009
[09/26 05:40:47 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1674, average loss: 1.1979
[09/26 05:40:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.18	
[09/26 05:40:47 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.019216926233717086
[09/26 05:40:54 visual_prompt]: Epoch 75 / 100: avg data time: 4.18e-02, avg batch time: 0.4874, average train loss: 0.0009
[09/26 05:40:55 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1677, average loss: 1.2147
[09/26 05:40:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.17	
[09/26 05:40:55 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.017860619515673033
[09/26 05:41:02 visual_prompt]: Epoch 76 / 100: avg data time: 4.68e-02, avg batch time: 0.4917, average train loss: 0.0008
[09/26 05:41:03 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1679, average loss: 1.2265
[09/26 05:41:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.16	
[09/26 05:41:03 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.016543469682057107
[09/26 05:41:10 visual_prompt]: Epoch 77 / 100: avg data time: 5.64e-02, avg batch time: 0.5011, average train loss: 0.0007
[09/26 05:41:12 visual_prompt]: Inference (val):avg data time: 3.26e-05, avg batch time: 0.1675, average loss: 1.2392
[09/26 05:41:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.15	
[09/26 05:41:12 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.015267081477050132
[09/26 05:41:18 visual_prompt]: Epoch 78 / 100: avg data time: 5.34e-02, avg batch time: 0.4979, average train loss: 0.0007
[09/26 05:41:20 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1674, average loss: 1.2461
[09/26 05:41:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.16	
[09/26 05:41:20 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.014033009983067453
[09/26 05:41:27 visual_prompt]: Epoch 79 / 100: avg data time: 5.71e-02, avg batch time: 0.5025, average train loss: 0.0007
[09/26 05:41:28 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1674, average loss: 1.2514
[09/26 05:41:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.15	
[09/26 05:41:28 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.012842758726130284
[09/26 05:41:35 visual_prompt]: Epoch 80 / 100: avg data time: 6.68e-02, avg batch time: 0.5105, average train loss: 0.0007
[09/26 05:41:36 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1671, average loss: 1.2547
[09/26 05:41:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.14	
[09/26 05:41:36 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.011697777844051106
[09/26 05:41:43 visual_prompt]: Epoch 81 / 100: avg data time: 5.46e-02, avg batch time: 0.4990, average train loss: 0.0007
[09/26 05:41:44 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1673, average loss: 1.2580
[09/26 05:41:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.14	
[09/26 05:41:44 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.010599462319663905
[09/26 05:41:51 visual_prompt]: Epoch 82 / 100: avg data time: 4.58e-02, avg batch time: 0.4901, average train loss: 0.0007
[09/26 05:41:53 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1675, average loss: 1.2640
[09/26 05:41:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.13	
[09/26 05:41:53 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.009549150281252633
[09/26 05:41:59 visual_prompt]: Epoch 83 / 100: avg data time: 5.83e-02, avg batch time: 0.5033, average train loss: 0.0007
[09/26 05:42:01 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1674, average loss: 1.2741
[09/26 05:42:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.13	
[09/26 05:42:01 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.008548121372247919
[09/26 05:42:07 visual_prompt]: Epoch 84 / 100: avg data time: 4.70e-02, avg batch time: 0.4925, average train loss: 0.0007
[09/26 05:42:09 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1673, average loss: 1.2800
[09/26 05:42:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.13	
[09/26 05:42:09 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.007597595192178702
[09/26 05:42:16 visual_prompt]: Epoch 85 / 100: avg data time: 5.82e-02, avg batch time: 0.5045, average train loss: 0.0007
[09/26 05:42:17 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1673, average loss: 1.2853
[09/26 05:42:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.11	
[09/26 05:42:17 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.006698729810778065
[09/26 05:42:24 visual_prompt]: Epoch 86 / 100: avg data time: 4.19e-02, avg batch time: 0.4867, average train loss: 0.0007
[09/26 05:42:25 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1675, average loss: 1.2946
[09/26 05:42:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.12	
[09/26 05:42:25 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.005852620357053651
[09/26 05:42:32 visual_prompt]: Epoch 87 / 100: avg data time: 5.12e-02, avg batch time: 0.4962, average train loss: 0.0006
[09/26 05:42:33 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1676, average loss: 1.2983
[09/26 05:42:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.12	
[09/26 05:42:33 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.00506029768504166
[09/26 05:42:40 visual_prompt]: Epoch 88 / 100: avg data time: 5.08e-02, avg batch time: 0.4956, average train loss: 0.0006
[09/26 05:42:41 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1673, average loss: 1.2990
[09/26 05:42:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.12	
[09/26 05:42:41 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.004322727117869951
[09/26 05:42:48 visual_prompt]: Epoch 89 / 100: avg data time: 4.16e-02, avg batch time: 0.4867, average train loss: 0.0006
[09/26 05:42:49 visual_prompt]: Inference (val):avg data time: 3.24e-05, avg batch time: 0.1673, average loss: 1.2987
[09/26 05:42:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.12	
[09/26 05:42:49 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.0036408072716606343
[09/26 05:42:56 visual_prompt]: Epoch 90 / 100: avg data time: 4.62e-02, avg batch time: 0.4904, average train loss: 0.0006
[09/26 05:42:58 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1674, average loss: 1.2999
[09/26 05:42:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.12	
[09/26 05:42:58 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.0030153689607045845
[09/26 05:43:04 visual_prompt]: Epoch 91 / 100: avg data time: 5.57e-02, avg batch time: 0.4996, average train loss: 0.0006
[09/26 05:43:06 visual_prompt]: Inference (val):avg data time: 4.52e-05, avg batch time: 0.1675, average loss: 1.3005
[09/26 05:43:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.13	
[09/26 05:43:06 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.0024471741852423235
[09/26 05:43:13 visual_prompt]: Epoch 92 / 100: avg data time: 5.54e-02, avg batch time: 0.5001, average train loss: 0.0006
[09/26 05:43:14 visual_prompt]: Inference (val):avg data time: 4.35e-05, avg batch time: 0.1685, average loss: 1.3011
[09/26 05:43:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.12	
[09/26 05:43:14 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.0019369152030840554
[09/26 05:43:21 visual_prompt]: Epoch 93 / 100: avg data time: 6.12e-02, avg batch time: 0.5059, average train loss: 0.0006
[09/26 05:43:23 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1676, average loss: 1.3022
[09/26 05:43:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.12	
[09/26 05:43:23 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.0014852136862001765
[09/26 05:43:30 visual_prompt]: Epoch 94 / 100: avg data time: 5.62e-02, avg batch time: 0.5017, average train loss: 0.0006
[09/26 05:43:31 visual_prompt]: Inference (val):avg data time: 5.29e-05, avg batch time: 0.1673, average loss: 1.3026
[09/26 05:43:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.12	
[09/26 05:43:31 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.0010926199633097156
[09/26 05:43:38 visual_prompt]: Epoch 95 / 100: avg data time: 5.20e-02, avg batch time: 0.4954, average train loss: 0.0006
[09/26 05:43:39 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1677, average loss: 1.3034
[09/26 05:43:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.12	
[09/26 05:43:39 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.0007596123493895991
[09/26 05:43:46 visual_prompt]: Epoch 96 / 100: avg data time: 4.38e-02, avg batch time: 0.4889, average train loss: 0.0007
[09/26 05:43:47 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1675, average loss: 1.3043
[09/26 05:43:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.12	
[09/26 05:43:47 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.00048659656292148194
[09/26 05:43:54 visual_prompt]: Epoch 97 / 100: avg data time: 4.80e-02, avg batch time: 0.4918, average train loss: 0.0006
[09/26 05:43:56 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1675, average loss: 1.3049
[09/26 05:43:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.13	
[09/26 05:43:56 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.0002739052315863355
[09/26 05:44:02 visual_prompt]: Epoch 98 / 100: avg data time: 4.25e-02, avg batch time: 0.4879, average train loss: 0.0006
[09/26 05:44:04 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1674, average loss: 1.3050
[09/26 05:44:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.13	
[09/26 05:44:04 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.00012179748700879012
[09/26 05:44:10 visual_prompt]: Epoch 99 / 100: avg data time: 5.90e-02, avg batch time: 0.5041, average train loss: 0.0006
[09/26 05:44:12 visual_prompt]: Inference (val):avg data time: 3.20e-05, avg batch time: 0.1673, average loss: 1.3050
[09/26 05:44:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.13	
[09/26 05:44:12 visual_prompt]: Training 100 / 100 epoch, with learning rate 3.0458649045211895e-05
[09/26 05:44:19 visual_prompt]: Epoch 100 / 100: avg data time: 4.59e-02, avg batch time: 0.4908, average train loss: 0.0006
[09/26 05:44:20 visual_prompt]: Inference (val):avg data time: 3.30e-05, avg batch time: 0.1676, average loss: 1.3050
[09/26 05:44:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.13	
[09/26 05:44:20 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 05:44:20 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 05:44:20 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 05:44:20 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 05:44:20 visual_prompt]: Training with config:
[09/26 05:44:20 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr0.1_wd0.0001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 0.1, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 05:44:20 visual_prompt]: Loading training data...
[09/26 05:44:20 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 05:44:21 visual_prompt]: Number of images: 800
[09/26 05:44:21 visual_prompt]: Number of classes: 2 / 2
[09/26 05:44:21 visual_prompt]: Loading validation data...
[09/26 05:44:21 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 05:44:22 visual_prompt]: Number of images: 200
[09/26 05:44:22 visual_prompt]: Number of classes: 2 / 2
[09/26 05:44:22 visual_prompt]: Constructing models...
[09/26 05:44:24 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 05:44:24 visual_prompt]: tuned percent:0.536
[09/26 05:44:24 visual_prompt]: Device used for model: 0
[09/26 05:44:24 visual_prompt]: Setting up Evaluator...
[09/26 05:44:24 visual_prompt]: Setting up Trainer...
[09/26 05:44:24 visual_prompt]: 	Setting up the optimizer...
[09/26 05:44:24 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 05:44:31 visual_prompt]: Epoch 1 / 100: avg data time: 5.14e-02, avg batch time: 0.4946, average train loss: 1.9477
[09/26 05:44:32 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1668, average loss: 2.0033
[09/26 05:44:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 05:44:32 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 05:44:32 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.010000000000000002
[09/26 05:44:39 visual_prompt]: Epoch 2 / 100: avg data time: 5.22e-02, avg batch time: 0.4967, average train loss: 1.4195
[09/26 05:44:41 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1670, average loss: 0.7985
[09/26 05:44:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.50	rocauc: 62.13	
[09/26 05:44:41 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.020000000000000004
[09/26 05:44:47 visual_prompt]: Epoch 3 / 100: avg data time: 4.68e-02, avg batch time: 0.4896, average train loss: 0.6954
[09/26 05:44:49 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1671, average loss: 0.6120
[09/26 05:44:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.00	rocauc: 87.80	
[09/26 05:44:49 visual_prompt]: Best epoch 3: best metric: 0.720
[09/26 05:44:49 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.03
[09/26 05:44:55 visual_prompt]: Epoch 4 / 100: avg data time: 4.10e-02, avg batch time: 0.4851, average train loss: 0.6468
[09/26 05:44:57 visual_prompt]: Inference (val):avg data time: 3.17e-05, avg batch time: 0.1669, average loss: 0.5475
[09/26 05:44:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 90.01	
[09/26 05:44:57 visual_prompt]: Best epoch 4: best metric: 0.760
[09/26 05:44:57 visual_prompt]: Training 5 / 100 epoch, with learning rate 0.04000000000000001
[09/26 05:45:03 visual_prompt]: Epoch 5 / 100: avg data time: 4.21e-02, avg batch time: 0.4859, average train loss: 0.5747
[09/26 05:45:05 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1671, average loss: 0.5490
[09/26 05:45:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.00	rocauc: 90.44	
[09/26 05:45:05 visual_prompt]: Training 6 / 100 epoch, with learning rate 0.05
[09/26 05:45:11 visual_prompt]: Epoch 6 / 100: avg data time: 4.75e-02, avg batch time: 0.4936, average train loss: 0.5339
[09/26 05:45:13 visual_prompt]: Inference (val):avg data time: 2.79e-05, avg batch time: 0.1670, average loss: 0.3791
[09/26 05:45:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 90.60	
[09/26 05:45:13 visual_prompt]: Best epoch 6: best metric: 0.850
[09/26 05:45:13 visual_prompt]: Training 7 / 100 epoch, with learning rate 0.06
[09/26 05:45:20 visual_prompt]: Epoch 7 / 100: avg data time: 5.27e-02, avg batch time: 0.4957, average train loss: 0.5028
[09/26 05:45:21 visual_prompt]: Inference (val):avg data time: 3.34e-05, avg batch time: 0.1675, average loss: 0.4352
[09/26 05:45:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 90.44	
[09/26 05:45:21 visual_prompt]: Training 8 / 100 epoch, with learning rate 0.06999999999999999
[09/26 05:45:28 visual_prompt]: Epoch 8 / 100: avg data time: 5.61e-02, avg batch time: 0.4996, average train loss: 0.5620
[09/26 05:45:29 visual_prompt]: Inference (val):avg data time: 3.18e-05, avg batch time: 0.1673, average loss: 0.6607
[09/26 05:45:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 62.00	rocauc: 90.74	
[09/26 05:45:29 visual_prompt]: Training 9 / 100 epoch, with learning rate 0.08000000000000002
[09/26 05:45:36 visual_prompt]: Epoch 9 / 100: avg data time: 4.90e-02, avg batch time: 0.4935, average train loss: 0.4968
[09/26 05:45:38 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1674, average loss: 0.4482
[09/26 05:45:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 91.84	
[09/26 05:45:38 visual_prompt]: Training 10 / 100 epoch, with learning rate 0.09000000000000001
[09/26 05:45:44 visual_prompt]: Epoch 10 / 100: avg data time: 4.85e-02, avg batch time: 0.4925, average train loss: 0.5304
[09/26 05:45:46 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1673, average loss: 0.5157
[09/26 05:45:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.00	rocauc: 91.28	
[09/26 05:45:46 visual_prompt]: Training 11 / 100 epoch, with learning rate 0.1
[09/26 05:45:52 visual_prompt]: Epoch 11 / 100: avg data time: 4.56e-02, avg batch time: 0.4914, average train loss: 0.5090
[09/26 05:45:54 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1672, average loss: 0.5157
[09/26 05:45:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 69.50	rocauc: 91.11	
[09/26 05:45:54 visual_prompt]: Training 12 / 100 epoch, with learning rate 0.0999695413509548
[09/26 05:46:01 visual_prompt]: Epoch 12 / 100: avg data time: 4.95e-02, avg batch time: 0.4938, average train loss: 0.4633
[09/26 05:46:02 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1676, average loss: 0.3977
[09/26 05:46:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.40	
[09/26 05:46:02 visual_prompt]: Training 13 / 100 epoch, with learning rate 0.09987820251299122
[09/26 05:46:09 visual_prompt]: Epoch 13 / 100: avg data time: 5.79e-02, avg batch time: 0.5009, average train loss: 0.4767
[09/26 05:46:10 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1673, average loss: 0.4064
[09/26 05:46:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.81	
[09/26 05:46:10 visual_prompt]: Training 14 / 100 epoch, with learning rate 0.09972609476841367
[09/26 05:46:17 visual_prompt]: Epoch 14 / 100: avg data time: 6.06e-02, avg batch time: 0.5046, average train loss: 0.4663
[09/26 05:46:19 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1674, average loss: 0.3747
[09/26 05:46:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.84	
[09/26 05:46:19 visual_prompt]: Training 15 / 100 epoch, with learning rate 0.09951340343707853
[09/26 05:46:26 visual_prompt]: Epoch 15 / 100: avg data time: 6.31e-02, avg batch time: 0.5060, average train loss: 0.3813
[09/26 05:46:27 visual_prompt]: Inference (val):avg data time: 3.28e-05, avg batch time: 0.1674, average loss: 0.3993
[09/26 05:46:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.60	
[09/26 05:46:27 visual_prompt]: Training 16 / 100 epoch, with learning rate 0.09924038765061041
[09/26 05:46:34 visual_prompt]: Epoch 16 / 100: avg data time: 5.45e-02, avg batch time: 0.4979, average train loss: 0.4127
[09/26 05:46:35 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1673, average loss: 0.5949
[09/26 05:46:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 68.50	rocauc: 91.06	
[09/26 05:46:35 visual_prompt]: Training 17 / 100 epoch, with learning rate 0.09890738003669029
[09/26 05:46:42 visual_prompt]: Epoch 17 / 100: avg data time: 4.81e-02, avg batch time: 0.4943, average train loss: 0.4362
[09/26 05:46:43 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1674, average loss: 0.4688
[09/26 05:46:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 92.53	
[09/26 05:46:43 visual_prompt]: Training 18 / 100 epoch, with learning rate 0.09851478631379983
[09/26 05:46:50 visual_prompt]: Epoch 18 / 100: avg data time: 5.95e-02, avg batch time: 0.5035, average train loss: 0.3883
[09/26 05:46:52 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1672, average loss: 0.3619
[09/26 05:46:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.52	
[09/26 05:46:52 visual_prompt]: Training 19 / 100 epoch, with learning rate 0.09806308479691594
[09/26 05:46:58 visual_prompt]: Epoch 19 / 100: avg data time: 5.79e-02, avg batch time: 0.5021, average train loss: 0.3308
[09/26 05:47:00 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1676, average loss: 0.3913
[09/26 05:47:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.94	
[09/26 05:47:00 visual_prompt]: Training 20 / 100 epoch, with learning rate 0.09755282581475769
[09/26 05:47:07 visual_prompt]: Epoch 20 / 100: avg data time: 4.68e-02, avg batch time: 0.4926, average train loss: 0.3448
[09/26 05:47:08 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1672, average loss: 0.4055
[09/26 05:47:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.29	
[09/26 05:47:08 visual_prompt]: Training 21 / 100 epoch, with learning rate 0.09698463103929543
[09/26 05:47:15 visual_prompt]: Epoch 21 / 100: avg data time: 5.17e-02, avg batch time: 0.4990, average train loss: 0.3390
[09/26 05:47:16 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1672, average loss: 0.3634
[09/26 05:47:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.75	
[09/26 05:47:16 visual_prompt]: Training 22 / 100 epoch, with learning rate 0.09635919272833937
[09/26 05:47:23 visual_prompt]: Epoch 22 / 100: avg data time: 4.67e-02, avg batch time: 0.4915, average train loss: 0.3095
[09/26 05:47:24 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1676, average loss: 0.3967
[09/26 05:47:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.43	
[09/26 05:47:24 visual_prompt]: Training 23 / 100 epoch, with learning rate 0.09567727288213004
[09/26 05:47:31 visual_prompt]: Epoch 23 / 100: avg data time: 5.70e-02, avg batch time: 0.5019, average train loss: 0.2941
[09/26 05:47:32 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1673, average loss: 0.3680
[09/26 05:47:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.82	
[09/26 05:47:32 visual_prompt]: Training 24 / 100 epoch, with learning rate 0.09493970231495835
[09/26 05:47:39 visual_prompt]: Epoch 24 / 100: avg data time: 4.74e-02, avg batch time: 0.4915, average train loss: 0.3027
[09/26 05:47:40 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1673, average loss: 0.4007
[09/26 05:47:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 91.55	
[09/26 05:47:40 visual_prompt]: Training 25 / 100 epoch, with learning rate 0.09414737964294635
[09/26 05:47:47 visual_prompt]: Epoch 25 / 100: avg data time: 5.77e-02, avg batch time: 0.5012, average train loss: 0.2563
[09/26 05:47:49 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1676, average loss: 0.4047
[09/26 05:47:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.11	
[09/26 05:47:49 visual_prompt]: Training 26 / 100 epoch, with learning rate 0.09330127018922195
[09/26 05:47:55 visual_prompt]: Epoch 26 / 100: avg data time: 5.52e-02, avg batch time: 0.4990, average train loss: 0.2707
[09/26 05:47:57 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1675, average loss: 0.3973
[09/26 05:47:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.49	
[09/26 05:47:57 visual_prompt]: Best epoch 26: best metric: 0.855
[09/26 05:47:57 visual_prompt]: Training 27 / 100 epoch, with learning rate 0.0924024048078213
[09/26 05:48:03 visual_prompt]: Epoch 27 / 100: avg data time: 4.70e-02, avg batch time: 0.4922, average train loss: 0.2632
[09/26 05:48:05 visual_prompt]: Inference (val):avg data time: 2.70e-05, avg batch time: 0.1675, average loss: 0.3899
[09/26 05:48:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.59	
[09/26 05:48:05 visual_prompt]: Training 28 / 100 epoch, with learning rate 0.09145187862775209
[09/26 05:48:12 visual_prompt]: Epoch 28 / 100: avg data time: 5.59e-02, avg batch time: 0.5018, average train loss: 0.2169
[09/26 05:48:13 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1673, average loss: 0.3994
[09/26 05:48:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 93.44	
[09/26 05:48:13 visual_prompt]: Training 29 / 100 epoch, with learning rate 0.09045084971874738
[09/26 05:48:20 visual_prompt]: Epoch 29 / 100: avg data time: 4.89e-02, avg batch time: 0.4941, average train loss: 0.1881
[09/26 05:48:21 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1674, average loss: 0.5049
[09/26 05:48:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.75	
[09/26 05:48:21 visual_prompt]: Training 30 / 100 epoch, with learning rate 0.0894005376803361
[09/26 05:48:28 visual_prompt]: Epoch 30 / 100: avg data time: 4.46e-02, avg batch time: 0.4895, average train loss: 0.2643
[09/26 05:48:30 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1673, average loss: 0.3317
[09/26 05:48:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.26	
[09/26 05:48:30 visual_prompt]: Best epoch 30: best metric: 0.865
[09/26 05:48:30 visual_prompt]: Training 31 / 100 epoch, with learning rate 0.0883022221559489
[09/26 05:48:36 visual_prompt]: Epoch 31 / 100: avg data time: 5.20e-02, avg batch time: 0.4961, average train loss: 0.2413
[09/26 05:48:38 visual_prompt]: Inference (val):avg data time: 2.95e-05, avg batch time: 0.1674, average loss: 0.3241
[09/26 05:48:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 94.28	
[09/26 05:48:38 visual_prompt]: Training 32 / 100 epoch, with learning rate 0.08715724127386971
[09/26 05:48:44 visual_prompt]: Epoch 32 / 100: avg data time: 4.76e-02, avg batch time: 0.4911, average train loss: 0.1987
[09/26 05:48:46 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1674, average loss: 0.3523
[09/26 05:48:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 94.26	
[09/26 05:48:46 visual_prompt]: Best epoch 32: best metric: 0.880
[09/26 05:48:46 visual_prompt]: Training 33 / 100 epoch, with learning rate 0.08596699001693256
[09/26 05:48:53 visual_prompt]: Epoch 33 / 100: avg data time: 5.62e-02, avg batch time: 0.5012, average train loss: 0.1683
[09/26 05:48:54 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1676, average loss: 0.3972
[09/26 05:48:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 93.24	
[09/26 05:48:54 visual_prompt]: Training 34 / 100 epoch, with learning rate 0.08473291852294987
[09/26 05:49:01 visual_prompt]: Epoch 34 / 100: avg data time: 5.67e-02, avg batch time: 0.5011, average train loss: 0.1788
[09/26 05:49:03 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1675, average loss: 0.5565
[09/26 05:49:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 94.43	
[09/26 05:49:03 visual_prompt]: Training 35 / 100 epoch, with learning rate 0.08345653031794292
[09/26 05:49:09 visual_prompt]: Epoch 35 / 100: avg data time: 5.54e-02, avg batch time: 0.4992, average train loss: 0.2171
[09/26 05:49:11 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1673, average loss: 0.3325
[09/26 05:49:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.91	
[09/26 05:49:11 visual_prompt]: Training 36 / 100 epoch, with learning rate 0.08213938048432697
[09/26 05:49:18 visual_prompt]: Epoch 36 / 100: avg data time: 5.69e-02, avg batch time: 0.5004, average train loss: 0.1515
[09/26 05:49:19 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1675, average loss: 0.3787
[09/26 05:49:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.54	
[09/26 05:49:19 visual_prompt]: Training 37 / 100 epoch, with learning rate 0.08078307376628291
[09/26 05:49:26 visual_prompt]: Epoch 37 / 100: avg data time: 6.03e-02, avg batch time: 0.5048, average train loss: 0.1653
[09/26 05:49:27 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1676, average loss: 0.4281
[09/26 05:49:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 94.61	
[09/26 05:49:27 visual_prompt]: Training 38 / 100 epoch, with learning rate 0.07938926261462366
[09/26 05:49:34 visual_prompt]: Epoch 38 / 100: avg data time: 4.85e-02, avg batch time: 0.4932, average train loss: 0.2346
[09/26 05:49:36 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1674, average loss: 0.4324
[09/26 05:49:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.90	
[09/26 05:49:36 visual_prompt]: Training 39 / 100 epoch, with learning rate 0.07795964517353735
[09/26 05:49:42 visual_prompt]: Epoch 39 / 100: avg data time: 5.54e-02, avg batch time: 0.4996, average train loss: 0.1573
[09/26 05:49:44 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1672, average loss: 0.4357
[09/26 05:49:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.96	
[09/26 05:49:44 visual_prompt]: Training 40 / 100 epoch, with learning rate 0.07649596321166025
[09/26 05:49:51 visual_prompt]: Epoch 40 / 100: avg data time: 5.76e-02, avg batch time: 0.5014, average train loss: 0.1103
[09/26 05:49:52 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1676, average loss: 0.3605
[09/26 05:49:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.08	
[09/26 05:49:52 visual_prompt]: Training 41 / 100 epoch, with learning rate 0.07500000000000001
[09/26 05:49:59 visual_prompt]: Epoch 41 / 100: avg data time: 5.70e-02, avg batch time: 0.5004, average train loss: 0.0867
[09/26 05:50:00 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1673, average loss: 0.5146
[09/26 05:50:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.45	
[09/26 05:50:00 visual_prompt]: Training 42 / 100 epoch, with learning rate 0.07347357813929455
[09/26 05:50:07 visual_prompt]: Epoch 42 / 100: avg data time: 5.34e-02, avg batch time: 0.4986, average train loss: 0.0753
[09/26 05:50:08 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1673, average loss: 0.5333
[09/26 05:50:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.53	
[09/26 05:50:08 visual_prompt]: Training 43 / 100 epoch, with learning rate 0.07191855733945388
[09/26 05:50:15 visual_prompt]: Epoch 43 / 100: avg data time: 4.87e-02, avg batch time: 0.4942, average train loss: 0.0643
[09/26 05:50:17 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1675, average loss: 0.5641
[09/26 05:50:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.65	
[09/26 05:50:17 visual_prompt]: Training 44 / 100 epoch, with learning rate 0.07033683215379002
[09/26 05:50:23 visual_prompt]: Epoch 44 / 100: avg data time: 5.30e-02, avg batch time: 0.4975, average train loss: 0.0695
[09/26 05:50:25 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1675, average loss: 0.4851
[09/26 05:50:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.54	
[09/26 05:50:25 visual_prompt]: Training 45 / 100 epoch, with learning rate 0.0687303296707956
[09/26 05:50:31 visual_prompt]: Epoch 45 / 100: avg data time: 4.92e-02, avg batch time: 0.4930, average train loss: 0.0488
[09/26 05:50:33 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1673, average loss: 0.6046
[09/26 05:50:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.82	
[09/26 05:50:33 visual_prompt]: Training 46 / 100 epoch, with learning rate 0.06710100716628345
[09/26 05:50:40 visual_prompt]: Epoch 46 / 100: avg data time: 4.15e-02, avg batch time: 0.4874, average train loss: 0.0391
[09/26 05:50:41 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1674, average loss: 0.7051
[09/26 05:50:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.23	
[09/26 05:50:41 visual_prompt]: Training 47 / 100 epoch, with learning rate 0.06545084971874737
[09/26 05:50:48 visual_prompt]: Epoch 47 / 100: avg data time: 4.17e-02, avg batch time: 0.4880, average train loss: 0.0335
[09/26 05:50:49 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1676, average loss: 0.7263
[09/26 05:50:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.45	
[09/26 05:50:49 visual_prompt]: Training 48 / 100 epoch, with learning rate 0.06378186779084996
[09/26 05:50:56 visual_prompt]: Epoch 48 / 100: avg data time: 4.45e-02, avg batch time: 0.4890, average train loss: 0.0257
[09/26 05:50:57 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1674, average loss: 0.7864
[09/26 05:50:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.47	
[09/26 05:50:57 visual_prompt]: Training 49 / 100 epoch, with learning rate 0.06209609477998338
[09/26 05:51:04 visual_prompt]: Epoch 49 / 100: avg data time: 4.92e-02, avg batch time: 0.4936, average train loss: 0.0681
[09/26 05:51:05 visual_prompt]: Inference (val):avg data time: 3.18e-05, avg batch time: 0.1674, average loss: 0.7358
[09/26 05:51:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.00	
[09/26 05:51:05 visual_prompt]: Training 50 / 100 epoch, with learning rate 0.06039558454088796
[09/26 05:51:12 visual_prompt]: Epoch 50 / 100: avg data time: 4.20e-02, avg batch time: 0.4873, average train loss: 0.0742
[09/26 05:51:14 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1676, average loss: 0.5895
[09/26 05:51:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.39	
[09/26 05:51:14 visual_prompt]: Training 51 / 100 epoch, with learning rate 0.058682408883346526
[09/26 05:51:20 visual_prompt]: Epoch 51 / 100: avg data time: 5.12e-02, avg batch time: 0.4965, average train loss: 0.0490
[09/26 05:51:22 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1676, average loss: 0.7649
[09/26 05:51:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.04	
[09/26 05:51:22 visual_prompt]: Training 52 / 100 epoch, with learning rate 0.05695865504800327
[09/26 05:51:29 visual_prompt]: Epoch 52 / 100: avg data time: 5.35e-02, avg batch time: 0.4980, average train loss: 0.0436
[09/26 05:51:30 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1675, average loss: 0.7755
[09/26 05:51:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 90.55	
[09/26 05:51:30 visual_prompt]: Training 53 / 100 epoch, with learning rate 0.05522642316338268
[09/26 05:51:37 visual_prompt]: Epoch 53 / 100: avg data time: 5.88e-02, avg batch time: 0.5036, average train loss: 0.0291
[09/26 05:51:38 visual_prompt]: Inference (val):avg data time: 3.14e-05, avg batch time: 0.1673, average loss: 0.8297
[09/26 05:51:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 91.52	
[09/26 05:51:38 visual_prompt]: Training 54 / 100 epoch, with learning rate 0.05348782368720626
[09/26 05:51:45 visual_prompt]: Epoch 54 / 100: avg data time: 5.99e-02, avg batch time: 0.5050, average train loss: 0.0205
[09/26 05:51:47 visual_prompt]: Inference (val):avg data time: 2.70e-05, avg batch time: 0.1676, average loss: 0.9698
[09/26 05:51:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 90.72	
[09/26 05:51:47 visual_prompt]: Training 55 / 100 epoch, with learning rate 0.05174497483512506
[09/26 05:51:54 visual_prompt]: Epoch 55 / 100: avg data time: 6.25e-02, avg batch time: 0.5065, average train loss: 0.0261
[09/26 05:51:55 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1676, average loss: 0.8836
[09/26 05:51:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 92.23	
[09/26 05:51:55 visual_prompt]: Training 56 / 100 epoch, with learning rate 0.05
[09/26 05:52:02 visual_prompt]: Epoch 56 / 100: avg data time: 4.40e-02, avg batch time: 0.4892, average train loss: 0.0408
[09/26 05:52:03 visual_prompt]: Inference (val):avg data time: 3.08e-05, avg batch time: 0.1674, average loss: 0.9841
[09/26 05:52:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 91.78	
[09/26 05:52:03 visual_prompt]: Training 57 / 100 epoch, with learning rate 0.04825502516487497
[09/26 05:52:10 visual_prompt]: Epoch 57 / 100: avg data time: 5.36e-02, avg batch time: 0.4987, average train loss: 0.0965
[09/26 05:52:12 visual_prompt]: Inference (val):avg data time: 3.33e-05, avg batch time: 0.1673, average loss: 1.1714
[09/26 05:52:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.14	
[09/26 05:52:12 visual_prompt]: Training 58 / 100 epoch, with learning rate 0.04651217631279374
[09/26 05:52:18 visual_prompt]: Epoch 58 / 100: avg data time: 4.87e-02, avg batch time: 0.4950, average train loss: 0.1276
[09/26 05:52:20 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1671, average loss: 0.6827
[09/26 05:52:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 90.84	
[09/26 05:52:20 visual_prompt]: Training 59 / 100 epoch, with learning rate 0.04477357683661734
[09/26 05:52:26 visual_prompt]: Epoch 59 / 100: avg data time: 4.61e-02, avg batch time: 0.4909, average train loss: 0.0841
[09/26 05:52:28 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1675, average loss: 0.6257
[09/26 05:52:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.61	
[09/26 05:52:28 visual_prompt]: Training 60 / 100 epoch, with learning rate 0.04304134495199674
[09/26 05:52:35 visual_prompt]: Epoch 60 / 100: avg data time: 6.11e-02, avg batch time: 0.5046, average train loss: 0.0575
[09/26 05:52:36 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1674, average loss: 0.6321
[09/26 05:52:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.61	
[09/26 05:52:36 visual_prompt]: Training 61 / 100 epoch, with learning rate 0.041317591116653486
[09/26 05:52:43 visual_prompt]: Epoch 61 / 100: avg data time: 4.79e-02, avg batch time: 0.4938, average train loss: 0.0141
[09/26 05:52:44 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1673, average loss: 0.7452
[09/26 05:52:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 90.31	
[09/26 05:52:44 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.039604415459112044
[09/26 05:52:51 visual_prompt]: Epoch 62 / 100: avg data time: 4.52e-02, avg batch time: 0.4925, average train loss: 0.0078
[09/26 05:52:53 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1671, average loss: 0.7729
[09/26 05:52:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.66	
[09/26 05:52:53 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.037903905220016625
[09/26 05:52:59 visual_prompt]: Epoch 63 / 100: avg data time: 4.26e-02, avg batch time: 0.4882, average train loss: 0.0062
[09/26 05:53:01 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1675, average loss: 0.7881
[09/26 05:53:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.87	
[09/26 05:53:01 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.036218132209150045
[09/26 05:53:07 visual_prompt]: Epoch 64 / 100: avg data time: 4.90e-02, avg batch time: 0.4935, average train loss: 0.0038
[09/26 05:53:09 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1676, average loss: 0.8342
[09/26 05:53:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.58	
[09/26 05:53:09 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.03454915028125263
[09/26 05:53:16 visual_prompt]: Epoch 65 / 100: avg data time: 4.84e-02, avg batch time: 0.4923, average train loss: 0.0094
[09/26 05:53:17 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1674, average loss: 0.8367
[09/26 05:53:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.24	
[09/26 05:53:17 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.03289899283371657
[09/26 05:53:24 visual_prompt]: Epoch 66 / 100: avg data time: 4.82e-02, avg batch time: 0.4936, average train loss: 0.0064
[09/26 05:53:25 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1672, average loss: 0.9473
[09/26 05:53:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 92.14	
[09/26 05:53:25 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.0312696703292044
[09/26 05:53:32 visual_prompt]: Epoch 67 / 100: avg data time: 5.00e-02, avg batch time: 0.4956, average train loss: 0.0180
[09/26 05:53:33 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1677, average loss: 0.8289
[09/26 05:53:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.31	
[09/26 05:53:33 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.02966316784621
[09/26 05:53:40 visual_prompt]: Epoch 68 / 100: avg data time: 4.37e-02, avg batch time: 0.4887, average train loss: 0.0350
[09/26 05:53:41 visual_prompt]: Inference (val):avg data time: 3.08e-05, avg batch time: 0.1674, average loss: 0.8770
[09/26 05:53:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.83	
[09/26 05:53:41 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.028081442660546126
[09/26 05:53:48 visual_prompt]: Epoch 69 / 100: avg data time: 5.52e-02, avg batch time: 0.4992, average train loss: 0.0137
[09/26 05:53:50 visual_prompt]: Inference (val):avg data time: 3.10e-05, avg batch time: 0.1675, average loss: 0.7301
[09/26 05:53:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.86	
[09/26 05:53:50 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.026526421860705474
[09/26 05:53:56 visual_prompt]: Epoch 70 / 100: avg data time: 4.10e-02, avg batch time: 0.4855, average train loss: 0.0135
[09/26 05:53:58 visual_prompt]: Inference (val):avg data time: 3.28e-05, avg batch time: 0.1676, average loss: 0.8092
[09/26 05:53:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.27	
[09/26 05:53:58 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.025000000000000012
[09/26 05:54:05 visual_prompt]: Epoch 71 / 100: avg data time: 5.53e-02, avg batch time: 0.4990, average train loss: 0.0030
[09/26 05:54:06 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1676, average loss: 0.8532
[09/26 05:54:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.71	
[09/26 05:54:06 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.02350403678833976
[09/26 05:54:13 visual_prompt]: Epoch 72 / 100: avg data time: 4.45e-02, avg batch time: 0.4920, average train loss: 0.0027
[09/26 05:54:14 visual_prompt]: Inference (val):avg data time: 3.52e-05, avg batch time: 0.1673, average loss: 0.8613
[09/26 05:54:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 92.01	
[09/26 05:54:14 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.022040354826462667
[09/26 05:54:21 visual_prompt]: Epoch 73 / 100: avg data time: 6.17e-02, avg batch time: 0.5059, average train loss: 0.0024
[09/26 05:54:23 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1673, average loss: 0.8621
[09/26 05:54:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.31	
[09/26 05:54:23 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.02061073738537635
[09/26 05:54:29 visual_prompt]: Epoch 74 / 100: avg data time: 5.24e-02, avg batch time: 0.4974, average train loss: 0.0016
[09/26 05:54:31 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1674, average loss: 0.8683
[09/26 05:54:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.49	
[09/26 05:54:31 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.019216926233717086
[09/26 05:54:38 visual_prompt]: Epoch 75 / 100: avg data time: 4.70e-02, avg batch time: 0.4920, average train loss: 0.0013
[09/26 05:54:39 visual_prompt]: Inference (val):avg data time: 3.12e-05, avg batch time: 0.1672, average loss: 0.8815
[09/26 05:54:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.55	
[09/26 05:54:39 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.017860619515673033
[09/26 05:54:46 visual_prompt]: Epoch 76 / 100: avg data time: 5.22e-02, avg batch time: 0.4978, average train loss: 0.0012
[09/26 05:54:47 visual_prompt]: Inference (val):avg data time: 3.39e-05, avg batch time: 0.1677, average loss: 0.8863
[09/26 05:54:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.55	
[09/26 05:54:47 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.016543469682057107
[09/26 05:54:54 visual_prompt]: Epoch 77 / 100: avg data time: 5.67e-02, avg batch time: 0.5019, average train loss: 0.0018
[09/26 05:54:56 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1675, average loss: 0.8988
[09/26 05:54:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.53	
[09/26 05:54:56 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.015267081477050132
[09/26 05:55:02 visual_prompt]: Epoch 78 / 100: avg data time: 6.34e-02, avg batch time: 0.5084, average train loss: 0.0011
[09/26 05:55:04 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1670, average loss: 0.9061
[09/26 05:55:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.51	
[09/26 05:55:04 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.014033009983067453
[09/26 05:55:11 visual_prompt]: Epoch 79 / 100: avg data time: 6.11e-02, avg batch time: 0.5053, average train loss: 0.0012
[09/26 05:55:12 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1675, average loss: 0.9128
[09/26 05:55:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.53	
[09/26 05:55:12 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.012842758726130284
[09/26 05:55:19 visual_prompt]: Epoch 80 / 100: avg data time: 5.13e-02, avg batch time: 0.4968, average train loss: 0.0010
[09/26 05:55:20 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1672, average loss: 0.9160
[09/26 05:55:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.53	
[09/26 05:55:20 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.011697777844051106
[09/26 05:55:27 visual_prompt]: Epoch 81 / 100: avg data time: 4.86e-02, avg batch time: 0.4937, average train loss: 0.0010
[09/26 05:55:29 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1673, average loss: 0.9185
[09/26 05:55:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.52	
[09/26 05:55:29 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.010599462319663905
[09/26 05:55:35 visual_prompt]: Epoch 82 / 100: avg data time: 5.79e-02, avg batch time: 0.5032, average train loss: 0.0009
[09/26 05:55:37 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1672, average loss: 0.9225
[09/26 05:55:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.52	
[09/26 05:55:37 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.009549150281252633
[09/26 05:55:44 visual_prompt]: Epoch 83 / 100: avg data time: 4.30e-02, avg batch time: 0.4894, average train loss: 0.0009
[09/26 05:55:45 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1673, average loss: 0.9267
[09/26 05:55:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.52	
[09/26 05:55:45 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.008548121372247919
[09/26 05:55:52 visual_prompt]: Epoch 84 / 100: avg data time: 4.35e-02, avg batch time: 0.4885, average train loss: 0.0009
[09/26 05:55:53 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1675, average loss: 0.9305
[09/26 05:55:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.51	
[09/26 05:55:53 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.007597595192178702
[09/26 05:56:00 visual_prompt]: Epoch 85 / 100: avg data time: 4.39e-02, avg batch time: 0.4889, average train loss: 0.0009
[09/26 05:56:01 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1673, average loss: 0.9320
[09/26 05:56:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.52	
[09/26 05:56:01 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.006698729810778065
[09/26 05:56:08 visual_prompt]: Epoch 86 / 100: avg data time: 5.55e-02, avg batch time: 0.5002, average train loss: 0.0013
[09/26 05:56:09 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1674, average loss: 0.9344
[09/26 05:56:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.53	
[09/26 05:56:09 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.005852620357053651
[09/26 05:56:16 visual_prompt]: Epoch 87 / 100: avg data time: 5.09e-02, avg batch time: 0.4957, average train loss: 0.0008
[09/26 05:56:18 visual_prompt]: Inference (val):avg data time: 3.13e-05, avg batch time: 0.1677, average loss: 0.9368
[09/26 05:56:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.54	
[09/26 05:56:18 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.00506029768504166
[09/26 05:56:24 visual_prompt]: Epoch 88 / 100: avg data time: 4.71e-02, avg batch time: 0.4915, average train loss: 0.0008
[09/26 05:56:26 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1673, average loss: 0.9383
[09/26 05:56:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.53	
[09/26 05:56:26 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.004322727117869951
[09/26 05:56:33 visual_prompt]: Epoch 89 / 100: avg data time: 4.89e-02, avg batch time: 0.4944, average train loss: 0.0009
[09/26 05:56:34 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1674, average loss: 0.9391
[09/26 05:56:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.52	
[09/26 05:56:34 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.0036408072716606343
[09/26 05:56:41 visual_prompt]: Epoch 90 / 100: avg data time: 5.85e-02, avg batch time: 0.5025, average train loss: 0.0009
[09/26 05:56:42 visual_prompt]: Inference (val):avg data time: 3.26e-05, avg batch time: 0.1678, average loss: 0.9397
[09/26 05:56:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.51	
[09/26 05:56:42 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.0030153689607045845
[09/26 05:56:49 visual_prompt]: Epoch 91 / 100: avg data time: 4.16e-02, avg batch time: 0.4877, average train loss: 0.0008
[09/26 05:56:50 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1676, average loss: 0.9404
[09/26 05:56:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.51	
[09/26 05:56:50 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.0024471741852423235
[09/26 05:56:57 visual_prompt]: Epoch 92 / 100: avg data time: 5.61e-02, avg batch time: 0.5009, average train loss: 0.0008
[09/26 05:56:59 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1674, average loss: 0.9412
[09/26 05:56:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.52	
[09/26 05:56:59 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.0019369152030840554
[09/26 05:57:05 visual_prompt]: Epoch 93 / 100: avg data time: 5.35e-02, avg batch time: 0.4981, average train loss: 0.0010
[09/26 05:57:07 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1674, average loss: 0.9420
[09/26 05:57:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.52	
[09/26 05:57:07 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.0014852136862001765
[09/26 05:57:14 visual_prompt]: Epoch 94 / 100: avg data time: 5.85e-02, avg batch time: 0.5031, average train loss: 0.0009
[09/26 05:57:15 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1673, average loss: 0.9425
[09/26 05:57:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.52	
[09/26 05:57:15 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.0010926199633097156
[09/26 05:57:22 visual_prompt]: Epoch 95 / 100: avg data time: 5.99e-02, avg batch time: 0.5033, average train loss: 0.0009
[09/26 05:57:24 visual_prompt]: Inference (val):avg data time: 3.07e-05, avg batch time: 0.1674, average loss: 0.9426
[09/26 05:57:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.52	
[09/26 05:57:24 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.0007596123493895991
[09/26 05:57:30 visual_prompt]: Epoch 96 / 100: avg data time: 5.91e-02, avg batch time: 0.5034, average train loss: 0.0009
[09/26 05:57:32 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1674, average loss: 0.9426
[09/26 05:57:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.51	
[09/26 05:57:32 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.00048659656292148194
[09/26 05:57:39 visual_prompt]: Epoch 97 / 100: avg data time: 5.98e-02, avg batch time: 0.5043, average train loss: 0.0007
[09/26 05:57:40 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1671, average loss: 0.9427
[09/26 05:57:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.51	
[09/26 05:57:40 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.0002739052315863355
[09/26 05:57:47 visual_prompt]: Epoch 98 / 100: avg data time: 5.20e-02, avg batch time: 0.4968, average train loss: 0.0008
[09/26 05:57:48 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1674, average loss: 0.9427
[09/26 05:57:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.51	
[09/26 05:57:48 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.00012179748700879012
[09/26 05:57:55 visual_prompt]: Epoch 99 / 100: avg data time: 4.90e-02, avg batch time: 0.4935, average train loss: 0.0007
[09/26 05:57:56 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1674, average loss: 0.9427
[09/26 05:57:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.51	
[09/26 05:57:56 visual_prompt]: Training 100 / 100 epoch, with learning rate 3.0458649045211895e-05
[09/26 05:58:03 visual_prompt]: Epoch 100 / 100: avg data time: 4.13e-02, avg batch time: 0.4883, average train loss: 0.0008
[09/26 05:58:04 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1680, average loss: 0.9427
[09/26 05:58:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.51	
[09/26 05:58:04 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 05:58:04 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 05:58:04 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 05:58:04 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 05:58:04 visual_prompt]: Training with config:
[09/26 05:58:04 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr0.1_wd0.0/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 0.1, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 05:58:04 visual_prompt]: Loading training data...
[09/26 05:58:04 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 05:58:06 visual_prompt]: Number of images: 800
[09/26 05:58:06 visual_prompt]: Number of classes: 2 / 2
[09/26 05:58:06 visual_prompt]: Loading validation data...
[09/26 05:58:06 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 05:58:06 visual_prompt]: Number of images: 200
[09/26 05:58:06 visual_prompt]: Number of classes: 2 / 2
[09/26 05:58:06 visual_prompt]: Constructing models...
[09/26 05:58:08 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 05:58:08 visual_prompt]: tuned percent:0.536
[09/26 05:58:09 visual_prompt]: Device used for model: 0
[09/26 05:58:09 visual_prompt]: Setting up Evaluator...
[09/26 05:58:09 visual_prompt]: Setting up Trainer...
[09/26 05:58:09 visual_prompt]: 	Setting up the optimizer...
[09/26 05:58:09 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 05:58:15 visual_prompt]: Epoch 1 / 100: avg data time: 4.10e-02, avg batch time: 0.4862, average train loss: 1.9568
[09/26 05:58:17 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1668, average loss: 2.0033
[09/26 05:58:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 05:58:17 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 05:58:17 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.010000000000000002
[09/26 05:58:23 visual_prompt]: Epoch 2 / 100: avg data time: 5.03e-02, avg batch time: 0.4947, average train loss: 1.4491
[09/26 05:58:25 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1669, average loss: 0.7560
[09/26 05:58:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 67.15	
[09/26 05:58:25 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.020000000000000004
[09/26 05:58:32 visual_prompt]: Epoch 3 / 100: avg data time: 4.50e-02, avg batch time: 0.4887, average train loss: 0.7008
[09/26 05:58:33 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1672, average loss: 0.5886
[09/26 05:58:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.50	rocauc: 87.87	
[09/26 05:58:33 visual_prompt]: Best epoch 3: best metric: 0.735
[09/26 05:58:33 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.03
[09/26 05:58:40 visual_prompt]: Epoch 4 / 100: avg data time: 5.70e-02, avg batch time: 0.4994, average train loss: 0.5890
[09/26 05:58:41 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1668, average loss: 0.5756
[09/26 05:58:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.00	rocauc: 89.92	
[09/26 05:58:41 visual_prompt]: Training 5 / 100 epoch, with learning rate 0.04000000000000001
[09/26 05:58:48 visual_prompt]: Epoch 5 / 100: avg data time: 6.15e-02, avg batch time: 0.5038, average train loss: 0.6140
[09/26 05:58:50 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1672, average loss: 0.5187
[09/26 05:58:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 88.31	
[09/26 05:58:50 visual_prompt]: Best epoch 5: best metric: 0.810
[09/26 05:58:50 visual_prompt]: Training 6 / 100 epoch, with learning rate 0.05
[09/26 05:58:56 visual_prompt]: Epoch 6 / 100: avg data time: 4.68e-02, avg batch time: 0.4927, average train loss: 0.5808
[09/26 05:58:58 visual_prompt]: Inference (val):avg data time: 3.45e-05, avg batch time: 0.1674, average loss: 0.4127
[09/26 05:58:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 90.02	
[09/26 05:58:58 visual_prompt]: Best epoch 6: best metric: 0.835
[09/26 05:58:58 visual_prompt]: Training 7 / 100 epoch, with learning rate 0.06
[09/26 05:59:05 visual_prompt]: Epoch 7 / 100: avg data time: 5.32e-02, avg batch time: 0.4974, average train loss: 0.5057
[09/26 05:59:06 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1672, average loss: 0.3812
[09/26 05:59:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 90.80	
[09/26 05:59:06 visual_prompt]: Best epoch 7: best metric: 0.845
[09/26 05:59:06 visual_prompt]: Training 8 / 100 epoch, with learning rate 0.06999999999999999
[09/26 05:59:13 visual_prompt]: Epoch 8 / 100: avg data time: 4.67e-02, avg batch time: 0.4909, average train loss: 0.4531
[09/26 05:59:14 visual_prompt]: Inference (val):avg data time: 3.87e-05, avg batch time: 0.1671, average loss: 0.4315
[09/26 05:59:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 90.00	
[09/26 05:59:14 visual_prompt]: Training 9 / 100 epoch, with learning rate 0.08000000000000002
[09/26 05:59:21 visual_prompt]: Epoch 9 / 100: avg data time: 5.03e-02, avg batch time: 0.4943, average train loss: 0.4731
[09/26 05:59:23 visual_prompt]: Inference (val):avg data time: 3.03e-05, avg batch time: 0.1675, average loss: 0.3795
[09/26 05:59:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.61	
[09/26 05:59:23 visual_prompt]: Training 10 / 100 epoch, with learning rate 0.09000000000000001
[09/26 05:59:29 visual_prompt]: Epoch 10 / 100: avg data time: 5.62e-02, avg batch time: 0.4998, average train loss: 0.4725
[09/26 05:59:31 visual_prompt]: Inference (val):avg data time: 3.25e-05, avg batch time: 0.1674, average loss: 0.4426
[09/26 05:59:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 91.13	
[09/26 05:59:31 visual_prompt]: Training 11 / 100 epoch, with learning rate 0.1
[09/26 05:59:37 visual_prompt]: Epoch 11 / 100: avg data time: 4.98e-02, avg batch time: 0.4955, average train loss: 0.4596
[09/26 05:59:39 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1672, average loss: 0.3712
[09/26 05:59:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.72	
[09/26 05:59:39 visual_prompt]: Training 12 / 100 epoch, with learning rate 0.0999695413509548
[09/26 05:59:46 visual_prompt]: Epoch 12 / 100: avg data time: 4.72e-02, avg batch time: 0.4920, average train loss: 0.4583
[09/26 05:59:47 visual_prompt]: Inference (val):avg data time: 3.88e-05, avg batch time: 0.1671, average loss: 0.4757
[09/26 05:59:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 91.42	
[09/26 05:59:47 visual_prompt]: Training 13 / 100 epoch, with learning rate 0.09987820251299122
[09/26 05:59:54 visual_prompt]: Epoch 13 / 100: avg data time: 4.24e-02, avg batch time: 0.4868, average train loss: 0.4780
[09/26 05:59:55 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1674, average loss: 0.3591
[09/26 05:59:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.99	
[09/26 05:59:55 visual_prompt]: Training 14 / 100 epoch, with learning rate 0.09972609476841367
[09/26 06:00:02 visual_prompt]: Epoch 14 / 100: avg data time: 4.55e-02, avg batch time: 0.4897, average train loss: 0.4330
[09/26 06:00:03 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1675, average loss: 0.3755
[09/26 06:00:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.49	
[09/26 06:00:03 visual_prompt]: Training 15 / 100 epoch, with learning rate 0.09951340343707853
[09/26 06:00:10 visual_prompt]: Epoch 15 / 100: avg data time: 6.03e-02, avg batch time: 0.5049, average train loss: 0.3922
[09/26 06:00:12 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1674, average loss: 0.4473
[09/26 06:00:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.00	rocauc: 91.36	
[09/26 06:00:12 visual_prompt]: Training 16 / 100 epoch, with learning rate 0.09924038765061041
[09/26 06:00:18 visual_prompt]: Epoch 16 / 100: avg data time: 5.45e-02, avg batch time: 0.4985, average train loss: 0.4233
[09/26 06:00:20 visual_prompt]: Inference (val):avg data time: 3.16e-05, avg batch time: 0.1674, average loss: 0.3620
[09/26 06:00:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.39	
[09/26 06:00:20 visual_prompt]: Training 17 / 100 epoch, with learning rate 0.09890738003669029
[09/26 06:00:27 visual_prompt]: Epoch 17 / 100: avg data time: 6.08e-02, avg batch time: 0.5043, average train loss: 0.4140
[09/26 06:00:28 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1676, average loss: 0.3749
[09/26 06:00:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.54	
[09/26 06:00:28 visual_prompt]: Training 18 / 100 epoch, with learning rate 0.09851478631379983
[09/26 06:00:35 visual_prompt]: Epoch 18 / 100: avg data time: 5.90e-02, avg batch time: 0.5037, average train loss: 0.3462
[09/26 06:00:36 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1671, average loss: 0.3945
[09/26 06:00:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 90.40	
[09/26 06:00:36 visual_prompt]: Training 19 / 100 epoch, with learning rate 0.09806308479691594
[09/26 06:00:43 visual_prompt]: Epoch 19 / 100: avg data time: 4.57e-02, avg batch time: 0.4894, average train loss: 0.3508
[09/26 06:00:44 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1674, average loss: 0.3906
[09/26 06:00:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.25	
[09/26 06:00:44 visual_prompt]: Training 20 / 100 epoch, with learning rate 0.09755282581475769
[09/26 06:00:51 visual_prompt]: Epoch 20 / 100: avg data time: 4.53e-02, avg batch time: 0.4897, average train loss: 0.3075
[09/26 06:00:53 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1672, average loss: 0.3568
[09/26 06:00:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.33	
[09/26 06:00:53 visual_prompt]: Training 21 / 100 epoch, with learning rate 0.09698463103929543
[09/26 06:00:59 visual_prompt]: Epoch 21 / 100: avg data time: 5.30e-02, avg batch time: 0.4975, average train loss: 0.3059
[09/26 06:01:01 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1674, average loss: 0.4529
[09/26 06:01:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.54	
[09/26 06:01:01 visual_prompt]: Training 22 / 100 epoch, with learning rate 0.09635919272833937
[09/26 06:01:08 visual_prompt]: Epoch 22 / 100: avg data time: 5.88e-02, avg batch time: 0.5022, average train loss: 0.3433
[09/26 06:01:09 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1674, average loss: 0.3670
[09/26 06:01:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.81	
[09/26 06:01:09 visual_prompt]: Training 23 / 100 epoch, with learning rate 0.09567727288213004
[09/26 06:01:16 visual_prompt]: Epoch 23 / 100: avg data time: 5.15e-02, avg batch time: 0.4960, average train loss: 0.2934
[09/26 06:01:17 visual_prompt]: Inference (val):avg data time: 4.39e-05, avg batch time: 0.1676, average loss: 0.6009
[09/26 06:01:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.50	rocauc: 91.90	
[09/26 06:01:17 visual_prompt]: Training 24 / 100 epoch, with learning rate 0.09493970231495835
[09/26 06:01:24 visual_prompt]: Epoch 24 / 100: avg data time: 4.31e-02, avg batch time: 0.4862, average train loss: 0.2983
[09/26 06:01:25 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1675, average loss: 0.3947
[09/26 06:01:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.01	
[09/26 06:01:25 visual_prompt]: Best epoch 24: best metric: 0.850
[09/26 06:01:25 visual_prompt]: Training 25 / 100 epoch, with learning rate 0.09414737964294635
[09/26 06:01:32 visual_prompt]: Epoch 25 / 100: avg data time: 4.64e-02, avg batch time: 0.4910, average train loss: 0.2791
[09/26 06:01:34 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1674, average loss: 0.3543
[09/26 06:01:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 92.61	
[09/26 06:01:34 visual_prompt]: Training 26 / 100 epoch, with learning rate 0.09330127018922195
[09/26 06:01:40 visual_prompt]: Epoch 26 / 100: avg data time: 4.17e-02, avg batch time: 0.4865, average train loss: 0.2535
[09/26 06:01:42 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1671, average loss: 0.5867
[09/26 06:01:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 90.03	
[09/26 06:01:42 visual_prompt]: Training 27 / 100 epoch, with learning rate 0.0924024048078213
[09/26 06:01:48 visual_prompt]: Epoch 27 / 100: avg data time: 5.17e-02, avg batch time: 0.4963, average train loss: 0.3140
[09/26 06:01:50 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1674, average loss: 0.3751
[09/26 06:01:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.37	
[09/26 06:01:50 visual_prompt]: Training 28 / 100 epoch, with learning rate 0.09145187862775209
[09/26 06:01:57 visual_prompt]: Epoch 28 / 100: avg data time: 5.08e-02, avg batch time: 0.4961, average train loss: 0.2908
[09/26 06:01:58 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1675, average loss: 0.4116
[09/26 06:01:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.23	
[09/26 06:01:58 visual_prompt]: Training 29 / 100 epoch, with learning rate 0.09045084971874738
[09/26 06:02:05 visual_prompt]: Epoch 29 / 100: avg data time: 6.08e-02, avg batch time: 0.5059, average train loss: 0.2725
[09/26 06:02:06 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1672, average loss: 0.3760
[09/26 06:02:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 94.63	
[09/26 06:02:06 visual_prompt]: Training 30 / 100 epoch, with learning rate 0.0894005376803361
[09/26 06:02:13 visual_prompt]: Epoch 30 / 100: avg data time: 5.45e-02, avg batch time: 0.4991, average train loss: 0.2797
[09/26 06:02:15 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1673, average loss: 0.3373
[09/26 06:02:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.02	
[09/26 06:02:15 visual_prompt]: Best epoch 30: best metric: 0.870
[09/26 06:02:15 visual_prompt]: Training 31 / 100 epoch, with learning rate 0.0883022221559489
[09/26 06:02:21 visual_prompt]: Epoch 31 / 100: avg data time: 5.76e-02, avg batch time: 0.5008, average train loss: 0.2442
[09/26 06:02:23 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1674, average loss: 0.3858
[09/26 06:02:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.65	
[09/26 06:02:23 visual_prompt]: Training 32 / 100 epoch, with learning rate 0.08715724127386971
[09/26 06:02:29 visual_prompt]: Epoch 32 / 100: avg data time: 4.37e-02, avg batch time: 0.4893, average train loss: 0.2612
[09/26 06:02:31 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1676, average loss: 0.4014
[09/26 06:02:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.66	
[09/26 06:02:31 visual_prompt]: Training 33 / 100 epoch, with learning rate 0.08596699001693256
[09/26 06:02:38 visual_prompt]: Epoch 33 / 100: avg data time: 4.31e-02, avg batch time: 0.4891, average train loss: 0.2202
[09/26 06:02:39 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1673, average loss: 0.3635
[09/26 06:02:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.84	
[09/26 06:02:39 visual_prompt]: Training 34 / 100 epoch, with learning rate 0.08473291852294987
[09/26 06:02:46 visual_prompt]: Epoch 34 / 100: avg data time: 4.31e-02, avg batch time: 0.4891, average train loss: 0.1729
[09/26 06:02:47 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1673, average loss: 0.4286
[09/26 06:02:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.64	
[09/26 06:02:47 visual_prompt]: Training 35 / 100 epoch, with learning rate 0.08345653031794292
[09/26 06:02:54 visual_prompt]: Epoch 35 / 100: avg data time: 5.47e-02, avg batch time: 0.4998, average train loss: 0.2154
[09/26 06:02:55 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1675, average loss: 0.3607
[09/26 06:02:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.81	
[09/26 06:02:55 visual_prompt]: Training 36 / 100 epoch, with learning rate 0.08213938048432697
[09/26 06:03:02 visual_prompt]: Epoch 36 / 100: avg data time: 5.20e-02, avg batch time: 0.4974, average train loss: 0.1913
[09/26 06:03:04 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1679, average loss: 0.4775
[09/26 06:03:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.09	
[09/26 06:03:04 visual_prompt]: Training 37 / 100 epoch, with learning rate 0.08078307376628291
[09/26 06:03:10 visual_prompt]: Epoch 37 / 100: avg data time: 4.68e-02, avg batch time: 0.4938, average train loss: 0.1475
[09/26 06:03:12 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1673, average loss: 0.3971
[09/26 06:03:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.15	
[09/26 06:03:12 visual_prompt]: Training 38 / 100 epoch, with learning rate 0.07938926261462366
[09/26 06:03:18 visual_prompt]: Epoch 38 / 100: avg data time: 4.33e-02, avg batch time: 0.4874, average train loss: 0.1522
[09/26 06:03:20 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1673, average loss: 0.4215
[09/26 06:03:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.90	
[09/26 06:03:20 visual_prompt]: Training 39 / 100 epoch, with learning rate 0.07795964517353735
[09/26 06:03:27 visual_prompt]: Epoch 39 / 100: avg data time: 5.85e-02, avg batch time: 0.5020, average train loss: 0.1465
[09/26 06:03:28 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1674, average loss: 0.4173
[09/26 06:03:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.89	
[09/26 06:03:28 visual_prompt]: Training 40 / 100 epoch, with learning rate 0.07649596321166025
[09/26 06:03:35 visual_prompt]: Epoch 40 / 100: avg data time: 5.73e-02, avg batch time: 0.5013, average train loss: 0.1496
[09/26 06:03:36 visual_prompt]: Inference (val):avg data time: 3.24e-05, avg batch time: 0.1674, average loss: 0.4398
[09/26 06:03:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.15	
[09/26 06:03:36 visual_prompt]: Training 41 / 100 epoch, with learning rate 0.07500000000000001
[09/26 06:03:43 visual_prompt]: Epoch 41 / 100: avg data time: 4.24e-02, avg batch time: 0.4864, average train loss: 0.1259
[09/26 06:03:45 visual_prompt]: Inference (val):avg data time: 2.79e-05, avg batch time: 0.1674, average loss: 0.5948
[09/26 06:03:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.70	
[09/26 06:03:45 visual_prompt]: Training 42 / 100 epoch, with learning rate 0.07347357813929455
[09/26 06:03:51 visual_prompt]: Epoch 42 / 100: avg data time: 5.48e-02, avg batch time: 0.4995, average train loss: 0.1024
[09/26 06:03:53 visual_prompt]: Inference (val):avg data time: 3.10e-05, avg batch time: 0.1676, average loss: 0.6329
[09/26 06:03:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.32	
[09/26 06:03:53 visual_prompt]: Training 43 / 100 epoch, with learning rate 0.07191855733945388
[09/26 06:04:00 visual_prompt]: Epoch 43 / 100: avg data time: 4.60e-02, avg batch time: 0.4915, average train loss: 0.1407
[09/26 06:04:01 visual_prompt]: Inference (val):avg data time: 3.03e-05, avg batch time: 0.1676, average loss: 0.4266
[09/26 06:04:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.83	
[09/26 06:04:01 visual_prompt]: Training 44 / 100 epoch, with learning rate 0.07033683215379002
[09/26 06:04:08 visual_prompt]: Epoch 44 / 100: avg data time: 5.51e-02, avg batch time: 0.4995, average train loss: 0.1257
[09/26 06:04:09 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1676, average loss: 0.6218
[09/26 06:04:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.67	
[09/26 06:04:09 visual_prompt]: Training 45 / 100 epoch, with learning rate 0.0687303296707956
[09/26 06:04:16 visual_prompt]: Epoch 45 / 100: avg data time: 4.19e-02, avg batch time: 0.4877, average train loss: 0.1324
[09/26 06:04:17 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1678, average loss: 0.4268
[09/26 06:04:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.67	
[09/26 06:04:17 visual_prompt]: Training 46 / 100 epoch, with learning rate 0.06710100716628345
[09/26 06:04:24 visual_prompt]: Epoch 46 / 100: avg data time: 5.75e-02, avg batch time: 0.5016, average train loss: 0.1118
[09/26 06:04:26 visual_prompt]: Inference (val):avg data time: 3.18e-05, avg batch time: 0.1675, average loss: 0.5506
[09/26 06:04:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.88	
[09/26 06:04:26 visual_prompt]: Training 47 / 100 epoch, with learning rate 0.06545084971874737
[09/26 06:04:32 visual_prompt]: Epoch 47 / 100: avg data time: 5.84e-02, avg batch time: 0.5020, average train loss: 0.0872
[09/26 06:04:34 visual_prompt]: Inference (val):avg data time: 2.95e-05, avg batch time: 0.1678, average loss: 0.5706
[09/26 06:04:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.68	
[09/26 06:04:34 visual_prompt]: Training 48 / 100 epoch, with learning rate 0.06378186779084996
[09/26 06:04:41 visual_prompt]: Epoch 48 / 100: avg data time: 5.48e-02, avg batch time: 0.4983, average train loss: 0.0621
[09/26 06:04:42 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1675, average loss: 0.5844
[09/26 06:04:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 91.87	
[09/26 06:04:42 visual_prompt]: Training 49 / 100 epoch, with learning rate 0.06209609477998338
[09/26 06:04:49 visual_prompt]: Epoch 49 / 100: avg data time: 6.04e-02, avg batch time: 0.5040, average train loss: 0.0717
[09/26 06:04:51 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1678, average loss: 0.7819
[09/26 06:04:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 90.32	
[09/26 06:04:51 visual_prompt]: Training 50 / 100 epoch, with learning rate 0.06039558454088796
[09/26 06:04:57 visual_prompt]: Epoch 50 / 100: avg data time: 5.58e-02, avg batch time: 0.5015, average train loss: 0.0994
[09/26 06:04:59 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1676, average loss: 0.5582
[09/26 06:04:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.30	
[09/26 06:04:59 visual_prompt]: Training 51 / 100 epoch, with learning rate 0.058682408883346526
[09/26 06:05:06 visual_prompt]: Epoch 51 / 100: avg data time: 6.07e-02, avg batch time: 0.5044, average train loss: 0.0611
[09/26 06:05:07 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1675, average loss: 0.6959
[09/26 06:05:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 90.86	
[09/26 06:05:07 visual_prompt]: Training 52 / 100 epoch, with learning rate 0.05695865504800327
[09/26 06:05:14 visual_prompt]: Epoch 52 / 100: avg data time: 5.91e-02, avg batch time: 0.5036, average train loss: 0.0563
[09/26 06:05:15 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1675, average loss: 0.6978
[09/26 06:05:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.55	
[09/26 06:05:15 visual_prompt]: Training 53 / 100 epoch, with learning rate 0.05522642316338268
[09/26 06:05:22 visual_prompt]: Epoch 53 / 100: avg data time: 4.16e-02, avg batch time: 0.4872, average train loss: 0.0478
[09/26 06:05:23 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1676, average loss: 0.6314
[09/26 06:05:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.39	
[09/26 06:05:23 visual_prompt]: Training 54 / 100 epoch, with learning rate 0.05348782368720626
[09/26 06:05:30 visual_prompt]: Epoch 54 / 100: avg data time: 4.34e-02, avg batch time: 0.4882, average train loss: 0.0411
[09/26 06:05:32 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1675, average loss: 0.8096
[09/26 06:05:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.30	
[09/26 06:05:32 visual_prompt]: Training 55 / 100 epoch, with learning rate 0.05174497483512506
[09/26 06:05:38 visual_prompt]: Epoch 55 / 100: avg data time: 4.22e-02, avg batch time: 0.4881, average train loss: 0.0428
[09/26 06:05:40 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1675, average loss: 0.7124
[09/26 06:05:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.12	
[09/26 06:05:40 visual_prompt]: Training 56 / 100 epoch, with learning rate 0.05
[09/26 06:05:46 visual_prompt]: Epoch 56 / 100: avg data time: 4.77e-02, avg batch time: 0.4931, average train loss: 0.0312
[09/26 06:05:48 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1676, average loss: 1.0500
[09/26 06:05:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 90.73	
[09/26 06:05:48 visual_prompt]: Training 57 / 100 epoch, with learning rate 0.04825502516487497
[09/26 06:05:55 visual_prompt]: Epoch 57 / 100: avg data time: 4.30e-02, avg batch time: 0.4889, average train loss: 0.0436
[09/26 06:05:56 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1676, average loss: 0.9747
[09/26 06:05:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 90.40	
[09/26 06:05:56 visual_prompt]: Training 58 / 100 epoch, with learning rate 0.04651217631279374
[09/26 06:06:03 visual_prompt]: Epoch 58 / 100: avg data time: 4.77e-02, avg batch time: 0.4921, average train loss: 0.0711
[09/26 06:06:04 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1673, average loss: 0.6922
[09/26 06:06:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 90.75	
[09/26 06:06:04 visual_prompt]: Training 59 / 100 epoch, with learning rate 0.04477357683661734
[09/26 06:06:11 visual_prompt]: Epoch 59 / 100: avg data time: 5.18e-02, avg batch time: 0.4963, average train loss: 0.0390
[09/26 06:06:12 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1677, average loss: 0.8203
[09/26 06:06:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 90.96	
[09/26 06:06:12 visual_prompt]: Training 60 / 100 epoch, with learning rate 0.04304134495199674
[09/26 06:06:19 visual_prompt]: Epoch 60 / 100: avg data time: 4.77e-02, avg batch time: 0.4922, average train loss: 0.0225
[09/26 06:06:21 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1674, average loss: 1.0288
[09/26 06:06:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 90.81	
[09/26 06:06:21 visual_prompt]: Training 61 / 100 epoch, with learning rate 0.041317591116653486
[09/26 06:06:27 visual_prompt]: Epoch 61 / 100: avg data time: 5.25e-02, avg batch time: 0.4963, average train loss: 0.0317
[09/26 06:06:29 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1674, average loss: 1.0604
[09/26 06:06:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.56	
[09/26 06:06:29 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.039604415459112044
[09/26 06:06:35 visual_prompt]: Epoch 62 / 100: avg data time: 4.48e-02, avg batch time: 0.4890, average train loss: 0.0624
[09/26 06:06:37 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1676, average loss: 0.7085
[09/26 06:06:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 91.76	
[09/26 06:06:37 visual_prompt]: Best epoch 62: best metric: 0.875
[09/26 06:06:37 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.037903905220016625
[09/26 06:06:44 visual_prompt]: Epoch 63 / 100: avg data time: 5.82e-02, avg batch time: 0.5025, average train loss: 0.0358
[09/26 06:06:45 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1678, average loss: 0.6968
[09/26 06:06:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 90.90	
[09/26 06:06:45 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.036218132209150045
[09/26 06:06:52 visual_prompt]: Epoch 64 / 100: avg data time: 5.26e-02, avg batch time: 0.4971, average train loss: 0.0194
[09/26 06:06:54 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1677, average loss: 0.8532
[09/26 06:06:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.21	
[09/26 06:06:54 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.03454915028125263
[09/26 06:07:00 visual_prompt]: Epoch 65 / 100: avg data time: 5.49e-02, avg batch time: 0.4981, average train loss: 0.0134
[09/26 06:07:02 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1672, average loss: 0.8733
[09/26 06:07:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.21	
[09/26 06:07:02 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.03289899283371657
[09/26 06:07:09 visual_prompt]: Epoch 66 / 100: avg data time: 5.44e-02, avg batch time: 0.5000, average train loss: 0.0146
[09/26 06:07:10 visual_prompt]: Inference (val):avg data time: 3.20e-05, avg batch time: 0.1676, average loss: 0.9961
[09/26 06:07:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 90.20	
[09/26 06:07:10 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.0312696703292044
[09/26 06:07:17 visual_prompt]: Epoch 67 / 100: avg data time: 5.63e-02, avg batch time: 0.4998, average train loss: 0.0081
[09/26 06:07:18 visual_prompt]: Inference (val):avg data time: 4.70e-05, avg batch time: 0.1673, average loss: 1.2238
[09/26 06:07:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 90.09	
[09/26 06:07:18 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.02966316784621
[09/26 06:07:25 visual_prompt]: Epoch 68 / 100: avg data time: 5.17e-02, avg batch time: 0.4968, average train loss: 0.0231
[09/26 06:07:27 visual_prompt]: Inference (val):avg data time: 2.79e-05, avg batch time: 0.1674, average loss: 1.0240
[09/26 06:07:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 90.73	
[09/26 06:07:27 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.028081442660546126
[09/26 06:07:33 visual_prompt]: Epoch 69 / 100: avg data time: 5.33e-02, avg batch time: 0.4980, average train loss: 0.0127
[09/26 06:07:35 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1675, average loss: 1.4893
[09/26 06:07:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 89.90	
[09/26 06:07:35 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.026526421860705474
[09/26 06:07:41 visual_prompt]: Epoch 70 / 100: avg data time: 5.35e-02, avg batch time: 0.4980, average train loss: 0.0062
[09/26 06:07:43 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1671, average loss: 1.2058
[09/26 06:07:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 90.64	
[09/26 06:07:43 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.025000000000000012
[09/26 06:07:50 visual_prompt]: Epoch 71 / 100: avg data time: 5.06e-02, avg batch time: 0.4957, average train loss: 0.0076
[09/26 06:07:51 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1672, average loss: 1.7475
[09/26 06:07:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 89.20	
[09/26 06:07:51 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.02350403678833976
[09/26 06:07:58 visual_prompt]: Epoch 72 / 100: avg data time: 5.86e-02, avg batch time: 0.5036, average train loss: 0.0048
[09/26 06:07:59 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.1671, average loss: 1.2401
[09/26 06:07:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 90.30	
[09/26 06:07:59 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.022040354826462667
[09/26 06:08:06 visual_prompt]: Epoch 73 / 100: avg data time: 6.07e-02, avg batch time: 0.5043, average train loss: 0.0027
[09/26 06:08:08 visual_prompt]: Inference (val):avg data time: 2.23e-05, avg batch time: 0.1674, average loss: 1.3228
[09/26 06:08:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 90.77	
[09/26 06:08:08 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.02061073738537635
[09/26 06:08:14 visual_prompt]: Epoch 74 / 100: avg data time: 4.10e-02, avg batch time: 0.4892, average train loss: 0.0030
[09/26 06:08:16 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1674, average loss: 1.3351
[09/26 06:08:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 90.12	
[09/26 06:08:16 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.019216926233717086
[09/26 06:08:23 visual_prompt]: Epoch 75 / 100: avg data time: 4.86e-02, avg batch time: 0.4938, average train loss: 0.0018
[09/26 06:08:24 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1672, average loss: 1.5544
[09/26 06:08:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 89.98	
[09/26 06:08:24 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.017860619515673033
[09/26 06:08:31 visual_prompt]: Epoch 76 / 100: avg data time: 5.52e-02, avg batch time: 0.4991, average train loss: 0.0028
[09/26 06:08:32 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1675, average loss: 1.4927
[09/26 06:08:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 89.97	
[09/26 06:08:32 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.016543469682057107
[09/26 06:08:39 visual_prompt]: Epoch 77 / 100: avg data time: 4.34e-02, avg batch time: 0.4919, average train loss: 0.0014
[09/26 06:08:40 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1678, average loss: 1.6373
[09/26 06:08:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 89.81	
[09/26 06:08:40 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.015267081477050132
[09/26 06:08:47 visual_prompt]: Epoch 78 / 100: avg data time: 5.26e-02, avg batch time: 0.4966, average train loss: 0.0015
[09/26 06:08:49 visual_prompt]: Inference (val):avg data time: 2.79e-05, avg batch time: 0.1678, average loss: 1.7478
[09/26 06:08:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 89.60	
[09/26 06:08:49 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.014033009983067453
[09/26 06:08:55 visual_prompt]: Epoch 79 / 100: avg data time: 5.04e-02, avg batch time: 0.4959, average train loss: 0.0013
[09/26 06:08:57 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1675, average loss: 1.7363
[09/26 06:08:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 89.71	
[09/26 06:08:57 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.012842758726130284
[09/26 06:09:04 visual_prompt]: Epoch 80 / 100: avg data time: 4.64e-02, avg batch time: 0.4925, average train loss: 0.0016
[09/26 06:09:05 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1675, average loss: 1.7577
[09/26 06:09:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 89.80	
[09/26 06:09:05 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.011697777844051106
[09/26 06:09:12 visual_prompt]: Epoch 81 / 100: avg data time: 5.43e-02, avg batch time: 0.4989, average train loss: 0.0010
[09/26 06:09:13 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1674, average loss: 1.7488
[09/26 06:09:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 89.87	
[09/26 06:09:13 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.010599462319663905
[09/26 06:09:20 visual_prompt]: Epoch 82 / 100: avg data time: 5.69e-02, avg batch time: 0.5003, average train loss: 0.0022
[09/26 06:09:22 visual_prompt]: Inference (val):avg data time: 4.65e-05, avg batch time: 0.1674, average loss: 1.8617
[09/26 06:09:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 89.99	
[09/26 06:09:22 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.009549150281252633
[09/26 06:09:28 visual_prompt]: Epoch 83 / 100: avg data time: 5.70e-02, avg batch time: 0.5007, average train loss: 0.0013
[09/26 06:09:30 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1681, average loss: 1.9210
[09/26 06:09:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 90.06	
[09/26 06:09:30 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.008548121372247919
[09/26 06:09:37 visual_prompt]: Epoch 84 / 100: avg data time: 5.56e-02, avg batch time: 0.5005, average train loss: 0.0013
[09/26 06:09:38 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1675, average loss: 1.8130
[09/26 06:09:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 90.12	
[09/26 06:09:38 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.007597595192178702
[09/26 06:09:45 visual_prompt]: Epoch 85 / 100: avg data time: 4.49e-02, avg batch time: 0.4899, average train loss: 0.0012
[09/26 06:09:46 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1674, average loss: 1.7307
[09/26 06:09:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 90.15	
[09/26 06:09:46 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.006698729810778065
[09/26 06:09:53 visual_prompt]: Epoch 86 / 100: avg data time: 6.07e-02, avg batch time: 0.5046, average train loss: 0.0024
[09/26 06:09:55 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1676, average loss: 1.5102
[09/26 06:09:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 90.38	
[09/26 06:09:55 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.005852620357053651
[09/26 06:10:01 visual_prompt]: Epoch 87 / 100: avg data time: 6.11e-02, avg batch time: 0.5059, average train loss: 0.0011
[09/26 06:10:03 visual_prompt]: Inference (val):avg data time: 2.98e-05, avg batch time: 0.1676, average loss: 1.4658
[09/26 06:10:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 90.41	
[09/26 06:10:03 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.00506029768504166
[09/26 06:10:10 visual_prompt]: Epoch 88 / 100: avg data time: 5.99e-02, avg batch time: 0.5056, average train loss: 0.0013
[09/26 06:10:11 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1676, average loss: 1.5280
[09/26 06:10:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 90.37	
[09/26 06:10:11 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.004322727117869951
[09/26 06:10:18 visual_prompt]: Epoch 89 / 100: avg data time: 5.11e-02, avg batch time: 0.4950, average train loss: 0.0011
[09/26 06:10:19 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1674, average loss: 1.5564
[09/26 06:10:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 90.36	
[09/26 06:10:19 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.0036408072716606343
[09/26 06:10:26 visual_prompt]: Epoch 90 / 100: avg data time: 5.49e-02, avg batch time: 0.5001, average train loss: 0.0009
[09/26 06:10:28 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1674, average loss: 1.5851
[09/26 06:10:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 90.38	
[09/26 06:10:28 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.0030153689607045845
[09/26 06:10:34 visual_prompt]: Epoch 91 / 100: avg data time: 4.58e-02, avg batch time: 0.4906, average train loss: 0.0013
[09/26 06:10:36 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1672, average loss: 1.5890
[09/26 06:10:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 90.37	
[09/26 06:10:36 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.0024471741852423235
[09/26 06:10:42 visual_prompt]: Epoch 92 / 100: avg data time: 5.24e-02, avg batch time: 0.4966, average train loss: 0.0010
[09/26 06:10:44 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1675, average loss: 1.5912
[09/26 06:10:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 90.39	
[09/26 06:10:44 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.0019369152030840554
[09/26 06:10:50 visual_prompt]: Epoch 93 / 100: avg data time: 4.46e-02, avg batch time: 0.4888, average train loss: 0.0008
[09/26 06:10:52 visual_prompt]: Inference (val):avg data time: 2.09e-05, avg batch time: 0.1674, average loss: 1.6040
[09/26 06:10:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 90.36	
[09/26 06:10:52 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.0014852136862001765
[09/26 06:10:59 visual_prompt]: Epoch 94 / 100: avg data time: 4.89e-02, avg batch time: 0.4942, average train loss: 0.0009
[09/26 06:11:00 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1675, average loss: 1.6113
[09/26 06:11:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 90.35	
[09/26 06:11:00 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.0010926199633097156
[09/26 06:11:07 visual_prompt]: Epoch 95 / 100: avg data time: 4.35e-02, avg batch time: 0.4904, average train loss: 0.0011
[09/26 06:11:08 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.1675, average loss: 1.6172
[09/26 06:11:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 90.34	
[09/26 06:11:08 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.0007596123493895991
[09/26 06:11:15 visual_prompt]: Epoch 96 / 100: avg data time: 5.05e-02, avg batch time: 0.4958, average train loss: 0.0009
[09/26 06:11:16 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1678, average loss: 1.6203
[09/26 06:11:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 90.33	
[09/26 06:11:16 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.00048659656292148194
[09/26 06:11:23 visual_prompt]: Epoch 97 / 100: avg data time: 4.71e-02, avg batch time: 0.4913, average train loss: 0.0011
[09/26 06:11:25 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1672, average loss: 1.6213
[09/26 06:11:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 90.33	
[09/26 06:11:25 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.0002739052315863355
[09/26 06:11:31 visual_prompt]: Epoch 98 / 100: avg data time: 4.23e-02, avg batch time: 0.4865, average train loss: 0.0010
[09/26 06:11:33 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1677, average loss: 1.6223
[09/26 06:11:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 90.33	
[09/26 06:11:33 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.00012179748700879012
[09/26 06:11:39 visual_prompt]: Epoch 99 / 100: avg data time: 4.37e-02, avg batch time: 0.4902, average train loss: 0.0008
[09/26 06:11:41 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1675, average loss: 1.6227
[09/26 06:11:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 90.33	
[09/26 06:11:41 visual_prompt]: Training 100 / 100 epoch, with learning rate 3.0458649045211895e-05
[09/26 06:11:47 visual_prompt]: Epoch 100 / 100: avg data time: 4.06e-02, avg batch time: 0.4855, average train loss: 0.0010
[09/26 06:11:49 visual_prompt]: Inference (val):avg data time: 3.20e-05, avg batch time: 0.1676, average loss: 1.6229
[09/26 06:11:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 90.33	
[09/26 06:11:49 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 06:11:49 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 06:11:49 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 06:11:49 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 06:11:49 visual_prompt]: Training with config:
[09/26 06:11:49 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr0.05_wd0.01/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.01, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 0.05, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 06:11:49 visual_prompt]: Loading training data...
[09/26 06:11:49 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 06:11:50 visual_prompt]: Number of images: 800
[09/26 06:11:50 visual_prompt]: Number of classes: 2 / 2
[09/26 06:11:50 visual_prompt]: Loading validation data...
[09/26 06:11:50 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 06:11:50 visual_prompt]: Number of images: 200
[09/26 06:11:50 visual_prompt]: Number of classes: 2 / 2
[09/26 06:11:50 visual_prompt]: Constructing models...
[09/26 06:11:53 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 06:11:53 visual_prompt]: tuned percent:0.536
[09/26 06:11:53 visual_prompt]: Device used for model: 0
[09/26 06:11:53 visual_prompt]: Setting up Evaluator...
[09/26 06:11:53 visual_prompt]: Setting up Trainer...
[09/26 06:11:53 visual_prompt]: 	Setting up the optimizer...
[09/26 06:11:53 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 06:12:00 visual_prompt]: Epoch 1 / 100: avg data time: 5.04e-02, avg batch time: 0.4933, average train loss: 1.9682
[09/26 06:12:01 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1670, average loss: 2.0033
[09/26 06:12:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 06:12:01 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 06:12:01 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.005000000000000001
[09/26 06:12:08 visual_prompt]: Epoch 2 / 100: avg data time: 4.49e-02, avg batch time: 0.4899, average train loss: 1.2266
[09/26 06:12:09 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1673, average loss: 0.6371
[09/26 06:12:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.50	rocauc: 77.96	
[09/26 06:12:09 visual_prompt]: Best epoch 2: best metric: 0.725
[09/26 06:12:09 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.010000000000000002
[09/26 06:12:16 visual_prompt]: Epoch 3 / 100: avg data time: 5.54e-02, avg batch time: 0.4989, average train loss: 0.6879
[09/26 06:12:17 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1673, average loss: 0.5976
[09/26 06:12:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 87.43	
[09/26 06:12:17 visual_prompt]: Best epoch 3: best metric: 0.790
[09/26 06:12:17 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.015
[09/26 06:12:24 visual_prompt]: Epoch 4 / 100: avg data time: 4.79e-02, avg batch time: 0.4914, average train loss: 0.6080
[09/26 06:12:25 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1672, average loss: 0.5403
[09/26 06:12:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 67.50	rocauc: 90.10	
[09/26 06:12:25 visual_prompt]: Training 5 / 100 epoch, with learning rate 0.020000000000000004
[09/26 06:12:32 visual_prompt]: Epoch 5 / 100: avg data time: 4.35e-02, avg batch time: 0.4867, average train loss: 0.5472
[09/26 06:12:34 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1673, average loss: 0.5057
[09/26 06:12:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 89.36	
[09/26 06:12:34 visual_prompt]: Training 6 / 100 epoch, with learning rate 0.025
[09/26 06:12:40 visual_prompt]: Epoch 6 / 100: avg data time: 4.61e-02, avg batch time: 0.4897, average train loss: 0.5951
[09/26 06:12:42 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1675, average loss: 0.6237
[09/26 06:12:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 59.50	rocauc: 89.49	
[09/26 06:12:42 visual_prompt]: Training 7 / 100 epoch, with learning rate 0.03
[09/26 06:12:48 visual_prompt]: Epoch 7 / 100: avg data time: 4.73e-02, avg batch time: 0.4906, average train loss: 0.6013
[09/26 06:12:50 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1671, average loss: 0.4070
[09/26 06:12:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 89.96	
[09/26 06:12:50 visual_prompt]: Best epoch 7: best metric: 0.825
[09/26 06:12:50 visual_prompt]: Training 8 / 100 epoch, with learning rate 0.034999999999999996
[09/26 06:12:57 visual_prompt]: Epoch 8 / 100: avg data time: 5.42e-02, avg batch time: 0.4976, average train loss: 0.4709
[09/26 06:12:58 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1675, average loss: 0.4150
[09/26 06:12:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 90.25	
[09/26 06:12:58 visual_prompt]: Training 9 / 100 epoch, with learning rate 0.04000000000000001
[09/26 06:13:05 visual_prompt]: Epoch 9 / 100: avg data time: 5.87e-02, avg batch time: 0.5025, average train loss: 0.5328
[09/26 06:13:06 visual_prompt]: Inference (val):avg data time: 3.07e-05, avg batch time: 0.1671, average loss: 0.4484
[09/26 06:13:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 90.31	
[09/26 06:13:06 visual_prompt]: Training 10 / 100 epoch, with learning rate 0.045000000000000005
[09/26 06:13:13 visual_prompt]: Epoch 10 / 100: avg data time: 5.10e-02, avg batch time: 0.4948, average train loss: 0.4843
[09/26 06:13:15 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1677, average loss: 0.4043
[09/26 06:13:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 90.57	
[09/26 06:13:15 visual_prompt]: Best epoch 10: best metric: 0.840
[09/26 06:13:15 visual_prompt]: Training 11 / 100 epoch, with learning rate 0.05
[09/26 06:13:21 visual_prompt]: Epoch 11 / 100: avg data time: 5.52e-02, avg batch time: 0.4993, average train loss: 0.5837
[09/26 06:13:23 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1672, average loss: 0.3956
[09/26 06:13:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 90.62	
[09/26 06:13:23 visual_prompt]: Best epoch 11: best metric: 0.855
[09/26 06:13:23 visual_prompt]: Training 12 / 100 epoch, with learning rate 0.0499847706754774
[09/26 06:13:30 visual_prompt]: Epoch 12 / 100: avg data time: 6.22e-02, avg batch time: 0.5064, average train loss: 0.4799
[09/26 06:13:31 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1674, average loss: 0.4383
[09/26 06:13:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 89.48	
[09/26 06:13:31 visual_prompt]: Training 13 / 100 epoch, with learning rate 0.04993910125649561
[09/26 06:13:38 visual_prompt]: Epoch 13 / 100: avg data time: 5.03e-02, avg batch time: 0.4939, average train loss: 0.4517
[09/26 06:13:39 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1674, average loss: 0.4442
[09/26 06:13:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 90.29	
[09/26 06:13:39 visual_prompt]: Training 14 / 100 epoch, with learning rate 0.049863047384206834
[09/26 06:13:46 visual_prompt]: Epoch 14 / 100: avg data time: 5.49e-02, avg batch time: 0.4988, average train loss: 0.5304
[09/26 06:13:48 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1671, average loss: 0.4254
[09/26 06:13:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.10	
[09/26 06:13:48 visual_prompt]: Training 15 / 100 epoch, with learning rate 0.04975670171853926
[09/26 06:13:54 visual_prompt]: Epoch 15 / 100: avg data time: 4.83e-02, avg batch time: 0.4919, average train loss: 0.4257
[09/26 06:13:56 visual_prompt]: Inference (val):avg data time: 3.17e-05, avg batch time: 0.1673, average loss: 0.4270
[09/26 06:13:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.83	
[09/26 06:13:56 visual_prompt]: Training 16 / 100 epoch, with learning rate 0.049620193825305206
[09/26 06:14:03 visual_prompt]: Epoch 16 / 100: avg data time: 4.21e-02, avg batch time: 0.4880, average train loss: 0.4218
[09/26 06:14:04 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1674, average loss: 0.5498
[09/26 06:14:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.50	rocauc: 89.55	
[09/26 06:14:04 visual_prompt]: Training 17 / 100 epoch, with learning rate 0.049453690018345146
[09/26 06:14:11 visual_prompt]: Epoch 17 / 100: avg data time: 5.33e-02, avg batch time: 0.4975, average train loss: 0.4081
[09/26 06:14:12 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1678, average loss: 0.3576
[09/26 06:14:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.95	
[09/26 06:14:12 visual_prompt]: Training 18 / 100 epoch, with learning rate 0.04925739315689991
[09/26 06:14:19 visual_prompt]: Epoch 18 / 100: avg data time: 4.37e-02, avg batch time: 0.4896, average train loss: 0.3958
[09/26 06:14:20 visual_prompt]: Inference (val):avg data time: 3.22e-05, avg batch time: 0.1675, average loss: 0.3998
[09/26 06:14:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.55	
[09/26 06:14:20 visual_prompt]: Training 19 / 100 epoch, with learning rate 0.04903154239845797
[09/26 06:14:27 visual_prompt]: Epoch 19 / 100: avg data time: 6.36e-02, avg batch time: 0.5070, average train loss: 0.3972
[09/26 06:14:29 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1673, average loss: 0.3776
[09/26 06:14:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.94	
[09/26 06:14:29 visual_prompt]: Training 20 / 100 epoch, with learning rate 0.048776412907378844
[09/26 06:14:36 visual_prompt]: Epoch 20 / 100: avg data time: 5.97e-02, avg batch time: 0.5030, average train loss: 0.3784
[09/26 06:14:37 visual_prompt]: Inference (val):avg data time: 3.52e-05, avg batch time: 0.1677, average loss: 0.3736
[09/26 06:14:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.42	
[09/26 06:14:37 visual_prompt]: Training 21 / 100 epoch, with learning rate 0.048492315519647715
[09/26 06:14:44 visual_prompt]: Epoch 21 / 100: avg data time: 5.81e-02, avg batch time: 0.5010, average train loss: 0.3747
[09/26 06:14:46 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1673, average loss: 0.3462
[09/26 06:14:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.26	
[09/26 06:14:46 visual_prompt]: Training 22 / 100 epoch, with learning rate 0.048179596364169686
[09/26 06:14:52 visual_prompt]: Epoch 22 / 100: avg data time: 4.47e-02, avg batch time: 0.4919, average train loss: 0.3352
[09/26 06:14:54 visual_prompt]: Inference (val):avg data time: 3.70e-05, avg batch time: 0.1672, average loss: 0.3837
[09/26 06:14:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 92.07	
[09/26 06:14:54 visual_prompt]: Training 23 / 100 epoch, with learning rate 0.04783863644106502
[09/26 06:15:00 visual_prompt]: Epoch 23 / 100: avg data time: 4.34e-02, avg batch time: 0.4874, average train loss: 0.2945
[09/26 06:15:02 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1674, average loss: 0.3885
[09/26 06:15:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.91	
[09/26 06:15:02 visual_prompt]: Training 24 / 100 epoch, with learning rate 0.047469851157479176
[09/26 06:15:09 visual_prompt]: Epoch 24 / 100: avg data time: 5.02e-02, avg batch time: 0.4951, average train loss: 0.4684
[09/26 06:15:10 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1674, average loss: 0.3721
[09/26 06:15:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.85	
[09/26 06:15:10 visual_prompt]: Training 25 / 100 epoch, with learning rate 0.047073689821473176
[09/26 06:15:17 visual_prompt]: Epoch 25 / 100: avg data time: 5.79e-02, avg batch time: 0.5024, average train loss: 0.3446
[09/26 06:15:18 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1673, average loss: 0.3895
[09/26 06:15:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.20	
[09/26 06:15:18 visual_prompt]: Training 26 / 100 epoch, with learning rate 0.046650635094610975
[09/26 06:15:25 visual_prompt]: Epoch 26 / 100: avg data time: 4.24e-02, avg batch time: 0.4866, average train loss: 0.3510
[09/26 06:15:27 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1671, average loss: 0.3908
[09/26 06:15:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 94.77	
[09/26 06:15:27 visual_prompt]: Training 27 / 100 epoch, with learning rate 0.04620120240391065
[09/26 06:15:33 visual_prompt]: Epoch 27 / 100: avg data time: 5.50e-02, avg batch time: 0.4996, average train loss: 0.3624
[09/26 06:15:35 visual_prompt]: Inference (val):avg data time: 2.14e-05, avg batch time: 0.1672, average loss: 0.4368
[09/26 06:15:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 95.03	
[09/26 06:15:35 visual_prompt]: Training 28 / 100 epoch, with learning rate 0.04572593931387604
[09/26 06:15:41 visual_prompt]: Epoch 28 / 100: avg data time: 4.81e-02, avg batch time: 0.4931, average train loss: 0.3655
[09/26 06:15:43 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1668, average loss: 0.3406
[09/26 06:15:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 94.22	
[09/26 06:15:43 visual_prompt]: Training 29 / 100 epoch, with learning rate 0.04522542485937369
[09/26 06:15:50 visual_prompt]: Epoch 29 / 100: avg data time: 5.27e-02, avg batch time: 0.4977, average train loss: 0.3069
[09/26 06:15:51 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1674, average loss: 0.3410
[09/26 06:15:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.98	
[09/26 06:15:51 visual_prompt]: Training 30 / 100 epoch, with learning rate 0.04470026884016805
[09/26 06:15:58 visual_prompt]: Epoch 30 / 100: avg data time: 5.09e-02, avg batch time: 0.4946, average train loss: 0.2873
[09/26 06:15:59 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1672, average loss: 0.5090
[09/26 06:15:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 94.88	
[09/26 06:15:59 visual_prompt]: Training 31 / 100 epoch, with learning rate 0.04415111107797445
[09/26 06:16:06 visual_prompt]: Epoch 31 / 100: avg data time: 5.17e-02, avg batch time: 0.4980, average train loss: 0.3851
[09/26 06:16:07 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1677, average loss: 0.3468
[09/26 06:16:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 94.11	
[09/26 06:16:08 visual_prompt]: Training 32 / 100 epoch, with learning rate 0.04357862063693486
[09/26 06:16:14 visual_prompt]: Epoch 32 / 100: avg data time: 5.03e-02, avg batch time: 0.4941, average train loss: 0.2908
[09/26 06:16:16 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1674, average loss: 0.4987
[09/26 06:16:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 93.61	
[09/26 06:16:16 visual_prompt]: Training 33 / 100 epoch, with learning rate 0.04298349500846628
[09/26 06:16:22 visual_prompt]: Epoch 33 / 100: avg data time: 4.31e-02, avg batch time: 0.4881, average train loss: 0.3310
[09/26 06:16:24 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1677, average loss: 0.3739
[09/26 06:16:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.61	
[09/26 06:16:24 visual_prompt]: Training 34 / 100 epoch, with learning rate 0.042366459261474934
[09/26 06:16:30 visual_prompt]: Epoch 34 / 100: avg data time: 5.22e-02, avg batch time: 0.4959, average train loss: 0.3149
[09/26 06:16:32 visual_prompt]: Inference (val):avg data time: 3.64e-05, avg batch time: 0.1675, average loss: 0.3458
[09/26 06:16:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 95.14	
[09/26 06:16:32 visual_prompt]: Training 35 / 100 epoch, with learning rate 0.04172826515897146
[09/26 06:16:39 visual_prompt]: Epoch 35 / 100: avg data time: 4.64e-02, avg batch time: 0.4911, average train loss: 0.3697
[09/26 06:16:40 visual_prompt]: Inference (val):avg data time: 3.14e-05, avg batch time: 0.1677, average loss: 0.3164
[09/26 06:16:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 94.89	
[09/26 06:16:40 visual_prompt]: Best epoch 35: best metric: 0.875
[09/26 06:16:40 visual_prompt]: Training 36 / 100 epoch, with learning rate 0.04106969024216348
[09/26 06:16:47 visual_prompt]: Epoch 36 / 100: avg data time: 4.99e-02, avg batch time: 0.4939, average train loss: 0.2927
[09/26 06:16:48 visual_prompt]: Inference (val):avg data time: 3.22e-05, avg batch time: 0.1676, average loss: 0.4213
[09/26 06:16:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 94.09	
[09/26 06:16:48 visual_prompt]: Training 37 / 100 epoch, with learning rate 0.040391536883141455
[09/26 06:16:55 visual_prompt]: Epoch 37 / 100: avg data time: 5.91e-02, avg batch time: 0.5036, average train loss: 0.2121
[09/26 06:16:57 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1674, average loss: 0.8069
[09/26 06:16:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 70.00	rocauc: 89.13	
[09/26 06:16:57 visual_prompt]: Training 38 / 100 epoch, with learning rate 0.03969463130731183
[09/26 06:17:03 visual_prompt]: Epoch 38 / 100: avg data time: 5.94e-02, avg batch time: 0.5046, average train loss: 0.2917
[09/26 06:17:05 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.1672, average loss: 0.4713
[09/26 06:17:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 94.98	
[09/26 06:17:05 visual_prompt]: Training 39 / 100 epoch, with learning rate 0.03897982258676867
[09/26 06:17:12 visual_prompt]: Epoch 39 / 100: avg data time: 4.96e-02, avg batch time: 0.4952, average train loss: 0.2375
[09/26 06:17:13 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1673, average loss: 0.3438
[09/26 06:17:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.12	
[09/26 06:17:13 visual_prompt]: Training 40 / 100 epoch, with learning rate 0.03824798160583012
[09/26 06:17:20 visual_prompt]: Epoch 40 / 100: avg data time: 4.20e-02, avg batch time: 0.4897, average train loss: 0.2217
[09/26 06:17:21 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1677, average loss: 0.3491
[09/26 06:17:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.66	
[09/26 06:17:21 visual_prompt]: Training 41 / 100 epoch, with learning rate 0.037500000000000006
[09/26 06:17:28 visual_prompt]: Epoch 41 / 100: avg data time: 5.01e-02, avg batch time: 0.4964, average train loss: 0.2216
[09/26 06:17:30 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1678, average loss: 0.4954
[09/26 06:17:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.65	
[09/26 06:17:30 visual_prompt]: Training 42 / 100 epoch, with learning rate 0.03673678906964727
[09/26 06:17:36 visual_prompt]: Epoch 42 / 100: avg data time: 5.70e-02, avg batch time: 0.5006, average train loss: 0.2236
[09/26 06:17:38 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1673, average loss: 0.6411
[09/26 06:17:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 71.00	rocauc: 95.13	
[09/26 06:17:38 visual_prompt]: Training 43 / 100 epoch, with learning rate 0.03595927866972694
[09/26 06:17:45 visual_prompt]: Epoch 43 / 100: avg data time: 6.07e-02, avg batch time: 0.5046, average train loss: 0.2390
[09/26 06:17:46 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1671, average loss: 1.4813
[09/26 06:17:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.00	rocauc: 93.58	
[09/26 06:17:46 visual_prompt]: Training 44 / 100 epoch, with learning rate 0.03516841607689501
[09/26 06:17:53 visual_prompt]: Epoch 44 / 100: avg data time: 4.72e-02, avg batch time: 0.4936, average train loss: 0.5191
[09/26 06:17:54 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1676, average loss: 0.3291
[09/26 06:17:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.00	rocauc: 95.59	
[09/26 06:17:54 visual_prompt]: Best epoch 44: best metric: 0.890
[09/26 06:17:54 visual_prompt]: Training 45 / 100 epoch, with learning rate 0.0343651648353978
[09/26 06:18:01 visual_prompt]: Epoch 45 / 100: avg data time: 5.51e-02, avg batch time: 0.4988, average train loss: 0.2634
[09/26 06:18:03 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1674, average loss: 0.3451
[09/26 06:18:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.26	
[09/26 06:18:03 visual_prompt]: Training 46 / 100 epoch, with learning rate 0.033550503583141725
[09/26 06:18:09 visual_prompt]: Epoch 46 / 100: avg data time: 5.85e-02, avg batch time: 0.5038, average train loss: 0.1983
[09/26 06:18:11 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1673, average loss: 0.4966
[09/26 06:18:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 94.82	
[09/26 06:18:11 visual_prompt]: Training 47 / 100 epoch, with learning rate 0.032725424859373686
[09/26 06:18:18 visual_prompt]: Epoch 47 / 100: avg data time: 5.55e-02, avg batch time: 0.5003, average train loss: 0.1688
[09/26 06:18:19 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1674, average loss: 0.4948
[09/26 06:18:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.12	
[09/26 06:18:19 visual_prompt]: Training 48 / 100 epoch, with learning rate 0.03189093389542498
[09/26 06:18:26 visual_prompt]: Epoch 48 / 100: avg data time: 5.79e-02, avg batch time: 0.5024, average train loss: 0.2413
[09/26 06:18:28 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1672, average loss: 0.3645
[09/26 06:18:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.01	
[09/26 06:18:28 visual_prompt]: Training 49 / 100 epoch, with learning rate 0.03104804738999169
[09/26 06:18:34 visual_prompt]: Epoch 49 / 100: avg data time: 5.88e-02, avg batch time: 0.5042, average train loss: 0.1671
[09/26 06:18:36 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1672, average loss: 0.4873
[09/26 06:18:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.94	
[09/26 06:18:36 visual_prompt]: Training 50 / 100 epoch, with learning rate 0.03019779227044398
[09/26 06:18:43 visual_prompt]: Epoch 50 / 100: avg data time: 5.78e-02, avg batch time: 0.5023, average train loss: 0.1861
[09/26 06:18:44 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1672, average loss: 0.4582
[09/26 06:18:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 93.42	
[09/26 06:18:44 visual_prompt]: Training 51 / 100 epoch, with learning rate 0.029341204441673263
[09/26 06:18:51 visual_prompt]: Epoch 51 / 100: avg data time: 5.98e-02, avg batch time: 0.5048, average train loss: 0.1889
[09/26 06:18:53 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1674, average loss: 0.4363
[09/26 06:18:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 91.22	
[09/26 06:18:53 visual_prompt]: Training 52 / 100 epoch, with learning rate 0.028479327524001636
[09/26 06:18:59 visual_prompt]: Epoch 52 / 100: avg data time: 6.40e-02, avg batch time: 0.5076, average train loss: 0.2152
[09/26 06:19:01 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1673, average loss: 0.4142
[09/26 06:19:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 93.14	
[09/26 06:19:01 visual_prompt]: Training 53 / 100 epoch, with learning rate 0.02761321158169134
[09/26 06:19:08 visual_prompt]: Epoch 53 / 100: avg data time: 6.09e-02, avg batch time: 0.5046, average train loss: 0.1311
[09/26 06:19:09 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1674, average loss: 0.3073
[09/26 06:19:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 95.75	
[09/26 06:19:09 visual_prompt]: Training 54 / 100 epoch, with learning rate 0.02674391184360313
[09/26 06:19:16 visual_prompt]: Epoch 54 / 100: avg data time: 5.10e-02, avg batch time: 0.4954, average train loss: 0.1511
[09/26 06:19:18 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1674, average loss: 0.4271
[09/26 06:19:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.77	
[09/26 06:19:18 visual_prompt]: Training 55 / 100 epoch, with learning rate 0.02587248741756253
[09/26 06:19:24 visual_prompt]: Epoch 55 / 100: avg data time: 5.08e-02, avg batch time: 0.4975, average train loss: 0.0882
[09/26 06:19:26 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1675, average loss: 0.5150
[09/26 06:19:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.38	
[09/26 06:19:26 visual_prompt]: Training 56 / 100 epoch, with learning rate 0.025
[09/26 06:19:33 visual_prompt]: Epoch 56 / 100: avg data time: 5.62e-02, avg batch time: 0.5007, average train loss: 0.1232
[09/26 06:19:34 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1674, average loss: 0.4560
[09/26 06:19:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.06	
[09/26 06:19:34 visual_prompt]: Training 57 / 100 epoch, with learning rate 0.024127512582437484
[09/26 06:19:41 visual_prompt]: Epoch 57 / 100: avg data time: 6.05e-02, avg batch time: 0.5043, average train loss: 0.1802
[09/26 06:19:42 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1676, average loss: 0.5549
[09/26 06:19:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.82	
[09/26 06:19:42 visual_prompt]: Training 58 / 100 epoch, with learning rate 0.02325608815639687
[09/26 06:19:49 visual_prompt]: Epoch 58 / 100: avg data time: 5.34e-02, avg batch time: 0.4980, average train loss: 0.2012
[09/26 06:19:51 visual_prompt]: Inference (val):avg data time: 3.09e-05, avg batch time: 0.1673, average loss: 0.4666
[09/26 06:19:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 93.31	
[09/26 06:19:51 visual_prompt]: Training 59 / 100 epoch, with learning rate 0.02238678841830867
[09/26 06:19:57 visual_prompt]: Epoch 59 / 100: avg data time: 5.65e-02, avg batch time: 0.5017, average train loss: 0.1377
[09/26 06:19:59 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1676, average loss: 0.5114
[09/26 06:19:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.75	
[09/26 06:19:59 visual_prompt]: Training 60 / 100 epoch, with learning rate 0.02152067247599837
[09/26 06:20:06 visual_prompt]: Epoch 60 / 100: avg data time: 5.20e-02, avg batch time: 0.4958, average train loss: 0.0689
[09/26 06:20:07 visual_prompt]: Inference (val):avg data time: 3.27e-05, avg batch time: 0.1673, average loss: 0.9180
[09/26 06:20:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.66	
[09/26 06:20:07 visual_prompt]: Training 61 / 100 epoch, with learning rate 0.020658795558326743
[09/26 06:20:14 visual_prompt]: Epoch 61 / 100: avg data time: 5.82e-02, avg batch time: 0.5036, average train loss: 0.0563
[09/26 06:20:15 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1677, average loss: 0.6613
[09/26 06:20:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.85	
[09/26 06:20:15 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.019802207729556022
[09/26 06:20:22 visual_prompt]: Epoch 62 / 100: avg data time: 5.60e-02, avg batch time: 0.5001, average train loss: 0.0964
[09/26 06:20:24 visual_prompt]: Inference (val):avg data time: 3.84e-05, avg batch time: 0.1675, average loss: 0.5071
[09/26 06:20:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.23	
[09/26 06:20:24 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.018951952610008312
[09/26 06:20:30 visual_prompt]: Epoch 63 / 100: avg data time: 4.34e-02, avg batch time: 0.4885, average train loss: 0.1667
[09/26 06:20:32 visual_prompt]: Inference (val):avg data time: 3.10e-05, avg batch time: 0.1677, average loss: 0.6667
[09/26 06:20:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 90.47	
[09/26 06:20:32 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.018109066104575022
[09/26 06:20:39 visual_prompt]: Epoch 64 / 100: avg data time: 4.89e-02, avg batch time: 0.4944, average train loss: 0.1533
[09/26 06:20:40 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1677, average loss: 0.5079
[09/26 06:20:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.12	
[09/26 06:20:40 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.017274575140626316
[09/26 06:20:47 visual_prompt]: Epoch 65 / 100: avg data time: 5.33e-02, avg batch time: 0.4976, average train loss: 0.1052
[09/26 06:20:48 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1673, average loss: 0.7559
[09/26 06:20:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.31	
[09/26 06:20:48 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.016449496416858285
[09/26 06:20:55 visual_prompt]: Epoch 66 / 100: avg data time: 4.24e-02, avg batch time: 0.4917, average train loss: 0.0740
[09/26 06:20:57 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1672, average loss: 0.4206
[09/26 06:20:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 93.37	
[09/26 06:20:57 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.0156348351646022
[09/26 06:21:03 visual_prompt]: Epoch 67 / 100: avg data time: 5.49e-02, avg batch time: 0.4988, average train loss: 0.0548
[09/26 06:21:05 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1672, average loss: 0.4703
[09/26 06:21:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.01	
[09/26 06:21:05 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.014831583923105
[09/26 06:21:12 visual_prompt]: Epoch 68 / 100: avg data time: 5.16e-02, avg batch time: 0.4960, average train loss: 0.0376
[09/26 06:21:13 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1676, average loss: 0.6495
[09/26 06:21:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.64	
[09/26 06:21:13 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.014040721330273063
[09/26 06:21:20 visual_prompt]: Epoch 69 / 100: avg data time: 6.05e-02, avg batch time: 0.5043, average train loss: 0.0534
[09/26 06:21:21 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1672, average loss: 0.6820
[09/26 06:21:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.82	
[09/26 06:21:21 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.013263210930352737
[09/26 06:21:28 visual_prompt]: Epoch 70 / 100: avg data time: 5.83e-02, avg batch time: 0.5022, average train loss: 0.0326
[09/26 06:21:30 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1676, average loss: 0.7423
[09/26 06:21:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 91.93	
[09/26 06:21:30 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.012500000000000006
[09/26 06:21:36 visual_prompt]: Epoch 71 / 100: avg data time: 4.86e-02, avg batch time: 0.4932, average train loss: 0.0883
[09/26 06:21:38 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1674, average loss: 0.4936
[09/26 06:21:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.53	
[09/26 06:21:38 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.01175201839416988
[09/26 06:21:44 visual_prompt]: Epoch 72 / 100: avg data time: 5.23e-02, avg batch time: 0.4969, average train loss: 0.0461
[09/26 06:21:46 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1675, average loss: 0.6922
[09/26 06:21:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 94.06	
[09/26 06:21:46 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.011020177413231334
[09/26 06:21:53 visual_prompt]: Epoch 73 / 100: avg data time: 5.34e-02, avg batch time: 0.4982, average train loss: 0.0300
[09/26 06:21:54 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1677, average loss: 0.7772
[09/26 06:21:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.93	
[09/26 06:21:54 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.010305368692688175
[09/26 06:22:01 visual_prompt]: Epoch 74 / 100: avg data time: 5.47e-02, avg batch time: 0.4992, average train loss: 0.0244
[09/26 06:22:02 visual_prompt]: Inference (val):avg data time: 3.42e-05, avg batch time: 0.1674, average loss: 0.7475
[09/26 06:22:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.39	
[09/26 06:22:02 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.009608463116858543
[09/26 06:22:09 visual_prompt]: Epoch 75 / 100: avg data time: 5.58e-02, avg batch time: 0.5008, average train loss: 0.0217
[09/26 06:22:11 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1675, average loss: 0.8183
[09/26 06:22:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.98	
[09/26 06:22:11 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.008930309757836517
[09/26 06:22:17 visual_prompt]: Epoch 76 / 100: avg data time: 4.61e-02, avg batch time: 0.4902, average train loss: 0.0153
[09/26 06:22:19 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1674, average loss: 0.9686
[09/26 06:22:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 92.94	
[09/26 06:22:19 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.008271734841028553
[09/26 06:22:26 visual_prompt]: Epoch 77 / 100: avg data time: 5.49e-02, avg batch time: 0.5005, average train loss: 0.0048
[09/26 06:22:27 visual_prompt]: Inference (val):avg data time: 3.12e-05, avg batch time: 0.1677, average loss: 0.8939
[09/26 06:22:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.66	
[09/26 06:22:27 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.007633540738525066
[09/26 06:22:34 visual_prompt]: Epoch 78 / 100: avg data time: 5.70e-02, avg batch time: 0.5022, average train loss: 0.0040
[09/26 06:22:35 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1675, average loss: 0.8936
[09/26 06:22:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.34	
[09/26 06:22:35 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.0070165049915337264
[09/26 06:22:42 visual_prompt]: Epoch 79 / 100: avg data time: 4.58e-02, avg batch time: 0.4912, average train loss: 0.0047
[09/26 06:22:44 visual_prompt]: Inference (val):avg data time: 4.88e-05, avg batch time: 0.1675, average loss: 0.9691
[09/26 06:22:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.23	
[09/26 06:22:44 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.006421379363065142
[09/26 06:22:50 visual_prompt]: Epoch 80 / 100: avg data time: 4.67e-02, avg batch time: 0.4929, average train loss: 0.0010
[09/26 06:22:52 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1676, average loss: 1.0363
[09/26 06:22:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.43	
[09/26 06:22:52 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.005848888922025553
[09/26 06:22:59 visual_prompt]: Epoch 81 / 100: avg data time: 4.97e-02, avg batch time: 0.4972, average train loss: 0.0010
[09/26 06:23:00 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1675, average loss: 1.0491
[09/26 06:23:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.48	
[09/26 06:23:00 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.005299731159831953
[09/26 06:23:07 visual_prompt]: Epoch 82 / 100: avg data time: 5.56e-02, avg batch time: 0.4997, average train loss: 0.0007
[09/26 06:23:08 visual_prompt]: Inference (val):avg data time: 4.21e-05, avg batch time: 0.1678, average loss: 1.0401
[09/26 06:23:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.47	
[09/26 06:23:08 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.004774575140626317
[09/26 06:23:15 visual_prompt]: Epoch 83 / 100: avg data time: 5.48e-02, avg batch time: 0.4986, average train loss: 0.0006
[09/26 06:23:17 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1675, average loss: 1.0463
[09/26 06:23:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.46	
[09/26 06:23:17 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.004274060686123959
[09/26 06:23:23 visual_prompt]: Epoch 84 / 100: avg data time: 6.22e-02, avg batch time: 0.5078, average train loss: 0.0006
[09/26 06:23:25 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1674, average loss: 1.0512
[09/26 06:23:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.45	
[09/26 06:23:25 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.003798797596089351
[09/26 06:23:32 visual_prompt]: Epoch 85 / 100: avg data time: 4.98e-02, avg batch time: 0.4951, average train loss: 0.0006
[09/26 06:23:33 visual_prompt]: Inference (val):avg data time: 3.19e-05, avg batch time: 0.1676, average loss: 1.0536
[09/26 06:23:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.42	
[09/26 06:23:33 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.0033493649053890325
[09/26 06:23:40 visual_prompt]: Epoch 86 / 100: avg data time: 5.48e-02, avg batch time: 0.4985, average train loss: 0.0006
[09/26 06:23:41 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1673, average loss: 1.0708
[09/26 06:23:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.41	
[09/26 06:23:41 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.0029263101785268254
[09/26 06:23:48 visual_prompt]: Epoch 87 / 100: avg data time: 6.01e-02, avg batch time: 0.5040, average train loss: 0.0006
[09/26 06:23:50 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1676, average loss: 1.0846
[09/26 06:23:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.36	
[09/26 06:23:50 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.00253014884252083
[09/26 06:23:56 visual_prompt]: Epoch 88 / 100: avg data time: 5.81e-02, avg batch time: 0.5030, average train loss: 0.0006
[09/26 06:23:58 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1676, average loss: 1.0827
[09/26 06:23:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.34	
[09/26 06:23:58 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.0021613635589349755
[09/26 06:24:05 visual_prompt]: Epoch 89 / 100: avg data time: 4.64e-02, avg batch time: 0.4921, average train loss: 0.0005
[09/26 06:24:06 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.1673, average loss: 1.0816
[09/26 06:24:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.31	
[09/26 06:24:06 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.0018204036358303172
[09/26 06:24:13 visual_prompt]: Epoch 90 / 100: avg data time: 4.86e-02, avg batch time: 0.4939, average train loss: 0.0005
[09/26 06:24:14 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1673, average loss: 1.0816
[09/26 06:24:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.29	
[09/26 06:24:14 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.0015076844803522923
[09/26 06:24:21 visual_prompt]: Epoch 91 / 100: avg data time: 5.14e-02, avg batch time: 0.4961, average train loss: 0.0005
[09/26 06:24:22 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1672, average loss: 1.0819
[09/26 06:24:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.29	
[09/26 06:24:22 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.0012235870926211618
[09/26 06:24:29 visual_prompt]: Epoch 92 / 100: avg data time: 4.25e-02, avg batch time: 0.4892, average train loss: 0.0005
[09/26 06:24:31 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.1674, average loss: 1.0821
[09/26 06:24:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.27	
[09/26 06:24:31 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.0009684576015420277
[09/26 06:24:37 visual_prompt]: Epoch 93 / 100: avg data time: 5.47e-02, avg batch time: 0.4986, average train loss: 0.0005
[09/26 06:24:39 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1675, average loss: 1.0826
[09/26 06:24:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.27	
[09/26 06:24:39 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.0007426068431000883
[09/26 06:24:45 visual_prompt]: Epoch 94 / 100: avg data time: 4.22e-02, avg batch time: 0.4877, average train loss: 0.0005
[09/26 06:24:47 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1675, average loss: 1.0828
[09/26 06:24:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.26	
[09/26 06:24:47 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.0005463099816548578
[09/26 06:24:54 visual_prompt]: Epoch 95 / 100: avg data time: 5.09e-02, avg batch time: 0.4964, average train loss: 0.0006
[09/26 06:24:55 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1673, average loss: 1.0836
[09/26 06:24:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.27	
[09/26 06:24:55 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.00037980617469479954
[09/26 06:25:02 visual_prompt]: Epoch 96 / 100: avg data time: 4.49e-02, avg batch time: 0.4910, average train loss: 0.0005
[09/26 06:25:03 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1675, average loss: 1.0854
[09/26 06:25:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.27	
[09/26 06:25:03 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.00024329828146074097
[09/26 06:25:10 visual_prompt]: Epoch 97 / 100: avg data time: 6.01e-02, avg batch time: 0.5045, average train loss: 0.0005
[09/26 06:25:12 visual_prompt]: Inference (val):avg data time: 3.68e-05, avg batch time: 0.1680, average loss: 1.0857
[09/26 06:25:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.26	
[09/26 06:25:12 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.00013695261579316776
[09/26 06:25:19 visual_prompt]: Epoch 98 / 100: avg data time: 5.47e-02, avg batch time: 0.4985, average train loss: 0.0006
[09/26 06:25:20 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1675, average loss: 1.0856
[09/26 06:25:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.26	
[09/26 06:25:20 visual_prompt]: Training 99 / 100 epoch, with learning rate 6.089874350439506e-05
[09/26 06:25:27 visual_prompt]: Epoch 99 / 100: avg data time: 5.87e-02, avg batch time: 0.5031, average train loss: 0.0005
[09/26 06:25:28 visual_prompt]: Inference (val):avg data time: 3.30e-05, avg batch time: 0.1682, average loss: 1.0855
[09/26 06:25:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.26	
[09/26 06:25:28 visual_prompt]: Training 100 / 100 epoch, with learning rate 1.5229324522605948e-05
[09/26 06:25:35 visual_prompt]: Epoch 100 / 100: avg data time: 5.80e-02, avg batch time: 0.5025, average train loss: 0.0005
[09/26 06:25:37 visual_prompt]: Inference (val):avg data time: 4.18e-05, avg batch time: 0.1676, average loss: 1.0855
[09/26 06:25:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.26	
[09/26 06:25:37 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 06:25:37 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 06:25:37 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 06:25:37 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 06:25:37 visual_prompt]: Training with config:
[09/26 06:25:37 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr0.05_wd0.001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 0.05, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 06:25:37 visual_prompt]: Loading training data...
[09/26 06:25:37 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 06:25:38 visual_prompt]: Number of images: 800
[09/26 06:25:38 visual_prompt]: Number of classes: 2 / 2
[09/26 06:25:38 visual_prompt]: Loading validation data...
[09/26 06:25:38 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 06:25:38 visual_prompt]: Number of images: 200
[09/26 06:25:38 visual_prompt]: Number of classes: 2 / 2
[09/26 06:25:38 visual_prompt]: Constructing models...
[09/26 06:25:41 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 06:25:41 visual_prompt]: tuned percent:0.536
[09/26 06:25:41 visual_prompt]: Device used for model: 0
[09/26 06:25:41 visual_prompt]: Setting up Evaluator...
[09/26 06:25:41 visual_prompt]: Setting up Trainer...
[09/26 06:25:41 visual_prompt]: 	Setting up the optimizer...
[09/26 06:25:41 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 06:25:48 visual_prompt]: Epoch 1 / 100: avg data time: 5.74e-02, avg batch time: 0.5000, average train loss: 1.9562
[09/26 06:25:49 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.1669, average loss: 2.0033
[09/26 06:25:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 06:25:49 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 06:25:49 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.005000000000000001
[09/26 06:25:56 visual_prompt]: Epoch 2 / 100: avg data time: 5.31e-02, avg batch time: 0.4963, average train loss: 1.2286
[09/26 06:25:57 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1668, average loss: 0.6702
[09/26 06:25:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 61.50	rocauc: 63.65	
[09/26 06:25:57 visual_prompt]: Best epoch 2: best metric: 0.615
[09/26 06:25:57 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.010000000000000002
[09/26 06:26:04 visual_prompt]: Epoch 3 / 100: avg data time: 4.62e-02, avg batch time: 0.4910, average train loss: 0.7368
[09/26 06:26:05 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1672, average loss: 0.6146
[09/26 06:26:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 85.13	
[09/26 06:26:05 visual_prompt]: Best epoch 3: best metric: 0.785
[09/26 06:26:05 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.015
[09/26 06:26:12 visual_prompt]: Epoch 4 / 100: avg data time: 4.81e-02, avg batch time: 0.4920, average train loss: 0.6371
[09/26 06:26:13 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1674, average loss: 0.5830
[09/26 06:26:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 66.00	rocauc: 89.47	
[09/26 06:26:13 visual_prompt]: Training 5 / 100 epoch, with learning rate 0.020000000000000004
[09/26 06:26:20 visual_prompt]: Epoch 5 / 100: avg data time: 6.09e-02, avg batch time: 0.5042, average train loss: 0.5644
[09/26 06:26:22 visual_prompt]: Inference (val):avg data time: 3.01e-05, avg batch time: 0.1673, average loss: 0.4555
[09/26 06:26:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 89.61	
[09/26 06:26:22 visual_prompt]: Best epoch 5: best metric: 0.805
[09/26 06:26:22 visual_prompt]: Training 6 / 100 epoch, with learning rate 0.025
[09/26 06:26:29 visual_prompt]: Epoch 6 / 100: avg data time: 5.58e-02, avg batch time: 0.4995, average train loss: 0.6119
[09/26 06:26:30 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1673, average loss: 0.4323
[09/26 06:26:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 89.98	
[09/26 06:26:30 visual_prompt]: Best epoch 6: best metric: 0.845
[09/26 06:26:30 visual_prompt]: Training 7 / 100 epoch, with learning rate 0.03
[09/26 06:26:37 visual_prompt]: Epoch 7 / 100: avg data time: 5.77e-02, avg batch time: 0.5003, average train loss: 0.5665
[09/26 06:26:38 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1676, average loss: 0.4059
[09/26 06:26:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 89.76	
[09/26 06:26:38 visual_prompt]: Best epoch 7: best metric: 0.855
[09/26 06:26:38 visual_prompt]: Training 8 / 100 epoch, with learning rate 0.034999999999999996
[09/26 06:26:45 visual_prompt]: Epoch 8 / 100: avg data time: 5.45e-02, avg batch time: 0.4990, average train loss: 0.5626
[09/26 06:26:47 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1674, average loss: 0.5953
[09/26 06:26:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 65.50	rocauc: 89.81	
[09/26 06:26:47 visual_prompt]: Training 9 / 100 epoch, with learning rate 0.04000000000000001
[09/26 06:26:53 visual_prompt]: Epoch 9 / 100: avg data time: 5.60e-02, avg batch time: 0.4988, average train loss: 0.5783
[09/26 06:26:55 visual_prompt]: Inference (val):avg data time: 3.34e-05, avg batch time: 0.1673, average loss: 0.5127
[09/26 06:26:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.00	rocauc: 90.05	
[09/26 06:26:55 visual_prompt]: Training 10 / 100 epoch, with learning rate 0.045000000000000005
[09/26 06:27:02 visual_prompt]: Epoch 10 / 100: avg data time: 5.66e-02, avg batch time: 0.5005, average train loss: 0.5440
[09/26 06:27:03 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1673, average loss: 0.3992
[09/26 06:27:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 90.31	
[09/26 06:27:03 visual_prompt]: Training 11 / 100 epoch, with learning rate 0.05
[09/26 06:27:10 visual_prompt]: Epoch 11 / 100: avg data time: 4.20e-02, avg batch time: 0.4880, average train loss: 0.4645
[09/26 06:27:11 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1673, average loss: 0.4375
[09/26 06:27:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 89.64	
[09/26 06:27:11 visual_prompt]: Training 12 / 100 epoch, with learning rate 0.0499847706754774
[09/26 06:27:18 visual_prompt]: Epoch 12 / 100: avg data time: 5.51e-02, avg batch time: 0.4986, average train loss: 0.4508
[09/26 06:27:19 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1674, average loss: 0.4202
[09/26 06:27:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 91.21	
[09/26 06:27:19 visual_prompt]: Training 13 / 100 epoch, with learning rate 0.04993910125649561
[09/26 06:27:26 visual_prompt]: Epoch 13 / 100: avg data time: 5.07e-02, avg batch time: 0.4938, average train loss: 0.4288
[09/26 06:27:28 visual_prompt]: Inference (val):avg data time: 3.40e-05, avg batch time: 0.1672, average loss: 0.3866
[09/26 06:27:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.19	
[09/26 06:27:28 visual_prompt]: Training 14 / 100 epoch, with learning rate 0.049863047384206834
[09/26 06:27:35 visual_prompt]: Epoch 14 / 100: avg data time: 4.84e-02, avg batch time: 0.4919, average train loss: 0.4053
[09/26 06:27:36 visual_prompt]: Inference (val):avg data time: 3.01e-05, avg batch time: 0.1673, average loss: 0.3849
[09/26 06:27:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 90.65	
[09/26 06:27:36 visual_prompt]: Training 15 / 100 epoch, with learning rate 0.04975670171853926
[09/26 06:27:43 visual_prompt]: Epoch 15 / 100: avg data time: 4.89e-02, avg batch time: 0.4921, average train loss: 0.4118
[09/26 06:27:44 visual_prompt]: Inference (val):avg data time: 2.99e-05, avg batch time: 0.1675, average loss: 0.3753
[09/26 06:27:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 91.89	
[09/26 06:27:44 visual_prompt]: Training 16 / 100 epoch, with learning rate 0.049620193825305206
[09/26 06:27:51 visual_prompt]: Epoch 16 / 100: avg data time: 5.70e-02, avg batch time: 0.5002, average train loss: 0.3758
[09/26 06:27:53 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1676, average loss: 0.3623
[09/26 06:27:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.12	
[09/26 06:27:53 visual_prompt]: Training 17 / 100 epoch, with learning rate 0.049453690018345146
[09/26 06:27:59 visual_prompt]: Epoch 17 / 100: avg data time: 5.44e-02, avg batch time: 0.4994, average train loss: 0.4006
[09/26 06:28:01 visual_prompt]: Inference (val):avg data time: 3.22e-05, avg batch time: 0.1675, average loss: 0.5150
[09/26 06:28:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 69.50	rocauc: 90.91	
[09/26 06:28:01 visual_prompt]: Training 18 / 100 epoch, with learning rate 0.04925739315689991
[09/26 06:28:08 visual_prompt]: Epoch 18 / 100: avg data time: 4.43e-02, avg batch time: 0.4890, average train loss: 0.3899
[09/26 06:28:09 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1675, average loss: 0.5551
[09/26 06:28:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.50	rocauc: 90.56	
[09/26 06:28:09 visual_prompt]: Training 19 / 100 epoch, with learning rate 0.04903154239845797
[09/26 06:28:16 visual_prompt]: Epoch 19 / 100: avg data time: 5.69e-02, avg batch time: 0.5002, average train loss: 0.4020
[09/26 06:28:17 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1671, average loss: 0.3844
[09/26 06:28:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.47	
[09/26 06:28:17 visual_prompt]: Training 20 / 100 epoch, with learning rate 0.048776412907378844
[09/26 06:28:24 visual_prompt]: Epoch 20 / 100: avg data time: 4.94e-02, avg batch time: 0.4942, average train loss: 0.3507
[09/26 06:28:26 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1673, average loss: 0.3919
[09/26 06:28:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.49	
[09/26 06:28:26 visual_prompt]: Training 21 / 100 epoch, with learning rate 0.048492315519647715
[09/26 06:28:32 visual_prompt]: Epoch 21 / 100: avg data time: 5.45e-02, avg batch time: 0.4978, average train loss: 0.3307
[09/26 06:28:34 visual_prompt]: Inference (val):avg data time: 2.95e-05, avg batch time: 0.1675, average loss: 0.4511
[09/26 06:28:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.50	rocauc: 89.27	
[09/26 06:28:34 visual_prompt]: Training 22 / 100 epoch, with learning rate 0.048179596364169686
[09/26 06:28:40 visual_prompt]: Epoch 22 / 100: avg data time: 4.28e-02, avg batch time: 0.4878, average train loss: 0.3977
[09/26 06:28:42 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1675, average loss: 0.4056
[09/26 06:28:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.46	
[09/26 06:28:42 visual_prompt]: Training 23 / 100 epoch, with learning rate 0.04783863644106502
[09/26 06:28:49 visual_prompt]: Epoch 23 / 100: avg data time: 5.52e-02, avg batch time: 0.4994, average train loss: 0.3475
[09/26 06:28:50 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1672, average loss: 0.4457
[09/26 06:28:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 91.68	
[09/26 06:28:50 visual_prompt]: Training 24 / 100 epoch, with learning rate 0.047469851157479176
[09/26 06:28:57 visual_prompt]: Epoch 24 / 100: avg data time: 5.81e-02, avg batch time: 0.5023, average train loss: 0.3761
[09/26 06:28:59 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1672, average loss: 0.4331
[09/26 06:28:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 91.58	
[09/26 06:28:59 visual_prompt]: Training 25 / 100 epoch, with learning rate 0.047073689821473176
[09/26 06:29:05 visual_prompt]: Epoch 25 / 100: avg data time: 5.97e-02, avg batch time: 0.5037, average train loss: 0.3115
[09/26 06:29:07 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1672, average loss: 0.3922
[09/26 06:29:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 90.68	
[09/26 06:29:07 visual_prompt]: Training 26 / 100 epoch, with learning rate 0.046650635094610975
[09/26 06:29:14 visual_prompt]: Epoch 26 / 100: avg data time: 5.98e-02, avg batch time: 0.5032, average train loss: 0.3074
[09/26 06:29:15 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1673, average loss: 0.3998
[09/26 06:29:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.19	
[09/26 06:29:15 visual_prompt]: Training 27 / 100 epoch, with learning rate 0.04620120240391065
[09/26 06:29:22 visual_prompt]: Epoch 27 / 100: avg data time: 5.80e-02, avg batch time: 0.5030, average train loss: 0.2760
[09/26 06:29:24 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1673, average loss: 0.4563
[09/26 06:29:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.00	rocauc: 90.72	
[09/26 06:29:24 visual_prompt]: Training 28 / 100 epoch, with learning rate 0.04572593931387604
[09/26 06:29:30 visual_prompt]: Epoch 28 / 100: avg data time: 4.98e-02, avg batch time: 0.4951, average train loss: 0.2737
[09/26 06:29:32 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1673, average loss: 0.4207
[09/26 06:29:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.91	
[09/26 06:29:32 visual_prompt]: Training 29 / 100 epoch, with learning rate 0.04522542485937369
[09/26 06:29:38 visual_prompt]: Epoch 29 / 100: avg data time: 4.22e-02, avg batch time: 0.4859, average train loss: 0.2435
[09/26 06:29:40 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1673, average loss: 0.3827
[09/26 06:29:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.13	
[09/26 06:29:40 visual_prompt]: Training 30 / 100 epoch, with learning rate 0.04470026884016805
[09/26 06:29:47 visual_prompt]: Epoch 30 / 100: avg data time: 5.23e-02, avg batch time: 0.4979, average train loss: 0.2898
[09/26 06:29:48 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1675, average loss: 0.4562
[09/26 06:29:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.13	
[09/26 06:29:48 visual_prompt]: Training 31 / 100 epoch, with learning rate 0.04415111107797445
[09/26 06:29:55 visual_prompt]: Epoch 31 / 100: avg data time: 4.15e-02, avg batch time: 0.4868, average train loss: 0.3161
[09/26 06:29:56 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1673, average loss: 0.3234
[09/26 06:29:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.90	
[09/26 06:29:56 visual_prompt]: Best epoch 31: best metric: 0.860
[09/26 06:29:56 visual_prompt]: Training 32 / 100 epoch, with learning rate 0.04357862063693486
[09/26 06:30:03 visual_prompt]: Epoch 32 / 100: avg data time: 4.23e-02, avg batch time: 0.4886, average train loss: 0.2836
[09/26 06:30:04 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1676, average loss: 0.3964
[09/26 06:30:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.63	
[09/26 06:30:04 visual_prompt]: Training 33 / 100 epoch, with learning rate 0.04298349500846628
[09/26 06:30:11 visual_prompt]: Epoch 33 / 100: avg data time: 6.28e-02, avg batch time: 0.5070, average train loss: 0.2592
[09/26 06:30:13 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1671, average loss: 0.4377
[09/26 06:30:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 93.84	
[09/26 06:30:13 visual_prompt]: Training 34 / 100 epoch, with learning rate 0.042366459261474934
[09/26 06:30:19 visual_prompt]: Epoch 34 / 100: avg data time: 4.18e-02, avg batch time: 0.4857, average train loss: 0.2681
[09/26 06:30:21 visual_prompt]: Inference (val):avg data time: 5.25e-05, avg batch time: 0.1675, average loss: 0.3499
[09/26 06:30:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.76	
[09/26 06:30:21 visual_prompt]: Best epoch 34: best metric: 0.870
[09/26 06:30:21 visual_prompt]: Training 35 / 100 epoch, with learning rate 0.04172826515897146
[09/26 06:30:27 visual_prompt]: Epoch 35 / 100: avg data time: 4.46e-02, avg batch time: 0.4893, average train loss: 0.2410
[09/26 06:30:29 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1671, average loss: 0.5228
[09/26 06:30:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 93.28	
[09/26 06:30:29 visual_prompt]: Training 36 / 100 epoch, with learning rate 0.04106969024216348
[09/26 06:30:36 visual_prompt]: Epoch 36 / 100: avg data time: 4.70e-02, avg batch time: 0.4945, average train loss: 0.2337
[09/26 06:30:37 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1674, average loss: 0.3626
[09/26 06:30:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 92.79	
[09/26 06:30:37 visual_prompt]: Training 37 / 100 epoch, with learning rate 0.040391536883141455
[09/26 06:30:44 visual_prompt]: Epoch 37 / 100: avg data time: 5.54e-02, avg batch time: 0.4990, average train loss: 0.2135
[09/26 06:30:45 visual_prompt]: Inference (val):avg data time: 3.03e-05, avg batch time: 0.1672, average loss: 0.4088
[09/26 06:30:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.62	
[09/26 06:30:45 visual_prompt]: Training 38 / 100 epoch, with learning rate 0.03969463130731183
[09/26 06:30:52 visual_prompt]: Epoch 38 / 100: avg data time: 4.70e-02, avg batch time: 0.4913, average train loss: 0.1938
[09/26 06:30:53 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1675, average loss: 0.3462
[09/26 06:30:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.91	
[09/26 06:30:53 visual_prompt]: Training 39 / 100 epoch, with learning rate 0.03897982258676867
[09/26 06:31:00 visual_prompt]: Epoch 39 / 100: avg data time: 5.44e-02, avg batch time: 0.4989, average train loss: 0.1872
[09/26 06:31:02 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1673, average loss: 0.4573
[09/26 06:31:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 93.72	
[09/26 06:31:02 visual_prompt]: Training 40 / 100 epoch, with learning rate 0.03824798160583012
[09/26 06:31:08 visual_prompt]: Epoch 40 / 100: avg data time: 4.99e-02, avg batch time: 0.4937, average train loss: 0.1526
[09/26 06:31:10 visual_prompt]: Inference (val):avg data time: 3.36e-05, avg batch time: 0.1679, average loss: 0.4322
[09/26 06:31:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.83	
[09/26 06:31:10 visual_prompt]: Training 41 / 100 epoch, with learning rate 0.037500000000000006
[09/26 06:31:17 visual_prompt]: Epoch 41 / 100: avg data time: 5.90e-02, avg batch time: 0.5026, average train loss: 0.2086
[09/26 06:31:18 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1676, average loss: 0.7722
[09/26 06:31:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.88	
[09/26 06:31:18 visual_prompt]: Training 42 / 100 epoch, with learning rate 0.03673678906964727
[09/26 06:31:25 visual_prompt]: Epoch 42 / 100: avg data time: 4.74e-02, avg batch time: 0.4923, average train loss: 0.2906
[09/26 06:31:26 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1676, average loss: 0.3165
[09/26 06:31:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.50	rocauc: 94.19	
[09/26 06:31:26 visual_prompt]: Best epoch 42: best metric: 0.875
[09/26 06:31:26 visual_prompt]: Training 43 / 100 epoch, with learning rate 0.03595927866972694
[09/26 06:31:33 visual_prompt]: Epoch 43 / 100: avg data time: 4.27e-02, avg batch time: 0.4878, average train loss: 0.2160
[09/26 06:31:34 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1678, average loss: 0.3150
[09/26 06:31:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.90	
[09/26 06:31:34 visual_prompt]: Training 44 / 100 epoch, with learning rate 0.03516841607689501
[09/26 06:31:41 visual_prompt]: Epoch 44 / 100: avg data time: 4.54e-02, avg batch time: 0.4892, average train loss: 0.2026
[09/26 06:31:43 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1676, average loss: 0.3213
[09/26 06:31:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.61	
[09/26 06:31:43 visual_prompt]: Training 45 / 100 epoch, with learning rate 0.0343651648353978
[09/26 06:31:49 visual_prompt]: Epoch 45 / 100: avg data time: 5.56e-02, avg batch time: 0.5004, average train loss: 0.1816
[09/26 06:31:51 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1673, average loss: 0.3797
[09/26 06:31:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 94.77	
[09/26 06:31:51 visual_prompt]: Training 46 / 100 epoch, with learning rate 0.033550503583141725
[09/26 06:31:58 visual_prompt]: Epoch 46 / 100: avg data time: 4.42e-02, avg batch time: 0.4891, average train loss: 0.1454
[09/26 06:31:59 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1672, average loss: 0.3416
[09/26 06:31:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 89.00	rocauc: 95.12	
[09/26 06:31:59 visual_prompt]: Best epoch 46: best metric: 0.890
[09/26 06:31:59 visual_prompt]: Training 47 / 100 epoch, with learning rate 0.032725424859373686
[09/26 06:32:06 visual_prompt]: Epoch 47 / 100: avg data time: 4.61e-02, avg batch time: 0.4937, average train loss: 0.1247
[09/26 06:32:07 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1676, average loss: 0.4137
[09/26 06:32:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.65	
[09/26 06:32:07 visual_prompt]: Training 48 / 100 epoch, with learning rate 0.03189093389542498
[09/26 06:32:14 visual_prompt]: Epoch 48 / 100: avg data time: 4.44e-02, avg batch time: 0.4897, average train loss: 0.1255
[09/26 06:32:15 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1671, average loss: 0.4538
[09/26 06:32:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 94.14	
[09/26 06:32:15 visual_prompt]: Training 49 / 100 epoch, with learning rate 0.03104804738999169
[09/26 06:32:22 visual_prompt]: Epoch 49 / 100: avg data time: 4.76e-02, avg batch time: 0.4919, average train loss: 0.1297
[09/26 06:32:23 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1674, average loss: 0.4901
[09/26 06:32:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.87	
[09/26 06:32:23 visual_prompt]: Training 50 / 100 epoch, with learning rate 0.03019779227044398
[09/26 06:32:30 visual_prompt]: Epoch 50 / 100: avg data time: 5.52e-02, avg batch time: 0.5005, average train loss: 0.0983
[09/26 06:32:32 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.1675, average loss: 0.4209
[09/26 06:32:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 94.36	
[09/26 06:32:32 visual_prompt]: Training 51 / 100 epoch, with learning rate 0.029341204441673263
[09/26 06:32:38 visual_prompt]: Epoch 51 / 100: avg data time: 5.53e-02, avg batch time: 0.4991, average train loss: 0.1163
[09/26 06:32:40 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1675, average loss: 0.4417
[09/26 06:32:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.54	
[09/26 06:32:40 visual_prompt]: Training 52 / 100 epoch, with learning rate 0.028479327524001636
[09/26 06:32:46 visual_prompt]: Epoch 52 / 100: avg data time: 4.18e-02, avg batch time: 0.4877, average train loss: 0.0952
[09/26 06:32:48 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1674, average loss: 0.4408
[09/26 06:32:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.07	
[09/26 06:32:48 visual_prompt]: Training 53 / 100 epoch, with learning rate 0.02761321158169134
[09/26 06:32:55 visual_prompt]: Epoch 53 / 100: avg data time: 6.11e-02, avg batch time: 0.5049, average train loss: 0.0819
[09/26 06:32:56 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1673, average loss: 0.4661
[09/26 06:32:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 94.35	
[09/26 06:32:56 visual_prompt]: Training 54 / 100 epoch, with learning rate 0.02674391184360313
[09/26 06:33:03 visual_prompt]: Epoch 54 / 100: avg data time: 5.25e-02, avg batch time: 0.4964, average train loss: 0.0972
[09/26 06:33:04 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1672, average loss: 0.4216
[09/26 06:33:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.68	
[09/26 06:33:04 visual_prompt]: Training 55 / 100 epoch, with learning rate 0.02587248741756253
[09/26 06:33:11 visual_prompt]: Epoch 55 / 100: avg data time: 5.31e-02, avg batch time: 0.4969, average train loss: 0.0613
[09/26 06:33:13 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.1674, average loss: 0.5324
[09/26 06:33:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.67	
[09/26 06:33:13 visual_prompt]: Training 56 / 100 epoch, with learning rate 0.025
[09/26 06:33:20 visual_prompt]: Epoch 56 / 100: avg data time: 5.69e-02, avg batch time: 0.5009, average train loss: 0.0853
[09/26 06:33:21 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1673, average loss: 0.5269
[09/26 06:33:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 92.48	
[09/26 06:33:21 visual_prompt]: Training 57 / 100 epoch, with learning rate 0.024127512582437484
[09/26 06:33:28 visual_prompt]: Epoch 57 / 100: avg data time: 5.50e-02, avg batch time: 0.4988, average train loss: 0.0863
[09/26 06:33:29 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1673, average loss: 0.4294
[09/26 06:33:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.55	
[09/26 06:33:29 visual_prompt]: Training 58 / 100 epoch, with learning rate 0.02325608815639687
[09/26 06:33:36 visual_prompt]: Epoch 58 / 100: avg data time: 5.73e-02, avg batch time: 0.5011, average train loss: 0.0924
[09/26 06:33:38 visual_prompt]: Inference (val):avg data time: 3.03e-05, avg batch time: 0.1675, average loss: 0.5346
[09/26 06:33:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.91	
[09/26 06:33:38 visual_prompt]: Training 59 / 100 epoch, with learning rate 0.02238678841830867
[09/26 06:33:44 visual_prompt]: Epoch 59 / 100: avg data time: 5.11e-02, avg batch time: 0.4956, average train loss: 0.0912
[09/26 06:33:46 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1678, average loss: 0.5123
[09/26 06:33:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.60	
[09/26 06:33:46 visual_prompt]: Training 60 / 100 epoch, with learning rate 0.02152067247599837
[09/26 06:33:53 visual_prompt]: Epoch 60 / 100: avg data time: 5.42e-02, avg batch time: 0.4986, average train loss: 0.0547
[09/26 06:33:54 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1675, average loss: 0.5382
[09/26 06:33:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 93.16	
[09/26 06:33:54 visual_prompt]: Training 61 / 100 epoch, with learning rate 0.020658795558326743
[09/26 06:34:01 visual_prompt]: Epoch 61 / 100: avg data time: 5.52e-02, avg batch time: 0.5004, average train loss: 0.0590
[09/26 06:34:02 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1675, average loss: 0.4607
[09/26 06:34:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.25	
[09/26 06:34:02 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.019802207729556022
[09/26 06:34:09 visual_prompt]: Epoch 62 / 100: avg data time: 5.53e-02, avg batch time: 0.4986, average train loss: 0.0445
[09/26 06:34:11 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1673, average loss: 0.5735
[09/26 06:34:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.04	
[09/26 06:34:11 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.018951952610008312
[09/26 06:34:17 visual_prompt]: Epoch 63 / 100: avg data time: 4.34e-02, avg batch time: 0.4882, average train loss: 0.0598
[09/26 06:34:19 visual_prompt]: Inference (val):avg data time: 3.47e-05, avg batch time: 0.1676, average loss: 0.6349
[09/26 06:34:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.65	
[09/26 06:34:19 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.018109066104575022
[09/26 06:34:26 visual_prompt]: Epoch 64 / 100: avg data time: 6.19e-02, avg batch time: 0.5063, average train loss: 0.0489
[09/26 06:34:27 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1676, average loss: 0.5062
[09/26 06:34:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.55	
[09/26 06:34:27 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.017274575140626316
[09/26 06:34:34 visual_prompt]: Epoch 65 / 100: avg data time: 5.91e-02, avg batch time: 0.5034, average train loss: 0.0315
[09/26 06:34:35 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1674, average loss: 0.5190
[09/26 06:34:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.95	
[09/26 06:34:35 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.016449496416858285
[09/26 06:34:42 visual_prompt]: Epoch 66 / 100: avg data time: 5.42e-02, avg batch time: 0.4986, average train loss: 0.0213
[09/26 06:34:44 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1674, average loss: 0.5226
[09/26 06:34:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.91	
[09/26 06:34:44 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.0156348351646022
[09/26 06:34:50 visual_prompt]: Epoch 67 / 100: avg data time: 5.85e-02, avg batch time: 0.5031, average train loss: 0.0487
[09/26 06:34:52 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1677, average loss: 0.6071
[09/26 06:34:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.46	
[09/26 06:34:52 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.014831583923105
[09/26 06:34:58 visual_prompt]: Epoch 68 / 100: avg data time: 4.42e-02, avg batch time: 0.4898, average train loss: 0.0464
[09/26 06:35:00 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1677, average loss: 0.6107
[09/26 06:35:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.46	
[09/26 06:35:00 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.014040721330273063
[09/26 06:35:07 visual_prompt]: Epoch 69 / 100: avg data time: 5.76e-02, avg batch time: 0.5014, average train loss: 0.0586
[09/26 06:35:08 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1673, average loss: 0.5825
[09/26 06:35:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 94.15	
[09/26 06:35:08 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.013263210930352737
[09/26 06:35:15 visual_prompt]: Epoch 70 / 100: avg data time: 4.55e-02, avg batch time: 0.4898, average train loss: 0.0557
[09/26 06:35:16 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1674, average loss: 0.5989
[09/26 06:35:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.86	
[09/26 06:35:16 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.012500000000000006
[09/26 06:35:23 visual_prompt]: Epoch 71 / 100: avg data time: 5.22e-02, avg batch time: 0.4959, average train loss: 0.0171
[09/26 06:35:24 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1672, average loss: 0.6059
[09/26 06:35:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.70	
[09/26 06:35:24 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.01175201839416988
[09/26 06:35:31 visual_prompt]: Epoch 72 / 100: avg data time: 5.10e-02, avg batch time: 0.4966, average train loss: 0.0217
[09/26 06:35:32 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1674, average loss: 0.5678
[09/26 06:35:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.36	
[09/26 06:35:32 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.011020177413231334
[09/26 06:35:39 visual_prompt]: Epoch 73 / 100: avg data time: 4.97e-02, avg batch time: 0.4937, average train loss: 0.0108
[09/26 06:35:41 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1673, average loss: 0.5858
[09/26 06:35:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.33	
[09/26 06:35:41 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.010305368692688175
[09/26 06:35:47 visual_prompt]: Epoch 74 / 100: avg data time: 5.52e-02, avg batch time: 0.5006, average train loss: 0.0117
[09/26 06:35:49 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1678, average loss: 0.5846
[09/26 06:35:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.29	
[09/26 06:35:49 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.009608463116858543
[09/26 06:35:55 visual_prompt]: Epoch 75 / 100: avg data time: 4.21e-02, avg batch time: 0.4909, average train loss: 0.0085
[09/26 06:35:57 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1674, average loss: 0.6167
[09/26 06:35:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.16	
[09/26 06:35:57 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.008930309757836517
[09/26 06:36:04 visual_prompt]: Epoch 76 / 100: avg data time: 4.80e-02, avg batch time: 0.4930, average train loss: 0.0095
[09/26 06:36:05 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1679, average loss: 0.5883
[09/26 06:36:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 87.00	rocauc: 93.62	
[09/26 06:36:05 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.008271734841028553
[09/26 06:36:12 visual_prompt]: Epoch 77 / 100: avg data time: 4.58e-02, avg batch time: 0.4934, average train loss: 0.0074
[09/26 06:36:13 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1675, average loss: 0.6342
[09/26 06:36:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.21	
[09/26 06:36:13 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.007633540738525066
[09/26 06:36:20 visual_prompt]: Epoch 78 / 100: avg data time: 4.40e-02, avg batch time: 0.4898, average train loss: 0.0058
[09/26 06:36:22 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1673, average loss: 0.6269
[09/26 06:36:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.18	
[09/26 06:36:22 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.0070165049915337264
[09/26 06:36:28 visual_prompt]: Epoch 79 / 100: avg data time: 4.42e-02, avg batch time: 0.4885, average train loss: 0.0047
[09/26 06:36:30 visual_prompt]: Inference (val):avg data time: 3.17e-05, avg batch time: 0.1677, average loss: 0.6417
[09/26 06:36:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.14	
[09/26 06:36:30 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.006421379363065142
[09/26 06:36:36 visual_prompt]: Epoch 80 / 100: avg data time: 4.77e-02, avg batch time: 0.4917, average train loss: 0.0055
[09/26 06:36:38 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1673, average loss: 0.6349
[09/26 06:36:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.18	
[09/26 06:36:38 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.005848888922025553
[09/26 06:36:44 visual_prompt]: Epoch 81 / 100: avg data time: 4.10e-02, avg batch time: 0.4866, average train loss: 0.0057
[09/26 06:36:46 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1676, average loss: 0.6539
[09/26 06:36:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.08	
[09/26 06:36:46 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.005299731159831953
[09/26 06:36:53 visual_prompt]: Epoch 82 / 100: avg data time: 5.69e-02, avg batch time: 0.5012, average train loss: 0.0044
[09/26 06:36:54 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1679, average loss: 0.6573
[09/26 06:36:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.07	
[09/26 06:36:54 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.004774575140626317
[09/26 06:37:01 visual_prompt]: Epoch 83 / 100: avg data time: 4.37e-02, avg batch time: 0.4889, average train loss: 0.0043
[09/26 06:37:02 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1677, average loss: 0.6553
[09/26 06:37:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.11	
[09/26 06:37:02 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.004274060686123959
[09/26 06:37:09 visual_prompt]: Epoch 84 / 100: avg data time: 5.55e-02, avg batch time: 0.4992, average train loss: 0.0046
[09/26 06:37:10 visual_prompt]: Inference (val):avg data time: 3.03e-05, avg batch time: 0.1674, average loss: 0.6553
[09/26 06:37:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.07	
[09/26 06:37:10 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.003798797596089351
[09/26 06:37:17 visual_prompt]: Epoch 85 / 100: avg data time: 5.65e-02, avg batch time: 0.5013, average train loss: 0.0044
[09/26 06:37:19 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1675, average loss: 0.6579
[09/26 06:37:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.07	
[09/26 06:37:19 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.0033493649053890325
[09/26 06:37:25 visual_prompt]: Epoch 86 / 100: avg data time: 4.85e-02, avg batch time: 0.4932, average train loss: 0.0044
[09/26 06:37:27 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1676, average loss: 0.6639
[09/26 06:37:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.04	
[09/26 06:37:27 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.0029263101785268254
[09/26 06:37:33 visual_prompt]: Epoch 87 / 100: avg data time: 4.75e-02, avg batch time: 0.4932, average train loss: 0.0038
[09/26 06:37:35 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1674, average loss: 0.6690
[09/26 06:37:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.93	
[09/26 06:37:35 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.00253014884252083
[09/26 06:37:42 visual_prompt]: Epoch 88 / 100: avg data time: 4.45e-02, avg batch time: 0.4907, average train loss: 0.0041
[09/26 06:37:43 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1674, average loss: 0.6662
[09/26 06:37:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.98	
[09/26 06:37:43 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.0021613635589349755
[09/26 06:37:50 visual_prompt]: Epoch 89 / 100: avg data time: 5.31e-02, avg batch time: 0.4988, average train loss: 0.0044
[09/26 06:37:51 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1675, average loss: 0.6644
[09/26 06:37:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.02	
[09/26 06:37:51 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.0018204036358303172
[09/26 06:37:58 visual_prompt]: Epoch 90 / 100: avg data time: 4.16e-02, avg batch time: 0.4867, average train loss: 0.0042
[09/26 06:37:59 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.1675, average loss: 0.6649
[09/26 06:37:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.05	
[09/26 06:37:59 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.0015076844803522923
[09/26 06:38:06 visual_prompt]: Epoch 91 / 100: avg data time: 4.38e-02, avg batch time: 0.4905, average train loss: 0.0038
[09/26 06:38:08 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1675, average loss: 0.6655
[09/26 06:38:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.03	
[09/26 06:38:08 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.0012235870926211618
[09/26 06:38:14 visual_prompt]: Epoch 92 / 100: avg data time: 5.22e-02, avg batch time: 0.4969, average train loss: 0.0053
[09/26 06:38:16 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1673, average loss: 0.6683
[09/26 06:38:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.02	
[09/26 06:38:16 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.0009684576015420277
[09/26 06:38:22 visual_prompt]: Epoch 93 / 100: avg data time: 5.00e-02, avg batch time: 0.4954, average train loss: 0.0040
[09/26 06:38:24 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1676, average loss: 0.6691
[09/26 06:38:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.03	
[09/26 06:38:24 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.0007426068431000883
[09/26 06:38:31 visual_prompt]: Epoch 94 / 100: avg data time: 4.59e-02, avg batch time: 0.4934, average train loss: 0.0036
[09/26 06:38:32 visual_prompt]: Inference (val):avg data time: 4.02e-05, avg batch time: 0.1675, average loss: 0.6693
[09/26 06:38:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.02	
[09/26 06:38:32 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.0005463099816548578
[09/26 06:38:39 visual_prompt]: Epoch 95 / 100: avg data time: 5.56e-02, avg batch time: 0.4997, average train loss: 0.0035
[09/26 06:38:40 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1674, average loss: 0.6695
[09/26 06:38:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.02	
[09/26 06:38:40 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.00037980617469479954
[09/26 06:38:47 visual_prompt]: Epoch 96 / 100: avg data time: 4.47e-02, avg batch time: 0.4892, average train loss: 0.0038
[09/26 06:38:49 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1675, average loss: 0.6708
[09/26 06:38:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.01	
[09/26 06:38:49 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.00024329828146074097
[09/26 06:38:55 visual_prompt]: Epoch 97 / 100: avg data time: 4.01e-02, avg batch time: 0.4857, average train loss: 0.0035
[09/26 06:38:57 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1678, average loss: 0.6713
[09/26 06:38:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.01	
[09/26 06:38:57 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.00013695261579316776
[09/26 06:39:03 visual_prompt]: Epoch 98 / 100: avg data time: 5.72e-02, avg batch time: 0.5015, average train loss: 0.0033
[09/26 06:39:05 visual_prompt]: Inference (val):avg data time: 2.96e-05, avg batch time: 0.1675, average loss: 0.6713
[09/26 06:39:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.02	
[09/26 06:39:05 visual_prompt]: Training 99 / 100 epoch, with learning rate 6.089874350439506e-05
[09/26 06:39:12 visual_prompt]: Epoch 99 / 100: avg data time: 5.77e-02, avg batch time: 0.5031, average train loss: 0.0036
[09/26 06:39:13 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1674, average loss: 0.6713
[09/26 06:39:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.02	
[09/26 06:39:13 visual_prompt]: Training 100 / 100 epoch, with learning rate 1.5229324522605948e-05
[09/26 06:39:20 visual_prompt]: Epoch 100 / 100: avg data time: 4.21e-02, avg batch time: 0.4896, average train loss: 0.0038
[09/26 06:39:21 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1673, average loss: 0.6713
[09/26 06:39:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.02	
[09/26 06:39:22 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 06:39:22 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 06:39:22 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 06:39:22 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 06:39:22 visual_prompt]: Training with config:
[09/26 06:39:22 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr0.05_wd0.0001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 0.05, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 06:39:22 visual_prompt]: Loading training data...
[09/26 06:39:22 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 06:39:23 visual_prompt]: Number of images: 800
[09/26 06:39:23 visual_prompt]: Number of classes: 2 / 2
[09/26 06:39:23 visual_prompt]: Loading validation data...
[09/26 06:39:23 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 06:39:23 visual_prompt]: Number of images: 200
[09/26 06:39:23 visual_prompt]: Number of classes: 2 / 2
[09/26 06:39:23 visual_prompt]: Constructing models...
[09/26 06:39:25 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 06:39:25 visual_prompt]: tuned percent:0.536
[09/26 06:39:26 visual_prompt]: Device used for model: 0
[09/26 06:39:26 visual_prompt]: Setting up Evaluator...
[09/26 06:39:26 visual_prompt]: Setting up Trainer...
[09/26 06:39:26 visual_prompt]: 	Setting up the optimizer...
[09/26 06:39:26 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 06:39:32 visual_prompt]: Epoch 1 / 100: avg data time: 5.64e-02, avg batch time: 0.5002, average train loss: 1.9538
[09/26 06:39:34 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1668, average loss: 2.0033
[09/26 06:39:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 06:39:34 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 06:39:34 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.005000000000000001
[09/26 06:39:40 visual_prompt]: Epoch 2 / 100: avg data time: 4.94e-02, avg batch time: 0.4932, average train loss: 1.3657
[09/26 06:39:42 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1669, average loss: 0.7942
[09/26 06:39:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 48.00	rocauc: 73.11	
[09/26 06:39:42 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.010000000000000002
[09/26 06:39:49 visual_prompt]: Epoch 3 / 100: avg data time: 4.40e-02, avg batch time: 0.4886, average train loss: 0.7107
[09/26 06:39:50 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1670, average loss: 0.6227
[09/26 06:39:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 83.95	
[09/26 06:39:50 visual_prompt]: Best epoch 3: best metric: 0.760
[09/26 06:39:50 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.015
[09/26 06:39:57 visual_prompt]: Epoch 4 / 100: avg data time: 5.65e-02, avg batch time: 0.4992, average train loss: 0.6417
[09/26 06:39:58 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1671, average loss: 0.5185
[09/26 06:39:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 89.47	
[09/26 06:39:58 visual_prompt]: Best epoch 4: best metric: 0.835
[09/26 06:39:58 visual_prompt]: Training 5 / 100 epoch, with learning rate 0.020000000000000004
[09/26 06:40:05 visual_prompt]: Epoch 5 / 100: avg data time: 4.85e-02, avg batch time: 0.4916, average train loss: 0.6328
[09/26 06:40:06 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1672, average loss: 0.5349
[09/26 06:40:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 68.50	rocauc: 90.21	
[09/26 06:40:06 visual_prompt]: Training 6 / 100 epoch, with learning rate 0.025
[09/26 06:40:13 visual_prompt]: Epoch 6 / 100: avg data time: 4.51e-02, avg batch time: 0.4904, average train loss: 0.5361
[09/26 06:40:15 visual_prompt]: Inference (val):avg data time: 2.79e-05, avg batch time: 0.1671, average loss: 0.4727
[09/26 06:40:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.50	rocauc: 90.26	
[09/26 06:40:15 visual_prompt]: Training 7 / 100 epoch, with learning rate 0.03
[09/26 06:40:21 visual_prompt]: Epoch 7 / 100: avg data time: 4.64e-02, avg batch time: 0.4899, average train loss: 0.5567
[09/26 06:40:23 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.1674, average loss: 0.4484
[09/26 06:40:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 90.34	
[09/26 06:40:23 visual_prompt]: Training 8 / 100 epoch, with learning rate 0.034999999999999996
[09/26 06:40:29 visual_prompt]: Epoch 8 / 100: avg data time: 4.69e-02, avg batch time: 0.4912, average train loss: 0.4981
[09/26 06:40:31 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1675, average loss: 0.4122
[09/26 06:40:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 90.94	
[09/26 06:40:31 visual_prompt]: Training 9 / 100 epoch, with learning rate 0.04000000000000001
[09/26 06:40:38 visual_prompt]: Epoch 9 / 100: avg data time: 5.41e-02, avg batch time: 0.4989, average train loss: 0.4896
[09/26 06:40:39 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1673, average loss: 0.4930
[09/26 06:40:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.00	rocauc: 91.03	
[09/26 06:40:39 visual_prompt]: Training 10 / 100 epoch, with learning rate 0.045000000000000005
[09/26 06:40:46 visual_prompt]: Epoch 10 / 100: avg data time: 4.51e-02, avg batch time: 0.4884, average train loss: 0.5182
[09/26 06:40:47 visual_prompt]: Inference (val):avg data time: 5.11e-05, avg batch time: 0.1672, average loss: 0.4031
[09/26 06:40:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 90.73	
[09/26 06:40:47 visual_prompt]: Training 11 / 100 epoch, with learning rate 0.05
[09/26 06:40:54 visual_prompt]: Epoch 11 / 100: avg data time: 5.27e-02, avg batch time: 0.4961, average train loss: 0.4548
[09/26 06:40:56 visual_prompt]: Inference (val):avg data time: 4.67e-05, avg batch time: 0.1677, average loss: 0.3809
[09/26 06:40:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.25	
[09/26 06:40:56 visual_prompt]: Training 12 / 100 epoch, with learning rate 0.0499847706754774
[09/26 06:41:02 visual_prompt]: Epoch 12 / 100: avg data time: 4.30e-02, avg batch time: 0.4874, average train loss: 0.4457
[09/26 06:41:04 visual_prompt]: Inference (val):avg data time: 3.67e-05, avg batch time: 0.1673, average loss: 0.3658
[09/26 06:41:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.79	
[09/26 06:41:04 visual_prompt]: Best epoch 12: best metric: 0.840
[09/26 06:41:04 visual_prompt]: Training 13 / 100 epoch, with learning rate 0.04993910125649561
[09/26 06:41:11 visual_prompt]: Epoch 13 / 100: avg data time: 5.60e-02, avg batch time: 0.5014, average train loss: 0.4211
[09/26 06:41:12 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1675, average loss: 0.5047
[09/26 06:41:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.00	rocauc: 91.12	
[09/26 06:41:12 visual_prompt]: Training 14 / 100 epoch, with learning rate 0.049863047384206834
[09/26 06:41:19 visual_prompt]: Epoch 14 / 100: avg data time: 4.80e-02, avg batch time: 0.4932, average train loss: 0.4820
[09/26 06:41:20 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1670, average loss: 0.4082
[09/26 06:41:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 91.91	
[09/26 06:41:20 visual_prompt]: Training 15 / 100 epoch, with learning rate 0.04975670171853926
[09/26 06:41:27 visual_prompt]: Epoch 15 / 100: avg data time: 4.48e-02, avg batch time: 0.4906, average train loss: 0.4480
[09/26 06:41:28 visual_prompt]: Inference (val):avg data time: 3.20e-05, avg batch time: 0.1676, average loss: 0.4174
[09/26 06:41:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 91.39	
[09/26 06:41:28 visual_prompt]: Training 16 / 100 epoch, with learning rate 0.049620193825305206
[09/26 06:41:35 visual_prompt]: Epoch 16 / 100: avg data time: 5.40e-02, avg batch time: 0.4989, average train loss: 0.4002
[09/26 06:41:37 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1676, average loss: 0.3733
[09/26 06:41:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.29	
[09/26 06:41:37 visual_prompt]: Training 17 / 100 epoch, with learning rate 0.049453690018345146
[09/26 06:41:43 visual_prompt]: Epoch 17 / 100: avg data time: 4.38e-02, avg batch time: 0.4886, average train loss: 0.3836
[09/26 06:41:45 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1674, average loss: 0.3919
[09/26 06:41:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.30	
[09/26 06:41:45 visual_prompt]: Training 18 / 100 epoch, with learning rate 0.04925739315689991
[09/26 06:41:52 visual_prompt]: Epoch 18 / 100: avg data time: 5.12e-02, avg batch time: 0.4952, average train loss: 0.3615
[09/26 06:41:53 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1670, average loss: 0.4213
[09/26 06:41:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.06	
[09/26 06:41:53 visual_prompt]: Training 19 / 100 epoch, with learning rate 0.04903154239845797
[09/26 06:42:00 visual_prompt]: Epoch 19 / 100: avg data time: 5.82e-02, avg batch time: 0.5021, average train loss: 0.3665
[09/26 06:42:01 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1673, average loss: 0.3910
[09/26 06:42:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 90.61	
[09/26 06:42:01 visual_prompt]: Training 20 / 100 epoch, with learning rate 0.048776412907378844
[09/26 06:42:08 visual_prompt]: Epoch 20 / 100: avg data time: 5.93e-02, avg batch time: 0.5037, average train loss: 0.3462
[09/26 06:42:10 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.1672, average loss: 0.4113
[09/26 06:42:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.24	
[09/26 06:42:10 visual_prompt]: Training 21 / 100 epoch, with learning rate 0.048492315519647715
[09/26 06:42:16 visual_prompt]: Epoch 21 / 100: avg data time: 4.52e-02, avg batch time: 0.4896, average train loss: 0.3727
[09/26 06:42:18 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.1675, average loss: 0.3879
[09/26 06:42:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.31	
[09/26 06:42:18 visual_prompt]: Training 22 / 100 epoch, with learning rate 0.048179596364169686
[09/26 06:42:24 visual_prompt]: Epoch 22 / 100: avg data time: 4.74e-02, avg batch time: 0.4918, average train loss: 0.3404
[09/26 06:42:26 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1674, average loss: 0.4239
[09/26 06:42:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.24	
[09/26 06:42:26 visual_prompt]: Training 23 / 100 epoch, with learning rate 0.04783863644106502
[09/26 06:42:33 visual_prompt]: Epoch 23 / 100: avg data time: 5.61e-02, avg batch time: 0.5004, average train loss: 0.3839
[09/26 06:42:34 visual_prompt]: Inference (val):avg data time: 3.29e-05, avg batch time: 0.1676, average loss: 0.4441
[09/26 06:42:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 76.00	rocauc: 90.71	
[09/26 06:42:34 visual_prompt]: Training 24 / 100 epoch, with learning rate 0.047469851157479176
[09/26 06:42:41 visual_prompt]: Epoch 24 / 100: avg data time: 5.35e-02, avg batch time: 0.4976, average train loss: 0.3245
[09/26 06:42:42 visual_prompt]: Inference (val):avg data time: 3.16e-05, avg batch time: 0.1676, average loss: 0.4548
[09/26 06:42:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 89.55	
[09/26 06:42:42 visual_prompt]: Training 25 / 100 epoch, with learning rate 0.047073689821473176
[09/26 06:42:49 visual_prompt]: Epoch 25 / 100: avg data time: 6.09e-02, avg batch time: 0.5044, average train loss: 0.3233
[09/26 06:42:51 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1673, average loss: 0.6644
[09/26 06:42:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 74.50	rocauc: 90.04	
[09/26 06:42:51 visual_prompt]: Training 26 / 100 epoch, with learning rate 0.046650635094610975
[09/26 06:42:57 visual_prompt]: Epoch 26 / 100: avg data time: 5.65e-02, avg batch time: 0.5000, average train loss: 0.3488
[09/26 06:42:59 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1672, average loss: 0.3931
[09/26 06:42:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 90.78	
[09/26 06:42:59 visual_prompt]: Training 27 / 100 epoch, with learning rate 0.04620120240391065
[09/26 06:43:06 visual_prompt]: Epoch 27 / 100: avg data time: 5.58e-02, avg batch time: 0.4994, average train loss: 0.3893
[09/26 06:43:07 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1676, average loss: 0.4010
[09/26 06:43:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.27	
[09/26 06:43:07 visual_prompt]: Training 28 / 100 epoch, with learning rate 0.04572593931387604
[09/26 06:43:14 visual_prompt]: Epoch 28 / 100: avg data time: 4.01e-02, avg batch time: 0.4841, average train loss: 0.2847
[09/26 06:43:15 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1676, average loss: 0.3655
[09/26 06:43:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.46	
[09/26 06:43:15 visual_prompt]: Training 29 / 100 epoch, with learning rate 0.04522542485937369
[09/26 06:43:22 visual_prompt]: Epoch 29 / 100: avg data time: 4.69e-02, avg batch time: 0.4924, average train loss: 0.2640
[09/26 06:43:23 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1675, average loss: 0.3759
[09/26 06:43:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.00	
[09/26 06:43:23 visual_prompt]: Training 30 / 100 epoch, with learning rate 0.04470026884016805
[09/26 06:43:30 visual_prompt]: Epoch 30 / 100: avg data time: 4.84e-02, avg batch time: 0.4924, average train loss: 0.2572
[09/26 06:43:31 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1673, average loss: 0.4896
[09/26 06:43:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 92.62	
[09/26 06:43:31 visual_prompt]: Training 31 / 100 epoch, with learning rate 0.04415111107797445
[09/26 06:43:38 visual_prompt]: Epoch 31 / 100: avg data time: 5.16e-02, avg batch time: 0.4973, average train loss: 0.2764
[09/26 06:43:40 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1673, average loss: 0.3891
[09/26 06:43:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.08	
[09/26 06:43:40 visual_prompt]: Best epoch 31: best metric: 0.850
[09/26 06:43:40 visual_prompt]: Training 32 / 100 epoch, with learning rate 0.04357862063693486
[09/26 06:43:46 visual_prompt]: Epoch 32 / 100: avg data time: 4.44e-02, avg batch time: 0.4908, average train loss: 0.2411
[09/26 06:43:48 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1673, average loss: 0.3836
[09/26 06:43:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 91.80	
[09/26 06:43:48 visual_prompt]: Training 33 / 100 epoch, with learning rate 0.04298349500846628
[09/26 06:43:55 visual_prompt]: Epoch 33 / 100: avg data time: 5.92e-02, avg batch time: 0.5038, average train loss: 0.2202
[09/26 06:43:56 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1676, average loss: 0.3970
[09/26 06:43:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.67	
[09/26 06:43:56 visual_prompt]: Training 34 / 100 epoch, with learning rate 0.042366459261474934
[09/26 06:44:03 visual_prompt]: Epoch 34 / 100: avg data time: 5.66e-02, avg batch time: 0.5016, average train loss: 0.2314
[09/26 06:44:04 visual_prompt]: Inference (val):avg data time: 2.76e-05, avg batch time: 0.1674, average loss: 0.3749
[09/26 06:44:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.57	
[09/26 06:44:04 visual_prompt]: Training 35 / 100 epoch, with learning rate 0.04172826515897146
[09/26 06:44:11 visual_prompt]: Epoch 35 / 100: avg data time: 4.70e-02, avg batch time: 0.4931, average train loss: 0.2375
[09/26 06:44:12 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1674, average loss: 0.3566
[09/26 06:44:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.04	
[09/26 06:44:12 visual_prompt]: Training 36 / 100 epoch, with learning rate 0.04106969024216348
[09/26 06:44:19 visual_prompt]: Epoch 36 / 100: avg data time: 4.44e-02, avg batch time: 0.4901, average train loss: 0.2264
[09/26 06:44:21 visual_prompt]: Inference (val):avg data time: 2.98e-05, avg batch time: 0.1675, average loss: 0.4525
[09/26 06:44:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.84	
[09/26 06:44:21 visual_prompt]: Training 37 / 100 epoch, with learning rate 0.040391536883141455
[09/26 06:44:27 visual_prompt]: Epoch 37 / 100: avg data time: 4.16e-02, avg batch time: 0.4875, average train loss: 0.3181
[09/26 06:44:29 visual_prompt]: Inference (val):avg data time: 3.13e-05, avg batch time: 0.1677, average loss: 0.3222
[09/26 06:44:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.76	
[09/26 06:44:29 visual_prompt]: Best epoch 37: best metric: 0.865
[09/26 06:44:29 visual_prompt]: Training 38 / 100 epoch, with learning rate 0.03969463130731183
[09/26 06:44:36 visual_prompt]: Epoch 38 / 100: avg data time: 5.79e-02, avg batch time: 0.5014, average train loss: 0.2200
[09/26 06:44:37 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1675, average loss: 0.3756
[09/26 06:44:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.86	
[09/26 06:44:37 visual_prompt]: Training 39 / 100 epoch, with learning rate 0.03897982258676867
[09/26 06:44:44 visual_prompt]: Epoch 39 / 100: avg data time: 4.71e-02, avg batch time: 0.4906, average train loss: 0.1962
[09/26 06:44:45 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1676, average loss: 0.4503
[09/26 06:44:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.90	
[09/26 06:44:45 visual_prompt]: Training 40 / 100 epoch, with learning rate 0.03824798160583012
[09/26 06:44:52 visual_prompt]: Epoch 40 / 100: avg data time: 5.58e-02, avg batch time: 0.4993, average train loss: 0.1858
[09/26 06:44:53 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1675, average loss: 0.3941
[09/26 06:44:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.00	
[09/26 06:44:53 visual_prompt]: Training 41 / 100 epoch, with learning rate 0.037500000000000006
[09/26 06:45:00 visual_prompt]: Epoch 41 / 100: avg data time: 5.87e-02, avg batch time: 0.5039, average train loss: 0.1790
[09/26 06:45:02 visual_prompt]: Inference (val):avg data time: 3.47e-05, avg batch time: 0.1677, average loss: 0.4129
[09/26 06:45:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.99	
[09/26 06:45:02 visual_prompt]: Training 42 / 100 epoch, with learning rate 0.03673678906964727
[09/26 06:45:08 visual_prompt]: Epoch 42 / 100: avg data time: 4.32e-02, avg batch time: 0.4873, average train loss: 0.1845
[09/26 06:45:10 visual_prompt]: Inference (val):avg data time: 2.92e-05, avg batch time: 0.1675, average loss: 0.3764
[09/26 06:45:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.35	
[09/26 06:45:10 visual_prompt]: Training 43 / 100 epoch, with learning rate 0.03595927866972694
[09/26 06:45:17 visual_prompt]: Epoch 43 / 100: avg data time: 5.55e-02, avg batch time: 0.5001, average train loss: 0.1690
[09/26 06:45:18 visual_prompt]: Inference (val):avg data time: 2.92e-05, avg batch time: 0.1676, average loss: 0.4073
[09/26 06:45:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.33	
[09/26 06:45:18 visual_prompt]: Training 44 / 100 epoch, with learning rate 0.03516841607689501
[09/26 06:45:25 visual_prompt]: Epoch 44 / 100: avg data time: 4.04e-02, avg batch time: 0.4884, average train loss: 0.1794
[09/26 06:45:26 visual_prompt]: Inference (val):avg data time: 3.09e-05, avg batch time: 0.1676, average loss: 0.4008
[09/26 06:45:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.24	
[09/26 06:45:26 visual_prompt]: Training 45 / 100 epoch, with learning rate 0.0343651648353978
[09/26 06:45:33 visual_prompt]: Epoch 45 / 100: avg data time: 5.40e-02, avg batch time: 0.4987, average train loss: 0.1642
[09/26 06:45:34 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1674, average loss: 0.3908
[09/26 06:45:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.42	
[09/26 06:45:34 visual_prompt]: Training 46 / 100 epoch, with learning rate 0.033550503583141725
[09/26 06:45:41 visual_prompt]: Epoch 46 / 100: avg data time: 5.14e-02, avg batch time: 0.4966, average train loss: 0.1457
[09/26 06:45:43 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1675, average loss: 0.4402
[09/26 06:45:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.55	
[09/26 06:45:43 visual_prompt]: Training 47 / 100 epoch, with learning rate 0.032725424859373686
[09/26 06:45:49 visual_prompt]: Epoch 47 / 100: avg data time: 4.62e-02, avg batch time: 0.4901, average train loss: 0.1150
[09/26 06:45:51 visual_prompt]: Inference (val):avg data time: 2.20e-05, avg batch time: 0.1675, average loss: 0.4453
[09/26 06:45:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.85	
[09/26 06:45:51 visual_prompt]: Training 48 / 100 epoch, with learning rate 0.03189093389542498
[09/26 06:45:58 visual_prompt]: Epoch 48 / 100: avg data time: 5.91e-02, avg batch time: 0.5028, average train loss: 0.1220
[09/26 06:45:59 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1673, average loss: 0.4516
[09/26 06:45:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.46	
[09/26 06:45:59 visual_prompt]: Training 49 / 100 epoch, with learning rate 0.03104804738999169
[09/26 06:46:06 visual_prompt]: Epoch 49 / 100: avg data time: 5.80e-02, avg batch time: 0.5028, average train loss: 0.1023
[09/26 06:46:08 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1672, average loss: 0.3934
[09/26 06:46:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.76	
[09/26 06:46:08 visual_prompt]: Training 50 / 100 epoch, with learning rate 0.03019779227044398
[09/26 06:46:14 visual_prompt]: Epoch 50 / 100: avg data time: 5.28e-02, avg batch time: 0.4983, average train loss: 0.0915
[09/26 06:46:16 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1673, average loss: 0.4533
[09/26 06:46:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.23	
[09/26 06:46:16 visual_prompt]: Training 51 / 100 epoch, with learning rate 0.029341204441673263
[09/26 06:46:23 visual_prompt]: Epoch 51 / 100: avg data time: 5.65e-02, avg batch time: 0.5016, average train loss: 0.0939
[09/26 06:46:24 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1671, average loss: 0.6222
[09/26 06:46:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.64	
[09/26 06:46:24 visual_prompt]: Training 52 / 100 epoch, with learning rate 0.028479327524001636
[09/26 06:46:31 visual_prompt]: Epoch 52 / 100: avg data time: 6.11e-02, avg batch time: 0.5051, average train loss: 0.1096
[09/26 06:46:32 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1673, average loss: 0.4766
[09/26 06:46:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 91.68	
[09/26 06:46:32 visual_prompt]: Training 53 / 100 epoch, with learning rate 0.02761321158169134
[09/26 06:46:39 visual_prompt]: Epoch 53 / 100: avg data time: 5.34e-02, avg batch time: 0.4989, average train loss: 0.0853
[09/26 06:46:40 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1676, average loss: 0.5288
[09/26 06:46:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 91.91	
[09/26 06:46:40 visual_prompt]: Training 54 / 100 epoch, with learning rate 0.02674391184360313
[09/26 06:46:47 visual_prompt]: Epoch 54 / 100: avg data time: 5.44e-02, avg batch time: 0.4993, average train loss: 0.0830
[09/26 06:46:49 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1671, average loss: 0.4262
[09/26 06:46:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.91	
[09/26 06:46:49 visual_prompt]: Training 55 / 100 epoch, with learning rate 0.02587248741756253
[09/26 06:46:55 visual_prompt]: Epoch 55 / 100: avg data time: 4.25e-02, avg batch time: 0.4867, average train loss: 0.0976
[09/26 06:46:57 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1672, average loss: 0.4918
[09/26 06:46:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.00	
[09/26 06:46:57 visual_prompt]: Training 56 / 100 epoch, with learning rate 0.025
[09/26 06:47:04 visual_prompt]: Epoch 56 / 100: avg data time: 5.30e-02, avg batch time: 0.5002, average train loss: 0.0979
[09/26 06:47:05 visual_prompt]: Inference (val):avg data time: 3.67e-05, avg batch time: 0.1676, average loss: 0.5659
[09/26 06:47:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 90.74	
[09/26 06:47:05 visual_prompt]: Training 57 / 100 epoch, with learning rate 0.024127512582437484
[09/26 06:47:12 visual_prompt]: Epoch 57 / 100: avg data time: 5.31e-02, avg batch time: 0.4967, average train loss: 0.0828
[09/26 06:47:13 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1675, average loss: 0.4862
[09/26 06:47:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.64	
[09/26 06:47:13 visual_prompt]: Training 58 / 100 epoch, with learning rate 0.02325608815639687
[09/26 06:47:20 visual_prompt]: Epoch 58 / 100: avg data time: 4.08e-02, avg batch time: 0.4861, average train loss: 0.0764
[09/26 06:47:21 visual_prompt]: Inference (val):avg data time: 2.98e-05, avg batch time: 0.1675, average loss: 0.5198
[09/26 06:47:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.90	
[09/26 06:47:21 visual_prompt]: Training 59 / 100 epoch, with learning rate 0.02238678841830867
[09/26 06:47:28 visual_prompt]: Epoch 59 / 100: avg data time: 5.48e-02, avg batch time: 0.4992, average train loss: 0.0783
[09/26 06:47:30 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1676, average loss: 0.6068
[09/26 06:47:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 90.39	
[09/26 06:47:30 visual_prompt]: Training 60 / 100 epoch, with learning rate 0.02152067247599837
[09/26 06:47:36 visual_prompt]: Epoch 60 / 100: avg data time: 4.78e-02, avg batch time: 0.4930, average train loss: 0.1055
[09/26 06:47:38 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1678, average loss: 0.4438
[09/26 06:47:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.98	
[09/26 06:47:38 visual_prompt]: Training 61 / 100 epoch, with learning rate 0.020658795558326743
[09/26 06:47:44 visual_prompt]: Epoch 61 / 100: avg data time: 4.23e-02, avg batch time: 0.4869, average train loss: 0.0479
[09/26 06:47:46 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1676, average loss: 0.4999
[09/26 06:47:46 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.15	
[09/26 06:47:46 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.019802207729556022
[09/26 06:47:53 visual_prompt]: Epoch 62 / 100: avg data time: 6.20e-02, avg batch time: 0.5060, average train loss: 0.0431
[09/26 06:47:54 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.1676, average loss: 0.5472
[09/26 06:47:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.43	
[09/26 06:47:54 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.018951952610008312
[09/26 06:48:01 visual_prompt]: Epoch 63 / 100: avg data time: 6.01e-02, avg batch time: 0.5036, average train loss: 0.0375
[09/26 06:48:03 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1675, average loss: 0.5242
[09/26 06:48:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.91	
[09/26 06:48:03 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.018109066104575022
[09/26 06:48:09 visual_prompt]: Epoch 64 / 100: avg data time: 4.20e-02, avg batch time: 0.4880, average train loss: 0.0335
[09/26 06:48:11 visual_prompt]: Inference (val):avg data time: 4.36e-05, avg batch time: 0.1671, average loss: 0.5633
[09/26 06:48:11 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.44	
[09/26 06:48:11 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.017274575140626316
[09/26 06:48:17 visual_prompt]: Epoch 65 / 100: avg data time: 4.83e-02, avg batch time: 0.4929, average train loss: 0.0365
[09/26 06:48:19 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.1675, average loss: 0.5621
[09/26 06:48:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.15	
[09/26 06:48:19 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.016449496416858285
[09/26 06:48:26 visual_prompt]: Epoch 66 / 100: avg data time: 4.88e-02, avg batch time: 0.4934, average train loss: 0.0326
[09/26 06:48:27 visual_prompt]: Inference (val):avg data time: 3.13e-05, avg batch time: 0.1675, average loss: 0.5808
[09/26 06:48:27 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.20	
[09/26 06:48:27 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.0156348351646022
[09/26 06:48:34 visual_prompt]: Epoch 67 / 100: avg data time: 4.63e-02, avg batch time: 0.4906, average train loss: 0.0557
[09/26 06:48:35 visual_prompt]: Inference (val):avg data time: 3.14e-05, avg batch time: 0.1677, average loss: 0.5893
[09/26 06:48:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.03	
[09/26 06:48:35 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.014831583923105
[09/26 06:48:42 visual_prompt]: Epoch 68 / 100: avg data time: 6.14e-02, avg batch time: 0.5056, average train loss: 0.0336
[09/26 06:48:44 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1674, average loss: 0.6916
[09/26 06:48:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.58	
[09/26 06:48:44 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.014040721330273063
[09/26 06:48:50 visual_prompt]: Epoch 69 / 100: avg data time: 5.95e-02, avg batch time: 0.5033, average train loss: 0.0421
[09/26 06:48:52 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1674, average loss: 0.5362
[09/26 06:48:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.00	
[09/26 06:48:52 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.013263210930352737
[09/26 06:48:59 visual_prompt]: Epoch 70 / 100: avg data time: 4.27e-02, avg batch time: 0.4867, average train loss: 0.0309
[09/26 06:49:00 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1675, average loss: 0.5262
[09/26 06:49:00 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.39	
[09/26 06:49:00 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.012500000000000006
[09/26 06:49:07 visual_prompt]: Epoch 71 / 100: avg data time: 5.32e-02, avg batch time: 0.4982, average train loss: 0.0344
[09/26 06:49:08 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1675, average loss: 0.5207
[09/26 06:49:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.02	
[09/26 06:49:08 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.01175201839416988
[09/26 06:49:15 visual_prompt]: Epoch 72 / 100: avg data time: 4.71e-02, avg batch time: 0.4915, average train loss: 0.0250
[09/26 06:49:16 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1676, average loss: 0.6050
[09/26 06:49:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.15	
[09/26 06:49:16 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.011020177413231334
[09/26 06:49:23 visual_prompt]: Epoch 73 / 100: avg data time: 5.38e-02, avg batch time: 0.4979, average train loss: 0.0251
[09/26 06:49:25 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.1675, average loss: 0.5859
[09/26 06:49:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.14	
[09/26 06:49:25 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.010305368692688175
[09/26 06:49:31 visual_prompt]: Epoch 74 / 100: avg data time: 4.70e-02, avg batch time: 0.4935, average train loss: 0.0201
[09/26 06:49:33 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1678, average loss: 0.6603
[09/26 06:49:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.85	
[09/26 06:49:33 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.009608463116858543
[09/26 06:49:39 visual_prompt]: Epoch 75 / 100: avg data time: 4.34e-02, avg batch time: 0.4895, average train loss: 0.0218
[09/26 06:49:41 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.1678, average loss: 0.6325
[09/26 06:49:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.78	
[09/26 06:49:41 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.008930309757836517
[09/26 06:49:48 visual_prompt]: Epoch 76 / 100: avg data time: 5.77e-02, avg batch time: 0.5023, average train loss: 0.0137
[09/26 06:49:49 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1672, average loss: 0.6391
[09/26 06:49:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.22	
[09/26 06:49:49 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.008271734841028553
[09/26 06:49:56 visual_prompt]: Epoch 77 / 100: avg data time: 4.87e-02, avg batch time: 0.4944, average train loss: 0.0124
[09/26 06:49:57 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1672, average loss: 0.6514
[09/26 06:49:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.05	
[09/26 06:49:57 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.007633540738525066
[09/26 06:50:04 visual_prompt]: Epoch 78 / 100: avg data time: 4.33e-02, avg batch time: 0.4905, average train loss: 0.0103
[09/26 06:50:06 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1673, average loss: 0.6662
[09/26 06:50:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.00	
[09/26 06:50:06 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.0070165049915337264
[09/26 06:50:12 visual_prompt]: Epoch 79 / 100: avg data time: 5.41e-02, avg batch time: 0.4997, average train loss: 0.0171
[09/26 06:50:14 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1672, average loss: 0.6800
[09/26 06:50:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.97	
[09/26 06:50:14 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.006421379363065142
[09/26 06:50:21 visual_prompt]: Epoch 80 / 100: avg data time: 5.84e-02, avg batch time: 0.5021, average train loss: 0.0110
[09/26 06:50:22 visual_prompt]: Inference (val):avg data time: 2.76e-05, avg batch time: 0.1676, average loss: 0.6928
[09/26 06:50:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.22	
[09/26 06:50:22 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.005848888922025553
[09/26 06:50:29 visual_prompt]: Epoch 81 / 100: avg data time: 4.72e-02, avg batch time: 0.4937, average train loss: 0.0140
[09/26 06:50:30 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1676, average loss: 0.6897
[09/26 06:50:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.63	
[09/26 06:50:30 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.005299731159831953
[09/26 06:50:37 visual_prompt]: Epoch 82 / 100: avg data time: 5.56e-02, avg batch time: 0.5008, average train loss: 0.0128
[09/26 06:50:39 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.1673, average loss: 0.6833
[09/26 06:50:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.56	
[09/26 06:50:39 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.004774575140626317
[09/26 06:50:45 visual_prompt]: Epoch 83 / 100: avg data time: 5.52e-02, avg batch time: 0.4995, average train loss: 0.0130
[09/26 06:50:47 visual_prompt]: Inference (val):avg data time: 2.73e-05, avg batch time: 0.1674, average loss: 0.6956
[09/26 06:50:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.54	
[09/26 06:50:47 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.004274060686123959
[09/26 06:50:54 visual_prompt]: Epoch 84 / 100: avg data time: 5.23e-02, avg batch time: 0.4957, average train loss: 0.0111
[09/26 06:50:55 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1675, average loss: 0.6812
[09/26 06:50:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.68	
[09/26 06:50:55 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.003798797596089351
[09/26 06:51:02 visual_prompt]: Epoch 85 / 100: avg data time: 4.23e-02, avg batch time: 0.4884, average train loss: 0.0125
[09/26 06:51:03 visual_prompt]: Inference (val):avg data time: 3.33e-05, avg batch time: 0.1674, average loss: 0.7126
[09/26 06:51:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.49	
[09/26 06:51:03 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.0033493649053890325
[09/26 06:51:10 visual_prompt]: Epoch 86 / 100: avg data time: 5.83e-02, avg batch time: 0.5033, average train loss: 0.0114
[09/26 06:51:12 visual_prompt]: Inference (val):avg data time: 3.19e-05, avg batch time: 0.1674, average loss: 0.7152
[09/26 06:51:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.48	
[09/26 06:51:12 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.0029263101785268254
[09/26 06:51:18 visual_prompt]: Epoch 87 / 100: avg data time: 5.24e-02, avg batch time: 0.4979, average train loss: 0.0093
[09/26 06:51:20 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.1677, average loss: 0.7109
[09/26 06:51:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.28	
[09/26 06:51:20 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.00253014884252083
[09/26 06:51:27 visual_prompt]: Epoch 88 / 100: avg data time: 4.35e-02, avg batch time: 0.4884, average train loss: 0.0090
[09/26 06:51:28 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1676, average loss: 0.7149
[09/26 06:51:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.28	
[09/26 06:51:28 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.0021613635589349755
[09/26 06:51:35 visual_prompt]: Epoch 89 / 100: avg data time: 5.83e-02, avg batch time: 0.5020, average train loss: 0.0085
[09/26 06:51:36 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1674, average loss: 0.7190
[09/26 06:51:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.29	
[09/26 06:51:36 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.0018204036358303172
[09/26 06:51:43 visual_prompt]: Epoch 90 / 100: avg data time: 5.35e-02, avg batch time: 0.4970, average train loss: 0.0081
[09/26 06:51:45 visual_prompt]: Inference (val):avg data time: 3.11e-05, avg batch time: 0.1678, average loss: 0.7171
[09/26 06:51:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.43	
[09/26 06:51:45 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.0015076844803522923
[09/26 06:51:51 visual_prompt]: Epoch 91 / 100: avg data time: 5.75e-02, avg batch time: 0.5020, average train loss: 0.0104
[09/26 06:51:53 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1678, average loss: 0.7179
[09/26 06:51:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.57	
[09/26 06:51:53 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.0012235870926211618
[09/26 06:52:00 visual_prompt]: Epoch 92 / 100: avg data time: 4.40e-02, avg batch time: 0.4889, average train loss: 0.0128
[09/26 06:52:01 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1672, average loss: 0.7204
[09/26 06:52:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.61	
[09/26 06:52:01 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.0009684576015420277
[09/26 06:52:08 visual_prompt]: Epoch 93 / 100: avg data time: 4.82e-02, avg batch time: 0.4932, average train loss: 0.0105
[09/26 06:52:09 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1674, average loss: 0.7235
[09/26 06:52:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.68	
[09/26 06:52:09 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.0007426068431000883
[09/26 06:52:16 visual_prompt]: Epoch 94 / 100: avg data time: 4.60e-02, avg batch time: 0.4910, average train loss: 0.0076
[09/26 06:52:17 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1673, average loss: 0.7228
[09/26 06:52:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.70	
[09/26 06:52:17 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.0005463099816548578
[09/26 06:52:24 visual_prompt]: Epoch 95 / 100: avg data time: 5.04e-02, avg batch time: 0.4956, average train loss: 0.0084
[09/26 06:52:26 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1674, average loss: 0.7226
[09/26 06:52:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.69	
[09/26 06:52:26 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.00037980617469479954
[09/26 06:52:32 visual_prompt]: Epoch 96 / 100: avg data time: 4.87e-02, avg batch time: 0.4936, average train loss: 0.0074
[09/26 06:52:34 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1673, average loss: 0.7221
[09/26 06:52:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.67	
[09/26 06:52:34 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.00024329828146074097
[09/26 06:52:40 visual_prompt]: Epoch 97 / 100: avg data time: 5.29e-02, avg batch time: 0.4978, average train loss: 0.0090
[09/26 06:52:42 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1675, average loss: 0.7218
[09/26 06:52:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.67	
[09/26 06:52:42 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.00013695261579316776
[09/26 06:52:49 visual_prompt]: Epoch 98 / 100: avg data time: 5.28e-02, avg batch time: 0.4982, average train loss: 0.0080
[09/26 06:52:50 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1675, average loss: 0.7217
[09/26 06:52:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.69	
[09/26 06:52:50 visual_prompt]: Training 99 / 100 epoch, with learning rate 6.089874350439506e-05
[09/26 06:52:57 visual_prompt]: Epoch 99 / 100: avg data time: 5.74e-02, avg batch time: 0.5010, average train loss: 0.0081
[09/26 06:52:59 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1673, average loss: 0.7217
[09/26 06:52:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.69	
[09/26 06:52:59 visual_prompt]: Training 100 / 100 epoch, with learning rate 1.5229324522605948e-05
[09/26 06:53:05 visual_prompt]: Epoch 100 / 100: avg data time: 5.13e-02, avg batch time: 0.4948, average train loss: 0.0107
[09/26 06:53:07 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.1670, average loss: 0.7217
[09/26 06:53:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.69	
[09/26 06:53:07 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 06:53:07 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              3
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 06:53:07 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-patch_camelyon', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 06:53:07 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 06:53:07 visual_prompt]: Training with config:
[09/26 06:53:07 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/vtab-patch_camelyon/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr0.05_wd0.0/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 0.05, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'vtab-patch_camelyon', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 06:53:07 visual_prompt]: Loading training data...
[09/26 06:53:07 visual_prompt]: Constructing vtab-patch_camelyon dataset train...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split train[:800], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 06:53:08 visual_prompt]: Number of images: 800
[09/26 06:53:08 visual_prompt]: Number of classes: 2 / 2
[09/26 06:53:08 visual_prompt]: Loading validation data...
[09/26 06:53:08 visual_prompt]: Constructing vtab-patch_camelyon dataset val...
[INFO: dataset_info.py:  599]: Load dataset info from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[INFO: dataset_builder.py:  573]: Reusing dataset patch_camelyon (visual_prompt_tuning/data_path/patch_camelyon/2.0.0)
[INFO: logging_logger.py:   49]: Constructing tf.data.Dataset patch_camelyon for split validation[:200], from visual_prompt_tuning/data_path/patch_camelyon/2.0.0
[09/26 06:53:08 visual_prompt]: Number of images: 200
[09/26 06:53:08 visual_prompt]: Number of classes: 2 / 2
[09/26 06:53:08 visual_prompt]: Constructing models...
[09/26 06:53:11 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 06:53:11 visual_prompt]: tuned percent:0.536
[09/26 06:53:11 visual_prompt]: Device used for model: 0
[09/26 06:53:11 visual_prompt]: Setting up Evaluator...
[09/26 06:53:11 visual_prompt]: Setting up Trainer...
[09/26 06:53:11 visual_prompt]: 	Setting up the optimizer...
[09/26 06:53:11 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 06:53:18 visual_prompt]: Epoch 1 / 100: avg data time: 4.68e-02, avg batch time: 0.4928, average train loss: 1.9527
[09/26 06:53:19 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1671, average loss: 2.0033
[09/26 06:53:19 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 30.38	
[09/26 06:53:19 visual_prompt]: Best epoch 1: best metric: 0.520
[09/26 06:53:19 visual_prompt]: Training 2 / 100 epoch, with learning rate 0.005000000000000001
[09/26 06:53:26 visual_prompt]: Epoch 2 / 100: avg data time: 5.80e-02, avg batch time: 0.5022, average train loss: 1.3718
[09/26 06:53:28 visual_prompt]: Inference (val):avg data time: 3.10e-05, avg batch time: 0.1669, average loss: 0.6703
[09/26 06:53:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 64.00	rocauc: 65.01	
[09/26 06:53:28 visual_prompt]: Best epoch 2: best metric: 0.640
[09/26 06:53:28 visual_prompt]: Training 3 / 100 epoch, with learning rate 0.010000000000000002
[09/26 06:53:34 visual_prompt]: Epoch 3 / 100: avg data time: 4.59e-02, avg batch time: 0.4924, average train loss: 0.7158
[09/26 06:53:36 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1673, average loss: 0.6484
[09/26 06:53:36 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 52.00	rocauc: 85.99	
[09/26 06:53:36 visual_prompt]: Training 4 / 100 epoch, with learning rate 0.015
[09/26 06:53:43 visual_prompt]: Epoch 4 / 100: avg data time: 5.10e-02, avg batch time: 0.4942, average train loss: 0.6595
[09/26 06:53:44 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1669, average loss: 0.6137
[09/26 06:53:44 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 62.50	rocauc: 89.89	
[09/26 06:53:44 visual_prompt]: Training 5 / 100 epoch, with learning rate 0.020000000000000004
[09/26 06:53:51 visual_prompt]: Epoch 5 / 100: avg data time: 5.62e-02, avg batch time: 0.5006, average train loss: 0.5639
[09/26 06:53:52 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1670, average loss: 0.4565
[09/26 06:53:52 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 90.47	
[09/26 06:53:52 visual_prompt]: Best epoch 5: best metric: 0.825
[09/26 06:53:52 visual_prompt]: Training 6 / 100 epoch, with learning rate 0.025
[09/26 06:53:59 visual_prompt]: Epoch 6 / 100: avg data time: 5.84e-02, avg batch time: 0.5032, average train loss: 0.5380
[09/26 06:54:01 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1670, average loss: 0.5155
[09/26 06:54:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.00	rocauc: 89.84	
[09/26 06:54:01 visual_prompt]: Training 7 / 100 epoch, with learning rate 0.03
[09/26 06:54:07 visual_prompt]: Epoch 7 / 100: avg data time: 5.33e-02, avg batch time: 0.4974, average train loss: 0.5072
[09/26 06:54:09 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1671, average loss: 0.4382
[09/26 06:54:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 89.60	
[09/26 06:54:09 visual_prompt]: Training 8 / 100 epoch, with learning rate 0.034999999999999996
[09/26 06:54:16 visual_prompt]: Epoch 8 / 100: avg data time: 4.77e-02, avg batch time: 0.4927, average train loss: 0.6540
[09/26 06:54:17 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1667, average loss: 0.7370
[09/26 06:54:17 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 60.50	rocauc: 90.71	
[09/26 06:54:17 visual_prompt]: Training 9 / 100 epoch, with learning rate 0.04000000000000001
[09/26 06:54:24 visual_prompt]: Epoch 9 / 100: avg data time: 5.07e-02, avg batch time: 0.4952, average train loss: 0.5275
[09/26 06:54:25 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1674, average loss: 0.3834
[09/26 06:54:25 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 90.67	
[09/26 06:54:25 visual_prompt]: Best epoch 9: best metric: 0.855
[09/26 06:54:25 visual_prompt]: Training 10 / 100 epoch, with learning rate 0.045000000000000005
[09/26 06:54:32 visual_prompt]: Epoch 10 / 100: avg data time: 4.42e-02, avg batch time: 0.4901, average train loss: 0.4969
[09/26 06:54:33 visual_prompt]: Inference (val):avg data time: 3.59e-05, avg batch time: 0.1671, average loss: 0.4617
[09/26 06:54:33 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 89.97	
[09/26 06:54:33 visual_prompt]: Training 11 / 100 epoch, with learning rate 0.05
[09/26 06:54:40 visual_prompt]: Epoch 11 / 100: avg data time: 5.40e-02, avg batch time: 0.4988, average train loss: 0.5039
[09/26 06:54:42 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1674, average loss: 0.3931
[09/26 06:54:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 90.58	
[09/26 06:54:42 visual_prompt]: Training 12 / 100 epoch, with learning rate 0.0499847706754774
[09/26 06:54:48 visual_prompt]: Epoch 12 / 100: avg data time: 5.20e-02, avg batch time: 0.4966, average train loss: 0.4976
[09/26 06:54:50 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.1672, average loss: 0.4158
[09/26 06:54:50 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.12	
[09/26 06:54:50 visual_prompt]: Training 13 / 100 epoch, with learning rate 0.04993910125649561
[09/26 06:54:57 visual_prompt]: Epoch 13 / 100: avg data time: 4.89e-02, avg batch time: 0.4937, average train loss: 0.4569
[09/26 06:54:58 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1669, average loss: 0.3648
[09/26 06:54:58 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 91.89	
[09/26 06:54:58 visual_prompt]: Training 14 / 100 epoch, with learning rate 0.049863047384206834
[09/26 06:55:05 visual_prompt]: Epoch 14 / 100: avg data time: 4.68e-02, avg batch time: 0.4923, average train loss: 0.4152
[09/26 06:55:06 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1678, average loss: 0.3731
[09/26 06:55:06 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.71	
[09/26 06:55:06 visual_prompt]: Training 15 / 100 epoch, with learning rate 0.04975670171853926
[09/26 06:55:13 visual_prompt]: Epoch 15 / 100: avg data time: 4.24e-02, avg batch time: 0.4891, average train loss: 0.3835
[09/26 06:55:14 visual_prompt]: Inference (val):avg data time: 4.50e-05, avg batch time: 0.1676, average loss: 0.4516
[09/26 06:55:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 78.50	rocauc: 91.49	
[09/26 06:55:14 visual_prompt]: Training 16 / 100 epoch, with learning rate 0.049620193825305206
[09/26 06:55:21 visual_prompt]: Epoch 16 / 100: avg data time: 5.73e-02, avg batch time: 0.5008, average train loss: 0.4121
[09/26 06:55:23 visual_prompt]: Inference (val):avg data time: 2.89e-05, avg batch time: 0.1674, average loss: 0.4577
[09/26 06:55:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 91.43	
[09/26 06:55:23 visual_prompt]: Training 17 / 100 epoch, with learning rate 0.049453690018345146
[09/26 06:55:29 visual_prompt]: Epoch 17 / 100: avg data time: 4.57e-02, avg batch time: 0.4914, average train loss: 0.4281
[09/26 06:55:31 visual_prompt]: Inference (val):avg data time: 2.95e-05, avg batch time: 0.1674, average loss: 0.4855
[09/26 06:55:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 73.50	rocauc: 90.17	
[09/26 06:55:31 visual_prompt]: Training 18 / 100 epoch, with learning rate 0.04925739315689991
[09/26 06:55:38 visual_prompt]: Epoch 18 / 100: avg data time: 4.25e-02, avg batch time: 0.4871, average train loss: 0.4075
[09/26 06:55:39 visual_prompt]: Inference (val):avg data time: 3.21e-05, avg batch time: 0.1674, average loss: 0.6180
[09/26 06:55:39 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 72.50	rocauc: 90.89	
[09/26 06:55:39 visual_prompt]: Training 19 / 100 epoch, with learning rate 0.04903154239845797
[09/26 06:55:46 visual_prompt]: Epoch 19 / 100: avg data time: 6.18e-02, avg batch time: 0.5052, average train loss: 0.4655
[09/26 06:55:47 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.1674, average loss: 0.4420
[09/26 06:55:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 92.06	
[09/26 06:55:47 visual_prompt]: Training 20 / 100 epoch, with learning rate 0.048776412907378844
[09/26 06:55:54 visual_prompt]: Epoch 20 / 100: avg data time: 5.05e-02, avg batch time: 0.4956, average train loss: 0.3890
[09/26 06:55:56 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1675, average loss: 0.3810
[09/26 06:55:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.07	
[09/26 06:55:56 visual_prompt]: Training 21 / 100 epoch, with learning rate 0.048492315519647715
[09/26 06:56:02 visual_prompt]: Epoch 21 / 100: avg data time: 5.06e-02, avg batch time: 0.4953, average train loss: 0.4081
[09/26 06:56:04 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1674, average loss: 0.3976
[09/26 06:56:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.03	
[09/26 06:56:04 visual_prompt]: Training 22 / 100 epoch, with learning rate 0.048179596364169686
[09/26 06:56:11 visual_prompt]: Epoch 22 / 100: avg data time: 4.55e-02, avg batch time: 0.4920, average train loss: 0.3419
[09/26 06:56:12 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.1675, average loss: 0.4220
[09/26 06:56:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 91.07	
[09/26 06:56:12 visual_prompt]: Training 23 / 100 epoch, with learning rate 0.04783863644106502
[09/26 06:56:19 visual_prompt]: Epoch 23 / 100: avg data time: 5.42e-02, avg batch time: 0.4994, average train loss: 0.3334
[09/26 06:56:20 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.1673, average loss: 0.4797
[09/26 06:56:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 79.00	rocauc: 90.03	
[09/26 06:56:20 visual_prompt]: Training 24 / 100 epoch, with learning rate 0.047469851157479176
[09/26 06:56:27 visual_prompt]: Epoch 24 / 100: avg data time: 4.41e-02, avg batch time: 0.4908, average train loss: 0.3489
[09/26 06:56:28 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1673, average loss: 0.3818
[09/26 06:56:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.72	
[09/26 06:56:28 visual_prompt]: Training 25 / 100 epoch, with learning rate 0.047073689821473176
[09/26 06:56:35 visual_prompt]: Epoch 25 / 100: avg data time: 5.03e-02, avg batch time: 0.4961, average train loss: 0.3501
[09/26 06:56:37 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1675, average loss: 0.3985
[09/26 06:56:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.47	
[09/26 06:56:37 visual_prompt]: Training 26 / 100 epoch, with learning rate 0.046650635094610975
[09/26 06:56:43 visual_prompt]: Epoch 26 / 100: avg data time: 5.64e-02, avg batch time: 0.5003, average train loss: 0.3009
[09/26 06:56:45 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1673, average loss: 0.3823
[09/26 06:56:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.50	
[09/26 06:56:45 visual_prompt]: Training 27 / 100 epoch, with learning rate 0.04620120240391065
[09/26 06:56:52 visual_prompt]: Epoch 27 / 100: avg data time: 5.89e-02, avg batch time: 0.5039, average train loss: 0.2794
[09/26 06:56:53 visual_prompt]: Inference (val):avg data time: 2.95e-05, avg batch time: 0.1674, average loss: 0.4320
[09/26 06:56:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 91.40	
[09/26 06:56:53 visual_prompt]: Training 28 / 100 epoch, with learning rate 0.04572593931387604
[09/26 06:57:00 visual_prompt]: Epoch 28 / 100: avg data time: 4.78e-02, avg batch time: 0.4920, average train loss: 0.2669
[09/26 06:57:02 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1675, average loss: 0.4703
[09/26 06:57:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 91.61	
[09/26 06:57:02 visual_prompt]: Training 29 / 100 epoch, with learning rate 0.04522542485937369
[09/26 06:57:08 visual_prompt]: Epoch 29 / 100: avg data time: 5.92e-02, avg batch time: 0.5046, average train loss: 0.2511
[09/26 06:57:10 visual_prompt]: Inference (val):avg data time: 3.06e-05, avg batch time: 0.1674, average loss: 0.5107
[09/26 06:57:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 91.38	
[09/26 06:57:10 visual_prompt]: Training 30 / 100 epoch, with learning rate 0.04470026884016805
[09/26 06:57:17 visual_prompt]: Epoch 30 / 100: avg data time: 4.70e-02, avg batch time: 0.4943, average train loss: 0.2746
[09/26 06:57:18 visual_prompt]: Inference (val):avg data time: 4.27e-05, avg batch time: 0.1675, average loss: 0.3664
[09/26 06:57:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 92.48	
[09/26 06:57:18 visual_prompt]: Training 31 / 100 epoch, with learning rate 0.04415111107797445
[09/26 06:57:25 visual_prompt]: Epoch 31 / 100: avg data time: 5.47e-02, avg batch time: 0.4985, average train loss: 0.2541
[09/26 06:57:26 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1673, average loss: 0.3920
[09/26 06:57:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.19	
[09/26 06:57:26 visual_prompt]: Training 32 / 100 epoch, with learning rate 0.04357862063693486
[09/26 06:57:33 visual_prompt]: Epoch 32 / 100: avg data time: 5.56e-02, avg batch time: 0.4995, average train loss: 0.2415
[09/26 06:57:35 visual_prompt]: Inference (val):avg data time: 3.74e-05, avg batch time: 0.1673, average loss: 0.3757
[09/26 06:57:35 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.76	
[09/26 06:57:35 visual_prompt]: Training 33 / 100 epoch, with learning rate 0.04298349500846628
[09/26 06:57:41 visual_prompt]: Epoch 33 / 100: avg data time: 4.78e-02, avg batch time: 0.4935, average train loss: 0.2183
[09/26 06:57:43 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1676, average loss: 0.4528
[09/26 06:57:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.23	
[09/26 06:57:43 visual_prompt]: Best epoch 33: best metric: 0.865
[09/26 06:57:43 visual_prompt]: Training 34 / 100 epoch, with learning rate 0.042366459261474934
[09/26 06:57:50 visual_prompt]: Epoch 34 / 100: avg data time: 5.71e-02, avg batch time: 0.5022, average train loss: 0.2671
[09/26 06:57:51 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.1674, average loss: 0.4655
[09/26 06:57:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 77.50	rocauc: 90.54	
[09/26 06:57:51 visual_prompt]: Training 35 / 100 epoch, with learning rate 0.04172826515897146
[09/26 06:57:58 visual_prompt]: Epoch 35 / 100: avg data time: 4.24e-02, avg batch time: 0.4884, average train loss: 0.2840
[09/26 06:57:59 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1669, average loss: 0.4375
[09/26 06:57:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 92.62	
[09/26 06:57:59 visual_prompt]: Training 36 / 100 epoch, with learning rate 0.04106969024216348
[09/26 06:58:06 visual_prompt]: Epoch 36 / 100: avg data time: 5.70e-02, avg batch time: 0.5024, average train loss: 0.2458
[09/26 06:58:08 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1669, average loss: 0.5071
[09/26 06:58:08 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 93.88	
[09/26 06:58:08 visual_prompt]: Training 37 / 100 epoch, with learning rate 0.040391536883141455
[09/26 06:58:14 visual_prompt]: Epoch 37 / 100: avg data time: 5.32e-02, avg batch time: 0.4973, average train loss: 0.2702
[09/26 06:58:16 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1671, average loss: 0.3644
[09/26 06:58:16 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.41	
[09/26 06:58:16 visual_prompt]: Training 38 / 100 epoch, with learning rate 0.03969463130731183
[09/26 06:58:23 visual_prompt]: Epoch 38 / 100: avg data time: 4.74e-02, avg batch time: 0.4933, average train loss: 0.1998
[09/26 06:58:24 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1672, average loss: 0.3894
[09/26 06:58:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.10	
[09/26 06:58:24 visual_prompt]: Training 39 / 100 epoch, with learning rate 0.03897982258676867
[09/26 06:58:31 visual_prompt]: Epoch 39 / 100: avg data time: 5.09e-02, avg batch time: 0.4961, average train loss: 0.1921
[09/26 06:58:32 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1671, average loss: 0.5974
[09/26 06:58:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.00	rocauc: 87.90	
[09/26 06:58:32 visual_prompt]: Training 40 / 100 epoch, with learning rate 0.03824798160583012
[09/26 06:58:39 visual_prompt]: Epoch 40 / 100: avg data time: 5.36e-02, avg batch time: 0.4984, average train loss: 0.2220
[09/26 06:58:41 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1674, average loss: 0.4005
[09/26 06:58:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 93.92	
[09/26 06:58:41 visual_prompt]: Training 41 / 100 epoch, with learning rate 0.037500000000000006
[09/26 06:58:47 visual_prompt]: Epoch 41 / 100: avg data time: 5.13e-02, avg batch time: 0.4964, average train loss: 0.1936
[09/26 06:58:49 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1674, average loss: 0.4345
[09/26 06:58:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.26	
[09/26 06:58:49 visual_prompt]: Training 42 / 100 epoch, with learning rate 0.03673678906964727
[09/26 06:58:55 visual_prompt]: Epoch 42 / 100: avg data time: 5.48e-02, avg batch time: 0.4987, average train loss: 0.1892
[09/26 06:58:57 visual_prompt]: Inference (val):avg data time: 2.99e-05, avg batch time: 0.1674, average loss: 0.4284
[09/26 06:58:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.51	
[09/26 06:58:57 visual_prompt]: Training 43 / 100 epoch, with learning rate 0.03595927866972694
[09/26 06:59:04 visual_prompt]: Epoch 43 / 100: avg data time: 4.34e-02, avg batch time: 0.4890, average train loss: 0.1916
[09/26 06:59:05 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.1676, average loss: 0.4645
[09/26 06:59:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.70	
[09/26 06:59:05 visual_prompt]: Training 44 / 100 epoch, with learning rate 0.03516841607689501
[09/26 06:59:12 visual_prompt]: Epoch 44 / 100: avg data time: 4.58e-02, avg batch time: 0.4909, average train loss: 0.2253
[09/26 06:59:13 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1670, average loss: 0.5669
[09/26 06:59:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.50	rocauc: 93.08	
[09/26 06:59:13 visual_prompt]: Training 45 / 100 epoch, with learning rate 0.0343651648353978
[09/26 06:59:20 visual_prompt]: Epoch 45 / 100: avg data time: 5.06e-02, avg batch time: 0.4957, average train loss: 0.1922
[09/26 06:59:22 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.1674, average loss: 0.3965
[09/26 06:59:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.00	
[09/26 06:59:22 visual_prompt]: Training 46 / 100 epoch, with learning rate 0.033550503583141725
[09/26 06:59:28 visual_prompt]: Epoch 46 / 100: avg data time: 5.81e-02, avg batch time: 0.5034, average train loss: 0.1431
[09/26 06:59:30 visual_prompt]: Inference (val):avg data time: 4.27e-05, avg batch time: 0.1678, average loss: 0.4626
[09/26 06:59:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.12	
[09/26 06:59:30 visual_prompt]: Training 47 / 100 epoch, with learning rate 0.032725424859373686
[09/26 06:59:37 visual_prompt]: Epoch 47 / 100: avg data time: 5.80e-02, avg batch time: 0.5019, average train loss: 0.1760
[09/26 06:59:38 visual_prompt]: Inference (val):avg data time: 3.09e-05, avg batch time: 0.1677, average loss: 0.4511
[09/26 06:59:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.82	
[09/26 06:59:38 visual_prompt]: Training 48 / 100 epoch, with learning rate 0.03189093389542498
[09/26 06:59:45 visual_prompt]: Epoch 48 / 100: avg data time: 5.91e-02, avg batch time: 0.5041, average train loss: 0.1906
[09/26 06:59:47 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1673, average loss: 0.4379
[09/26 06:59:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.21	
[09/26 06:59:47 visual_prompt]: Training 49 / 100 epoch, with learning rate 0.03104804738999169
[09/26 06:59:54 visual_prompt]: Epoch 49 / 100: avg data time: 6.01e-02, avg batch time: 0.5048, average train loss: 0.1683
[09/26 06:59:55 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1674, average loss: 0.4272
[09/26 06:59:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.97	
[09/26 06:59:55 visual_prompt]: Training 50 / 100 epoch, with learning rate 0.03019779227044398
[09/26 07:00:02 visual_prompt]: Epoch 50 / 100: avg data time: 5.73e-02, avg batch time: 0.5033, average train loss: 0.1372
[09/26 07:00:03 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1675, average loss: 0.5340
[09/26 07:00:03 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 81.50	rocauc: 93.17	
[09/26 07:00:03 visual_prompt]: Training 51 / 100 epoch, with learning rate 0.029341204441673263
[09/26 07:00:10 visual_prompt]: Epoch 51 / 100: avg data time: 5.90e-02, avg batch time: 0.5043, average train loss: 0.1352
[09/26 07:00:12 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.1671, average loss: 0.4532
[09/26 07:00:12 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 92.38	
[09/26 07:00:12 visual_prompt]: Training 52 / 100 epoch, with learning rate 0.028479327524001636
[09/26 07:00:19 visual_prompt]: Epoch 52 / 100: avg data time: 6.35e-02, avg batch time: 0.5071, average train loss: 0.1256
[09/26 07:00:20 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1675, average loss: 0.4041
[09/26 07:00:20 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.86	
[09/26 07:00:20 visual_prompt]: Training 53 / 100 epoch, with learning rate 0.02761321158169134
[09/26 07:00:27 visual_prompt]: Epoch 53 / 100: avg data time: 4.64e-02, avg batch time: 0.4916, average train loss: 0.1152
[09/26 07:00:28 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.1675, average loss: 0.4468
[09/26 07:00:28 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 93.30	
[09/26 07:00:28 visual_prompt]: Training 54 / 100 epoch, with learning rate 0.02674391184360313
[09/26 07:00:35 visual_prompt]: Epoch 54 / 100: avg data time: 5.71e-02, avg batch time: 0.5015, average train loss: 0.0922
[09/26 07:00:37 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1673, average loss: 0.5408
[09/26 07:00:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.74	
[09/26 07:00:37 visual_prompt]: Training 55 / 100 epoch, with learning rate 0.02587248741756253
[09/26 07:00:43 visual_prompt]: Epoch 55 / 100: avg data time: 4.21e-02, avg batch time: 0.4885, average train loss: 0.1105
[09/26 07:00:45 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1674, average loss: 0.7567
[09/26 07:00:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 93.05	
[09/26 07:00:45 visual_prompt]: Training 56 / 100 epoch, with learning rate 0.025
[09/26 07:00:51 visual_prompt]: Epoch 56 / 100: avg data time: 5.32e-02, avg batch time: 0.4990, average train loss: 0.1472
[09/26 07:00:53 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.1673, average loss: 0.3978
[09/26 07:00:53 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 94.08	
[09/26 07:00:53 visual_prompt]: Training 57 / 100 epoch, with learning rate 0.024127512582437484
[09/26 07:01:00 visual_prompt]: Epoch 57 / 100: avg data time: 5.54e-02, avg batch time: 0.4995, average train loss: 0.1180
[09/26 07:01:01 visual_prompt]: Inference (val):avg data time: 3.02e-05, avg batch time: 0.1675, average loss: 0.3905
[09/26 07:01:01 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 93.83	
[09/26 07:01:01 visual_prompt]: Training 58 / 100 epoch, with learning rate 0.02325608815639687
[09/26 07:01:08 visual_prompt]: Epoch 58 / 100: avg data time: 4.65e-02, avg batch time: 0.4937, average train loss: 0.0738
[09/26 07:01:09 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1675, average loss: 0.4767
[09/26 07:01:09 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.00	rocauc: 94.33	
[09/26 07:01:09 visual_prompt]: Best epoch 58: best metric: 0.880
[09/26 07:01:09 visual_prompt]: Training 59 / 100 epoch, with learning rate 0.02238678841830867
[09/26 07:01:16 visual_prompt]: Epoch 59 / 100: avg data time: 4.96e-02, avg batch time: 0.4954, average train loss: 0.0681
[09/26 07:01:18 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1675, average loss: 0.5115
[09/26 07:01:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.61	
[09/26 07:01:18 visual_prompt]: Training 60 / 100 epoch, with learning rate 0.02152067247599837
[09/26 07:01:24 visual_prompt]: Epoch 60 / 100: avg data time: 4.13e-02, avg batch time: 0.4896, average train loss: 0.0672
[09/26 07:01:26 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1676, average loss: 0.5935
[09/26 07:01:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 93.54	
[09/26 07:01:26 visual_prompt]: Training 61 / 100 epoch, with learning rate 0.020658795558326743
[09/26 07:01:33 visual_prompt]: Epoch 61 / 100: avg data time: 5.34e-02, avg batch time: 0.4986, average train loss: 0.0721
[09/26 07:01:34 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1674, average loss: 0.5725
[09/26 07:01:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.50	
[09/26 07:01:34 visual_prompt]: Training 62 / 100 epoch, with learning rate 0.019802207729556022
[09/26 07:01:41 visual_prompt]: Epoch 62 / 100: avg data time: 5.32e-02, avg batch time: 0.4985, average train loss: 0.0660
[09/26 07:01:42 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.1676, average loss: 0.5662
[09/26 07:01:42 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.34	
[09/26 07:01:42 visual_prompt]: Training 63 / 100 epoch, with learning rate 0.018951952610008312
[09/26 07:01:49 visual_prompt]: Epoch 63 / 100: avg data time: 5.39e-02, avg batch time: 0.4991, average train loss: 0.0646
[09/26 07:01:51 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1673, average loss: 0.5572
[09/26 07:01:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 93.26	
[09/26 07:01:51 visual_prompt]: Training 64 / 100 epoch, with learning rate 0.018109066104575022
[09/26 07:01:57 visual_prompt]: Epoch 64 / 100: avg data time: 5.05e-02, avg batch time: 0.4965, average train loss: 0.0575
[09/26 07:01:59 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1674, average loss: 0.7960
[09/26 07:01:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 80.00	rocauc: 88.65	
[09/26 07:01:59 visual_prompt]: Training 65 / 100 epoch, with learning rate 0.017274575140626316
[09/26 07:02:05 visual_prompt]: Epoch 65 / 100: avg data time: 4.36e-02, avg batch time: 0.4884, average train loss: 0.0785
[09/26 07:02:07 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.1674, average loss: 0.5522
[09/26 07:02:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.57	
[09/26 07:02:07 visual_prompt]: Training 66 / 100 epoch, with learning rate 0.016449496416858285
[09/26 07:02:13 visual_prompt]: Epoch 66 / 100: avg data time: 4.20e-02, avg batch time: 0.4891, average train loss: 0.0632
[09/26 07:02:15 visual_prompt]: Inference (val):avg data time: 2.79e-05, avg batch time: 0.1676, average loss: 0.5707
[09/26 07:02:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 93.49	
[09/26 07:02:15 visual_prompt]: Training 67 / 100 epoch, with learning rate 0.0156348351646022
[09/26 07:02:22 visual_prompt]: Epoch 67 / 100: avg data time: 4.98e-02, avg batch time: 0.4948, average train loss: 0.0380
[09/26 07:02:23 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.1674, average loss: 0.6204
[09/26 07:02:23 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.50	rocauc: 93.30	
[09/26 07:02:23 visual_prompt]: Training 68 / 100 epoch, with learning rate 0.014831583923105
[09/26 07:02:30 visual_prompt]: Epoch 68 / 100: avg data time: 5.25e-02, avg batch time: 0.4977, average train loss: 0.0411
[09/26 07:02:31 visual_prompt]: Inference (val):avg data time: 3.05e-05, avg batch time: 0.1676, average loss: 0.8691
[09/26 07:02:31 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 91.91	
[09/26 07:02:31 visual_prompt]: Training 69 / 100 epoch, with learning rate 0.014040721330273063
[09/26 07:02:38 visual_prompt]: Epoch 69 / 100: avg data time: 5.42e-02, avg batch time: 0.4991, average train loss: 0.0287
[09/26 07:02:40 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1675, average loss: 0.6848
[09/26 07:02:40 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 88.50	rocauc: 93.40	
[09/26 07:02:40 visual_prompt]: Best epoch 69: best metric: 0.885
[09/26 07:02:40 visual_prompt]: Training 70 / 100 epoch, with learning rate 0.013263210930352737
[09/26 07:02:46 visual_prompt]: Epoch 70 / 100: avg data time: 4.17e-02, avg batch time: 0.4872, average train loss: 0.0413
[09/26 07:02:48 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.1675, average loss: 0.7862
[09/26 07:02:48 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 92.08	
[09/26 07:02:48 visual_prompt]: Training 71 / 100 epoch, with learning rate 0.012500000000000006
[09/26 07:02:55 visual_prompt]: Epoch 71 / 100: avg data time: 4.82e-02, avg batch time: 0.4937, average train loss: 0.0405
[09/26 07:02:56 visual_prompt]: Inference (val):avg data time: 2.76e-05, avg batch time: 0.1677, average loss: 0.8714
[09/26 07:02:56 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.47	
[09/26 07:02:56 visual_prompt]: Training 72 / 100 epoch, with learning rate 0.01175201839416988
[09/26 07:03:03 visual_prompt]: Epoch 72 / 100: avg data time: 5.28e-02, avg batch time: 0.4967, average train loss: 0.0461
[09/26 07:03:04 visual_prompt]: Inference (val):avg data time: 3.65e-05, avg batch time: 0.1677, average loss: 0.6882
[09/26 07:03:04 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.85	
[09/26 07:03:04 visual_prompt]: Training 73 / 100 epoch, with learning rate 0.011020177413231334
[09/26 07:03:11 visual_prompt]: Epoch 73 / 100: avg data time: 4.82e-02, avg batch time: 0.4937, average train loss: 0.0306
[09/26 07:03:13 visual_prompt]: Inference (val):avg data time: 3.09e-05, avg batch time: 0.1675, average loss: 0.7857
[09/26 07:03:13 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 92.03	
[09/26 07:03:13 visual_prompt]: Training 74 / 100 epoch, with learning rate 0.010305368692688175
[09/26 07:03:19 visual_prompt]: Epoch 74 / 100: avg data time: 4.42e-02, avg batch time: 0.4896, average train loss: 0.0284
[09/26 07:03:21 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.1675, average loss: 0.7365
[09/26 07:03:21 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.60	
[09/26 07:03:21 visual_prompt]: Training 75 / 100 epoch, with learning rate 0.009608463116858543
[09/26 07:03:28 visual_prompt]: Epoch 75 / 100: avg data time: 6.13e-02, avg batch time: 0.5061, average train loss: 0.0227
[09/26 07:03:29 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1675, average loss: 0.7882
[09/26 07:03:29 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 91.73	
[09/26 07:03:29 visual_prompt]: Training 76 / 100 epoch, with learning rate 0.008930309757836517
[09/26 07:03:36 visual_prompt]: Epoch 76 / 100: avg data time: 5.33e-02, avg batch time: 0.4985, average train loss: 0.0168
[09/26 07:03:37 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1673, average loss: 0.7809
[09/26 07:03:37 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.67	
[09/26 07:03:37 visual_prompt]: Training 77 / 100 epoch, with learning rate 0.008271734841028553
[09/26 07:03:44 visual_prompt]: Epoch 77 / 100: avg data time: 5.06e-02, avg batch time: 0.4947, average train loss: 0.0217
[09/26 07:03:45 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1672, average loss: 0.8976
[09/26 07:03:45 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.44	
[09/26 07:03:45 visual_prompt]: Training 78 / 100 epoch, with learning rate 0.007633540738525066
[09/26 07:03:52 visual_prompt]: Epoch 78 / 100: avg data time: 5.25e-02, avg batch time: 0.4986, average train loss: 0.0172
[09/26 07:03:54 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1675, average loss: 1.0172
[09/26 07:03:54 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 91.81	
[09/26 07:03:54 visual_prompt]: Training 79 / 100 epoch, with learning rate 0.0070165049915337264
[09/26 07:04:00 visual_prompt]: Epoch 79 / 100: avg data time: 5.38e-02, avg batch time: 0.4981, average train loss: 0.0128
[09/26 07:04:02 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1675, average loss: 0.9774
[09/26 07:04:02 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.50	rocauc: 91.71	
[09/26 07:04:02 visual_prompt]: Training 80 / 100 epoch, with learning rate 0.006421379363065142
[09/26 07:04:08 visual_prompt]: Epoch 80 / 100: avg data time: 4.50e-02, avg batch time: 0.4906, average train loss: 0.0165
[09/26 07:04:10 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.1675, average loss: 1.0783
[09/26 07:04:10 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.32	
[09/26 07:04:10 visual_prompt]: Training 81 / 100 epoch, with learning rate 0.005848888922025553
[09/26 07:04:17 visual_prompt]: Epoch 81 / 100: avg data time: 4.86e-02, avg batch time: 0.4937, average train loss: 0.0090
[09/26 07:04:18 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.1675, average loss: 1.0561
[09/26 07:04:18 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 86.00	rocauc: 92.87	
[09/26 07:04:18 visual_prompt]: Training 82 / 100 epoch, with learning rate 0.005299731159831953
[09/26 07:04:25 visual_prompt]: Epoch 82 / 100: avg data time: 4.25e-02, avg batch time: 0.4864, average train loss: 0.0164
[09/26 07:04:26 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.1676, average loss: 1.2691
[09/26 07:04:26 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.06	
[09/26 07:04:26 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.004774575140626317
[09/26 07:04:33 visual_prompt]: Epoch 83 / 100: avg data time: 3.99e-02, avg batch time: 0.4860, average train loss: 0.0131
[09/26 07:04:34 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.1677, average loss: 1.2687
[09/26 07:04:34 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.34	
[09/26 07:04:34 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.004274060686123959
[09/26 07:04:41 visual_prompt]: Epoch 84 / 100: avg data time: 4.19e-02, avg batch time: 0.4923, average train loss: 0.0115
[09/26 07:04:43 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1678, average loss: 1.3769
[09/26 07:04:43 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.01	
[09/26 07:04:43 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.003798797596089351
[09/26 07:04:49 visual_prompt]: Epoch 85 / 100: avg data time: 4.89e-02, avg batch time: 0.4935, average train loss: 0.0113
[09/26 07:04:51 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.1672, average loss: 1.0423
[09/26 07:04:51 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.50	rocauc: 92.09	
[09/26 07:04:51 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.0033493649053890325
[09/26 07:04:57 visual_prompt]: Epoch 86 / 100: avg data time: 4.76e-02, avg batch time: 0.4930, average train loss: 0.0090
[09/26 07:04:59 visual_prompt]: Inference (val):avg data time: 3.27e-05, avg batch time: 0.1677, average loss: 1.2854
[09/26 07:04:59 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 91.94	
[09/26 07:04:59 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.0029263101785268254
[09/26 07:05:06 visual_prompt]: Epoch 87 / 100: avg data time: 5.29e-02, avg batch time: 0.4990, average train loss: 0.0086
[09/26 07:05:07 visual_prompt]: Inference (val):avg data time: 3.18e-05, avg batch time: 0.1679, average loss: 1.1449
[09/26 07:05:07 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 82.00	rocauc: 91.76	
[09/26 07:05:07 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.00253014884252083
[09/26 07:05:14 visual_prompt]: Epoch 88 / 100: avg data time: 5.06e-02, avg batch time: 0.4937, average train loss: 0.0066
[09/26 07:05:15 visual_prompt]: Inference (val):avg data time: 4.59e-05, avg batch time: 0.1675, average loss: 1.0473
[09/26 07:05:15 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.13	
[09/26 07:05:15 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.0021613635589349755
[09/26 07:05:22 visual_prompt]: Epoch 89 / 100: avg data time: 6.11e-02, avg batch time: 0.5046, average train loss: 0.0087
[09/26 07:05:24 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.1675, average loss: 1.4003
[09/26 07:05:24 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.39	
[09/26 07:05:24 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.0018204036358303172
[09/26 07:05:31 visual_prompt]: Epoch 90 / 100: avg data time: 5.88e-02, avg batch time: 0.5033, average train loss: 0.0131
[09/26 07:05:32 visual_prompt]: Inference (val):avg data time: 3.03e-05, avg batch time: 0.1673, average loss: 1.2538
[09/26 07:05:32 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.31	
[09/26 07:05:32 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.0015076844803522923
[09/26 07:05:39 visual_prompt]: Epoch 91 / 100: avg data time: 6.01e-02, avg batch time: 0.5060, average train loss: 0.0074
[09/26 07:05:41 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.1673, average loss: 1.1800
[09/26 07:05:41 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.00	rocauc: 92.17	
[09/26 07:05:41 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.0012235870926211618
[09/26 07:05:47 visual_prompt]: Epoch 92 / 100: avg data time: 4.58e-02, avg batch time: 0.4904, average train loss: 0.0102
[09/26 07:05:49 visual_prompt]: Inference (val):avg data time: 3.16e-05, avg batch time: 0.1675, average loss: 1.3078
[09/26 07:05:49 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.50	rocauc: 92.27	
[09/26 07:05:49 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.0009684576015420277
[09/26 07:05:55 visual_prompt]: Epoch 93 / 100: avg data time: 6.12e-02, avg batch time: 0.5053, average train loss: 0.0081
[09/26 07:05:57 visual_prompt]: Inference (val):avg data time: 2.97e-05, avg batch time: 0.1674, average loss: 1.3611
[09/26 07:05:57 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.28	
[09/26 07:05:57 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.0007426068431000883
[09/26 07:06:04 visual_prompt]: Epoch 94 / 100: avg data time: 6.03e-02, avg batch time: 0.5041, average train loss: 0.0084
[09/26 07:06:05 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.1677, average loss: 1.3323
[09/26 07:06:05 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 85.00	rocauc: 92.25	
[09/26 07:06:05 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.0005463099816548578
[09/26 07:06:12 visual_prompt]: Epoch 95 / 100: avg data time: 6.29e-02, avg batch time: 0.5061, average train loss: 0.0102
[09/26 07:06:14 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1673, average loss: 1.2672
[09/26 07:06:14 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 84.50	rocauc: 92.20	
[09/26 07:06:14 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.00037980617469479954
[09/26 07:06:20 visual_prompt]: Epoch 96 / 100: avg data time: 5.74e-02, avg batch time: 0.4999, average train loss: 0.0065
[09/26 07:06:22 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.1672, average loss: 1.1969
[09/26 07:06:22 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.95	
[09/26 07:06:22 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.00024329828146074097
[09/26 07:06:29 visual_prompt]: Epoch 97 / 100: avg data time: 5.69e-02, avg batch time: 0.5019, average train loss: 0.0070
[09/26 07:06:30 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1674, average loss: 1.1989
[09/26 07:06:30 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.92	
[09/26 07:06:30 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.00013695261579316776
[09/26 07:06:37 visual_prompt]: Epoch 98 / 100: avg data time: 5.29e-02, avg batch time: 0.4971, average train loss: 0.0042
[09/26 07:06:38 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.1675, average loss: 1.2019
[09/26 07:06:38 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.92	
[09/26 07:06:38 visual_prompt]: Training 99 / 100 epoch, with learning rate 6.089874350439506e-05
[09/26 07:06:45 visual_prompt]: Epoch 99 / 100: avg data time: 5.29e-02, avg batch time: 0.4981, average train loss: 0.0064
[09/26 07:06:47 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.1672, average loss: 1.2038
[09/26 07:06:47 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.92	
[09/26 07:06:47 visual_prompt]: Training 100 / 100 epoch, with learning rate 1.5229324522605948e-05
[09/26 07:06:53 visual_prompt]: Epoch 100 / 100: avg data time: 5.16e-02, avg batch time: 0.4972, average train loss: 0.0074
[09/26 07:06:55 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.1670, average loss: 1.2048
[09/26 07:06:55 visual_prompt]: Classification results with val_vtab-patch_camelyon: top1: 83.00	rocauc: 91.91	
Traceback (most recent call last):
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/tune_vtab.py", line 289, in <module>
    main(args)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/tune_vtab.py", line 284, in main
    train(cfg, args)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/tune_vtab.py", line 113, in train
    seed(cfg)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/tune_vtab.py", line 136, in seed
    torch.manual_seed(SEED)
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.11/site-packages/torch/random.py", line 36, in manual_seed
    seed = int(seed)
           ^^^^^^^^^
TypeError: int() argument must be a string, a bytes-like object or a real number, not 'tuple'
