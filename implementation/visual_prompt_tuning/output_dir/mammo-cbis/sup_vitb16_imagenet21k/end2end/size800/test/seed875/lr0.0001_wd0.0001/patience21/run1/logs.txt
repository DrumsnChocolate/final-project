[11/24 09:07:48][INFO] visual_prompt:   95: Rank of current process: 0. World size: 1
[11/24 09:07:48][INFO] visual_prompt:   97: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              2
GPU 0                NVIDIA A40
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[11/24 09:07:48][INFO] visual_prompt:   99: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/finetune/cub.yaml', train_type='finetune', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '4', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.IMGSIZE', '800', 'DATA.NAME', 'mammo-cbis', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROP', 'False', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir', 'SOLVER.PATIENCE', '21', 'SOLVER.CRITERION', 'loss'])
[11/24 09:07:48][INFO] visual_prompt:  101: Contents of args.config_file=visual_prompt_tuning/configs/finetune/cub.yaml:
_BASE_: "../base-finetune.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
  FEATURE: "imagenet_supervised"  # need to tune
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.00375
  WEIGHT_DECAY: 0.01

[11/24 09:07:48][INFO] visual_prompt:  108: Training with config:
[11/24 09:07:48][INFO] visual_prompt:  109: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/mammo-cbis/sup_vitb16_imagenet21k/end2end/size800/test/seed875/lr0.0001_wd0.0001/patience21/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 875, 'MODEL': CfgNode({'TRANSFER_TYPE': 'end2end', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'adamw', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 21, 'CRITERION': 'loss', 'SCHEDULER': 'cosine', 'BASE_LR': 0.0001, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 5, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'mammo-cbis', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'IMGSIZE': 800, 'CROP': False, 'NO_TEST': False, 'BATCH_SIZE': 4, 'NUM_WORKERS': 8, 'PIN_MEMORY': True})})
[11/24 09:07:48][INFO] visual_prompt:   55: Loading training data...
[11/24 09:07:48][INFO] visual_prompt:   28: Constructing mammo-cbis dataset train...
[11/24 09:07:48][INFO] visual_prompt:   57: Loading validation data...
[11/24 09:07:48][INFO] visual_prompt:   28: Constructing mammo-cbis dataset val...
[11/24 09:07:48][INFO] visual_prompt:   61: Loading test data...
[11/24 09:07:48][INFO] visual_prompt:   28: Constructing mammo-cbis dataset test...
[11/24 09:07:48][INFO] visual_prompt:   38: Constructing models...
[11/24 09:07:50][INFO] visual_prompt:  153: Enable all parameters update during training
[11/24 09:07:50][INFO] visual_prompt:   52: Total Parameters: 87569666	 Gradient Parameters: 87569666
[11/24 09:07:50][INFO] visual_prompt:   54: tuned percent:100.000
[11/24 09:07:50][INFO] visual_prompt:   40: Device used for model: 0
[11/24 09:07:50][INFO] visual_prompt:   40: Setting up Evaluator...
[11/24 09:07:50][INFO] visual_prompt:   42: Setting up Trainer...
[11/24 09:07:50][INFO] visual_prompt:   45: 	Setting up the optimizer...
[11/24 09:07:50][INFO] visual_prompt:  165: Training 1 / 100 epoch, with learning rate 0.0
[11/24 09:09:34][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.7594,	0.9448 s / batch. (data: 2.58e-04). ETA=14:29:14, max mem: 30.7 GB 
[11/24 09:11:07][INFO] visual_prompt:  204: 	Training 200/553. train loss: 1.2505,	0.9271 s / batch. (data: 2.46e-04). ETA=14:11:20, max mem: 30.7 GB 
[11/24 09:12:41][INFO] visual_prompt:  204: 	Training 300/553. train loss: 1.6675,	0.9237 s / batch. (data: 2.99e-04). ETA=14:06:42, max mem: 30.7 GB 
[11/24 09:14:14][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.8681,	0.9284 s / batch. (data: 2.66e-04). ETA=14:09:26, max mem: 30.7 GB 
[11/24 09:15:48][INFO] visual_prompt:  204: 	Training 500/553. train loss: 2.3298,	0.9319 s / batch. (data: 1.55e-02). ETA=14:11:07, max mem: 30.7 GB 
[11/24 09:16:37][INFO] visual_prompt:  217: Epoch 1 / 100: avg data time: 2.46e-02, avg batch time: 0.9529, average train loss: 1.8801
[11/24 09:17:32][INFO] visual_prompt:  316: Inference (val):avg data time: 2.87e-05, avg batch time: 0.3073, average loss: 2.2501
[11/24 09:17:32][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.01	
[11/24 09:19:05][INFO] visual_prompt:  303: 	Test 100/162. loss: 0.464, 0.3172 s / batch. (data: 3.27e-05)max mem: 30.66532 GB 
[11/24 09:19:51][INFO] visual_prompt:  316: Inference (test):avg data time: 1.19e-04, avg batch time: 0.3046, average loss: 2.4060
[11/24 09:19:51][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 49.30	rocauc: 48.51	
[11/24 09:19:51][INFO] visual_prompt:  165: Training 2 / 100 epoch, with learning rate 2e-05
[11/24 09:21:33][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.7237,	0.9395 s / batch. (data: 1.55e-02). ETA=14:15:38, max mem: 30.7 GB 
[11/24 09:23:06][INFO] visual_prompt:  204: 	Training 200/553. train loss: 0.5434,	0.9183 s / batch. (data: 7.99e-04). ETA=13:54:51, max mem: 30.7 GB 
[11/24 09:24:39][INFO] visual_prompt:  204: 	Training 300/553. train loss: 1.8921,	0.9271 s / batch. (data: 1.11e-02). ETA=14:01:18, max mem: 30.7 GB 
[11/24 09:26:13][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.6106,	0.9531 s / batch. (data: 2.80e-02). ETA=14:23:19, max mem: 30.7 GB 
[11/24 09:27:47][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.3141,	0.9235 s / batch. (data: 5.39e-03). ETA=13:54:55, max mem: 30.7 GB 
[11/24 09:28:36][INFO] visual_prompt:  217: Epoch 2 / 100: avg data time: 2.13e-02, avg batch time: 0.9494, average train loss: 0.8655
[11/24 09:29:31][INFO] visual_prompt:  316: Inference (val):avg data time: 3.03e-05, avg batch time: 0.3042, average loss: 0.6771
[11/24 09:29:31][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 62.60	rocauc: 63.48	
[11/24 09:31:05][INFO] visual_prompt:  303: 	Test 100/162. loss: 0.454, 0.3281 s / batch. (data: 2.98e-05)max mem: 30.66532 GB 
[11/24 09:31:51][INFO] visual_prompt:  316: Inference (test):avg data time: 3.10e-05, avg batch time: 0.3041, average loss: 0.7193
[11/24 09:31:51][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 56.43	rocauc: 59.41	
[11/24 09:31:51][INFO] visual_prompt:  165: Training 3 / 100 epoch, with learning rate 4e-05
[11/24 09:33:39][INFO] visual_prompt:  204: 	Training 100/553. train loss: 1.1044,	0.9172 s / batch. (data: 7.85e-04). ETA=13:46:52, max mem: 30.7 GB 
[11/24 09:35:12][INFO] visual_prompt:  204: 	Training 200/553. train loss: 1.3005,	0.9465 s / batch. (data: 5.38e-03). ETA=14:11:46, max mem: 30.7 GB 
[11/24 09:36:46][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.5329,	0.9343 s / batch. (data: 6.56e-03). ETA=13:59:15, max mem: 30.7 GB 
[11/24 09:38:19][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.8753,	0.9659 s / batch. (data: 2.79e-02). ETA=14:25:56, max mem: 30.7 GB 
[11/24 09:39:53][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.7587,	0.9145 s / batch. (data: 3.21e-04). ETA=13:38:23, max mem: 30.7 GB 
[11/24 09:40:42][INFO] visual_prompt:  217: Epoch 3 / 100: avg data time: 3.28e-02, avg batch time: 0.9600, average train loss: 0.7746
[11/24 09:41:37][INFO] visual_prompt:  316: Inference (val):avg data time: 2.89e-05, avg batch time: 0.3034, average loss: 0.6482
[11/24 09:41:37][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 59.35	rocauc: 67.26	
[11/24 09:43:10][INFO] visual_prompt:  303: 	Test 100/162. loss: 0.644, 0.3017 s / batch. (data: 3.15e-05)max mem: 30.66532 GB 
[11/24 09:43:56][INFO] visual_prompt:  316: Inference (test):avg data time: 3.04e-05, avg batch time: 0.3056, average loss: 0.6375
[11/24 09:43:56][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 63.26	rocauc: 64.15	
[11/24 09:43:56][INFO] visual_prompt:  165: Training 4 / 100 epoch, with learning rate 6e-05
[11/24 09:45:39][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.5178,	0.9346 s / batch. (data: 2.11e-04). ETA=13:53:58, max mem: 30.7 GB 
[11/24 09:47:12][INFO] visual_prompt:  204: 	Training 200/553. train loss: 1.3578,	0.9240 s / batch. (data: 2.64e-04). ETA=13:42:59, max mem: 30.7 GB 
[11/24 09:48:46][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.5756,	0.9655 s / batch. (data: 1.09e-02). ETA=14:18:20, max mem: 30.7 GB 
[11/24 09:50:19][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.5748,	0.9208 s / batch. (data: 2.82e-04). ETA=13:37:03, max mem: 30.7 GB 
[11/24 09:51:53][INFO] visual_prompt:  204: 	Training 500/553. train loss: 1.3852,	0.9396 s / batch. (data: 7.67e-04). ETA=13:52:11, max mem: 30.7 GB 
[11/24 09:52:43][INFO] visual_prompt:  217: Epoch 4 / 100: avg data time: 2.10e-02, avg batch time: 0.9510, average train loss: 0.7298
[11/24 09:53:38][INFO] visual_prompt:  316: Inference (val):avg data time: 2.87e-05, avg batch time: 0.3062, average loss: 0.6357
[11/24 09:53:38][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 65.85	rocauc: 67.08	
[11/24 09:55:10][INFO] visual_prompt:  303: 	Test 100/162. loss: 0.536, 0.2946 s / batch. (data: 3.24e-05)max mem: 30.66532 GB 
[11/24 09:55:57][INFO] visual_prompt:  316: Inference (test):avg data time: 6.61e-05, avg batch time: 0.3053, average loss: 0.6556
[11/24 09:55:57][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 62.79	rocauc: 65.02	
[11/24 09:55:57][INFO] visual_prompt:  165: Training 5 / 100 epoch, with learning rate 8e-05
[11/24 09:57:42][INFO] visual_prompt:  204: 	Training 100/553. train loss: 1.0224,	0.9234 s / batch. (data: 1.55e-02). ETA=13:35:28, max mem: 30.7 GB 
[11/24 09:59:16][INFO] visual_prompt:  204: 	Training 200/553. train loss: 0.5661,	0.9426 s / batch. (data: 1.97e-02). ETA=13:50:53, max mem: 30.7 GB 
[11/24 10:00:49][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.0890,	0.9359 s / batch. (data: 2.67e-04). ETA=13:43:22, max mem: 30.7 GB 
[11/24 10:02:23][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.5450,	0.9720 s / batch. (data: 7.55e-04). ETA=14:13:31, max mem: 30.7 GB 
[11/24 10:03:56][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.7077,	0.9113 s / batch. (data: 2.56e-04). ETA=13:18:44, max mem: 30.7 GB 
[11/24 10:04:46][INFO] visual_prompt:  217: Epoch 5 / 100: avg data time: 2.79e-02, avg batch time: 0.9557, average train loss: 0.7426
[11/24 10:05:40][INFO] visual_prompt:  316: Inference (val):avg data time: 8.44e-05, avg batch time: 0.3064, average loss: 0.6637
[11/24 10:05:40][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 60.57	rocauc: 68.40	
[11/24 10:07:12][INFO] visual_prompt:  303: 	Test 100/162. loss: 0.648, 0.2945 s / batch. (data: 6.10e-05)max mem: 30.66532 GB 
[11/24 10:07:58][INFO] visual_prompt:  316: Inference (test):avg data time: 3.12e-05, avg batch time: 0.3068, average loss: 0.6309
[11/24 10:07:58][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 62.79	rocauc: 67.68	
[11/24 10:07:58][INFO] visual_prompt:  165: Training 6 / 100 epoch, with learning rate 0.0001
[11/24 10:09:40][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.5812,	0.9429 s / batch. (data: 1.83e-02). ETA=13:43:58, max mem: 30.7 GB 
[11/24 10:11:14][INFO] visual_prompt:  204: 	Training 200/553. train loss: 0.4160,	0.9202 s / batch. (data: 1.04e-02). ETA=13:22:36, max mem: 30.7 GB 
[11/24 10:12:47][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.5871,	0.9360 s / batch. (data: 2.58e-04). ETA=13:34:54, max mem: 30.7 GB 
[11/24 10:14:21][INFO] visual_prompt:  204: 	Training 400/553. train loss: 1.1414,	0.9227 s / batch. (data: 2.98e-04). ETA=13:21:43, max mem: 30.7 GB 
[11/24 10:15:55][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.5884,	0.9259 s / batch. (data: 3.99e-03). ETA=13:22:58, max mem: 30.7 GB 
[11/24 10:16:44][INFO] visual_prompt:  217: Epoch 6 / 100: avg data time: 2.14e-02, avg batch time: 0.9497, average train loss: 0.6957
[11/24 10:17:38][INFO] visual_prompt:  316: Inference (val):avg data time: 1.47e-04, avg batch time: 0.3064, average loss: 0.6004
[11/24 10:17:38][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 67.07	rocauc: 74.76	
[11/24 10:19:11][INFO] visual_prompt:  303: 	Test 100/162. loss: 0.576, 0.3124 s / batch. (data: 3.03e-05)max mem: 30.66532 GB 
[11/24 10:19:56][INFO] visual_prompt:  316: Inference (test):avg data time: 3.22e-05, avg batch time: 0.3048, average loss: 0.6211
[11/24 10:19:56][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 64.65	rocauc: 69.32	
[11/24 10:19:56][INFO] visual_prompt:  165: Training 7 / 100 epoch, with learning rate 9.997266286704631e-05
[11/24 10:21:38][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.5012,	0.9310 s / batch. (data: 5.40e-03). ETA=13:25:04, max mem: 30.7 GB 
[11/24 10:23:11][INFO] visual_prompt:  204: 	Training 200/553. train loss: 0.8132,	0.9503 s / batch. (data: 7.31e-04). ETA=13:40:08, max mem: 30.7 GB 
[11/24 10:24:45][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.8412,	0.9199 s / batch. (data: 7.39e-04). ETA=13:12:20, max mem: 30.7 GB 
[11/24 10:26:18][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.5109,	0.9539 s / batch. (data: 5.88e-03). ETA=13:40:05, max mem: 30.7 GB 
[11/24 10:27:52][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.9293,	0.9329 s / batch. (data: 1.42e-02). ETA=13:20:29, max mem: 30.7 GB 
[11/24 10:28:41][INFO] visual_prompt:  217: Epoch 7 / 100: avg data time: 2.17e-02, avg batch time: 0.9488, average train loss: 0.6626
[11/24 10:29:36][INFO] visual_prompt:  316: Inference (val):avg data time: 2.85e-05, avg batch time: 0.3060, average loss: 0.7452
[11/24 10:29:36][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 54.47	rocauc: 74.27	
[11/24 10:31:08][INFO] visual_prompt:  303: 	Test 100/162. loss: 0.834, 0.2957 s / batch. (data: 4.01e-05)max mem: 30.66532 GB 
[11/24 10:31:54][INFO] visual_prompt:  316: Inference (test):avg data time: 7.75e-05, avg batch time: 0.3046, average loss: 0.8758
[11/24 10:31:54][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 46.05	rocauc: 70.04	
[11/24 10:31:54][INFO] visual_prompt:  165: Training 8 / 100 epoch, with learning rate 9.989068136093873e-05
[11/24 10:33:38][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.7651,	0.9648 s / batch. (data: 1.09e-02). ETA=13:45:20, max mem: 30.7 GB 
[11/24 10:35:11][INFO] visual_prompt:  204: 	Training 200/553. train loss: 1.3167,	0.9223 s / batch. (data: 5.34e-03). ETA=13:07:26, max mem: 30.7 GB 
[11/24 10:36:44][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.8135,	0.9328 s / batch. (data: 2.67e-04). ETA=13:14:53, max mem: 30.7 GB 
[11/24 10:38:18][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.4510,	0.9233 s / batch. (data: 1.44e-02). ETA=13:05:12, max mem: 30.7 GB 
[11/24 10:39:51][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.6356,	0.9259 s / batch. (data: 5.39e-03). ETA=13:05:56, max mem: 30.7 GB 
[11/24 10:40:41][INFO] visual_prompt:  217: Epoch 8 / 100: avg data time: 2.46e-02, avg batch time: 0.9517, average train loss: 0.6602
[11/24 10:41:35][INFO] visual_prompt:  316: Inference (val):avg data time: 1.32e-04, avg batch time: 0.3084, average loss: 0.6764
[11/24 10:41:35][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 63.82	rocauc: 72.64	
[11/24 10:43:07][INFO] visual_prompt:  303: 	Test 100/162. loss: 0.661, 0.2947 s / batch. (data: 4.27e-05)max mem: 30.66532 GB 
[11/24 10:43:53][INFO] visual_prompt:  316: Inference (test):avg data time: 3.13e-05, avg batch time: 0.3059, average loss: 0.6868
[11/24 10:43:53][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 61.24	rocauc: 65.13	
[11/24 10:43:53][INFO] visual_prompt:  165: Training 9 / 100 epoch, with learning rate 9.975414512725057e-05
[11/24 10:45:38][INFO] visual_prompt:  204: 	Training 100/553. train loss: 1.5860,	0.9291 s / batch. (data: 5.37e-03). ETA=13:06:16, max mem: 30.7 GB 
[11/24 10:47:11][INFO] visual_prompt:  204: 	Training 200/553. train loss: 0.7147,	0.9251 s / batch. (data: 7.26e-04). ETA=13:01:18, max mem: 30.7 GB 
[11/24 10:48:45][INFO] visual_prompt:  204: 	Training 300/553. train loss: 1.0297,	0.9237 s / batch. (data: 7.51e-04). ETA=12:58:38, max mem: 30.7 GB 
[11/24 10:50:18][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.4326,	0.9169 s / batch. (data: 9.44e-03). ETA=12:51:20, max mem: 30.7 GB 
[11/24 10:51:52][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.5943,	0.9162 s / batch. (data: 2.57e-04). ETA=12:49:14, max mem: 30.7 GB 
[11/24 10:52:41][INFO] visual_prompt:  217: Epoch 9 / 100: avg data time: 2.77e-02, avg batch time: 0.9535, average train loss: 0.6592
[11/24 10:53:35][INFO] visual_prompt:  316: Inference (val):avg data time: 1.47e-04, avg batch time: 0.3068, average loss: 0.7498
[11/24 10:53:35][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 58.54	rocauc: 71.20	
[11/24 10:55:07][INFO] visual_prompt:  303: 	Test 100/162. loss: 0.696, 0.2947 s / batch. (data: 5.15e-05)max mem: 30.66532 GB 
[11/24 10:55:53][INFO] visual_prompt:  316: Inference (test):avg data time: 3.17e-05, avg batch time: 0.3060, average loss: 0.7117
[11/24 10:55:53][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 61.09	rocauc: 68.08	
[11/24 10:55:53][INFO] visual_prompt:  165: Training 10 / 100 epoch, with learning rate 9.956320346634876e-05
[11/24 10:57:36][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.7398,	0.9399 s / batch. (data: 4.17e-04). ETA=13:06:45, max mem: 30.7 GB 
[11/24 10:59:10][INFO] visual_prompt:  204: 	Training 200/553. train loss: 0.4476,	0.9324 s / batch. (data: 1.23e-02). ETA=12:58:52, max mem: 30.7 GB 
[11/24 11:00:43][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.2307,	0.9316 s / batch. (data: 2.64e-04). ETA=12:56:40, max mem: 30.7 GB 
[11/24 11:02:17][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.8411,	0.9217 s / batch. (data: 5.38e-03). ETA=12:46:54, max mem: 30.7 GB 
[11/24 11:03:50][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.4581,	0.9443 s / batch. (data: 7.14e-04). ETA=13:04:06, max mem: 30.7 GB 
[11/24 11:04:39][INFO] visual_prompt:  217: Epoch 10 / 100: avg data time: 2.31e-02, avg batch time: 0.9510, average train loss: 0.6129
[11/24 11:05:34][INFO] visual_prompt:  316: Inference (val):avg data time: 3.02e-05, avg batch time: 0.3051, average loss: 0.6210
[11/24 11:05:34][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 65.85	rocauc: 71.56	
[11/24 11:07:07][INFO] visual_prompt:  303: 	Test 100/162. loss: 0.565, 0.2948 s / batch. (data: 3.19e-05)max mem: 30.66532 GB 
[11/24 11:07:53][INFO] visual_prompt:  316: Inference (test):avg data time: 3.07e-05, avg batch time: 0.3067, average loss: 0.6619
[11/24 11:07:53][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 63.41	rocauc: 66.94	
[11/24 11:07:53][INFO] visual_prompt:  165: Training 11 / 100 epoch, with learning rate 9.931806517013612e-05
[11/24 11:09:35][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.5597,	0.9415 s / batch. (data: 5.82e-03). ETA=12:59:24, max mem: 30.7 GB 
[11/24 11:11:08][INFO] visual_prompt:  204: 	Training 200/553. train loss: 1.2874,	0.9259 s / batch. (data: 2.40e-04). ETA=12:44:57, max mem: 30.7 GB 
[11/24 11:12:42][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.2569,	0.9412 s / batch. (data: 7.39e-04). ETA=12:56:02, max mem: 30.7 GB 
[11/24 11:14:15][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.4382,	0.9372 s / batch. (data: 2.43e-04). ETA=12:51:11, max mem: 30.7 GB 
[11/24 11:15:49][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.8125,	0.9420 s / batch. (data: 5.81e-03). ETA=12:53:33, max mem: 30.7 GB 
[11/24 11:16:38][INFO] visual_prompt:  217: Epoch 11 / 100: avg data time: 2.14e-02, avg batch time: 0.9500, average train loss: 0.5940
[11/24 11:17:33][INFO] visual_prompt:  316: Inference (val):avg data time: 2.83e-05, avg batch time: 0.3056, average loss: 0.6491
[11/24 11:17:33][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 61.79	rocauc: 68.50	
[11/24 11:19:05][INFO] visual_prompt:  303: 	Test 100/162. loss: 0.623, 0.3138 s / batch. (data: 4.32e-05)max mem: 30.66532 GB 
[11/24 11:19:51][INFO] visual_prompt:  316: Inference (test):avg data time: 3.18e-05, avg batch time: 0.3056, average loss: 0.6860
[11/24 11:19:51][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 58.91	rocauc: 65.80	
[11/24 11:19:51][INFO] visual_prompt:  165: Training 12 / 100 epoch, with learning rate 9.901899829374047e-05
[11/24 11:21:31][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.1930,	0.9480 s / batch. (data: 3.37e-04). ETA=12:56:01, max mem: 30.7 GB 
[11/24 11:23:05][INFO] visual_prompt:  204: 	Training 200/553. train loss: 0.6062,	0.9296 s / batch. (data: 2.49e-04). ETA=12:39:27, max mem: 30.7 GB 
[11/24 11:24:38][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.6999,	0.9294 s / batch. (data: 1.05e-02). ETA=12:37:42, max mem: 30.7 GB 
[11/24 11:26:12][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.3693,	0.9560 s / batch. (data: 2.83e-04). ETA=12:57:48, max mem: 30.7 GB 
[11/24 11:27:46][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.8497,	0.9131 s / batch. (data: 5.38e-03). ETA=12:21:23, max mem: 30.7 GB 
[11/24 11:28:35][INFO] visual_prompt:  217: Epoch 12 / 100: avg data time: 1.86e-02, avg batch time: 0.9483, average train loss: 0.5933
[11/24 11:29:32][INFO] visual_prompt:  316: Inference (val):avg data time: 1.47e-04, avg batch time: 0.3038, average loss: 0.6596
[11/24 11:29:32][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 60.57	rocauc: 68.35	
[11/24 11:31:09][INFO] visual_prompt:  303: 	Test 100/162. loss: 1.016, 0.3360 s / batch. (data: 9.56e-05)max mem: 30.66532 GB 
[11/24 11:31:57][INFO] visual_prompt:  316: Inference (test):avg data time: 3.63e-05, avg batch time: 0.3052, average loss: 0.6433
[11/24 11:31:57][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 64.96	rocauc: 66.48	
[11/24 11:31:57][INFO] visual_prompt:  165: Training 13 / 100 epoch, with learning rate 9.86663298624003e-05
[11/24 11:33:42][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.4868,	0.9262 s / batch. (data: 2.75e-04). ETA=12:29:40, max mem: 30.7 GB 
[11/24 11:35:15][INFO] visual_prompt:  204: 	Training 200/553. train loss: 0.3324,	0.9146 s / batch. (data: 2.60e-04). ETA=12:18:46, max mem: 30.7 GB 
[11/24 11:36:49][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.7280,	0.9212 s / batch. (data: 2.73e-04). ETA=12:22:35, max mem: 30.7 GB 
[11/24 11:38:22][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.9791,	0.9480 s / batch. (data: 1.02e-03). ETA=12:42:32, max mem: 30.7 GB 
[11/24 11:39:56][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.4276,	0.9310 s / batch. (data: 7.97e-04). ETA=12:27:22, max mem: 30.7 GB 
[11/24 11:40:45][INFO] visual_prompt:  217: Epoch 13 / 100: avg data time: 2.63e-02, avg batch time: 0.9542, average train loss: 0.5730
[11/24 11:41:40][INFO] visual_prompt:  316: Inference (val):avg data time: 3.83e-04, avg batch time: 0.3066, average loss: 0.6934
[11/24 11:41:40][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 62.20	rocauc: 64.41	
[11/24 11:43:12][INFO] visual_prompt:  303: 	Test 100/162. loss: 0.500, 0.2991 s / batch. (data: 3.74e-05)max mem: 30.66532 GB 
[11/24 11:43:59][INFO] visual_prompt:  316: Inference (test):avg data time: 1.62e-04, avg batch time: 0.3061, average loss: 0.6582
[11/24 11:43:59][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 64.65	rocauc: 68.29	
[11/24 11:43:59][INFO] visual_prompt:  165: Training 14 / 100 epoch, with learning rate 9.826044551386744e-05
[11/24 11:45:42][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.1816,	0.9221 s / batch. (data: 7.50e-04). ETA=12:17:50, max mem: 30.7 GB 
[11/24 11:47:15][INFO] visual_prompt:  204: 	Training 200/553. train loss: 0.2033,	0.9405 s / batch. (data: 1.09e-02). ETA=12:31:02, max mem: 30.7 GB 
[11/24 11:48:49][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.7907,	0.9382 s / batch. (data: 2.43e-02). ETA=12:27:37, max mem: 30.7 GB 
[11/24 11:50:22][INFO] visual_prompt:  204: 	Training 400/553. train loss: 1.0723,	0.9382 s / batch. (data: 6.99e-04). ETA=12:26:00, max mem: 30.7 GB 
[11/24 11:51:56][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.5031,	0.9615 s / batch. (data: 5.82e-03). ETA=12:42:59, max mem: 30.7 GB 
[11/24 11:52:46][INFO] visual_prompt:  217: Epoch 14 / 100: avg data time: 2.33e-02, avg batch time: 0.9523, average train loss: 0.5275
[11/24 11:53:41][INFO] visual_prompt:  316: Inference (val):avg data time: 3.02e-05, avg batch time: 0.3054, average loss: 0.7516
[11/24 11:53:41][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 65.85	rocauc: 70.49	
[11/24 11:55:17][INFO] visual_prompt:  303: 	Test 100/162. loss: 1.208, 0.2940 s / batch. (data: 3.27e-05)max mem: 30.66532 GB 
[11/24 11:56:05][INFO] visual_prompt:  316: Inference (test):avg data time: 1.72e-04, avg batch time: 0.3038, average loss: 0.7666
[11/24 11:56:05][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 63.41	rocauc: 65.41	
[11/24 11:56:05][INFO] visual_prompt:  165: Training 15 / 100 epoch, with learning rate 9.780178907671789e-05
[11/24 11:57:50][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.3695,	0.9159 s / batch. (data: 2.45e-04). ETA=12:04:26, max mem: 30.7 GB 
[11/24 11:59:24][INFO] visual_prompt:  204: 	Training 200/553. train loss: 0.1944,	0.9472 s / batch. (data: 2.48e-04). ETA=12:27:36, max mem: 30.7 GB 
[11/24 12:00:57][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.3285,	0.9209 s / batch. (data: 1.09e-02). ETA=12:05:19, max mem: 30.7 GB 
[11/24 12:02:31][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.7595,	0.9685 s / batch. (data: 1.61e-02). ETA=12:41:10, max mem: 30.7 GB 
[11/24 12:04:05][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.5264,	0.9360 s / batch. (data: 2.76e-04). ETA=12:14:06, max mem: 30.7 GB 
[11/24 12:04:54][INFO] visual_prompt:  217: Epoch 15 / 100: avg data time: 2.80e-02, avg batch time: 0.9560, average train loss: 0.5052
[11/24 12:05:49][INFO] visual_prompt:  316: Inference (val):avg data time: 3.91e-04, avg batch time: 0.3050, average loss: 0.8788
[11/24 12:05:49][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 60.57	rocauc: 66.44	
[11/24 12:07:22][INFO] visual_prompt:  303: 	Test 100/162. loss: 0.732, 0.3081 s / batch. (data: 3.74e-05)max mem: 30.66532 GB 
[11/24 12:08:08][INFO] visual_prompt:  316: Inference (test):avg data time: 7.67e-05, avg batch time: 0.3031, average loss: 1.0301
[11/24 12:08:08][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 55.97	rocauc: 64.12	
[11/24 12:08:08][INFO] visual_prompt:  165: Training 16 / 100 epoch, with learning rate 9.729086208503174e-05
[11/24 12:09:50][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.4383,	0.9340 s / batch. (data: 5.34e-03). ETA=12:10:09, max mem: 30.7 GB 
[11/24 12:11:24][INFO] visual_prompt:  204: 	Training 200/553. train loss: 0.2102,	0.9425 s / batch. (data: 2.67e-04). ETA=12:15:14, max mem: 30.7 GB 
[11/24 12:12:57][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.4587,	0.9280 s / batch. (data: 7.75e-04). ETA=12:02:20, max mem: 30.7 GB 
[11/24 12:14:31][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.3234,	0.9136 s / batch. (data: 7.65e-04). ETA=11:49:38, max mem: 30.7 GB 
[11/24 12:16:05][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.3443,	0.9195 s / batch. (data: 2.67e-04). ETA=11:52:41, max mem: 30.7 GB 
[11/24 12:16:54][INFO] visual_prompt:  217: Epoch 16 / 100: avg data time: 2.36e-02, avg batch time: 0.9515, average train loss: 0.4938
[11/24 12:17:51][INFO] visual_prompt:  316: Inference (val):avg data time: 3.02e-05, avg batch time: 0.3051, average loss: 0.7491
[11/24 12:17:51][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 57.72	rocauc: 65.52	
[11/24 12:19:28][INFO] visual_prompt:  303: 	Test 100/162. loss: 0.890, 0.2940 s / batch. (data: 5.82e-05)max mem: 30.66532 GB 
[11/24 12:20:15][INFO] visual_prompt:  316: Inference (test):avg data time: 1.25e-04, avg batch time: 0.3039, average loss: 0.7956
[11/24 12:20:15][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 60.47	rocauc: 65.76	
[11/24 12:20:15][INFO] visual_prompt:  165: Training 17 / 100 epoch, with learning rate 9.672822322997305e-05
[11/24 12:22:01][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.1345,	0.9301 s / batch. (data: 2.64e-04). ETA=11:58:30, max mem: 30.7 GB 
[11/24 12:23:34][INFO] visual_prompt:  204: 	Training 200/553. train loss: 0.6868,	0.9205 s / batch. (data: 5.34e-03). ETA=11:49:34, max mem: 30.7 GB 
[11/24 12:25:08][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.2172,	0.9233 s / batch. (data: 2.48e-04). ETA=11:50:11, max mem: 30.7 GB 
[11/24 12:26:42][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.8169,	0.9379 s / batch. (data: 7.40e-04). ETA=11:59:50, max mem: 30.7 GB 
[11/24 12:28:15][INFO] visual_prompt:  204: 	Training 500/553. train loss: 1.4272,	0.9230 s / batch. (data: 2.66e-04). ETA=11:46:53, max mem: 30.7 GB 
[11/24 12:29:04][INFO] visual_prompt:  217: Epoch 17 / 100: avg data time: 2.73e-02, avg batch time: 0.9565, average train loss: 0.4371
[11/24 12:29:59][INFO] visual_prompt:  316: Inference (val):avg data time: 2.93e-05, avg batch time: 0.3055, average loss: 0.7632
[11/24 12:29:59][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 60.57	rocauc: 65.04	
[11/24 12:31:32][INFO] visual_prompt:  303: 	Test 100/162. loss: 1.179, 0.2943 s / batch. (data: 4.46e-05)max mem: 30.66532 GB 
[11/24 12:32:18][INFO] visual_prompt:  316: Inference (test):avg data time: 7.09e-05, avg batch time: 0.3034, average loss: 0.8219
[11/24 12:32:18][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 60.62	rocauc: 65.46	
[11/24 12:32:18][INFO] visual_prompt:  165: Training 18 / 100 epoch, with learning rate 9.611448774886924e-05
[11/24 12:34:00][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.3766,	0.9602 s / batch. (data: 9.66e-03). ETA=12:12:56, max mem: 30.7 GB 
[11/24 12:35:33][INFO] visual_prompt:  204: 	Training 200/553. train loss: 0.3697,	0.9445 s / batch. (data: 7.21e-04). ETA=11:59:24, max mem: 30.7 GB 
[11/24 12:37:07][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.1260,	0.9563 s / batch. (data: 2.23e-02). ETA=12:06:46, max mem: 30.7 GB 
[11/24 12:38:41][INFO] visual_prompt:  204: 	Training 400/553. train loss: 1.0186,	0.9270 s / batch. (data: 5.35e-03). ETA=11:42:56, max mem: 30.7 GB 
[11/24 12:40:14][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.1165,	0.9678 s / batch. (data: 3.71e-02). ETA=12:12:16, max mem: 30.7 GB 
[11/24 12:41:04][INFO] visual_prompt:  217: Epoch 18 / 100: avg data time: 2.21e-02, avg batch time: 0.9508, average train loss: 0.3963
[11/24 12:41:59][INFO] visual_prompt:  316: Inference (val):avg data time: 3.83e-04, avg batch time: 0.3059, average loss: 0.8144
[11/24 12:41:59][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 58.94	rocauc: 64.16	
[11/24 12:43:31][INFO] visual_prompt:  303: 	Test 100/162. loss: 1.026, 0.3087 s / batch. (data: 6.63e-05)max mem: 30.66532 GB 
[11/24 12:44:17][INFO] visual_prompt:  316: Inference (test):avg data time: 7.67e-05, avg batch time: 0.3065, average loss: 0.8903
[11/24 12:44:17][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 56.59	rocauc: 63.15	
[11/24 12:44:17][INFO] visual_prompt:  165: Training 19 / 100 epoch, with learning rate 9.545032675245813e-05
[11/24 12:45:59][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.5684,	0.9426 s / batch. (data: 8.29e-03). ETA=11:50:48, max mem: 30.7 GB 
[11/24 12:47:32][INFO] visual_prompt:  204: 	Training 200/553. train loss: 0.0884,	0.9312 s / batch. (data: 5.42e-03). ETA=11:40:40, max mem: 30.7 GB 
[11/24 12:49:07][INFO] visual_prompt:  204: 	Training 300/553. train loss: 1.0476,	0.9440 s / batch. (data: 2.90e-04). ETA=11:48:43, max mem: 30.7 GB 
[11/24 12:50:40][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.5436,	0.9493 s / batch. (data: 6.81e-04). ETA=11:51:05, max mem: 30.7 GB 
[11/24 12:52:14][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.1840,	0.9357 s / batch. (data: 5.40e-03). ETA=11:39:23, max mem: 30.7 GB 
[11/24 12:53:04][INFO] visual_prompt:  217: Epoch 19 / 100: avg data time: 2.12e-02, avg batch time: 0.9515, average train loss: 0.3679
[11/24 12:54:01][INFO] visual_prompt:  316: Inference (val):avg data time: 1.48e-04, avg batch time: 0.3039, average loss: 0.8509
[11/24 12:54:01][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 62.60	rocauc: 68.90	
[11/24 12:55:37][INFO] visual_prompt:  303: 	Test 100/162. loss: 0.887, 0.3081 s / batch. (data: 4.03e-05)max mem: 30.66532 GB 
[11/24 12:56:24][INFO] visual_prompt:  316: Inference (test):avg data time: 1.22e-04, avg batch time: 0.3047, average loss: 0.9409
[11/24 12:56:24][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 63.88	rocauc: 65.79	
[11/24 12:56:24][INFO] visual_prompt:  165: Training 20 / 100 epoch, with learning rate 9.473646649103818e-05
[11/24 12:58:07][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.4614,	0.9413 s / batch. (data: 2.53e-04). ETA=11:41:11, max mem: 30.7 GB 
[11/24 12:59:40][INFO] visual_prompt:  204: 	Training 200/553. train loss: 0.0686,	0.9498 s / batch. (data: 7.19e-04). ETA=11:45:52, max mem: 30.7 GB 
[11/24 13:01:14][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.2962,	0.9400 s / batch. (data: 4.29e-04). ETA=11:37:02, max mem: 30.7 GB 
[11/24 13:02:48][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.0821,	0.9154 s / batch. (data: 2.49e-04). ETA=11:17:17, max mem: 30.7 GB 
[11/24 13:04:22][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.0936,	0.9416 s / batch. (data: 7.72e-04). ETA=11:35:08, max mem: 30.7 GB 
[11/24 13:05:11][INFO] visual_prompt:  217: Epoch 20 / 100: avg data time: 2.17e-02, avg batch time: 0.9523, average train loss: 0.3360
[11/24 13:06:06][INFO] visual_prompt:  316: Inference (val):avg data time: 3.74e-04, avg batch time: 0.3050, average loss: 1.0802
[11/24 13:06:06][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 58.13	rocauc: 64.50	
[11/24 13:07:41][INFO] visual_prompt:  303: 	Test 100/162. loss: 1.615, 0.2941 s / batch. (data: 5.79e-05)max mem: 30.66532 GB 
[11/24 13:08:27][INFO] visual_prompt:  316: Inference (test):avg data time: 6.96e-05, avg batch time: 0.3044, average loss: 0.9613
[11/24 13:08:27][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 63.88	rocauc: 66.12	
[11/24 13:08:27][INFO] visual_prompt:  165: Training 21 / 100 epoch, with learning rate 9.397368756032445e-05
[11/24 13:10:10][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.8414,	0.9168 s / batch. (data: 5.34e-03). ETA=11:14:29, max mem: 30.7 GB 
[11/24 13:11:44][INFO] visual_prompt:  204: 	Training 200/553. train loss: 0.7258,	0.9466 s / batch. (data: 1.32e-02). ETA=11:34:48, max mem: 30.7 GB 
[11/24 13:13:17][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.6676,	0.9279 s / batch. (data: 2.42e-04). ETA=11:19:31, max mem: 30.7 GB 
[11/24 13:14:50][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.0518,	0.9354 s / batch. (data: 7.06e-04). ETA=11:23:27, max mem: 30.7 GB 
[11/24 13:16:23][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.3943,	0.9504 s / batch. (data: 7.88e-04). ETA=11:32:48, max mem: 30.7 GB 
[11/24 13:17:13][INFO] visual_prompt:  217: Epoch 21 / 100: avg data time: 2.23e-02, avg batch time: 0.9501, average train loss: 0.3108
[11/24 13:18:08][INFO] visual_prompt:  316: Inference (val):avg data time: 1.47e-04, avg batch time: 0.3071, average loss: 0.9910
[11/24 13:18:08][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 65.04	rocauc: 66.54	
[11/24 13:19:40][INFO] visual_prompt:  303: 	Test 100/162. loss: 1.147, 0.3108 s / batch. (data: 3.03e-05)max mem: 30.66532 GB 
[11/24 13:20:26][INFO] visual_prompt:  316: Inference (test):avg data time: 7.41e-05, avg batch time: 0.3069, average loss: 0.9471
[11/24 13:20:26][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 63.72	rocauc: 66.75	
[11/24 13:20:26][INFO] visual_prompt:  165: Training 22 / 100 epoch, with learning rate 9.316282404787871e-05
[11/24 13:22:08][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.0062,	0.9509 s / batch. (data: 1.51e-02). ETA=11:30:44, max mem: 30.7 GB 
[11/24 13:23:41][INFO] visual_prompt:  204: 	Training 200/553. train loss: 0.0930,	0.9233 s / batch. (data: 5.35e-03). ETA=11:09:12, max mem: 30.7 GB 
[11/24 13:25:14][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.4479,	0.9163 s / batch. (data: 2.83e-04). ETA=11:02:35, max mem: 30.7 GB 
[11/24 13:26:48][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.0043,	0.9416 s / batch. (data: 1.55e-02). ETA=11:19:19, max mem: 30.7 GB 
[11/24 13:28:22][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.9375,	0.9326 s / batch. (data: 1.08e-02). ETA=11:11:17, max mem: 30.7 GB 
[11/24 13:29:11][INFO] visual_prompt:  217: Epoch 22 / 100: avg data time: 2.14e-02, avg batch time: 0.9493, average train loss: 0.2774
[11/24 13:30:06][INFO] visual_prompt:  316: Inference (val):avg data time: 2.80e-05, avg batch time: 0.3053, average loss: 1.1511
[11/24 13:30:06][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 59.35	rocauc: 61.22	
[11/24 13:31:38][INFO] visual_prompt:  303: 	Test 100/162. loss: 2.864, 0.2949 s / batch. (data: 3.79e-05)max mem: 30.66532 GB 
[11/24 13:32:24][INFO] visual_prompt:  316: Inference (test):avg data time: 3.04e-05, avg batch time: 0.3046, average loss: 1.0373
[11/24 13:32:24][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 62.79	rocauc: 64.43	
[11/24 13:32:24][INFO] visual_prompt:  165: Training 23 / 100 epoch, with learning rate 9.230476262104677e-05
[11/24 13:34:07][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.4469,	0.9485 s / batch. (data: 7.08e-04). ETA=11:20:18, max mem: 30.7 GB 
[11/24 13:35:41][INFO] visual_prompt:  204: 	Training 200/553. train loss: 0.0191,	0.9266 s / batch. (data: 2.62e-04). ETA=11:03:02, max mem: 30.7 GB 
[11/24 13:37:14][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.0923,	0.9448 s / batch. (data: 1.55e-02). ETA=11:14:28, max mem: 30.7 GB 
[11/24 13:38:48][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.9145,	0.9226 s / batch. (data: 2.63e-04). ETA=10:57:05, max mem: 30.7 GB 
[11/24 13:40:22][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.1431,	0.9233 s / batch. (data: 5.36e-03). ETA=10:56:02, max mem: 30.7 GB 
[11/24 13:41:11][INFO] visual_prompt:  217: Epoch 23 / 100: avg data time: 2.29e-02, avg batch time: 0.9524, average train loss: 0.2129
[11/24 13:42:06][INFO] visual_prompt:  316: Inference (val):avg data time: 2.77e-04, avg batch time: 0.3057, average loss: 1.1742
[11/24 13:42:06][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 64.23	rocauc: 65.27	
[11/24 13:43:39][INFO] visual_prompt:  303: 	Test 100/162. loss: 2.284, 0.3183 s / batch. (data: 5.89e-05)max mem: 30.66532 GB 
[11/24 13:44:24][INFO] visual_prompt:  316: Inference (test):avg data time: 5.26e-05, avg batch time: 0.3041, average loss: 1.2042
[11/24 13:44:24][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 62.33	rocauc: 65.08	
[11/24 13:44:24][INFO] visual_prompt:  165: Training 24 / 100 epoch, with learning rate 9.140044155740101e-05
[11/24 13:46:07][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.2438,	0.9131 s / batch. (data: 2.59e-04). ETA=10:46:29, max mem: 30.7 GB 
[11/24 13:47:41][INFO] visual_prompt:  204: 	Training 200/553. train loss: 0.0697,	0.9475 s / batch. (data: 8.68e-03). ETA=11:09:18, max mem: 30.7 GB 
[11/24 13:49:14][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.2612,	0.9343 s / batch. (data: 1.52e-02). ETA=10:58:21, max mem: 30.7 GB 
[11/24 13:50:48][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.0823,	0.9455 s / batch. (data: 2.96e-04). ETA=11:04:43, max mem: 30.7 GB 
[11/24 13:52:22][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.0589,	0.9423 s / batch. (data: 8.19e-03). ETA=11:00:53, max mem: 30.7 GB 
[11/24 13:53:11][INFO] visual_prompt:  217: Epoch 24 / 100: avg data time: 2.30e-02, avg batch time: 0.9525, average train loss: 0.2184
[11/24 13:54:08][INFO] visual_prompt:  316: Inference (val):avg data time: 3.01e-05, avg batch time: 0.3050, average loss: 1.2529
[11/24 13:54:08][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 57.72	rocauc: 62.49	
[11/24 13:55:45][INFO] visual_prompt:  303: 	Test 100/162. loss: 2.663, 0.3124 s / batch. (data: 3.31e-05)max mem: 30.66532 GB 
[11/24 13:56:32][INFO] visual_prompt:  316: Inference (test):avg data time: 8.03e-05, avg batch time: 0.3047, average loss: 1.1353
[11/24 13:56:32][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 61.24	rocauc: 61.43	
[11/24 13:56:32][INFO] visual_prompt:  165: Training 25 / 100 epoch, with learning rate 9.045084971874738e-05
[11/24 13:58:16][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.0783,	0.9280 s / batch. (data: 2.68e-04). ETA=10:48:27, max mem: 30.7 GB 
[11/24 13:59:51][INFO] visual_prompt:  204: 	Training 200/553. train loss: 0.0269,	0.9622 s / batch. (data: 1.09e-02). ETA=11:10:44, max mem: 30.7 GB 
[11/24 14:01:25][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.0159,	0.9330 s / batch. (data: 5.48e-03). ETA=10:48:51, max mem: 30.7 GB 
[11/24 14:02:58][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.0034,	0.9239 s / batch. (data: 2.55e-04). ETA=10:40:58, max mem: 30.7 GB 
[11/24 14:04:31][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.0339,	0.9150 s / batch. (data: 7.93e-03). ETA=10:33:16, max mem: 30.7 GB 
[11/24 14:05:21][INFO] visual_prompt:  217: Epoch 25 / 100: avg data time: 2.83e-02, avg batch time: 0.9557, average train loss: 0.1749
[11/24 14:06:16][INFO] visual_prompt:  316: Inference (val):avg data time: 2.93e-05, avg batch time: 0.3056, average loss: 1.2216
[11/24 14:06:16][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 62.20	rocauc: 62.67	
[11/24 14:07:49][INFO] visual_prompt:  303: 	Test 100/162. loss: 2.103, 0.2950 s / batch. (data: 4.12e-05)max mem: 30.66532 GB 
[11/24 14:08:35][INFO] visual_prompt:  316: Inference (test):avg data time: 8.01e-05, avg batch time: 0.3052, average loss: 1.2772
[11/24 14:08:35][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 62.33	rocauc: 63.96	
[11/24 14:08:35][INFO] visual_prompt:  165: Training 26 / 100 epoch, with learning rate 8.945702546981969e-05
[11/24 14:10:19][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.0314,	0.9728 s / batch. (data: 5.88e-03). ETA=11:10:49, max mem: 30.7 GB 
[11/24 14:11:53][INFO] visual_prompt:  204: 	Training 200/553. train loss: 0.0213,	0.9324 s / batch. (data: 1.08e-02). ETA=10:41:23, max mem: 30.7 GB 
[11/24 14:13:26][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.0894,	0.9294 s / batch. (data: 1.04e-02). ETA=10:37:47, max mem: 30.7 GB 
[11/24 14:15:00][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.0313,	0.9302 s / batch. (data: 2.57e-04). ETA=10:36:49, max mem: 30.7 GB 
[11/24 14:16:33][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.1866,	0.9250 s / batch. (data: 7.73e-04). ETA=10:31:41, max mem: 30.7 GB 
[11/24 14:17:22][INFO] visual_prompt:  217: Epoch 26 / 100: avg data time: 2.42e-02, avg batch time: 0.9523, average train loss: 0.1592
[11/24 14:18:17][INFO] visual_prompt:  316: Inference (val):avg data time: 6.28e-05, avg batch time: 0.3052, average loss: 1.1144
[11/24 14:18:17][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 61.38	rocauc: 65.74	
[11/24 14:19:49][INFO] visual_prompt:  303: 	Test 100/162. loss: 1.783, 0.3045 s / batch. (data: 3.15e-05)max mem: 30.66532 GB 
[11/24 14:20:35][INFO] visual_prompt:  316: Inference (test):avg data time: 7.66e-05, avg batch time: 0.3048, average loss: 1.2617
[11/24 14:20:35][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 58.45	rocauc: 63.20	
[11/24 14:20:35][INFO] visual_prompt:  165: Training 27 / 100 epoch, with learning rate 8.842005554284296e-05
[11/24 14:22:16][INFO] visual_prompt:  204: 	Training 100/553. train loss: 0.0028,	0.9320 s / batch. (data: 2.46e-04). ETA=10:34:06, max mem: 30.7 GB 
[11/24 14:23:49][INFO] visual_prompt:  204: 	Training 200/553. train loss: 0.0435,	0.9374 s / batch. (data: 5.35e-03). ETA=10:36:13, max mem: 30.7 GB 
[11/24 14:25:23][INFO] visual_prompt:  204: 	Training 300/553. train loss: 0.0862,	0.9480 s / batch. (data: 7.12e-04). ETA=10:41:51, max mem: 30.7 GB 
[11/24 14:26:57][INFO] visual_prompt:  204: 	Training 400/553. train loss: 0.2331,	0.9606 s / batch. (data: 1.09e-02). ETA=10:48:45, max mem: 30.7 GB 
[11/24 14:28:30][INFO] visual_prompt:  204: 	Training 500/553. train loss: 0.0109,	0.9300 s / batch. (data: 7.27e-04). ETA=10:26:32, max mem: 30.7 GB 
[11/24 14:29:19][INFO] visual_prompt:  217: Epoch 27 / 100: avg data time: 1.85e-02, avg batch time: 0.9469, average train loss: 0.1401
[11/24 14:30:14][INFO] visual_prompt:  316: Inference (val):avg data time: 2.89e-05, avg batch time: 0.3061, average loss: 1.4549
[11/24 14:30:14][INFO] visual_prompt:  113: Classification results with val_mammo-cbis: top1: 58.94	rocauc: 62.14	
[11/24 14:31:46][INFO] visual_prompt:  303: 	Test 100/162. loss: 4.812, 0.3117 s / batch. (data: 3.34e-05)max mem: 30.66532 GB 
[11/24 14:32:32][INFO] visual_prompt:  316: Inference (test):avg data time: 3.18e-05, avg batch time: 0.3054, average loss: 1.5517
[11/24 14:32:32][INFO] visual_prompt:  113: Classification results with test_mammo-cbis: top1: 57.36	rocauc: 62.07	
[11/24 14:32:32][INFO] visual_prompt:   42: Stopping early.
