/bin/bash: /home/s1952889/miniconda3/envs/prompt/lib/libtinfo.so.6: no version information available (required by /bin/bash)
12/06 17:06:00 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 (main, Sep 11 2023, 13:44:35) [GCC 11.2.0]
    CUDA available: True
    numpy_random_seed: 1611706550
    GPU 0: NVIDIA TITAN Xp
    CUDA_HOME: None
    GCC: gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
    PyTorch: 2.0.0
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.15.0
    OpenCV: 4.8.1
    MMEngine: 0.9.1

Runtime environment:
    cudnn_benchmark: True
    dist_cfg: {'backend': 'nccl'}
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    seed: 1611706550
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

12/06 17:06:00 - mmengine - INFO - Config:
backbone_norm_cfg = dict(eps=1e-06, requires_grad=True, type='LN')
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = 'work_dirs/setr_vit-l_pup_8xb2-160k_ade20k-512x512/20231119_220403/iter_160000.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=[
        dict(
            act_cfg=dict(type='ReLU'),
            align_corners=False,
            channels=256,
            dropout_ratio=0,
            in_channels=1024,
            in_index=0,
            kernel_size=3,
            loss_decode=dict(
                loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
            norm_cfg=dict(requires_grad=True, type='SyncBN'),
            num_classes=150,
            num_convs=2,
            type='SETRUPHead'),
        dict(
            act_cfg=dict(type='ReLU'),
            align_corners=False,
            channels=256,
            dropout_ratio=0,
            in_channels=1024,
            in_index=1,
            kernel_size=3,
            loss_decode=dict(
                loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
            norm_cfg=dict(requires_grad=True, type='SyncBN'),
            num_classes=150,
            num_convs=2,
            type='SETRUPHead'),
        dict(
            act_cfg=dict(type='ReLU'),
            align_corners=False,
            channels=256,
            dropout_ratio=0,
            in_channels=1024,
            in_index=2,
            kernel_size=3,
            loss_decode=dict(
                loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
            norm_cfg=dict(requires_grad=True, type='SyncBN'),
            num_classes=150,
            num_convs=2,
            type='SETRUPHead'),
    ],
    backbone=dict(
        drop_rate=0.0,
        embed_dims=1024,
        img_size=(
            512,
            512,
        ),
        in_channels=3,
        init_cfg=dict(
            checkpoint='pretrain/vit_large_p16.pth', type='Pretrained'),
        interpolate_mode='bilinear',
        norm_cfg=dict(eps=1e-06, requires_grad=True, type='LN'),
        num_heads=16,
        num_layers=24,
        out_indices=(
            9,
            14,
            19,
            23,
        ),
        patch_size=16,
        type='VisionTransformer',
        with_cls_token=True),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0,
        in_channels=1024,
        in_index=3,
        kernel_size=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=4,
        type='SETRUPHead',
        up_scale=2),
    pretrained=None,
    test_cfg=dict(crop_size=(
        512,
        512,
    ), mode='slide', stride=(
        341,
        341,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.001, momentum=0.9, type='SGD', weight_decay=0.0),
    paramwise_cfg=dict(custom_keys=dict(head=dict(lr_mult=10.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.001, momentum=0.9, type='SGD', weight_decay=0.0)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=8,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_log_dir = 'work_dirs/setr_vit-l_pup_8xb2-160k_ade20k-512x512/20231119_220403'
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = 'work_dirs/setr_vit-l_pup_8xb2-160k_ade20k-512x512/20231119_220403/test'

/home/s1952889/final-project/implementation/mmsegmentation/mmseg/models/builder.py:36: UserWarning: ``build_loss`` would be deprecated soon, please use ``mmseg.registry.MODELS.build()`` 
  warnings.warn('``build_loss`` would be deprecated soon, please use '
/home/s1952889/final-project/implementation/mmsegmentation/mmseg/models/losses/cross_entropy_loss.py:249: UserWarning: Default ``avg_non_ignore`` is False, if you would like to ignore the certain label and average loss over non-ignore labels, which is the same with PyTorch official cross_entropy, set ``avg_non_ignore=True``.
  warnings.warn(
12/06 17:06:21 - mmengine - INFO - Total parameters: 317290072
12/06 17:06:21 - mmengine - INFO - Trainable parameters: 317290072
12/06 17:06:22 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
/home/s1952889/final-project/implementation/mmsegmentation/mmseg/engine/hooks/visualization_hook.py:61: UserWarning: The draw is False, it means that the hook for visualization will not take effect. The results will NOT be visualized or stored.
  warnings.warn('The draw is False, it means that the '
12/06 17:06:22 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
/home/s1952889/final-project/implementation/mmsegmentation/mmseg/datasets/transforms/loading.py:83: UserWarning: `reduce_zero_label` will be deprecated, if you would like to ignore the zero label, please set `reduce_zero_label=True` when dataset initialized
  warnings.warn('`reduce_zero_label` will be deprecated, '
12/06 17:06:25 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: work_dirs/setr_vit-l_pup_8xb2-160k_ade20k-512x512/20231119_220403/iter_160000.pth
12/06 17:07:04 - mmengine - INFO - Load checkpoint from work_dirs/setr_vit-l_pup_8xb2-160k_ade20k-512x512/20231119_220403/iter_160000.pth
12/06 17:07:35 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:20:35  time: 0.3142  data_time: 0.0022  memory: 9939  
12/06 17:07:50 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:14:41  time: 0.3031  data_time: 0.0022  memory: 2073  
12/06 17:08:04 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:12:22  time: 0.2880  data_time: 0.0021  memory: 2032  
12/06 17:08:19 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:11:16  time: 0.3025  data_time: 0.0021  memory: 2135  
12/06 17:08:33 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:10:21  time: 0.2876  data_time: 0.0021  memory: 2170  
12/06 17:08:47 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:09:44  time: 0.3048  data_time: 0.0022  memory: 2068  
12/06 17:09:02 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:09:15  time: 0.2750  data_time: 0.0022  memory: 2067  
12/06 17:09:16 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:08:48  time: 0.3058  data_time: 0.0021  memory: 2070  
12/06 17:09:28 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:08:18  time: 0.2744  data_time: 0.0020  memory: 2028  
12/06 17:09:43 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:07:57  time: 0.2764  data_time: 0.0022  memory: 2031  
12/06 17:09:58 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:07:39  time: 0.3214  data_time: 0.0023  memory: 2065  
12/06 17:10:12 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:07:20  time: 0.3080  data_time: 0.0023  memory: 2070  
12/06 17:10:27 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:07:01  time: 0.2912  data_time: 0.0021  memory: 2084  
12/06 17:10:42 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:06:45  time: 0.3066  data_time: 0.0023  memory: 2081  
12/06 17:10:57 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:06:28  time: 0.3065  data_time: 0.0021  memory: 2091  
12/06 17:11:10 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:06:09  time: 0.3071  data_time: 0.0023  memory: 2033  
12/06 17:11:26 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:05:54  time: 0.3084  data_time: 0.0023  memory: 2026  
12/06 17:11:38 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:05:35  time: 0.2464  data_time: 0.0022  memory: 2046  
12/06 17:11:53 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:05:19  time: 0.2760  data_time: 0.0022  memory: 2062  
12/06 17:12:06 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:05:02  time: 0.2769  data_time: 0.0022  memory: 2063  
12/06 17:12:22 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:04:47  time: 0.3216  data_time: 0.0022  memory: 2093  
12/06 17:12:37 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:32  time: 0.2781  data_time: 0.0022  memory: 2055  
12/06 17:12:51 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:04:16  time: 0.2924  data_time: 0.0022  memory: 2050  
12/06 17:13:06 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:04:01  time: 0.2770  data_time: 0.0022  memory: 2877  
12/06 17:13:19 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:45  time: 0.2775  data_time: 0.0022  memory: 2042  
12/06 17:13:32 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:03:28  time: 0.2925  data_time: 0.0021  memory: 2027  
12/06 17:13:46 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:13  time: 0.2626  data_time: 0.0022  memory: 2027  
12/06 17:14:00 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:02:58  time: 0.3068  data_time: 0.0022  memory: 2062  
12/06 17:14:13 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:42  time: 0.3087  data_time: 0.0020  memory: 2062  
12/06 17:14:27 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:27  time: 0.2621  data_time: 0.0021  memory: 2026  
12/06 17:14:42 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:12  time: 0.2928  data_time: 0.0022  memory: 2056  
12/06 17:14:56 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:58  time: 0.2926  data_time: 0.0022  memory: 2024  
12/06 17:15:09 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:42  time: 0.2468  data_time: 0.0021  memory: 2140  
12/06 17:15:24 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:28  time: 0.2937  data_time: 0.0023  memory: 2060  
12/06 17:15:39 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:13  time: 0.2767  data_time: 0.0021  memory: 2065  
12/06 17:15:53 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:58  time: 0.3088  data_time: 0.0023  memory: 2034  
12/06 17:16:08 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:44  time: 0.3080  data_time: 0.0023  memory: 1999  
12/06 17:16:21 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:29  time: 0.2619  data_time: 0.0021  memory: 2081  
12/06 17:16:36 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:14  time: 0.2776  data_time: 0.0021  memory: 2162  
12/06 17:16:49 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.2614  data_time: 0.0019  memory: 2086  
12/06 17:16:50 - mmengine - INFO - per class results:
12/06 17:16:50 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 76.28 | 87.58 |
|       building      | 83.34 | 93.21 |
|         sky         | 93.64 | 96.63 |
|        floor        | 80.44 | 88.82 |
|         tree        | 74.64 | 87.55 |
|       ceiling       | 82.47 | 90.86 |
|         road        | 83.05 | 89.38 |
|         bed         | 87.26 | 95.03 |
|      windowpane     | 59.54 | 75.16 |
|        grass        | 66.25 | 79.42 |
|       cabinet       | 58.67 | 71.14 |
|       sidewalk      | 62.35 | 77.19 |
|        person       | 77.79 | 90.23 |
|        earth        | 38.99 | 53.62 |
|         door        | 47.37 | 63.02 |
|        table        | 55.76 |  73.6 |
|       mountain      |  56.0 | 69.79 |
|        plant        | 51.16 | 60.48 |
|       curtain       | 71.87 | 85.55 |
|        chair        | 52.32 | 67.56 |
|         car         | 81.91 | 92.66 |
|        water        | 48.94 | 59.17 |
|       painting      | 68.97 | 82.27 |
|         sofa        | 63.19 | 77.55 |
|        shelf        | 41.98 | 59.72 |
|        house        | 53.14 | 67.21 |
|         sea         | 59.01 | 79.47 |
|        mirror       | 62.27 | 71.73 |
|         rug         | 64.67 |  75.3 |
|        field        | 29.71 | 56.23 |
|       armchair      | 40.92 | 64.16 |
|         seat        | 64.06 | 82.82 |
|        fence        | 45.31 | 63.01 |
|         desk        | 45.44 | 66.88 |
|         rock        | 48.84 | 74.63 |
|       wardrobe      | 47.25 | 68.27 |
|         lamp        | 50.91 | 63.76 |
|       bathtub       | 79.48 | 86.83 |
|       railing       | 33.92 | 48.29 |
|       cushion       | 54.61 | 69.04 |
|         base        | 29.38 | 48.53 |
|         box         | 23.86 | 32.97 |
|        column       | 41.47 | 52.56 |
|      signboard      | 31.96 | 42.49 |
|   chest of drawers  |  38.8 | 54.46 |
|       counter       | 36.25 | 43.82 |
|         sand        | 40.95 | 66.39 |
|         sink        | 63.51 | 70.07 |
|      skyscraper     | 55.21 | 67.49 |
|      fireplace      | 70.36 | 87.97 |
|     refrigerator    | 65.06 | 79.23 |
|      grandstand     | 48.89 | 81.72 |
|         path        | 25.26 |  34.6 |
|        stairs       | 27.17 | 36.33 |
|        runway       | 70.08 | 91.97 |
|         case        | 56.17 | 72.31 |
|      pool table     | 88.34 | 97.01 |
|        pillow       | 50.59 | 58.01 |
|     screen door     | 59.59 | 65.91 |
|       stairway      | 27.85 | 37.31 |
|        river        | 15.68 | 34.14 |
|        bridge       | 55.89 | 77.43 |
|       bookcase      | 34.93 | 53.02 |
|        blind        | 44.35 | 51.95 |
|     coffee table    | 56.66 |  77.1 |
|        toilet       | 75.65 | 90.64 |
|        flower       | 29.67 |  45.1 |
|         book        | 43.21 |  60.3 |
|         hill        |  7.25 | 13.71 |
|        bench        | 44.58 | 52.88 |
|      countertop     | 50.46 | 70.55 |
|        stove        | 64.28 | 74.93 |
|         palm        | 50.38 | 68.25 |
|    kitchen island   | 40.02 | 74.78 |
|       computer      | 56.25 | 71.84 |
|     swivel chair    | 42.83 | 63.57 |
|         boat        | 52.95 | 80.31 |
|         bar         | 51.63 |  67.9 |
|    arcade machine   | 77.67 | 86.63 |
|        hovel        | 40.15 |  60.7 |
|         bus         | 82.77 | 92.12 |
|        towel        |  59.8 |  77.5 |
|        light        | 42.37 | 48.78 |
|        truck        | 19.46 | 28.43 |
|        tower        | 26.03 | 35.75 |
|      chandelier     | 60.56 | 79.06 |
|        awning       | 24.79 | 28.92 |
|     streetlight     | 14.71 | 18.08 |
|        booth        | 38.57 |  40.1 |
| television receiver | 63.65 | 74.93 |
|       airplane      | 53.79 | 63.35 |
|      dirt track     |  7.13 | 19.63 |
|       apparel       | 31.45 | 42.49 |
|         pole        | 11.76 | 13.84 |
|         land        |  1.66 |  3.71 |
|      bannister      |  6.28 |  9.33 |
|      escalator      | 49.61 | 77.48 |
|       ottoman       | 41.83 | 58.45 |
|        bottle       | 34.19 | 59.04 |
|        buffet       | 51.73 | 69.02 |
|        poster       | 30.16 | 39.15 |
|        stage        | 15.66 | 34.63 |
|         van         | 36.44 | 43.11 |
|         ship        | 52.49 | 65.87 |
|       fountain      | 47.14 | 51.09 |
|    conveyer belt    | 72.37 | 93.15 |
|        canopy       | 35.64 | 47.38 |
|        washer       | 72.17 | 76.47 |
|      plaything      | 17.02 | 24.33 |
|    swimming pool    | 53.71 | 81.83 |
|        stool        | 27.73 | 39.75 |
|        barrel       | 50.65 | 63.93 |
|        basket       | 24.44 |  30.4 |
|      waterfall      | 64.07 | 76.55 |
|         tent        | 91.96 | 99.29 |
|         bag         |  5.62 |  6.28 |
|       minibike      | 65.48 |  78.0 |
|        cradle       | 61.21 | 83.48 |
|         oven        | 39.24 | 56.21 |
|         ball        | 31.82 |  33.8 |
|         food        | 49.68 | 62.95 |
|         step        | 12.42 | 14.92 |
|         tank        | 47.76 | 52.72 |
|      trade name     |  22.5 | 24.87 |
|      microwave      | 76.08 | 87.46 |
|         pot         | 38.89 | 43.79 |
|        animal       | 57.07 | 58.59 |
|       bicycle       | 52.69 | 72.24 |
|         lake        | 39.78 | 81.54 |
|      dishwasher     | 42.81 | 62.06 |
|        screen       | 64.37 | 88.35 |
|       blanket       | 10.26 | 11.57 |
|      sculpture      | 48.34 | 61.51 |
|         hood        | 51.96 | 62.14 |
|        sconce       |  22.9 | 27.69 |
|         vase        |  25.4 | 34.06 |
|    traffic light    | 18.77 | 28.25 |
|         tray        |  1.84 |  3.31 |
|        ashcan       | 29.01 | 39.15 |
|         fan         | 50.66 | 63.96 |
|         pier        | 36.61 | 53.78 |
|      crt screen     |  1.07 |  1.49 |
|        plate        | 47.78 | 58.98 |
|       monitor       | 36.34 | 74.87 |
|    bulletin board   | 35.69 | 45.04 |
|        shower       |  1.09 |  3.99 |
|       radiator      | 54.08 | 61.74 |
|        glass        |  6.82 |  7.1  |
|        clock        | 16.31 | 17.58 |
|         flag        | 56.17 | 60.82 |
+---------------------+-------+-------+
12/06 17:16:50 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 82.2000  mIoU: 46.6800  mAcc: 59.5500  data_time: 0.0031  time: 0.2925
12/06 17:17:15 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 (main, Sep 11 2023, 13:44:35) [GCC 11.2.0]
    CUDA available: True
    numpy_random_seed: 1177989981
    GPU 0: NVIDIA TITAN Xp
    CUDA_HOME: None
    GCC: gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
    PyTorch: 2.0.0
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.15.0
    OpenCV: 4.8.1
    MMEngine: 0.9.1

Runtime environment:
    cudnn_benchmark: True
    dist_cfg: {'backend': 'nccl'}
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    seed: 1177989981
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

12/06 17:17:15 - mmengine - INFO - Config:
backbone_norm_cfg = dict(eps=1e-06, requires_grad=True, type='LN')
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = 'work_dirs/setr_vit-l_pup-noaux_8xb2-160k_ade20k-512x512/20231119_220357/iter_160000.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=[],
    backbone=dict(
        drop_rate=0.0,
        embed_dims=1024,
        img_size=(
            512,
            512,
        ),
        in_channels=3,
        init_cfg=dict(
            checkpoint='pretrain/vit_large_p16.pth', type='Pretrained'),
        interpolate_mode='bilinear',
        norm_cfg=dict(eps=1e-06, requires_grad=True, type='LN'),
        num_heads=16,
        num_layers=24,
        out_indices=23,
        patch_size=16,
        type='VisionTransformer',
        with_cls_token=True),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0,
        in_channels=1024,
        in_index=0,
        kernel_size=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=4,
        type='SETRUPHead',
        up_scale=2),
    pretrained=None,
    test_cfg=dict(crop_size=(
        512,
        512,
    ), mode='slide', stride=(
        341,
        341,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
num_layers = 24
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.001, momentum=0.9, type='SGD', weight_decay=0.0),
    paramwise_cfg=dict(custom_keys=dict(head=dict(lr_mult=10.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.001, momentum=0.9, type='SGD', weight_decay=0.0)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=8,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=8,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_log_dir = 'work_dirs/setr_vit-l_pup-noaux_8xb2-160k_ade20k-512x512/20231119_220357'
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = 'work_dirs/setr_vit-l_pup-noaux_8xb2-160k_ade20k-512x512/20231119_220357/test'

/home/s1952889/final-project/implementation/mmsegmentation/mmseg/models/builder.py:36: UserWarning: ``build_loss`` would be deprecated soon, please use ``mmseg.registry.MODELS.build()`` 
  warnings.warn('``build_loss`` would be deprecated soon, please use '
/home/s1952889/final-project/implementation/mmsegmentation/mmseg/models/losses/cross_entropy_loss.py:249: UserWarning: Default ``avg_non_ignore`` is False, if you would like to ignore the certain label and average loss over non-ignore labels, which is the same with PyTorch official cross_entropy, set ``avg_non_ignore=True``.
  warnings.warn(
12/06 17:17:19 - mmengine - INFO - Total parameters: 308317846
12/06 17:17:19 - mmengine - INFO - Trainable parameters: 308317846
12/06 17:17:19 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
/home/s1952889/final-project/implementation/mmsegmentation/mmseg/engine/hooks/visualization_hook.py:61: UserWarning: The draw is False, it means that the hook for visualization will not take effect. The results will NOT be visualized or stored.
  warnings.warn('The draw is False, it means that the '
12/06 17:17:19 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
/home/s1952889/final-project/implementation/mmsegmentation/mmseg/datasets/transforms/loading.py:83: UserWarning: `reduce_zero_label` will be deprecated, if you would like to ignore the zero label, please set `reduce_zero_label=True` when dataset initialized
  warnings.warn('`reduce_zero_label` will be deprecated, '
12/06 17:17:20 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: work_dirs/setr_vit-l_pup-noaux_8xb2-160k_ade20k-512x512/20231119_220357/iter_160000.pth
12/06 17:18:13 - mmengine - INFO - Load checkpoint from work_dirs/setr_vit-l_pup-noaux_8xb2-160k_ade20k-512x512/20231119_220357/iter_160000.pth
12/06 17:18:31 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:11:18  time: 0.3159  data_time: 0.0021  memory: 9892  
12/06 17:18:46 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:10:12  time: 0.3021  data_time: 0.0022  memory: 2026  
12/06 17:18:59 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:09:27  time: 0.2878  data_time: 0.0022  memory: 1985  
12/06 17:19:14 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:09:09  time: 0.3046  data_time: 0.0021  memory: 2089  
12/06 17:19:28 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:08:43  time: 0.2898  data_time: 0.0021  memory: 2124  
12/06 17:19:43 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:08:25  time: 0.3057  data_time: 0.0022  memory: 2022  
12/06 17:19:57 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:08:09  time: 0.2758  data_time: 0.0021  memory: 2021  
12/06 17:20:12 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:07:53  time: 0.3058  data_time: 0.0020  memory: 2024  
12/06 17:20:24 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:07:30  time: 0.2766  data_time: 0.0021  memory: 1982  
12/06 17:20:39 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:07:15  time: 0.2751  data_time: 0.0021  memory: 1985  
12/06 17:20:54 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:07:02  time: 0.3217  data_time: 0.0022  memory: 2019  
12/06 17:21:08 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:06:48  time: 0.3070  data_time: 0.0021  memory: 2024  
12/06 17:21:22 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:06:32  time: 0.2910  data_time: 0.0020  memory: 2036  
12/06 17:21:38 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:06:20  time: 0.3079  data_time: 0.0022  memory: 2034  
12/06 17:21:53 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:06:05  time: 0.3062  data_time: 0.0021  memory: 2044  
12/06 17:22:06 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:05:48  time: 0.3072  data_time: 0.0022  memory: 1987  
12/06 17:22:21 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:05:35  time: 0.3072  data_time: 0.0022  memory: 1979  
12/06 17:22:34 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:05:18  time: 0.2458  data_time: 0.0021  memory: 2000  
12/06 17:22:49 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:05:04  time: 0.2764  data_time: 0.0020  memory: 2016  
12/06 17:23:02 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:04:48  time: 0.2771  data_time: 0.0021  memory: 2017  
12/06 17:23:18 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:04:35  time: 0.3220  data_time: 0.0021  memory: 2046  
12/06 17:23:33 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:21  time: 0.2780  data_time: 0.0021  memory: 2008  
12/06 17:23:47 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:04:06  time: 0.2919  data_time: 0.0021  memory: 2003  
12/06 17:24:02 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:03:52  time: 0.2764  data_time: 0.0020  memory: 2842  
12/06 17:24:15 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:36  time: 0.2765  data_time: 0.0020  memory: 1995  
12/06 17:24:28 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:03:21  time: 0.2926  data_time: 0.0021  memory: 1980  
12/06 17:24:42 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:06  time: 0.2613  data_time: 0.0019  memory: 1981  
12/06 17:24:56 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:02:52  time: 0.3075  data_time: 0.0020  memory: 2015  
12/06 17:25:09 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:37  time: 0.3068  data_time: 0.0020  memory: 2016  
12/06 17:25:23 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:23  time: 0.2622  data_time: 0.0020  memory: 1979  
12/06 17:25:37 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:08  time: 0.2925  data_time: 0.0021  memory: 2010  
12/06 17:25:52 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:54  time: 0.2925  data_time: 0.0021  memory: 1978  
12/06 17:26:05 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:40  time: 0.2462  data_time: 0.0020  memory: 2094  
12/06 17:26:20 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:25  time: 0.2931  data_time: 0.0022  memory: 2013  
12/06 17:26:35 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:11  time: 0.2767  data_time: 0.0020  memory: 2019  
12/06 17:26:48 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:57  time: 0.3075  data_time: 0.0021  memory: 1988  
12/06 17:27:04 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:42  time: 0.3074  data_time: 0.0022  memory: 1953  
12/06 17:27:16 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:28  time: 0.2610  data_time: 0.0020  memory: 2034  
12/06 17:27:31 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:14  time: 0.2786  data_time: 0.0020  memory: 2116  
12/06 17:27:45 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.2615  data_time: 0.0019  memory: 2039  
12/06 17:27:45 - mmengine - INFO - per class results:
12/06 17:27:45 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        |  76.1 | 87.03 |
|       building      | 82.17 | 92.31 |
|         sky         | 93.52 | 96.45 |
|        floor        | 80.75 | 89.97 |
|         tree        | 73.77 | 88.13 |
|       ceiling       |  83.5 | 92.03 |
|         road        | 81.78 |  89.8 |
|         bed         | 87.63 | 94.74 |
|      windowpane     | 61.04 | 77.41 |
|        grass        | 64.98 | 79.65 |
|       cabinet       | 59.13 | 72.31 |
|       sidewalk      | 62.23 | 75.79 |
|        person       | 79.01 | 90.85 |
|        earth        |  38.2 |  52.8 |
|         door        | 45.74 | 61.45 |
|        table        | 56.42 | 74.21 |
|       mountain      |  56.1 | 69.94 |
|        plant        | 50.27 |  62.6 |
|       curtain       |  73.3 | 85.36 |
|        chair        |  54.0 | 69.39 |
|         car         | 82.87 | 92.75 |
|        water        |  57.3 | 72.45 |
|       painting      |  68.1 | 82.61 |
|         sofa        | 64.76 |  81.1 |
|        shelf        |  44.0 |  62.8 |
|        house        | 49.13 | 63.82 |
|         sea         |  63.4 | 80.12 |
|        mirror       | 63.22 | 73.02 |
|         rug         | 65.32 | 71.89 |
|        field        | 26.25 |  43.2 |
|       armchair      | 42.18 |  62.3 |
|         seat        | 62.49 | 82.42 |
|        fence        | 35.89 |  50.4 |
|         desk        |  47.0 | 68.88 |
|         rock        | 47.71 | 72.41 |
|       wardrobe      | 45.67 | 62.34 |
|         lamp        | 52.63 | 67.19 |
|       bathtub       | 80.78 | 87.71 |
|       railing       | 33.82 | 49.24 |
|       cushion       | 52.56 | 62.72 |
|         base        | 32.81 | 49.73 |
|         box         |  25.2 | 36.86 |
|        column       | 42.04 | 53.72 |
|      signboard      | 31.35 |  41.8 |
|   chest of drawers  | 42.11 | 56.41 |
|       counter       | 28.02 | 34.15 |
|         sand        | 51.11 | 79.72 |
|         sink        | 66.07 | 74.16 |
|      skyscraper     |  58.9 | 73.85 |
|      fireplace      | 70.73 | 87.76 |
|     refrigerator    | 65.67 | 77.09 |
|      grandstand     | 49.46 | 82.96 |
|         path        | 26.22 |  36.9 |
|        stairs       | 24.99 | 35.44 |
|        runway       | 66.35 | 87.55 |
|         case        | 53.53 | 73.68 |
|      pool table     | 87.17 | 96.54 |
|        pillow       | 51.64 | 62.85 |
|     screen door     | 58.75 | 65.51 |
|       stairway      | 26.29 |  35.4 |
|        river        | 16.54 | 31.07 |
|        bridge       | 49.55 |  61.2 |
|       bookcase      |  39.9 | 61.63 |
|        blind        | 38.75 |  45.0 |
|     coffee table    | 55.79 | 78.79 |
|        toilet       |  78.4 | 89.68 |
|        flower       |  32.6 | 46.39 |
|         book        | 46.33 | 63.49 |
|         hill        |  8.53 | 11.57 |
|        bench        | 42.06 | 48.65 |
|      countertop     |  55.4 | 71.06 |
|        stove        | 65.08 | 76.35 |
|         palm        | 52.55 | 73.45 |
|    kitchen island   |  36.0 | 68.68 |
|       computer      | 71.88 | 86.94 |
|     swivel chair    |  39.5 | 55.79 |
|         boat        | 63.31 | 85.53 |
|         bar         | 52.44 | 67.39 |
|    arcade machine   | 78.12 | 83.97 |
|        hovel        | 47.38 | 67.14 |
|         bus         | 80.61 | 94.48 |
|        towel        | 52.84 | 72.95 |
|        light        | 40.63 | 45.01 |
|        truck        | 25.83 | 30.11 |
|        tower        | 21.45 | 35.57 |
|      chandelier     |  59.6 | 75.16 |
|        awning       | 23.92 | 29.25 |
|     streetlight     | 15.06 | 18.74 |
|        booth        | 42.62 | 47.38 |
| television receiver | 64.68 | 72.86 |
|       airplane      | 56.37 | 64.92 |
|      dirt track     |  0.86 |  2.22 |
|       apparel       | 35.19 | 45.69 |
|         pole        | 15.38 | 20.19 |
|         land        |  6.13 |  9.93 |
|      bannister      |  5.95 |  8.65 |
|      escalator      | 53.11 | 80.88 |
|       ottoman       | 41.87 | 56.56 |
|        bottle       | 33.29 |  51.4 |
|        buffet       | 48.56 | 60.71 |
|        poster       | 42.14 | 51.99 |
|        stage        | 20.56 | 41.31 |
|         van         | 38.99 | 47.15 |
|         ship        | 66.74 | 77.57 |
|       fountain      | 52.96 | 60.59 |
|    conveyer belt    | 74.25 | 93.25 |
|        canopy       | 42.43 | 54.88 |
|        washer       | 70.27 |  79.6 |
|      plaything      | 16.63 | 22.02 |
|    swimming pool    |  70.3 |  84.6 |
|        stool        | 31.93 | 41.01 |
|        barrel       | 53.69 |  63.0 |
|        basket       | 24.81 | 32.47 |
|      waterfall      | 51.83 |  61.5 |
|         tent        |  86.6 | 98.82 |
|         bag         |  8.66 |  9.66 |
|       minibike      | 66.18 | 79.57 |
|        cradle       | 60.05 | 83.72 |
|         oven        |  36.5 | 52.42 |
|         ball        | 29.95 | 33.23 |
|         food        | 55.06 | 75.44 |
|         step        |  9.59 | 11.94 |
|         tank        | 56.67 | 61.17 |
|      trade name     | 20.79 | 23.17 |
|      microwave      | 76.92 | 86.12 |
|         pot         | 39.14 | 44.79 |
|        animal       | 52.75 | 55.43 |
|       bicycle       | 50.99 | 72.14 |
|         lake        | 54.98 | 65.82 |
|      dishwasher     | 46.42 | 60.39 |
|        screen       | 66.35 | 87.64 |
|       blanket       | 10.17 |  12.1 |
|      sculpture      | 61.14 | 73.25 |
|         hood        | 57.32 | 66.16 |
|        sconce       | 29.92 | 36.25 |
|         vase        | 25.89 | 37.44 |
|    traffic light    | 23.23 | 36.59 |
|         tray        |  2.01 |  2.5  |
|        ashcan       | 34.09 | 47.68 |
|         fan         | 52.14 | 63.62 |
|         pier        | 49.98 | 58.68 |
|      crt screen     |  1.09 |  1.71 |
|        plate        | 50.04 |  66.8 |
|       monitor       | 56.71 | 71.35 |
|    bulletin board   |  46.3 | 55.56 |
|        shower       |  1.78 |  5.0  |
|       radiator      | 58.97 | 69.13 |
|        glass        |  7.91 |  8.2  |
|        clock        | 20.52 | 22.41 |
|         flag        | 60.08 | 66.77 |
+---------------------+-------+-------+
12/06 17:27:45 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 82.3200  mIoU: 48.1400  mAcc: 60.2900  data_time: 0.0026  time: 0.2855
12/06 17:27:49 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 (main, Sep 11 2023, 13:44:35) [GCC 11.2.0]
    CUDA available: True
    numpy_random_seed: 683941395
    GPU 0: NVIDIA TITAN Xp
    CUDA_HOME: None
    GCC: gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
    PyTorch: 2.0.0
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.15.0
    OpenCV: 4.8.1
    MMEngine: 0.9.1

Runtime environment:
    cudnn_benchmark: True
    dist_cfg: {'backend': 'nccl'}
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    seed: 683941395
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

12/06 17:27:49 - mmengine - INFO - Config:
backbone_norm_cfg = dict(eps=1e-06, requires_grad=True, type='LN')
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = 'work_dirs/setrvpt_vit-l_pup_8xb2-160k_ade20k-512x512/20231120_011426/iter_160000.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=[
        dict(
            act_cfg=dict(type='ReLU'),
            align_corners=False,
            channels=256,
            dropout_ratio=0,
            in_channels=1024,
            in_index=0,
            kernel_size=3,
            loss_decode=dict(
                loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
            norm_cfg=dict(requires_grad=True, type='SyncBN'),
            num_classes=150,
            num_convs=2,
            type='SETRUPHead'),
        dict(
            act_cfg=dict(type='ReLU'),
            align_corners=False,
            channels=256,
            dropout_ratio=0,
            in_channels=1024,
            in_index=1,
            kernel_size=3,
            loss_decode=dict(
                loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
            norm_cfg=dict(requires_grad=True, type='SyncBN'),
            num_classes=150,
            num_convs=2,
            type='SETRUPHead'),
        dict(
            act_cfg=dict(type='ReLU'),
            align_corners=False,
            channels=256,
            dropout_ratio=0,
            in_channels=1024,
            in_index=2,
            kernel_size=3,
            loss_decode=dict(
                loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
            norm_cfg=dict(requires_grad=True, type='SyncBN'),
            num_classes=150,
            num_convs=2,
            type='SETRUPHead'),
    ],
    backbone=dict(
        drop_rate=0.0,
        embed_dims=1024,
        img_size=(
            512,
            512,
        ),
        in_channels=3,
        init_cfg=dict(
            checkpoint='pretrain/vit_large_p16.pth', type='Pretrained'),
        interpolate_mode='bilinear',
        norm_cfg=dict(eps=1e-06, requires_grad=True, type='LN'),
        num_heads=16,
        num_layers=24,
        out_indices=(
            9,
            14,
            19,
            23,
        ),
        patch_size=16,
        prompt_cfg=dict(
            depth=24,
            dropout=0.1,
            init='random',
            length=50,
            location='prepend',
            shared=False),
        type='PromptedVisionTransformer',
        with_cls_token=True),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0,
        in_channels=1024,
        in_index=3,
        kernel_size=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=4,
        type='SETRUPHead',
        up_scale=2),
    pretrained=None,
    test_cfg=dict(crop_size=(
        512,
        512,
    ), mode='slide', stride=(
        341,
        341,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.0005, momentum=0.9, type='SGD', weight_decay=0.0),
    paramwise_cfg=dict(custom_keys=dict(head=dict(lr_mult=1.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.0005, momentum=0.9, type='SGD', weight_decay=0.0)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=8,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_log_dir = 'work_dirs/setrvpt_vit-l_pup_8xb2-160k_ade20k-512x512/20231120_011426'
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = 'work_dirs/setrvpt_vit-l_pup_8xb2-160k_ade20k-512x512/20231120_011426/test'

/home/s1952889/final-project/implementation/mmsegmentation/mmseg/models/builder.py:36: UserWarning: ``build_loss`` would be deprecated soon, please use ``mmseg.registry.MODELS.build()`` 
  warnings.warn('``build_loss`` would be deprecated soon, please use '
/home/s1952889/final-project/implementation/mmsegmentation/mmseg/models/losses/cross_entropy_loss.py:249: UserWarning: Default ``avg_non_ignore`` is False, if you would like to ignore the certain label and average loss over non-ignore labels, which is the same with PyTorch official cross_entropy, set ``avg_non_ignore=True``.
  warnings.warn(
12/06 17:27:54 - mmengine - INFO - Total parameters: 318518872
12/06 17:27:54 - mmengine - INFO - Trainable parameters: 14372440
12/06 17:27:54 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
/home/s1952889/final-project/implementation/mmsegmentation/mmseg/engine/hooks/visualization_hook.py:61: UserWarning: The draw is False, it means that the hook for visualization will not take effect. The results will NOT be visualized or stored.
  warnings.warn('The draw is False, it means that the '
12/06 17:27:54 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
/home/s1952889/final-project/implementation/mmsegmentation/mmseg/datasets/transforms/loading.py:83: UserWarning: `reduce_zero_label` will be deprecated, if you would like to ignore the zero label, please set `reduce_zero_label=True` when dataset initialized
  warnings.warn('`reduce_zero_label` will be deprecated, '
12/06 17:27:55 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: work_dirs/setrvpt_vit-l_pup_8xb2-160k_ade20k-512x512/20231120_011426/iter_160000.pth
12/06 17:28:27 - mmengine - INFO - Load checkpoint from work_dirs/setrvpt_vit-l_pup_8xb2-160k_ade20k-512x512/20231120_011426/iter_160000.pth
12/06 17:28:46 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:12:28  time: 0.3518  data_time: 0.0021  memory: 9944  
12/06 17:29:02 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:11:18  time: 0.3377  data_time: 0.0022  memory: 2078  
12/06 17:29:18 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:10:30  time: 0.3222  data_time: 0.0022  memory: 2036  
12/06 17:29:34 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:10:10  time: 0.3373  data_time: 0.0021  memory: 2139  
12/06 17:29:50 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:09:41  time: 0.3219  data_time: 0.0021  memory: 2174  
12/06 17:30:06 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:09:21  time: 0.3398  data_time: 0.0021  memory: 2073  
12/06 17:30:22 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:09:03  time: 0.3048  data_time: 0.0021  memory: 2072  
12/06 17:30:38 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:08:45  time: 0.3390  data_time: 0.0021  memory: 2075  
12/06 17:30:52 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:08:19  time: 0.3063  data_time: 0.0020  memory: 2033  
12/06 17:31:08 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:08:03  time: 0.3056  data_time: 0.0020  memory: 2036  
12/06 17:31:24 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:07:48  time: 0.3554  data_time: 0.0021  memory: 2070  
12/06 17:31:41 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:07:32  time: 0.3407  data_time: 0.0022  memory: 2075  
12/06 17:31:56 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:07:15  time: 0.3218  data_time: 0.0020  memory: 2088  
12/06 17:32:13 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:07:01  time: 0.3390  data_time: 0.0022  memory: 2085  
12/06 17:32:30 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:06:45  time: 0.3391  data_time: 0.0021  memory: 2095  
12/06 17:32:44 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:06:26  time: 0.3402  data_time: 0.0022  memory: 2037  
12/06 17:33:01 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:06:11  time: 0.3401  data_time: 0.0022  memory: 2030  
12/06 17:33:15 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:05:52  time: 0.2719  data_time: 0.0021  memory: 2051  
12/06 17:33:32 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:05:37  time: 0.3054  data_time: 0.0021  memory: 2066  
12/06 17:33:47 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:05:19  time: 0.3057  data_time: 0.0021  memory: 2068  
12/06 17:34:04 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:05:05  time: 0.3570  data_time: 0.0021  memory: 2097  
12/06 17:34:20 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:49  time: 0.3077  data_time: 0.0021  memory: 2060  
12/06 17:34:36 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:04:32  time: 0.3251  data_time: 0.0020  memory: 2055  
12/06 17:34:52 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:04:17  time: 0.3057  data_time: 0.0020  memory: 2882  
12/06 17:35:07 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:00  time: 0.3051  data_time: 0.0020  memory: 2047  
12/06 17:35:21 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:03:43  time: 0.3223  data_time: 0.0020  memory: 2031  
12/06 17:35:37 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:26  time: 0.2909  data_time: 0.0020  memory: 2031  
12/06 17:35:52 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:10  time: 0.3384  data_time: 0.0020  memory: 2067  
12/06 17:36:07 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:54  time: 0.3398  data_time: 0.0020  memory: 2067  
12/06 17:36:22 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:38  time: 0.2893  data_time: 0.0020  memory: 2030  
12/06 17:36:38 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:22  time: 0.3242  data_time: 0.0020  memory: 2060  
12/06 17:36:54 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:06  time: 0.3245  data_time: 0.0021  memory: 2029  
12/06 17:37:08 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:50  time: 0.2719  data_time: 0.0020  memory: 2145  
12/06 17:37:25 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:35  time: 0.3255  data_time: 0.0022  memory: 2065  
12/06 17:37:42 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:19  time: 0.3073  data_time: 0.0020  memory: 2070  
12/06 17:37:56 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:03  time: 0.3391  data_time: 0.0021  memory: 2039  
12/06 17:38:13 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:47  time: 0.3416  data_time: 0.0022  memory: 2005  
12/06 17:38:28 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:31  time: 0.2902  data_time: 0.0019  memory: 2085  
12/06 17:38:44 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:15  time: 0.3046  data_time: 0.0020  memory: 2167  
12/06 17:38:59 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.2881  data_time: 0.0019  memory: 2091  
12/06 17:38:59 - mmengine - INFO - per class results:
12/06 17:38:59 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 74.66 | 86.32 |
|       building      | 82.24 | 93.31 |
|         sky         | 93.44 | 96.72 |
|        floor        |  80.0 | 87.86 |
|         tree        | 74.36 | 86.26 |
|       ceiling       | 82.17 |  91.2 |
|         road        |  81.5 | 88.11 |
|         bed         | 85.35 |  94.4 |
|      windowpane     | 59.08 | 77.41 |
|        grass        | 66.69 | 81.77 |
|       cabinet       | 56.88 | 70.23 |
|       sidewalk      | 60.29 |  78.4 |
|        person       | 76.45 | 88.83 |
|        earth        | 33.23 | 45.58 |
|         door        | 43.84 | 60.08 |
|        table        | 53.78 | 68.78 |
|       mountain      |  54.0 | 67.07 |
|        plant        | 52.14 | 63.72 |
|       curtain       | 70.34 | 86.84 |
|        chair        | 48.76 | 64.76 |
|         car         | 80.86 | 91.03 |
|        water        | 51.06 | 61.88 |
|       painting      | 66.27 | 81.24 |
|         sofa        | 60.59 | 81.33 |
|        shelf        | 44.65 | 66.69 |
|        house        | 50.53 | 64.09 |
|         sea         | 58.92 | 82.86 |
|        mirror       | 63.37 | 71.49 |
|         rug         | 65.78 | 73.28 |
|        field        | 22.44 |  47.6 |
|       armchair      | 30.38 | 47.18 |
|         seat        | 64.39 | 83.54 |
|        fence        | 43.45 | 60.98 |
|         desk        | 41.96 | 65.99 |
|         rock        | 43.32 | 66.81 |
|       wardrobe      |  45.2 | 59.88 |
|         lamp        | 46.61 | 62.66 |
|       bathtub       | 78.93 | 88.29 |
|       railing       | 30.88 | 43.42 |
|       cushion       | 50.18 | 65.19 |
|         base        | 32.34 | 52.33 |
|         box         | 20.44 | 27.82 |
|        column       | 40.43 | 54.25 |
|      signboard      | 28.85 | 39.43 |
|   chest of drawers  | 37.34 | 57.97 |
|       counter       |  31.4 | 38.63 |
|         sand        | 33.89 | 52.39 |
|         sink        | 61.94 | 70.48 |
|      skyscraper     | 63.94 | 82.94 |
|      fireplace      | 61.84 |  89.3 |
|     refrigerator    | 60.49 | 77.29 |
|      grandstand     | 49.12 | 76.11 |
|         path        | 23.89 |  34.4 |
|        stairs       | 24.52 | 35.33 |
|        runway       | 65.25 | 88.92 |
|         case        | 57.56 | 77.45 |
|      pool table     | 87.13 | 97.02 |
|        pillow       |  49.4 | 59.44 |
|     screen door     | 66.24 | 75.36 |
|       stairway      | 28.77 | 45.22 |
|        river        | 13.72 | 32.26 |
|        bridge       | 57.07 | 76.63 |
|       bookcase      | 36.46 | 59.49 |
|        blind        | 29.79 |  32.3 |
|     coffee table    | 51.98 | 79.06 |
|        toilet       | 69.92 | 90.17 |
|        flower       | 29.85 | 46.97 |
|         book        | 44.36 | 61.75 |
|         hill        |  6.47 | 17.52 |
|        bench        | 38.23 | 48.82 |
|      countertop     | 48.37 | 65.57 |
|        stove        | 59.34 | 75.66 |
|         palm        | 49.61 | 69.35 |
|    kitchen island   | 39.17 | 72.59 |
|       computer      |  57.0 | 72.94 |
|     swivel chair    | 37.48 | 52.85 |
|         boat        | 60.14 | 70.44 |
|         bar         | 50.01 | 68.18 |
|    arcade machine   | 67.74 | 89.79 |
|        hovel        | 51.94 | 79.07 |
|         bus         | 77.52 | 87.78 |
|        towel        |  55.2 | 74.24 |
|        light        | 20.34 | 21.55 |
|        truck        | 22.17 | 34.31 |
|        tower        | 25.09 |  36.1 |
|      chandelier     |  58.1 | 75.98 |
|        awning       |  19.3 | 22.51 |
|     streetlight     |  5.24 |  7.06 |
|        booth        | 38.57 | 43.23 |
| television receiver | 62.86 |  74.0 |
|       airplane      |  50.4 | 61.14 |
|      dirt track     | 12.49 | 17.08 |
|       apparel       | 22.61 | 34.62 |
|         pole        | 13.92 | 16.84 |
|         land        |  0.02 |  0.03 |
|      bannister      |  1.69 |  2.2  |
|      escalator      | 58.66 | 72.23 |
|       ottoman       |  35.6 | 48.19 |
|        bottle       |  14.9 | 17.13 |
|        buffet       | 35.97 | 42.04 |
|        poster       |  7.08 |  9.21 |
|        stage        |  9.86 | 22.73 |
|         van         | 30.58 | 37.22 |
|         ship        |  5.83 |  7.81 |
|       fountain      | 24.09 | 29.96 |
|    conveyer belt    | 55.26 | 84.27 |
|        canopy       | 29.61 | 40.74 |
|        washer       | 60.52 | 74.16 |
|      plaything      |  9.71 |  16.1 |
|    swimming pool    | 44.71 | 68.18 |
|        stool        | 14.42 | 20.77 |
|        barrel       |  28.1 |  61.0 |
|        basket       | 13.69 | 15.75 |
|      waterfall      | 56.69 | 85.41 |
|         tent        | 85.34 | 99.23 |
|         bag         |  0.39 |  0.39 |
|       minibike      | 53.95 | 63.58 |
|        cradle       | 63.95 | 85.81 |
|         oven        | 19.86 | 25.21 |
|         ball        | 46.67 | 59.18 |
|         food        | 42.97 |  50.1 |
|         step        |  4.51 |  4.92 |
|         tank        | 56.36 | 59.46 |
|      trade name     | 16.39 | 18.17 |
|      microwave      | 54.87 | 63.01 |
|         pot         | 35.81 | 42.15 |
|        animal       | 61.05 | 63.02 |
|       bicycle       | 41.28 | 61.84 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     | 29.56 | 39.87 |
|        screen       |  44.7 | 87.01 |
|       blanket       |  2.94 |  3.06 |
|      sculpture      | 35.56 | 43.51 |
|         hood        | 45.81 | 52.15 |
|        sconce       |  0.46 |  0.46 |
|         vase        | 18.46 | 28.61 |
|    traffic light    |  0.0  |  0.0  |
|         tray        |  0.57 |  0.61 |
|        ashcan       |  9.53 |  9.9  |
|         fan         | 17.42 | 18.81 |
|         pier        | 10.35 | 42.08 |
|      crt screen     |  0.07 |  0.13 |
|        plate        | 40.94 | 50.62 |
|       monitor       |  1.17 |  1.74 |
|    bulletin board   |  6.16 |  7.01 |
|        shower       |  0.0  |  0.0  |
|       radiator      |  9.95 |  9.95 |
|        glass        |  0.0  |  0.0  |
|        clock        |  0.0  |  0.0  |
|         flag        | 12.81 | 12.89 |
+---------------------+-------+-------+
12/06 17:38:59 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.9400  mIoU: 40.5500  mAcc: 52.6800  data_time: 0.0026  time: 0.3159
12/06 17:39:03 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 (main, Sep 11 2023, 13:44:35) [GCC 11.2.0]
    CUDA available: True
    numpy_random_seed: 403910324
    GPU 0: NVIDIA TITAN Xp
    CUDA_HOME: None
    GCC: gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
    PyTorch: 2.0.0
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.15.0
    OpenCV: 4.8.1
    MMEngine: 0.9.1

Runtime environment:
    cudnn_benchmark: True
    dist_cfg: {'backend': 'nccl'}
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    seed: 403910324
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

12/06 17:39:03 - mmengine - INFO - Config:
backbone_norm_cfg = dict(eps=1e-06, requires_grad=True, type='LN')
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = 'work_dirs/setrvpt_vit-l_pup-noaux_8xb2-160k_ade20k-512x512/20231125_124611/iter_160000.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=[],
    backbone=dict(
        drop_rate=0.0,
        embed_dims=1024,
        img_size=(
            512,
            512,
        ),
        in_channels=3,
        init_cfg=dict(
            checkpoint='pretrain/vit_large_p16.pth', type='Pretrained'),
        interpolate_mode='bilinear',
        norm_cfg=dict(eps=1e-06, requires_grad=True, type='LN'),
        num_heads=16,
        num_layers=24,
        out_indices=23,
        patch_size=16,
        prompt_cfg=dict(
            depth=24,
            dropout=0.1,
            init='random',
            length=50,
            location='prepend',
            shared=False),
        type='PromptedVisionTransformer',
        with_cls_token=True),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0,
        in_channels=1024,
        in_index=0,
        kernel_size=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=4,
        type='SETRUPHead',
        up_scale=2),
    pretrained=None,
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
num_layers = 24
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.0005, momentum=0.9, type='SGD', weight_decay=0.0),
    paramwise_cfg=dict(custom_keys=dict(head=dict(lr_mult=1.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.0005, momentum=0.9, type='SGD', weight_decay=0.0)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
record_gpu_snapshot = False
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=8,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=8,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_log_dir = 'work_dirs/setrvpt_vit-l_pup-noaux_8xb2-160k_ade20k-512x512/20231125_124611'
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = 'work_dirs/setrvpt_vit-l_pup-noaux_8xb2-160k_ade20k-512x512/20231125_124611/test'

/home/s1952889/final-project/implementation/mmsegmentation/mmseg/models/builder.py:36: UserWarning: ``build_loss`` would be deprecated soon, please use ``mmseg.registry.MODELS.build()`` 
  warnings.warn('``build_loss`` would be deprecated soon, please use '
/home/s1952889/final-project/implementation/mmsegmentation/mmseg/models/losses/cross_entropy_loss.py:249: UserWarning: Default ``avg_non_ignore`` is False, if you would like to ignore the certain label and average loss over non-ignore labels, which is the same with PyTorch official cross_entropy, set ``avg_non_ignore=True``.
  warnings.warn(
12/06 17:39:07 - mmengine - INFO - Total parameters: 309546646
12/06 17:39:07 - mmengine - INFO - Trainable parameters: 5400214
12/06 17:39:08 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
/home/s1952889/final-project/implementation/mmsegmentation/mmseg/engine/hooks/visualization_hook.py:61: UserWarning: The draw is False, it means that the hook for visualization will not take effect. The results will NOT be visualized or stored.
  warnings.warn('The draw is False, it means that the '
12/06 17:39:08 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
/home/s1952889/final-project/implementation/mmsegmentation/mmseg/datasets/transforms/loading.py:83: UserWarning: `reduce_zero_label` will be deprecated, if you would like to ignore the zero label, please set `reduce_zero_label=True` when dataset initialized
  warnings.warn('`reduce_zero_label` will be deprecated, '
12/06 17:39:08 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: work_dirs/setrvpt_vit-l_pup-noaux_8xb2-160k_ade20k-512x512/20231125_124611/iter_160000.pth
12/06 17:40:05 - mmengine - INFO - Load checkpoint from work_dirs/setrvpt_vit-l_pup-noaux_8xb2-160k_ade20k-512x512/20231125_124611/iter_160000.pth
12/06 17:40:37 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:20:50  time: 0.4955  data_time: 0.0023  memory: 10094  
12/06 17:40:56 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:16:23  time: 0.4741  data_time: 0.0022  memory: 9945  
12/06 17:41:10 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:13:20  time: 0.2496  data_time: 0.0020  memory: 9699  
12/06 17:41:28 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:12:27  time: 0.3418  data_time: 0.0021  memory: 11727  
12/06 17:41:46 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:11:48  time: 0.2378  data_time: 0.0021  memory: 9704  
12/06 17:42:01 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:10:57  time: 0.2484  data_time: 0.0022  memory: 9702  
12/06 17:42:16 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:10:18  time: 0.2252  data_time: 0.0020  memory: 9704  
12/06 17:42:30 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:09:40  time: 0.2455  data_time: 0.0020  memory: 9703  
12/06 17:42:41 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:08:57  time: 0.2195  data_time: 0.0020  memory: 1901  
12/06 17:42:54 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:08:26  time: 0.2276  data_time: 0.0020  memory: 9696  
12/06 17:43:06 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:07:58  time: 0.2563  data_time: 0.0021  memory: 1931  
12/06 17:43:18 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:07:31  time: 0.2480  data_time: 0.0021  memory: 1940  
12/06 17:43:32 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:07:11  time: 0.3774  data_time: 0.0020  memory: 10242  
12/06 17:43:46 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:06:51  time: 0.2500  data_time: 0.0021  memory: 9703  
12/06 17:44:01 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:06:33  time: 0.3321  data_time: 0.0021  memory: 10393  
12/06 17:44:12 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:06:10  time: 0.2382  data_time: 0.0022  memory: 1838  
12/06 17:44:24 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:05:50  time: 0.2405  data_time: 0.0021  memory: 1812  
12/06 17:44:35 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:05:29  time: 0.2090  data_time: 0.0020  memory: 1875  
12/06 17:44:48 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:05:12  time: 0.2332  data_time: 0.0020  memory: 9696  
12/06 17:44:59 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:04:54  time: 0.2266  data_time: 0.0020  memory: 1916  
12/06 17:45:14 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:04:39  time: 0.3719  data_time: 0.0020  memory: 10538  
12/06 17:45:27 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:23  time: 0.2340  data_time: 0.0021  memory: 9700  
12/06 17:45:40 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:04:07  time: 0.2383  data_time: 0.0020  memory: 9696  
12/06 17:45:52 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:03:51  time: 0.2312  data_time: 0.0020  memory: 2846  
12/06 17:46:05 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:35  time: 0.2328  data_time: 0.0020  memory: 9700  
12/06 17:46:16 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:03:19  time: 0.2417  data_time: 0.0020  memory: 1825  
12/06 17:46:27 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:04  time: 0.2153  data_time: 0.0020  memory: 1825  
12/06 17:46:40 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:02:49  time: 0.2512  data_time: 0.0020  memory: 9702  
12/06 17:46:52 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:34  time: 0.2484  data_time: 0.0019  memory: 1916  
12/06 17:47:03 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:19  time: 0.2173  data_time: 0.0020  memory: 1823  
12/06 17:47:16 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:05  time: 0.2457  data_time: 0.0020  memory: 1903  
12/06 17:47:27 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:50  time: 0.2335  data_time: 0.0021  memory: 1812  
12/06 17:47:41 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:36  time: 0.2171  data_time: 0.0020  memory: 9704  
12/06 17:47:53 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:22  time: 0.2398  data_time: 0.0020  memory: 1913  
12/06 17:48:05 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:08  time: 0.2346  data_time: 0.0020  memory: 1929  
12/06 17:48:16 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:54  time: 0.2411  data_time: 0.0022  memory: 1836  
12/06 17:48:28 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:40  time: 0.2381  data_time: 0.0021  memory: 1747  
12/06 17:48:39 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:27  time: 0.2301  data_time: 0.0020  memory: 1970  
12/06 17:48:54 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:13  time: 0.2290  data_time: 0.0020  memory: 9698  
12/06 17:49:05 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.2106  data_time: 0.0019  memory: 1979  
12/06 17:49:05 - mmengine - INFO - per class results:
12/06 17:49:05 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 74.19 | 86.32 |
|       building      |  81.9 | 92.27 |
|         sky         |  92.9 | 96.49 |
|        floor        | 79.38 | 89.18 |
|         tree        | 72.72 | 86.16 |
|       ceiling       | 81.07 | 89.32 |
|         road        | 81.41 | 89.12 |
|         bed         | 86.08 | 93.78 |
|      windowpane     |  58.3 |  76.0 |
|        grass        | 65.19 | 79.05 |
|       cabinet       |  55.0 | 68.33 |
|       sidewalk      | 60.18 | 76.75 |
|        person       | 74.93 |  87.6 |
|        earth        | 34.34 | 49.47 |
|         door        | 43.12 | 57.56 |
|        table        | 52.11 | 68.08 |
|       mountain      | 56.51 |  71.9 |
|        plant        |  50.6 | 61.27 |
|       curtain       | 69.27 | 83.33 |
|        chair        |  48.0 | 62.57 |
|         car         | 79.76 | 91.52 |
|        water        |  58.0 | 73.74 |
|       painting      |  65.8 | 80.74 |
|         sofa        | 62.19 | 77.28 |
|        shelf        | 40.75 | 55.96 |
|        house        | 52.22 | 74.59 |
|         sea         | 59.81 | 76.39 |
|        mirror       |  58.0 | 69.13 |
|         rug         | 64.52 | 72.63 |
|        field        | 26.98 | 45.06 |
|       armchair      | 36.02 | 58.88 |
|         seat        | 60.52 | 82.35 |
|        fence        |  40.1 | 54.75 |
|         desk        | 38.75 | 63.99 |
|         rock        | 42.96 | 65.54 |
|       wardrobe      | 47.97 | 66.52 |
|         lamp        | 44.38 | 60.38 |
|       bathtub       | 74.67 | 83.42 |
|       railing       | 32.27 |  44.0 |
|       cushion       | 46.22 | 61.19 |
|         base        | 27.79 | 48.68 |
|         box         | 21.27 | 30.05 |
|        column       | 40.39 | 56.51 |
|      signboard      |  28.2 | 38.24 |
|   chest of drawers  | 34.58 |  51.5 |
|       counter       | 28.43 |  36.4 |
|         sand        | 39.91 | 63.27 |
|         sink        | 58.09 |  65.4 |
|      skyscraper     | 52.26 | 66.01 |
|      fireplace      |  61.3 | 86.94 |
|     refrigerator    | 61.28 | 75.05 |
|      grandstand     | 41.67 | 84.82 |
|         path        | 28.18 | 36.41 |
|        stairs       | 26.97 | 34.34 |
|        runway       |  66.2 | 86.43 |
|         case        | 59.81 | 76.14 |
|      pool table     | 85.95 | 94.61 |
|        pillow       | 52.46 | 64.73 |
|     screen door     | 65.35 | 77.23 |
|       stairway      | 32.33 | 46.78 |
|        river        | 15.37 | 29.04 |
|        bridge       | 37.91 | 48.28 |
|       bookcase      | 35.44 |  62.9 |
|        blind        |  39.5 | 44.82 |
|     coffee table    |  53.1 | 79.82 |
|        toilet       | 73.44 |  89.1 |
|        flower       | 31.01 | 40.89 |
|         book        | 42.25 | 58.54 |
|         hill        | 10.03 | 18.78 |
|        bench        | 43.53 | 51.33 |
|      countertop     | 51.16 | 68.44 |
|        stove        | 56.17 |  69.6 |
|         palm        | 46.07 | 64.54 |
|    kitchen island   | 37.28 | 76.58 |
|       computer      | 60.26 | 78.94 |
|     swivel chair    | 35.75 | 56.77 |
|         boat        | 64.23 | 82.85 |
|         bar         |  52.0 | 67.96 |
|    arcade machine   | 74.76 | 83.42 |
|        hovel        | 47.93 | 73.38 |
|         bus         | 78.44 | 89.91 |
|        towel        | 48.31 | 70.72 |
|        light        | 32.98 | 37.58 |
|        truck        | 31.57 | 42.46 |
|        tower        |  23.6 | 36.92 |
|      chandelier     | 55.77 | 72.28 |
|        awning       |  27.9 | 34.46 |
|     streetlight     |  6.71 |  9.5  |
|        booth        | 31.93 | 37.93 |
| television receiver |  60.2 | 71.93 |
|       airplane      | 51.88 | 61.24 |
|      dirt track     |  9.82 | 10.93 |
|       apparel       | 24.82 | 34.78 |
|         pole        |  8.95 | 10.54 |
|         land        |  2.57 |  4.17 |
|      bannister      |  1.37 |  1.68 |
|      escalator      |  46.1 | 73.05 |
|       ottoman       | 32.58 |  43.2 |
|        bottle       | 33.08 | 45.82 |
|        buffet       | 38.39 | 50.21 |
|        poster       | 23.68 | 30.44 |
|        stage        | 19.54 | 39.92 |
|         van         | 28.49 | 35.17 |
|         ship        | 72.51 | 87.98 |
|       fountain      | 41.84 | 49.69 |
|    conveyer belt    | 63.18 | 91.54 |
|        canopy       | 48.04 | 69.07 |
|        washer       | 72.09 | 84.89 |
|      plaything      |  9.64 |  15.3 |
|    swimming pool    | 46.27 | 60.82 |
|        stool        | 14.25 |  17.3 |
|        barrel       | 30.75 | 48.22 |
|        basket       | 23.23 | 29.27 |
|      waterfall      | 71.03 | 87.21 |
|         tent        | 82.25 | 99.42 |
|         bag         |  5.21 |  5.43 |
|       minibike      | 61.12 | 74.27 |
|        cradle       |  58.1 | 82.66 |
|         oven        | 14.82 | 24.93 |
|         ball        | 41.26 |  62.1 |
|         food        |  39.2 | 42.73 |
|         step        |  1.37 |  1.52 |
|         tank        | 49.52 | 53.37 |
|      trade name     | 13.43 | 14.06 |
|      microwave      | 63.13 | 70.76 |
|         pot         | 34.25 | 37.87 |
|        animal       | 46.09 | 47.24 |
|       bicycle       | 49.87 | 70.47 |
|         lake        | 42.17 | 48.59 |
|      dishwasher     | 25.21 | 39.19 |
|        screen       | 60.56 | 88.22 |
|       blanket       |  3.47 |  4.06 |
|      sculpture      | 40.66 |  53.9 |
|         hood        |  47.1 | 54.14 |
|        sconce       |  0.56 |  0.56 |
|         vase        | 17.18 | 21.18 |
|    traffic light    |  3.32 |  3.49 |
|         tray        |  0.53 |  0.55 |
|        ashcan       | 21.41 | 25.44 |
|         fan         | 37.32 | 43.89 |
|         pier        | 31.26 | 37.29 |
|      crt screen     |  0.07 |  0.28 |
|        plate        | 39.72 | 50.81 |
|       monitor       |  1.25 |  1.6  |
|    bulletin board   | 29.71 | 35.85 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 35.77 | 36.58 |
|        glass        |  0.0  |  0.0  |
|        clock        |  2.35 |  2.36 |
|         flag        |  40.9 | 43.49 |
+---------------------+-------+-------+
12/06 17:49:05 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.8700  mIoU: 42.8000  mAcc: 55.0200  data_time: 0.0026  time: 0.2700
/bin/bash: /home/s1952889/miniconda3/envs/prompt/lib/libtinfo.so.6: no version information available (required by /bin/bash)
