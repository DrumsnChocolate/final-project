/bin/bash: /home/s1952889/miniconda3/envs/prompt/lib/libtinfo.so.6: no version information available (required by /bin/bash)
An exception occurred in telemetry logging.Disabling telemetry to prevent further exceptions.
Traceback (most recent call last):
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.11/site-packages/iopath/common/file_io.py", line 946, in __log_tmetry_keys
    handler.log_event()
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.11/site-packages/iopath/common/event_logger.py", line 97, in log_event
    del self._evt
        ^^^^^^^^^
AttributeError: 'NativePathHandler' object has no attribute '_evt'
Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'mammo-cbis', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/25 16:31:34 visual_prompt]: Rank of current process: 0. World size: 1
[09/25 16:31:34 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              0
GPU 0                NVIDIA A100-PCIE-40GB
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/25 16:31:34 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'mammo-cbis', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/25 16:31:34 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/25 16:31:34 visual_prompt]: Training with config:
[09/25 16:31:34 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/mammo-cbis/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr50.0_wd0.01/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.01, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 50.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'mammo-cbis', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/25 16:31:34 visual_prompt]: Loading training data...
[09/25 16:31:34 visual_prompt]: Constructing mammo-cbis dataset train...
[09/25 16:31:35 visual_prompt]: Loading validation data...
[09/25 16:31:35 visual_prompt]: Constructing mammo-cbis dataset val...
[09/25 16:31:35 visual_prompt]: Constructing models...
[09/25 16:31:37 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/25 16:31:37 visual_prompt]: tuned percent:0.536
[09/25 16:31:39 visual_prompt]: Device used for model: 0
[09/25 16:31:39 visual_prompt]: Setting up Evaluator...
[09/25 16:31:39 visual_prompt]: Setting up Trainer...
[09/25 16:31:39 visual_prompt]: 	Setting up the optimizer...
[09/25 16:31:39 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/25 16:38:46 visual_prompt]: Epoch 1 / 100: avg data time: 1.16e+01, avg batch time: 12.1828, average train loss: 1.4903
[09/25 16:39:41 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2212, average loss: 1.4710
[09/25 16:39:41 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.15	
[09/25 16:39:41 visual_prompt]: Best epoch 1: best metric: 0.537
[09/25 16:39:41 visual_prompt]: Training 2 / 100 epoch, with learning rate 5.0
[09/25 16:46:07 visual_prompt]: Epoch 2 / 100: avg data time: 1.05e+01, avg batch time: 11.0067, average train loss: 30.7318
[09/25 16:46:52 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.2349, average loss: 20.8553
[09/25 16:46:52 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.80	
[09/25 16:46:52 visual_prompt]: Training 3 / 100 epoch, with learning rate 10.0
[09/25 16:53:18 visual_prompt]: Epoch 3 / 100: avg data time: 1.06e+01, avg batch time: 11.0295, average train loss: 28.5547
[09/25 16:54:04 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.2224, average loss: 12.8502
[09/25 16:54:04 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 40.05	
[09/25 16:54:04 visual_prompt]: Training 4 / 100 epoch, with learning rate 15.0
[09/25 17:00:30 visual_prompt]: Epoch 4 / 100: avg data time: 1.06e+01, avg batch time: 11.0387, average train loss: 35.4937
[09/25 17:01:15 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.2402, average loss: 1.0600
[09/25 17:01:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 40.24	
[09/25 17:01:15 visual_prompt]: Training 5 / 100 epoch, with learning rate 20.0
[09/25 17:07:39 visual_prompt]: Epoch 5 / 100: avg data time: 1.05e+01, avg batch time: 10.9759, average train loss: 45.3974
[09/25 17:08:25 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2356, average loss: 191.9768
[09/25 17:08:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.35	
[09/25 17:08:25 visual_prompt]: Training 6 / 100 epoch, with learning rate 25.0
[09/25 17:14:49 visual_prompt]: Epoch 6 / 100: avg data time: 1.05e+01, avg batch time: 10.9832, average train loss: 71.6381
[09/25 17:15:34 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.2273, average loss: 3.9827
[09/25 17:15:34 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.42	
[09/25 17:15:34 visual_prompt]: Training 7 / 100 epoch, with learning rate 30.0
[09/25 17:22:00 visual_prompt]: Epoch 7 / 100: avg data time: 1.05e+01, avg batch time: 11.0120, average train loss: 67.1750
[09/25 17:22:44 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2397, average loss: 18.9590
[09/25 17:22:44 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 40.42	
[09/25 17:22:44 visual_prompt]: Training 8 / 100 epoch, with learning rate 35.0
[09/25 17:29:10 visual_prompt]: Epoch 8 / 100: avg data time: 1.06e+01, avg batch time: 11.0206, average train loss: 87.6187
[09/25 17:29:56 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2232, average loss: 132.0871
[09/25 17:29:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 45.16	
[09/25 17:29:56 visual_prompt]: Training 9 / 100 epoch, with learning rate 40.0
[09/25 17:36:22 visual_prompt]: Epoch 9 / 100: avg data time: 1.06e+01, avg batch time: 11.0258, average train loss: 135.1996
[09/25 17:37:07 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2295, average loss: 87.7244
[09/25 17:37:07 visual_prompt]: Classification results with val_mammo-cbis: top1: 45.93	rocauc: 39.97	
[09/25 17:37:07 visual_prompt]: Training 10 / 100 epoch, with learning rate 45.0
[09/25 17:43:32 visual_prompt]: Epoch 10 / 100: avg data time: 1.05e+01, avg batch time: 10.9810, average train loss: 119.9019
[09/25 17:44:17 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.2413, average loss: 66.3752
[09/25 17:44:17 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.44	
[09/25 17:44:17 visual_prompt]: Training 11 / 100 epoch, with learning rate 50.0
[09/25 17:50:42 visual_prompt]: Epoch 11 / 100: avg data time: 1.06e+01, avg batch time: 11.0077, average train loss: 111.8179
[09/25 17:51:28 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2328, average loss: 96.2213
[09/25 17:51:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.46	
[09/25 17:51:28 visual_prompt]: Training 12 / 100 epoch, with learning rate 49.9847706754774
[09/25 17:57:53 visual_prompt]: Epoch 12 / 100: avg data time: 1.05e+01, avg batch time: 11.0032, average train loss: 167.6909
[09/25 17:58:38 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2401, average loss: 292.3350
[09/25 17:58:38 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 48.67	
[09/25 17:58:38 visual_prompt]: Training 13 / 100 epoch, with learning rate 49.939101256495604
[09/25 18:05:04 visual_prompt]: Epoch 13 / 100: avg data time: 1.06e+01, avg batch time: 11.0168, average train loss: 124.3367
[09/25 18:05:49 visual_prompt]: Inference (val):avg data time: 2.17e-05, avg batch time: 0.2278, average loss: 315.3519
[09/25 18:05:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 47.99	
[09/25 18:05:49 visual_prompt]: Training 14 / 100 epoch, with learning rate 49.86304738420683
[09/25 18:12:14 visual_prompt]: Epoch 14 / 100: avg data time: 1.05e+01, avg batch time: 10.9944, average train loss: 143.4093
[09/25 18:12:59 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2421, average loss: 16.0485
[09/25 18:12:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 45.19	
[09/25 18:12:59 visual_prompt]: Training 15 / 100 epoch, with learning rate 49.75670171853926
[09/25 18:19:24 visual_prompt]: Epoch 15 / 100: avg data time: 1.05e+01, avg batch time: 10.9805, average train loss: 159.6220
[09/25 18:20:09 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2326, average loss: 22.4826
[09/25 18:20:09 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 47.52	
[09/25 18:20:09 visual_prompt]: Training 16 / 100 epoch, with learning rate 49.6201938253052
[09/25 18:26:35 visual_prompt]: Epoch 16 / 100: avg data time: 1.05e+01, avg batch time: 11.0224, average train loss: 201.1519
[09/25 18:27:20 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2322, average loss: 267.3141
[09/25 18:27:20 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.21	
[09/25 18:27:20 visual_prompt]: Training 17 / 100 epoch, with learning rate 49.45369001834514
[09/25 18:33:48 visual_prompt]: Epoch 17 / 100: avg data time: 1.06e+01, avg batch time: 11.0737, average train loss: 184.5174
[09/25 18:34:34 visual_prompt]: Inference (val):avg data time: 2.23e-05, avg batch time: 0.2254, average loss: 363.3021
[09/25 18:34:34 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.08	
[09/25 18:34:34 visual_prompt]: Training 18 / 100 epoch, with learning rate 49.25739315689991
[09/25 18:40:59 visual_prompt]: Epoch 18 / 100: avg data time: 1.06e+01, avg batch time: 11.0054, average train loss: 122.3082
[09/25 18:41:44 visual_prompt]: Inference (val):avg data time: 2.04e-05, avg batch time: 0.2363, average loss: 182.4161
[09/25 18:41:44 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 46.19	
[09/25 18:41:44 visual_prompt]: Training 19 / 100 epoch, with learning rate 49.03154239845797
[09/25 18:48:07 visual_prompt]: Epoch 19 / 100: avg data time: 1.05e+01, avg batch time: 10.9494, average train loss: 173.5599
[09/25 18:48:53 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2305, average loss: 33.5188
[09/25 18:48:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 63.07	
[09/25 18:48:53 visual_prompt]: Training 20 / 100 epoch, with learning rate 48.77641290737884
[09/25 18:55:16 visual_prompt]: Epoch 20 / 100: avg data time: 1.05e+01, avg batch time: 10.9392, average train loss: 151.4193
[09/25 18:56:01 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.2322, average loss: 45.6429
[09/25 18:56:01 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.16	
[09/25 18:56:01 visual_prompt]: Training 21 / 100 epoch, with learning rate 48.49231551964771
[09/25 19:02:25 visual_prompt]: Epoch 21 / 100: avg data time: 1.05e+01, avg batch time: 10.9693, average train loss: 159.7278
[09/25 19:03:10 visual_prompt]: Inference (val):avg data time: 2.03e-05, avg batch time: 0.2299, average loss: 72.3464
[09/25 19:03:10 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.88	rocauc: 58.09	
[09/25 19:03:10 visual_prompt]: Best epoch 21: best metric: 0.549
[09/25 19:03:10 visual_prompt]: Training 22 / 100 epoch, with learning rate 48.17959636416968
[09/25 19:09:36 visual_prompt]: Epoch 22 / 100: avg data time: 1.05e+01, avg batch time: 11.0165, average train loss: 163.0613
[09/25 19:10:21 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.2324, average loss: 215.5745
[09/25 19:10:21 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.57	
[09/25 19:10:21 visual_prompt]: Training 23 / 100 epoch, with learning rate 47.83863644106502
[09/25 19:16:45 visual_prompt]: Epoch 23 / 100: avg data time: 1.05e+01, avg batch time: 10.9515, average train loss: 104.9521
[09/25 19:17:30 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2282, average loss: 157.8589
[09/25 19:17:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.81	
[09/25 19:17:30 visual_prompt]: Training 24 / 100 epoch, with learning rate 47.46985115747918
[09/25 19:23:54 visual_prompt]: Epoch 24 / 100: avg data time: 1.05e+01, avg batch time: 10.9569, average train loss: 126.0180
[09/25 19:24:39 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.2250, average loss: 68.8975
[09/25 19:24:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 58.41	
[09/25 19:24:39 visual_prompt]: Training 25 / 100 epoch, with learning rate 47.073689821473174
[09/25 19:31:04 visual_prompt]: Epoch 25 / 100: avg data time: 1.05e+01, avg batch time: 10.9859, average train loss: 94.9743
[09/25 19:31:49 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.2250, average loss: 42.6148
[09/25 19:31:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 43.97	
[09/25 19:31:49 visual_prompt]: Training 26 / 100 epoch, with learning rate 46.65063509461097
[09/25 19:38:13 visual_prompt]: Epoch 26 / 100: avg data time: 1.05e+01, avg batch time: 10.9886, average train loss: 90.5288
[09/25 19:38:58 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.2269, average loss: 306.2295
[09/25 19:38:58 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.87	
[09/25 19:38:58 visual_prompt]: Training 27 / 100 epoch, with learning rate 46.20120240391065
[09/25 19:45:22 visual_prompt]: Epoch 27 / 100: avg data time: 1.05e+01, avg batch time: 10.9436, average train loss: 106.2314
[09/25 19:46:07 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.2257, average loss: 130.6245
[09/25 19:46:07 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 61.28	
[09/25 19:46:07 visual_prompt]: Training 28 / 100 epoch, with learning rate 45.72593931387604
[09/25 19:52:33 visual_prompt]: Epoch 28 / 100: avg data time: 1.06e+01, avg batch time: 11.0295, average train loss: 131.0572
[09/25 19:53:18 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.2396, average loss: 39.5420
[09/25 19:53:18 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 41.41	
[09/25 19:53:18 visual_prompt]: Training 29 / 100 epoch, with learning rate 45.22542485937369
[09/25 19:59:43 visual_prompt]: Epoch 29 / 100: avg data time: 1.05e+01, avg batch time: 10.9954, average train loss: 149.9537
[09/25 20:00:28 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.2300, average loss: 209.5091
[09/25 20:00:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 62.62	
[09/25 20:00:28 visual_prompt]: Training 30 / 100 epoch, with learning rate 44.70026884016804
[09/25 20:06:54 visual_prompt]: Epoch 30 / 100: avg data time: 1.05e+01, avg batch time: 11.0007, average train loss: 112.8597
[09/25 20:07:39 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2302, average loss: 218.0409
[09/25 20:07:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.75	
[09/25 20:07:39 visual_prompt]: Training 31 / 100 epoch, with learning rate 44.15111107797445
[09/25 20:14:04 visual_prompt]: Epoch 31 / 100: avg data time: 1.06e+01, avg batch time: 11.0063, average train loss: 193.7665
[09/25 20:14:49 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.2309, average loss: 92.0672
[09/25 20:14:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.69	
[09/25 20:14:49 visual_prompt]: Training 32 / 100 epoch, with learning rate 43.57862063693486
[09/25 20:21:14 visual_prompt]: Epoch 32 / 100: avg data time: 1.05e+01, avg batch time: 11.0001, average train loss: 123.9459
[09/25 20:21:59 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2404, average loss: 68.9552
[09/25 20:21:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.75	rocauc: 47.85	
[09/25 20:21:59 visual_prompt]: Training 33 / 100 epoch, with learning rate 42.98349500846628
[09/25 20:28:26 visual_prompt]: Epoch 33 / 100: avg data time: 1.06e+01, avg batch time: 11.0406, average train loss: 130.1192
[09/25 20:29:11 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.2321, average loss: 74.3332
[09/25 20:29:11 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 48.06	
[09/25 20:29:11 visual_prompt]: Training 34 / 100 epoch, with learning rate 42.36645926147493
[09/25 20:35:37 visual_prompt]: Epoch 34 / 100: avg data time: 1.06e+01, avg batch time: 11.0211, average train loss: 96.6164
[09/25 20:36:22 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2337, average loss: 583.8135
[09/25 20:36:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 58.31	
[09/25 20:36:22 visual_prompt]: Training 35 / 100 epoch, with learning rate 41.72826515897145
[09/25 20:42:48 visual_prompt]: Epoch 35 / 100: avg data time: 1.06e+01, avg batch time: 11.0227, average train loss: 167.3533
[09/25 20:43:33 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2333, average loss: 186.6061
[09/25 20:43:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 41.71	
[09/25 20:43:33 visual_prompt]: Training 36 / 100 epoch, with learning rate 41.06969024216348
[09/25 20:49:58 visual_prompt]: Epoch 36 / 100: avg data time: 1.05e+01, avg batch time: 10.9891, average train loss: 146.6273
[09/25 20:50:43 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2293, average loss: 103.3731
[09/25 20:50:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 49.84	
[09/25 20:50:43 visual_prompt]: Training 37 / 100 epoch, with learning rate 40.391536883141455
[09/25 20:57:08 visual_prompt]: Epoch 37 / 100: avg data time: 1.05e+01, avg batch time: 10.9895, average train loss: 150.2833
[09/25 20:57:53 visual_prompt]: Inference (val):avg data time: 2.73e-05, avg batch time: 0.2418, average loss: 193.8114
[09/25 20:57:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.84	
[09/25 20:57:53 visual_prompt]: Training 38 / 100 epoch, with learning rate 39.69463130731183
[09/25 21:04:16 visual_prompt]: Epoch 38 / 100: avg data time: 1.05e+01, avg batch time: 10.9439, average train loss: 185.6134
[09/25 21:05:01 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.2351, average loss: 183.7030
[09/25 21:05:01 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.28	
[09/25 21:05:01 visual_prompt]: Training 39 / 100 epoch, with learning rate 38.97982258676867
[09/25 21:11:26 visual_prompt]: Epoch 39 / 100: avg data time: 1.05e+01, avg batch time: 10.9757, average train loss: 140.6193
[09/25 21:12:10 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2249, average loss: 65.1229
[09/25 21:12:10 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 48.19	
[09/25 21:12:10 visual_prompt]: Training 40 / 100 epoch, with learning rate 38.24798160583012
[09/25 21:18:35 visual_prompt]: Epoch 40 / 100: avg data time: 1.05e+01, avg batch time: 10.9838, average train loss: 76.7217
[09/25 21:19:20 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2305, average loss: 73.9360
[09/25 21:19:20 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.02	
[09/25 21:19:20 visual_prompt]: Training 41 / 100 epoch, with learning rate 37.5
[09/25 21:25:45 visual_prompt]: Epoch 41 / 100: avg data time: 1.05e+01, avg batch time: 10.9978, average train loss: 125.4445
[09/25 21:26:30 visual_prompt]: Inference (val):avg data time: 2.08e-05, avg batch time: 0.2319, average loss: 9.2597
[09/25 21:26:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.83	
[09/25 21:26:30 visual_prompt]: Training 42 / 100 epoch, with learning rate 36.736789069647266
[09/25 21:32:54 visual_prompt]: Epoch 42 / 100: avg data time: 1.05e+01, avg batch time: 10.9798, average train loss: 100.4637
[09/25 21:33:39 visual_prompt]: Inference (val):avg data time: 2.20e-05, avg batch time: 0.2317, average loss: 18.2445
[09/25 21:33:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 45.18	
[09/25 21:33:39 visual_prompt]: Training 43 / 100 epoch, with learning rate 35.959278669726935
[09/25 21:40:06 visual_prompt]: Epoch 43 / 100: avg data time: 1.06e+01, avg batch time: 11.0394, average train loss: 79.6850
[09/25 21:40:51 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2254, average loss: 31.1047
[09/25 21:40:51 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.88	
[09/25 21:40:51 visual_prompt]: Training 44 / 100 epoch, with learning rate 35.16841607689501
[09/25 21:47:21 visual_prompt]: Epoch 44 / 100: avg data time: 1.07e+01, avg batch time: 11.1304, average train loss: 78.2667
[09/25 21:48:06 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.2441, average loss: 211.3217
[09/25 21:48:06 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.26	
[09/25 21:48:06 visual_prompt]: Training 45 / 100 epoch, with learning rate 34.365164835397806
[09/25 21:54:35 visual_prompt]: Epoch 45 / 100: avg data time: 1.06e+01, avg batch time: 11.1043, average train loss: 94.9644
[09/25 21:55:21 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2291, average loss: 49.4926
[09/25 21:55:21 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.78	
[09/25 21:55:21 visual_prompt]: Training 46 / 100 epoch, with learning rate 33.55050358314172
[09/25 22:01:49 visual_prompt]: Epoch 46 / 100: avg data time: 1.06e+01, avg batch time: 11.0738, average train loss: 88.7738
[09/25 22:02:34 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2312, average loss: 251.6820
[09/25 22:02:34 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.13	
[09/25 22:02:34 visual_prompt]: Training 47 / 100 epoch, with learning rate 32.72542485937369
[09/25 22:09:03 visual_prompt]: Epoch 47 / 100: avg data time: 1.07e+01, avg batch time: 11.1244, average train loss: 127.7933
[09/25 22:09:49 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2331, average loss: 80.1200
[09/25 22:09:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 61.39	
[09/25 22:09:49 visual_prompt]: Training 48 / 100 epoch, with learning rate 31.89093389542498
[09/25 22:16:19 visual_prompt]: Epoch 48 / 100: avg data time: 1.07e+01, avg batch time: 11.1398, average train loss: 97.9766
[09/25 22:17:04 visual_prompt]: Inference (val):avg data time: 2.08e-05, avg batch time: 0.2329, average loss: 22.7801
[09/25 22:17:04 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 36.49	
[09/25 22:17:04 visual_prompt]: Training 49 / 100 epoch, with learning rate 31.04804738999169
[09/25 22:23:34 visual_prompt]: Epoch 49 / 100: avg data time: 1.07e+01, avg batch time: 11.1298, average train loss: 69.5247
[09/25 22:24:20 visual_prompt]: Inference (val):avg data time: 2.23e-05, avg batch time: 0.2310, average loss: 41.8498
[09/25 22:24:20 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 41.08	
[09/25 22:24:20 visual_prompt]: Training 50 / 100 epoch, with learning rate 30.19779227044398
[09/25 22:30:48 visual_prompt]: Epoch 50 / 100: avg data time: 1.06e+01, avg batch time: 11.0840, average train loss: 83.6247
[09/25 22:31:33 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2341, average loss: 26.7332
[09/25 22:31:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.77	
[09/25 22:31:33 visual_prompt]: Training 51 / 100 epoch, with learning rate 29.341204441673263
[09/25 22:38:03 visual_prompt]: Epoch 51 / 100: avg data time: 1.07e+01, avg batch time: 11.1257, average train loss: 64.6411
[09/25 22:38:48 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.2204, average loss: 55.5689
[09/25 22:38:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 49.92	
[09/25 22:38:48 visual_prompt]: Training 52 / 100 epoch, with learning rate 28.479327524001636
[09/25 22:45:18 visual_prompt]: Epoch 52 / 100: avg data time: 1.07e+01, avg batch time: 11.1395, average train loss: 78.3896
[09/25 22:46:03 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2363, average loss: 73.7059
[09/25 22:46:03 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.72	
[09/25 22:46:03 visual_prompt]: Training 53 / 100 epoch, with learning rate 27.61321158169134
[09/25 22:52:32 visual_prompt]: Epoch 53 / 100: avg data time: 1.07e+01, avg batch time: 11.1119, average train loss: 70.0301
[09/25 22:53:18 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.2381, average loss: 32.0213
[09/25 22:53:18 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 47.89	
[09/25 22:53:18 visual_prompt]: Training 54 / 100 epoch, with learning rate 26.74391184360313
[09/25 22:59:47 visual_prompt]: Epoch 54 / 100: avg data time: 1.07e+01, avg batch time: 11.1201, average train loss: 84.2588
[09/25 23:00:33 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.2335, average loss: 61.3422
[09/25 23:00:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 37.86	
[09/25 23:00:33 visual_prompt]: Training 55 / 100 epoch, with learning rate 25.872487417562528
[09/25 23:07:02 visual_prompt]: Epoch 55 / 100: avg data time: 1.07e+01, avg batch time: 11.1193, average train loss: 68.9366
[09/25 23:07:48 visual_prompt]: Inference (val):avg data time: 2.23e-05, avg batch time: 0.2420, average loss: 53.3251
[09/25 23:07:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 41.44	
[09/25 23:07:48 visual_prompt]: Training 56 / 100 epoch, with learning rate 25.0
[09/25 23:14:19 visual_prompt]: Epoch 56 / 100: avg data time: 1.07e+01, avg batch time: 11.1545, average train loss: 67.1197
[09/25 23:15:04 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.2253, average loss: 35.8667
[09/25 23:15:04 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 46.11	
[09/25 23:15:04 visual_prompt]: Training 57 / 100 epoch, with learning rate 24.127512582437483
[09/25 23:21:35 visual_prompt]: Epoch 57 / 100: avg data time: 1.07e+01, avg batch time: 11.1437, average train loss: 66.5896
[09/25 23:22:20 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.2337, average loss: 78.5289
[09/25 23:22:20 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.96	
[09/25 23:22:20 visual_prompt]: Training 58 / 100 epoch, with learning rate 23.256088156396867
[09/25 23:28:49 visual_prompt]: Epoch 58 / 100: avg data time: 1.06e+01, avg batch time: 11.1081, average train loss: 59.6981
[09/25 23:29:35 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2366, average loss: 117.8298
[09/25 23:29:35 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.10	
[09/25 23:29:35 visual_prompt]: Training 59 / 100 epoch, with learning rate 22.38678841830867
[09/25 23:36:04 visual_prompt]: Epoch 59 / 100: avg data time: 1.07e+01, avg batch time: 11.1135, average train loss: 45.6347
[09/25 23:36:49 visual_prompt]: Inference (val):avg data time: 2.14e-05, avg batch time: 0.2353, average loss: 25.4485
[09/25 23:36:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.48	
[09/25 23:36:49 visual_prompt]: Training 60 / 100 epoch, with learning rate 21.52067247599837
[09/25 23:43:17 visual_prompt]: Epoch 60 / 100: avg data time: 1.06e+01, avg batch time: 11.0912, average train loss: 48.3096
[09/25 23:44:03 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2278, average loss: 81.4751
[09/25 23:44:03 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 47.34	
[09/25 23:44:03 visual_prompt]: Training 61 / 100 epoch, with learning rate 20.65879555832674
[09/25 23:50:34 visual_prompt]: Epoch 61 / 100: avg data time: 1.07e+01, avg batch time: 11.1724, average train loss: 49.5041
[09/25 23:51:19 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.2266, average loss: 23.8310
[09/25 23:51:19 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 43.83	
[09/25 23:51:19 visual_prompt]: Training 62 / 100 epoch, with learning rate 19.80220772955602
[09/25 23:57:49 visual_prompt]: Epoch 62 / 100: avg data time: 1.07e+01, avg batch time: 11.1233, average train loss: 52.0183
[09/25 23:58:35 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2223, average loss: 126.9567
[09/25 23:58:35 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 41.09	
[09/25 23:58:35 visual_prompt]: Training 63 / 100 epoch, with learning rate 18.95195261000831
[09/26 00:05:04 visual_prompt]: Epoch 63 / 100: avg data time: 1.06e+01, avg batch time: 11.1130, average train loss: 38.8390
[09/26 00:05:49 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.2370, average loss: 0.7994
[09/26 00:05:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 45.53	rocauc: 40.67	
[09/26 00:05:49 visual_prompt]: Training 64 / 100 epoch, with learning rate 18.10906610457502
[09/26 00:12:19 visual_prompt]: Epoch 64 / 100: avg data time: 1.07e+01, avg batch time: 11.1181, average train loss: 35.9263
[09/26 00:13:04 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.2253, average loss: 13.5344
[09/26 00:13:04 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.18	
[09/26 00:13:04 visual_prompt]: Training 65 / 100 epoch, with learning rate 17.274575140626318
[09/26 00:19:33 visual_prompt]: Epoch 65 / 100: avg data time: 1.07e+01, avg batch time: 11.1176, average train loss: 43.3469
[09/26 00:20:19 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2420, average loss: 33.7960
[09/26 00:20:19 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 46.62	
[09/26 00:20:19 visual_prompt]: Training 66 / 100 epoch, with learning rate 16.449496416858285
[09/26 00:26:48 visual_prompt]: Epoch 66 / 100: avg data time: 1.07e+01, avg batch time: 11.1025, average train loss: 42.2146
[09/26 00:27:33 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2318, average loss: 88.4970
[09/26 00:27:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.33	
[09/26 00:27:33 visual_prompt]: Training 67 / 100 epoch, with learning rate 15.634835164602197
[09/26 00:34:01 visual_prompt]: Epoch 67 / 100: avg data time: 1.06e+01, avg batch time: 11.0948, average train loss: 41.1143
[09/26 00:34:47 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.2361, average loss: 20.6780
[09/26 00:34:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.29	
[09/26 00:34:47 visual_prompt]: Training 68 / 100 epoch, with learning rate 14.831583923104999
[09/26 00:41:14 visual_prompt]: Epoch 68 / 100: avg data time: 1.06e+01, avg batch time: 11.0740, average train loss: 33.2861
[09/26 00:42:00 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2323, average loss: 108.5231
[09/26 00:42:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.55	
[09/26 00:42:00 visual_prompt]: Training 69 / 100 epoch, with learning rate 14.040721330273062
[09/26 00:48:30 visual_prompt]: Epoch 69 / 100: avg data time: 1.07e+01, avg batch time: 11.1427, average train loss: 33.2000
[09/26 00:49:16 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.2322, average loss: 17.9418
[09/26 00:49:16 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.99	
[09/26 00:49:16 visual_prompt]: Training 70 / 100 epoch, with learning rate 13.263210930352736
[09/26 00:55:45 visual_prompt]: Epoch 70 / 100: avg data time: 1.07e+01, avg batch time: 11.1103, average train loss: 22.0858
[09/26 00:56:30 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.2294, average loss: 39.0934
[09/26 00:56:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.47	
[09/26 00:56:30 visual_prompt]: Training 71 / 100 epoch, with learning rate 12.500000000000005
[09/26 01:03:00 visual_prompt]: Epoch 71 / 100: avg data time: 1.07e+01, avg batch time: 11.1223, average train loss: 23.4772
[09/26 01:03:45 visual_prompt]: Inference (val):avg data time: 2.03e-05, avg batch time: 0.2280, average loss: 3.0544
[09/26 01:03:45 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 40.48	
[09/26 01:03:45 visual_prompt]: Training 72 / 100 epoch, with learning rate 11.75201839416988
[09/26 01:10:13 visual_prompt]: Epoch 72 / 100: avg data time: 1.06e+01, avg batch time: 11.0918, average train loss: 25.1728
[09/26 01:10:59 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.2335, average loss: 57.7273
[09/26 01:10:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 46.06	
[09/26 01:10:59 visual_prompt]: Training 73 / 100 epoch, with learning rate 11.020177413231332
[09/26 01:17:29 visual_prompt]: Epoch 73 / 100: avg data time: 1.07e+01, avg batch time: 11.1416, average train loss: 32.8342
[09/26 01:18:14 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.2221, average loss: 25.6655
[09/26 01:18:14 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 47.76	
[09/26 01:18:14 visual_prompt]: Training 74 / 100 epoch, with learning rate 10.305368692688175
[09/26 01:24:41 visual_prompt]: Epoch 74 / 100: avg data time: 1.06e+01, avg batch time: 11.0511, average train loss: 19.6944
[09/26 01:25:27 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2388, average loss: 24.0264
[09/26 01:25:27 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 47.03	
[09/26 01:25:27 visual_prompt]: Training 75 / 100 epoch, with learning rate 9.608463116858543
[09/26 01:31:58 visual_prompt]: Epoch 75 / 100: avg data time: 1.07e+01, avg batch time: 11.1711, average train loss: 26.1556
[09/26 01:32:43 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.2425, average loss: 5.2405
[09/26 01:32:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 49.65	
[09/26 01:32:43 visual_prompt]: Training 76 / 100 epoch, with learning rate 8.930309757836516
[09/26 01:39:12 visual_prompt]: Epoch 76 / 100: avg data time: 1.06e+01, avg batch time: 11.1067, average train loss: 20.6234
[09/26 01:39:58 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2313, average loss: 7.3252
[09/26 01:39:58 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 46.25	
[09/26 01:39:58 visual_prompt]: Training 77 / 100 epoch, with learning rate 8.271734841028552
[09/26 01:46:27 visual_prompt]: Epoch 77 / 100: avg data time: 1.06e+01, avg batch time: 11.1017, average train loss: 20.9867
[09/26 01:47:12 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2315, average loss: 14.9281
[09/26 01:47:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 47.56	rocauc: 55.68	
[09/26 01:47:12 visual_prompt]: Training 78 / 100 epoch, with learning rate 7.633540738525066
[09/26 01:53:42 visual_prompt]: Epoch 78 / 100: avg data time: 1.07e+01, avg batch time: 11.1348, average train loss: 25.3578
[09/26 01:54:28 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.2243, average loss: 37.3003
[09/26 01:54:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.65	
[09/26 01:54:28 visual_prompt]: Training 79 / 100 epoch, with learning rate 7.016504991533726
[09/26 02:00:56 visual_prompt]: Epoch 79 / 100: avg data time: 1.06e+01, avg batch time: 11.0648, average train loss: 15.4222
[09/26 02:01:41 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2376, average loss: 2.0098
[09/26 02:01:41 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 42.92	
[09/26 02:01:41 visual_prompt]: Training 80 / 100 epoch, with learning rate 6.4213793630651415
[09/26 02:08:12 visual_prompt]: Epoch 80 / 100: avg data time: 1.07e+01, avg batch time: 11.1577, average train loss: 20.4217
[09/26 02:08:57 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.2383, average loss: 13.2036
[09/26 02:08:57 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.55	
[09/26 02:08:57 visual_prompt]: Training 81 / 100 epoch, with learning rate 5.848888922025552
[09/26 02:15:28 visual_prompt]: Epoch 81 / 100: avg data time: 1.07e+01, avg batch time: 11.1648, average train loss: 13.1049
[09/26 02:16:14 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.2253, average loss: 17.9195
[09/26 02:16:14 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.25	
[09/26 02:16:14 visual_prompt]: Training 82 / 100 epoch, with learning rate 5.2997311598319525
[09/26 02:22:41 visual_prompt]: Epoch 82 / 100: avg data time: 1.06e+01, avg batch time: 11.0557, average train loss: 10.1500
[09/26 02:23:27 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.2380, average loss: 8.5908
[09/26 02:23:27 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 59.45	
[09/26 02:23:27 visual_prompt]: Training 83 / 100 epoch, with learning rate 4.774575140626316
[09/26 02:29:56 visual_prompt]: Epoch 83 / 100: avg data time: 1.07e+01, avg batch time: 11.1256, average train loss: 9.5045
[09/26 02:30:42 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2330, average loss: 6.5500
[09/26 02:30:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.54	
[09/26 02:30:42 visual_prompt]: Training 84 / 100 epoch, with learning rate 4.27406068612396
[09/26 02:37:14 visual_prompt]: Epoch 84 / 100: avg data time: 1.07e+01, avg batch time: 11.1923, average train loss: 12.8883
[09/26 02:38:00 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.2277, average loss: 20.4552
[09/26 02:38:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 48.90	
[09/26 02:38:00 visual_prompt]: Training 85 / 100 epoch, with learning rate 3.798797596089351
[09/26 02:44:29 visual_prompt]: Epoch 85 / 100: avg data time: 1.07e+01, avg batch time: 11.1315, average train loss: 7.0122
[09/26 02:45:15 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2391, average loss: 2.4703
[09/26 02:45:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.65	
[09/26 02:45:15 visual_prompt]: Training 86 / 100 epoch, with learning rate 3.349364905389032
[09/26 02:51:44 visual_prompt]: Epoch 86 / 100: avg data time: 1.07e+01, avg batch time: 11.1086, average train loss: 5.2411
[09/26 02:52:29 visual_prompt]: Inference (val):avg data time: 4.42e-05, avg batch time: 0.2292, average loss: 6.1140
[09/26 02:52:29 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 58.72	
[09/26 02:52:29 visual_prompt]: Training 87 / 100 epoch, with learning rate 2.9263101785268253
[09/26 02:58:57 visual_prompt]: Epoch 87 / 100: avg data time: 1.06e+01, avg batch time: 11.0573, average train loss: 4.1704
[09/26 02:59:42 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2361, average loss: 6.4559
[09/26 02:59:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.93	
[09/26 02:59:42 visual_prompt]: Training 88 / 100 epoch, with learning rate 2.5301488425208296
[09/26 03:06:11 visual_prompt]: Epoch 88 / 100: avg data time: 1.07e+01, avg batch time: 11.1134, average train loss: 4.5181
[09/26 03:06:56 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.2275, average loss: 2.7197
[09/26 03:06:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.76	
[09/26 03:06:56 visual_prompt]: Training 89 / 100 epoch, with learning rate 2.1613635589349753
[09/26 03:13:26 visual_prompt]: Epoch 89 / 100: avg data time: 1.07e+01, avg batch time: 11.1249, average train loss: 3.4404
[09/26 03:14:11 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.2270, average loss: 2.8511
[09/26 03:14:11 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.07	
[09/26 03:14:11 visual_prompt]: Training 90 / 100 epoch, with learning rate 1.820403635830317
[09/26 03:20:40 visual_prompt]: Epoch 90 / 100: avg data time: 1.07e+01, avg batch time: 11.1076, average train loss: 4.1206
[09/26 03:21:26 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.2327, average loss: 1.1795
[09/26 03:21:26 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.40	
[09/26 03:21:26 visual_prompt]: Training 91 / 100 epoch, with learning rate 1.507684480352292
[09/26 03:27:55 visual_prompt]: Epoch 91 / 100: avg data time: 1.07e+01, avg batch time: 11.1228, average train loss: 1.6667
[09/26 03:28:40 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.2287, average loss: 1.1458
[09/26 03:28:40 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.07	
[09/26 03:28:40 visual_prompt]: Training 92 / 100 epoch, with learning rate 1.2235870926211616
[09/26 03:35:10 visual_prompt]: Epoch 92 / 100: avg data time: 1.06e+01, avg batch time: 11.1238, average train loss: 1.2683
[09/26 03:35:56 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.2291, average loss: 0.8086
[09/26 03:35:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.34	
[09/26 03:35:56 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.9684576015420276
[09/26 03:42:25 visual_prompt]: Epoch 93 / 100: avg data time: 1.06e+01, avg batch time: 11.1170, average train loss: 0.9066
[09/26 03:43:11 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2417, average loss: 0.8044
[09/26 03:43:11 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 47.13	
[09/26 03:43:11 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.7426068431000882
[09/26 03:49:39 visual_prompt]: Epoch 94 / 100: avg data time: 1.06e+01, avg batch time: 11.0967, average train loss: 0.8545
[09/26 03:50:24 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.2447, average loss: 1.7071
[09/26 03:50:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.76	
[09/26 03:50:24 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.5463099816548578
[09/26 03:56:53 visual_prompt]: Epoch 95 / 100: avg data time: 1.06e+01, avg batch time: 11.0959, average train loss: 0.9308
[09/26 03:57:39 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2307, average loss: 3.9594
[09/26 03:57:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.94	
[09/26 03:57:39 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.3798061746947995
[09/26 04:04:08 visual_prompt]: Epoch 96 / 100: avg data time: 1.06e+01, avg batch time: 11.1247, average train loss: 0.8891
[09/26 04:04:53 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2313, average loss: 0.8897
[09/26 04:04:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 48.03	
[09/26 04:04:53 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.24329828146074095
[09/26 04:11:23 visual_prompt]: Epoch 97 / 100: avg data time: 1.06e+01, avg batch time: 11.1234, average train loss: 0.7670
[09/26 04:12:08 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2341, average loss: 0.7296
[09/26 04:12:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.07	
[09/26 04:12:08 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.13695261579316775
[09/26 04:18:37 visual_prompt]: Epoch 98 / 100: avg data time: 1.06e+01, avg batch time: 11.0958, average train loss: 0.6981
[09/26 04:19:22 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.2205, average loss: 0.7449
[09/26 04:19:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.17	
[09/26 04:19:22 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.06089874350439506
[09/26 04:25:50 visual_prompt]: Epoch 99 / 100: avg data time: 1.06e+01, avg batch time: 11.0618, average train loss: 0.7068
[09/26 04:26:35 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2287, average loss: 0.7068
[09/26 04:26:35 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.13	
[09/26 04:26:35 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.015229324522605947
[09/26 04:33:06 visual_prompt]: Epoch 100 / 100: avg data time: 1.07e+01, avg batch time: 11.1503, average train loss: 0.6946
[09/26 04:33:51 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2277, average loss: 0.6922
[09/26 04:33:51 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.04	
[09/26 04:33:51 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 04:33:51 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              0
GPU 0                NVIDIA A100-PCIE-40GB
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 04:33:51 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'mammo-cbis', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 04:33:51 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 04:33:51 visual_prompt]: Training with config:
[09/26 04:33:51 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/mammo-cbis/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr50.0_wd0.001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 50.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'mammo-cbis', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 04:33:51 visual_prompt]: Loading training data...
[09/26 04:33:51 visual_prompt]: Constructing mammo-cbis dataset train...
[09/26 04:33:51 visual_prompt]: Loading validation data...
[09/26 04:33:51 visual_prompt]: Constructing mammo-cbis dataset val...
[09/26 04:33:51 visual_prompt]: Constructing models...
[09/26 04:33:54 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 04:33:54 visual_prompt]: tuned percent:0.536
[09/26 04:33:54 visual_prompt]: Device used for model: 0
[09/26 04:33:54 visual_prompt]: Setting up Evaluator...
[09/26 04:33:54 visual_prompt]: Setting up Trainer...
[09/26 04:33:54 visual_prompt]: 	Setting up the optimizer...
[09/26 04:33:54 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 04:40:20 visual_prompt]: Epoch 1 / 100: avg data time: 1.06e+01, avg batch time: 11.0271, average train loss: 1.4903
[09/26 04:41:05 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.2338, average loss: 1.4710
[09/26 04:41:05 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.15	
[09/26 04:41:05 visual_prompt]: Best epoch 1: best metric: 0.537
[09/26 04:41:05 visual_prompt]: Training 2 / 100 epoch, with learning rate 5.0
[09/26 04:47:32 visual_prompt]: Epoch 2 / 100: avg data time: 1.06e+01, avg batch time: 11.0532, average train loss: 25.8975
[09/26 04:48:17 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2402, average loss: 77.0776
[09/26 04:48:17 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.41	
[09/26 04:48:17 visual_prompt]: Training 3 / 100 epoch, with learning rate 10.0
[09/26 04:54:43 visual_prompt]: Epoch 3 / 100: avg data time: 1.06e+01, avg batch time: 11.0135, average train loss: 29.4540
[09/26 04:55:28 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.2322, average loss: 25.1232
[09/26 04:55:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.26	
[09/26 04:55:28 visual_prompt]: Training 4 / 100 epoch, with learning rate 15.0
[09/26 05:01:55 visual_prompt]: Epoch 4 / 100: avg data time: 1.06e+01, avg batch time: 11.0397, average train loss: 24.1737
[09/26 05:02:40 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2295, average loss: 10.2298
[09/26 05:02:40 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.94	
[09/26 05:02:40 visual_prompt]: Training 5 / 100 epoch, with learning rate 20.0
[09/26 05:09:06 visual_prompt]: Epoch 5 / 100: avg data time: 1.06e+01, avg batch time: 11.0173, average train loss: 29.7141
[09/26 05:09:51 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2285, average loss: 27.3433
[09/26 05:09:51 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 38.62	
[09/26 05:09:51 visual_prompt]: Training 6 / 100 epoch, with learning rate 25.0
[09/26 05:16:17 visual_prompt]: Epoch 6 / 100: avg data time: 1.05e+01, avg batch time: 11.0291, average train loss: 83.9533
[09/26 05:17:02 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2399, average loss: 1.9400
[09/26 05:17:02 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 47.20	
[09/26 05:17:02 visual_prompt]: Training 7 / 100 epoch, with learning rate 30.0
[09/26 05:23:29 visual_prompt]: Epoch 7 / 100: avg data time: 1.06e+01, avg batch time: 11.0275, average train loss: 68.1050
[09/26 05:24:14 visual_prompt]: Inference (val):avg data time: 2.17e-05, avg batch time: 0.2445, average loss: 260.0429
[09/26 05:24:14 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.24	
[09/26 05:24:14 visual_prompt]: Training 8 / 100 epoch, with learning rate 35.0
[09/26 05:30:40 visual_prompt]: Epoch 8 / 100: avg data time: 1.06e+01, avg batch time: 11.0299, average train loss: 138.2511
[09/26 05:31:25 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.2275, average loss: 51.4106
[09/26 05:31:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 41.89	
[09/26 05:31:25 visual_prompt]: Training 9 / 100 epoch, with learning rate 40.0
[09/26 05:37:51 visual_prompt]: Epoch 9 / 100: avg data time: 1.06e+01, avg batch time: 11.0258, average train loss: 99.3755
[09/26 05:38:36 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.2336, average loss: 107.6028
[09/26 05:38:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.28	
[09/26 05:38:36 visual_prompt]: Training 10 / 100 epoch, with learning rate 45.0
[09/26 05:45:02 visual_prompt]: Epoch 10 / 100: avg data time: 1.06e+01, avg batch time: 11.0285, average train loss: 81.7667
[09/26 05:45:47 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2354, average loss: 129.3184
[09/26 05:45:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 46.74	
[09/26 05:45:47 visual_prompt]: Training 11 / 100 epoch, with learning rate 50.0
[09/26 05:52:14 visual_prompt]: Epoch 11 / 100: avg data time: 1.06e+01, avg batch time: 11.0386, average train loss: 136.1361
[09/26 05:52:59 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2375, average loss: 235.6923
[09/26 05:52:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 43.89	
[09/26 05:52:59 visual_prompt]: Training 12 / 100 epoch, with learning rate 49.9847706754774
[09/26 05:59:25 visual_prompt]: Epoch 12 / 100: avg data time: 1.06e+01, avg batch time: 11.0350, average train loss: 111.3045
[09/26 06:00:10 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.2296, average loss: 154.4438
[09/26 06:00:10 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 41.03	
[09/26 06:00:10 visual_prompt]: Training 13 / 100 epoch, with learning rate 49.939101256495604
[09/26 06:06:36 visual_prompt]: Epoch 13 / 100: avg data time: 1.06e+01, avg batch time: 11.0032, average train loss: 126.3747
[09/26 06:07:21 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.2131, average loss: 24.3850
[09/26 06:07:21 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 58.72	
[09/26 06:07:21 visual_prompt]: Training 14 / 100 epoch, with learning rate 49.86304738420683
[09/26 06:13:46 visual_prompt]: Epoch 14 / 100: avg data time: 1.06e+01, avg batch time: 11.0096, average train loss: 101.0894
[09/26 06:14:31 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2310, average loss: 35.1746
[09/26 06:14:31 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 44.05	
[09/26 06:14:31 visual_prompt]: Training 15 / 100 epoch, with learning rate 49.75670171853926
[09/26 06:20:56 visual_prompt]: Epoch 15 / 100: avg data time: 1.05e+01, avg batch time: 10.9879, average train loss: 90.4069
[09/26 06:21:41 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.2335, average loss: 97.2683
[09/26 06:21:41 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.58	
[09/26 06:21:41 visual_prompt]: Training 16 / 100 epoch, with learning rate 49.6201938253052
[09/26 06:28:07 visual_prompt]: Epoch 16 / 100: avg data time: 1.06e+01, avg batch time: 11.0284, average train loss: 84.5982
[09/26 06:28:53 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.2357, average loss: 72.0583
[09/26 06:28:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 60.87	
[09/26 06:28:53 visual_prompt]: Training 17 / 100 epoch, with learning rate 49.45369001834514
[09/26 06:35:19 visual_prompt]: Epoch 17 / 100: avg data time: 1.06e+01, avg batch time: 11.0199, average train loss: 114.9979
[09/26 06:36:03 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2316, average loss: 96.0085
[09/26 06:36:03 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.57	
[09/26 06:36:03 visual_prompt]: Training 18 / 100 epoch, with learning rate 49.25739315689991
[09/26 06:42:30 visual_prompt]: Epoch 18 / 100: avg data time: 1.06e+01, avg batch time: 11.0302, average train loss: 105.2702
[09/26 06:43:15 visual_prompt]: Inference (val):avg data time: 2.01e-05, avg batch time: 0.2229, average loss: 34.3809
[09/26 06:43:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 48.09	
[09/26 06:43:15 visual_prompt]: Training 19 / 100 epoch, with learning rate 49.03154239845797
[09/26 06:49:40 visual_prompt]: Epoch 19 / 100: avg data time: 1.06e+01, avg batch time: 11.0078, average train loss: 110.6488
[09/26 06:50:25 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.2315, average loss: 5.4153
[09/26 06:50:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 44.27	
[09/26 06:50:25 visual_prompt]: Training 20 / 100 epoch, with learning rate 48.77641290737884
[09/26 06:56:51 visual_prompt]: Epoch 20 / 100: avg data time: 1.05e+01, avg batch time: 11.0089, average train loss: 93.8685
[09/26 06:57:36 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2409, average loss: 140.8704
[09/26 06:57:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 45.40	
[09/26 06:57:36 visual_prompt]: Training 21 / 100 epoch, with learning rate 48.49231551964771
[09/26 07:04:02 visual_prompt]: Epoch 21 / 100: avg data time: 1.06e+01, avg batch time: 11.0218, average train loss: 77.4552
[09/26 07:04:47 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2285, average loss: 203.2863
[09/26 07:04:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 39.92	
[09/26 07:04:47 visual_prompt]: Training 22 / 100 epoch, with learning rate 48.17959636416968
[09/26 07:11:13 visual_prompt]: Epoch 22 / 100: avg data time: 1.06e+01, avg batch time: 11.0261, average train loss: 139.1039
[09/26 07:11:58 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2268, average loss: 153.3928
[09/26 07:11:58 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 49.78	
[09/26 07:11:58 visual_prompt]: Training 23 / 100 epoch, with learning rate 47.83863644106502
[09/26 07:18:24 visual_prompt]: Epoch 23 / 100: avg data time: 1.06e+01, avg batch time: 11.0272, average train loss: 72.0162
[09/26 07:19:09 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.2259, average loss: 50.1808
[09/26 07:19:09 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.00	
[09/26 07:19:09 visual_prompt]: Training 24 / 100 epoch, with learning rate 47.46985115747918
[09/26 07:25:35 visual_prompt]: Epoch 24 / 100: avg data time: 1.05e+01, avg batch time: 11.0078, average train loss: 102.6355
[09/26 07:26:20 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2283, average loss: 176.4059
[09/26 07:26:20 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 48.86	
[09/26 07:26:20 visual_prompt]: Training 25 / 100 epoch, with learning rate 47.073689821473174
[09/26 07:32:47 visual_prompt]: Epoch 25 / 100: avg data time: 1.06e+01, avg batch time: 11.0367, average train loss: 62.9792
[09/26 07:33:32 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.2357, average loss: 31.0578
[09/26 07:33:32 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.55	
[09/26 07:33:32 visual_prompt]: Training 26 / 100 epoch, with learning rate 46.65063509461097
[09/26 07:39:57 visual_prompt]: Epoch 26 / 100: avg data time: 1.06e+01, avg batch time: 11.0024, average train loss: 119.1587
[09/26 07:40:42 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2192, average loss: 157.6088
[09/26 07:40:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 48.01	
[09/26 07:40:42 visual_prompt]: Training 27 / 100 epoch, with learning rate 46.20120240391065
[09/26 07:47:08 visual_prompt]: Epoch 27 / 100: avg data time: 1.06e+01, avg batch time: 11.0123, average train loss: 98.7303
[09/26 07:47:53 visual_prompt]: Inference (val):avg data time: 3.08e-05, avg batch time: 0.2269, average loss: 4.0141
[09/26 07:47:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 46.84	
[09/26 07:47:53 visual_prompt]: Training 28 / 100 epoch, with learning rate 45.72593931387604
[09/26 07:54:19 visual_prompt]: Epoch 28 / 100: avg data time: 1.06e+01, avg batch time: 11.0345, average train loss: 160.5329
[09/26 07:55:04 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.2264, average loss: 198.5181
[09/26 07:55:04 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 45.94	
[09/26 07:55:04 visual_prompt]: Training 29 / 100 epoch, with learning rate 45.22542485937369
[09/26 08:01:30 visual_prompt]: Epoch 29 / 100: avg data time: 1.06e+01, avg batch time: 11.0286, average train loss: 110.7281
[09/26 08:02:15 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.2261, average loss: 1.0322
[09/26 08:02:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.28	rocauc: 57.66	
[09/26 08:02:15 visual_prompt]: Best epoch 29: best metric: 0.553
[09/26 08:02:15 visual_prompt]: Training 30 / 100 epoch, with learning rate 44.70026884016804
[09/26 08:08:41 visual_prompt]: Epoch 30 / 100: avg data time: 1.06e+01, avg batch time: 11.0284, average train loss: 77.8007
[09/26 08:09:26 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2344, average loss: 12.4672
[09/26 08:09:26 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 61.32	
[09/26 08:09:26 visual_prompt]: Training 31 / 100 epoch, with learning rate 44.15111107797445
[09/26 08:15:52 visual_prompt]: Epoch 31 / 100: avg data time: 1.05e+01, avg batch time: 10.9992, average train loss: 80.8732
[09/26 08:16:36 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2374, average loss: 63.9347
[09/26 08:16:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 40.56	
[09/26 08:16:36 visual_prompt]: Training 32 / 100 epoch, with learning rate 43.57862063693486
[09/26 08:23:03 visual_prompt]: Epoch 32 / 100: avg data time: 1.06e+01, avg batch time: 11.0239, average train loss: 90.2375
[09/26 08:23:48 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2300, average loss: 4.0705
[09/26 08:23:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.36	
[09/26 08:23:48 visual_prompt]: Training 33 / 100 epoch, with learning rate 42.98349500846628
[09/26 08:30:14 visual_prompt]: Epoch 33 / 100: avg data time: 1.06e+01, avg batch time: 11.0288, average train loss: 116.9334
[09/26 08:30:59 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2363, average loss: 31.3159
[09/26 08:30:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.89	
[09/26 08:30:59 visual_prompt]: Training 34 / 100 epoch, with learning rate 42.36645926147493
[09/26 08:37:26 visual_prompt]: Epoch 34 / 100: avg data time: 1.06e+01, avg batch time: 11.0431, average train loss: 93.0288
[09/26 08:38:11 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.2359, average loss: 122.9140
[09/26 08:38:11 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 45.70	
[09/26 08:38:11 visual_prompt]: Training 35 / 100 epoch, with learning rate 41.72826515897145
[09/26 08:44:36 visual_prompt]: Epoch 35 / 100: avg data time: 1.05e+01, avg batch time: 11.0032, average train loss: 107.8732
[09/26 08:45:21 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.2280, average loss: 80.2140
[09/26 08:45:21 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 42.92	
[09/26 08:45:21 visual_prompt]: Training 36 / 100 epoch, with learning rate 41.06969024216348
[09/26 08:51:47 visual_prompt]: Epoch 36 / 100: avg data time: 1.05e+01, avg batch time: 11.0128, average train loss: 77.0565
[09/26 08:52:32 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.2323, average loss: 106.3292
[09/26 08:52:32 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 44.65	
[09/26 08:52:32 visual_prompt]: Training 37 / 100 epoch, with learning rate 40.391536883141455
[09/26 08:58:58 visual_prompt]: Epoch 37 / 100: avg data time: 1.05e+01, avg batch time: 11.0035, average train loss: 81.4315
[09/26 08:59:43 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.2262, average loss: 107.2281
[09/26 08:59:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.23	
[09/26 08:59:43 visual_prompt]: Training 38 / 100 epoch, with learning rate 39.69463130731183
[09/26 09:06:09 visual_prompt]: Epoch 38 / 100: avg data time: 1.05e+01, avg batch time: 11.0140, average train loss: 74.1395
[09/26 09:06:54 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.2304, average loss: 59.8580
[09/26 09:06:54 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.33	
[09/26 09:06:54 visual_prompt]: Training 39 / 100 epoch, with learning rate 38.97982258676867
[09/26 09:13:20 visual_prompt]: Epoch 39 / 100: avg data time: 1.06e+01, avg batch time: 11.0274, average train loss: 132.5255
[09/26 09:14:05 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.2366, average loss: 52.0641
[09/26 09:14:05 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 38.94	
[09/26 09:14:05 visual_prompt]: Training 40 / 100 epoch, with learning rate 38.24798160583012
[09/26 09:20:31 visual_prompt]: Epoch 40 / 100: avg data time: 1.06e+01, avg batch time: 11.0266, average train loss: 67.5791
[09/26 09:21:16 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2323, average loss: 106.2456
[09/26 09:21:16 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.56	
[09/26 09:21:16 visual_prompt]: Training 41 / 100 epoch, with learning rate 37.5
[09/26 09:27:42 visual_prompt]: Epoch 41 / 100: avg data time: 1.05e+01, avg batch time: 11.0072, average train loss: 109.5540
[09/26 09:28:27 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.2442, average loss: 40.5927
[09/26 09:28:27 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 43.26	
[09/26 09:28:27 visual_prompt]: Training 42 / 100 epoch, with learning rate 36.736789069647266
[09/26 09:34:54 visual_prompt]: Epoch 42 / 100: avg data time: 1.06e+01, avg batch time: 11.0561, average train loss: 73.3252
[09/26 09:35:39 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2245, average loss: 8.0388
[09/26 09:35:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.44	
[09/26 09:35:39 visual_prompt]: Training 43 / 100 epoch, with learning rate 35.959278669726935
[09/26 09:42:05 visual_prompt]: Epoch 43 / 100: avg data time: 1.06e+01, avg batch time: 11.0168, average train loss: 73.0128
[09/26 09:42:50 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2251, average loss: 122.1291
[09/26 09:42:50 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 48.18	
[09/26 09:42:50 visual_prompt]: Training 44 / 100 epoch, with learning rate 35.16841607689501
[09/26 09:49:15 visual_prompt]: Epoch 44 / 100: avg data time: 1.06e+01, avg batch time: 11.0060, average train loss: 84.7139
[09/26 09:50:00 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2275, average loss: 77.2613
[09/26 09:50:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 43.63	
[09/26 09:50:00 visual_prompt]: Training 45 / 100 epoch, with learning rate 34.365164835397806
[09/26 09:56:26 visual_prompt]: Epoch 45 / 100: avg data time: 1.06e+01, avg batch time: 11.0137, average train loss: 57.8713
[09/26 09:57:11 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2359, average loss: 8.7841
[09/26 09:57:11 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 41.94	
[09/26 09:57:11 visual_prompt]: Training 46 / 100 epoch, with learning rate 33.55050358314172
[09/26 10:03:37 visual_prompt]: Epoch 46 / 100: avg data time: 1.05e+01, avg batch time: 11.0039, average train loss: 96.5399
[09/26 10:04:22 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2292, average loss: 89.1871
[09/26 10:04:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 39.80	
[09/26 10:04:22 visual_prompt]: Training 47 / 100 epoch, with learning rate 32.72542485937369
[09/26 10:10:47 visual_prompt]: Epoch 47 / 100: avg data time: 1.05e+01, avg batch time: 11.0037, average train loss: 59.8098
[09/26 10:11:32 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2286, average loss: 45.3858
[09/26 10:11:32 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 47.52	
[09/26 10:11:32 visual_prompt]: Training 48 / 100 epoch, with learning rate 31.89093389542498
[09/26 10:17:58 visual_prompt]: Epoch 48 / 100: avg data time: 1.06e+01, avg batch time: 11.0136, average train loss: 89.6234
[09/26 10:18:43 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2234, average loss: 10.3606
[09/26 10:18:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 46.06	
[09/26 10:18:43 visual_prompt]: Training 49 / 100 epoch, with learning rate 31.04804738999169
[09/26 10:25:10 visual_prompt]: Epoch 49 / 100: avg data time: 1.06e+01, avg batch time: 11.0601, average train loss: 55.1318
[09/26 10:25:56 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2427, average loss: 55.3000
[09/26 10:25:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.98	
[09/26 10:25:56 visual_prompt]: Training 50 / 100 epoch, with learning rate 30.19779227044398
[09/26 10:32:22 visual_prompt]: Epoch 50 / 100: avg data time: 1.06e+01, avg batch time: 11.0211, average train loss: 89.4484
[09/26 10:33:06 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.2264, average loss: 34.9058
[09/26 10:33:06 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.06	
[09/26 10:33:06 visual_prompt]: Training 51 / 100 epoch, with learning rate 29.341204441673263
[09/26 10:39:33 visual_prompt]: Epoch 51 / 100: avg data time: 1.06e+01, avg batch time: 11.0282, average train loss: 83.1764
[09/26 10:40:18 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2373, average loss: 111.7215
[09/26 10:40:18 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 38.78	
[09/26 10:40:18 visual_prompt]: Training 52 / 100 epoch, with learning rate 28.479327524001636
[09/26 10:46:44 visual_prompt]: Epoch 52 / 100: avg data time: 1.06e+01, avg batch time: 11.0149, average train loss: 82.8664
[09/26 10:47:29 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2326, average loss: 64.7079
[09/26 10:47:29 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.16	
[09/26 10:47:29 visual_prompt]: Training 53 / 100 epoch, with learning rate 27.61321158169134
[09/26 10:53:54 visual_prompt]: Epoch 53 / 100: avg data time: 1.06e+01, avg batch time: 11.0076, average train loss: 86.5978
[09/26 10:54:39 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2356, average loss: 49.2258
[09/26 10:54:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.13	
[09/26 10:54:39 visual_prompt]: Training 54 / 100 epoch, with learning rate 26.74391184360313
[09/26 11:01:05 visual_prompt]: Epoch 54 / 100: avg data time: 1.05e+01, avg batch time: 11.0175, average train loss: 67.8062
[09/26 11:01:50 visual_prompt]: Inference (val):avg data time: 2.09e-05, avg batch time: 0.2275, average loss: 20.1390
[09/26 11:01:50 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 48.28	
[09/26 11:01:50 visual_prompt]: Training 55 / 100 epoch, with learning rate 25.872487417562528
[09/26 11:08:16 visual_prompt]: Epoch 55 / 100: avg data time: 1.06e+01, avg batch time: 11.0323, average train loss: 56.0022
[09/26 11:09:01 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2346, average loss: 22.4089
[09/26 11:09:01 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 40.32	
[09/26 11:09:01 visual_prompt]: Training 56 / 100 epoch, with learning rate 25.0
[09/26 11:15:27 visual_prompt]: Epoch 56 / 100: avg data time: 1.06e+01, avg batch time: 11.0253, average train loss: 41.4812
[09/26 11:16:13 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.2229, average loss: 15.1573
[09/26 11:16:13 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 64.31	
[09/26 11:16:13 visual_prompt]: Training 57 / 100 epoch, with learning rate 24.127512582437483
[09/26 11:22:39 visual_prompt]: Epoch 57 / 100: avg data time: 1.06e+01, avg batch time: 11.0256, average train loss: 52.2761
[09/26 11:23:24 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.2206, average loss: 7.8657
[09/26 11:23:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 46.51	
[09/26 11:23:24 visual_prompt]: Training 58 / 100 epoch, with learning rate 23.256088156396867
[09/26 11:29:49 visual_prompt]: Epoch 58 / 100: avg data time: 1.05e+01, avg batch time: 11.0055, average train loss: 79.2962
[09/26 11:30:34 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.2298, average loss: 0.7361
[09/26 11:30:34 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.91	rocauc: 59.41	
[09/26 11:30:34 visual_prompt]: Best epoch 58: best metric: 0.569
[09/26 11:30:34 visual_prompt]: Training 59 / 100 epoch, with learning rate 22.38678841830867
[09/26 11:37:00 visual_prompt]: Epoch 59 / 100: avg data time: 1.06e+01, avg batch time: 11.0262, average train loss: 44.2944
[09/26 11:37:45 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2357, average loss: 92.3585
[09/26 11:37:45 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.93	
[09/26 11:37:45 visual_prompt]: Training 60 / 100 epoch, with learning rate 21.52067247599837
[09/26 11:44:11 visual_prompt]: Epoch 60 / 100: avg data time: 1.06e+01, avg batch time: 11.0122, average train loss: 37.8420
[09/26 11:44:56 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.2355, average loss: 48.7692
[09/26 11:44:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 62.48	
[09/26 11:44:56 visual_prompt]: Training 61 / 100 epoch, with learning rate 20.65879555832674
[09/26 11:51:23 visual_prompt]: Epoch 61 / 100: avg data time: 1.06e+01, avg batch time: 11.0588, average train loss: 35.0497
[09/26 11:52:08 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2181, average loss: 16.9753
[09/26 11:52:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.85	
[09/26 11:52:08 visual_prompt]: Training 62 / 100 epoch, with learning rate 19.80220772955602
[09/26 11:58:34 visual_prompt]: Epoch 62 / 100: avg data time: 1.06e+01, avg batch time: 11.0307, average train loss: 72.9436
[09/26 11:59:19 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2240, average loss: 47.9303
[09/26 11:59:19 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.82	
[09/26 11:59:19 visual_prompt]: Training 63 / 100 epoch, with learning rate 18.95195261000831
[09/26 12:05:45 visual_prompt]: Epoch 63 / 100: avg data time: 1.05e+01, avg batch time: 11.0035, average train loss: 43.5059
[09/26 12:06:30 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.2251, average loss: 2.6406
[09/26 12:06:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 39.92	
[09/26 12:06:30 visual_prompt]: Training 64 / 100 epoch, with learning rate 18.10906610457502
[09/26 12:12:57 visual_prompt]: Epoch 64 / 100: avg data time: 1.06e+01, avg batch time: 11.0421, average train loss: 36.4893
[09/26 12:13:42 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.2236, average loss: 150.1064
[09/26 12:13:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.20	
[09/26 12:13:42 visual_prompt]: Training 65 / 100 epoch, with learning rate 17.274575140626318
[09/26 12:20:09 visual_prompt]: Epoch 65 / 100: avg data time: 1.06e+01, avg batch time: 11.0467, average train loss: 33.5983
[09/26 12:20:54 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.2261, average loss: 33.6038
[09/26 12:20:54 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.55	
[09/26 12:20:54 visual_prompt]: Training 66 / 100 epoch, with learning rate 16.449496416858285
[09/26 12:27:20 visual_prompt]: Epoch 66 / 100: avg data time: 1.06e+01, avg batch time: 11.0305, average train loss: 40.7459
[09/26 12:28:05 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2342, average loss: 11.0786
[09/26 12:28:05 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 42.23	
[09/26 12:28:05 visual_prompt]: Training 67 / 100 epoch, with learning rate 15.634835164602197
[09/26 12:34:32 visual_prompt]: Epoch 67 / 100: avg data time: 1.06e+01, avg batch time: 11.0378, average train loss: 23.4708
[09/26 12:35:17 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2284, average loss: 13.3570
[09/26 12:35:17 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 47.77	
[09/26 12:35:17 visual_prompt]: Training 68 / 100 epoch, with learning rate 14.831583923104999
[09/26 12:41:43 visual_prompt]: Epoch 68 / 100: avg data time: 1.06e+01, avg batch time: 11.0299, average train loss: 29.6599
[09/26 12:42:28 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.2316, average loss: 29.6697
[09/26 12:42:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 37.67	
[09/26 12:42:28 visual_prompt]: Training 69 / 100 epoch, with learning rate 14.040721330273062
[09/26 12:48:54 visual_prompt]: Epoch 69 / 100: avg data time: 1.06e+01, avg batch time: 11.0279, average train loss: 21.6794
[09/26 12:49:40 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.2341, average loss: 20.0742
[09/26 12:49:40 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 48.71	
[09/26 12:49:40 visual_prompt]: Training 70 / 100 epoch, with learning rate 13.263210930352736
[09/26 12:56:06 visual_prompt]: Epoch 70 / 100: avg data time: 1.06e+01, avg batch time: 11.0209, average train loss: 19.7403
[09/26 12:56:51 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2260, average loss: 61.9626
[09/26 12:56:51 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 49.36	
[09/26 12:56:51 visual_prompt]: Training 71 / 100 epoch, with learning rate 12.500000000000005
[09/26 13:03:17 visual_prompt]: Epoch 71 / 100: avg data time: 1.06e+01, avg batch time: 11.0366, average train loss: 29.2014
[09/26 13:04:02 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2281, average loss: 39.5242
[09/26 13:04:02 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.62	
[09/26 13:04:02 visual_prompt]: Training 72 / 100 epoch, with learning rate 11.75201839416988
[09/26 13:10:27 visual_prompt]: Epoch 72 / 100: avg data time: 1.05e+01, avg batch time: 11.0009, average train loss: 33.1990
[09/26 13:11:12 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.2308, average loss: 41.2833
[09/26 13:11:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.33	
[09/26 13:11:12 visual_prompt]: Training 73 / 100 epoch, with learning rate 11.020177413231332
[09/26 13:17:39 visual_prompt]: Epoch 73 / 100: avg data time: 1.06e+01, avg batch time: 11.0242, average train loss: 35.8873
[09/26 13:18:24 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.2360, average loss: 34.5307
[09/26 13:18:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 62.03	
[09/26 13:18:24 visual_prompt]: Training 74 / 100 epoch, with learning rate 10.305368692688175
[09/26 13:24:49 visual_prompt]: Epoch 74 / 100: avg data time: 1.06e+01, avg batch time: 11.0097, average train loss: 24.4421
[09/26 13:25:34 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2325, average loss: 170.4502
[09/26 13:25:34 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 39.42	
[09/26 13:25:34 visual_prompt]: Training 75 / 100 epoch, with learning rate 9.608463116858543
[09/26 13:32:00 visual_prompt]: Epoch 75 / 100: avg data time: 1.06e+01, avg batch time: 11.0163, average train loss: 21.4014
[09/26 13:32:45 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.2311, average loss: 29.8918
[09/26 13:32:45 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.60	
[09/26 13:32:45 visual_prompt]: Training 76 / 100 epoch, with learning rate 8.930309757836516
[09/26 13:39:11 visual_prompt]: Epoch 76 / 100: avg data time: 1.05e+01, avg batch time: 11.0133, average train loss: 17.6611
[09/26 13:39:56 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2295, average loss: 5.5700
[09/26 13:39:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.97	
[09/26 13:39:56 visual_prompt]: Training 77 / 100 epoch, with learning rate 8.271734841028552
[09/26 13:46:22 visual_prompt]: Epoch 77 / 100: avg data time: 1.06e+01, avg batch time: 11.0314, average train loss: 13.9275
[09/26 13:47:07 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2369, average loss: 28.0414
[09/26 13:47:07 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 58.40	
[09/26 13:47:07 visual_prompt]: Training 78 / 100 epoch, with learning rate 7.633540738525066
[09/26 13:53:33 visual_prompt]: Epoch 78 / 100: avg data time: 1.06e+01, avg batch time: 11.0283, average train loss: 15.8621
[09/26 13:54:18 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2229, average loss: 16.1176
[09/26 13:54:18 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.50	
[09/26 13:54:18 visual_prompt]: Training 79 / 100 epoch, with learning rate 7.016504991533726
[09/26 14:00:44 visual_prompt]: Epoch 79 / 100: avg data time: 1.05e+01, avg batch time: 11.0133, average train loss: 8.5750
[09/26 14:01:29 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2395, average loss: 13.4448
[09/26 14:01:29 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 39.90	
[09/26 14:01:29 visual_prompt]: Training 80 / 100 epoch, with learning rate 6.4213793630651415
[09/26 14:07:55 visual_prompt]: Epoch 80 / 100: avg data time: 1.06e+01, avg batch time: 11.0277, average train loss: 6.1448
[09/26 14:08:40 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.2221, average loss: 16.3343
[09/26 14:08:40 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.31	
[09/26 14:08:40 visual_prompt]: Training 81 / 100 epoch, with learning rate 5.848888922025552
[09/26 14:15:06 visual_prompt]: Epoch 81 / 100: avg data time: 1.06e+01, avg batch time: 11.0052, average train loss: 18.0381
[09/26 14:15:51 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2390, average loss: 3.8226
[09/26 14:15:51 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.00	
[09/26 14:15:51 visual_prompt]: Training 82 / 100 epoch, with learning rate 5.2997311598319525
[09/26 14:22:17 visual_prompt]: Epoch 82 / 100: avg data time: 1.06e+01, avg batch time: 11.0184, average train loss: 9.5401
[09/26 14:23:02 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2295, average loss: 4.0759
[09/26 14:23:02 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.00	
[09/26 14:23:02 visual_prompt]: Training 83 / 100 epoch, with learning rate 4.774575140626316
[09/26 14:29:28 visual_prompt]: Epoch 83 / 100: avg data time: 1.06e+01, avg batch time: 11.0256, average train loss: 7.8190
[09/26 14:30:12 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.2280, average loss: 2.1842
[09/26 14:30:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 61.42	
[09/26 14:30:12 visual_prompt]: Training 84 / 100 epoch, with learning rate 4.27406068612396
[09/26 14:36:38 visual_prompt]: Epoch 84 / 100: avg data time: 1.06e+01, avg batch time: 11.0100, average train loss: 8.0503
[09/26 14:37:23 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.2372, average loss: 8.7098
[09/26 14:37:23 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.45	
[09/26 14:37:23 visual_prompt]: Training 85 / 100 epoch, with learning rate 3.798797596089351
[09/26 14:43:49 visual_prompt]: Epoch 85 / 100: avg data time: 1.06e+01, avg batch time: 11.0245, average train loss: 5.8502
[09/26 14:44:34 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2299, average loss: 2.9304
[09/26 14:44:35 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 38.35	
[09/26 14:44:35 visual_prompt]: Training 86 / 100 epoch, with learning rate 3.349364905389032
[09/26 14:51:00 visual_prompt]: Epoch 86 / 100: avg data time: 1.05e+01, avg batch time: 10.9932, average train loss: 7.5109
[09/26 14:51:45 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2210, average loss: 1.3615
[09/26 14:51:45 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 41.93	
[09/26 14:51:45 visual_prompt]: Training 87 / 100 epoch, with learning rate 2.9263101785268253
[09/26 14:58:10 visual_prompt]: Epoch 87 / 100: avg data time: 1.05e+01, avg batch time: 11.0077, average train loss: 7.1295
[09/26 14:58:55 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.2264, average loss: 7.8209
[09/26 14:58:55 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.77	
[09/26 14:58:55 visual_prompt]: Training 88 / 100 epoch, with learning rate 2.5301488425208296
[09/26 15:05:20 visual_prompt]: Epoch 88 / 100: avg data time: 1.05e+01, avg batch time: 10.9962, average train loss: 2.8766
[09/26 15:06:05 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.2290, average loss: 0.7196
[09/26 15:06:05 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 42.48	
[09/26 15:06:05 visual_prompt]: Training 89 / 100 epoch, with learning rate 2.1613635589349753
[09/26 15:12:32 visual_prompt]: Epoch 89 / 100: avg data time: 1.06e+01, avg batch time: 11.0455, average train loss: 1.6148
[09/26 15:13:17 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.2370, average loss: 4.8519
[09/26 15:13:17 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.57	
[09/26 15:13:17 visual_prompt]: Training 90 / 100 epoch, with learning rate 1.820403635830317
[09/26 15:19:43 visual_prompt]: Epoch 90 / 100: avg data time: 1.06e+01, avg batch time: 11.0192, average train loss: 1.6523
[09/26 15:20:28 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.2279, average loss: 2.1879
[09/26 15:20:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.47	
[09/26 15:20:28 visual_prompt]: Training 91 / 100 epoch, with learning rate 1.507684480352292
[09/26 15:26:54 visual_prompt]: Epoch 91 / 100: avg data time: 1.05e+01, avg batch time: 11.0230, average train loss: 1.5131
[09/26 15:27:39 visual_prompt]: Inference (val):avg data time: 3.03e-05, avg batch time: 0.2238, average loss: 1.5789
[09/26 15:27:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 58.71	
[09/26 15:27:39 visual_prompt]: Training 92 / 100 epoch, with learning rate 1.2235870926211616
[09/26 15:34:05 visual_prompt]: Epoch 92 / 100: avg data time: 1.06e+01, avg batch time: 11.0253, average train loss: 0.8424
[09/26 15:34:50 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.2361, average loss: 0.7272
[09/26 15:34:50 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.59	
[09/26 15:34:50 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.9684576015420276
[09/26 15:41:12 visual_prompt]: Epoch 93 / 100: avg data time: 1.04e+01, avg batch time: 10.8891, average train loss: 0.8061
[09/26 15:41:56 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2349, average loss: 0.7495
[09/26 15:41:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.40	
[09/26 15:41:56 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.7426068431000882
[09/26 15:48:18 visual_prompt]: Epoch 94 / 100: avg data time: 1.04e+01, avg batch time: 10.8841, average train loss: 0.7629
[09/26 15:49:02 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.2218, average loss: 0.6885
[09/26 15:49:02 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.93	
[09/26 15:49:02 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.5463099816548578
[09/26 15:55:24 visual_prompt]: Epoch 95 / 100: avg data time: 1.05e+01, avg batch time: 10.9105, average train loss: 0.7030
[09/26 15:56:09 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2281, average loss: 0.6860
[09/26 15:56:09 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.50	rocauc: 55.82	
[09/26 15:56:09 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.3798061746947995
[09/26 16:02:32 visual_prompt]: Epoch 96 / 100: avg data time: 1.04e+01, avg batch time: 10.9340, average train loss: 0.6970
[09/26 16:03:16 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.2294, average loss: 0.6889
[09/26 16:03:16 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.07	rocauc: 56.11	
[09/26 16:03:16 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.24329828146074095
[09/26 16:09:38 visual_prompt]: Epoch 97 / 100: avg data time: 1.04e+01, avg batch time: 10.8956, average train loss: 0.6990
[09/26 16:10:22 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.2337, average loss: 0.6851
[09/26 16:10:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 57.32	rocauc: 55.83	
[09/26 16:10:22 visual_prompt]: Best epoch 97: best metric: 0.573
[09/26 16:10:22 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.13695261579316775
[09/26 16:16:44 visual_prompt]: Epoch 98 / 100: avg data time: 1.04e+01, avg batch time: 10.8818, average train loss: 0.6854
[09/26 16:17:28 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.2369, average loss: 0.6981
[09/26 16:17:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.47	rocauc: 57.09	
[09/26 16:17:28 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.06089874350439506
[09/26 16:23:50 visual_prompt]: Epoch 99 / 100: avg data time: 1.04e+01, avg batch time: 10.8910, average train loss: 0.6876
[09/26 16:24:34 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2302, average loss: 0.6917
[09/26 16:24:34 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.28	rocauc: 56.86	
[09/26 16:24:34 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.015229324522605947
[09/26 16:30:56 visual_prompt]: Epoch 100 / 100: avg data time: 1.04e+01, avg batch time: 10.9046, average train loss: 0.6840
[09/26 16:31:40 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.2299, average loss: 0.6832
[09/26 16:31:40 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.98	
[09/26 16:31:40 visual_prompt]: Rank of current process: 0. World size: 1
[09/26 16:31:40 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              0
GPU 0                NVIDIA A100-PCIE-40GB
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/26 16:31:40 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'mammo-cbis', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/26 16:31:40 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/26 16:31:40 visual_prompt]: Training with config:
[09/26 16:31:40 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/mammo-cbis/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr50.0_wd0.0001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 50.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'mammo-cbis', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/26 16:31:40 visual_prompt]: Loading training data...
[09/26 16:31:40 visual_prompt]: Constructing mammo-cbis dataset train...
[09/26 16:31:40 visual_prompt]: Loading validation data...
[09/26 16:31:40 visual_prompt]: Constructing mammo-cbis dataset val...
[09/26 16:31:40 visual_prompt]: Constructing models...
[09/26 16:31:43 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/26 16:31:43 visual_prompt]: tuned percent:0.536
[09/26 16:31:43 visual_prompt]: Device used for model: 0
[09/26 16:31:43 visual_prompt]: Setting up Evaluator...
[09/26 16:31:43 visual_prompt]: Setting up Trainer...
[09/26 16:31:43 visual_prompt]: 	Setting up the optimizer...
[09/26 16:31:43 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/26 16:38:05 visual_prompt]: Epoch 1 / 100: avg data time: 1.05e+01, avg batch time: 10.9049, average train loss: 1.4903
[09/26 16:38:49 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2355, average loss: 1.4710
[09/26 16:38:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.15	
[09/26 16:38:49 visual_prompt]: Best epoch 1: best metric: 0.537
[09/26 16:38:49 visual_prompt]: Training 2 / 100 epoch, with learning rate 5.0
[09/26 16:45:12 visual_prompt]: Epoch 2 / 100: avg data time: 1.05e+01, avg batch time: 10.9136, average train loss: 34.6223
[09/26 16:45:56 visual_prompt]: Inference (val):avg data time: 2.00e-05, avg batch time: 0.2402, average loss: 27.2077
[09/26 16:45:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 60.83	
[09/26 16:45:56 visual_prompt]: Training 3 / 100 epoch, with learning rate 10.0
[09/26 16:52:17 visual_prompt]: Epoch 3 / 100: avg data time: 1.04e+01, avg batch time: 10.8794, average train loss: 33.5211
[09/26 16:53:02 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.2322, average loss: 2.9486
[09/26 16:53:02 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.34	
[09/26 16:53:02 visual_prompt]: Training 4 / 100 epoch, with learning rate 15.0
[09/26 16:59:24 visual_prompt]: Epoch 4 / 100: avg data time: 1.04e+01, avg batch time: 10.9136, average train loss: 17.5063
[09/26 17:00:09 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.2417, average loss: 10.3606
[09/26 17:00:09 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 47.37	
[09/26 17:00:09 visual_prompt]: Training 5 / 100 epoch, with learning rate 20.0
[09/26 17:06:30 visual_prompt]: Epoch 5 / 100: avg data time: 1.04e+01, avg batch time: 10.8933, average train loss: 21.9126
[09/26 17:07:15 visual_prompt]: Inference (val):avg data time: 2.07e-05, avg batch time: 0.2285, average loss: 72.6114
[09/26 17:07:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.64	
[09/26 17:07:15 visual_prompt]: Training 6 / 100 epoch, with learning rate 25.0
[09/26 17:13:37 visual_prompt]: Epoch 6 / 100: avg data time: 1.04e+01, avg batch time: 10.9186, average train loss: 59.2379
[09/26 17:14:22 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.2259, average loss: 39.3178
[09/26 17:14:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 59.80	
[09/26 17:14:22 visual_prompt]: Training 7 / 100 epoch, with learning rate 30.0
[09/26 17:20:44 visual_prompt]: Epoch 7 / 100: avg data time: 1.04e+01, avg batch time: 10.9190, average train loss: 56.8823
[09/26 17:21:29 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.2252, average loss: 45.5531
[09/26 17:21:29 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.69	
[09/26 17:21:29 visual_prompt]: Training 8 / 100 epoch, with learning rate 35.0
[09/26 17:27:51 visual_prompt]: Epoch 8 / 100: avg data time: 1.04e+01, avg batch time: 10.9096, average train loss: 42.3680
[09/26 17:28:35 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.2291, average loss: 3.3099
[09/26 17:28:35 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.65	
[09/26 17:28:35 visual_prompt]: Training 9 / 100 epoch, with learning rate 40.0
[09/26 17:34:59 visual_prompt]: Epoch 9 / 100: avg data time: 1.05e+01, avg batch time: 10.9444, average train loss: 114.0016
[09/26 17:35:43 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2312, average loss: 226.3268
[09/26 17:35:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.71	
[09/26 17:35:43 visual_prompt]: Training 10 / 100 epoch, with learning rate 45.0
[09/26 17:42:08 visual_prompt]: Epoch 10 / 100: avg data time: 1.05e+01, avg batch time: 10.9798, average train loss: 130.7166
[09/26 17:42:53 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2340, average loss: 57.2957
[09/26 17:42:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.37	
[09/26 17:42:53 visual_prompt]: Training 11 / 100 epoch, with learning rate 50.0
[09/26 17:49:20 visual_prompt]: Epoch 11 / 100: avg data time: 1.06e+01, avg batch time: 11.0450, average train loss: 73.1117
[09/26 17:50:05 visual_prompt]: Inference (val):avg data time: 2.07e-05, avg batch time: 0.2333, average loss: 94.1491
[09/26 17:50:05 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 37.46	
[09/26 17:50:05 visual_prompt]: Training 12 / 100 epoch, with learning rate 49.9847706754774
[09/26 17:56:31 visual_prompt]: Epoch 12 / 100: avg data time: 1.06e+01, avg batch time: 11.0300, average train loss: 65.6763
[09/26 17:57:16 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2321, average loss: 10.9175
[09/26 17:57:16 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.78	
[09/26 17:57:16 visual_prompt]: Training 13 / 100 epoch, with learning rate 49.939101256495604
[09/26 18:03:42 visual_prompt]: Epoch 13 / 100: avg data time: 1.06e+01, avg batch time: 11.0097, average train loss: 80.5970
[09/26 18:04:27 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.2309, average loss: 103.8119
[09/26 18:04:27 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 39.19	
[09/26 18:04:27 visual_prompt]: Training 14 / 100 epoch, with learning rate 49.86304738420683
[09/26 18:10:52 visual_prompt]: Epoch 14 / 100: avg data time: 1.05e+01, avg batch time: 11.0051, average train loss: 139.8647
[09/26 18:11:37 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2346, average loss: 107.9899
[09/26 18:11:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 47.47	
[09/26 18:11:37 visual_prompt]: Training 15 / 100 epoch, with learning rate 49.75670171853926
[09/26 18:18:04 visual_prompt]: Epoch 15 / 100: avg data time: 1.06e+01, avg batch time: 11.0464, average train loss: 105.1889
[09/26 18:18:49 visual_prompt]: Inference (val):avg data time: 2.01e-05, avg batch time: 0.2348, average loss: 120.0861
[09/26 18:18:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.98	
[09/26 18:18:49 visual_prompt]: Training 16 / 100 epoch, with learning rate 49.6201938253052
[09/26 18:25:15 visual_prompt]: Epoch 16 / 100: avg data time: 1.05e+01, avg batch time: 11.0181, average train loss: 71.7130
[09/26 18:26:00 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.2280, average loss: 111.5840
[09/26 18:26:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 39.65	
[09/26 18:26:00 visual_prompt]: Training 17 / 100 epoch, with learning rate 49.45369001834514
[09/26 18:32:25 visual_prompt]: Epoch 17 / 100: avg data time: 1.05e+01, avg batch time: 11.0041, average train loss: 81.2667
[09/26 18:33:10 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2322, average loss: 132.0342
[09/26 18:33:10 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.42	
[09/26 18:33:10 visual_prompt]: Training 18 / 100 epoch, with learning rate 49.25739315689991
[09/26 18:39:37 visual_prompt]: Epoch 18 / 100: avg data time: 1.06e+01, avg batch time: 11.0324, average train loss: 63.4690
[09/26 18:40:22 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2255, average loss: 68.0753
[09/26 18:40:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.90	
[09/26 18:40:22 visual_prompt]: Training 19 / 100 epoch, with learning rate 49.03154239845797
[09/26 18:46:47 visual_prompt]: Epoch 19 / 100: avg data time: 1.05e+01, avg batch time: 11.0061, average train loss: 67.8655
[09/26 18:47:32 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2294, average loss: 24.9790
[09/26 18:47:32 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.19	
[09/26 18:47:32 visual_prompt]: Training 20 / 100 epoch, with learning rate 48.77641290737884
[09/26 18:53:57 visual_prompt]: Epoch 20 / 100: avg data time: 1.05e+01, avg batch time: 10.9948, average train loss: 59.1713
[09/26 18:54:42 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2341, average loss: 60.2244
[09/26 18:54:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 47.00	
[09/26 18:54:42 visual_prompt]: Training 21 / 100 epoch, with learning rate 48.49231551964771
[09/26 19:01:08 visual_prompt]: Epoch 21 / 100: avg data time: 1.05e+01, avg batch time: 11.0080, average train loss: 83.8758
[09/26 19:01:53 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2389, average loss: 15.5143
[09/26 19:01:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.50	
[09/26 19:01:53 visual_prompt]: Training 22 / 100 epoch, with learning rate 48.17959636416968
[09/26 19:08:20 visual_prompt]: Epoch 22 / 100: avg data time: 1.06e+01, avg batch time: 11.0424, average train loss: 102.5761
[09/26 19:09:04 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2401, average loss: 67.6504
[09/26 19:09:04 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.11	
[09/26 19:09:04 visual_prompt]: Training 23 / 100 epoch, with learning rate 47.83863644106502
[09/26 19:15:32 visual_prompt]: Epoch 23 / 100: avg data time: 1.06e+01, avg batch time: 11.0740, average train loss: 61.2020
[09/26 19:16:17 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2374, average loss: 37.8764
[09/26 19:16:17 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.86	
[09/26 19:16:17 visual_prompt]: Training 24 / 100 epoch, with learning rate 47.46985115747918
[09/26 19:22:43 visual_prompt]: Epoch 24 / 100: avg data time: 1.06e+01, avg batch time: 11.0083, average train loss: 62.7740
[09/26 19:23:28 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.2245, average loss: 88.7493
[09/26 19:23:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 43.90	
[09/26 19:23:28 visual_prompt]: Training 25 / 100 epoch, with learning rate 47.073689821473174
[09/26 19:29:54 visual_prompt]: Epoch 25 / 100: avg data time: 1.06e+01, avg batch time: 11.0199, average train loss: 77.9737
[09/26 19:30:39 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2362, average loss: 58.0950
[09/26 19:30:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 46.76	
[09/26 19:30:39 visual_prompt]: Training 26 / 100 epoch, with learning rate 46.65063509461097
[09/26 19:37:04 visual_prompt]: Epoch 26 / 100: avg data time: 1.06e+01, avg batch time: 11.0114, average train loss: 65.9714
[09/26 19:37:49 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2341, average loss: 124.9980
[09/26 19:37:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.46	
[09/26 19:37:49 visual_prompt]: Training 27 / 100 epoch, with learning rate 46.20120240391065
[09/26 19:44:15 visual_prompt]: Epoch 27 / 100: avg data time: 1.06e+01, avg batch time: 11.0195, average train loss: 140.4447
[09/26 19:45:00 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2287, average loss: 50.9187
[09/26 19:45:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 45.97	
[09/26 19:45:00 visual_prompt]: Training 28 / 100 epoch, with learning rate 45.72593931387604
[09/26 19:51:26 visual_prompt]: Epoch 28 / 100: avg data time: 1.06e+01, avg batch time: 11.0105, average train loss: 116.5868
[09/26 19:52:11 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2345, average loss: 44.9242
[09/26 19:52:11 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 40.89	
[09/26 19:52:11 visual_prompt]: Training 29 / 100 epoch, with learning rate 45.22542485937369
[09/26 19:58:37 visual_prompt]: Epoch 29 / 100: avg data time: 1.06e+01, avg batch time: 11.0231, average train loss: 69.3703
[09/26 19:59:22 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2462, average loss: 77.3634
[09/26 19:59:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.85	
[09/26 19:59:22 visual_prompt]: Training 30 / 100 epoch, with learning rate 44.70026884016804
[09/26 20:05:48 visual_prompt]: Epoch 30 / 100: avg data time: 1.06e+01, avg batch time: 11.0364, average train loss: 70.1489
[09/26 20:06:33 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.2424, average loss: 566.1619
[09/26 20:06:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 42.06	
[09/26 20:06:33 visual_prompt]: Training 31 / 100 epoch, with learning rate 44.15111107797445
[09/26 20:13:00 visual_prompt]: Epoch 31 / 100: avg data time: 1.06e+01, avg batch time: 11.0288, average train loss: 105.1041
[09/26 20:13:45 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2277, average loss: 36.2057
[09/26 20:13:45 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.91	
[09/26 20:13:45 visual_prompt]: Training 32 / 100 epoch, with learning rate 43.57862063693486
[09/26 20:20:11 visual_prompt]: Epoch 32 / 100: avg data time: 1.06e+01, avg batch time: 11.0185, average train loss: 82.2632
[09/26 20:20:56 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.2349, average loss: 13.7937
[09/26 20:20:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 63.19	
[09/26 20:20:56 visual_prompt]: Training 33 / 100 epoch, with learning rate 42.98349500846628
[09/26 20:27:22 visual_prompt]: Epoch 33 / 100: avg data time: 1.06e+01, avg batch time: 11.0450, average train loss: 60.6035
[09/26 20:28:08 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.2312, average loss: 46.3858
[09/26 20:28:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.25	
[09/26 20:28:08 visual_prompt]: Training 34 / 100 epoch, with learning rate 42.36645926147493
[09/26 20:34:34 visual_prompt]: Epoch 34 / 100: avg data time: 1.06e+01, avg batch time: 11.0455, average train loss: 116.5843
[09/26 20:35:19 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2393, average loss: 92.9385
[09/26 20:35:19 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.46	
[09/26 20:35:19 visual_prompt]: Training 35 / 100 epoch, with learning rate 41.72826515897145
[09/26 20:41:45 visual_prompt]: Epoch 35 / 100: avg data time: 1.05e+01, avg batch time: 10.9954, average train loss: 76.3871
[09/26 20:42:30 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.2296, average loss: 141.4491
[09/26 20:42:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.01	
[09/26 20:42:30 visual_prompt]: Training 36 / 100 epoch, with learning rate 41.06969024216348
[09/26 20:48:57 visual_prompt]: Epoch 36 / 100: avg data time: 1.06e+01, avg batch time: 11.0533, average train loss: 95.3522
[09/26 20:49:42 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2237, average loss: 17.6030
[09/26 20:49:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 60.77	
[09/26 20:49:42 visual_prompt]: Training 37 / 100 epoch, with learning rate 40.391536883141455
[09/26 20:56:08 visual_prompt]: Epoch 37 / 100: avg data time: 1.05e+01, avg batch time: 11.0182, average train loss: 90.0975
[09/26 20:56:52 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.2360, average loss: 32.8140
[09/26 20:56:52 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.28	
[09/26 20:56:52 visual_prompt]: Training 38 / 100 epoch, with learning rate 39.69463130731183
[09/26 21:03:20 visual_prompt]: Epoch 38 / 100: avg data time: 1.06e+01, avg batch time: 11.0548, average train loss: 63.4174
[09/26 21:04:05 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2318, average loss: 41.2985
[09/26 21:04:05 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 60.40	
[09/26 21:04:05 visual_prompt]: Training 39 / 100 epoch, with learning rate 38.97982258676867
[09/26 21:10:32 visual_prompt]: Epoch 39 / 100: avg data time: 1.06e+01, avg batch time: 11.0527, average train loss: 150.9593
[09/26 21:11:17 visual_prompt]: Inference (val):avg data time: 2.14e-05, avg batch time: 0.2270, average loss: 72.8210
[09/26 21:11:17 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.66	
[09/26 21:11:17 visual_prompt]: Training 40 / 100 epoch, with learning rate 38.24798160583012
[09/26 21:17:43 visual_prompt]: Epoch 40 / 100: avg data time: 1.06e+01, avg batch time: 11.0300, average train loss: 64.2066
[09/26 21:18:28 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.2225, average loss: 41.3273
[09/26 21:18:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.89	
[09/26 21:18:28 visual_prompt]: Training 41 / 100 epoch, with learning rate 37.5
[09/26 21:24:54 visual_prompt]: Epoch 41 / 100: avg data time: 1.05e+01, avg batch time: 11.0172, average train loss: 71.2738
[09/26 21:25:39 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.2275, average loss: 56.7451
[09/26 21:25:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.11	
[09/26 21:25:39 visual_prompt]: Training 42 / 100 epoch, with learning rate 36.736789069647266
[09/26 21:32:05 visual_prompt]: Epoch 42 / 100: avg data time: 1.06e+01, avg batch time: 11.0333, average train loss: 45.1517
[09/26 21:32:50 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2351, average loss: 115.8964
[09/26 21:32:50 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 43.37	
[09/26 21:32:50 visual_prompt]: Training 43 / 100 epoch, with learning rate 35.959278669726935
[09/26 21:39:17 visual_prompt]: Epoch 43 / 100: avg data time: 1.06e+01, avg batch time: 11.0326, average train loss: 91.1406
[09/26 21:40:02 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.2187, average loss: 90.1968
[09/26 21:40:02 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.72	
[09/26 21:40:02 visual_prompt]: Training 44 / 100 epoch, with learning rate 35.16841607689501
[09/26 21:46:28 visual_prompt]: Epoch 44 / 100: avg data time: 1.06e+01, avg batch time: 11.0173, average train loss: 91.9329
[09/26 21:47:13 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.2246, average loss: 94.9876
[09/26 21:47:13 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 45.03	
[09/26 21:47:13 visual_prompt]: Training 45 / 100 epoch, with learning rate 34.365164835397806
[09/26 21:53:39 visual_prompt]: Epoch 45 / 100: avg data time: 1.06e+01, avg batch time: 11.0322, average train loss: 91.9037
[09/26 21:54:25 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.2318, average loss: 80.7814
[09/26 21:54:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 46.88	
[09/26 21:54:25 visual_prompt]: Training 46 / 100 epoch, with learning rate 33.55050358314172
[09/26 22:00:51 visual_prompt]: Epoch 46 / 100: avg data time: 1.05e+01, avg batch time: 11.0239, average train loss: 75.3897
[09/26 22:01:36 visual_prompt]: Inference (val):avg data time: 2.94e-05, avg batch time: 0.2373, average loss: 130.9268
[09/26 22:01:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 48.28	
[09/26 22:01:36 visual_prompt]: Training 47 / 100 epoch, with learning rate 32.72542485937369
[09/26 22:08:02 visual_prompt]: Epoch 47 / 100: avg data time: 1.06e+01, avg batch time: 11.0386, average train loss: 87.1221
[09/26 22:08:48 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2409, average loss: 2.9065
[09/26 22:08:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.32	
[09/26 22:08:48 visual_prompt]: Training 48 / 100 epoch, with learning rate 31.89093389542498
[09/26 22:15:14 visual_prompt]: Epoch 48 / 100: avg data time: 1.06e+01, avg batch time: 11.0335, average train loss: 36.6518
[09/26 22:15:59 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.2329, average loss: 9.8671
[09/26 22:15:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.33	
[09/26 22:15:59 visual_prompt]: Training 49 / 100 epoch, with learning rate 31.04804738999169
[09/26 22:22:26 visual_prompt]: Epoch 49 / 100: avg data time: 1.06e+01, avg batch time: 11.0526, average train loss: 51.7295
[09/26 22:23:11 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2285, average loss: 20.1887
[09/26 22:23:11 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 63.85	
[09/26 22:23:11 visual_prompt]: Training 50 / 100 epoch, with learning rate 30.19779227044398
[09/26 22:29:38 visual_prompt]: Epoch 50 / 100: avg data time: 1.06e+01, avg batch time: 11.0366, average train loss: 61.1818
[09/26 22:30:23 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.2345, average loss: 54.0185
[09/26 22:30:23 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 59.75	
[09/26 22:30:23 visual_prompt]: Training 51 / 100 epoch, with learning rate 29.341204441673263
[09/26 22:36:50 visual_prompt]: Epoch 51 / 100: avg data time: 1.06e+01, avg batch time: 11.0585, average train loss: 27.6521
[09/26 22:37:35 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2377, average loss: 18.3492
[09/26 22:37:35 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.40	
[09/26 22:37:35 visual_prompt]: Training 52 / 100 epoch, with learning rate 28.479327524001636
[09/26 22:44:02 visual_prompt]: Epoch 52 / 100: avg data time: 1.06e+01, avg batch time: 11.0493, average train loss: 24.9661
[09/26 22:44:47 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.2338, average loss: 25.3765
[09/26 22:44:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.86	
[09/26 22:44:47 visual_prompt]: Training 53 / 100 epoch, with learning rate 27.61321158169134
[09/26 22:51:13 visual_prompt]: Epoch 53 / 100: avg data time: 1.06e+01, avg batch time: 11.0145, average train loss: 48.0066
[09/26 22:51:58 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2355, average loss: 62.9084
[09/26 22:51:58 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.88	
[09/26 22:51:58 visual_prompt]: Training 54 / 100 epoch, with learning rate 26.74391184360313
[09/26 22:58:23 visual_prompt]: Epoch 54 / 100: avg data time: 1.05e+01, avg batch time: 10.9951, average train loss: 23.6778
[09/26 22:59:08 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.2301, average loss: 21.0278
[09/26 22:59:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 61.51	
[09/26 22:59:08 visual_prompt]: Training 55 / 100 epoch, with learning rate 25.872487417562528
[09/26 23:05:34 visual_prompt]: Epoch 55 / 100: avg data time: 1.06e+01, avg batch time: 11.0281, average train loss: 36.5814
[09/26 23:06:19 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.2384, average loss: 87.1113
[09/26 23:06:19 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.64	
[09/26 23:06:19 visual_prompt]: Training 56 / 100 epoch, with learning rate 25.0
[09/26 23:12:45 visual_prompt]: Epoch 56 / 100: avg data time: 1.06e+01, avg batch time: 11.0188, average train loss: 56.6617
[09/26 23:13:31 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.2365, average loss: 18.1653
[09/26 23:13:31 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 48.03	
[09/26 23:13:31 visual_prompt]: Training 57 / 100 epoch, with learning rate 24.127512582437483
[09/26 23:19:58 visual_prompt]: Epoch 57 / 100: avg data time: 1.06e+01, avg batch time: 11.0517, average train loss: 64.7109
[09/26 23:20:43 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.2412, average loss: 61.1577
[09/26 23:20:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 60.98	
[09/26 23:20:43 visual_prompt]: Training 58 / 100 epoch, with learning rate 23.256088156396867
[09/26 23:27:09 visual_prompt]: Epoch 58 / 100: avg data time: 1.06e+01, avg batch time: 11.0194, average train loss: 43.5481
[09/26 23:27:54 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2298, average loss: 32.6654
[09/26 23:27:54 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 44.33	
[09/26 23:27:54 visual_prompt]: Training 59 / 100 epoch, with learning rate 22.38678841830867
[09/26 23:34:19 visual_prompt]: Epoch 59 / 100: avg data time: 1.06e+01, avg batch time: 11.0055, average train loss: 20.2482
[09/26 23:35:04 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.2371, average loss: 39.5897
[09/26 23:35:04 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.81	
[09/26 23:35:04 visual_prompt]: Training 60 / 100 epoch, with learning rate 21.52067247599837
[09/26 23:41:31 visual_prompt]: Epoch 60 / 100: avg data time: 1.06e+01, avg batch time: 11.0519, average train loss: 25.9707
[09/26 23:42:16 visual_prompt]: Inference (val):avg data time: 2.23e-05, avg batch time: 0.2354, average loss: 27.1080
[09/26 23:42:16 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 46.85	
[09/26 23:42:16 visual_prompt]: Training 61 / 100 epoch, with learning rate 20.65879555832674
[09/26 23:48:43 visual_prompt]: Epoch 61 / 100: avg data time: 1.06e+01, avg batch time: 11.0428, average train loss: 27.1489
[09/26 23:49:28 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2241, average loss: 29.7376
[09/26 23:49:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.08	
[09/26 23:49:28 visual_prompt]: Training 62 / 100 epoch, with learning rate 19.80220772955602
[09/26 23:55:54 visual_prompt]: Epoch 62 / 100: avg data time: 1.06e+01, avg batch time: 11.0338, average train loss: 43.4957
[09/26 23:56:40 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.2284, average loss: 67.2939
[09/26 23:56:40 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.69	
[09/26 23:56:40 visual_prompt]: Training 63 / 100 epoch, with learning rate 18.95195261000831
[09/27 00:03:05 visual_prompt]: Epoch 63 / 100: avg data time: 1.05e+01, avg batch time: 11.0139, average train loss: 26.2680
[09/27 00:03:50 visual_prompt]: Inference (val):avg data time: 2.10e-05, avg batch time: 0.2360, average loss: 5.1437
[09/27 00:03:50 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 44.87	
[09/27 00:03:50 visual_prompt]: Training 64 / 100 epoch, with learning rate 18.10906610457502
[09/27 00:10:16 visual_prompt]: Epoch 64 / 100: avg data time: 1.06e+01, avg batch time: 11.0202, average train loss: 34.1653
[09/27 00:11:01 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.2298, average loss: 67.2926
[09/27 00:11:01 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 46.13	
[09/27 00:11:01 visual_prompt]: Training 65 / 100 epoch, with learning rate 17.274575140626318
[09/27 00:17:28 visual_prompt]: Epoch 65 / 100: avg data time: 1.06e+01, avg batch time: 11.0345, average train loss: 30.7853
[09/27 00:18:13 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.2262, average loss: 25.7342
[09/27 00:18:13 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 58.41	
[09/27 00:18:13 visual_prompt]: Training 66 / 100 epoch, with learning rate 16.449496416858285
[09/27 00:24:39 visual_prompt]: Epoch 66 / 100: avg data time: 1.06e+01, avg batch time: 11.0368, average train loss: 26.1534
[09/27 00:25:24 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.2122, average loss: 11.2945
[09/27 00:25:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 59.30	
[09/27 00:25:24 visual_prompt]: Training 67 / 100 epoch, with learning rate 15.634835164602197
[09/27 00:31:51 visual_prompt]: Epoch 67 / 100: avg data time: 1.06e+01, avg batch time: 11.0319, average train loss: 32.5377
[09/27 00:32:36 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.2380, average loss: 13.8121
[09/27 00:32:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 43.50	rocauc: 44.89	
[09/27 00:32:36 visual_prompt]: Training 68 / 100 epoch, with learning rate 14.831583923104999
[09/27 00:39:02 visual_prompt]: Epoch 68 / 100: avg data time: 1.06e+01, avg batch time: 11.0414, average train loss: 14.2556
[09/27 00:39:48 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.2263, average loss: 21.8047
[09/27 00:39:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.70	
[09/27 00:39:48 visual_prompt]: Training 69 / 100 epoch, with learning rate 14.040721330273062
[09/27 00:46:14 visual_prompt]: Epoch 69 / 100: avg data time: 1.06e+01, avg batch time: 11.0344, average train loss: 16.6304
[09/27 00:46:59 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2243, average loss: 11.9443
[09/27 00:46:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.32	
[09/27 00:46:59 visual_prompt]: Training 70 / 100 epoch, with learning rate 13.263210930352736
[09/27 00:53:25 visual_prompt]: Epoch 70 / 100: avg data time: 1.06e+01, avg batch time: 11.0285, average train loss: 11.8250
[09/27 00:54:10 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2277, average loss: 18.2476
[09/27 00:54:10 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.09	
[09/27 00:54:10 visual_prompt]: Training 71 / 100 epoch, with learning rate 12.500000000000005
[09/27 01:00:36 visual_prompt]: Epoch 71 / 100: avg data time: 1.06e+01, avg batch time: 11.0273, average train loss: 13.5264
[09/27 01:01:22 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2277, average loss: 19.3729
[09/27 01:01:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.56	
[09/27 01:01:22 visual_prompt]: Training 72 / 100 epoch, with learning rate 11.75201839416988
[09/27 01:07:48 visual_prompt]: Epoch 72 / 100: avg data time: 1.05e+01, avg batch time: 11.0179, average train loss: 15.7748
[09/27 01:08:33 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.2424, average loss: 0.7102
[09/27 01:08:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 44.31	rocauc: 40.02	
[09/27 01:08:33 visual_prompt]: Training 73 / 100 epoch, with learning rate 11.020177413231332
[09/27 01:14:59 visual_prompt]: Epoch 73 / 100: avg data time: 1.06e+01, avg batch time: 11.0294, average train loss: 6.8505
[09/27 01:15:44 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.2356, average loss: 17.5697
[09/27 01:15:44 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.40	
[09/27 01:15:44 visual_prompt]: Training 74 / 100 epoch, with learning rate 10.305368692688175
[09/27 01:22:10 visual_prompt]: Epoch 74 / 100: avg data time: 1.06e+01, avg batch time: 11.0255, average train loss: 9.8777
[09/27 01:22:55 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.2303, average loss: 2.1269
[09/27 01:22:55 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.63	
[09/27 01:22:55 visual_prompt]: Training 75 / 100 epoch, with learning rate 9.608463116858543
[09/27 01:29:21 visual_prompt]: Epoch 75 / 100: avg data time: 1.06e+01, avg batch time: 11.0291, average train loss: 13.2639
[09/27 01:30:06 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2381, average loss: 14.4780
[09/27 01:30:06 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 43.09	
[09/27 01:30:06 visual_prompt]: Training 76 / 100 epoch, with learning rate 8.930309757836516
[09/27 01:36:33 visual_prompt]: Epoch 76 / 100: avg data time: 1.06e+01, avg batch time: 11.0368, average train loss: 15.5474
[09/27 01:37:18 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.2257, average loss: 15.7069
[09/27 01:37:18 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 46.68	
[09/27 01:37:18 visual_prompt]: Training 77 / 100 epoch, with learning rate 8.271734841028552
[09/27 01:43:46 visual_prompt]: Epoch 77 / 100: avg data time: 1.06e+01, avg batch time: 11.0719, average train loss: 28.5457
[09/27 01:44:31 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2343, average loss: 3.1941
[09/27 01:44:31 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 61.52	
[09/27 01:44:31 visual_prompt]: Training 78 / 100 epoch, with learning rate 7.633540738525066
[09/27 01:50:57 visual_prompt]: Epoch 78 / 100: avg data time: 1.06e+01, avg batch time: 11.0144, average train loss: 12.1270
[09/27 01:51:42 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.2379, average loss: 1.0889
[09/27 01:51:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.99	
[09/27 01:51:42 visual_prompt]: Training 79 / 100 epoch, with learning rate 7.016504991533726
[09/27 01:58:08 visual_prompt]: Epoch 79 / 100: avg data time: 1.05e+01, avg batch time: 11.0193, average train loss: 4.8597
[09/27 01:58:53 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.2235, average loss: 2.3711
[09/27 01:58:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.65	
[09/27 01:58:53 visual_prompt]: Training 80 / 100 epoch, with learning rate 6.4213793630651415
[09/27 02:05:19 visual_prompt]: Epoch 80 / 100: avg data time: 1.05e+01, avg batch time: 11.0221, average train loss: 10.3226
[09/27 02:06:04 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.2333, average loss: 13.7746
[09/27 02:06:04 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.54	
[09/27 02:06:04 visual_prompt]: Training 81 / 100 epoch, with learning rate 5.848888922025552
[09/27 02:12:31 visual_prompt]: Epoch 81 / 100: avg data time: 1.06e+01, avg batch time: 11.0431, average train loss: 7.8186
[09/27 02:13:16 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2344, average loss: 2.7681
[09/27 02:13:16 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 60.89	
[09/27 02:13:16 visual_prompt]: Training 82 / 100 epoch, with learning rate 5.2997311598319525
[09/27 02:19:42 visual_prompt]: Epoch 82 / 100: avg data time: 1.06e+01, avg batch time: 11.0320, average train loss: 2.9377
[09/27 02:20:27 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2370, average loss: 2.9192
[09/27 02:20:27 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.06	
[09/27 02:20:27 visual_prompt]: Training 83 / 100 epoch, with learning rate 4.774575140626316
[09/27 02:26:54 visual_prompt]: Epoch 83 / 100: avg data time: 1.06e+01, avg batch time: 11.0331, average train loss: 1.9801
[09/27 02:27:39 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2241, average loss: 1.5918
[09/27 02:27:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.85	
[09/27 02:27:39 visual_prompt]: Training 84 / 100 epoch, with learning rate 4.27406068612396
[09/27 02:34:05 visual_prompt]: Epoch 84 / 100: avg data time: 1.06e+01, avg batch time: 11.0168, average train loss: 2.2366
[09/27 02:34:50 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.2287, average loss: 3.3384
[09/27 02:34:50 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.80	
[09/27 02:34:50 visual_prompt]: Training 85 / 100 epoch, with learning rate 3.798797596089351
[09/27 02:41:14 visual_prompt]: Epoch 85 / 100: avg data time: 1.05e+01, avg batch time: 10.9746, average train loss: 2.1061
[09/27 02:41:59 visual_prompt]: Inference (val):avg data time: 2.04e-05, avg batch time: 0.2366, average loss: 0.9750
[09/27 02:41:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.26	
[09/27 02:41:59 visual_prompt]: Training 86 / 100 epoch, with learning rate 3.349364905389032
[09/27 02:48:22 visual_prompt]: Epoch 86 / 100: avg data time: 1.05e+01, avg batch time: 10.9519, average train loss: 0.8354
[09/27 02:49:07 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2285, average loss: 0.6933
[09/27 02:49:07 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.16	
[09/27 02:49:07 visual_prompt]: Training 87 / 100 epoch, with learning rate 2.9263101785268253
[09/27 02:55:30 visual_prompt]: Epoch 87 / 100: avg data time: 1.05e+01, avg batch time: 10.9377, average train loss: 0.7902
[09/27 02:56:15 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.2326, average loss: 0.8057
[09/27 02:56:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.34	
[09/27 02:56:15 visual_prompt]: Training 88 / 100 epoch, with learning rate 2.5301488425208296
[09/27 03:02:37 visual_prompt]: Epoch 88 / 100: avg data time: 1.04e+01, avg batch time: 10.8994, average train loss: 0.7646
[09/27 03:03:21 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2440, average loss: 0.6912
[09/27 03:03:21 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.28	rocauc: 56.31	
[09/27 03:03:21 visual_prompt]: Best epoch 88: best metric: 0.553
[09/27 03:03:21 visual_prompt]: Training 89 / 100 epoch, with learning rate 2.1613635589349753
[09/27 03:09:43 visual_prompt]: Epoch 89 / 100: avg data time: 1.04e+01, avg batch time: 10.9128, average train loss: 0.7873
[09/27 03:10:28 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2426, average loss: 0.6862
[09/27 03:10:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.88	rocauc: 56.43	
[09/27 03:10:28 visual_prompt]: Training 90 / 100 epoch, with learning rate 1.820403635830317
[09/27 03:16:51 visual_prompt]: Epoch 90 / 100: avg data time: 1.05e+01, avg batch time: 10.9353, average train loss: 0.7110
[09/27 03:17:36 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2263, average loss: 0.6938
[09/27 03:17:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 50.41	rocauc: 56.01	
[09/27 03:17:36 visual_prompt]: Training 91 / 100 epoch, with learning rate 1.507684480352292
[09/27 03:24:00 visual_prompt]: Epoch 91 / 100: avg data time: 1.05e+01, avg batch time: 10.9673, average train loss: 0.7002
[09/27 03:24:45 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2255, average loss: 0.6904
[09/27 03:24:45 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.69	rocauc: 56.07	
[09/27 03:24:45 visual_prompt]: Best epoch 91: best metric: 0.557
[09/27 03:24:45 visual_prompt]: Training 92 / 100 epoch, with learning rate 1.2235870926211616
[09/27 03:31:07 visual_prompt]: Epoch 92 / 100: avg data time: 1.05e+01, avg batch time: 10.9294, average train loss: 0.7076
[09/27 03:31:52 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.2340, average loss: 0.6911
[09/27 03:31:52 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.47	rocauc: 56.40	
[09/27 03:31:52 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.9684576015420276
[09/27 03:38:14 visual_prompt]: Epoch 93 / 100: avg data time: 1.04e+01, avg batch time: 10.9015, average train loss: 0.7219
[09/27 03:38:58 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.2329, average loss: 0.6958
[09/27 03:38:58 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.50	
[09/27 03:38:58 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.7426068431000882
[09/27 03:45:19 visual_prompt]: Epoch 94 / 100: avg data time: 1.04e+01, avg batch time: 10.8850, average train loss: 0.6931
[09/27 03:46:04 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.2311, average loss: 0.6923
[09/27 03:46:04 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.28	rocauc: 56.21	
[09/27 03:46:04 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.5463099816548578
[09/27 03:52:25 visual_prompt]: Epoch 95 / 100: avg data time: 1.04e+01, avg batch time: 10.8965, average train loss: 0.6978
[09/27 03:53:10 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2344, average loss: 0.6863
[09/27 03:53:10 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.69	rocauc: 56.23	
[09/27 03:53:10 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.3798061746947995
[09/27 03:59:33 visual_prompt]: Epoch 96 / 100: avg data time: 1.05e+01, avg batch time: 10.9434, average train loss: 0.6871
[09/27 04:00:18 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2244, average loss: 0.6832
[09/27 04:00:18 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.10	rocauc: 56.57	
[09/27 04:00:18 visual_prompt]: Best epoch 96: best metric: 0.561
[09/27 04:00:18 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.24329828146074095
[09/27 04:06:40 visual_prompt]: Epoch 97 / 100: avg data time: 1.04e+01, avg batch time: 10.9109, average train loss: 0.6838
[09/27 04:07:25 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2314, average loss: 0.7023
[09/27 04:07:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 49.19	rocauc: 56.91	
[09/27 04:07:25 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.13695261579316775
[09/27 04:13:47 visual_prompt]: Epoch 98 / 100: avg data time: 1.04e+01, avg batch time: 10.9051, average train loss: 0.6885
[09/27 04:14:31 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.2293, average loss: 0.6899
[09/27 04:14:31 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.91	rocauc: 56.79	
[09/27 04:14:31 visual_prompt]: Best epoch 98: best metric: 0.569
[09/27 04:14:31 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.06089874350439506
[09/27 04:20:54 visual_prompt]: Epoch 99 / 100: avg data time: 1.05e+01, avg batch time: 10.9311, average train loss: 0.6826
[09/27 04:21:39 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2305, average loss: 0.6881
[09/27 04:21:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.10	rocauc: 57.14	
[09/27 04:21:39 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.015229324522605947
[09/27 04:28:01 visual_prompt]: Epoch 100 / 100: avg data time: 1.05e+01, avg batch time: 10.9122, average train loss: 0.6851
[09/27 04:28:46 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2349, average loss: 0.6811
[09/27 04:28:46 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.50	rocauc: 57.10	
[09/27 04:28:46 visual_prompt]: Rank of current process: 0. World size: 1
[09/27 04:28:46 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              0
GPU 0                NVIDIA A100-PCIE-40GB
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/27 04:28:46 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'mammo-cbis', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/27 04:28:46 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/27 04:28:46 visual_prompt]: Training with config:
[09/27 04:28:46 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/mammo-cbis/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr50.0_wd0.0/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 50.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'mammo-cbis', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/27 04:28:46 visual_prompt]: Loading training data...
[09/27 04:28:46 visual_prompt]: Constructing mammo-cbis dataset train...
[09/27 04:28:46 visual_prompt]: Loading validation data...
[09/27 04:28:46 visual_prompt]: Constructing mammo-cbis dataset val...
[09/27 04:28:46 visual_prompt]: Constructing models...
[09/27 04:28:48 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/27 04:28:48 visual_prompt]: tuned percent:0.536
[09/27 04:28:48 visual_prompt]: Device used for model: 0
[09/27 04:28:48 visual_prompt]: Setting up Evaluator...
[09/27 04:28:48 visual_prompt]: Setting up Trainer...
[09/27 04:28:48 visual_prompt]: 	Setting up the optimizer...
[09/27 04:28:48 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/27 04:35:10 visual_prompt]: Epoch 1 / 100: avg data time: 1.04e+01, avg batch time: 10.8888, average train loss: 1.4903
[09/27 04:35:54 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2354, average loss: 1.4710
[09/27 04:35:54 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.15	
[09/27 04:35:54 visual_prompt]: Best epoch 1: best metric: 0.537
[09/27 04:35:54 visual_prompt]: Training 2 / 100 epoch, with learning rate 5.0
[09/27 04:42:15 visual_prompt]: Epoch 2 / 100: avg data time: 1.04e+01, avg batch time: 10.8810, average train loss: 18.1685
[09/27 04:43:00 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2282, average loss: 5.5034
[09/27 04:43:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.31	
[09/27 04:43:00 visual_prompt]: Training 3 / 100 epoch, with learning rate 10.0
[09/27 04:49:21 visual_prompt]: Epoch 3 / 100: avg data time: 1.04e+01, avg batch time: 10.8698, average train loss: 39.3456
[09/27 04:50:05 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2278, average loss: 27.7039
[09/27 04:50:05 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.56	
[09/27 04:50:05 visual_prompt]: Training 4 / 100 epoch, with learning rate 15.0
[09/27 04:56:26 visual_prompt]: Epoch 4 / 100: avg data time: 1.04e+01, avg batch time: 10.8877, average train loss: 30.8699
[09/27 04:57:11 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2392, average loss: 23.7221
[09/27 04:57:11 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.31	
[09/27 04:57:11 visual_prompt]: Training 5 / 100 epoch, with learning rate 20.0
[09/27 05:03:32 visual_prompt]: Epoch 5 / 100: avg data time: 1.04e+01, avg batch time: 10.8870, average train loss: 66.2980
[09/27 05:04:17 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.2353, average loss: 39.8086
[09/27 05:04:17 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.17	
[09/27 05:04:17 visual_prompt]: Training 6 / 100 epoch, with learning rate 25.0
[09/27 05:10:40 visual_prompt]: Epoch 6 / 100: avg data time: 1.05e+01, avg batch time: 10.9430, average train loss: 81.4732
[09/27 05:11:25 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.2301, average loss: 114.2704
[09/27 05:11:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.99	
[09/27 05:11:25 visual_prompt]: Training 7 / 100 epoch, with learning rate 30.0
[09/27 05:17:47 visual_prompt]: Epoch 7 / 100: avg data time: 1.04e+01, avg batch time: 10.8988, average train loss: 108.0223
[09/27 05:18:31 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2303, average loss: 11.7175
[09/27 05:18:31 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.18	
[09/27 05:18:31 visual_prompt]: Training 8 / 100 epoch, with learning rate 35.0
[09/27 05:24:52 visual_prompt]: Epoch 8 / 100: avg data time: 1.04e+01, avg batch time: 10.8821, average train loss: 121.1031
[09/27 05:25:37 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2367, average loss: 130.9646
[09/27 05:25:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 41.37	
[09/27 05:25:37 visual_prompt]: Training 9 / 100 epoch, with learning rate 40.0
[09/27 05:31:58 visual_prompt]: Epoch 9 / 100: avg data time: 1.04e+01, avg batch time: 10.8965, average train loss: 81.3396
[09/27 05:32:43 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.2375, average loss: 52.1649
[09/27 05:32:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 48.38	
[09/27 05:32:43 visual_prompt]: Training 10 / 100 epoch, with learning rate 45.0
[09/27 05:39:06 visual_prompt]: Epoch 10 / 100: avg data time: 1.05e+01, avg batch time: 10.9434, average train loss: 81.1682
[09/27 05:39:51 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2338, average loss: 153.5915
[09/27 05:39:51 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.91	
[09/27 05:39:51 visual_prompt]: Training 11 / 100 epoch, with learning rate 50.0
[09/27 05:46:15 visual_prompt]: Epoch 11 / 100: avg data time: 1.05e+01, avg batch time: 10.9542, average train loss: 60.4657
[09/27 05:46:59 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.2312, average loss: 24.0753
[09/27 05:46:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 43.91	
[09/27 05:46:59 visual_prompt]: Training 12 / 100 epoch, with learning rate 49.9847706754774
[09/27 05:53:23 visual_prompt]: Epoch 12 / 100: avg data time: 1.05e+01, avg batch time: 10.9476, average train loss: 38.6421
[09/27 05:54:08 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2117, average loss: 29.3682
[09/27 05:54:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 58.03	
[09/27 05:54:08 visual_prompt]: Training 13 / 100 epoch, with learning rate 49.939101256495604
[09/27 06:00:30 visual_prompt]: Epoch 13 / 100: avg data time: 1.05e+01, avg batch time: 10.9309, average train loss: 66.1310
[09/27 06:01:15 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.2286, average loss: 14.8660
[09/27 06:01:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.85	
[09/27 06:01:15 visual_prompt]: Training 14 / 100 epoch, with learning rate 49.86304738420683
[09/27 06:07:37 visual_prompt]: Epoch 14 / 100: avg data time: 1.04e+01, avg batch time: 10.9102, average train loss: 106.6508
[09/27 06:08:22 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2233, average loss: 193.3312
[09/27 06:08:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.41	
[09/27 06:08:22 visual_prompt]: Training 15 / 100 epoch, with learning rate 49.75670171853926
[09/27 06:14:43 visual_prompt]: Epoch 15 / 100: avg data time: 1.04e+01, avg batch time: 10.8939, average train loss: 104.5618
[09/27 06:15:28 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2364, average loss: 12.1593
[09/27 06:15:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 45.47	
[09/27 06:15:28 visual_prompt]: Training 16 / 100 epoch, with learning rate 49.6201938253052
[09/27 06:21:51 visual_prompt]: Epoch 16 / 100: avg data time: 1.04e+01, avg batch time: 10.9230, average train loss: 42.4517
[09/27 06:22:35 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.2185, average loss: 69.4019
[09/27 06:22:35 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.83	
[09/27 06:22:35 visual_prompt]: Training 17 / 100 epoch, with learning rate 49.45369001834514
[09/27 06:28:57 visual_prompt]: Epoch 17 / 100: avg data time: 1.04e+01, avg batch time: 10.9037, average train loss: 53.5351
[09/27 06:29:42 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2356, average loss: 11.4094
[09/27 06:29:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.65	
[09/27 06:29:42 visual_prompt]: Training 18 / 100 epoch, with learning rate 49.25739315689991
[09/27 06:36:04 visual_prompt]: Epoch 18 / 100: avg data time: 1.05e+01, avg batch time: 10.9194, average train loss: 62.7477
[09/27 06:36:49 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2423, average loss: 12.0564
[09/27 06:36:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.16	
[09/27 06:36:49 visual_prompt]: Training 19 / 100 epoch, with learning rate 49.03154239845797
[09/27 06:43:10 visual_prompt]: Epoch 19 / 100: avg data time: 1.04e+01, avg batch time: 10.8770, average train loss: 81.2966
[09/27 06:43:54 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.2249, average loss: 49.9067
[09/27 06:43:55 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.93	
[09/27 06:43:55 visual_prompt]: Training 20 / 100 epoch, with learning rate 48.77641290737884
[09/27 06:50:16 visual_prompt]: Epoch 20 / 100: avg data time: 1.04e+01, avg batch time: 10.8817, average train loss: 60.9944
[09/27 06:51:00 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2300, average loss: 10.3583
[09/27 06:51:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.65	
[09/27 06:51:00 visual_prompt]: Training 21 / 100 epoch, with learning rate 48.49231551964771
[09/27 06:57:22 visual_prompt]: Epoch 21 / 100: avg data time: 1.04e+01, avg batch time: 10.8956, average train loss: 54.8756
[09/27 06:58:06 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.2328, average loss: 92.9679
[09/27 06:58:07 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 49.47	
[09/27 06:58:07 visual_prompt]: Training 22 / 100 epoch, with learning rate 48.17959636416968
[09/27 07:04:28 visual_prompt]: Epoch 22 / 100: avg data time: 1.04e+01, avg batch time: 10.9004, average train loss: 64.3987
[09/27 07:05:13 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.2310, average loss: 39.8352
[09/27 07:05:13 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.53	
[09/27 07:05:13 visual_prompt]: Training 23 / 100 epoch, with learning rate 47.83863644106502
[09/27 07:11:35 visual_prompt]: Epoch 23 / 100: avg data time: 1.04e+01, avg batch time: 10.8956, average train loss: 49.5148
[09/27 07:12:19 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.2295, average loss: 85.5087
[09/27 07:12:19 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.45	
[09/27 07:12:19 visual_prompt]: Training 24 / 100 epoch, with learning rate 47.46985115747918
[09/27 07:18:41 visual_prompt]: Epoch 24 / 100: avg data time: 1.04e+01, avg batch time: 10.9122, average train loss: 48.1389
[09/27 07:19:26 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2290, average loss: 104.8288
[09/27 07:19:26 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 45.30	
[09/27 07:19:26 visual_prompt]: Training 25 / 100 epoch, with learning rate 47.073689821473174
[09/27 07:25:48 visual_prompt]: Epoch 25 / 100: avg data time: 1.05e+01, avg batch time: 10.9179, average train loss: 71.9652
[09/27 07:26:33 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.2308, average loss: 67.9985
[09/27 07:26:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 42.20	
[09/27 07:26:33 visual_prompt]: Training 26 / 100 epoch, with learning rate 46.65063509461097
[09/27 07:32:55 visual_prompt]: Epoch 26 / 100: avg data time: 1.05e+01, avg batch time: 10.9173, average train loss: 76.7456
[09/27 07:33:40 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.2418, average loss: 65.9643
[09/27 07:33:40 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.45	
[09/27 07:33:40 visual_prompt]: Training 27 / 100 epoch, with learning rate 46.20120240391065
[09/27 07:40:02 visual_prompt]: Epoch 27 / 100: avg data time: 1.04e+01, avg batch time: 10.9060, average train loss: 37.6852
[09/27 07:40:47 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.2365, average loss: 69.2490
[09/27 07:40:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.99	
[09/27 07:40:47 visual_prompt]: Training 28 / 100 epoch, with learning rate 45.72593931387604
[09/27 07:47:08 visual_prompt]: Epoch 28 / 100: avg data time: 1.04e+01, avg batch time: 10.8893, average train loss: 69.2358
[09/27 07:47:53 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.2289, average loss: 112.5286
[09/27 07:47:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.81	
[09/27 07:47:53 visual_prompt]: Training 29 / 100 epoch, with learning rate 45.22542485937369
[09/27 07:54:14 visual_prompt]: Epoch 29 / 100: avg data time: 1.04e+01, avg batch time: 10.9041, average train loss: 44.5379
[09/27 07:54:59 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.2223, average loss: 76.5091
[09/27 07:54:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.12	
[09/27 07:54:59 visual_prompt]: Training 30 / 100 epoch, with learning rate 44.70026884016804
[09/27 08:01:21 visual_prompt]: Epoch 30 / 100: avg data time: 1.04e+01, avg batch time: 10.8992, average train loss: 55.5701
[09/27 08:02:05 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.2379, average loss: 8.2606
[09/27 08:02:05 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.69	
[09/27 08:02:05 visual_prompt]: Training 31 / 100 epoch, with learning rate 44.15111107797445
[09/27 08:08:27 visual_prompt]: Epoch 31 / 100: avg data time: 1.04e+01, avg batch time: 10.8985, average train loss: 38.7667
[09/27 08:09:12 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.2329, average loss: 43.3713
[09/27 08:09:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.35	
[09/27 08:09:12 visual_prompt]: Training 32 / 100 epoch, with learning rate 43.57862063693486
[09/27 08:15:35 visual_prompt]: Epoch 32 / 100: avg data time: 1.05e+01, avg batch time: 10.9369, average train loss: 42.5000
[09/27 08:16:19 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.2273, average loss: 59.7763
[09/27 08:16:19 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.12	
[09/27 08:16:19 visual_prompt]: Training 33 / 100 epoch, with learning rate 42.98349500846628
[09/27 08:22:43 visual_prompt]: Epoch 33 / 100: avg data time: 1.05e+01, avg batch time: 10.9557, average train loss: 46.2700
[09/27 08:23:28 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.2327, average loss: 16.4141
[09/27 08:23:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 61.90	
[09/27 08:23:28 visual_prompt]: Training 34 / 100 epoch, with learning rate 42.36645926147493
[09/27 08:29:52 visual_prompt]: Epoch 34 / 100: avg data time: 1.05e+01, avg batch time: 10.9626, average train loss: 34.6277
[09/27 08:30:37 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.2351, average loss: 9.1949
[09/27 08:30:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.50	
[09/27 08:30:37 visual_prompt]: Training 35 / 100 epoch, with learning rate 41.72826515897145
[09/27 08:36:59 visual_prompt]: Epoch 35 / 100: avg data time: 1.05e+01, avg batch time: 10.9091, average train loss: 34.7174
[09/27 08:37:43 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.2372, average loss: 58.8601
[09/27 08:37:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.82	
[09/27 08:37:43 visual_prompt]: Training 36 / 100 epoch, with learning rate 41.06969024216348
[09/27 08:44:05 visual_prompt]: Epoch 36 / 100: avg data time: 1.04e+01, avg batch time: 10.9005, average train loss: 35.8271
[09/27 08:44:50 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.2369, average loss: 9.0021
[09/27 08:44:50 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.37	
[09/27 08:44:50 visual_prompt]: Training 37 / 100 epoch, with learning rate 40.391536883141455
[09/27 08:51:11 visual_prompt]: Epoch 37 / 100: avg data time: 1.04e+01, avg batch time: 10.8914, average train loss: 34.4271
[09/27 08:51:55 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.2277, average loss: 5.1507
[09/27 08:51:55 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.46	
[09/27 08:51:55 visual_prompt]: Training 38 / 100 epoch, with learning rate 39.69463130731183
[09/27 08:58:17 visual_prompt]: Epoch 38 / 100: avg data time: 1.04e+01, avg batch time: 10.8863, average train loss: 16.4048
[09/27 08:59:01 visual_prompt]: Inference (val):avg data time: 2.10e-05, avg batch time: 0.2222, average loss: 105.5535
[09/27 08:59:01 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.39	
[09/27 08:59:01 visual_prompt]: Training 39 / 100 epoch, with learning rate 38.97982258676867
[09/27 09:05:23 visual_prompt]: Epoch 39 / 100: avg data time: 1.05e+01, avg batch time: 10.9011, average train loss: 54.4159
[09/27 09:06:08 visual_prompt]: Inference (val):avg data time: 2.99e-05, avg batch time: 0.2381, average loss: 21.3865
[09/27 09:06:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.90	
[09/27 09:06:08 visual_prompt]: Training 40 / 100 epoch, with learning rate 38.24798160583012
[09/27 09:12:30 visual_prompt]: Epoch 40 / 100: avg data time: 1.04e+01, avg batch time: 10.9040, average train loss: 16.6932
[09/27 09:13:14 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2277, average loss: 39.5885
[09/27 09:13:14 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.25	
[09/27 09:13:14 visual_prompt]: Training 41 / 100 epoch, with learning rate 37.5
[09/27 09:19:36 visual_prompt]: Epoch 41 / 100: avg data time: 1.04e+01, avg batch time: 10.8863, average train loss: 23.2223
[09/27 09:20:20 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.2330, average loss: 11.1281
[09/27 09:20:20 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 59.19	
[09/27 09:20:20 visual_prompt]: Training 42 / 100 epoch, with learning rate 36.736789069647266
[09/27 09:26:42 visual_prompt]: Epoch 42 / 100: avg data time: 1.04e+01, avg batch time: 10.9069, average train loss: 22.8068
[09/27 09:27:27 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2336, average loss: 42.1778
[09/27 09:27:27 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.66	
[09/27 09:27:27 visual_prompt]: Training 43 / 100 epoch, with learning rate 35.959278669726935
[09/27 09:33:49 visual_prompt]: Epoch 43 / 100: avg data time: 1.04e+01, avg batch time: 10.9138, average train loss: 32.8992
[09/27 09:34:34 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.2371, average loss: 68.7217
[09/27 09:34:34 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.32	
[09/27 09:34:34 visual_prompt]: Training 44 / 100 epoch, with learning rate 35.16841607689501
[09/27 09:40:56 visual_prompt]: Epoch 44 / 100: avg data time: 1.05e+01, avg batch time: 10.9134, average train loss: 19.2186
[09/27 09:41:41 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.2329, average loss: 13.8328
[09/27 09:41:41 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.86	
[09/27 09:41:41 visual_prompt]: Training 45 / 100 epoch, with learning rate 34.365164835397806
[09/27 09:48:03 visual_prompt]: Epoch 45 / 100: avg data time: 1.04e+01, avg batch time: 10.8996, average train loss: 18.4550
[09/27 09:48:47 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.2339, average loss: 19.5550
[09/27 09:48:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.13	
[09/27 09:48:47 visual_prompt]: Training 46 / 100 epoch, with learning rate 33.55050358314172
[09/27 09:55:10 visual_prompt]: Epoch 46 / 100: avg data time: 1.05e+01, avg batch time: 10.9361, average train loss: 14.2578
[09/27 09:55:55 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2323, average loss: 15.5494
[09/27 09:55:55 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.94	
[09/27 09:55:55 visual_prompt]: Training 47 / 100 epoch, with learning rate 32.72542485937369
[09/27 10:02:18 visual_prompt]: Epoch 47 / 100: avg data time: 1.05e+01, avg batch time: 10.9363, average train loss: 15.2872
[09/27 10:03:03 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.2264, average loss: 14.7965
[09/27 10:03:03 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.76	
[09/27 10:03:03 visual_prompt]: Training 48 / 100 epoch, with learning rate 31.89093389542498
[09/27 10:09:24 visual_prompt]: Epoch 48 / 100: avg data time: 1.04e+01, avg batch time: 10.9012, average train loss: 11.8925
[09/27 10:10:09 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2252, average loss: 43.4585
[09/27 10:10:09 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.27	
[09/27 10:10:09 visual_prompt]: Training 49 / 100 epoch, with learning rate 31.04804738999169
[09/27 10:16:32 visual_prompt]: Epoch 49 / 100: avg data time: 1.05e+01, avg batch time: 10.9408, average train loss: 23.7318
[09/27 10:17:17 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2402, average loss: 3.1462
[09/27 10:17:17 visual_prompt]: Classification results with val_mammo-cbis: top1: 51.63	rocauc: 54.15	
[09/27 10:17:17 visual_prompt]: Training 50 / 100 epoch, with learning rate 30.19779227044398
[09/27 10:23:39 visual_prompt]: Epoch 50 / 100: avg data time: 1.04e+01, avg batch time: 10.9019, average train loss: 12.2100
[09/27 10:24:23 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.2303, average loss: 20.5735
[09/27 10:24:23 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.89	
[09/27 10:24:23 visual_prompt]: Training 51 / 100 epoch, with learning rate 29.341204441673263
[09/27 10:30:45 visual_prompt]: Epoch 51 / 100: avg data time: 1.04e+01, avg batch time: 10.8992, average train loss: 13.4155
[09/27 10:31:30 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2334, average loss: 13.0067
[09/27 10:31:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 61.09	
[09/27 10:31:30 visual_prompt]: Training 52 / 100 epoch, with learning rate 28.479327524001636
[09/27 10:37:52 visual_prompt]: Epoch 52 / 100: avg data time: 1.05e+01, avg batch time: 10.9150, average train loss: 23.3188
[09/27 10:38:37 visual_prompt]: Inference (val):avg data time: 2.23e-05, avg batch time: 0.2275, average loss: 2.8021
[09/27 10:38:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.10	rocauc: 56.45	
[09/27 10:38:37 visual_prompt]: Best epoch 52: best metric: 0.561
[09/27 10:38:37 visual_prompt]: Training 53 / 100 epoch, with learning rate 27.61321158169134
[09/27 10:44:58 visual_prompt]: Epoch 53 / 100: avg data time: 1.04e+01, avg batch time: 10.8782, average train loss: 15.7387
[09/27 10:45:42 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2298, average loss: 8.4637
[09/27 10:45:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.51	
[09/27 10:45:42 visual_prompt]: Training 54 / 100 epoch, with learning rate 26.74391184360313
[09/27 10:52:04 visual_prompt]: Epoch 54 / 100: avg data time: 1.04e+01, avg batch time: 10.8858, average train loss: 21.0682
[09/27 10:52:48 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.2226, average loss: 55.6155
[09/27 10:52:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 59.90	
[09/27 10:52:48 visual_prompt]: Training 55 / 100 epoch, with learning rate 25.872487417562528
[09/27 10:59:10 visual_prompt]: Epoch 55 / 100: avg data time: 1.04e+01, avg batch time: 10.9060, average train loss: 9.8963
[09/27 10:59:55 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2236, average loss: 19.2858
[09/27 10:59:55 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.21	
[09/27 10:59:55 visual_prompt]: Training 56 / 100 epoch, with learning rate 25.0
[09/27 11:06:17 visual_prompt]: Epoch 56 / 100: avg data time: 1.04e+01, avg batch time: 10.8998, average train loss: 16.7575
[09/27 11:07:01 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2306, average loss: 29.8187
[09/27 11:07:01 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.15	
[09/27 11:07:01 visual_prompt]: Training 57 / 100 epoch, with learning rate 24.127512582437483
[09/27 11:13:23 visual_prompt]: Epoch 57 / 100: avg data time: 1.05e+01, avg batch time: 10.9137, average train loss: 20.9240
[09/27 11:14:08 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.2391, average loss: 13.4120
[09/27 11:14:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.69	
[09/27 11:14:08 visual_prompt]: Training 58 / 100 epoch, with learning rate 23.256088156396867
[09/27 11:20:30 visual_prompt]: Epoch 58 / 100: avg data time: 1.04e+01, avg batch time: 10.9161, average train loss: 5.7251
[09/27 11:21:15 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.2277, average loss: 1.8695
[09/27 11:21:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.88	rocauc: 57.19	
[09/27 11:21:15 visual_prompt]: Training 59 / 100 epoch, with learning rate 22.38678841830867
[09/27 11:27:39 visual_prompt]: Epoch 59 / 100: avg data time: 1.05e+01, avg batch time: 10.9578, average train loss: 8.3095
[09/27 11:28:24 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2339, average loss: 3.8623
[09/27 11:28:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.96	
[09/27 11:28:24 visual_prompt]: Training 60 / 100 epoch, with learning rate 21.52067247599837
[09/27 11:34:47 visual_prompt]: Epoch 60 / 100: avg data time: 1.05e+01, avg batch time: 10.9352, average train loss: 7.3079
[09/27 11:35:31 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2305, average loss: 23.9077
[09/27 11:35:31 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.48	
[09/27 11:35:31 visual_prompt]: Training 61 / 100 epoch, with learning rate 20.65879555832674
[09/27 11:41:55 visual_prompt]: Epoch 61 / 100: avg data time: 1.05e+01, avg batch time: 10.9422, average train loss: 11.1414
[09/27 11:42:39 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.2310, average loss: 17.4453
[09/27 11:42:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.20	
[09/27 11:42:39 visual_prompt]: Training 62 / 100 epoch, with learning rate 19.80220772955602
[09/27 11:49:02 visual_prompt]: Epoch 62 / 100: avg data time: 1.05e+01, avg batch time: 10.9239, average train loss: 17.3360
[09/27 11:49:47 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2353, average loss: 3.0384
[09/27 11:49:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.25	rocauc: 55.81	
[09/27 11:49:47 visual_prompt]: Training 63 / 100 epoch, with learning rate 18.95195261000831
[09/27 11:56:08 visual_prompt]: Epoch 63 / 100: avg data time: 1.04e+01, avg batch time: 10.8902, average train loss: 6.5937
[09/27 11:56:53 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.2379, average loss: 5.1557
[09/27 11:56:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.19	
[09/27 11:56:53 visual_prompt]: Training 64 / 100 epoch, with learning rate 18.10906610457502
[09/27 12:03:16 visual_prompt]: Epoch 64 / 100: avg data time: 1.05e+01, avg batch time: 10.9544, average train loss: 9.2115
[09/27 12:04:01 visual_prompt]: Inference (val):avg data time: 2.76e-05, avg batch time: 0.2281, average loss: 2.1438
[09/27 12:04:01 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.07	rocauc: 57.18	
[09/27 12:04:01 visual_prompt]: Training 65 / 100 epoch, with learning rate 17.274575140626318
[09/27 12:10:24 visual_prompt]: Epoch 65 / 100: avg data time: 1.05e+01, avg batch time: 10.9269, average train loss: 6.2526
[09/27 12:11:08 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.2347, average loss: 30.4323
[09/27 12:11:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 59.28	
[09/27 12:11:08 visual_prompt]: Training 66 / 100 epoch, with learning rate 16.449496416858285
[09/27 12:17:31 visual_prompt]: Epoch 66 / 100: avg data time: 1.05e+01, avg batch time: 10.9222, average train loss: 9.8443
[09/27 12:18:16 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2261, average loss: 12.4770
[09/27 12:18:16 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.41	
[09/27 12:18:16 visual_prompt]: Training 67 / 100 epoch, with learning rate 15.634835164602197
[09/27 12:24:38 visual_prompt]: Epoch 67 / 100: avg data time: 1.05e+01, avg batch time: 10.9222, average train loss: 5.8208
[09/27 12:25:23 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.2327, average loss: 1.5433
[09/27 12:25:23 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 60.21	
[09/27 12:25:23 visual_prompt]: Training 68 / 100 epoch, with learning rate 14.831583923104999
[09/27 12:31:45 visual_prompt]: Epoch 68 / 100: avg data time: 1.04e+01, avg batch time: 10.8981, average train loss: 4.5528
[09/27 12:32:30 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.2344, average loss: 4.6341
[09/27 12:32:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.76	
[09/27 12:32:30 visual_prompt]: Training 69 / 100 epoch, with learning rate 14.040721330273062
[09/27 12:38:54 visual_prompt]: Epoch 69 / 100: avg data time: 1.05e+01, avg batch time: 10.9769, average train loss: 9.5958
[09/27 12:39:39 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2338, average loss: 2.3574
[09/27 12:39:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.21	
[09/27 12:39:39 visual_prompt]: Training 70 / 100 epoch, with learning rate 13.263210930352736
[09/27 12:46:01 visual_prompt]: Epoch 70 / 100: avg data time: 1.05e+01, avg batch time: 10.9097, average train loss: 4.3244
[09/27 12:46:45 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.2224, average loss: 1.2779
[09/27 12:46:45 visual_prompt]: Classification results with val_mammo-cbis: top1: 57.72	rocauc: 57.45	
[09/27 12:46:45 visual_prompt]: Best epoch 70: best metric: 0.577
[09/27 12:46:45 visual_prompt]: Training 71 / 100 epoch, with learning rate 12.500000000000005
[09/27 12:53:07 visual_prompt]: Epoch 71 / 100: avg data time: 1.04e+01, avg batch time: 10.9011, average train loss: 3.8250
[09/27 12:53:52 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.2233, average loss: 4.9622
[09/27 12:53:52 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.14	
[09/27 12:53:52 visual_prompt]: Training 72 / 100 epoch, with learning rate 11.75201839416988
[09/27 13:00:15 visual_prompt]: Epoch 72 / 100: avg data time: 1.04e+01, avg batch time: 10.9246, average train loss: 8.6486
[09/27 13:00:59 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.2372, average loss: 6.5156
[09/27 13:00:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.36	
[09/27 13:00:59 visual_prompt]: Training 73 / 100 epoch, with learning rate 11.020177413231332
[09/27 13:07:22 visual_prompt]: Epoch 73 / 100: avg data time: 1.05e+01, avg batch time: 10.9266, average train loss: 6.1267
[09/27 13:08:07 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.2273, average loss: 2.9870
[09/27 13:08:07 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.88	rocauc: 57.92	
[09/27 13:08:07 visual_prompt]: Training 74 / 100 epoch, with learning rate 10.305368692688175
[09/27 13:14:30 visual_prompt]: Epoch 74 / 100: avg data time: 1.05e+01, avg batch time: 10.9362, average train loss: 8.2625
[09/27 13:15:14 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.2333, average loss: 5.4194
[09/27 13:15:14 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 58.05	
[09/27 13:15:14 visual_prompt]: Training 75 / 100 epoch, with learning rate 9.608463116858543
[09/27 13:21:38 visual_prompt]: Epoch 75 / 100: avg data time: 1.05e+01, avg batch time: 10.9539, average train loss: 6.4499
[09/27 13:22:23 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2235, average loss: 2.0788
[09/27 13:22:23 visual_prompt]: Classification results with val_mammo-cbis: top1: 49.19	rocauc: 57.05	
[09/27 13:22:23 visual_prompt]: Training 76 / 100 epoch, with learning rate 8.930309757836516
[09/27 13:28:46 visual_prompt]: Epoch 76 / 100: avg data time: 1.05e+01, avg batch time: 10.9299, average train loss: 4.4633
[09/27 13:29:30 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.2282, average loss: 1.9757
[09/27 13:29:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.28	rocauc: 56.98	
[09/27 13:29:30 visual_prompt]: Training 77 / 100 epoch, with learning rate 8.271734841028552
[09/27 13:35:52 visual_prompt]: Epoch 77 / 100: avg data time: 1.04e+01, avg batch time: 10.9034, average train loss: 5.3099
[09/27 13:36:37 visual_prompt]: Inference (val):avg data time: 2.23e-05, avg batch time: 0.2290, average loss: 2.6896
[09/27 13:36:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.91	rocauc: 57.21	
[09/27 13:36:37 visual_prompt]: Training 78 / 100 epoch, with learning rate 7.633540738525066
[09/27 13:42:58 visual_prompt]: Epoch 78 / 100: avg data time: 1.04e+01, avg batch time: 10.8775, average train loss: 2.8576
[09/27 13:43:42 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.2242, average loss: 1.5477
[09/27 13:43:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.63	
[09/27 13:43:42 visual_prompt]: Training 79 / 100 epoch, with learning rate 7.016504991533726
[09/27 13:50:03 visual_prompt]: Epoch 79 / 100: avg data time: 1.04e+01, avg batch time: 10.8889, average train loss: 2.0412
[09/27 13:50:48 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2217, average loss: 1.7045
[09/27 13:50:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.28	rocauc: 58.62	
[09/27 13:50:48 visual_prompt]: Training 80 / 100 epoch, with learning rate 6.4213793630651415
[09/27 13:57:11 visual_prompt]: Epoch 80 / 100: avg data time: 1.05e+01, avg batch time: 10.9295, average train loss: 2.9387
[09/27 13:57:55 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.2289, average loss: 3.3978
[09/27 13:57:55 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 58.61	
[09/27 13:57:55 visual_prompt]: Training 81 / 100 epoch, with learning rate 5.848888922025552
[09/27 14:04:18 visual_prompt]: Epoch 81 / 100: avg data time: 1.05e+01, avg batch time: 10.9266, average train loss: 4.0723
[09/27 14:05:03 visual_prompt]: Inference (val):avg data time: 2.79e-05, avg batch time: 0.2280, average loss: 7.3484
[09/27 14:05:03 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.18	
[09/27 14:05:03 visual_prompt]: Training 82 / 100 epoch, with learning rate 5.2997311598319525
[09/27 14:11:24 visual_prompt]: Epoch 82 / 100: avg data time: 1.04e+01, avg batch time: 10.8875, average train loss: 2.6489
[09/27 14:12:09 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.2265, average loss: 1.9606
[09/27 14:12:09 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 59.52	
[09/27 14:12:09 visual_prompt]: Training 83 / 100 epoch, with learning rate 4.774575140626316
[09/27 14:18:31 visual_prompt]: Epoch 83 / 100: avg data time: 1.05e+01, avg batch time: 10.9111, average train loss: 1.2749
[09/27 14:19:16 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2244, average loss: 0.6899
[09/27 14:19:16 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.07	rocauc: 61.41	
[09/27 14:19:16 visual_prompt]: Training 84 / 100 epoch, with learning rate 4.27406068612396
[09/27 14:25:37 visual_prompt]: Epoch 84 / 100: avg data time: 1.04e+01, avg batch time: 10.8970, average train loss: 1.7345
[09/27 14:26:22 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2323, average loss: 2.5308
[09/27 14:26:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 59.91	
[09/27 14:26:22 visual_prompt]: Training 85 / 100 epoch, with learning rate 3.798797596089351
[09/27 14:32:45 visual_prompt]: Epoch 85 / 100: avg data time: 1.05e+01, avg batch time: 10.9390, average train loss: 1.1186
[09/27 14:33:30 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.2358, average loss: 0.7511
[09/27 14:33:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.69	rocauc: 59.97	
[09/27 14:33:30 visual_prompt]: Training 86 / 100 epoch, with learning rate 3.349364905389032
[09/27 14:39:53 visual_prompt]: Epoch 86 / 100: avg data time: 1.05e+01, avg batch time: 10.9435, average train loss: 0.9412
[09/27 14:40:38 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.2211, average loss: 1.1585
[09/27 14:40:38 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 61.69	
[09/27 14:40:38 visual_prompt]: Training 87 / 100 epoch, with learning rate 2.9263101785268253
[09/27 14:47:02 visual_prompt]: Epoch 87 / 100: avg data time: 1.05e+01, avg batch time: 10.9477, average train loss: 0.8545
[09/27 14:47:46 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2254, average loss: 0.7107
[09/27 14:47:46 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.88	rocauc: 59.73	
[09/27 14:47:46 visual_prompt]: Training 88 / 100 epoch, with learning rate 2.5301488425208296
[09/27 14:54:09 visual_prompt]: Epoch 88 / 100: avg data time: 1.05e+01, avg batch time: 10.9257, average train loss: 0.8447
[09/27 14:54:54 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.2338, average loss: 0.8789
[09/27 14:54:54 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.25	
[09/27 14:54:54 visual_prompt]: Training 89 / 100 epoch, with learning rate 2.1613635589349753
[09/27 15:01:21 visual_prompt]: Epoch 89 / 100: avg data time: 1.06e+01, avg batch time: 11.0439, average train loss: 0.8198
[09/27 15:02:06 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.2364, average loss: 0.7453
[09/27 15:02:06 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.43	
[09/27 15:02:06 visual_prompt]: Training 90 / 100 epoch, with learning rate 1.820403635830317
[09/27 15:08:30 visual_prompt]: Epoch 90 / 100: avg data time: 1.05e+01, avg batch time: 10.9673, average train loss: 0.8211
[09/27 15:09:15 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.2378, average loss: 0.7362
[09/27 15:09:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.07	rocauc: 58.93	
[09/27 15:09:15 visual_prompt]: Training 91 / 100 epoch, with learning rate 1.507684480352292
[09/27 15:15:40 visual_prompt]: Epoch 91 / 100: avg data time: 1.05e+01, avg batch time: 10.9929, average train loss: 0.7594
[09/27 15:16:25 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2275, average loss: 0.9395
[09/27 15:16:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.61	
[09/27 15:16:25 visual_prompt]: Training 92 / 100 epoch, with learning rate 1.2235870926211616
[09/27 15:22:50 visual_prompt]: Epoch 92 / 100: avg data time: 1.05e+01, avg batch time: 10.9949, average train loss: 0.7461
[09/27 15:23:35 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.2323, average loss: 0.7457
[09/27 15:23:35 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.07	rocauc: 59.38	
[09/27 15:23:35 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.9684576015420276
[09/27 15:30:00 visual_prompt]: Epoch 93 / 100: avg data time: 1.05e+01, avg batch time: 10.9934, average train loss: 0.7690
[09/27 15:30:45 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.2221, average loss: 0.9738
[09/27 15:30:45 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 59.92	
[09/27 15:30:45 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.7426068431000882
[09/27 15:37:09 visual_prompt]: Epoch 94 / 100: avg data time: 1.05e+01, avg batch time: 10.9554, average train loss: 0.7387
[09/27 15:37:54 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2296, average loss: 0.9016
[09/27 15:37:54 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.16	
[09/27 15:37:54 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.5463099816548578
[09/27 15:44:20 visual_prompt]: Epoch 95 / 100: avg data time: 1.06e+01, avg batch time: 11.0194, average train loss: 0.7470
[09/27 15:45:05 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.2329, average loss: 0.9128
[09/27 15:45:05 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.02	
[09/27 15:45:05 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.3798061746947995
[09/27 15:51:30 visual_prompt]: Epoch 96 / 100: avg data time: 1.05e+01, avg batch time: 11.0046, average train loss: 0.7183
[09/27 15:52:15 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2342, average loss: 0.8319
[09/27 15:52:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.97	
[09/27 15:52:15 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.24329828146074095
[09/27 15:58:42 visual_prompt]: Epoch 97 / 100: avg data time: 1.05e+01, avg batch time: 11.0331, average train loss: 0.7403
[09/27 15:59:27 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.2371, average loss: 0.7598
[09/27 15:59:27 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.25	
[09/27 15:59:27 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.13695261579316775
[09/27 16:05:54 visual_prompt]: Epoch 98 / 100: avg data time: 1.06e+01, avg batch time: 11.0502, average train loss: 0.7106
[09/27 16:06:39 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.2313, average loss: 0.9283
[09/27 16:06:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.49	
[09/27 16:06:39 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.06089874350439506
[09/27 16:13:05 visual_prompt]: Epoch 99 / 100: avg data time: 1.06e+01, avg batch time: 11.0293, average train loss: 0.7229
[09/27 16:13:51 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2190, average loss: 0.9120
[09/27 16:13:51 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.58	
[09/27 16:13:51 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.015229324522605947
[09/27 16:20:17 visual_prompt]: Epoch 100 / 100: avg data time: 1.06e+01, avg batch time: 11.0304, average train loss: 0.7090
[09/27 16:21:02 visual_prompt]: Inference (val):avg data time: 2.84e-05, avg batch time: 0.2427, average loss: 0.8455
[09/27 16:21:02 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.57	
[09/27 16:21:02 visual_prompt]: Rank of current process: 0. World size: 1
[09/27 16:21:02 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              0
GPU 0                NVIDIA A100-PCIE-40GB
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/27 16:21:02 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'mammo-cbis', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/27 16:21:02 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/27 16:21:02 visual_prompt]: Training with config:
[09/27 16:21:02 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/mammo-cbis/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr25.0_wd0.01/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.01, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 25.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'mammo-cbis', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/27 16:21:02 visual_prompt]: Loading training data...
[09/27 16:21:02 visual_prompt]: Constructing mammo-cbis dataset train...
[09/27 16:21:02 visual_prompt]: Loading validation data...
[09/27 16:21:02 visual_prompt]: Constructing mammo-cbis dataset val...
[09/27 16:21:02 visual_prompt]: Constructing models...
[09/27 16:21:05 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/27 16:21:05 visual_prompt]: tuned percent:0.536
[09/27 16:21:05 visual_prompt]: Device used for model: 0
[09/27 16:21:05 visual_prompt]: Setting up Evaluator...
[09/27 16:21:05 visual_prompt]: Setting up Trainer...
[09/27 16:21:05 visual_prompt]: 	Setting up the optimizer...
[09/27 16:21:05 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/27 16:27:32 visual_prompt]: Epoch 1 / 100: avg data time: 1.06e+01, avg batch time: 11.0529, average train loss: 1.4903
[09/27 16:28:17 visual_prompt]: Inference (val):avg data time: 1.95e-05, avg batch time: 0.2410, average loss: 1.4710
[09/27 16:28:17 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.15	
[09/27 16:28:17 visual_prompt]: Best epoch 1: best metric: 0.537
[09/27 16:28:17 visual_prompt]: Training 2 / 100 epoch, with learning rate 2.5
[09/27 16:34:44 visual_prompt]: Epoch 2 / 100: avg data time: 1.06e+01, avg batch time: 11.0482, average train loss: 16.8730
[09/27 16:35:30 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2140, average loss: 15.0763
[09/27 16:35:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.22	
[09/27 16:35:30 visual_prompt]: Training 3 / 100 epoch, with learning rate 5.0
[09/27 16:41:57 visual_prompt]: Epoch 3 / 100: avg data time: 1.06e+01, avg batch time: 11.0640, average train loss: 13.9544
[09/27 16:42:42 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.2319, average loss: 9.9981
[09/27 16:42:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.14	
[09/27 16:42:42 visual_prompt]: Training 4 / 100 epoch, with learning rate 7.5
[09/27 16:49:07 visual_prompt]: Epoch 4 / 100: avg data time: 1.05e+01, avg batch time: 10.9964, average train loss: 15.3590
[09/27 16:49:52 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2322, average loss: 11.3670
[09/27 16:49:52 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 48.29	
[09/27 16:49:52 visual_prompt]: Training 5 / 100 epoch, with learning rate 10.0
[09/27 16:56:18 visual_prompt]: Epoch 5 / 100: avg data time: 1.06e+01, avg batch time: 11.0212, average train loss: 29.6332
[09/27 16:57:03 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.2228, average loss: 15.5691
[09/27 16:57:03 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.11	
[09/27 16:57:03 visual_prompt]: Training 6 / 100 epoch, with learning rate 12.5
[09/27 17:03:31 visual_prompt]: Epoch 6 / 100: avg data time: 1.06e+01, avg batch time: 11.0746, average train loss: 30.0637
[09/27 17:04:16 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2368, average loss: 23.2159
[09/27 17:04:16 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.58	
[09/27 17:04:16 visual_prompt]: Training 7 / 100 epoch, with learning rate 15.0
[09/27 17:10:42 visual_prompt]: Epoch 7 / 100: avg data time: 1.05e+01, avg batch time: 11.0057, average train loss: 29.7835
[09/27 17:11:27 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.2326, average loss: 26.6600
[09/27 17:11:27 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.65	
[09/27 17:11:27 visual_prompt]: Training 8 / 100 epoch, with learning rate 17.5
[09/27 17:17:51 visual_prompt]: Epoch 8 / 100: avg data time: 1.05e+01, avg batch time: 10.9536, average train loss: 41.7016
[09/27 17:18:36 visual_prompt]: Inference (val):avg data time: 2.04e-05, avg batch time: 0.2234, average loss: 16.1353
[09/27 17:18:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 43.27	
[09/27 17:18:36 visual_prompt]: Training 9 / 100 epoch, with learning rate 20.0
[09/27 17:25:02 visual_prompt]: Epoch 9 / 100: avg data time: 1.06e+01, avg batch time: 11.0305, average train loss: 61.8345
[09/27 17:25:47 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2305, average loss: 1.1134
[09/27 17:25:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 50.41	rocauc: 54.97	
[09/27 17:25:47 visual_prompt]: Training 10 / 100 epoch, with learning rate 22.5
[09/27 17:32:11 visual_prompt]: Epoch 10 / 100: avg data time: 1.05e+01, avg batch time: 10.9676, average train loss: 50.0688
[09/27 17:32:57 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2350, average loss: 16.8633
[09/27 17:32:57 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.46	
[09/27 17:32:57 visual_prompt]: Training 11 / 100 epoch, with learning rate 25.0
[09/27 17:39:24 visual_prompt]: Epoch 11 / 100: avg data time: 1.06e+01, avg batch time: 11.0643, average train loss: 64.9435
[09/27 17:40:09 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.2344, average loss: 45.8812
[09/27 17:40:09 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 41.75	
[09/27 17:40:09 visual_prompt]: Training 12 / 100 epoch, with learning rate 24.9923853377387
[09/27 17:46:37 visual_prompt]: Epoch 12 / 100: avg data time: 1.06e+01, avg batch time: 11.0648, average train loss: 54.4993
[09/27 17:47:22 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2315, average loss: 148.5877
[09/27 17:47:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.48	
[09/27 17:47:22 visual_prompt]: Training 13 / 100 epoch, with learning rate 24.969550628247802
[09/27 17:53:47 visual_prompt]: Epoch 13 / 100: avg data time: 1.05e+01, avg batch time: 10.9938, average train loss: 56.1452
[09/27 17:54:33 visual_prompt]: Inference (val):avg data time: 2.02e-05, avg batch time: 0.2342, average loss: 4.4951
[09/27 17:54:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.93	
[09/27 17:54:33 visual_prompt]: Training 14 / 100 epoch, with learning rate 24.931523692103415
[09/27 18:01:00 visual_prompt]: Epoch 14 / 100: avg data time: 1.06e+01, avg batch time: 11.0528, average train loss: 73.5586
[09/27 18:01:45 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.2352, average loss: 72.3958
[09/27 18:01:45 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 46.37	
[09/27 18:01:45 visual_prompt]: Training 15 / 100 epoch, with learning rate 24.87835085926963
[09/27 18:08:13 visual_prompt]: Epoch 15 / 100: avg data time: 1.06e+01, avg batch time: 11.0890, average train loss: 79.1103
[09/27 18:08:59 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.2350, average loss: 168.4979
[09/27 18:08:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 63.34	
[09/27 18:08:59 visual_prompt]: Training 16 / 100 epoch, with learning rate 24.8100969126526
[09/27 18:15:26 visual_prompt]: Epoch 16 / 100: avg data time: 1.06e+01, avg batch time: 11.0621, average train loss: 72.0953
[09/27 18:16:12 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.2291, average loss: 184.7695
[09/27 18:16:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 48.05	
[09/27 18:16:12 visual_prompt]: Training 17 / 100 epoch, with learning rate 24.72684500917257
[09/27 18:22:41 visual_prompt]: Epoch 17 / 100: avg data time: 1.06e+01, avg batch time: 11.1169, average train loss: 64.3631
[09/27 18:23:26 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2365, average loss: 51.3022
[09/27 18:23:26 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 41.21	
[09/27 18:23:26 visual_prompt]: Training 18 / 100 epoch, with learning rate 24.628696578449954
[09/27 18:29:55 visual_prompt]: Epoch 18 / 100: avg data time: 1.06e+01, avg batch time: 11.0881, average train loss: 68.4057
[09/27 18:30:40 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.2251, average loss: 125.2345
[09/27 18:30:40 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.24	
[09/27 18:30:40 visual_prompt]: Training 19 / 100 epoch, with learning rate 24.515771199228986
[09/27 18:37:07 visual_prompt]: Epoch 19 / 100: avg data time: 1.06e+01, avg batch time: 11.0534, average train loss: 74.7902
[09/27 18:37:52 visual_prompt]: Inference (val):avg data time: 2.11e-05, avg batch time: 0.2394, average loss: 62.7735
[09/27 18:37:52 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 60.14	
[09/27 18:37:52 visual_prompt]: Training 20 / 100 epoch, with learning rate 24.38820645368942
[09/27 18:44:17 visual_prompt]: Epoch 20 / 100: avg data time: 1.05e+01, avg batch time: 10.9947, average train loss: 72.6927
[09/27 18:45:02 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.2201, average loss: 165.5502
[09/27 18:45:02 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.07	
[09/27 18:45:02 visual_prompt]: Training 21 / 100 epoch, with learning rate 24.246157759823856
[09/27 18:51:30 visual_prompt]: Epoch 21 / 100: avg data time: 1.06e+01, avg batch time: 11.0711, average train loss: 54.3866
[09/27 18:52:15 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2233, average loss: 74.2759
[09/27 18:52:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.67	
[09/27 18:52:15 visual_prompt]: Training 22 / 100 epoch, with learning rate 24.08979818208484
[09/27 18:58:40 visual_prompt]: Epoch 22 / 100: avg data time: 1.05e+01, avg batch time: 10.9924, average train loss: 89.5721
[09/27 18:59:25 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.2291, average loss: 48.7608
[09/27 18:59:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 51.22	rocauc: 52.80	
[09/27 18:59:25 visual_prompt]: Training 23 / 100 epoch, with learning rate 23.91931822053251
[09/27 19:05:51 visual_prompt]: Epoch 23 / 100: avg data time: 1.06e+01, avg batch time: 11.0257, average train loss: 72.0905
[09/27 19:06:36 visual_prompt]: Inference (val):avg data time: 2.00e-05, avg batch time: 0.2266, average loss: 23.3743
[09/27 19:06:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.70	
[09/27 19:06:36 visual_prompt]: Training 24 / 100 epoch, with learning rate 23.73492557873959
[09/27 19:13:02 visual_prompt]: Epoch 24 / 100: avg data time: 1.06e+01, avg batch time: 11.0182, average train loss: 85.7900
[09/27 19:13:47 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.2230, average loss: 251.3992
[09/27 19:13:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 40.19	
[09/27 19:13:47 visual_prompt]: Training 25 / 100 epoch, with learning rate 23.536844910736587
[09/27 19:20:14 visual_prompt]: Epoch 25 / 100: avg data time: 1.06e+01, avg batch time: 11.0352, average train loss: 55.2667
[09/27 19:20:59 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2320, average loss: 36.9004
[09/27 19:20:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.25	
[09/27 19:20:59 visual_prompt]: Training 26 / 100 epoch, with learning rate 23.325317547305485
[09/27 19:27:26 visual_prompt]: Epoch 26 / 100: avg data time: 1.06e+01, avg batch time: 11.0605, average train loss: 49.7370
[09/27 19:28:11 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2376, average loss: 50.8425
[09/27 19:28:11 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 48.54	
[09/27 19:28:11 visual_prompt]: Training 27 / 100 epoch, with learning rate 23.100601201955325
[09/27 19:34:39 visual_prompt]: Epoch 27 / 100: avg data time: 1.06e+01, avg batch time: 11.0736, average train loss: 51.6643
[09/27 19:35:24 visual_prompt]: Inference (val):avg data time: 2.07e-05, avg batch time: 0.2349, average loss: 30.9399
[09/27 19:35:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 48.82	
[09/27 19:35:24 visual_prompt]: Training 28 / 100 epoch, with learning rate 22.86296965693802
[09/27 19:41:52 visual_prompt]: Epoch 28 / 100: avg data time: 1.06e+01, avg batch time: 11.0788, average train loss: 66.6329
[09/27 19:42:38 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.2337, average loss: 309.4719
[09/27 19:42:38 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.21	
[09/27 19:42:38 visual_prompt]: Training 29 / 100 epoch, with learning rate 22.612712429686844
[09/27 19:49:06 visual_prompt]: Epoch 29 / 100: avg data time: 1.06e+01, avg batch time: 11.0735, average train loss: 60.2609
[09/27 19:49:51 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2407, average loss: 21.8653
[09/27 19:49:51 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 46.00	
[09/27 19:49:51 visual_prompt]: Training 30 / 100 epoch, with learning rate 22.35013442008402
[09/27 19:56:18 visual_prompt]: Epoch 30 / 100: avg data time: 1.06e+01, avg batch time: 11.0542, average train loss: 34.2034
[09/27 19:57:03 visual_prompt]: Inference (val):avg data time: 2.09e-05, avg batch time: 0.2225, average loss: 22.2718
[09/27 19:57:03 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.81	
[09/27 19:57:03 visual_prompt]: Training 31 / 100 epoch, with learning rate 22.075555538987224
[09/27 20:03:31 visual_prompt]: Epoch 31 / 100: avg data time: 1.06e+01, avg batch time: 11.0596, average train loss: 57.4835
[09/27 20:04:16 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.2418, average loss: 11.4326
[09/27 20:04:16 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.66	
[09/27 20:04:16 visual_prompt]: Training 32 / 100 epoch, with learning rate 21.78931031846743
[09/27 20:10:42 visual_prompt]: Epoch 32 / 100: avg data time: 1.06e+01, avg batch time: 11.0330, average train loss: 59.4564
[09/27 20:11:27 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2326, average loss: 29.1412
[09/27 20:11:27 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 59.40	
[09/27 20:11:27 visual_prompt]: Training 33 / 100 epoch, with learning rate 21.49174750423314
[09/27 20:17:54 visual_prompt]: Epoch 33 / 100: avg data time: 1.06e+01, avg batch time: 11.0572, average train loss: 57.4008
[09/27 20:18:39 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2237, average loss: 16.6152
[09/27 20:18:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.42	
[09/27 20:18:39 visual_prompt]: Training 34 / 100 epoch, with learning rate 21.183229630737465
[09/27 20:25:07 visual_prompt]: Epoch 34 / 100: avg data time: 1.06e+01, avg batch time: 11.0545, average train loss: 52.4918
[09/27 20:25:51 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.2291, average loss: 111.7578
[09/27 20:25:51 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.46	
[09/27 20:25:51 visual_prompt]: Training 35 / 100 epoch, with learning rate 20.864132579485727
[09/27 20:32:17 visual_prompt]: Epoch 35 / 100: avg data time: 1.05e+01, avg batch time: 10.9980, average train loss: 47.7688
[09/27 20:33:02 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.2359, average loss: 69.3147
[09/27 20:33:02 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.73	
[09/27 20:33:02 visual_prompt]: Training 36 / 100 epoch, with learning rate 20.53484512108174
[09/27 20:39:28 visual_prompt]: Epoch 36 / 100: avg data time: 1.05e+01, avg batch time: 11.0107, average train loss: 53.0598
[09/27 20:40:13 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.2307, average loss: 34.3383
[09/27 20:40:13 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 45.86	
[09/27 20:40:13 visual_prompt]: Training 37 / 100 epoch, with learning rate 20.195768441570728
[09/27 20:46:37 visual_prompt]: Epoch 37 / 100: avg data time: 1.05e+01, avg batch time: 10.9770, average train loss: 56.3734
[09/27 20:47:22 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.2245, average loss: 24.2354
[09/27 20:47:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 60.73	
[09/27 20:47:22 visual_prompt]: Training 38 / 100 epoch, with learning rate 19.847315653655915
[09/27 20:53:47 visual_prompt]: Epoch 38 / 100: avg data time: 1.05e+01, avg batch time: 10.9917, average train loss: 46.3255
[09/27 20:54:32 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2302, average loss: 38.3881
[09/27 20:54:32 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 49.87	
[09/27 20:54:32 visual_prompt]: Training 39 / 100 epoch, with learning rate 19.489911293384335
[09/27 21:00:58 visual_prompt]: Epoch 39 / 100: avg data time: 1.06e+01, avg batch time: 11.0066, average train loss: 36.1790
[09/27 21:01:43 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2371, average loss: 41.9621
[09/27 21:01:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.80	
[09/27 21:01:43 visual_prompt]: Training 40 / 100 epoch, with learning rate 19.12399080291506
[09/27 21:08:08 visual_prompt]: Epoch 40 / 100: avg data time: 1.05e+01, avg batch time: 11.0014, average train loss: 33.1071
[09/27 21:08:53 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2320, average loss: 30.8092
[09/27 21:08:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 41.02	
[09/27 21:08:53 visual_prompt]: Training 41 / 100 epoch, with learning rate 18.75
[09/27 21:15:20 visual_prompt]: Epoch 41 / 100: avg data time: 1.06e+01, avg batch time: 11.0370, average train loss: 31.6990
[09/27 21:16:05 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2219, average loss: 28.3779
[09/27 21:16:05 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 43.43	
[09/27 21:16:05 visual_prompt]: Training 42 / 100 epoch, with learning rate 18.368394534823633
[09/27 21:22:30 visual_prompt]: Epoch 42 / 100: avg data time: 1.05e+01, avg batch time: 10.9978, average train loss: 47.6759
[09/27 21:23:15 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.2444, average loss: 8.0682
[09/27 21:23:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 33.51	
[09/27 21:23:15 visual_prompt]: Training 43 / 100 epoch, with learning rate 17.979639334863467
[09/27 21:29:42 visual_prompt]: Epoch 43 / 100: avg data time: 1.06e+01, avg batch time: 11.0464, average train loss: 57.3725
[09/27 21:30:27 visual_prompt]: Inference (val):avg data time: 2.92e-05, avg batch time: 0.2270, average loss: 47.9156
[09/27 21:30:27 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.33	
[09/27 21:30:27 visual_prompt]: Training 44 / 100 epoch, with learning rate 17.584208038447503
[09/27 21:36:54 visual_prompt]: Epoch 44 / 100: avg data time: 1.06e+01, avg batch time: 11.0263, average train loss: 59.2578
[09/27 21:37:39 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.2292, average loss: 144.4968
[09/27 21:37:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.86	
[09/27 21:37:39 visual_prompt]: Training 45 / 100 epoch, with learning rate 17.182582417698903
[09/27 21:44:04 visual_prompt]: Epoch 45 / 100: avg data time: 1.06e+01, avg batch time: 11.0129, average train loss: 48.3213
[09/27 21:44:50 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.2277, average loss: 24.6558
[09/27 21:44:50 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 46.08	
[09/27 21:44:50 visual_prompt]: Training 46 / 100 epoch, with learning rate 16.77525179157086
[09/27 21:51:15 visual_prompt]: Epoch 46 / 100: avg data time: 1.05e+01, avg batch time: 11.0035, average train loss: 37.1131
[09/27 21:52:00 visual_prompt]: Inference (val):avg data time: 1.98e-05, avg batch time: 0.2324, average loss: 68.6709
[09/27 21:52:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 62.02	
[09/27 21:52:00 visual_prompt]: Training 47 / 100 epoch, with learning rate 16.362712429686844
[09/27 21:58:28 visual_prompt]: Epoch 47 / 100: avg data time: 1.06e+01, avg batch time: 11.0541, average train loss: 39.0206
[09/27 21:59:13 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.2322, average loss: 39.2425
[09/27 21:59:13 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 39.27	
[09/27 21:59:13 visual_prompt]: Training 48 / 100 epoch, with learning rate 15.94546694771249
[09/27 22:05:39 visual_prompt]: Epoch 48 / 100: avg data time: 1.06e+01, avg batch time: 11.0201, average train loss: 37.5531
[09/27 22:06:24 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.2260, average loss: 31.3916
[09/27 22:06:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 45.61	
[09/27 22:06:24 visual_prompt]: Training 49 / 100 epoch, with learning rate 15.524023694995845
[09/27 22:12:51 visual_prompt]: Epoch 49 / 100: avg data time: 1.06e+01, avg batch time: 11.0541, average train loss: 52.8699
[09/27 22:13:36 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2382, average loss: 5.1075
[09/27 22:13:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 45.73	
[09/27 22:13:36 visual_prompt]: Training 50 / 100 epoch, with learning rate 15.09889613522199
[09/27 22:20:03 visual_prompt]: Epoch 50 / 100: avg data time: 1.06e+01, avg batch time: 11.0441, average train loss: 53.3432
[09/27 22:20:48 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.2376, average loss: 5.5439
[09/27 22:20:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.56	
[09/27 22:20:48 visual_prompt]: Training 51 / 100 epoch, with learning rate 14.670602220836631
[09/27 22:27:10 visual_prompt]: Epoch 51 / 100: avg data time: 1.05e+01, avg batch time: 10.9062, average train loss: 49.8567
[09/27 22:27:54 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.2345, average loss: 12.9396
[09/27 22:27:54 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.58	
[09/27 22:27:54 visual_prompt]: Training 52 / 100 epoch, with learning rate 14.239663762000818
[09/27 22:34:17 visual_prompt]: Epoch 52 / 100: avg data time: 1.05e+01, avg batch time: 10.9255, average train loss: 26.4935
[09/27 22:35:02 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.2360, average loss: 93.7535
[09/27 22:35:02 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.48	
[09/27 22:35:02 visual_prompt]: Training 53 / 100 epoch, with learning rate 13.80660579084567
[09/27 22:41:27 visual_prompt]: Epoch 53 / 100: avg data time: 1.05e+01, avg batch time: 10.9861, average train loss: 26.0887
[09/27 22:42:12 visual_prompt]: Inference (val):avg data time: 2.01e-05, avg batch time: 0.2232, average loss: 44.2073
[09/27 22:42:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 45.51	
[09/27 22:42:12 visual_prompt]: Training 54 / 100 epoch, with learning rate 13.371955921801565
[09/27 22:48:39 visual_prompt]: Epoch 54 / 100: avg data time: 1.06e+01, avg batch time: 11.0700, average train loss: 34.8372
[09/27 22:49:25 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2125, average loss: 23.7685
[09/27 22:49:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 43.33	
[09/27 22:49:25 visual_prompt]: Training 55 / 100 epoch, with learning rate 12.936243708781264
[09/27 22:55:53 visual_prompt]: Epoch 55 / 100: avg data time: 1.06e+01, avg batch time: 11.0870, average train loss: 30.1061
[09/27 22:56:39 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2417, average loss: 28.5868
[09/27 22:56:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 43.94	
[09/27 22:56:39 visual_prompt]: Training 56 / 100 epoch, with learning rate 12.5
[09/27 23:03:07 visual_prompt]: Epoch 56 / 100: avg data time: 1.06e+01, avg batch time: 11.0838, average train loss: 23.4033
[09/27 23:03:52 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.2271, average loss: 10.7962
[09/27 23:03:52 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 44.28	
[09/27 23:03:52 visual_prompt]: Training 57 / 100 epoch, with learning rate 12.063756291218741
[09/27 23:10:20 visual_prompt]: Epoch 57 / 100: avg data time: 1.06e+01, avg batch time: 11.0854, average train loss: 26.6626
[09/27 23:11:06 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2266, average loss: 66.0175
[09/27 23:11:06 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 40.10	
[09/27 23:11:06 visual_prompt]: Training 58 / 100 epoch, with learning rate 11.628044078198434
[09/27 23:17:33 visual_prompt]: Epoch 58 / 100: avg data time: 1.06e+01, avg batch time: 11.0663, average train loss: 27.4497
[09/27 23:18:18 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2252, average loss: 9.2910
[09/27 23:18:18 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.53	
[09/27 23:18:18 visual_prompt]: Training 59 / 100 epoch, with learning rate 11.193394209154334
[09/27 23:24:47 visual_prompt]: Epoch 59 / 100: avg data time: 1.07e+01, avg batch time: 11.0947, average train loss: 26.3830
[09/27 23:25:33 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.2262, average loss: 32.7897
[09/27 23:25:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 38.13	
[09/27 23:25:33 visual_prompt]: Training 60 / 100 epoch, with learning rate 10.760336237999185
[09/27 23:32:02 visual_prompt]: Epoch 60 / 100: avg data time: 1.06e+01, avg batch time: 11.1117, average train loss: 23.0644
[09/27 23:32:47 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.2346, average loss: 8.1345
[09/27 23:32:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 38.01	
[09/27 23:32:47 visual_prompt]: Training 61 / 100 epoch, with learning rate 10.32939777916337
[09/27 23:39:17 visual_prompt]: Epoch 61 / 100: avg data time: 1.07e+01, avg batch time: 11.1157, average train loss: 46.5828
[09/27 23:40:02 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2427, average loss: 51.3980
[09/27 23:40:02 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 60.98	
[09/27 23:40:02 visual_prompt]: Training 62 / 100 epoch, with learning rate 9.90110386477801
[09/27 23:46:30 visual_prompt]: Epoch 62 / 100: avg data time: 1.06e+01, avg batch time: 11.0784, average train loss: 40.2749
[09/27 23:47:15 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.2299, average loss: 14.5006
[09/27 23:47:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.07	rocauc: 55.80	
[09/27 23:47:15 visual_prompt]: Best epoch 62: best metric: 0.541
[09/27 23:47:15 visual_prompt]: Training 63 / 100 epoch, with learning rate 9.475976305004155
[09/27 23:53:43 visual_prompt]: Epoch 63 / 100: avg data time: 1.06e+01, avg batch time: 11.0692, average train loss: 22.2912
[09/27 23:54:28 visual_prompt]: Inference (val):avg data time: 2.20e-05, avg batch time: 0.2263, average loss: 3.6869
[09/27 23:54:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.68	
[09/27 23:54:28 visual_prompt]: Training 64 / 100 epoch, with learning rate 9.05453305228751
[09/28 00:00:56 visual_prompt]: Epoch 64 / 100: avg data time: 1.06e+01, avg batch time: 11.0760, average train loss: 21.8958
[09/28 00:01:42 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2289, average loss: 14.6605
[09/28 00:01:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 43.31	
[09/28 00:01:42 visual_prompt]: Training 65 / 100 epoch, with learning rate 8.637287570313159
[09/28 00:08:11 visual_prompt]: Epoch 65 / 100: avg data time: 1.06e+01, avg batch time: 11.1147, average train loss: 13.5197
[09/28 00:08:56 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2313, average loss: 38.7351
[09/28 00:08:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 48.24	
[09/28 00:08:56 visual_prompt]: Training 66 / 100 epoch, with learning rate 8.224748208429142
[09/28 00:15:25 visual_prompt]: Epoch 66 / 100: avg data time: 1.07e+01, avg batch time: 11.1179, average train loss: 19.9845
[09/28 00:16:11 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2310, average loss: 46.0078
[09/28 00:16:11 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.72	
[09/28 00:16:11 visual_prompt]: Training 67 / 100 epoch, with learning rate 7.817417582301099
[09/28 00:22:38 visual_prompt]: Epoch 67 / 100: avg data time: 1.06e+01, avg batch time: 11.0684, average train loss: 18.5468
[09/28 00:23:24 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2231, average loss: 0.8887
[09/28 00:23:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.25	rocauc: 38.72	
[09/28 00:23:24 visual_prompt]: Training 68 / 100 epoch, with learning rate 7.415791961552499
[09/28 00:29:52 visual_prompt]: Epoch 68 / 100: avg data time: 1.06e+01, avg batch time: 11.0820, average train loss: 19.3150
[09/28 00:30:38 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.2287, average loss: 66.1050
[09/28 00:30:38 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.76	
[09/28 00:30:38 visual_prompt]: Training 69 / 100 epoch, with learning rate 7.020360665136531
[09/28 00:37:05 visual_prompt]: Epoch 69 / 100: avg data time: 1.06e+01, avg batch time: 11.0593, average train loss: 19.1551
[09/28 00:37:50 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2309, average loss: 11.0971
[09/28 00:37:50 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.65	
[09/28 00:37:50 visual_prompt]: Training 70 / 100 epoch, with learning rate 6.631605465176368
[09/28 00:44:18 visual_prompt]: Epoch 70 / 100: avg data time: 1.06e+01, avg batch time: 11.0852, average train loss: 16.3771
[09/28 00:45:04 visual_prompt]: Inference (val):avg data time: 2.23e-05, avg batch time: 0.2382, average loss: 2.5591
[09/28 00:45:04 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.42	
[09/28 00:45:04 visual_prompt]: Training 71 / 100 epoch, with learning rate 6.250000000000003
[09/28 00:51:32 visual_prompt]: Epoch 71 / 100: avg data time: 1.06e+01, avg batch time: 11.0848, average train loss: 17.9093
[09/28 00:52:17 visual_prompt]: Inference (val):avg data time: 2.06e-05, avg batch time: 0.2248, average loss: 1.1804
[09/28 00:52:17 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.60	
[09/28 00:52:17 visual_prompt]: Training 72 / 100 epoch, with learning rate 5.87600919708494
[09/28 00:58:44 visual_prompt]: Epoch 72 / 100: avg data time: 1.06e+01, avg batch time: 11.0642, average train loss: 17.4745
[09/28 00:59:30 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2407, average loss: 18.3352
[09/28 00:59:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 60.92	
[09/28 00:59:30 visual_prompt]: Training 73 / 100 epoch, with learning rate 5.510088706615666
[09/28 01:05:58 visual_prompt]: Epoch 73 / 100: avg data time: 1.06e+01, avg batch time: 11.0859, average train loss: 13.2792
[09/28 01:06:43 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.2385, average loss: 12.3406
[09/28 01:06:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 42.01	
[09/28 01:06:43 visual_prompt]: Training 74 / 100 epoch, with learning rate 5.1526843463440875
[09/28 01:13:12 visual_prompt]: Epoch 74 / 100: avg data time: 1.06e+01, avg batch time: 11.0858, average train loss: 15.1308
[09/28 01:13:57 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.2377, average loss: 0.8598
[09/28 01:13:57 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.84	
[09/28 01:13:57 visual_prompt]: Training 75 / 100 epoch, with learning rate 4.804231558429271
[09/28 01:20:25 visual_prompt]: Epoch 75 / 100: avg data time: 1.06e+01, avg batch time: 11.0874, average train loss: 14.9787
[09/28 01:21:11 visual_prompt]: Inference (val):avg data time: 2.23e-05, avg batch time: 0.2317, average loss: 6.9725
[09/28 01:21:11 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.90	
[09/28 01:21:11 visual_prompt]: Training 76 / 100 epoch, with learning rate 4.465154878918258
[09/28 01:27:39 visual_prompt]: Epoch 76 / 100: avg data time: 1.06e+01, avg batch time: 11.0694, average train loss: 9.7419
[09/28 01:28:24 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.2391, average loss: 16.9447
[09/28 01:28:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.58	
[09/28 01:28:24 visual_prompt]: Training 77 / 100 epoch, with learning rate 4.135867420514276
[09/28 01:34:52 visual_prompt]: Epoch 77 / 100: avg data time: 1.06e+01, avg batch time: 11.0830, average train loss: 11.1386
[09/28 01:35:37 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2403, average loss: 2.0287
[09/28 01:35:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 42.64	
[09/28 01:35:37 visual_prompt]: Training 78 / 100 epoch, with learning rate 3.816770369262533
[09/28 01:42:06 visual_prompt]: Epoch 78 / 100: avg data time: 1.06e+01, avg batch time: 11.0833, average train loss: 7.3010
[09/28 01:42:51 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.2280, average loss: 1.6653
[09/28 01:42:51 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.01	
[09/28 01:42:51 visual_prompt]: Training 79 / 100 epoch, with learning rate 3.508252495766863
[09/28 01:49:18 visual_prompt]: Epoch 79 / 100: avg data time: 1.06e+01, avg batch time: 11.0621, average train loss: 7.0416
[09/28 01:50:04 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2326, average loss: 8.4422
[09/28 01:50:04 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.99	
[09/28 01:50:04 visual_prompt]: Training 80 / 100 epoch, with learning rate 3.2106896815325707
[09/28 01:56:33 visual_prompt]: Epoch 80 / 100: avg data time: 1.06e+01, avg batch time: 11.1144, average train loss: 4.6283
[09/28 01:57:18 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.2354, average loss: 2.4009
[09/28 01:57:18 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.73	
[09/28 01:57:18 visual_prompt]: Training 81 / 100 epoch, with learning rate 2.924444461012776
[09/28 02:03:47 visual_prompt]: Epoch 81 / 100: avg data time: 1.07e+01, avg batch time: 11.1083, average train loss: 4.9583
[09/28 02:04:32 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2310, average loss: 3.9005
[09/28 02:04:32 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 43.53	
[09/28 02:04:32 visual_prompt]: Training 82 / 100 epoch, with learning rate 2.6498655799159763
[09/28 02:11:00 visual_prompt]: Epoch 82 / 100: avg data time: 1.06e+01, avg batch time: 11.0753, average train loss: 3.6863
[09/28 02:11:46 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.2262, average loss: 3.7358
[09/28 02:11:46 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.04	
[09/28 02:11:46 visual_prompt]: Training 83 / 100 epoch, with learning rate 2.387287570313158
[09/28 02:18:15 visual_prompt]: Epoch 83 / 100: avg data time: 1.06e+01, avg batch time: 11.0908, average train loss: 3.0088
[09/28 02:19:00 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2234, average loss: 7.6715
[09/28 02:19:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 46.75	
[09/28 02:19:00 visual_prompt]: Training 84 / 100 epoch, with learning rate 2.13703034306198
[09/28 02:25:29 visual_prompt]: Epoch 84 / 100: avg data time: 1.06e+01, avg batch time: 11.0964, average train loss: 2.8525
[09/28 02:26:14 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2287, average loss: 0.6948
[09/28 02:26:14 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 60.69	
[09/28 02:26:14 visual_prompt]: Training 85 / 100 epoch, with learning rate 1.8993987980446756
[09/28 02:32:43 visual_prompt]: Epoch 85 / 100: avg data time: 1.07e+01, avg batch time: 11.1143, average train loss: 2.7442
[09/28 02:33:29 visual_prompt]: Inference (val):avg data time: 2.11e-05, avg batch time: 0.2431, average loss: 1.1820
[09/28 02:33:29 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 42.03	
[09/28 02:33:29 visual_prompt]: Training 86 / 100 epoch, with learning rate 1.674682452694516
[09/28 02:39:57 visual_prompt]: Epoch 86 / 100: avg data time: 1.06e+01, avg batch time: 11.0894, average train loss: 1.9573
[09/28 02:40:42 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.2410, average loss: 1.3193
[09/28 02:40:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.09	
[09/28 02:40:42 visual_prompt]: Training 87 / 100 epoch, with learning rate 1.4631550892634126
[09/28 02:47:11 visual_prompt]: Epoch 87 / 100: avg data time: 1.06e+01, avg batch time: 11.0925, average train loss: 1.2486
[09/28 02:47:56 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.2298, average loss: 0.7850
[09/28 02:47:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.71	
[09/28 02:47:56 visual_prompt]: Training 88 / 100 epoch, with learning rate 1.2650744212604148
[09/28 02:54:24 visual_prompt]: Epoch 88 / 100: avg data time: 1.06e+01, avg batch time: 11.0584, average train loss: 1.3070
[09/28 02:55:09 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.2324, average loss: 0.7267
[09/28 02:55:09 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.92	
[09/28 02:55:09 visual_prompt]: Training 89 / 100 epoch, with learning rate 1.0806817794674877
[09/28 03:01:38 visual_prompt]: Epoch 89 / 100: avg data time: 1.06e+01, avg batch time: 11.1035, average train loss: 1.1601
[09/28 03:02:23 visual_prompt]: Inference (val):avg data time: 2.08e-05, avg batch time: 0.2280, average loss: 1.1917
[09/28 03:02:23 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.83	
[09/28 03:02:23 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.9102018179151585
[09/28 03:08:51 visual_prompt]: Epoch 90 / 100: avg data time: 1.06e+01, avg batch time: 11.0690, average train loss: 0.8636
[09/28 03:09:36 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.2343, average loss: 0.7907
[09/28 03:09:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.07	
[09/28 03:09:36 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.753842240176146
[09/28 03:16:04 visual_prompt]: Epoch 91 / 100: avg data time: 1.06e+01, avg batch time: 11.0798, average train loss: 0.8578
[09/28 03:16:50 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2395, average loss: 0.7568
[09/28 03:16:50 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.00	
[09/28 03:16:50 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.6117935463105808
[09/28 03:23:19 visual_prompt]: Epoch 92 / 100: avg data time: 1.06e+01, avg batch time: 11.1061, average train loss: 0.7403
[09/28 03:24:04 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.2295, average loss: 0.7622
[09/28 03:24:04 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 48.27	
[09/28 03:24:04 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.4842288007710138
[09/28 03:30:32 visual_prompt]: Epoch 93 / 100: avg data time: 1.06e+01, avg batch time: 11.0882, average train loss: 0.7648
[09/28 03:31:17 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2245, average loss: 0.6907
[09/28 03:31:17 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.29	
[09/28 03:31:17 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.3713034215500441
[09/28 03:37:45 visual_prompt]: Epoch 94 / 100: avg data time: 1.06e+01, avg batch time: 11.0768, average train loss: 0.7111
[09/28 03:38:31 visual_prompt]: Inference (val):avg data time: 2.10e-05, avg batch time: 0.2377, average loss: 0.6905
[09/28 03:38:31 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.00	
[09/28 03:38:31 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.2731549908274289
[09/28 03:44:59 visual_prompt]: Epoch 95 / 100: avg data time: 1.06e+01, avg batch time: 11.0831, average train loss: 0.6992
[09/28 03:45:44 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2242, average loss: 0.6980
[09/28 03:45:44 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.54	
[09/28 03:45:44 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.18990308734739975
[09/28 03:52:12 visual_prompt]: Epoch 96 / 100: avg data time: 1.06e+01, avg batch time: 11.0850, average train loss: 0.6993
[09/28 03:52:58 visual_prompt]: Inference (val):avg data time: 2.06e-05, avg batch time: 0.2274, average loss: 0.6909
[09/28 03:52:58 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.24	
[09/28 03:52:58 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.12164914073037048
[09/28 03:59:26 visual_prompt]: Epoch 97 / 100: avg data time: 1.06e+01, avg batch time: 11.0839, average train loss: 0.7018
[09/28 04:00:11 visual_prompt]: Inference (val):avg data time: 2.23e-05, avg batch time: 0.2297, average loss: 0.7291
[09/28 04:00:11 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.95	
[09/28 04:00:11 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.06847630789658388
[09/28 04:06:39 visual_prompt]: Epoch 98 / 100: avg data time: 1.06e+01, avg batch time: 11.0672, average train loss: 0.7003
[09/28 04:07:24 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.2174, average loss: 0.7014
[09/28 04:07:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.71	
[09/28 04:07:24 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.03044937175219753
[09/28 04:13:53 visual_prompt]: Epoch 99 / 100: avg data time: 1.06e+01, avg batch time: 11.0928, average train loss: 0.6943
[09/28 04:14:38 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.2292, average loss: 0.6930
[09/28 04:14:38 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.33	
[09/28 04:14:38 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0076146622613029735
[09/28 04:21:06 visual_prompt]: Epoch 100 / 100: avg data time: 1.06e+01, avg batch time: 11.0693, average train loss: 0.6924
[09/28 04:21:51 visual_prompt]: Inference (val):avg data time: 2.11e-05, avg batch time: 0.2345, average loss: 0.6903
[09/28 04:21:51 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.93	
[09/28 04:21:51 visual_prompt]: Rank of current process: 0. World size: 1
[09/28 04:21:51 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              0
GPU 0                NVIDIA A100-PCIE-40GB
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/28 04:21:51 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'mammo-cbis', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/28 04:21:51 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/28 04:21:51 visual_prompt]: Training with config:
[09/28 04:21:51 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/mammo-cbis/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr25.0_wd0.001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 25.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'mammo-cbis', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/28 04:21:51 visual_prompt]: Loading training data...
[09/28 04:21:51 visual_prompt]: Constructing mammo-cbis dataset train...
[09/28 04:21:51 visual_prompt]: Loading validation data...
[09/28 04:21:51 visual_prompt]: Constructing mammo-cbis dataset val...
[09/28 04:21:51 visual_prompt]: Constructing models...
[09/28 04:21:54 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/28 04:21:54 visual_prompt]: tuned percent:0.536
[09/28 04:21:54 visual_prompt]: Device used for model: 0
[09/28 04:21:54 visual_prompt]: Setting up Evaluator...
[09/28 04:21:54 visual_prompt]: Setting up Trainer...
[09/28 04:21:54 visual_prompt]: 	Setting up the optimizer...
[09/28 04:21:54 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/28 04:28:22 visual_prompt]: Epoch 1 / 100: avg data time: 1.06e+01, avg batch time: 11.0917, average train loss: 1.4903
[09/28 04:29:08 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2334, average loss: 1.4710
[09/28 04:29:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.15	
[09/28 04:29:08 visual_prompt]: Best epoch 1: best metric: 0.537
[09/28 04:29:08 visual_prompt]: Training 2 / 100 epoch, with learning rate 2.5
[09/28 04:35:37 visual_prompt]: Epoch 2 / 100: avg data time: 1.06e+01, avg batch time: 11.1081, average train loss: 26.4902
[09/28 04:36:22 visual_prompt]: Inference (val):avg data time: 2.64e-05, avg batch time: 0.2285, average loss: 3.6256
[09/28 04:36:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.30	
[09/28 04:36:22 visual_prompt]: Training 3 / 100 epoch, with learning rate 5.0
[09/28 04:42:51 visual_prompt]: Epoch 3 / 100: avg data time: 1.06e+01, avg batch time: 11.0990, average train loss: 14.6158
[09/28 04:43:36 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2293, average loss: 6.6359
[09/28 04:43:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 48.30	
[09/28 04:43:36 visual_prompt]: Training 4 / 100 epoch, with learning rate 7.5
[09/28 04:50:04 visual_prompt]: Epoch 4 / 100: avg data time: 1.06e+01, avg batch time: 11.0814, average train loss: 14.5256
[09/28 04:50:50 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.2324, average loss: 8.2737
[09/28 04:50:50 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 60.12	
[09/28 04:50:50 visual_prompt]: Training 5 / 100 epoch, with learning rate 10.0
[09/28 04:57:17 visual_prompt]: Epoch 5 / 100: avg data time: 1.06e+01, avg batch time: 11.0572, average train loss: 20.3054
[09/28 04:58:02 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.2351, average loss: 11.6723
[09/28 04:58:02 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 38.80	
[09/28 04:58:02 visual_prompt]: Training 6 / 100 epoch, with learning rate 12.5
[09/28 05:04:32 visual_prompt]: Epoch 6 / 100: avg data time: 1.06e+01, avg batch time: 11.1156, average train loss: 17.1438
[09/28 05:05:17 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2333, average loss: 8.9639
[09/28 05:05:17 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.04	
[09/28 05:05:17 visual_prompt]: Training 7 / 100 epoch, with learning rate 15.0
[09/28 05:11:45 visual_prompt]: Epoch 7 / 100: avg data time: 1.06e+01, avg batch time: 11.0832, average train loss: 37.7634
[09/28 05:12:31 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2183, average loss: 1.6207
[09/28 05:12:31 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.32	
[09/28 05:12:31 visual_prompt]: Training 8 / 100 epoch, with learning rate 17.5
[09/28 05:18:59 visual_prompt]: Epoch 8 / 100: avg data time: 1.06e+01, avg batch time: 11.0864, average train loss: 34.0984
[09/28 05:19:44 visual_prompt]: Inference (val):avg data time: 2.09e-05, avg batch time: 0.2231, average loss: 61.4266
[09/28 05:19:44 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 45.56	
[09/28 05:19:44 visual_prompt]: Training 9 / 100 epoch, with learning rate 20.0
[09/28 05:26:12 visual_prompt]: Epoch 9 / 100: avg data time: 1.06e+01, avg batch time: 11.0823, average train loss: 54.6874
[09/28 05:26:57 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.2305, average loss: 31.5536
[09/28 05:26:57 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.92	
[09/28 05:26:57 visual_prompt]: Training 10 / 100 epoch, with learning rate 22.5
[09/28 05:33:25 visual_prompt]: Epoch 10 / 100: avg data time: 1.06e+01, avg batch time: 11.0703, average train loss: 54.2449
[09/28 05:34:10 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2300, average loss: 37.8211
[09/28 05:34:10 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 46.94	
[09/28 05:34:10 visual_prompt]: Training 11 / 100 epoch, with learning rate 25.0
[09/28 05:40:38 visual_prompt]: Epoch 11 / 100: avg data time: 1.06e+01, avg batch time: 11.0607, average train loss: 36.7045
[09/28 05:41:23 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2332, average loss: 25.5152
[09/28 05:41:23 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.30	
[09/28 05:41:23 visual_prompt]: Training 12 / 100 epoch, with learning rate 24.9923853377387
[09/28 05:47:50 visual_prompt]: Epoch 12 / 100: avg data time: 1.06e+01, avg batch time: 11.0595, average train loss: 32.2897
[09/28 05:48:36 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.2192, average loss: 4.4567
[09/28 05:48:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 61.44	
[09/28 05:48:36 visual_prompt]: Training 13 / 100 epoch, with learning rate 24.969550628247802
[09/28 05:55:03 visual_prompt]: Epoch 13 / 100: avg data time: 1.06e+01, avg batch time: 11.0566, average train loss: 57.6631
[09/28 05:55:48 visual_prompt]: Inference (val):avg data time: 2.09e-05, avg batch time: 0.2199, average loss: 12.7942
[09/28 05:55:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.91	
[09/28 05:55:48 visual_prompt]: Training 14 / 100 epoch, with learning rate 24.931523692103415
[09/28 06:02:15 visual_prompt]: Epoch 14 / 100: avg data time: 1.06e+01, avg batch time: 11.0449, average train loss: 60.8657
[09/28 06:03:00 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2280, average loss: 139.1015
[09/28 06:03:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.39	
[09/28 06:03:00 visual_prompt]: Training 15 / 100 epoch, with learning rate 24.87835085926963
[09/28 06:09:28 visual_prompt]: Epoch 15 / 100: avg data time: 1.06e+01, avg batch time: 11.0698, average train loss: 92.0117
[09/28 06:10:14 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.2415, average loss: 152.1745
[09/28 06:10:14 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.62	
[09/28 06:10:14 visual_prompt]: Training 16 / 100 epoch, with learning rate 24.8100969126526
[09/28 06:16:41 visual_prompt]: Epoch 16 / 100: avg data time: 1.06e+01, avg batch time: 11.0642, average train loss: 45.9598
[09/28 06:17:26 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2326, average loss: 65.5040
[09/28 06:17:26 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.04	
[09/28 06:17:26 visual_prompt]: Training 17 / 100 epoch, with learning rate 24.72684500917257
[09/28 06:23:54 visual_prompt]: Epoch 17 / 100: avg data time: 1.06e+01, avg batch time: 11.0741, average train loss: 67.2476
[09/28 06:24:39 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2266, average loss: 25.7999
[09/28 06:24:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.67	
[09/28 06:24:39 visual_prompt]: Training 18 / 100 epoch, with learning rate 24.628696578449954
[09/28 06:31:07 visual_prompt]: Epoch 18 / 100: avg data time: 1.06e+01, avg batch time: 11.0692, average train loss: 69.5611
[09/28 06:31:52 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2393, average loss: 42.2799
[09/28 06:31:52 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.87	
[09/28 06:31:52 visual_prompt]: Training 19 / 100 epoch, with learning rate 24.515771199228986
[09/28 06:38:21 visual_prompt]: Epoch 19 / 100: avg data time: 1.06e+01, avg batch time: 11.0897, average train loss: 41.6317
[09/28 06:39:06 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.2373, average loss: 80.5330
[09/28 06:39:06 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 60.46	
[09/28 06:39:06 visual_prompt]: Training 20 / 100 epoch, with learning rate 24.38820645368942
[09/28 06:45:34 visual_prompt]: Epoch 20 / 100: avg data time: 1.06e+01, avg batch time: 11.0569, average train loss: 64.7889
[09/28 06:46:19 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.2238, average loss: 98.1249
[09/28 06:46:19 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 39.11	
[09/28 06:46:19 visual_prompt]: Training 21 / 100 epoch, with learning rate 24.246157759823856
[09/28 06:52:46 visual_prompt]: Epoch 21 / 100: avg data time: 1.06e+01, avg batch time: 11.0735, average train loss: 68.9446
[09/28 06:53:32 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2435, average loss: 96.4749
[09/28 06:53:32 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 61.72	
[09/28 06:53:32 visual_prompt]: Training 22 / 100 epoch, with learning rate 24.08979818208484
[09/28 07:00:00 visual_prompt]: Epoch 22 / 100: avg data time: 1.06e+01, avg batch time: 11.0924, average train loss: 64.4839
[09/28 07:00:45 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.2383, average loss: 20.7762
[09/28 07:00:45 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 63.86	
[09/28 07:00:45 visual_prompt]: Training 23 / 100 epoch, with learning rate 23.91931822053251
[09/28 07:07:13 visual_prompt]: Epoch 23 / 100: avg data time: 1.06e+01, avg batch time: 11.0618, average train loss: 33.3317
[09/28 07:07:58 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.2344, average loss: 3.8529
[09/28 07:07:58 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.66	
[09/28 07:07:58 visual_prompt]: Training 24 / 100 epoch, with learning rate 23.73492557873959
[09/28 07:14:27 visual_prompt]: Epoch 24 / 100: avg data time: 1.07e+01, avg batch time: 11.1044, average train loss: 95.6027
[09/28 07:15:12 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2371, average loss: 73.4670
[09/28 07:15:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.13	
[09/28 07:15:12 visual_prompt]: Training 25 / 100 epoch, with learning rate 23.536844910736587
[09/28 07:21:39 visual_prompt]: Epoch 25 / 100: avg data time: 1.06e+01, avg batch time: 11.0391, average train loss: 78.9832
[09/28 07:22:24 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2342, average loss: 32.7024
[09/28 07:22:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.84	
[09/28 07:22:24 visual_prompt]: Training 26 / 100 epoch, with learning rate 23.325317547305485
[09/28 07:28:48 visual_prompt]: Epoch 26 / 100: avg data time: 1.05e+01, avg batch time: 10.9643, average train loss: 41.5082
[09/28 07:29:33 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.2237, average loss: 60.6615
[09/28 07:29:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 46.60	
[09/28 07:29:33 visual_prompt]: Training 27 / 100 epoch, with learning rate 23.100601201955325
[09/28 07:35:57 visual_prompt]: Epoch 27 / 100: avg data time: 1.05e+01, avg batch time: 10.9725, average train loss: 66.2379
[09/28 07:36:42 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.2299, average loss: 0.9192
[09/28 07:36:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 48.79	
[09/28 07:36:42 visual_prompt]: Training 28 / 100 epoch, with learning rate 22.86296965693802
[09/28 07:43:06 visual_prompt]: Epoch 28 / 100: avg data time: 1.05e+01, avg batch time: 10.9642, average train loss: 51.4595
[09/28 07:43:51 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.2316, average loss: 131.0959
[09/28 07:43:51 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.77	
[09/28 07:43:51 visual_prompt]: Training 29 / 100 epoch, with learning rate 22.612712429686844
[09/28 07:50:16 visual_prompt]: Epoch 29 / 100: avg data time: 1.05e+01, avg batch time: 10.9819, average train loss: 60.3795
[09/28 07:51:00 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2240, average loss: 60.3936
[09/28 07:51:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.57	
[09/28 07:51:00 visual_prompt]: Training 30 / 100 epoch, with learning rate 22.35013442008402
[09/28 07:57:25 visual_prompt]: Epoch 30 / 100: avg data time: 1.05e+01, avg batch time: 10.9715, average train loss: 37.7961
[09/28 07:58:10 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.2326, average loss: 60.5709
[09/28 07:58:10 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 40.86	
[09/28 07:58:10 visual_prompt]: Training 31 / 100 epoch, with learning rate 22.075555538987224
[09/28 08:04:32 visual_prompt]: Epoch 31 / 100: avg data time: 1.05e+01, avg batch time: 10.9227, average train loss: 58.8519
[09/28 08:05:17 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2330, average loss: 42.2882
[09/28 08:05:17 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 46.21	
[09/28 08:05:17 visual_prompt]: Training 32 / 100 epoch, with learning rate 21.78931031846743
[09/28 08:11:41 visual_prompt]: Epoch 32 / 100: avg data time: 1.05e+01, avg batch time: 10.9698, average train loss: 32.5981
[09/28 08:12:26 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2273, average loss: 37.4177
[09/28 08:12:26 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.12	
[09/28 08:12:26 visual_prompt]: Training 33 / 100 epoch, with learning rate 21.49174750423314
[09/28 08:18:49 visual_prompt]: Epoch 33 / 100: avg data time: 1.05e+01, avg batch time: 10.9410, average train loss: 65.1412
[09/28 08:19:34 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2272, average loss: 10.5540
[09/28 08:19:34 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 49.92	
[09/28 08:19:34 visual_prompt]: Training 34 / 100 epoch, with learning rate 21.183229630737465
[09/28 08:25:59 visual_prompt]: Epoch 34 / 100: avg data time: 1.06e+01, avg batch time: 11.0037, average train loss: 36.9392
[09/28 08:26:44 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.2328, average loss: 80.1472
[09/28 08:26:44 visual_prompt]: Classification results with val_mammo-cbis: top1: 51.22	rocauc: 47.49	
[09/28 08:26:44 visual_prompt]: Training 35 / 100 epoch, with learning rate 20.864132579485727
[09/28 08:33:08 visual_prompt]: Epoch 35 / 100: avg data time: 1.05e+01, avg batch time: 10.9582, average train loss: 47.1630
[09/28 08:33:53 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.2403, average loss: 40.2591
[09/28 08:33:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.86	
[09/28 08:33:53 visual_prompt]: Training 36 / 100 epoch, with learning rate 20.53484512108174
[09/28 08:40:16 visual_prompt]: Epoch 36 / 100: avg data time: 1.05e+01, avg batch time: 10.9364, average train loss: 38.8050
[09/28 08:41:01 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.2323, average loss: 28.4418
[09/28 08:41:01 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 62.20	
[09/28 08:41:01 visual_prompt]: Training 37 / 100 epoch, with learning rate 20.195768441570728
[09/28 08:47:24 visual_prompt]: Epoch 37 / 100: avg data time: 1.05e+01, avg batch time: 10.9324, average train loss: 32.9102
[09/28 08:48:09 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2332, average loss: 28.1268
[09/28 08:48:09 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.12	
[09/28 08:48:09 visual_prompt]: Training 38 / 100 epoch, with learning rate 19.847315653655915
[09/28 08:54:33 visual_prompt]: Epoch 38 / 100: avg data time: 1.05e+01, avg batch time: 10.9732, average train loss: 32.1416
[09/28 08:55:18 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2424, average loss: 104.5330
[09/28 08:55:18 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.38	
[09/28 08:55:18 visual_prompt]: Training 39 / 100 epoch, with learning rate 19.489911293384335
[09/28 09:01:43 visual_prompt]: Epoch 39 / 100: avg data time: 1.05e+01, avg batch time: 10.9860, average train loss: 42.3813
[09/28 09:02:28 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.2359, average loss: 41.6042
[09/28 09:02:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 61.26	
[09/28 09:02:28 visual_prompt]: Training 40 / 100 epoch, with learning rate 19.12399080291506
[09/28 09:08:52 visual_prompt]: Epoch 40 / 100: avg data time: 1.05e+01, avg batch time: 10.9663, average train loss: 29.9099
[09/28 09:09:37 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2391, average loss: 86.4886
[09/28 09:09:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.08	
[09/28 09:09:37 visual_prompt]: Training 41 / 100 epoch, with learning rate 18.75
[09/28 09:16:01 visual_prompt]: Epoch 41 / 100: avg data time: 1.05e+01, avg batch time: 10.9650, average train loss: 45.7042
[09/28 09:16:46 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2369, average loss: 36.8589
[09/28 09:16:46 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.14	
[09/28 09:16:46 visual_prompt]: Training 42 / 100 epoch, with learning rate 18.368394534823633
[09/28 09:23:11 visual_prompt]: Epoch 42 / 100: avg data time: 1.05e+01, avg batch time: 10.9800, average train loss: 28.2795
[09/28 09:23:56 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.2379, average loss: 37.4876
[09/28 09:23:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 43.15	
[09/28 09:23:56 visual_prompt]: Training 43 / 100 epoch, with learning rate 17.979639334863467
[09/28 09:30:18 visual_prompt]: Epoch 43 / 100: avg data time: 1.05e+01, avg batch time: 10.9328, average train loss: 38.7569
[09/28 09:31:04 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2439, average loss: 8.2856
[09/28 09:31:04 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.45	
[09/28 09:31:04 visual_prompt]: Training 44 / 100 epoch, with learning rate 17.584208038447503
[09/28 09:37:28 visual_prompt]: Epoch 44 / 100: avg data time: 1.05e+01, avg batch time: 10.9641, average train loss: 35.5320
[09/28 09:38:13 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2402, average loss: 27.7572
[09/28 09:38:13 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 58.83	
[09/28 09:38:13 visual_prompt]: Training 45 / 100 epoch, with learning rate 17.182582417698903
[09/28 09:44:37 visual_prompt]: Epoch 45 / 100: avg data time: 1.05e+01, avg batch time: 10.9746, average train loss: 39.2853
[09/28 09:45:22 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.2277, average loss: 61.6718
[09/28 09:45:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 40.22	
[09/28 09:45:22 visual_prompt]: Training 46 / 100 epoch, with learning rate 16.77525179157086
[09/28 09:51:46 visual_prompt]: Epoch 46 / 100: avg data time: 1.05e+01, avg batch time: 10.9679, average train loss: 28.1727
[09/28 09:52:31 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2219, average loss: 2.4907
[09/28 09:52:31 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.36	
[09/28 09:52:31 visual_prompt]: Training 47 / 100 epoch, with learning rate 16.362712429686844
[09/28 09:58:54 visual_prompt]: Epoch 47 / 100: avg data time: 1.05e+01, avg batch time: 10.9329, average train loss: 37.5517
[09/28 09:59:39 visual_prompt]: Inference (val):avg data time: 2.10e-05, avg batch time: 0.2397, average loss: 52.6498
[09/28 09:59:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.03	
[09/28 09:59:39 visual_prompt]: Training 48 / 100 epoch, with learning rate 15.94546694771249
[09/28 10:06:02 visual_prompt]: Epoch 48 / 100: avg data time: 1.05e+01, avg batch time: 10.9501, average train loss: 31.3626
[09/28 10:06:47 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.2261, average loss: 18.1691
[09/28 10:06:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.29	
[09/28 10:06:47 visual_prompt]: Training 49 / 100 epoch, with learning rate 15.524023694995845
[09/28 10:13:11 visual_prompt]: Epoch 49 / 100: avg data time: 1.05e+01, avg batch time: 10.9751, average train loss: 32.8950
[09/28 10:13:56 visual_prompt]: Inference (val):avg data time: 2.09e-05, avg batch time: 0.2352, average loss: 86.9635
[09/28 10:13:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 45.04	
[09/28 10:13:56 visual_prompt]: Training 50 / 100 epoch, with learning rate 15.09889613522199
[09/28 10:20:20 visual_prompt]: Epoch 50 / 100: avg data time: 1.05e+01, avg batch time: 10.9496, average train loss: 51.4201
[09/28 10:21:04 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2081, average loss: 42.6935
[09/28 10:21:04 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 45.82	
[09/28 10:21:04 visual_prompt]: Training 51 / 100 epoch, with learning rate 14.670602220836631
[09/28 10:27:27 visual_prompt]: Epoch 51 / 100: avg data time: 1.05e+01, avg batch time: 10.9254, average train loss: 30.7568
[09/28 10:28:12 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2323, average loss: 5.4152
[09/28 10:28:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.31	
[09/28 10:28:12 visual_prompt]: Training 52 / 100 epoch, with learning rate 14.239663762000818
[09/28 10:34:35 visual_prompt]: Epoch 52 / 100: avg data time: 1.05e+01, avg batch time: 10.9361, average train loss: 55.5000
[09/28 10:35:20 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2243, average loss: 25.2965
[09/28 10:35:20 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 46.43	
[09/28 10:35:20 visual_prompt]: Training 53 / 100 epoch, with learning rate 13.80660579084567
[09/28 10:41:44 visual_prompt]: Epoch 53 / 100: avg data time: 1.05e+01, avg batch time: 10.9727, average train loss: 20.1985
[09/28 10:42:29 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2262, average loss: 32.8283
[09/28 10:42:29 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 48.33	
[09/28 10:42:29 visual_prompt]: Training 54 / 100 epoch, with learning rate 13.371955921801565
[09/28 10:48:53 visual_prompt]: Epoch 54 / 100: avg data time: 1.05e+01, avg batch time: 10.9556, average train loss: 31.6233
[09/28 10:49:37 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.2383, average loss: 75.0302
[09/28 10:49:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.31	
[09/28 10:49:37 visual_prompt]: Training 55 / 100 epoch, with learning rate 12.936243708781264
[09/28 10:56:01 visual_prompt]: Epoch 55 / 100: avg data time: 1.05e+01, avg batch time: 10.9645, average train loss: 30.7982
[09/28 10:56:46 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.2226, average loss: 76.9850
[09/28 10:56:46 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 46.98	
[09/28 10:56:46 visual_prompt]: Training 56 / 100 epoch, with learning rate 12.5
[09/28 11:03:09 visual_prompt]: Epoch 56 / 100: avg data time: 1.05e+01, avg batch time: 10.9225, average train loss: 20.3496
[09/28 11:03:54 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2331, average loss: 12.2918
[09/28 11:03:54 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 43.61	
[09/28 11:03:54 visual_prompt]: Training 57 / 100 epoch, with learning rate 12.063756291218741
[09/28 11:10:17 visual_prompt]: Epoch 57 / 100: avg data time: 1.05e+01, avg batch time: 10.9378, average train loss: 20.3034
[09/28 11:11:01 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.2348, average loss: 40.2645
[09/28 11:11:01 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 40.28	
[09/28 11:11:01 visual_prompt]: Training 58 / 100 epoch, with learning rate 11.628044078198434
[09/28 11:17:25 visual_prompt]: Epoch 58 / 100: avg data time: 1.05e+01, avg batch time: 10.9656, average train loss: 30.3101
[09/28 11:18:10 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2219, average loss: 6.3534
[09/28 11:18:10 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 43.11	
[09/28 11:18:10 visual_prompt]: Training 59 / 100 epoch, with learning rate 11.193394209154334
[09/28 11:24:34 visual_prompt]: Epoch 59 / 100: avg data time: 1.05e+01, avg batch time: 10.9598, average train loss: 19.9859
[09/28 11:25:19 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.2321, average loss: 57.3697
[09/28 11:25:19 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 47.80	
[09/28 11:25:19 visual_prompt]: Training 60 / 100 epoch, with learning rate 10.760336237999185
[09/28 11:31:44 visual_prompt]: Epoch 60 / 100: avg data time: 1.05e+01, avg batch time: 10.9869, average train loss: 21.4225
[09/28 11:32:29 visual_prompt]: Inference (val):avg data time: 2.70e-05, avg batch time: 0.2308, average loss: 3.5999
[09/28 11:32:29 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.66	
[09/28 11:32:29 visual_prompt]: Training 61 / 100 epoch, with learning rate 10.32939777916337
[09/28 11:38:54 visual_prompt]: Epoch 61 / 100: avg data time: 1.05e+01, avg batch time: 10.9954, average train loss: 24.5704
[09/28 11:39:39 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2353, average loss: 25.8480
[09/28 11:39:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 59.89	
[09/28 11:39:39 visual_prompt]: Training 62 / 100 epoch, with learning rate 9.90110386477801
[09/28 11:46:03 visual_prompt]: Epoch 62 / 100: avg data time: 1.05e+01, avg batch time: 10.9712, average train loss: 15.7679
[09/28 11:46:48 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2275, average loss: 25.1784
[09/28 11:46:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 63.90	
[09/28 11:46:48 visual_prompt]: Training 63 / 100 epoch, with learning rate 9.475976305004155
[09/28 11:53:12 visual_prompt]: Epoch 63 / 100: avg data time: 1.05e+01, avg batch time: 10.9657, average train loss: 16.7826
[09/28 11:53:57 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2274, average loss: 43.7900
[09/28 11:53:57 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.20	
[09/28 11:53:57 visual_prompt]: Training 64 / 100 epoch, with learning rate 9.05453305228751
[09/28 12:00:19 visual_prompt]: Epoch 64 / 100: avg data time: 1.05e+01, avg batch time: 10.9083, average train loss: 17.6857
[09/28 12:01:04 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2367, average loss: 10.0030
[09/28 12:01:04 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 43.82	
[09/28 12:01:04 visual_prompt]: Training 65 / 100 epoch, with learning rate 8.637287570313159
[09/28 12:07:30 visual_prompt]: Epoch 65 / 100: avg data time: 1.05e+01, avg batch time: 11.0179, average train loss: 12.6490
[09/28 12:08:15 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.2409, average loss: 6.0902
[09/28 12:08:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 43.84	
[09/28 12:08:15 visual_prompt]: Training 66 / 100 epoch, with learning rate 8.224748208429142
[09/28 12:14:39 visual_prompt]: Epoch 66 / 100: avg data time: 1.05e+01, avg batch time: 10.9750, average train loss: 18.0443
[09/28 12:15:24 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2293, average loss: 4.8542
[09/28 12:15:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.97	
[09/28 12:15:24 visual_prompt]: Training 67 / 100 epoch, with learning rate 7.817417582301099
[09/28 12:21:47 visual_prompt]: Epoch 67 / 100: avg data time: 1.05e+01, avg batch time: 10.9265, average train loss: 33.8394
[09/28 12:22:31 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2227, average loss: 10.8701
[09/28 12:22:31 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.95	
[09/28 12:22:31 visual_prompt]: Training 68 / 100 epoch, with learning rate 7.415791961552499
[09/28 12:28:54 visual_prompt]: Epoch 68 / 100: avg data time: 1.05e+01, avg batch time: 10.9264, average train loss: 16.5237
[09/28 12:29:39 visual_prompt]: Inference (val):avg data time: 2.11e-05, avg batch time: 0.2228, average loss: 1.3820
[09/28 12:29:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 59.99	
[09/28 12:29:39 visual_prompt]: Training 69 / 100 epoch, with learning rate 7.020360665136531
[09/28 12:36:01 visual_prompt]: Epoch 69 / 100: avg data time: 1.04e+01, avg batch time: 10.9176, average train loss: 9.3752
[09/28 12:36:46 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.2243, average loss: 18.0417
[09/28 12:36:46 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.06	
[09/28 12:36:46 visual_prompt]: Training 70 / 100 epoch, with learning rate 6.631605465176368
[09/28 12:43:08 visual_prompt]: Epoch 70 / 100: avg data time: 1.05e+01, avg batch time: 10.9252, average train loss: 12.2984
[09/28 12:43:53 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.2226, average loss: 49.4863
[09/28 12:43:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.78	
[09/28 12:43:53 visual_prompt]: Training 71 / 100 epoch, with learning rate 6.250000000000003
[09/28 12:50:16 visual_prompt]: Epoch 71 / 100: avg data time: 1.05e+01, avg batch time: 10.9502, average train loss: 17.0183
[09/28 12:51:01 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2336, average loss: 3.4405
[09/28 12:51:01 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 38.51	
[09/28 12:51:01 visual_prompt]: Training 72 / 100 epoch, with learning rate 5.87600919708494
[09/28 12:57:24 visual_prompt]: Epoch 72 / 100: avg data time: 1.05e+01, avg batch time: 10.9378, average train loss: 9.1792
[09/28 12:58:09 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.2389, average loss: 7.6551
[09/28 12:58:09 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 41.43	
[09/28 12:58:09 visual_prompt]: Training 73 / 100 epoch, with learning rate 5.510088706615666
[09/28 13:04:33 visual_prompt]: Epoch 73 / 100: avg data time: 1.05e+01, avg batch time: 10.9412, average train loss: 9.0454
[09/28 13:05:17 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.2299, average loss: 0.7278
[09/28 13:05:17 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.83	
[09/28 13:05:17 visual_prompt]: Training 74 / 100 epoch, with learning rate 5.1526843463440875
[09/28 13:11:41 visual_prompt]: Epoch 74 / 100: avg data time: 1.05e+01, avg batch time: 10.9574, average train loss: 5.5801
[09/28 13:12:26 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2447, average loss: 0.9175
[09/28 13:12:26 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 38.38	
[09/28 13:12:26 visual_prompt]: Training 75 / 100 epoch, with learning rate 4.804231558429271
[09/28 13:18:50 visual_prompt]: Epoch 75 / 100: avg data time: 1.05e+01, avg batch time: 10.9652, average train loss: 6.5348
[09/28 13:19:35 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.2333, average loss: 3.8497
[09/28 13:19:35 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.19	
[09/28 13:19:35 visual_prompt]: Training 76 / 100 epoch, with learning rate 4.465154878918258
[09/28 13:25:57 visual_prompt]: Epoch 76 / 100: avg data time: 1.04e+01, avg batch time: 10.9155, average train loss: 5.2247
[09/28 13:26:42 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2264, average loss: 2.9103
[09/28 13:26:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 60.26	
[09/28 13:26:42 visual_prompt]: Training 77 / 100 epoch, with learning rate 4.135867420514276
[09/28 13:33:04 visual_prompt]: Epoch 77 / 100: avg data time: 1.05e+01, avg batch time: 10.9203, average train loss: 8.6305
[09/28 13:33:49 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.2415, average loss: 1.8687
[09/28 13:33:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 59.26	
[09/28 13:33:49 visual_prompt]: Training 78 / 100 epoch, with learning rate 3.816770369262533
[09/28 13:40:10 visual_prompt]: Epoch 78 / 100: avg data time: 1.04e+01, avg batch time: 10.8850, average train loss: 16.6603
[09/28 13:40:55 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.2344, average loss: 21.0226
[09/28 13:40:55 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 61.99	
[09/28 13:40:55 visual_prompt]: Training 79 / 100 epoch, with learning rate 3.508252495766863
[09/28 13:47:16 visual_prompt]: Epoch 79 / 100: avg data time: 1.04e+01, avg batch time: 10.8787, average train loss: 6.7941
[09/28 13:48:00 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.2252, average loss: 2.6094
[09/28 13:48:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.29	
[09/28 13:48:00 visual_prompt]: Training 80 / 100 epoch, with learning rate 3.2106896815325707
[09/28 13:54:24 visual_prompt]: Epoch 80 / 100: avg data time: 1.05e+01, avg batch time: 10.9601, average train loss: 2.7914
[09/28 13:55:09 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2373, average loss: 10.0034
[09/28 13:55:09 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.39	
[09/28 13:55:09 visual_prompt]: Training 81 / 100 epoch, with learning rate 2.924444461012776
[09/28 14:01:33 visual_prompt]: Epoch 81 / 100: avg data time: 1.05e+01, avg batch time: 10.9547, average train loss: 5.1447
[09/28 14:02:18 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2345, average loss: 3.9934
[09/28 14:02:18 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 40.18	
[09/28 14:02:18 visual_prompt]: Training 82 / 100 epoch, with learning rate 2.6498655799159763
[09/28 14:08:39 visual_prompt]: Epoch 82 / 100: avg data time: 1.04e+01, avg batch time: 10.8883, average train loss: 1.8822
[09/28 14:09:23 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2369, average loss: 1.6359
[09/28 14:09:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 46.18	
[09/28 14:09:24 visual_prompt]: Training 83 / 100 epoch, with learning rate 2.387287570313158
[09/28 14:15:45 visual_prompt]: Epoch 83 / 100: avg data time: 1.04e+01, avg batch time: 10.9028, average train loss: 1.2789
[09/28 14:16:30 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2336, average loss: 1.6070
[09/28 14:16:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 66.77	
[09/28 14:16:30 visual_prompt]: Training 84 / 100 epoch, with learning rate 2.13703034306198
[09/28 14:22:55 visual_prompt]: Epoch 84 / 100: avg data time: 1.06e+01, avg batch time: 11.0005, average train loss: 1.8936
[09/28 14:23:41 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.2307, average loss: 1.5953
[09/28 14:23:41 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.90	
[09/28 14:23:41 visual_prompt]: Training 85 / 100 epoch, with learning rate 1.8993987980446756
[09/28 14:30:06 visual_prompt]: Epoch 85 / 100: avg data time: 1.06e+01, avg batch time: 11.0114, average train loss: 1.2527
[09/28 14:30:51 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.2196, average loss: 1.6265
[09/28 14:30:51 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.58	
[09/28 14:30:51 visual_prompt]: Training 86 / 100 epoch, with learning rate 1.674682452694516
[09/28 14:37:18 visual_prompt]: Epoch 86 / 100: avg data time: 1.06e+01, avg batch time: 11.0293, average train loss: 0.8053
[09/28 14:38:03 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2247, average loss: 0.6922
[09/28 14:38:03 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.34	
[09/28 14:38:03 visual_prompt]: Training 87 / 100 epoch, with learning rate 1.4631550892634126
[09/28 14:44:28 visual_prompt]: Epoch 87 / 100: avg data time: 1.05e+01, avg batch time: 11.0083, average train loss: 0.7372
[09/28 14:45:13 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.2318, average loss: 0.6930
[09/28 14:45:13 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.12	
[09/28 14:45:13 visual_prompt]: Training 88 / 100 epoch, with learning rate 1.2650744212604148
[09/28 14:51:38 visual_prompt]: Epoch 88 / 100: avg data time: 1.05e+01, avg batch time: 10.9752, average train loss: 0.7161
[09/28 14:52:23 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.2246, average loss: 0.6976
[09/28 14:52:23 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.81	
[09/28 14:52:23 visual_prompt]: Training 89 / 100 epoch, with learning rate 1.0806817794674877
[09/28 14:58:50 visual_prompt]: Epoch 89 / 100: avg data time: 1.06e+01, avg batch time: 11.0611, average train loss: 0.7309
[09/28 14:59:35 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2305, average loss: 0.7241
[09/28 14:59:35 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 61.89	
[09/28 14:59:35 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.9102018179151585
[09/28 15:06:02 visual_prompt]: Epoch 90 / 100: avg data time: 1.06e+01, avg batch time: 11.0399, average train loss: 0.7296
[09/28 15:06:47 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2243, average loss: 0.7216
[09/28 15:06:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.16	
[09/28 15:06:47 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.753842240176146
[09/28 15:13:14 visual_prompt]: Epoch 91 / 100: avg data time: 1.06e+01, avg batch time: 11.0469, average train loss: 0.6972
[09/28 15:13:59 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.2285, average loss: 0.6895
[09/28 15:13:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.10	rocauc: 55.01	
[09/28 15:13:59 visual_prompt]: Best epoch 91: best metric: 0.561
[09/28 15:13:59 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.6117935463105808
[09/28 15:20:27 visual_prompt]: Epoch 92 / 100: avg data time: 1.06e+01, avg batch time: 11.0766, average train loss: 0.7087
[09/28 15:21:12 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.2359, average loss: 0.7553
[09/28 15:21:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.09	
[09/28 15:21:12 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.4842288007710138
[09/28 15:27:39 visual_prompt]: Epoch 93 / 100: avg data time: 1.06e+01, avg batch time: 11.0523, average train loss: 0.7106
[09/28 15:28:24 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.2228, average loss: 0.6949
[09/28 15:28:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.72	
[09/28 15:28:24 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.3713034215500441
[09/28 15:34:51 visual_prompt]: Epoch 94 / 100: avg data time: 1.06e+01, avg batch time: 11.0296, average train loss: 0.6965
[09/28 15:35:36 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.2361, average loss: 0.6934
[09/28 15:35:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.38	
[09/28 15:35:36 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.2731549908274289
[09/28 15:42:01 visual_prompt]: Epoch 95 / 100: avg data time: 1.06e+01, avg batch time: 11.0104, average train loss: 0.6985
[09/28 15:42:47 visual_prompt]: Inference (val):avg data time: 2.10e-05, avg batch time: 0.2420, average loss: 0.6987
[09/28 15:42:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.74	
[09/28 15:42:47 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.18990308734739975
[09/28 15:49:14 visual_prompt]: Epoch 96 / 100: avg data time: 1.06e+01, avg batch time: 11.0682, average train loss: 0.6920
[09/28 15:50:00 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2223, average loss: 0.6896
[09/28 15:50:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.76	
[09/28 15:50:00 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.12164914073037048
[09/28 15:56:27 visual_prompt]: Epoch 97 / 100: avg data time: 1.06e+01, avg batch time: 11.0485, average train loss: 0.6928
[09/28 15:57:12 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.2327, average loss: 0.7008
[09/28 15:57:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.82	
[09/28 15:57:12 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.06847630789658388
[09/28 16:03:39 visual_prompt]: Epoch 98 / 100: avg data time: 1.06e+01, avg batch time: 11.0622, average train loss: 0.6919
[09/28 16:04:24 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.2225, average loss: 0.6921
[09/28 16:04:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.61	
[09/28 16:04:24 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.03044937175219753
[09/28 16:10:52 visual_prompt]: Epoch 99 / 100: avg data time: 1.06e+01, avg batch time: 11.0629, average train loss: 0.6862
[09/28 16:11:37 visual_prompt]: Inference (val):avg data time: 2.17e-05, avg batch time: 0.2267, average loss: 0.6891
[09/28 16:11:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.28	rocauc: 56.66	
[09/28 16:11:37 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0076146622613029735
[09/28 16:18:04 visual_prompt]: Epoch 100 / 100: avg data time: 1.06e+01, avg batch time: 11.0617, average train loss: 0.6858
[09/28 16:18:50 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2303, average loss: 0.6839
[09/28 16:18:50 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.50	rocauc: 56.27	
[09/28 16:18:50 visual_prompt]: Best epoch 100: best metric: 0.565
[09/28 16:18:50 visual_prompt]: Rank of current process: 0. World size: 1
[09/28 16:18:50 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              0
GPU 0                NVIDIA A100-PCIE-40GB
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/28 16:18:50 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'mammo-cbis', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/28 16:18:50 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/28 16:18:50 visual_prompt]: Training with config:
[09/28 16:18:50 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/mammo-cbis/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr25.0_wd0.0001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 25.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'mammo-cbis', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/28 16:18:50 visual_prompt]: Loading training data...
[09/28 16:18:50 visual_prompt]: Constructing mammo-cbis dataset train...
[09/28 16:18:50 visual_prompt]: Loading validation data...
[09/28 16:18:50 visual_prompt]: Constructing mammo-cbis dataset val...
[09/28 16:18:50 visual_prompt]: Constructing models...
[09/28 16:18:52 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/28 16:18:52 visual_prompt]: tuned percent:0.536
[09/28 16:18:52 visual_prompt]: Device used for model: 0
[09/28 16:18:52 visual_prompt]: Setting up Evaluator...
[09/28 16:18:52 visual_prompt]: Setting up Trainer...
[09/28 16:18:52 visual_prompt]: 	Setting up the optimizer...
[09/28 16:18:52 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/28 16:25:22 visual_prompt]: Epoch 1 / 100: avg data time: 1.07e+01, avg batch time: 11.1195, average train loss: 1.4903
[09/28 16:26:07 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.2317, average loss: 1.4710
[09/28 16:26:07 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.15	
[09/28 16:26:07 visual_prompt]: Best epoch 1: best metric: 0.537
[09/28 16:26:07 visual_prompt]: Training 2 / 100 epoch, with learning rate 2.5
[09/28 16:32:37 visual_prompt]: Epoch 2 / 100: avg data time: 1.07e+01, avg batch time: 11.1317, average train loss: 21.8292
[09/28 16:33:23 visual_prompt]: Inference (val):avg data time: 2.08e-05, avg batch time: 0.2347, average loss: 2.9823
[09/28 16:33:23 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.39	
[09/28 16:33:23 visual_prompt]: Training 3 / 100 epoch, with learning rate 5.0
[09/28 16:39:49 visual_prompt]: Epoch 3 / 100: avg data time: 1.06e+01, avg batch time: 11.0216, average train loss: 8.2858
[09/28 16:40:33 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.2396, average loss: 0.7691
[09/28 16:40:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 52.44	rocauc: 59.46	
[09/28 16:40:33 visual_prompt]: Training 4 / 100 epoch, with learning rate 7.5
[09/28 16:46:55 visual_prompt]: Epoch 4 / 100: avg data time: 1.04e+01, avg batch time: 10.9045, average train loss: 20.2865
[09/28 16:47:40 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2311, average loss: 44.7829
[09/28 16:47:40 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 60.98	
[09/28 16:47:40 visual_prompt]: Training 5 / 100 epoch, with learning rate 10.0
[09/28 16:54:03 visual_prompt]: Epoch 5 / 100: avg data time: 1.05e+01, avg batch time: 10.9256, average train loss: 18.3514
[09/28 16:54:48 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2376, average loss: 23.6626
[09/28 16:54:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.47	rocauc: 56.22	
[09/28 16:54:48 visual_prompt]: Best epoch 5: best metric: 0.545
[09/28 16:54:48 visual_prompt]: Training 6 / 100 epoch, with learning rate 12.5
[09/28 17:01:13 visual_prompt]: Epoch 6 / 100: avg data time: 1.05e+01, avg batch time: 11.0058, average train loss: 22.5027
[09/28 17:01:58 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2451, average loss: 6.1524
[09/28 17:01:58 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.42	
[09/28 17:01:58 visual_prompt]: Training 7 / 100 epoch, with learning rate 15.0
[09/28 17:08:25 visual_prompt]: Epoch 7 / 100: avg data time: 1.06e+01, avg batch time: 11.0521, average train loss: 16.3515
[09/28 17:09:10 visual_prompt]: Inference (val):avg data time: 2.23e-05, avg batch time: 0.2520, average loss: 21.2174
[09/28 17:09:10 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 41.60	
[09/28 17:09:10 visual_prompt]: Training 8 / 100 epoch, with learning rate 17.5
[09/28 17:15:37 visual_prompt]: Epoch 8 / 100: avg data time: 1.06e+01, avg batch time: 11.0357, average train loss: 28.7747
[09/28 17:16:22 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2375, average loss: 27.2695
[09/28 17:16:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.64	
[09/28 17:16:22 visual_prompt]: Training 9 / 100 epoch, with learning rate 20.0
[09/28 17:22:48 visual_prompt]: Epoch 9 / 100: avg data time: 1.05e+01, avg batch time: 11.0272, average train loss: 30.0505
[09/28 17:23:33 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.2102, average loss: 46.0567
[09/28 17:23:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.59	
[09/28 17:23:33 visual_prompt]: Training 10 / 100 epoch, with learning rate 22.5
[09/28 17:30:01 visual_prompt]: Epoch 10 / 100: avg data time: 1.06e+01, avg batch time: 11.0714, average train loss: 47.5868
[09/28 17:30:46 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2128, average loss: 43.0014
[09/28 17:30:46 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.35	
[09/28 17:30:46 visual_prompt]: Training 11 / 100 epoch, with learning rate 25.0
[09/28 17:37:13 visual_prompt]: Epoch 11 / 100: avg data time: 1.06e+01, avg batch time: 11.0529, average train loss: 48.7699
[09/28 17:37:58 visual_prompt]: Inference (val):avg data time: 1.88e-05, avg batch time: 0.2309, average loss: 106.0011
[09/28 17:37:58 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 63.35	
[09/28 17:37:58 visual_prompt]: Training 12 / 100 epoch, with learning rate 24.9923853377387
[09/28 17:44:24 visual_prompt]: Epoch 12 / 100: avg data time: 1.06e+01, avg batch time: 11.0107, average train loss: 79.4407
[09/28 17:45:09 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2061, average loss: 165.1922
[09/28 17:45:09 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 41.36	
[09/28 17:45:09 visual_prompt]: Training 13 / 100 epoch, with learning rate 24.969550628247802
[09/28 17:51:36 visual_prompt]: Epoch 13 / 100: avg data time: 1.06e+01, avg batch time: 11.0579, average train loss: 52.7392
[09/28 17:52:21 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1902, average loss: 23.4932
[09/28 17:52:21 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.60	
[09/28 17:52:21 visual_prompt]: Training 14 / 100 epoch, with learning rate 24.931523692103415
[09/28 17:58:48 visual_prompt]: Epoch 14 / 100: avg data time: 1.06e+01, avg batch time: 11.0407, average train loss: 32.9662
[09/28 17:59:33 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.2248, average loss: 20.2801
[09/28 17:59:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 46.48	
[09/28 17:59:33 visual_prompt]: Training 15 / 100 epoch, with learning rate 24.87835085926963
[09/28 18:06:00 visual_prompt]: Epoch 15 / 100: avg data time: 1.06e+01, avg batch time: 11.0578, average train loss: 20.7590
[09/28 18:06:45 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2172, average loss: 20.9428
[09/28 18:06:45 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 40.65	
[09/28 18:06:45 visual_prompt]: Training 16 / 100 epoch, with learning rate 24.8100969126526
[09/28 18:13:13 visual_prompt]: Epoch 16 / 100: avg data time: 1.06e+01, avg batch time: 11.0808, average train loss: 35.0746
[09/28 18:13:58 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1939, average loss: 49.2768
[09/28 18:13:58 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.43	
[09/28 18:13:58 visual_prompt]: Training 17 / 100 epoch, with learning rate 24.72684500917257
[09/28 18:20:23 visual_prompt]: Epoch 17 / 100: avg data time: 1.05e+01, avg batch time: 10.9722, average train loss: 31.0721
[09/28 18:21:08 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.2741, average loss: 14.0693
[09/28 18:21:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.37	
[09/28 18:21:08 visual_prompt]: Training 18 / 100 epoch, with learning rate 24.628696578449954
[09/28 18:27:35 visual_prompt]: Epoch 18 / 100: avg data time: 1.06e+01, avg batch time: 11.0388, average train loss: 30.2678
[09/28 18:28:19 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.1908, average loss: 26.6637
[09/28 18:28:19 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.18	
[09/28 18:28:19 visual_prompt]: Training 19 / 100 epoch, with learning rate 24.515771199228986
[09/28 18:34:45 visual_prompt]: Epoch 19 / 100: avg data time: 1.05e+01, avg batch time: 11.0061, average train loss: 25.4649
[09/28 18:35:30 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1901, average loss: 19.2666
[09/28 18:35:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.28	
[09/28 18:35:30 visual_prompt]: Training 20 / 100 epoch, with learning rate 24.38820645368942
[09/28 18:41:54 visual_prompt]: Epoch 20 / 100: avg data time: 1.05e+01, avg batch time: 10.9797, average train loss: 28.3949
[09/28 18:42:39 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2143, average loss: 27.8740
[09/28 18:42:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.87	
[09/28 18:42:39 visual_prompt]: Training 21 / 100 epoch, with learning rate 24.246157759823856
[09/28 18:49:08 visual_prompt]: Epoch 21 / 100: avg data time: 1.06e+01, avg batch time: 11.0866, average train loss: 33.5847
[09/28 18:49:53 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2323, average loss: 61.6208
[09/28 18:49:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 59.61	
[09/28 18:49:53 visual_prompt]: Training 22 / 100 epoch, with learning rate 24.08979818208484
[09/28 18:56:19 visual_prompt]: Epoch 22 / 100: avg data time: 1.05e+01, avg batch time: 11.0144, average train loss: 38.6838
[09/28 18:57:04 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2173, average loss: 49.6465
[09/28 18:57:04 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 39.35	
[09/28 18:57:04 visual_prompt]: Training 23 / 100 epoch, with learning rate 23.91931822053251
[09/28 19:03:30 visual_prompt]: Epoch 23 / 100: avg data time: 1.06e+01, avg batch time: 11.0257, average train loss: 34.5828
[09/28 19:04:15 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.2075, average loss: 36.8600
[09/28 19:04:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.98	
[09/28 19:04:15 visual_prompt]: Training 24 / 100 epoch, with learning rate 23.73492557873959
[09/28 19:10:40 visual_prompt]: Epoch 24 / 100: avg data time: 1.05e+01, avg batch time: 10.9983, average train loss: 31.7910
[09/28 19:11:25 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2731, average loss: 1.5830
[09/28 19:11:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.84	
[09/28 19:11:25 visual_prompt]: Training 25 / 100 epoch, with learning rate 23.536844910736587
[09/28 19:17:51 visual_prompt]: Epoch 25 / 100: avg data time: 1.06e+01, avg batch time: 11.0134, average train loss: 47.6111
[09/28 19:18:36 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2573, average loss: 103.7047
[09/28 19:18:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 45.95	
[09/28 19:18:36 visual_prompt]: Training 26 / 100 epoch, with learning rate 23.325317547305485
[09/28 19:25:01 visual_prompt]: Epoch 26 / 100: avg data time: 1.05e+01, avg batch time: 10.9735, average train loss: 42.2180
[09/28 19:25:45 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1899, average loss: 28.8961
[09/28 19:25:45 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.82	
[09/28 19:25:45 visual_prompt]: Training 27 / 100 epoch, with learning rate 23.100601201955325
[09/28 19:32:12 visual_prompt]: Epoch 27 / 100: avg data time: 1.06e+01, avg batch time: 11.0351, average train loss: 19.6412
[09/28 19:32:57 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2765, average loss: 50.1822
[09/28 19:32:57 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 44.16	
[09/28 19:32:57 visual_prompt]: Training 28 / 100 epoch, with learning rate 22.86296965693802
[09/28 19:39:24 visual_prompt]: Epoch 28 / 100: avg data time: 1.06e+01, avg batch time: 11.0311, average train loss: 50.4246
[09/28 19:40:09 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1924, average loss: 58.6129
[09/28 19:40:09 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.39	
[09/28 19:40:09 visual_prompt]: Training 29 / 100 epoch, with learning rate 22.612712429686844
[09/28 19:46:36 visual_prompt]: Epoch 29 / 100: avg data time: 1.06e+01, avg batch time: 11.0606, average train loss: 27.4179
[09/28 19:47:21 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.2167, average loss: 13.6555
[09/28 19:47:21 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.23	
[09/28 19:47:21 visual_prompt]: Training 30 / 100 epoch, with learning rate 22.35013442008402
[09/28 19:53:49 visual_prompt]: Epoch 30 / 100: avg data time: 1.06e+01, avg batch time: 11.0665, average train loss: 44.4650
[09/28 19:54:34 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1918, average loss: 85.5083
[09/28 19:54:34 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 45.95	
[09/28 19:54:34 visual_prompt]: Training 31 / 100 epoch, with learning rate 22.075555538987224
[09/28 20:01:01 visual_prompt]: Epoch 31 / 100: avg data time: 1.06e+01, avg batch time: 11.0547, average train loss: 60.5086
[09/28 20:01:47 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.2169, average loss: 60.1105
[09/28 20:01:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.72	
[09/28 20:01:47 visual_prompt]: Training 32 / 100 epoch, with learning rate 21.78931031846743
[09/28 20:08:13 visual_prompt]: Epoch 32 / 100: avg data time: 1.05e+01, avg batch time: 11.0282, average train loss: 29.5558
[09/28 20:08:58 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.2096, average loss: 14.7511
[09/28 20:08:58 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 40.75	
[09/28 20:08:58 visual_prompt]: Training 33 / 100 epoch, with learning rate 21.49174750423314
[09/28 20:15:26 visual_prompt]: Epoch 33 / 100: avg data time: 1.06e+01, avg batch time: 11.0656, average train loss: 67.4234
[09/28 20:16:11 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.2101, average loss: 102.9840
[09/28 20:16:11 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.81	
[09/28 20:16:11 visual_prompt]: Training 34 / 100 epoch, with learning rate 21.183229630737465
[09/28 20:22:40 visual_prompt]: Epoch 34 / 100: avg data time: 1.06e+01, avg batch time: 11.1215, average train loss: 53.2167
[09/28 20:23:26 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2772, average loss: 109.2399
[09/28 20:23:26 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.75	
[09/28 20:23:26 visual_prompt]: Training 35 / 100 epoch, with learning rate 20.864132579485727
[09/28 20:29:52 visual_prompt]: Epoch 35 / 100: avg data time: 1.06e+01, avg batch time: 11.0262, average train loss: 70.5325
[09/28 20:30:37 visual_prompt]: Inference (val):avg data time: 2.88e-05, avg batch time: 0.1957, average loss: 23.7128
[09/28 20:30:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.70	
[09/28 20:30:37 visual_prompt]: Training 36 / 100 epoch, with learning rate 20.53484512108174
[09/28 20:37:04 visual_prompt]: Epoch 36 / 100: avg data time: 1.06e+01, avg batch time: 11.0418, average train loss: 35.4872
[09/28 20:37:49 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2289, average loss: 25.7878
[09/28 20:37:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.22	
[09/28 20:37:49 visual_prompt]: Training 37 / 100 epoch, with learning rate 20.195768441570728
[09/28 20:44:16 visual_prompt]: Epoch 37 / 100: avg data time: 1.06e+01, avg batch time: 11.0647, average train loss: 39.5491
[09/28 20:45:02 visual_prompt]: Inference (val):avg data time: 2.20e-05, avg batch time: 0.1920, average loss: 12.6075
[09/28 20:45:02 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 47.47	
[09/28 20:45:02 visual_prompt]: Training 38 / 100 epoch, with learning rate 19.847315653655915
[09/28 20:51:30 visual_prompt]: Epoch 38 / 100: avg data time: 1.06e+01, avg batch time: 11.0794, average train loss: 22.8124
[09/28 20:52:15 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1915, average loss: 4.9679
[09/28 20:52:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 41.71	
[09/28 20:52:15 visual_prompt]: Training 39 / 100 epoch, with learning rate 19.489911293384335
[09/28 20:58:42 visual_prompt]: Epoch 39 / 100: avg data time: 1.06e+01, avg batch time: 11.0633, average train loss: 18.1041
[09/28 20:59:28 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2055, average loss: 17.3155
[09/28 20:59:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 41.50	
[09/28 20:59:28 visual_prompt]: Training 40 / 100 epoch, with learning rate 19.12399080291506
[09/28 21:05:54 visual_prompt]: Epoch 40 / 100: avg data time: 1.05e+01, avg batch time: 11.0367, average train loss: 18.4119
[09/28 21:06:39 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.2319, average loss: 44.6408
[09/28 21:06:40 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.09	
[09/28 21:06:40 visual_prompt]: Training 41 / 100 epoch, with learning rate 18.75
[09/28 21:13:08 visual_prompt]: Epoch 41 / 100: avg data time: 1.06e+01, avg batch time: 11.0921, average train loss: 18.4227
[09/28 21:13:53 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.1942, average loss: 25.1289
[09/28 21:13:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.61	
[09/28 21:13:53 visual_prompt]: Training 42 / 100 epoch, with learning rate 18.368394534823633
[09/28 21:20:20 visual_prompt]: Epoch 42 / 100: avg data time: 1.06e+01, avg batch time: 11.0542, average train loss: 27.1743
[09/28 21:21:05 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.2748, average loss: 11.1393
[09/28 21:21:05 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 48.25	
[09/28 21:21:05 visual_prompt]: Training 43 / 100 epoch, with learning rate 17.979639334863467
[09/28 21:27:31 visual_prompt]: Epoch 43 / 100: avg data time: 1.05e+01, avg batch time: 11.0251, average train loss: 43.5266
[09/28 21:28:17 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2299, average loss: 5.5532
[09/28 21:28:17 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.27	
[09/28 21:28:17 visual_prompt]: Training 44 / 100 epoch, with learning rate 17.584208038447503
[09/28 21:34:44 visual_prompt]: Epoch 44 / 100: avg data time: 1.06e+01, avg batch time: 11.0493, average train loss: 37.6677
[09/28 21:35:29 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.1920, average loss: 6.8755
[09/28 21:35:29 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.27	
[09/28 21:35:29 visual_prompt]: Training 45 / 100 epoch, with learning rate 17.182582417698903
[09/28 21:41:57 visual_prompt]: Epoch 45 / 100: avg data time: 1.06e+01, avg batch time: 11.0682, average train loss: 24.7429
[09/28 21:42:42 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.2392, average loss: 4.8298
[09/28 21:42:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.89	
[09/28 21:42:42 visual_prompt]: Training 46 / 100 epoch, with learning rate 16.77525179157086
[09/28 21:49:10 visual_prompt]: Epoch 46 / 100: avg data time: 1.06e+01, avg batch time: 11.0851, average train loss: 16.9321
[09/28 21:49:56 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.2555, average loss: 15.1774
[09/28 21:49:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.26	
[09/28 21:49:56 visual_prompt]: Training 47 / 100 epoch, with learning rate 16.362712429686844
[09/28 21:56:23 visual_prompt]: Epoch 47 / 100: avg data time: 1.06e+01, avg batch time: 11.0524, average train loss: 18.7243
[09/28 21:57:08 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2286, average loss: 9.6631
[09/28 21:57:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.98	
[09/28 21:57:08 visual_prompt]: Training 48 / 100 epoch, with learning rate 15.94546694771249
[09/28 22:03:34 visual_prompt]: Epoch 48 / 100: avg data time: 1.05e+01, avg batch time: 11.0211, average train loss: 16.2367
[09/28 22:04:19 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2184, average loss: 17.2051
[09/28 22:04:19 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 43.49	
[09/28 22:04:19 visual_prompt]: Training 49 / 100 epoch, with learning rate 15.524023694995845
[09/28 22:10:47 visual_prompt]: Epoch 49 / 100: avg data time: 1.06e+01, avg batch time: 11.0955, average train loss: 21.1856
[09/28 22:11:33 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2020, average loss: 15.5428
[09/28 22:11:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 45.92	
[09/28 22:11:33 visual_prompt]: Training 50 / 100 epoch, with learning rate 15.09889613522199
[09/28 22:18:01 visual_prompt]: Epoch 50 / 100: avg data time: 1.06e+01, avg batch time: 11.0927, average train loss: 50.0481
[09/28 22:18:46 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2613, average loss: 64.8732
[09/28 22:18:46 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 48.39	
[09/28 22:18:46 visual_prompt]: Training 51 / 100 epoch, with learning rate 14.670602220836631
[09/28 22:25:14 visual_prompt]: Epoch 51 / 100: avg data time: 1.06e+01, avg batch time: 11.0802, average train loss: 25.7984
[09/28 22:26:00 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.2418, average loss: 3.4134
[09/28 22:26:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.81	
[09/28 22:26:00 visual_prompt]: Training 52 / 100 epoch, with learning rate 14.239663762000818
[09/28 22:32:28 visual_prompt]: Epoch 52 / 100: avg data time: 1.06e+01, avg batch time: 11.0962, average train loss: 14.8182
[09/28 22:33:14 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1922, average loss: 11.6910
[09/28 22:33:14 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.87	
[09/28 22:33:14 visual_prompt]: Training 53 / 100 epoch, with learning rate 13.80660579084567
[09/28 22:39:42 visual_prompt]: Epoch 53 / 100: avg data time: 1.06e+01, avg batch time: 11.0723, average train loss: 25.2019
[09/28 22:40:27 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.2331, average loss: 46.5477
[09/28 22:40:27 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 46.93	
[09/28 22:40:27 visual_prompt]: Training 54 / 100 epoch, with learning rate 13.371955921801565
[09/28 22:46:54 visual_prompt]: Epoch 54 / 100: avg data time: 1.06e+01, avg batch time: 11.0418, average train loss: 19.8594
[09/28 22:47:40 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2829, average loss: 22.5415
[09/28 22:47:40 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.61	
[09/28 22:47:40 visual_prompt]: Training 55 / 100 epoch, with learning rate 12.936243708781264
[09/28 22:54:08 visual_prompt]: Epoch 55 / 100: avg data time: 1.06e+01, avg batch time: 11.0980, average train loss: 28.5604
[09/28 22:54:53 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2367, average loss: 12.6409
[09/28 22:54:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.58	
[09/28 22:54:53 visual_prompt]: Training 56 / 100 epoch, with learning rate 12.5
[09/28 23:01:20 visual_prompt]: Epoch 56 / 100: avg data time: 1.05e+01, avg batch time: 11.0246, average train loss: 29.6854
[09/28 23:02:04 visual_prompt]: Inference (val):avg data time: 2.06e-05, avg batch time: 0.2387, average loss: 4.8642
[09/28 23:02:04 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 60.87	
[09/28 23:02:04 visual_prompt]: Training 57 / 100 epoch, with learning rate 12.063756291218741
[09/28 23:08:31 visual_prompt]: Epoch 57 / 100: avg data time: 1.06e+01, avg batch time: 11.0242, average train loss: 17.3906
[09/28 23:09:15 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2073, average loss: 5.4935
[09/28 23:09:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.00	
[09/28 23:09:15 visual_prompt]: Training 58 / 100 epoch, with learning rate 11.628044078198434
[09/28 23:15:43 visual_prompt]: Epoch 58 / 100: avg data time: 1.06e+01, avg batch time: 11.0589, average train loss: 9.3784
[09/28 23:16:28 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2789, average loss: 7.5904
[09/28 23:16:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.19	
[09/28 23:16:28 visual_prompt]: Training 59 / 100 epoch, with learning rate 11.193394209154334
[09/28 23:22:56 visual_prompt]: Epoch 59 / 100: avg data time: 1.06e+01, avg batch time: 11.0747, average train loss: 9.4888
[09/28 23:23:41 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.2281, average loss: 5.6519
[09/28 23:23:41 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.60	
[09/28 23:23:41 visual_prompt]: Training 60 / 100 epoch, with learning rate 10.760336237999185
[09/28 23:30:09 visual_prompt]: Epoch 60 / 100: avg data time: 1.06e+01, avg batch time: 11.0817, average train loss: 6.2561
[09/28 23:30:54 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2167, average loss: 0.9909
[09/28 23:30:54 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.73	
[09/28 23:30:54 visual_prompt]: Training 61 / 100 epoch, with learning rate 10.32939777916337
[09/28 23:37:23 visual_prompt]: Epoch 61 / 100: avg data time: 1.06e+01, avg batch time: 11.0883, average train loss: 10.8892
[09/28 23:38:08 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2315, average loss: 9.1649
[09/28 23:38:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.87	
[09/28 23:38:08 visual_prompt]: Training 62 / 100 epoch, with learning rate 9.90110386477801
[09/28 23:44:36 visual_prompt]: Epoch 62 / 100: avg data time: 1.06e+01, avg batch time: 11.0922, average train loss: 14.2462
[09/28 23:45:22 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2324, average loss: 16.4182
[09/28 23:45:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 40.81	
[09/28 23:45:22 visual_prompt]: Training 63 / 100 epoch, with learning rate 9.475976305004155
[09/28 23:51:49 visual_prompt]: Epoch 63 / 100: avg data time: 1.06e+01, avg batch time: 11.0600, average train loss: 15.1979
[09/28 23:52:34 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2260, average loss: 2.5491
[09/28 23:52:34 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 42.88	
[09/28 23:52:34 visual_prompt]: Training 64 / 100 epoch, with learning rate 9.05453305228751
[09/28 23:59:02 visual_prompt]: Epoch 64 / 100: avg data time: 1.06e+01, avg batch time: 11.0795, average train loss: 14.1419
[09/28 23:59:48 visual_prompt]: Inference (val):avg data time: 2.10e-05, avg batch time: 0.2072, average loss: 10.6615
[09/28 23:59:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.59	
[09/28 23:59:48 visual_prompt]: Training 65 / 100 epoch, with learning rate 8.637287570313159
[09/29 00:06:16 visual_prompt]: Epoch 65 / 100: avg data time: 1.06e+01, avg batch time: 11.0864, average train loss: 8.8830
[09/29 00:07:01 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.2506, average loss: 2.6663
[09/29 00:07:01 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.83	
[09/29 00:07:01 visual_prompt]: Training 66 / 100 epoch, with learning rate 8.224748208429142
[09/29 00:13:29 visual_prompt]: Epoch 66 / 100: avg data time: 1.06e+01, avg batch time: 11.0731, average train loss: 3.1623
[09/29 00:14:14 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2738, average loss: 3.5240
[09/29 00:14:14 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 47.96	
[09/29 00:14:14 visual_prompt]: Training 67 / 100 epoch, with learning rate 7.817417582301099
[09/29 00:20:42 visual_prompt]: Epoch 67 / 100: avg data time: 1.06e+01, avg batch time: 11.0766, average train loss: 3.0941
[09/29 00:21:28 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2170, average loss: 0.6909
[09/29 00:21:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 64.09	
[09/29 00:21:28 visual_prompt]: Training 68 / 100 epoch, with learning rate 7.415791961552499
[09/29 00:27:55 visual_prompt]: Epoch 68 / 100: avg data time: 1.06e+01, avg batch time: 11.0744, average train loss: 1.8657
[09/29 00:28:41 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.2067, average loss: 3.6282
[09/29 00:28:41 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 40.33	
[09/29 00:28:41 visual_prompt]: Training 69 / 100 epoch, with learning rate 7.020360665136531
[09/29 00:35:11 visual_prompt]: Epoch 69 / 100: avg data time: 1.06e+01, avg batch time: 11.1287, average train loss: 1.9442
[09/29 00:35:56 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.2050, average loss: 3.7929
[09/29 00:35:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 44.31	
[09/29 00:35:56 visual_prompt]: Training 70 / 100 epoch, with learning rate 6.631605465176368
[09/29 00:42:24 visual_prompt]: Epoch 70 / 100: avg data time: 1.06e+01, avg batch time: 11.0945, average train loss: 6.3177
[09/29 00:43:10 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.2718, average loss: 9.7244
[09/29 00:43:10 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.34	
[09/29 00:43:10 visual_prompt]: Training 71 / 100 epoch, with learning rate 6.250000000000003
[09/29 00:49:39 visual_prompt]: Epoch 71 / 100: avg data time: 1.06e+01, avg batch time: 11.1088, average train loss: 8.4152
[09/29 00:50:24 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.2155, average loss: 19.1399
[09/29 00:50:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.60	
[09/29 00:50:24 visual_prompt]: Training 72 / 100 epoch, with learning rate 5.87600919708494
[09/29 00:56:53 visual_prompt]: Epoch 72 / 100: avg data time: 1.06e+01, avg batch time: 11.0878, average train loss: 8.4398
[09/29 00:57:38 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2314, average loss: 4.2187
[09/29 00:57:38 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 41.84	
[09/29 00:57:38 visual_prompt]: Training 73 / 100 epoch, with learning rate 5.510088706615666
[09/29 01:04:06 visual_prompt]: Epoch 73 / 100: avg data time: 1.06e+01, avg batch time: 11.0842, average train loss: 3.5328
[09/29 01:04:52 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2252, average loss: 3.0706
[09/29 01:04:52 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 40.84	
[09/29 01:04:52 visual_prompt]: Training 74 / 100 epoch, with learning rate 5.1526843463440875
[09/29 01:11:18 visual_prompt]: Epoch 74 / 100: avg data time: 1.06e+01, avg batch time: 11.0331, average train loss: 1.7778
[09/29 01:12:03 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2279, average loss: 1.5217
[09/29 01:12:03 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 45.57	
[09/29 01:12:03 visual_prompt]: Training 75 / 100 epoch, with learning rate 4.804231558429271
[09/29 01:18:30 visual_prompt]: Epoch 75 / 100: avg data time: 1.06e+01, avg batch time: 11.0457, average train loss: 0.9268
[09/29 01:19:15 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.2357, average loss: 1.4459
[09/29 01:19:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.09	
[09/29 01:19:15 visual_prompt]: Training 76 / 100 epoch, with learning rate 4.465154878918258
[09/29 01:25:43 visual_prompt]: Epoch 76 / 100: avg data time: 1.06e+01, avg batch time: 11.0751, average train loss: 1.5202
[09/29 01:26:28 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2398, average loss: 2.6774
[09/29 01:26:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.44	
[09/29 01:26:28 visual_prompt]: Training 77 / 100 epoch, with learning rate 4.135867420514276
[09/29 01:32:57 visual_prompt]: Epoch 77 / 100: avg data time: 1.06e+01, avg batch time: 11.0954, average train loss: 3.2512
[09/29 01:33:42 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2303, average loss: 3.3373
[09/29 01:33:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.37	
[09/29 01:33:42 visual_prompt]: Training 78 / 100 epoch, with learning rate 3.816770369262533
[09/29 01:40:11 visual_prompt]: Epoch 78 / 100: avg data time: 1.06e+01, avg batch time: 11.1057, average train loss: 1.2749
[09/29 01:40:57 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2057, average loss: 0.7102
[09/29 01:40:57 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 48.59	
[09/29 01:40:57 visual_prompt]: Training 79 / 100 epoch, with learning rate 3.508252495766863
[09/29 01:47:24 visual_prompt]: Epoch 79 / 100: avg data time: 1.06e+01, avg batch time: 11.0589, average train loss: 0.8808
[09/29 01:48:09 visual_prompt]: Inference (val):avg data time: 2.23e-05, avg batch time: 0.2163, average loss: 0.6992
[09/29 01:48:09 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.02	
[09/29 01:48:09 visual_prompt]: Training 80 / 100 epoch, with learning rate 3.2106896815325707
[09/29 01:54:37 visual_prompt]: Epoch 80 / 100: avg data time: 1.06e+01, avg batch time: 11.0915, average train loss: 1.0691
[09/29 01:55:23 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2392, average loss: 1.2971
[09/29 01:55:23 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.79	
[09/29 01:55:23 visual_prompt]: Training 81 / 100 epoch, with learning rate 2.924444461012776
[09/29 02:01:51 visual_prompt]: Epoch 81 / 100: avg data time: 1.06e+01, avg batch time: 11.0927, average train loss: 0.9394
[09/29 02:02:37 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2175, average loss: 0.7220
[09/29 02:02:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.55	
[09/29 02:02:37 visual_prompt]: Training 82 / 100 epoch, with learning rate 2.6498655799159763
[09/29 02:09:04 visual_prompt]: Epoch 82 / 100: avg data time: 1.06e+01, avg batch time: 11.0689, average train loss: 0.8616
[09/29 02:09:50 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.2436, average loss: 0.8034
[09/29 02:09:50 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 48.36	
[09/29 02:09:50 visual_prompt]: Training 83 / 100 epoch, with learning rate 2.387287570313158
[09/29 02:16:18 visual_prompt]: Epoch 83 / 100: avg data time: 1.06e+01, avg batch time: 11.0757, average train loss: 0.7602
[09/29 02:17:03 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.2181, average loss: 0.7360
[09/29 02:17:03 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.27	
[09/29 02:17:03 visual_prompt]: Training 84 / 100 epoch, with learning rate 2.13703034306198
[09/29 02:23:31 visual_prompt]: Epoch 84 / 100: avg data time: 1.06e+01, avg batch time: 11.0705, average train loss: 0.7952
[09/29 02:24:15 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.2079, average loss: 0.8139
[09/29 02:24:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.72	
[09/29 02:24:15 visual_prompt]: Training 85 / 100 epoch, with learning rate 1.8993987980446756
[09/29 02:30:45 visual_prompt]: Epoch 85 / 100: avg data time: 1.06e+01, avg batch time: 11.1116, average train loss: 0.7399
[09/29 02:31:30 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2331, average loss: 0.6975
[09/29 02:31:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 45.12	rocauc: 50.98	
[09/29 02:31:30 visual_prompt]: Training 86 / 100 epoch, with learning rate 1.674682452694516
[09/29 02:37:58 visual_prompt]: Epoch 86 / 100: avg data time: 1.06e+01, avg batch time: 11.0690, average train loss: 0.7025
[09/29 02:38:43 visual_prompt]: Inference (val):avg data time: 2.02e-05, avg batch time: 0.1951, average loss: 0.7086
[09/29 02:38:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.12	
[09/29 02:38:43 visual_prompt]: Training 87 / 100 epoch, with learning rate 1.4631550892634126
[09/29 02:45:11 visual_prompt]: Epoch 87 / 100: avg data time: 1.06e+01, avg batch time: 11.0897, average train loss: 0.7263
[09/29 02:45:57 visual_prompt]: Inference (val):avg data time: 2.07e-05, avg batch time: 0.2834, average loss: 0.7163
[09/29 02:45:57 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.43	
[09/29 02:45:57 visual_prompt]: Training 88 / 100 epoch, with learning rate 1.2650744212604148
[09/29 02:52:25 visual_prompt]: Epoch 88 / 100: avg data time: 1.06e+01, avg batch time: 11.0822, average train loss: 0.7363
[09/29 02:53:10 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.2191, average loss: 0.6981
[09/29 02:53:10 visual_prompt]: Classification results with val_mammo-cbis: top1: 45.93	rocauc: 52.39	
[09/29 02:53:10 visual_prompt]: Training 89 / 100 epoch, with learning rate 1.0806817794674877
[09/29 02:59:39 visual_prompt]: Epoch 89 / 100: avg data time: 1.06e+01, avg batch time: 11.1149, average train loss: 0.7289
[09/29 03:00:25 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.2224, average loss: 0.7036
[09/29 03:00:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 47.56	rocauc: 52.66	
[09/29 03:00:25 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.9102018179151585
[09/29 03:06:53 visual_prompt]: Epoch 90 / 100: avg data time: 1.06e+01, avg batch time: 11.0913, average train loss: 0.6961
[09/29 03:07:39 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1917, average loss: 0.6870
[09/29 03:07:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 51.63	rocauc: 54.44	
[09/29 03:07:39 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.753842240176146
[09/29 03:14:08 visual_prompt]: Epoch 91 / 100: avg data time: 1.06e+01, avg batch time: 11.1089, average train loss: 0.6948
[09/29 03:14:53 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.2254, average loss: 0.6981
[09/29 03:14:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.28	rocauc: 54.41	
[09/29 03:14:53 visual_prompt]: Best epoch 91: best metric: 0.553
[09/29 03:14:53 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.6117935463105808
[09/29 03:21:22 visual_prompt]: Epoch 92 / 100: avg data time: 1.06e+01, avg batch time: 11.1150, average train loss: 0.6907
[09/29 03:22:07 visual_prompt]: Inference (val):avg data time: 2.14e-05, avg batch time: 0.2124, average loss: 0.7330
[09/29 03:22:07 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.93	
[09/29 03:22:07 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.4842288007710138
[09/29 03:28:35 visual_prompt]: Epoch 93 / 100: avg data time: 1.06e+01, avg batch time: 11.0695, average train loss: 0.7030
[09/29 03:29:21 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2171, average loss: 0.7017
[09/29 03:29:21 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.47	rocauc: 55.50	
[09/29 03:29:21 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.3713034215500441
[09/29 03:35:49 visual_prompt]: Epoch 94 / 100: avg data time: 1.06e+01, avg batch time: 11.0952, average train loss: 0.6835
[09/29 03:36:34 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2077, average loss: 0.6906
[09/29 03:36:34 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.28	rocauc: 55.13	
[09/29 03:36:34 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.2731549908274289
[09/29 03:43:03 visual_prompt]: Epoch 95 / 100: avg data time: 1.06e+01, avg batch time: 11.0922, average train loss: 0.6895
[09/29 03:43:48 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1917, average loss: 0.6878
[09/29 03:43:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 52.03	rocauc: 54.64	
[09/29 03:43:48 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.18990308734739975
[09/29 03:50:17 visual_prompt]: Epoch 96 / 100: avg data time: 1.06e+01, avg batch time: 11.1167, average train loss: 0.6833
[09/29 03:51:03 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1919, average loss: 0.7031
[09/29 03:51:03 visual_prompt]: Classification results with val_mammo-cbis: top1: 49.59	rocauc: 54.85	
[09/29 03:51:03 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.12164914073037048
[09/29 03:57:30 visual_prompt]: Epoch 97 / 100: avg data time: 1.06e+01, avg batch time: 11.0700, average train loss: 0.6876
[09/29 03:58:16 visual_prompt]: Inference (val):avg data time: 2.70e-05, avg batch time: 0.1920, average loss: 0.6865
[09/29 03:58:16 visual_prompt]: Classification results with val_mammo-cbis: top1: 51.22	rocauc: 55.08	
[09/29 03:58:16 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.06847630789658388
[09/29 04:04:45 visual_prompt]: Epoch 98 / 100: avg data time: 1.06e+01, avg batch time: 11.1108, average train loss: 0.6821
[09/29 04:05:30 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.2676, average loss: 0.6869
[09/29 04:05:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 52.03	rocauc: 54.88	
[09/29 04:05:30 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.03044937175219753
[09/29 04:11:59 visual_prompt]: Epoch 99 / 100: avg data time: 1.06e+01, avg batch time: 11.0962, average train loss: 0.6799
[09/29 04:12:44 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.2118, average loss: 0.6865
[09/29 04:12:44 visual_prompt]: Classification results with val_mammo-cbis: top1: 52.03	rocauc: 55.08	
[09/29 04:12:44 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0076146622613029735
[09/29 04:19:13 visual_prompt]: Epoch 100 / 100: avg data time: 1.06e+01, avg batch time: 11.0953, average train loss: 0.6835
[09/29 04:19:58 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.2649, average loss: 0.6867
[09/29 04:19:58 visual_prompt]: Classification results with val_mammo-cbis: top1: 52.44	rocauc: 55.08	
[09/29 04:19:58 visual_prompt]: Rank of current process: 0. World size: 1
[09/29 04:19:58 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              0
GPU 0                NVIDIA A100-PCIE-40GB
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/29 04:19:58 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'mammo-cbis', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/29 04:19:58 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/29 04:19:58 visual_prompt]: Training with config:
[09/29 04:19:58 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/mammo-cbis/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr25.0_wd0.0/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 25.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'mammo-cbis', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/29 04:19:58 visual_prompt]: Loading training data...
[09/29 04:19:58 visual_prompt]: Constructing mammo-cbis dataset train...
[09/29 04:19:58 visual_prompt]: Loading validation data...
[09/29 04:19:58 visual_prompt]: Constructing mammo-cbis dataset val...
[09/29 04:19:58 visual_prompt]: Constructing models...
[09/29 04:20:01 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/29 04:20:01 visual_prompt]: tuned percent:0.536
[09/29 04:20:01 visual_prompt]: Device used for model: 0
[09/29 04:20:01 visual_prompt]: Setting up Evaluator...
[09/29 04:20:01 visual_prompt]: Setting up Trainer...
[09/29 04:20:01 visual_prompt]: 	Setting up the optimizer...
[09/29 04:20:01 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/29 04:26:30 visual_prompt]: Epoch 1 / 100: avg data time: 1.06e+01, avg batch time: 11.1002, average train loss: 1.4903
[09/29 04:27:15 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1920, average loss: 1.4710
[09/29 04:27:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.15	
[09/29 04:27:15 visual_prompt]: Best epoch 1: best metric: 0.537
[09/29 04:27:15 visual_prompt]: Training 2 / 100 epoch, with learning rate 2.5
[09/29 04:33:44 visual_prompt]: Epoch 2 / 100: avg data time: 1.06e+01, avg batch time: 11.1177, average train loss: 34.2452
[09/29 04:34:30 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2203, average loss: 12.8135
[09/29 04:34:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.52	
[09/29 04:34:30 visual_prompt]: Training 3 / 100 epoch, with learning rate 5.0
[09/29 04:40:58 visual_prompt]: Epoch 3 / 100: avg data time: 1.06e+01, avg batch time: 11.0947, average train loss: 11.3271
[09/29 04:41:43 visual_prompt]: Inference (val):avg data time: 2.00e-05, avg batch time: 0.1922, average loss: 19.6816
[09/29 04:41:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.32	
[09/29 04:41:43 visual_prompt]: Training 4 / 100 epoch, with learning rate 7.5
[09/29 04:48:12 visual_prompt]: Epoch 4 / 100: avg data time: 1.06e+01, avg batch time: 11.0916, average train loss: 21.0455
[09/29 04:48:57 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.2334, average loss: 6.4950
[09/29 04:48:57 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.77	
[09/29 04:48:57 visual_prompt]: Training 5 / 100 epoch, with learning rate 10.0
[09/29 04:55:25 visual_prompt]: Epoch 5 / 100: avg data time: 1.06e+01, avg batch time: 11.0683, average train loss: 17.2848
[09/29 04:56:10 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2246, average loss: 30.6152
[09/29 04:56:10 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.74	
[09/29 04:56:10 visual_prompt]: Training 6 / 100 epoch, with learning rate 12.5
[09/29 05:02:39 visual_prompt]: Epoch 6 / 100: avg data time: 1.06e+01, avg batch time: 11.0831, average train loss: 19.9008
[09/29 05:03:24 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.2063, average loss: 18.5150
[09/29 05:03:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.20	
[09/29 05:03:24 visual_prompt]: Training 7 / 100 epoch, with learning rate 15.0
[09/29 05:09:53 visual_prompt]: Epoch 7 / 100: avg data time: 1.06e+01, avg batch time: 11.1105, average train loss: 20.0133
[09/29 05:10:38 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.2247, average loss: 55.2397
[09/29 05:10:38 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.18	
[09/29 05:10:38 visual_prompt]: Training 8 / 100 epoch, with learning rate 17.5
[09/29 05:17:07 visual_prompt]: Epoch 8 / 100: avg data time: 1.06e+01, avg batch time: 11.1112, average train loss: 28.7663
[09/29 05:17:53 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.2116, average loss: 21.9458
[09/29 05:17:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.72	
[09/29 05:17:53 visual_prompt]: Training 9 / 100 epoch, with learning rate 20.0
[09/29 05:24:21 visual_prompt]: Epoch 9 / 100: avg data time: 1.06e+01, avg batch time: 11.0984, average train loss: 45.2804
[09/29 05:25:07 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.2457, average loss: 106.4722
[09/29 05:25:07 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 39.29	
[09/29 05:25:07 visual_prompt]: Training 10 / 100 epoch, with learning rate 22.5
[09/29 05:31:36 visual_prompt]: Epoch 10 / 100: avg data time: 1.06e+01, avg batch time: 11.1031, average train loss: 75.0833
[09/29 05:32:21 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.2307, average loss: 5.9884
[09/29 05:32:21 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 43.46	
[09/29 05:32:21 visual_prompt]: Training 11 / 100 epoch, with learning rate 25.0
[09/29 05:38:49 visual_prompt]: Epoch 11 / 100: avg data time: 1.06e+01, avg batch time: 11.0764, average train loss: 53.0387
[09/29 05:39:34 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.1923, average loss: 20.7257
[09/29 05:39:34 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 46.93	
[09/29 05:39:34 visual_prompt]: Training 12 / 100 epoch, with learning rate 24.9923853377387
[09/29 05:46:02 visual_prompt]: Epoch 12 / 100: avg data time: 1.06e+01, avg batch time: 11.0692, average train loss: 58.1280
[09/29 05:46:47 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.2094, average loss: 79.1305
[09/29 05:46:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.31	
[09/29 05:46:47 visual_prompt]: Training 13 / 100 epoch, with learning rate 24.969550628247802
[09/29 05:53:15 visual_prompt]: Epoch 13 / 100: avg data time: 1.06e+01, avg batch time: 11.0727, average train loss: 59.6043
[09/29 05:54:00 visual_prompt]: Inference (val):avg data time: 1.88e-05, avg batch time: 0.2468, average loss: 81.6950
[09/29 05:54:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.62	
[09/29 05:54:00 visual_prompt]: Training 14 / 100 epoch, with learning rate 24.931523692103415
[09/29 06:00:27 visual_prompt]: Epoch 14 / 100: avg data time: 1.06e+01, avg batch time: 11.0606, average train loss: 65.2393
[09/29 06:01:13 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2295, average loss: 56.1838
[09/29 06:01:13 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.10	
[09/29 06:01:13 visual_prompt]: Training 15 / 100 epoch, with learning rate 24.87835085926963
[09/29 06:07:41 visual_prompt]: Epoch 15 / 100: avg data time: 1.06e+01, avg batch time: 11.0648, average train loss: 56.8807
[09/29 06:08:26 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2056, average loss: 43.4621
[09/29 06:08:26 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.70	
[09/29 06:08:26 visual_prompt]: Training 16 / 100 epoch, with learning rate 24.8100969126526
[09/29 06:14:54 visual_prompt]: Epoch 16 / 100: avg data time: 1.06e+01, avg batch time: 11.0671, average train loss: 36.4562
[09/29 06:15:39 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2337, average loss: 19.4917
[09/29 06:15:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.59	
[09/29 06:15:39 visual_prompt]: Training 17 / 100 epoch, with learning rate 24.72684500917257
[09/29 06:22:07 visual_prompt]: Epoch 17 / 100: avg data time: 1.06e+01, avg batch time: 11.0881, average train loss: 32.3019
[09/29 06:22:52 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2171, average loss: 28.3163
[09/29 06:22:52 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 59.51	
[09/29 06:22:52 visual_prompt]: Training 18 / 100 epoch, with learning rate 24.628696578449954
[09/29 06:29:21 visual_prompt]: Epoch 18 / 100: avg data time: 1.06e+01, avg batch time: 11.0973, average train loss: 31.0565
[09/29 06:30:06 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2756, average loss: 2.1611
[09/29 06:30:06 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 45.80	
[09/29 06:30:06 visual_prompt]: Training 19 / 100 epoch, with learning rate 24.515771199228986
[09/29 06:36:35 visual_prompt]: Epoch 19 / 100: avg data time: 1.06e+01, avg batch time: 11.0907, average train loss: 46.4927
[09/29 06:37:20 visual_prompt]: Inference (val):avg data time: 2.14e-05, avg batch time: 0.2239, average loss: 73.0261
[09/29 06:37:20 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 63.32	
[09/29 06:37:20 visual_prompt]: Training 20 / 100 epoch, with learning rate 24.38820645368942
[09/29 06:43:48 visual_prompt]: Epoch 20 / 100: avg data time: 1.06e+01, avg batch time: 11.0709, average train loss: 32.1905
[09/29 06:44:33 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.2327, average loss: 39.7640
[09/29 06:44:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 60.58	
[09/29 06:44:33 visual_prompt]: Training 21 / 100 epoch, with learning rate 24.246157759823856
[09/29 06:51:01 visual_prompt]: Epoch 21 / 100: avg data time: 1.06e+01, avg batch time: 11.0824, average train loss: 26.6209
[09/29 06:51:47 visual_prompt]: Inference (val):avg data time: 2.85e-05, avg batch time: 0.2164, average loss: 73.2064
[09/29 06:51:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.79	
[09/29 06:51:47 visual_prompt]: Training 22 / 100 epoch, with learning rate 24.08979818208484
[09/29 06:58:15 visual_prompt]: Epoch 22 / 100: avg data time: 1.06e+01, avg batch time: 11.0736, average train loss: 55.8131
[09/29 06:59:00 visual_prompt]: Inference (val):avg data time: 2.02e-05, avg batch time: 0.1938, average loss: 47.8882
[09/29 06:59:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.81	
[09/29 06:59:00 visual_prompt]: Training 23 / 100 epoch, with learning rate 23.91931822053251
[09/29 07:05:28 visual_prompt]: Epoch 23 / 100: avg data time: 1.06e+01, avg batch time: 11.0801, average train loss: 31.9880
[09/29 07:06:14 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2910, average loss: 20.1414
[09/29 07:06:14 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.83	
[09/29 07:06:14 visual_prompt]: Training 24 / 100 epoch, with learning rate 23.73492557873959
[09/29 07:12:43 visual_prompt]: Epoch 24 / 100: avg data time: 1.06e+01, avg batch time: 11.1173, average train loss: 15.3007
[09/29 07:13:28 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1918, average loss: 4.3232
[09/29 07:13:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.40	
[09/29 07:13:28 visual_prompt]: Training 25 / 100 epoch, with learning rate 23.536844910736587
[09/29 07:19:57 visual_prompt]: Epoch 25 / 100: avg data time: 1.06e+01, avg batch time: 11.0912, average train loss: 28.0705
[09/29 07:20:42 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2091, average loss: 25.3048
[09/29 07:20:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.22	
[09/29 07:20:42 visual_prompt]: Training 26 / 100 epoch, with learning rate 23.325317547305485
[09/29 07:27:10 visual_prompt]: Epoch 26 / 100: avg data time: 1.06e+01, avg batch time: 11.0867, average train loss: 23.4146
[09/29 07:27:56 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1934, average loss: 34.3790
[09/29 07:27:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.94	
[09/29 07:27:56 visual_prompt]: Training 27 / 100 epoch, with learning rate 23.100601201955325
[09/29 07:34:23 visual_prompt]: Epoch 27 / 100: avg data time: 1.06e+01, avg batch time: 11.0654, average train loss: 28.7219
[09/29 07:35:08 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.1920, average loss: 62.3533
[09/29 07:35:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.79	
[09/29 07:35:08 visual_prompt]: Training 28 / 100 epoch, with learning rate 22.86296965693802
[09/29 07:41:36 visual_prompt]: Epoch 28 / 100: avg data time: 1.06e+01, avg batch time: 11.0761, average train loss: 32.6733
[09/29 07:42:22 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.2831, average loss: 69.3894
[09/29 07:42:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.33	
[09/29 07:42:22 visual_prompt]: Training 29 / 100 epoch, with learning rate 22.612712429686844
[09/29 07:48:50 visual_prompt]: Epoch 29 / 100: avg data time: 1.06e+01, avg batch time: 11.0977, average train loss: 21.2650
[09/29 07:49:36 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2300, average loss: 6.1041
[09/29 07:49:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.67	
[09/29 07:49:36 visual_prompt]: Training 30 / 100 epoch, with learning rate 22.35013442008402
[09/29 07:56:04 visual_prompt]: Epoch 30 / 100: avg data time: 1.06e+01, avg batch time: 11.0875, average train loss: 25.6821
[09/29 07:56:49 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.2257, average loss: 4.3419
[09/29 07:56:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.47	
[09/29 07:56:49 visual_prompt]: Training 31 / 100 epoch, with learning rate 22.075555538987224
[09/29 08:03:17 visual_prompt]: Epoch 31 / 100: avg data time: 1.06e+01, avg batch time: 11.0692, average train loss: 25.0543
[09/29 08:04:03 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.2651, average loss: 25.1537
[09/29 08:04:03 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.04	
[09/29 08:04:03 visual_prompt]: Training 32 / 100 epoch, with learning rate 21.78931031846743
[09/29 08:10:31 visual_prompt]: Epoch 32 / 100: avg data time: 1.06e+01, avg batch time: 11.1047, average train loss: 18.5722
[09/29 08:11:17 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.2286, average loss: 22.8114
[09/29 08:11:17 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.69	
[09/29 08:11:17 visual_prompt]: Training 33 / 100 epoch, with learning rate 21.49174750423314
[09/29 08:17:46 visual_prompt]: Epoch 33 / 100: avg data time: 1.06e+01, avg batch time: 11.1072, average train loss: 24.0164
[09/29 08:18:31 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.2147, average loss: 15.4118
[09/29 08:18:31 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.61	
[09/29 08:18:31 visual_prompt]: Training 34 / 100 epoch, with learning rate 21.183229630737465
[09/29 08:25:00 visual_prompt]: Epoch 34 / 100: avg data time: 1.06e+01, avg batch time: 11.1024, average train loss: 11.6074
[09/29 08:25:45 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2054, average loss: 19.1714
[09/29 08:25:45 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.46	
[09/29 08:25:45 visual_prompt]: Training 35 / 100 epoch, with learning rate 20.864132579485727
[09/29 08:32:13 visual_prompt]: Epoch 35 / 100: avg data time: 1.06e+01, avg batch time: 11.0870, average train loss: 10.1896
[09/29 08:32:59 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.2425, average loss: 5.0301
[09/29 08:32:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.76	
[09/29 08:32:59 visual_prompt]: Training 36 / 100 epoch, with learning rate 20.53484512108174
[09/29 08:39:27 visual_prompt]: Epoch 36 / 100: avg data time: 1.06e+01, avg batch time: 11.0731, average train loss: 13.2905
[09/29 08:40:12 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1942, average loss: 16.3260
[09/29 08:40:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.20	
[09/29 08:40:12 visual_prompt]: Training 37 / 100 epoch, with learning rate 20.195768441570728
[09/29 08:46:40 visual_prompt]: Epoch 37 / 100: avg data time: 1.06e+01, avg batch time: 11.0782, average train loss: 17.8081
[09/29 08:47:25 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.1923, average loss: 9.7287
[09/29 08:47:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.80	
[09/29 08:47:25 visual_prompt]: Training 38 / 100 epoch, with learning rate 19.847315653655915
[09/29 08:53:53 visual_prompt]: Epoch 38 / 100: avg data time: 1.06e+01, avg batch time: 11.0764, average train loss: 12.6263
[09/29 08:54:38 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2636, average loss: 23.6354
[09/29 08:54:38 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.85	
[09/29 08:54:38 visual_prompt]: Training 39 / 100 epoch, with learning rate 19.489911293384335
[09/29 09:01:07 visual_prompt]: Epoch 39 / 100: avg data time: 1.06e+01, avg batch time: 11.0860, average train loss: 14.6388
[09/29 09:01:52 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2236, average loss: 13.7440
[09/29 09:01:52 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.35	
[09/29 09:01:52 visual_prompt]: Training 40 / 100 epoch, with learning rate 19.12399080291506
[09/29 09:08:21 visual_prompt]: Epoch 40 / 100: avg data time: 1.06e+01, avg batch time: 11.0987, average train loss: 11.4837
[09/29 09:09:06 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.2601, average loss: 29.4715
[09/29 09:09:06 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.79	
[09/29 09:09:06 visual_prompt]: Training 41 / 100 epoch, with learning rate 18.75
[09/29 09:15:34 visual_prompt]: Epoch 41 / 100: avg data time: 1.06e+01, avg batch time: 11.0795, average train loss: 17.1171
[09/29 09:16:19 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2104, average loss: 48.7244
[09/29 09:16:19 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 58.54	
[09/29 09:16:19 visual_prompt]: Training 42 / 100 epoch, with learning rate 18.368394534823633
[09/29 09:22:48 visual_prompt]: Epoch 42 / 100: avg data time: 1.06e+01, avg batch time: 11.0963, average train loss: 21.1812
[09/29 09:23:34 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2719, average loss: 2.1263
[09/29 09:23:34 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.10	
[09/29 09:23:34 visual_prompt]: Training 43 / 100 epoch, with learning rate 17.979639334863467
[09/29 09:30:02 visual_prompt]: Epoch 43 / 100: avg data time: 1.06e+01, avg batch time: 11.0853, average train loss: 11.5020
[09/29 09:30:47 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1917, average loss: 9.6447
[09/29 09:30:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.07	
[09/29 09:30:47 visual_prompt]: Training 44 / 100 epoch, with learning rate 17.584208038447503
[09/29 09:37:16 visual_prompt]: Epoch 44 / 100: avg data time: 1.06e+01, avg batch time: 11.1112, average train loss: 16.7737
[09/29 09:38:02 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.1959, average loss: 7.2400
[09/29 09:38:02 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.47	
[09/29 09:38:02 visual_prompt]: Training 45 / 100 epoch, with learning rate 17.182582417698903
[09/29 09:44:30 visual_prompt]: Epoch 45 / 100: avg data time: 1.06e+01, avg batch time: 11.0831, average train loss: 8.4363
[09/29 09:45:15 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2295, average loss: 8.7712
[09/29 09:45:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.93	
[09/29 09:45:15 visual_prompt]: Training 46 / 100 epoch, with learning rate 16.77525179157086
[09/29 09:51:44 visual_prompt]: Epoch 46 / 100: avg data time: 1.06e+01, avg batch time: 11.1004, average train loss: 14.3064
[09/29 09:52:29 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.1920, average loss: 1.5270
[09/29 09:52:29 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.55	
[09/29 09:52:29 visual_prompt]: Training 47 / 100 epoch, with learning rate 16.362712429686844
[09/29 09:58:57 visual_prompt]: Epoch 47 / 100: avg data time: 1.06e+01, avg batch time: 11.0898, average train loss: 18.0824
[09/29 09:59:43 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2111, average loss: 17.9868
[09/29 09:59:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.57	
[09/29 09:59:43 visual_prompt]: Training 48 / 100 epoch, with learning rate 15.94546694771249
[09/29 10:06:12 visual_prompt]: Epoch 48 / 100: avg data time: 1.06e+01, avg batch time: 11.1062, average train loss: 5.6719
[09/29 10:06:57 visual_prompt]: Inference (val):avg data time: 2.09e-05, avg batch time: 0.2161, average loss: 0.9114
[09/29 10:06:57 visual_prompt]: Classification results with val_mammo-cbis: top1: 58.54	rocauc: 58.12	
[09/29 10:06:57 visual_prompt]: Best epoch 48: best metric: 0.585
[09/29 10:06:57 visual_prompt]: Training 49 / 100 epoch, with learning rate 15.524023694995845
[09/29 10:13:26 visual_prompt]: Epoch 49 / 100: avg data time: 1.06e+01, avg batch time: 11.1161, average train loss: 4.7049
[09/29 10:14:12 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.2822, average loss: 8.2901
[09/29 10:14:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.91	
[09/29 10:14:12 visual_prompt]: Training 50 / 100 epoch, with learning rate 15.09889613522199
[09/29 10:20:40 visual_prompt]: Epoch 50 / 100: avg data time: 1.06e+01, avg batch time: 11.0800, average train loss: 8.1200
[09/29 10:21:25 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.1921, average loss: 25.2751
[09/29 10:21:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.97	
[09/29 10:21:25 visual_prompt]: Training 51 / 100 epoch, with learning rate 14.670602220836631
[09/29 10:27:54 visual_prompt]: Epoch 51 / 100: avg data time: 1.06e+01, avg batch time: 11.1053, average train loss: 14.7513
[09/29 10:28:39 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.2101, average loss: 10.5376
[09/29 10:28:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.81	
[09/29 10:28:39 visual_prompt]: Training 52 / 100 epoch, with learning rate 14.239663762000818
[09/29 10:35:09 visual_prompt]: Epoch 52 / 100: avg data time: 1.06e+01, avg batch time: 11.1110, average train loss: 7.5221
[09/29 10:35:54 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2714, average loss: 14.6228
[09/29 10:35:54 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.90	
[09/29 10:35:54 visual_prompt]: Training 53 / 100 epoch, with learning rate 13.80660579084567
[09/29 10:42:23 visual_prompt]: Epoch 53 / 100: avg data time: 1.06e+01, avg batch time: 11.0948, average train loss: 7.3345
[09/29 10:43:08 visual_prompt]: Inference (val):avg data time: 2.17e-05, avg batch time: 0.2479, average loss: 1.1394
[09/29 10:43:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.37	
[09/29 10:43:08 visual_prompt]: Training 54 / 100 epoch, with learning rate 13.371955921801565
[09/29 10:49:36 visual_prompt]: Epoch 54 / 100: avg data time: 1.06e+01, avg batch time: 11.0592, average train loss: 7.7825
[09/29 10:50:21 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.2304, average loss: 2.6928
[09/29 10:50:21 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.69	rocauc: 58.95	
[09/29 10:50:21 visual_prompt]: Training 55 / 100 epoch, with learning rate 12.936243708781264
[09/29 10:56:49 visual_prompt]: Epoch 55 / 100: avg data time: 1.06e+01, avg batch time: 11.0787, average train loss: 3.9517
[09/29 10:57:34 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.2609, average loss: 3.7932
[09/29 10:57:34 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.13	
[09/29 10:57:34 visual_prompt]: Training 56 / 100 epoch, with learning rate 12.5
[09/29 11:04:04 visual_prompt]: Epoch 56 / 100: avg data time: 1.06e+01, avg batch time: 11.1257, average train loss: 3.4372
[09/29 11:04:49 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.2342, average loss: 2.8045
[09/29 11:04:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.51	
[09/29 11:04:49 visual_prompt]: Training 57 / 100 epoch, with learning rate 12.063756291218741
[09/29 11:11:18 visual_prompt]: Epoch 57 / 100: avg data time: 1.07e+01, avg batch time: 11.0925, average train loss: 6.1622
[09/29 11:12:03 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.1935, average loss: 14.9008
[09/29 11:12:03 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 58.61	
[09/29 11:12:03 visual_prompt]: Training 58 / 100 epoch, with learning rate 11.628044078198434
[09/29 11:18:42 visual_prompt]: Epoch 58 / 100: avg data time: 1.09e+01, avg batch time: 11.3946, average train loss: 8.1288
[09/29 11:19:28 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.2107, average loss: 1.4179
[09/29 11:19:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.88	rocauc: 58.78	
[09/29 11:19:28 visual_prompt]: Training 59 / 100 epoch, with learning rate 11.193394209154334
[09/29 11:25:57 visual_prompt]: Epoch 59 / 100: avg data time: 1.06e+01, avg batch time: 11.0913, average train loss: 3.9314
[09/29 11:26:42 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2400, average loss: 9.0096
[09/29 11:26:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 60.21	
[09/29 11:26:42 visual_prompt]: Training 60 / 100 epoch, with learning rate 10.760336237999185
[09/29 11:33:11 visual_prompt]: Epoch 60 / 100: avg data time: 1.06e+01, avg batch time: 11.0888, average train loss: 5.7815
[09/29 11:33:56 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.1926, average loss: 2.0398
[09/29 11:33:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 47.56	rocauc: 59.11	
[09/29 11:33:56 visual_prompt]: Training 61 / 100 epoch, with learning rate 10.32939777916337
[09/29 11:40:26 visual_prompt]: Epoch 61 / 100: avg data time: 1.06e+01, avg batch time: 11.1387, average train loss: 3.1311
[09/29 11:41:11 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2050, average loss: 9.9399
[09/29 11:41:11 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.74	
[09/29 11:41:11 visual_prompt]: Training 62 / 100 epoch, with learning rate 9.90110386477801
[09/29 11:47:40 visual_prompt]: Epoch 62 / 100: avg data time: 1.06e+01, avg batch time: 11.0963, average train loss: 3.3988
[09/29 11:48:26 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.2334, average loss: 1.6370
[09/29 11:48:26 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.93	
[09/29 11:48:26 visual_prompt]: Training 63 / 100 epoch, with learning rate 9.475976305004155
[09/29 11:54:53 visual_prompt]: Epoch 63 / 100: avg data time: 1.06e+01, avg batch time: 11.0739, average train loss: 1.8328
[09/29 11:55:39 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.2693, average loss: 1.3372
[09/29 11:55:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 61.28	
[09/29 11:55:39 visual_prompt]: Training 64 / 100 epoch, with learning rate 9.05453305228751
[09/29 12:02:07 visual_prompt]: Epoch 64 / 100: avg data time: 1.06e+01, avg batch time: 11.0897, average train loss: 7.5855
[09/29 12:02:53 visual_prompt]: Inference (val):avg data time: 2.20e-05, avg batch time: 0.1987, average loss: 5.7359
[09/29 12:02:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 60.18	
[09/29 12:02:53 visual_prompt]: Training 65 / 100 epoch, with learning rate 8.637287570313159
[09/29 12:09:22 visual_prompt]: Epoch 65 / 100: avg data time: 1.06e+01, avg batch time: 11.1269, average train loss: 1.8621
[09/29 12:10:08 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.1995, average loss: 0.6887
[09/29 12:10:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 57.72	rocauc: 62.31	
[09/29 12:10:08 visual_prompt]: Training 66 / 100 epoch, with learning rate 8.224748208429142
[09/29 12:16:37 visual_prompt]: Epoch 66 / 100: avg data time: 1.06e+01, avg batch time: 11.1108, average train loss: 2.0081
[09/29 12:17:22 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.1924, average loss: 3.6531
[09/29 12:17:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 60.71	
[09/29 12:17:22 visual_prompt]: Training 67 / 100 epoch, with learning rate 7.817417582301099
[09/29 12:23:50 visual_prompt]: Epoch 67 / 100: avg data time: 1.06e+01, avg batch time: 11.0849, average train loss: 2.3912
[09/29 12:24:36 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2286, average loss: 1.5834
[09/29 12:24:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.91	
[09/29 12:24:36 visual_prompt]: Training 68 / 100 epoch, with learning rate 7.415791961552499
[09/29 12:31:04 visual_prompt]: Epoch 68 / 100: avg data time: 1.06e+01, avg batch time: 11.0737, average train loss: 2.1448
[09/29 12:31:49 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2287, average loss: 0.8194
[09/29 12:31:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 50.00	rocauc: 60.72	
[09/29 12:31:49 visual_prompt]: Training 69 / 100 epoch, with learning rate 7.020360665136531
[09/29 12:38:17 visual_prompt]: Epoch 69 / 100: avg data time: 1.06e+01, avg batch time: 11.0740, average train loss: 1.2546
[09/29 12:39:02 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2093, average loss: 0.7062
[09/29 12:39:02 visual_prompt]: Classification results with val_mammo-cbis: top1: 58.54	rocauc: 60.03	
[09/29 12:39:02 visual_prompt]: Training 70 / 100 epoch, with learning rate 6.631605465176368
[09/29 12:45:31 visual_prompt]: Epoch 70 / 100: avg data time: 1.06e+01, avg batch time: 11.0989, average train loss: 1.7396
[09/29 12:46:16 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2513, average loss: 2.7310
[09/29 12:46:16 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.66	
[09/29 12:46:16 visual_prompt]: Training 71 / 100 epoch, with learning rate 6.250000000000003
[09/29 12:52:45 visual_prompt]: Epoch 71 / 100: avg data time: 1.06e+01, avg batch time: 11.0913, average train loss: 2.0069
[09/29 12:53:31 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.3163, average loss: 0.7535
[09/29 12:53:31 visual_prompt]: Classification results with val_mammo-cbis: top1: 58.54	rocauc: 60.19	
[09/29 12:53:31 visual_prompt]: Training 72 / 100 epoch, with learning rate 5.87600919708494
[09/29 12:59:58 visual_prompt]: Epoch 72 / 100: avg data time: 1.06e+01, avg batch time: 11.0753, average train loss: 1.3112
[09/29 13:00:44 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.1930, average loss: 1.0955
[09/29 13:00:44 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 61.02	
[09/29 13:00:44 visual_prompt]: Training 73 / 100 epoch, with learning rate 5.510088706615666
[09/29 13:07:12 visual_prompt]: Epoch 73 / 100: avg data time: 1.06e+01, avg batch time: 11.0809, average train loss: 1.7079
[09/29 13:07:57 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2828, average loss: 0.6854
[09/29 13:07:57 visual_prompt]: Classification results with val_mammo-cbis: top1: 60.98	rocauc: 60.81	
[09/29 13:07:57 visual_prompt]: Best epoch 73: best metric: 0.610
[09/29 13:07:57 visual_prompt]: Training 74 / 100 epoch, with learning rate 5.1526843463440875
[09/29 13:14:26 visual_prompt]: Epoch 74 / 100: avg data time: 1.06e+01, avg batch time: 11.1148, average train loss: 1.9626
[09/29 13:15:12 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.2863, average loss: 1.2084
[09/29 13:15:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.88	rocauc: 60.38	
[09/29 13:15:12 visual_prompt]: Training 75 / 100 epoch, with learning rate 4.804231558429271
[09/29 13:21:42 visual_prompt]: Epoch 75 / 100: avg data time: 1.06e+01, avg batch time: 11.1287, average train loss: 0.9104
[09/29 13:22:27 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1936, average loss: 0.6693
[09/29 13:22:27 visual_prompt]: Classification results with val_mammo-cbis: top1: 61.79	rocauc: 61.52	
[09/29 13:22:27 visual_prompt]: Best epoch 75: best metric: 0.618
[09/29 13:22:27 visual_prompt]: Training 76 / 100 epoch, with learning rate 4.465154878918258
[09/29 13:28:56 visual_prompt]: Epoch 76 / 100: avg data time: 1.06e+01, avg batch time: 11.1079, average train loss: 0.8975
[09/29 13:29:42 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2924, average loss: 1.0055
[09/29 13:29:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 62.11	
[09/29 13:29:42 visual_prompt]: Training 77 / 100 epoch, with learning rate 4.135867420514276
[09/29 13:36:10 visual_prompt]: Epoch 77 / 100: avg data time: 1.06e+01, avg batch time: 11.0820, average train loss: 0.7849
[09/29 13:36:55 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.2232, average loss: 0.6636
[09/29 13:36:55 visual_prompt]: Classification results with val_mammo-cbis: top1: 63.01	rocauc: 62.42	
[09/29 13:36:55 visual_prompt]: Best epoch 77: best metric: 0.630
[09/29 13:36:55 visual_prompt]: Training 78 / 100 epoch, with learning rate 3.816770369262533
[09/29 13:43:22 visual_prompt]: Epoch 78 / 100: avg data time: 1.06e+01, avg batch time: 11.0549, average train loss: 0.8595
[09/29 13:44:08 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2344, average loss: 0.6741
[09/29 13:44:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.50	rocauc: 62.20	
[09/29 13:44:08 visual_prompt]: Training 79 / 100 epoch, with learning rate 3.508252495766863
[09/29 13:50:35 visual_prompt]: Epoch 79 / 100: avg data time: 1.06e+01, avg batch time: 11.0617, average train loss: 0.8746
[09/29 13:51:20 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.2091, average loss: 1.2843
[09/29 13:51:20 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 61.77	
[09/29 13:51:20 visual_prompt]: Training 80 / 100 epoch, with learning rate 3.2106896815325707
[09/29 13:57:49 visual_prompt]: Epoch 80 / 100: avg data time: 1.06e+01, avg batch time: 11.0945, average train loss: 0.8709
[09/29 13:58:34 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2248, average loss: 0.7034
[09/29 13:58:34 visual_prompt]: Classification results with val_mammo-cbis: top1: 57.72	rocauc: 62.26	
[09/29 13:58:34 visual_prompt]: Training 81 / 100 epoch, with learning rate 2.924444461012776
[09/29 14:05:03 visual_prompt]: Epoch 81 / 100: avg data time: 1.06e+01, avg batch time: 11.1150, average train loss: 0.8938
[09/29 14:05:49 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.1925, average loss: 1.0012
[09/29 14:05:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 62.79	
[09/29 14:05:49 visual_prompt]: Training 82 / 100 epoch, with learning rate 2.6498655799159763
[09/29 14:12:18 visual_prompt]: Epoch 82 / 100: avg data time: 1.06e+01, avg batch time: 11.1252, average train loss: 0.8245
[09/29 14:13:04 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2837, average loss: 0.7696
[09/29 14:13:04 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.10	rocauc: 62.63	
[09/29 14:13:04 visual_prompt]: Training 83 / 100 epoch, with learning rate 2.387287570313158
[09/29 14:19:33 visual_prompt]: Epoch 83 / 100: avg data time: 1.06e+01, avg batch time: 11.1056, average train loss: 0.7951
[09/29 14:20:18 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.2054, average loss: 0.6759
[09/29 14:20:18 visual_prompt]: Classification results with val_mammo-cbis: top1: 58.54	rocauc: 63.07	
[09/29 14:20:18 visual_prompt]: Training 84 / 100 epoch, with learning rate 2.13703034306198
[09/29 14:26:48 visual_prompt]: Epoch 84 / 100: avg data time: 1.07e+01, avg batch time: 11.1238, average train loss: 0.7646
[09/29 14:27:33 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2297, average loss: 1.1911
[09/29 14:27:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 63.25	
[09/29 14:27:33 visual_prompt]: Training 85 / 100 epoch, with learning rate 1.8993987980446756
[09/29 14:34:02 visual_prompt]: Epoch 85 / 100: avg data time: 1.06e+01, avg batch time: 11.0926, average train loss: 0.7537
[09/29 14:34:47 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.2103, average loss: 0.7616
[09/29 14:34:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.88	rocauc: 63.17	
[09/29 14:34:47 visual_prompt]: Training 86 / 100 epoch, with learning rate 1.674682452694516
[09/29 14:41:11 visual_prompt]: Epoch 86 / 100: avg data time: 1.05e+01, avg batch time: 10.9640, average train loss: 0.7126
[09/29 14:41:56 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.2736, average loss: 0.6664
[09/29 14:41:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 57.32	rocauc: 63.36	
[09/29 14:41:56 visual_prompt]: Training 87 / 100 epoch, with learning rate 1.4631550892634126
[09/29 14:48:20 visual_prompt]: Epoch 87 / 100: avg data time: 1.05e+01, avg batch time: 10.9689, average train loss: 0.7752
[09/29 14:49:05 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2519, average loss: 1.0492
[09/29 14:49:05 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 63.04	
[09/29 14:49:05 visual_prompt]: Training 88 / 100 epoch, with learning rate 1.2650744212604148
[09/29 14:55:29 visual_prompt]: Epoch 88 / 100: avg data time: 1.05e+01, avg batch time: 10.9662, average train loss: 0.7295
[09/29 14:56:14 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2281, average loss: 0.8416
[09/29 14:56:14 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 62.88	
[09/29 14:56:14 visual_prompt]: Training 89 / 100 epoch, with learning rate 1.0806817794674877
[09/29 15:02:39 visual_prompt]: Epoch 89 / 100: avg data time: 1.05e+01, avg batch time: 10.9993, average train loss: 0.7116
[09/29 15:03:24 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.2373, average loss: 0.6997
[09/29 15:03:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 57.72	rocauc: 62.64	
[09/29 15:03:24 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.9102018179151585
[09/29 15:09:48 visual_prompt]: Epoch 90 / 100: avg data time: 1.05e+01, avg batch time: 10.9639, average train loss: 0.7018
[09/29 15:10:32 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2130, average loss: 0.7484
[09/29 15:10:32 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.07	rocauc: 62.77	
[09/29 15:10:32 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.753842240176146
[09/29 15:16:56 visual_prompt]: Epoch 91 / 100: avg data time: 1.04e+01, avg batch time: 10.9421, average train loss: 0.6975
[09/29 15:17:41 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.2841, average loss: 1.0367
[09/29 15:17:41 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 62.63	
[09/29 15:17:41 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.6117935463105808
[09/29 15:24:04 visual_prompt]: Epoch 92 / 100: avg data time: 1.04e+01, avg batch time: 10.9370, average train loss: 0.7110
[09/29 15:24:48 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1940, average loss: 0.6676
[09/29 15:24:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 57.32	rocauc: 62.60	
[09/29 15:24:48 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.4842288007710138
[09/29 15:31:11 visual_prompt]: Epoch 93 / 100: avg data time: 1.05e+01, avg batch time: 10.9312, average train loss: 0.7041
[09/29 15:31:56 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2128, average loss: 0.8503
[09/29 15:31:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 62.72	
[09/29 15:31:56 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.3713034215500441
[09/29 15:38:18 visual_prompt]: Epoch 94 / 100: avg data time: 1.04e+01, avg batch time: 10.9240, average train loss: 0.6960
[09/29 15:39:03 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2122, average loss: 0.7599
[09/29 15:39:03 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 62.72	
[09/29 15:39:03 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.2731549908274289
[09/29 15:45:26 visual_prompt]: Epoch 95 / 100: avg data time: 1.05e+01, avg batch time: 10.9230, average train loss: 0.6861
[09/29 15:46:10 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2229, average loss: 0.7561
[09/29 15:46:10 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 62.70	
[09/29 15:46:10 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.18990308734739975
[09/29 15:52:34 visual_prompt]: Epoch 96 / 100: avg data time: 1.04e+01, avg batch time: 10.9488, average train loss: 0.6802
[09/29 15:53:19 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2799, average loss: 0.6974
[09/29 15:53:19 visual_prompt]: Classification results with val_mammo-cbis: top1: 58.54	rocauc: 62.77	
[09/29 15:53:19 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.12164914073037048
[09/29 15:59:44 visual_prompt]: Epoch 97 / 100: avg data time: 1.05e+01, avg batch time: 10.9999, average train loss: 0.6894
[09/29 16:00:29 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.1978, average loss: 0.7957
[09/29 16:00:29 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 62.76	
[09/29 16:00:29 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.06847630789658388
[09/29 16:06:52 visual_prompt]: Epoch 98 / 100: avg data time: 1.05e+01, avg batch time: 10.9475, average train loss: 0.6818
[09/29 16:07:37 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.2335, average loss: 0.7611
[09/29 16:07:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 62.78	
[09/29 16:07:37 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.03044937175219753
[09/29 16:14:01 visual_prompt]: Epoch 99 / 100: avg data time: 1.05e+01, avg batch time: 10.9665, average train loss: 0.6890
[09/29 16:14:46 visual_prompt]: Inference (val):avg data time: 2.06e-05, avg batch time: 0.1961, average loss: 0.7649
[09/29 16:14:46 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 62.78	
[09/29 16:14:46 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0076146622613029735
[09/29 16:21:13 visual_prompt]: Epoch 100 / 100: avg data time: 1.06e+01, avg batch time: 11.0563, average train loss: 0.6885
[09/29 16:21:58 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2439, average loss: 0.7625
[09/29 16:21:58 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 62.79	
[09/29 16:21:58 visual_prompt]: Rank of current process: 0. World size: 1
[09/29 16:21:58 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              0
GPU 0                NVIDIA A100-PCIE-40GB
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/29 16:21:58 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'mammo-cbis', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/29 16:21:58 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/29 16:21:58 visual_prompt]: Training with config:
[09/29 16:21:58 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/mammo-cbis/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr10.0_wd0.01/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.01, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 10.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'mammo-cbis', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/29 16:21:58 visual_prompt]: Loading training data...
[09/29 16:21:58 visual_prompt]: Constructing mammo-cbis dataset train...
[09/29 16:21:59 visual_prompt]: Loading validation data...
[09/29 16:21:59 visual_prompt]: Constructing mammo-cbis dataset val...
[09/29 16:21:59 visual_prompt]: Constructing models...
[09/29 16:22:01 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/29 16:22:01 visual_prompt]: tuned percent:0.536
[09/29 16:22:01 visual_prompt]: Device used for model: 0
[09/29 16:22:01 visual_prompt]: Setting up Evaluator...
[09/29 16:22:01 visual_prompt]: Setting up Trainer...
[09/29 16:22:01 visual_prompt]: 	Setting up the optimizer...
[09/29 16:22:01 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/29 16:28:28 visual_prompt]: Epoch 1 / 100: avg data time: 1.06e+01, avg batch time: 11.0397, average train loss: 1.4903
[09/29 16:29:13 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.2231, average loss: 1.4710
[09/29 16:29:13 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.15	
[09/29 16:29:13 visual_prompt]: Best epoch 1: best metric: 0.537
[09/29 16:29:13 visual_prompt]: Training 2 / 100 epoch, with learning rate 1.0
[09/29 16:35:42 visual_prompt]: Epoch 2 / 100: avg data time: 1.06e+01, avg batch time: 11.0948, average train loss: 10.4816
[09/29 16:36:27 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2307, average loss: 1.8211
[09/29 16:36:27 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 41.44	
[09/29 16:36:27 visual_prompt]: Training 3 / 100 epoch, with learning rate 2.0
[09/29 16:42:52 visual_prompt]: Epoch 3 / 100: avg data time: 1.05e+01, avg batch time: 10.9987, average train loss: 1.4592
[09/29 16:43:37 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2593, average loss: 0.9764
[09/29 16:43:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.47	
[09/29 16:43:37 visual_prompt]: Training 4 / 100 epoch, with learning rate 3.0
[09/29 16:50:03 visual_prompt]: Epoch 4 / 100: avg data time: 1.05e+01, avg batch time: 11.0034, average train loss: 4.4051
[09/29 16:50:48 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.2331, average loss: 1.9315
[09/29 16:50:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 45.35	
[09/29 16:50:48 visual_prompt]: Training 5 / 100 epoch, with learning rate 4.0
[09/29 16:57:15 visual_prompt]: Epoch 5 / 100: avg data time: 1.06e+01, avg batch time: 11.0437, average train loss: 5.5460
[09/29 16:58:00 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2609, average loss: 12.4164
[09/29 16:58:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 59.65	
[09/29 16:58:00 visual_prompt]: Training 6 / 100 epoch, with learning rate 5.0
[09/29 17:04:28 visual_prompt]: Epoch 6 / 100: avg data time: 1.06e+01, avg batch time: 11.0741, average train loss: 10.1098
[09/29 17:05:13 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2048, average loss: 18.1172
[09/29 17:05:13 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 45.12	
[09/29 17:05:13 visual_prompt]: Training 7 / 100 epoch, with learning rate 6.0
[09/29 17:11:40 visual_prompt]: Epoch 7 / 100: avg data time: 1.06e+01, avg batch time: 11.0507, average train loss: 12.6344
[09/29 17:12:25 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.2428, average loss: 8.1977
[09/29 17:12:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.91	
[09/29 17:12:25 visual_prompt]: Training 8 / 100 epoch, with learning rate 7.0
[09/29 17:18:52 visual_prompt]: Epoch 8 / 100: avg data time: 1.06e+01, avg batch time: 11.0542, average train loss: 13.9856
[09/29 17:19:38 visual_prompt]: Inference (val):avg data time: 2.23e-05, avg batch time: 0.2871, average loss: 15.1068
[09/29 17:19:38 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 41.84	
[09/29 17:19:38 visual_prompt]: Training 9 / 100 epoch, with learning rate 8.0
[09/29 17:26:06 visual_prompt]: Epoch 9 / 100: avg data time: 1.06e+01, avg batch time: 11.0801, average train loss: 13.4366
[09/29 17:26:51 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.2236, average loss: 10.4254
[09/29 17:26:51 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 40.80	
[09/29 17:26:51 visual_prompt]: Training 10 / 100 epoch, with learning rate 9.0
[09/29 17:33:17 visual_prompt]: Epoch 10 / 100: avg data time: 1.05e+01, avg batch time: 11.0348, average train loss: 17.6286
[09/29 17:34:03 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.2416, average loss: 4.5287
[09/29 17:34:03 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 40.42	
[09/29 17:34:03 visual_prompt]: Training 11 / 100 epoch, with learning rate 10.0
[09/29 17:40:30 visual_prompt]: Epoch 11 / 100: avg data time: 1.06e+01, avg batch time: 11.0725, average train loss: 23.3186
[09/29 17:41:16 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.2101, average loss: 0.8470
[09/29 17:41:16 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 46.21	
[09/29 17:41:16 visual_prompt]: Training 12 / 100 epoch, with learning rate 9.996954135095478
[09/29 17:47:41 visual_prompt]: Epoch 12 / 100: avg data time: 1.05e+01, avg batch time: 11.0038, average train loss: 23.9741
[09/29 17:48:26 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.1997, average loss: 121.1556
[09/29 17:48:26 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.55	
[09/29 17:48:26 visual_prompt]: Training 13 / 100 epoch, with learning rate 9.987820251299121
[09/29 17:54:53 visual_prompt]: Epoch 13 / 100: avg data time: 1.06e+01, avg batch time: 11.0544, average train loss: 20.8818
[09/29 17:55:39 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.2299, average loss: 2.5412
[09/29 17:55:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.69	
[09/29 17:55:39 visual_prompt]: Training 14 / 100 epoch, with learning rate 9.972609476841367
[09/29 18:02:05 visual_prompt]: Epoch 14 / 100: avg data time: 1.06e+01, avg batch time: 11.0379, average train loss: 20.4080
[09/29 18:02:51 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.2953, average loss: 29.2571
[09/29 18:02:51 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 46.46	
[09/29 18:02:51 visual_prompt]: Training 15 / 100 epoch, with learning rate 9.951340343707852
[09/29 18:09:16 visual_prompt]: Epoch 15 / 100: avg data time: 1.05e+01, avg batch time: 11.0152, average train loss: 27.5028
[09/29 18:10:01 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.2081, average loss: 3.3380
[09/29 18:10:01 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.23	
[09/29 18:10:01 visual_prompt]: Training 16 / 100 epoch, with learning rate 9.924038765061042
[09/29 18:16:27 visual_prompt]: Epoch 16 / 100: avg data time: 1.05e+01, avg batch time: 11.0204, average train loss: 34.6196
[09/29 18:17:13 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.2427, average loss: 13.5363
[09/29 18:17:13 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.06	
[09/29 18:17:13 visual_prompt]: Training 17 / 100 epoch, with learning rate 9.890738003669028
[09/29 18:23:39 visual_prompt]: Epoch 17 / 100: avg data time: 1.05e+01, avg batch time: 11.0368, average train loss: 27.7704
[09/29 18:24:24 visual_prompt]: Inference (val):avg data time: 2.70e-05, avg batch time: 0.2099, average loss: 42.4506
[09/29 18:24:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 48.18	
[09/29 18:24:24 visual_prompt]: Training 18 / 100 epoch, with learning rate 9.851478631379981
[09/29 18:30:52 visual_prompt]: Epoch 18 / 100: avg data time: 1.06e+01, avg batch time: 11.0769, average train loss: 25.4903
[09/29 18:31:38 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.2318, average loss: 94.6035
[09/29 18:31:38 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.22	
[09/29 18:31:38 visual_prompt]: Training 19 / 100 epoch, with learning rate 9.806308479691594
[09/29 18:38:03 visual_prompt]: Epoch 19 / 100: avg data time: 1.05e+01, avg batch time: 11.0058, average train loss: 26.8606
[09/29 18:38:48 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2152, average loss: 57.2656
[09/29 18:38:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 42.29	
[09/29 18:38:48 visual_prompt]: Training 20 / 100 epoch, with learning rate 9.755282581475768
[09/29 18:45:13 visual_prompt]: Epoch 20 / 100: avg data time: 1.05e+01, avg batch time: 10.9949, average train loss: 25.2034
[09/29 18:45:59 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.2143, average loss: 12.2221
[09/29 18:45:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 45.62	
[09/29 18:45:59 visual_prompt]: Training 21 / 100 epoch, with learning rate 9.698463103929543
[09/29 18:52:25 visual_prompt]: Epoch 21 / 100: avg data time: 1.06e+01, avg batch time: 11.0414, average train loss: 17.6408
[09/29 18:53:11 visual_prompt]: Inference (val):avg data time: 2.20e-05, avg batch time: 0.2431, average loss: 15.5488
[09/29 18:53:11 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 46.84	
[09/29 18:53:11 visual_prompt]: Training 22 / 100 epoch, with learning rate 9.635919272833938
[09/29 18:59:37 visual_prompt]: Epoch 22 / 100: avg data time: 1.05e+01, avg batch time: 11.0301, average train loss: 25.5934
[09/29 19:00:22 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2149, average loss: 41.9795
[09/29 19:00:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.32	
[09/29 19:00:22 visual_prompt]: Training 23 / 100 epoch, with learning rate 9.567727288213003
[09/29 19:06:46 visual_prompt]: Epoch 23 / 100: avg data time: 1.05e+01, avg batch time: 10.9716, average train loss: 28.7690
[09/29 19:07:31 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2157, average loss: 19.1060
[09/29 19:07:31 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.55	
[09/29 19:07:31 visual_prompt]: Training 24 / 100 epoch, with learning rate 9.493970231495835
[09/29 19:13:58 visual_prompt]: Epoch 24 / 100: avg data time: 1.06e+01, avg batch time: 11.0510, average train loss: 21.0452
[09/29 19:14:43 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.2334, average loss: 21.2794
[09/29 19:14:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.92	
[09/29 19:14:43 visual_prompt]: Training 25 / 100 epoch, with learning rate 9.414737964294634
[09/29 19:21:11 visual_prompt]: Epoch 25 / 100: avg data time: 1.06e+01, avg batch time: 11.0631, average train loss: 15.7024
[09/29 19:21:56 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.2349, average loss: 49.0955
[09/29 19:21:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.93	
[09/29 19:21:56 visual_prompt]: Training 26 / 100 epoch, with learning rate 9.330127018922195
[09/29 19:28:22 visual_prompt]: Epoch 26 / 100: avg data time: 1.06e+01, avg batch time: 11.0421, average train loss: 20.3613
[09/29 19:29:07 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1963, average loss: 13.7725
[09/29 19:29:07 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.48	
[09/29 19:29:07 visual_prompt]: Training 27 / 100 epoch, with learning rate 9.240240480782129
[09/29 19:35:34 visual_prompt]: Epoch 27 / 100: avg data time: 1.06e+01, avg batch time: 11.0322, average train loss: 24.4178
[09/29 19:36:19 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2605, average loss: 32.9668
[09/29 19:36:19 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.62	
[09/29 19:36:19 visual_prompt]: Training 28 / 100 epoch, with learning rate 9.145187862775208
[09/29 19:42:46 visual_prompt]: Epoch 28 / 100: avg data time: 1.06e+01, avg batch time: 11.0466, average train loss: 15.9531
[09/29 19:43:31 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2327, average loss: 1.5627
[09/29 19:43:31 visual_prompt]: Classification results with val_mammo-cbis: top1: 43.90	rocauc: 43.97	
[09/29 19:43:31 visual_prompt]: Training 29 / 100 epoch, with learning rate 9.045084971874736
[09/29 19:49:59 visual_prompt]: Epoch 29 / 100: avg data time: 1.06e+01, avg batch time: 11.0689, average train loss: 19.8668
[09/29 19:50:44 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2117, average loss: 4.0413
[09/29 19:50:44 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.37	
[09/29 19:50:44 visual_prompt]: Training 30 / 100 epoch, with learning rate 8.940053768033609
[09/29 19:57:13 visual_prompt]: Epoch 30 / 100: avg data time: 1.06e+01, avg batch time: 11.1067, average train loss: 14.1112
[09/29 19:57:59 visual_prompt]: Inference (val):avg data time: 2.61e-05, avg batch time: 0.2061, average loss: 4.7550
[09/29 19:57:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.68	
[09/29 19:57:59 visual_prompt]: Training 31 / 100 epoch, with learning rate 8.83022221559489
[09/29 20:04:26 visual_prompt]: Epoch 31 / 100: avg data time: 1.06e+01, avg batch time: 11.0644, average train loss: 17.1846
[09/29 20:05:11 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.2117, average loss: 23.1989
[09/29 20:05:11 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 60.88	
[09/29 20:05:11 visual_prompt]: Training 32 / 100 epoch, with learning rate 8.715724127386972
[09/29 20:11:38 visual_prompt]: Epoch 32 / 100: avg data time: 1.06e+01, avg batch time: 11.0267, average train loss: 19.3604
[09/29 20:12:23 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.2046, average loss: 19.9257
[09/29 20:12:23 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.04	
[09/29 20:12:23 visual_prompt]: Training 33 / 100 epoch, with learning rate 8.596699001693256
[09/29 20:18:49 visual_prompt]: Epoch 33 / 100: avg data time: 1.06e+01, avg batch time: 11.0357, average train loss: 18.4102
[09/29 20:19:34 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.2249, average loss: 23.3556
[09/29 20:19:34 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 48.86	
[09/29 20:19:34 visual_prompt]: Training 34 / 100 epoch, with learning rate 8.473291852294986
[09/29 20:26:02 visual_prompt]: Epoch 34 / 100: avg data time: 1.06e+01, avg batch time: 11.0671, average train loss: 19.2684
[09/29 20:26:47 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2364, average loss: 33.0766
[09/29 20:26:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.40	
[09/29 20:26:47 visual_prompt]: Training 35 / 100 epoch, with learning rate 8.345653031794292
[09/29 20:33:14 visual_prompt]: Epoch 35 / 100: avg data time: 1.06e+01, avg batch time: 11.0327, average train loss: 16.9727
[09/29 20:33:59 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2238, average loss: 19.2818
[09/29 20:33:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 40.38	
[09/29 20:33:59 visual_prompt]: Training 36 / 100 epoch, with learning rate 8.213938048432697
[09/29 20:40:25 visual_prompt]: Epoch 36 / 100: avg data time: 1.06e+01, avg batch time: 11.0392, average train loss: 18.5012
[09/29 20:41:11 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2188, average loss: 9.9038
[09/29 20:41:11 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 44.72	
[09/29 20:41:11 visual_prompt]: Training 37 / 100 epoch, with learning rate 8.078307376628292
[09/29 20:47:37 visual_prompt]: Epoch 37 / 100: avg data time: 1.05e+01, avg batch time: 11.0111, average train loss: 18.2781
[09/29 20:48:22 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.2756, average loss: 10.5119
[09/29 20:48:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 61.54	
[09/29 20:48:22 visual_prompt]: Training 38 / 100 epoch, with learning rate 7.938926261462366
[09/29 20:54:48 visual_prompt]: Epoch 38 / 100: avg data time: 1.05e+01, avg batch time: 11.0133, average train loss: 14.6480
[09/29 20:55:33 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.2995, average loss: 0.9654
[09/29 20:55:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.05	
[09/29 20:55:33 visual_prompt]: Training 39 / 100 epoch, with learning rate 7.795964517353734
[09/29 21:02:00 visual_prompt]: Epoch 39 / 100: avg data time: 1.06e+01, avg batch time: 11.0517, average train loss: 23.0892
[09/29 21:02:45 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.2051, average loss: 15.2528
[09/29 21:02:45 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 40.71	
[09/29 21:02:45 visual_prompt]: Training 40 / 100 epoch, with learning rate 7.649596321166024
[09/29 21:09:11 visual_prompt]: Epoch 40 / 100: avg data time: 1.05e+01, avg batch time: 11.0020, average train loss: 18.5623
[09/29 21:09:56 visual_prompt]: Inference (val):avg data time: 2.90e-05, avg batch time: 0.2143, average loss: 18.5994
[09/29 21:09:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 46.27	
[09/29 21:09:56 visual_prompt]: Training 41 / 100 epoch, with learning rate 7.5
[09/29 21:16:22 visual_prompt]: Epoch 41 / 100: avg data time: 1.06e+01, avg batch time: 11.0447, average train loss: 15.8444
[09/29 21:17:08 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2349, average loss: 19.5978
[09/29 21:17:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.89	
[09/29 21:17:08 visual_prompt]: Training 42 / 100 epoch, with learning rate 7.347357813929454
[09/29 21:23:33 visual_prompt]: Epoch 42 / 100: avg data time: 1.05e+01, avg batch time: 11.0046, average train loss: 13.9640
[09/29 21:24:18 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.2595, average loss: 19.3939
[09/29 21:24:18 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.54	
[09/29 21:24:18 visual_prompt]: Training 43 / 100 epoch, with learning rate 7.191855733945387
[09/29 21:30:43 visual_prompt]: Epoch 43 / 100: avg data time: 1.05e+01, avg batch time: 10.9990, average train loss: 12.6791
[09/29 21:31:29 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.2239, average loss: 55.3718
[09/29 21:31:29 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 40.84	
[09/29 21:31:29 visual_prompt]: Training 44 / 100 epoch, with learning rate 7.033683215379002
[09/29 21:37:54 visual_prompt]: Epoch 44 / 100: avg data time: 1.05e+01, avg batch time: 11.0067, average train loss: 14.3067
[09/29 21:38:39 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.2366, average loss: 17.0274
[09/29 21:38:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 40.80	
[09/29 21:38:39 visual_prompt]: Training 45 / 100 epoch, with learning rate 6.873032967079561
[09/29 21:45:06 visual_prompt]: Epoch 45 / 100: avg data time: 1.06e+01, avg batch time: 11.0552, average train loss: 15.5244
[09/29 21:45:51 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2088, average loss: 11.5891
[09/29 21:45:51 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.37	
[09/29 21:45:51 visual_prompt]: Training 46 / 100 epoch, with learning rate 6.710100716628345
[09/29 21:52:18 visual_prompt]: Epoch 46 / 100: avg data time: 1.06e+01, avg batch time: 11.0424, average train loss: 18.0223
[09/29 21:53:03 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2100, average loss: 27.8192
[09/29 21:53:03 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 59.54	
[09/29 21:53:03 visual_prompt]: Training 47 / 100 epoch, with learning rate 6.545084971874737
[09/29 21:59:29 visual_prompt]: Epoch 47 / 100: avg data time: 1.05e+01, avg batch time: 11.0155, average train loss: 17.8804
[09/29 22:00:14 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.2133, average loss: 37.8699
[09/29 22:00:14 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 47.69	
[09/29 22:00:14 visual_prompt]: Training 48 / 100 epoch, with learning rate 6.378186779084995
[09/29 22:06:41 visual_prompt]: Epoch 48 / 100: avg data time: 1.06e+01, avg batch time: 11.0496, average train loss: 15.6419
[09/29 22:07:26 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.2315, average loss: 7.7685
[09/29 22:07:26 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 42.92	
[09/29 22:07:26 visual_prompt]: Training 49 / 100 epoch, with learning rate 6.209609477998338
[09/29 22:13:54 visual_prompt]: Epoch 49 / 100: avg data time: 1.06e+01, avg batch time: 11.0610, average train loss: 13.3828
[09/29 22:14:39 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2317, average loss: 7.6211
[09/29 22:14:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 60.83	
[09/29 22:14:39 visual_prompt]: Training 50 / 100 epoch, with learning rate 6.039558454088796
[09/29 22:21:05 visual_prompt]: Epoch 50 / 100: avg data time: 1.06e+01, avg batch time: 11.0254, average train loss: 11.8191
[09/29 22:21:50 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2422, average loss: 12.7244
[09/29 22:21:50 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 47.38	
[09/29 22:21:50 visual_prompt]: Training 51 / 100 epoch, with learning rate 5.868240888334652
[09/29 22:28:16 visual_prompt]: Epoch 51 / 100: avg data time: 1.06e+01, avg batch time: 11.0297, average train loss: 12.9137
[09/29 22:29:02 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.2328, average loss: 12.2754
[09/29 22:29:02 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 61.92	
[09/29 22:29:02 visual_prompt]: Training 52 / 100 epoch, with learning rate 5.695865504800327
[09/29 22:35:29 visual_prompt]: Epoch 52 / 100: avg data time: 1.06e+01, avg batch time: 11.0701, average train loss: 14.2333
[09/29 22:36:14 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.2211, average loss: 11.1628
[09/29 22:36:14 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.67	
[09/29 22:36:14 visual_prompt]: Training 53 / 100 epoch, with learning rate 5.522642316338268
[09/29 22:42:42 visual_prompt]: Epoch 53 / 100: avg data time: 1.06e+01, avg batch time: 11.0606, average train loss: 11.8676
[09/29 22:43:27 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2166, average loss: 39.5910
[09/29 22:43:27 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 47.35	
[09/29 22:43:27 visual_prompt]: Training 54 / 100 epoch, with learning rate 5.3487823687206255
[09/29 22:49:53 visual_prompt]: Epoch 54 / 100: avg data time: 1.06e+01, avg batch time: 11.0322, average train loss: 12.8915
[09/29 22:50:39 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2850, average loss: 11.1225
[09/29 22:50:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 44.23	
[09/29 22:50:39 visual_prompt]: Training 55 / 100 epoch, with learning rate 5.174497483512505
[09/29 22:57:05 visual_prompt]: Epoch 55 / 100: avg data time: 1.05e+01, avg batch time: 11.0301, average train loss: 7.9007
[09/29 22:57:50 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.2294, average loss: 10.2085
[09/29 22:57:50 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 43.30	
[09/29 22:57:50 visual_prompt]: Training 56 / 100 epoch, with learning rate 5.0
[09/29 23:04:16 visual_prompt]: Epoch 56 / 100: avg data time: 1.06e+01, avg batch time: 11.0341, average train loss: 10.5688
[09/29 23:05:01 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.2224, average loss: 9.3255
[09/29 23:05:01 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 38.88	
[09/29 23:05:01 visual_prompt]: Training 57 / 100 epoch, with learning rate 4.8255025164874965
[09/29 23:11:29 visual_prompt]: Epoch 57 / 100: avg data time: 1.06e+01, avg batch time: 11.0568, average train loss: 6.8389
[09/29 23:12:14 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.2154, average loss: 13.8265
[09/29 23:12:14 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 43.44	
[09/29 23:12:14 visual_prompt]: Training 58 / 100 epoch, with learning rate 4.651217631279374
[09/29 23:18:42 visual_prompt]: Epoch 58 / 100: avg data time: 1.06e+01, avg batch time: 11.0869, average train loss: 6.8361
[09/29 23:19:28 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2330, average loss: 14.5368
[09/29 23:19:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 60.50	
[09/29 23:19:28 visual_prompt]: Training 59 / 100 epoch, with learning rate 4.477357683661733
[09/29 23:25:53 visual_prompt]: Epoch 59 / 100: avg data time: 1.06e+01, avg batch time: 11.0151, average train loss: 11.1053
[09/29 23:26:39 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.2310, average loss: 5.2212
[09/29 23:26:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 44.37	
[09/29 23:26:39 visual_prompt]: Training 60 / 100 epoch, with learning rate 4.3041344951996745
[09/29 23:33:05 visual_prompt]: Epoch 60 / 100: avg data time: 1.06e+01, avg batch time: 11.0344, average train loss: 8.0299
[09/29 23:33:50 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2256, average loss: 7.4970
[09/29 23:33:50 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 42.76	
[09/29 23:33:50 visual_prompt]: Training 61 / 100 epoch, with learning rate 4.131759111665349
[09/29 23:40:18 visual_prompt]: Epoch 61 / 100: avg data time: 1.06e+01, avg batch time: 11.0704, average train loss: 8.0831
[09/29 23:41:03 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.2334, average loss: 13.9604
[09/29 23:41:03 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 47.92	
[09/29 23:41:03 visual_prompt]: Training 62 / 100 epoch, with learning rate 3.960441545911204
[09/29 23:47:30 visual_prompt]: Epoch 62 / 100: avg data time: 1.06e+01, avg batch time: 11.0535, average train loss: 7.5852
[09/29 23:48:15 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.2104, average loss: 2.7119
[09/29 23:48:16 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 59.68	
[09/29 23:48:16 visual_prompt]: Training 63 / 100 epoch, with learning rate 3.790390522001662
[09/29 23:54:43 visual_prompt]: Epoch 63 / 100: avg data time: 1.06e+01, avg batch time: 11.0518, average train loss: 6.0269
[09/29 23:55:28 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.2238, average loss: 3.3938
[09/29 23:55:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 46.64	
[09/29 23:55:28 visual_prompt]: Training 64 / 100 epoch, with learning rate 3.6218132209150045
[09/30 00:01:54 visual_prompt]: Epoch 64 / 100: avg data time: 1.06e+01, avg batch time: 11.0346, average train loss: 5.6173
[09/30 00:02:39 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2130, average loss: 2.1085
[09/30 00:02:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.86	
[09/30 00:02:39 visual_prompt]: Training 65 / 100 epoch, with learning rate 3.454915028125263
[09/30 00:09:07 visual_prompt]: Epoch 65 / 100: avg data time: 1.06e+01, avg batch time: 11.0565, average train loss: 5.9375
[09/30 00:09:52 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.2352, average loss: 0.7203
[09/30 00:09:52 visual_prompt]: Classification results with val_mammo-cbis: top1: 52.44	rocauc: 50.44	
[09/30 00:09:52 visual_prompt]: Training 66 / 100 epoch, with learning rate 3.289899283371657
[09/30 00:16:21 visual_prompt]: Epoch 66 / 100: avg data time: 1.06e+01, avg batch time: 11.0944, average train loss: 5.1822
[09/30 00:17:06 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.2188, average loss: 3.0304
[09/30 00:17:06 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.53	
[09/30 00:17:06 visual_prompt]: Training 67 / 100 epoch, with learning rate 3.1269670329204398
[09/30 00:23:33 visual_prompt]: Epoch 67 / 100: avg data time: 1.06e+01, avg batch time: 11.0435, average train loss: 6.3551
[09/30 00:24:18 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.2355, average loss: 4.5592
[09/30 00:24:18 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.53	
[09/30 00:24:18 visual_prompt]: Training 68 / 100 epoch, with learning rate 2.9663167846209997
[09/30 00:30:44 visual_prompt]: Epoch 68 / 100: avg data time: 1.06e+01, avg batch time: 11.0315, average train loss: 4.9615
[09/30 00:31:29 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.2213, average loss: 8.1000
[09/30 00:31:29 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 45.47	
[09/30 00:31:29 visual_prompt]: Training 69 / 100 epoch, with learning rate 2.8081442660546125
[09/30 00:37:56 visual_prompt]: Epoch 69 / 100: avg data time: 1.06e+01, avg batch time: 11.0314, average train loss: 5.3752
[09/30 00:38:41 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2339, average loss: 3.3243
[09/30 00:38:41 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 46.49	
[09/30 00:38:41 visual_prompt]: Training 70 / 100 epoch, with learning rate 2.6526421860705476
[09/30 00:45:07 visual_prompt]: Epoch 70 / 100: avg data time: 1.06e+01, avg batch time: 11.0330, average train loss: 5.4375
[09/30 00:45:52 visual_prompt]: Inference (val):avg data time: 2.12e-05, avg batch time: 0.2292, average loss: 0.8095
[09/30 00:45:52 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.67	
[09/30 00:45:52 visual_prompt]: Training 71 / 100 epoch, with learning rate 2.500000000000001
[09/30 00:52:21 visual_prompt]: Epoch 71 / 100: avg data time: 1.06e+01, avg batch time: 11.0937, average train loss: 5.3524
[09/30 00:53:06 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2654, average loss: 7.2823
[09/30 00:53:06 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 46.21	
[09/30 00:53:06 visual_prompt]: Training 72 / 100 epoch, with learning rate 2.350403678833976
[09/30 00:59:34 visual_prompt]: Epoch 72 / 100: avg data time: 1.06e+01, avg batch time: 11.0687, average train loss: 5.0623
[09/30 01:00:19 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.2393, average loss: 1.8592
[09/30 01:00:19 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 45.40	
[09/30 01:00:19 visual_prompt]: Training 73 / 100 epoch, with learning rate 2.2040354826462667
[09/30 01:06:47 visual_prompt]: Epoch 73 / 100: avg data time: 1.06e+01, avg batch time: 11.0599, average train loss: 2.1977
[09/30 01:07:32 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.2229, average loss: 0.8231
[09/30 01:07:32 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.36	
[09/30 01:07:32 visual_prompt]: Training 74 / 100 epoch, with learning rate 2.061073738537635
[09/30 01:14:00 visual_prompt]: Epoch 74 / 100: avg data time: 1.06e+01, avg batch time: 11.0787, average train loss: 4.9661
[09/30 01:14:45 visual_prompt]: Inference (val):avg data time: 2.72e-05, avg batch time: 0.2146, average loss: 8.3129
[09/30 01:14:45 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 43.00	
[09/30 01:14:45 visual_prompt]: Training 75 / 100 epoch, with learning rate 1.9216926233717087
[09/30 01:21:13 visual_prompt]: Epoch 75 / 100: avg data time: 1.06e+01, avg batch time: 11.0755, average train loss: 2.1172
[09/30 01:21:58 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.2308, average loss: 1.4353
[09/30 01:21:58 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 44.47	
[09/30 01:21:58 visual_prompt]: Training 76 / 100 epoch, with learning rate 1.7860619515673033
[09/30 01:28:25 visual_prompt]: Epoch 76 / 100: avg data time: 1.06e+01, avg batch time: 11.0311, average train loss: 1.9824
[09/30 01:29:10 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.2578, average loss: 2.6725
[09/30 01:29:10 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 62.05	
[09/30 01:29:10 visual_prompt]: Training 77 / 100 epoch, with learning rate 1.6543469682057106
[09/30 01:35:36 visual_prompt]: Epoch 77 / 100: avg data time: 1.06e+01, avg batch time: 11.0375, average train loss: 3.4782
[09/30 01:36:22 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.2217, average loss: 12.8090
[09/30 01:36:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.33	
[09/30 01:36:22 visual_prompt]: Training 78 / 100 epoch, with learning rate 1.5267081477050133
[09/30 01:42:48 visual_prompt]: Epoch 78 / 100: avg data time: 1.06e+01, avg batch time: 11.0275, average train loss: 2.8775
[09/30 01:43:33 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.2209, average loss: 1.8248
[09/30 01:43:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.94	
[09/30 01:43:33 visual_prompt]: Training 79 / 100 epoch, with learning rate 1.403300998306745
[09/30 01:49:59 visual_prompt]: Epoch 79 / 100: avg data time: 1.05e+01, avg batch time: 11.0255, average train loss: 1.1334
[09/30 01:50:44 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2297, average loss: 0.6927
[09/30 01:50:44 visual_prompt]: Classification results with val_mammo-cbis: top1: 49.19	rocauc: 62.59	
[09/30 01:50:44 visual_prompt]: Training 80 / 100 epoch, with learning rate 1.2842758726130281
[09/30 01:57:11 visual_prompt]: Epoch 80 / 100: avg data time: 1.06e+01, avg batch time: 11.0487, average train loss: 1.0767
[09/30 01:57:56 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2288, average loss: 0.6933
[09/30 01:57:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 39.31	
[09/30 01:57:56 visual_prompt]: Training 81 / 100 epoch, with learning rate 1.1697777844051105
[09/30 02:04:23 visual_prompt]: Epoch 81 / 100: avg data time: 1.06e+01, avg batch time: 11.0467, average train loss: 0.8406
[09/30 02:05:08 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2187, average loss: 1.2868
[09/30 02:05:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.99	
[09/30 02:05:08 visual_prompt]: Training 82 / 100 epoch, with learning rate 1.0599462319663906
[09/30 02:11:35 visual_prompt]: Epoch 82 / 100: avg data time: 1.06e+01, avg batch time: 11.0460, average train loss: 1.7877
[09/30 02:12:20 visual_prompt]: Inference (val):avg data time: 4.67e-05, avg batch time: 0.2150, average loss: 1.0119
[09/30 02:12:20 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.29	
[09/30 02:12:20 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.9549150281252633
[09/30 02:18:47 visual_prompt]: Epoch 83 / 100: avg data time: 1.06e+01, avg batch time: 11.0312, average train loss: 1.7789
[09/30 02:19:32 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2240, average loss: 0.7452
[09/30 02:19:32 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.59	
[09/30 02:19:32 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.8548121372247919
[09/30 02:25:58 visual_prompt]: Epoch 84 / 100: avg data time: 1.06e+01, avg batch time: 11.0328, average train loss: 0.9356
[09/30 02:26:43 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2138, average loss: 1.5133
[09/30 02:26:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 59.82	
[09/30 02:26:43 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.7597595192178702
[09/30 02:33:10 visual_prompt]: Epoch 85 / 100: avg data time: 1.06e+01, avg batch time: 11.0448, average train loss: 0.7727
[09/30 02:33:56 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2063, average loss: 0.7119
[09/30 02:33:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 48.54	
[09/30 02:33:56 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.6698729810778065
[09/30 02:40:23 visual_prompt]: Epoch 86 / 100: avg data time: 1.06e+01, avg batch time: 11.0585, average train loss: 0.7115
[09/30 02:41:08 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2357, average loss: 0.6947
[09/30 02:41:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 45.84	
[09/30 02:41:08 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.5852620357053651
[09/30 02:47:35 visual_prompt]: Epoch 87 / 100: avg data time: 1.06e+01, avg batch time: 11.0378, average train loss: 0.7395
[09/30 02:48:20 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2137, average loss: 0.7001
[09/30 02:48:20 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.93	
[09/30 02:48:20 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.5060297685041659
[09/30 02:54:47 visual_prompt]: Epoch 88 / 100: avg data time: 1.06e+01, avg batch time: 11.0358, average train loss: 0.7061
[09/30 02:55:32 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.2177, average loss: 0.7642
[09/30 02:55:32 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.56	
[09/30 02:55:32 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.4322727117869951
[09/30 03:02:00 visual_prompt]: Epoch 89 / 100: avg data time: 1.06e+01, avg batch time: 11.0726, average train loss: 0.7259
[09/30 03:02:45 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2279, average loss: 0.7737
[09/30 03:02:45 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 47.53	
[09/30 03:02:45 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.36408072716606343
[09/30 03:09:11 visual_prompt]: Epoch 90 / 100: avg data time: 1.06e+01, avg batch time: 11.0333, average train loss: 0.7117
[09/30 03:09:56 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2091, average loss: 0.6906
[09/30 03:09:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 47.32	
[09/30 03:09:56 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.3015368960704584
[09/30 03:16:23 visual_prompt]: Epoch 91 / 100: avg data time: 1.06e+01, avg batch time: 11.0495, average train loss: 0.7001
[09/30 03:17:08 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.2061, average loss: 0.7140
[09/30 03:17:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.82	
[09/30 03:17:08 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.24471741852423234
[09/30 03:23:35 visual_prompt]: Epoch 92 / 100: avg data time: 1.06e+01, avg batch time: 11.0411, average train loss: 0.7003
[09/30 03:24:20 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.2360, average loss: 0.7024
[09/30 03:24:20 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.26	
[09/30 03:24:20 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.19369152030840553
[09/30 03:30:46 visual_prompt]: Epoch 93 / 100: avg data time: 1.05e+01, avg batch time: 11.0217, average train loss: 0.7056
[09/30 03:31:32 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.2238, average loss: 0.6915
[09/30 03:31:32 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.61	
[09/30 03:31:32 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.14852136862001764
[09/30 03:37:58 visual_prompt]: Epoch 94 / 100: avg data time: 1.06e+01, avg batch time: 11.0311, average train loss: 0.6949
[09/30 03:38:43 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1945, average loss: 0.6950
[09/30 03:38:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.03	
[09/30 03:38:43 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.10926199633097156
[09/30 03:45:11 visual_prompt]: Epoch 95 / 100: avg data time: 1.06e+01, avg batch time: 11.0648, average train loss: 0.6960
[09/30 03:45:56 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.2286, average loss: 0.6904
[09/30 03:45:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.81	
[09/30 03:45:56 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.0759612349389599
[09/30 03:52:22 visual_prompt]: Epoch 96 / 100: avg data time: 1.06e+01, avg batch time: 11.0370, average train loss: 0.6924
[09/30 03:53:07 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2168, average loss: 0.6957
[09/30 03:53:07 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.89	
[09/30 03:53:07 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.04865965629214819
[09/30 03:59:34 visual_prompt]: Epoch 97 / 100: avg data time: 1.05e+01, avg batch time: 11.0380, average train loss: 0.6965
[09/30 04:00:19 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2820, average loss: 0.6964
[09/30 04:00:19 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 47.22	
[09/30 04:00:19 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.02739052315863355
[09/30 04:06:46 visual_prompt]: Epoch 98 / 100: avg data time: 1.06e+01, avg batch time: 11.0565, average train loss: 0.6908
[09/30 04:07:32 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.2176, average loss: 0.6905
[09/30 04:07:32 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.72	
[09/30 04:07:32 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.012179748700879012
[09/30 04:13:58 visual_prompt]: Epoch 99 / 100: avg data time: 1.06e+01, avg batch time: 11.0229, average train loss: 0.6911
[09/30 04:14:43 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2448, average loss: 0.6904
[09/30 04:14:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.95	
[09/30 04:14:43 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0030458649045211894
[09/30 04:21:09 visual_prompt]: Epoch 100 / 100: avg data time: 1.06e+01, avg batch time: 11.0367, average train loss: 0.6909
[09/30 04:21:55 visual_prompt]: Inference (val):avg data time: 2.20e-05, avg batch time: 0.1931, average loss: 0.6904
[09/30 04:21:55 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.16	
[09/30 04:21:55 visual_prompt]: Rank of current process: 0. World size: 1
[09/30 04:21:55 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              0
GPU 0                NVIDIA A100-PCIE-40GB
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/30 04:21:55 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'mammo-cbis', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/30 04:21:55 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/30 04:21:55 visual_prompt]: Training with config:
[09/30 04:21:55 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/mammo-cbis/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr10.0_wd0.001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 10.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'mammo-cbis', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/30 04:21:55 visual_prompt]: Loading training data...
[09/30 04:21:55 visual_prompt]: Constructing mammo-cbis dataset train...
[09/30 04:21:55 visual_prompt]: Loading validation data...
[09/30 04:21:55 visual_prompt]: Constructing mammo-cbis dataset val...
[09/30 04:21:55 visual_prompt]: Constructing models...
[09/30 04:21:57 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/30 04:21:57 visual_prompt]: tuned percent:0.536
[09/30 04:21:57 visual_prompt]: Device used for model: 0
[09/30 04:21:57 visual_prompt]: Setting up Evaluator...
[09/30 04:21:57 visual_prompt]: Setting up Trainer...
[09/30 04:21:57 visual_prompt]: 	Setting up the optimizer...
[09/30 04:21:57 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/30 04:28:25 visual_prompt]: Epoch 1 / 100: avg data time: 1.06e+01, avg batch time: 11.0625, average train loss: 1.4903
[09/30 04:29:10 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.2187, average loss: 1.4710
[09/30 04:29:10 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.15	
[09/30 04:29:10 visual_prompt]: Best epoch 1: best metric: 0.537
[09/30 04:29:10 visual_prompt]: Training 2 / 100 epoch, with learning rate 1.0
[09/30 04:35:38 visual_prompt]: Epoch 2 / 100: avg data time: 1.06e+01, avg batch time: 11.0730, average train loss: 14.3656
[09/30 04:36:24 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.2878, average loss: 2.8443
[09/30 04:36:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.78	
[09/30 04:36:24 visual_prompt]: Training 3 / 100 epoch, with learning rate 2.0
[09/30 04:42:51 visual_prompt]: Epoch 3 / 100: avg data time: 1.06e+01, avg batch time: 11.0679, average train loss: 3.2623
[09/30 04:43:37 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.2144, average loss: 3.7062
[09/30 04:43:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.94	
[09/30 04:43:37 visual_prompt]: Training 4 / 100 epoch, with learning rate 3.0
[09/30 04:50:05 visual_prompt]: Epoch 4 / 100: avg data time: 1.06e+01, avg batch time: 11.0767, average train loss: 4.0200
[09/30 04:50:50 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2238, average loss: 6.2414
[09/30 04:50:50 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 38.36	
[09/30 04:50:50 visual_prompt]: Training 5 / 100 epoch, with learning rate 4.0
[09/30 04:57:15 visual_prompt]: Epoch 5 / 100: avg data time: 1.06e+01, avg batch time: 11.0135, average train loss: 7.3607
[09/30 04:58:01 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.2048, average loss: 7.1549
[09/30 04:58:01 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.68	
[09/30 04:58:01 visual_prompt]: Training 6 / 100 epoch, with learning rate 5.0
[09/30 05:04:27 visual_prompt]: Epoch 6 / 100: avg data time: 1.06e+01, avg batch time: 11.0360, average train loss: 10.2879
[09/30 05:05:12 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2495, average loss: 22.1068
[09/30 05:05:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.01	
[09/30 05:05:12 visual_prompt]: Training 7 / 100 epoch, with learning rate 6.0
[09/30 05:11:39 visual_prompt]: Epoch 7 / 100: avg data time: 1.06e+01, avg batch time: 11.0481, average train loss: 10.7989
[09/30 05:12:25 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.2429, average loss: 14.6863
[09/30 05:12:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.33	
[09/30 05:12:25 visual_prompt]: Training 8 / 100 epoch, with learning rate 7.0
[09/30 05:18:52 visual_prompt]: Epoch 8 / 100: avg data time: 1.06e+01, avg batch time: 11.0516, average train loss: 10.8765
[09/30 05:19:37 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2107, average loss: 9.0449
[09/30 05:19:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 47.16	
[09/30 05:19:37 visual_prompt]: Training 9 / 100 epoch, with learning rate 8.0
[09/30 05:26:05 visual_prompt]: Epoch 9 / 100: avg data time: 1.06e+01, avg batch time: 11.0783, average train loss: 17.2093
[09/30 05:26:50 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2199, average loss: 10.7762
[09/30 05:26:50 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 41.29	
[09/30 05:26:50 visual_prompt]: Training 10 / 100 epoch, with learning rate 9.0
[09/30 05:33:19 visual_prompt]: Epoch 10 / 100: avg data time: 1.06e+01, avg batch time: 11.0957, average train loss: 15.9203
[09/30 05:34:04 visual_prompt]: Inference (val):avg data time: 3.57e-05, avg batch time: 0.1930, average loss: 8.6821
[09/30 05:34:04 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 48.23	
[09/30 05:34:04 visual_prompt]: Training 11 / 100 epoch, with learning rate 10.0
[09/30 05:40:30 visual_prompt]: Epoch 11 / 100: avg data time: 1.06e+01, avg batch time: 11.0335, average train loss: 19.4961
[09/30 05:41:15 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.2348, average loss: 110.4636
[09/30 05:41:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 45.08	
[09/30 05:41:15 visual_prompt]: Training 12 / 100 epoch, with learning rate 9.996954135095478
[09/30 05:47:43 visual_prompt]: Epoch 12 / 100: avg data time: 1.06e+01, avg batch time: 11.0586, average train loss: 31.5833
[09/30 05:48:28 visual_prompt]: Inference (val):avg data time: 2.75e-05, avg batch time: 0.2229, average loss: 45.8466
[09/30 05:48:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 47.77	
[09/30 05:48:28 visual_prompt]: Training 13 / 100 epoch, with learning rate 9.987820251299121
[09/30 05:54:55 visual_prompt]: Epoch 13 / 100: avg data time: 1.06e+01, avg batch time: 11.0369, average train loss: 30.1329
[09/30 05:55:40 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2367, average loss: 14.2119
[09/30 05:55:40 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 39.53	
[09/30 05:55:40 visual_prompt]: Training 14 / 100 epoch, with learning rate 9.972609476841367
[09/30 06:02:06 visual_prompt]: Epoch 14 / 100: avg data time: 1.06e+01, avg batch time: 11.0316, average train loss: 12.3854
[09/30 06:02:52 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.2127, average loss: 2.6200
[09/30 06:02:52 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.11	
[09/30 06:02:52 visual_prompt]: Training 15 / 100 epoch, with learning rate 9.951340343707852
[09/30 06:09:18 visual_prompt]: Epoch 15 / 100: avg data time: 1.05e+01, avg batch time: 11.0320, average train loss: 15.6059
[09/30 06:10:03 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.2240, average loss: 3.8212
[09/30 06:10:03 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.93	
[09/30 06:10:03 visual_prompt]: Training 16 / 100 epoch, with learning rate 9.924038765061042
[09/30 06:16:30 visual_prompt]: Epoch 16 / 100: avg data time: 1.06e+01, avg batch time: 11.0358, average train loss: 16.8967
[09/30 06:17:15 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2078, average loss: 4.7757
[09/30 06:17:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.43	
[09/30 06:17:15 visual_prompt]: Training 17 / 100 epoch, with learning rate 9.890738003669028
[09/30 06:23:41 visual_prompt]: Epoch 17 / 100: avg data time: 1.06e+01, avg batch time: 11.0440, average train loss: 18.2726
[09/30 06:24:27 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2321, average loss: 9.5429
[09/30 06:24:27 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.22	
[09/30 06:24:27 visual_prompt]: Training 18 / 100 epoch, with learning rate 9.851478631379981
[09/30 06:30:54 visual_prompt]: Epoch 18 / 100: avg data time: 1.06e+01, avg batch time: 11.0577, average train loss: 13.9461
[09/30 06:31:39 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2381, average loss: 64.6426
[09/30 06:31:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 43.68	
[09/30 06:31:39 visual_prompt]: Training 19 / 100 epoch, with learning rate 9.806308479691594
[09/30 06:38:07 visual_prompt]: Epoch 19 / 100: avg data time: 1.06e+01, avg batch time: 11.0683, average train loss: 21.8895
[09/30 06:38:52 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.2679, average loss: 35.0426
[09/30 06:38:52 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 58.61	
[09/30 06:38:52 visual_prompt]: Training 20 / 100 epoch, with learning rate 9.755282581475768
[09/30 06:45:20 visual_prompt]: Epoch 20 / 100: avg data time: 1.06e+01, avg batch time: 11.0764, average train loss: 19.2948
[09/30 06:46:05 visual_prompt]: Inference (val):avg data time: 2.91e-05, avg batch time: 0.2191, average loss: 26.1816
[09/30 06:46:05 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.03	
[09/30 06:46:05 visual_prompt]: Training 21 / 100 epoch, with learning rate 9.698463103929543
[09/30 06:52:32 visual_prompt]: Epoch 21 / 100: avg data time: 1.06e+01, avg batch time: 11.0465, average train loss: 31.9703
[09/30 06:53:18 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.2086, average loss: 32.8908
[09/30 06:53:18 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 47.49	
[09/30 06:53:18 visual_prompt]: Training 22 / 100 epoch, with learning rate 9.635919272833938
[09/30 06:59:42 visual_prompt]: Epoch 22 / 100: avg data time: 1.05e+01, avg batch time: 10.9824, average train loss: 15.6995
[09/30 07:00:27 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.2196, average loss: 31.4197
[09/30 07:00:27 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.89	
[09/30 07:00:27 visual_prompt]: Training 23 / 100 epoch, with learning rate 9.567727288213003
[09/30 07:06:54 visual_prompt]: Epoch 23 / 100: avg data time: 1.06e+01, avg batch time: 11.0429, average train loss: 16.5244
[09/30 07:07:40 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2042, average loss: 26.2579
[09/30 07:07:40 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.27	
[09/30 07:07:40 visual_prompt]: Training 24 / 100 epoch, with learning rate 9.493970231495835
[09/30 07:14:08 visual_prompt]: Epoch 24 / 100: avg data time: 1.06e+01, avg batch time: 11.0829, average train loss: 28.9235
[09/30 07:14:53 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.2272, average loss: 20.5570
[09/30 07:14:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.99	
[09/30 07:14:53 visual_prompt]: Training 25 / 100 epoch, with learning rate 9.414737964294634
[09/30 07:21:21 visual_prompt]: Epoch 25 / 100: avg data time: 1.06e+01, avg batch time: 11.0782, average train loss: 21.8849
[09/30 07:22:06 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.2150, average loss: 26.3864
[09/30 07:22:06 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 63.46	
[09/30 07:22:06 visual_prompt]: Training 26 / 100 epoch, with learning rate 9.330127018922195
[09/30 07:28:33 visual_prompt]: Epoch 26 / 100: avg data time: 1.06e+01, avg batch time: 11.0412, average train loss: 19.0139
[09/30 07:29:18 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2086, average loss: 24.4106
[09/30 07:29:18 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.79	
[09/30 07:29:18 visual_prompt]: Training 27 / 100 epoch, with learning rate 9.240240480782129
[09/30 07:35:45 visual_prompt]: Epoch 27 / 100: avg data time: 1.06e+01, avg batch time: 11.0461, average train loss: 22.4413
[09/30 07:36:30 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.2199, average loss: 8.7775
[09/30 07:36:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 47.94	
[09/30 07:36:30 visual_prompt]: Training 28 / 100 epoch, with learning rate 9.145187862775208
[09/30 07:42:57 visual_prompt]: Epoch 28 / 100: avg data time: 1.06e+01, avg batch time: 11.0377, average train loss: 14.6237
[09/30 07:43:43 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.2075, average loss: 20.4954
[09/30 07:43:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 48.86	
[09/30 07:43:43 visual_prompt]: Training 29 / 100 epoch, with learning rate 9.045084971874736
[09/30 07:50:11 visual_prompt]: Epoch 29 / 100: avg data time: 1.06e+01, avg batch time: 11.0925, average train loss: 15.5743
[09/30 07:50:56 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2110, average loss: 9.9294
[09/30 07:50:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 35.09	
[09/30 07:50:56 visual_prompt]: Training 30 / 100 epoch, with learning rate 8.940053768033609
[09/30 07:57:23 visual_prompt]: Epoch 30 / 100: avg data time: 1.06e+01, avg batch time: 11.0452, average train loss: 17.1659
[09/30 07:58:09 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.2321, average loss: 28.3170
[09/30 07:58:09 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.00	
[09/30 07:58:09 visual_prompt]: Training 31 / 100 epoch, with learning rate 8.83022221559489
[09/30 08:04:35 visual_prompt]: Epoch 31 / 100: avg data time: 1.06e+01, avg batch time: 11.0400, average train loss: 29.1644
[09/30 08:05:20 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.1935, average loss: 3.7346
[09/30 08:05:20 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 47.05	
[09/30 08:05:20 visual_prompt]: Training 32 / 100 epoch, with learning rate 8.715724127386972
[09/30 08:11:48 visual_prompt]: Epoch 32 / 100: avg data time: 1.06e+01, avg batch time: 11.0616, average train loss: 15.0943
[09/30 08:12:33 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2152, average loss: 29.9034
[09/30 08:12:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 41.08	
[09/30 08:12:33 visual_prompt]: Training 33 / 100 epoch, with learning rate 8.596699001693256
[09/30 08:19:02 visual_prompt]: Epoch 33 / 100: avg data time: 1.06e+01, avg batch time: 11.0987, average train loss: 14.1732
[09/30 08:19:47 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2160, average loss: 9.9376
[09/30 08:19:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.64	
[09/30 08:19:47 visual_prompt]: Training 34 / 100 epoch, with learning rate 8.473291852294986
[09/30 08:26:15 visual_prompt]: Epoch 34 / 100: avg data time: 1.06e+01, avg batch time: 11.0697, average train loss: 19.3264
[09/30 08:27:00 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2366, average loss: 17.0832
[09/30 08:27:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.22	
[09/30 08:27:00 visual_prompt]: Training 35 / 100 epoch, with learning rate 8.345653031794292
[09/30 08:33:27 visual_prompt]: Epoch 35 / 100: avg data time: 1.06e+01, avg batch time: 11.0532, average train loss: 18.5016
[09/30 08:34:12 visual_prompt]: Inference (val):avg data time: 3.08e-05, avg batch time: 0.2206, average loss: 48.3497
[09/30 08:34:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 46.82	
[09/30 08:34:12 visual_prompt]: Training 36 / 100 epoch, with learning rate 8.213938048432697
[09/30 08:40:39 visual_prompt]: Epoch 36 / 100: avg data time: 1.06e+01, avg batch time: 11.0353, average train loss: 20.5766
[09/30 08:41:24 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.2725, average loss: 3.6214
[09/30 08:41:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.75	
[09/30 08:41:24 visual_prompt]: Training 37 / 100 epoch, with learning rate 8.078307376628292
[09/30 08:47:51 visual_prompt]: Epoch 37 / 100: avg data time: 1.05e+01, avg batch time: 11.0320, average train loss: 11.3966
[09/30 08:48:36 visual_prompt]: Inference (val):avg data time: 2.79e-05, avg batch time: 0.2122, average loss: 4.5796
[09/30 08:48:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.61	
[09/30 08:48:36 visual_prompt]: Training 38 / 100 epoch, with learning rate 7.938926261462366
[09/30 08:55:03 visual_prompt]: Epoch 38 / 100: avg data time: 1.06e+01, avg batch time: 11.0449, average train loss: 10.1963
[09/30 08:55:48 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.2321, average loss: 8.6075
[09/30 08:55:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.65	
[09/30 08:55:48 visual_prompt]: Training 39 / 100 epoch, with learning rate 7.795964517353734
[09/30 09:02:16 visual_prompt]: Epoch 39 / 100: avg data time: 1.06e+01, avg batch time: 11.0712, average train loss: 7.9922
[09/30 09:03:01 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.2496, average loss: 4.6487
[09/30 09:03:01 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.17	
[09/30 09:03:01 visual_prompt]: Training 40 / 100 epoch, with learning rate 7.649596321166024
[09/30 09:09:28 visual_prompt]: Epoch 40 / 100: avg data time: 1.06e+01, avg batch time: 11.0460, average train loss: 11.2974
[09/30 09:10:13 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2361, average loss: 14.6904
[09/30 09:10:13 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.13	
[09/30 09:10:13 visual_prompt]: Training 41 / 100 epoch, with learning rate 7.5
[09/30 09:16:40 visual_prompt]: Epoch 41 / 100: avg data time: 1.06e+01, avg batch time: 11.0266, average train loss: 9.3454
[09/30 09:17:25 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2103, average loss: 8.5370
[09/30 09:17:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.91	
[09/30 09:17:25 visual_prompt]: Training 42 / 100 epoch, with learning rate 7.347357813929454
[09/30 09:23:51 visual_prompt]: Epoch 42 / 100: avg data time: 1.06e+01, avg batch time: 11.0240, average train loss: 10.8236
[09/30 09:24:36 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.2102, average loss: 7.4339
[09/30 09:24:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 47.40	
[09/30 09:24:36 visual_prompt]: Training 43 / 100 epoch, with learning rate 7.191855733945387
[09/30 09:31:01 visual_prompt]: Epoch 43 / 100: avg data time: 1.05e+01, avg batch time: 11.0119, average train loss: 13.7714
[09/30 09:31:46 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.2246, average loss: 19.9323
[09/30 09:31:46 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 62.55	
[09/30 09:31:46 visual_prompt]: Training 44 / 100 epoch, with learning rate 7.033683215379002
[09/30 09:38:13 visual_prompt]: Epoch 44 / 100: avg data time: 1.06e+01, avg batch time: 11.0280, average train loss: 15.4545
[09/30 09:38:59 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2069, average loss: 11.9169
[09/30 09:38:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 46.07	
[09/30 09:38:59 visual_prompt]: Training 45 / 100 epoch, with learning rate 6.873032967079561
[09/30 09:45:26 visual_prompt]: Epoch 45 / 100: avg data time: 1.06e+01, avg batch time: 11.0629, average train loss: 7.2836
[09/30 09:46:11 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.2181, average loss: 24.4807
[09/30 09:46:11 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 61.98	
[09/30 09:46:11 visual_prompt]: Training 46 / 100 epoch, with learning rate 6.710100716628345
[09/30 09:52:38 visual_prompt]: Epoch 46 / 100: avg data time: 1.06e+01, avg batch time: 11.0359, average train loss: 17.1308
[09/30 09:53:23 visual_prompt]: Inference (val):avg data time: 2.71e-05, avg batch time: 0.2198, average loss: 19.2685
[09/30 09:53:23 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 48.59	
[09/30 09:53:23 visual_prompt]: Training 47 / 100 epoch, with learning rate 6.545084971874737
[09/30 09:59:52 visual_prompt]: Epoch 47 / 100: avg data time: 1.06e+01, avg batch time: 11.0975, average train loss: 10.2910
[09/30 10:00:37 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.2541, average loss: 8.9047
[09/30 10:00:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 39.73	
[09/30 10:00:37 visual_prompt]: Training 48 / 100 epoch, with learning rate 6.378186779084995
[09/30 10:07:04 visual_prompt]: Epoch 48 / 100: avg data time: 1.06e+01, avg batch time: 11.0536, average train loss: 16.6899
[09/30 10:07:49 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.2081, average loss: 13.6908
[09/30 10:07:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 60.85	
[09/30 10:07:49 visual_prompt]: Training 49 / 100 epoch, with learning rate 6.209609477998338
[09/30 10:14:17 visual_prompt]: Epoch 49 / 100: avg data time: 1.06e+01, avg batch time: 11.0778, average train loss: 9.8379
[09/30 10:15:02 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2097, average loss: 11.8788
[09/30 10:15:02 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.94	
[09/30 10:15:02 visual_prompt]: Training 50 / 100 epoch, with learning rate 6.039558454088796
[09/30 10:21:29 visual_prompt]: Epoch 50 / 100: avg data time: 1.06e+01, avg batch time: 11.0245, average train loss: 6.9400
[09/30 10:22:14 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.1921, average loss: 0.6932
[09/30 10:22:14 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.75	rocauc: 60.20	
[09/30 10:22:14 visual_prompt]: Training 51 / 100 epoch, with learning rate 5.868240888334652
[09/30 10:28:41 visual_prompt]: Epoch 51 / 100: avg data time: 1.06e+01, avg batch time: 11.0656, average train loss: 19.5965
[09/30 10:29:26 visual_prompt]: Inference (val):avg data time: 3.00e-05, avg batch time: 0.2165, average loss: 6.2907
[09/30 10:29:26 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 59.72	
[09/30 10:29:26 visual_prompt]: Training 52 / 100 epoch, with learning rate 5.695865504800327
[09/30 10:35:53 visual_prompt]: Epoch 52 / 100: avg data time: 1.06e+01, avg batch time: 11.0456, average train loss: 19.4371
[09/30 10:36:38 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.1980, average loss: 0.7806
[09/30 10:36:38 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.75	
[09/30 10:36:38 visual_prompt]: Training 53 / 100 epoch, with learning rate 5.522642316338268
[09/30 10:43:05 visual_prompt]: Epoch 53 / 100: avg data time: 1.06e+01, avg batch time: 11.0303, average train loss: 7.7846
[09/30 10:43:50 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.2433, average loss: 5.2889
[09/30 10:43:50 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 48.13	
[09/30 10:43:50 visual_prompt]: Training 54 / 100 epoch, with learning rate 5.3487823687206255
[09/30 10:50:16 visual_prompt]: Epoch 54 / 100: avg data time: 1.05e+01, avg batch time: 11.0262, average train loss: 9.4027
[09/30 10:51:02 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.1951, average loss: 29.0417
[09/30 10:51:02 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 46.07	
[09/30 10:51:02 visual_prompt]: Training 55 / 100 epoch, with learning rate 5.174497483512505
[09/30 10:57:29 visual_prompt]: Epoch 55 / 100: avg data time: 1.06e+01, avg batch time: 11.0621, average train loss: 9.5741
[09/30 10:58:14 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.2003, average loss: 2.7007
[09/30 10:58:14 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.34	
[09/30 10:58:14 visual_prompt]: Training 56 / 100 epoch, with learning rate 5.0
[09/30 11:04:41 visual_prompt]: Epoch 56 / 100: avg data time: 1.06e+01, avg batch time: 11.0435, average train loss: 6.0718
[09/30 11:05:26 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2235, average loss: 21.7817
[09/30 11:05:26 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.40	
[09/30 11:05:26 visual_prompt]: Training 57 / 100 epoch, with learning rate 4.8255025164874965
[09/30 11:11:54 visual_prompt]: Epoch 57 / 100: avg data time: 1.06e+01, avg batch time: 11.0742, average train loss: 8.7248
[09/30 11:12:39 visual_prompt]: Inference (val):avg data time: 2.67e-05, avg batch time: 0.2298, average loss: 1.4092
[09/30 11:12:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 47.73	
[09/30 11:12:39 visual_prompt]: Training 58 / 100 epoch, with learning rate 4.651217631279374
[09/30 11:19:06 visual_prompt]: Epoch 58 / 100: avg data time: 1.06e+01, avg batch time: 11.0429, average train loss: 6.4098
[09/30 11:19:51 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2313, average loss: 1.9196
[09/30 11:19:51 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 41.85	
[09/30 11:19:51 visual_prompt]: Training 59 / 100 epoch, with learning rate 4.477357683661733
[09/30 11:26:18 visual_prompt]: Epoch 59 / 100: avg data time: 1.06e+01, avg batch time: 11.0465, average train loss: 6.9451
[09/30 11:27:03 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.2132, average loss: 4.7588
[09/30 11:27:03 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.83	
[09/30 11:27:03 visual_prompt]: Training 60 / 100 epoch, with learning rate 4.3041344951996745
[09/30 11:33:31 visual_prompt]: Epoch 60 / 100: avg data time: 1.06e+01, avg batch time: 11.0749, average train loss: 7.1448
[09/30 11:34:16 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2292, average loss: 8.1224
[09/30 11:34:16 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 43.94	
[09/30 11:34:16 visual_prompt]: Training 61 / 100 epoch, with learning rate 4.131759111665349
[09/30 11:40:44 visual_prompt]: Epoch 61 / 100: avg data time: 1.06e+01, avg batch time: 11.0809, average train loss: 17.6160
[09/30 11:41:30 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.2410, average loss: 2.9080
[09/30 11:41:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.30	
[09/30 11:41:30 visual_prompt]: Training 62 / 100 epoch, with learning rate 3.960441545911204
[09/30 11:47:56 visual_prompt]: Epoch 62 / 100: avg data time: 1.06e+01, avg batch time: 11.0443, average train loss: 9.0220
[09/30 11:48:41 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2198, average loss: 1.7391
[09/30 11:48:41 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.80	
[09/30 11:48:41 visual_prompt]: Training 63 / 100 epoch, with learning rate 3.790390522001662
[09/30 11:55:08 visual_prompt]: Epoch 63 / 100: avg data time: 1.05e+01, avg batch time: 11.0258, average train loss: 4.6304
[09/30 11:55:53 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2405, average loss: 4.8232
[09/30 11:55:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 46.58	
[09/30 11:55:53 visual_prompt]: Training 64 / 100 epoch, with learning rate 3.6218132209150045
[09/30 12:02:20 visual_prompt]: Epoch 64 / 100: avg data time: 1.06e+01, avg batch time: 11.0443, average train loss: 3.1319
[09/30 12:03:05 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2254, average loss: 2.5824
[09/30 12:03:05 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 62.87	
[09/30 12:03:05 visual_prompt]: Training 65 / 100 epoch, with learning rate 3.454915028125263
[09/30 12:09:33 visual_prompt]: Epoch 65 / 100: avg data time: 1.06e+01, avg batch time: 11.0863, average train loss: 3.0066
[09/30 12:10:18 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.2008, average loss: 0.8805
[09/30 12:10:18 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 47.23	
[09/30 12:10:18 visual_prompt]: Training 66 / 100 epoch, with learning rate 3.289899283371657
[09/30 12:16:45 visual_prompt]: Epoch 66 / 100: avg data time: 1.06e+01, avg batch time: 11.0401, average train loss: 1.7059
[09/30 12:17:30 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2339, average loss: 1.3598
[09/30 12:17:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.66	
[09/30 12:17:30 visual_prompt]: Training 67 / 100 epoch, with learning rate 3.1269670329204398
[09/30 12:23:57 visual_prompt]: Epoch 67 / 100: avg data time: 1.06e+01, avg batch time: 11.0383, average train loss: 2.9940
[09/30 12:24:42 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.2134, average loss: 0.8219
[09/30 12:24:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.10	rocauc: 56.09	
[09/30 12:24:42 visual_prompt]: Best epoch 67: best metric: 0.561
[09/30 12:24:42 visual_prompt]: Training 68 / 100 epoch, with learning rate 2.9663167846209997
[09/30 12:31:08 visual_prompt]: Epoch 68 / 100: avg data time: 1.05e+01, avg batch time: 11.0194, average train loss: 6.2418
[09/30 12:31:53 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2717, average loss: 3.3913
[09/30 12:31:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 41.76	
[09/30 12:31:53 visual_prompt]: Training 69 / 100 epoch, with learning rate 2.8081442660546125
[09/30 12:38:20 visual_prompt]: Epoch 69 / 100: avg data time: 1.06e+01, avg batch time: 11.0335, average train loss: 2.6945
[09/30 12:39:05 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2524, average loss: 6.0090
[09/30 12:39:05 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 45.36	
[09/30 12:39:05 visual_prompt]: Training 70 / 100 epoch, with learning rate 2.6526421860705476
[09/30 12:45:33 visual_prompt]: Epoch 70 / 100: avg data time: 1.06e+01, avg batch time: 11.0547, average train loss: 2.9924
[09/30 12:46:18 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.2459, average loss: 0.7340
[09/30 12:46:18 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.74	
[09/30 12:46:18 visual_prompt]: Training 71 / 100 epoch, with learning rate 2.500000000000001
[09/30 12:52:44 visual_prompt]: Epoch 71 / 100: avg data time: 1.05e+01, avg batch time: 11.0394, average train loss: 1.6778
[09/30 12:53:30 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2319, average loss: 1.6822
[09/30 12:53:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.23	
[09/30 12:53:30 visual_prompt]: Training 72 / 100 epoch, with learning rate 2.350403678833976
[09/30 12:59:56 visual_prompt]: Epoch 72 / 100: avg data time: 1.06e+01, avg batch time: 11.0406, average train loss: 1.9488
[09/30 13:00:41 visual_prompt]: Inference (val):avg data time: 2.87e-05, avg batch time: 0.1946, average loss: 1.2094
[09/30 13:00:41 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.34	
[09/30 13:00:41 visual_prompt]: Training 73 / 100 epoch, with learning rate 2.2040354826462667
[09/30 13:07:10 visual_prompt]: Epoch 73 / 100: avg data time: 1.06e+01, avg batch time: 11.0818, average train loss: 0.9951
[09/30 13:07:55 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2213, average loss: 0.7673
[09/30 13:07:55 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 47.83	
[09/30 13:07:55 visual_prompt]: Training 74 / 100 epoch, with learning rate 2.061073738537635
[09/30 13:14:22 visual_prompt]: Epoch 74 / 100: avg data time: 1.06e+01, avg batch time: 11.0583, average train loss: 0.8237
[09/30 13:15:07 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.2148, average loss: 0.9253
[09/30 13:15:07 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 39.23	
[09/30 13:15:07 visual_prompt]: Training 75 / 100 epoch, with learning rate 1.9216926233717087
[09/30 13:21:35 visual_prompt]: Epoch 75 / 100: avg data time: 1.06e+01, avg batch time: 11.0711, average train loss: 0.9741
[09/30 13:22:20 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2909, average loss: 0.9129
[09/30 13:22:20 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.89	
[09/30 13:22:20 visual_prompt]: Training 76 / 100 epoch, with learning rate 1.7860619515673033
[09/30 13:28:47 visual_prompt]: Epoch 76 / 100: avg data time: 1.06e+01, avg batch time: 11.0380, average train loss: 1.8170
[09/30 13:29:32 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.2279, average loss: 1.5065
[09/30 13:29:32 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.13	
[09/30 13:29:32 visual_prompt]: Training 77 / 100 epoch, with learning rate 1.6543469682057106
[09/30 13:36:00 visual_prompt]: Epoch 77 / 100: avg data time: 1.06e+01, avg batch time: 11.0679, average train loss: 0.9581
[09/30 13:36:45 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.1970, average loss: 0.7076
[09/30 13:36:45 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.48	
[09/30 13:36:45 visual_prompt]: Training 78 / 100 epoch, with learning rate 1.5267081477050133
[09/30 13:43:13 visual_prompt]: Epoch 78 / 100: avg data time: 1.06e+01, avg batch time: 11.0735, average train loss: 0.8741
[09/30 13:43:58 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.2276, average loss: 0.9357
[09/30 13:43:58 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 41.71	
[09/30 13:43:58 visual_prompt]: Training 79 / 100 epoch, with learning rate 1.403300998306745
[09/30 13:50:27 visual_prompt]: Epoch 79 / 100: avg data time: 1.06e+01, avg batch time: 11.0806, average train loss: 0.7575
[09/30 13:51:12 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.3085, average loss: 0.6912
[09/30 13:51:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.66	
[09/30 13:51:12 visual_prompt]: Training 80 / 100 epoch, with learning rate 1.2842758726130281
[09/30 13:57:40 visual_prompt]: Epoch 80 / 100: avg data time: 1.06e+01, avg batch time: 11.0684, average train loss: 0.7188
[09/30 13:58:25 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.2377, average loss: 0.6903
[09/30 13:58:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.00	
[09/30 13:58:25 visual_prompt]: Training 81 / 100 epoch, with learning rate 1.1697777844051105
[09/30 14:04:55 visual_prompt]: Epoch 81 / 100: avg data time: 1.07e+01, avg batch time: 11.1127, average train loss: 0.7369
[09/30 14:05:40 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.2232, average loss: 0.7896
[09/30 14:05:40 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.03	
[09/30 14:05:40 visual_prompt]: Training 82 / 100 epoch, with learning rate 1.0599462319663906
[09/30 14:12:10 visual_prompt]: Epoch 82 / 100: avg data time: 1.07e+01, avg batch time: 11.1370, average train loss: 0.7480
[09/30 14:12:56 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.2081, average loss: 0.8261
[09/30 14:12:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.15	
[09/30 14:12:56 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.9549150281252633
[09/30 14:19:25 visual_prompt]: Epoch 83 / 100: avg data time: 1.06e+01, avg batch time: 11.1039, average train loss: 0.8359
[09/30 14:20:10 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.2144, average loss: 0.7705
[09/30 14:20:10 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.87	
[09/30 14:20:10 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.8548121372247919
[09/30 14:26:37 visual_prompt]: Epoch 84 / 100: avg data time: 1.06e+01, avg batch time: 11.0481, average train loss: 0.8044
[09/30 14:27:22 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.2143, average loss: 0.7814
[09/30 14:27:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.02	
[09/30 14:27:22 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.7597595192178702
[09/30 14:33:49 visual_prompt]: Epoch 85 / 100: avg data time: 1.06e+01, avg batch time: 11.0511, average train loss: 0.7479
[09/30 14:34:34 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2220, average loss: 0.7069
[09/30 14:34:34 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.60	
[09/30 14:34:34 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.6698729810778065
[09/30 14:41:02 visual_prompt]: Epoch 86 / 100: avg data time: 1.06e+01, avg batch time: 11.0655, average train loss: 0.6950
[09/30 14:41:47 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.2082, average loss: 0.7252
[09/30 14:41:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.45	
[09/30 14:41:47 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.5852620357053651
[09/30 14:48:14 visual_prompt]: Epoch 87 / 100: avg data time: 1.06e+01, avg batch time: 11.0598, average train loss: 0.7228
[09/30 14:49:00 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.2089, average loss: 0.7150
[09/30 14:49:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.13	
[09/30 14:49:00 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.5060297685041659
[09/30 14:55:25 visual_prompt]: Epoch 88 / 100: avg data time: 1.05e+01, avg batch time: 11.0102, average train loss: 0.7065
[09/30 14:56:10 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.2324, average loss: 0.7154
[09/30 14:56:10 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.35	
[09/30 14:56:10 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.4322727117869951
[09/30 15:02:37 visual_prompt]: Epoch 89 / 100: avg data time: 1.06e+01, avg batch time: 11.0573, average train loss: 0.6972
[09/30 15:03:23 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.2059, average loss: 0.7029
[09/30 15:03:23 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.73	
[09/30 15:03:23 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.36408072716606343
[09/30 15:09:50 visual_prompt]: Epoch 90 / 100: avg data time: 1.06e+01, avg batch time: 11.0633, average train loss: 0.7070
[09/30 15:10:35 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2378, average loss: 0.6897
[09/30 15:10:35 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.64	
[09/30 15:10:35 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.3015368960704584
[09/30 15:17:02 visual_prompt]: Epoch 91 / 100: avg data time: 1.06e+01, avg batch time: 11.0427, average train loss: 0.6967
[09/30 15:17:47 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.2063, average loss: 0.6927
[09/30 15:17:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.35	
[09/30 15:17:47 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.24471741852423234
[09/30 15:24:15 visual_prompt]: Epoch 92 / 100: avg data time: 1.06e+01, avg batch time: 11.0805, average train loss: 0.6970
[09/30 15:25:01 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.2402, average loss: 0.7112
[09/30 15:25:01 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.44	
[09/30 15:25:01 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.19369152030840553
[09/30 15:31:28 visual_prompt]: Epoch 93 / 100: avg data time: 1.06e+01, avg batch time: 11.0581, average train loss: 0.6923
[09/30 15:32:13 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2348, average loss: 0.6931
[09/30 15:32:13 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.18	
[09/30 15:32:13 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.14852136862001764
[09/30 15:38:40 visual_prompt]: Epoch 94 / 100: avg data time: 1.06e+01, avg batch time: 11.0438, average train loss: 0.6890
[09/30 15:39:25 visual_prompt]: Inference (val):avg data time: 2.93e-05, avg batch time: 0.2328, average loss: 0.6882
[09/30 15:39:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.07	rocauc: 56.28	
[09/30 15:39:25 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.10926199633097156
[09/30 15:45:53 visual_prompt]: Epoch 95 / 100: avg data time: 1.06e+01, avg batch time: 11.0796, average train loss: 0.6888
[09/30 15:46:38 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.2259, average loss: 0.6856
[09/30 15:46:38 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.69	rocauc: 56.52	
[09/30 15:46:38 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.0759612349389599
[09/30 15:53:07 visual_prompt]: Epoch 96 / 100: avg data time: 1.06e+01, avg batch time: 11.0950, average train loss: 0.6852
[09/30 15:53:53 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2535, average loss: 0.6940
[09/30 15:53:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.25	rocauc: 56.19	
[09/30 15:53:53 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.04865965629214819
[09/30 16:00:22 visual_prompt]: Epoch 97 / 100: avg data time: 1.06e+01, avg batch time: 11.1161, average train loss: 0.6844
[09/30 16:01:07 visual_prompt]: Inference (val):avg data time: 2.86e-05, avg batch time: 0.2113, average loss: 0.6866
[09/30 16:01:07 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.28	rocauc: 55.70	
[09/30 16:01:07 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.02739052315863355
[09/30 16:07:36 visual_prompt]: Epoch 98 / 100: avg data time: 1.06e+01, avg batch time: 11.0888, average train loss: 0.6834
[09/30 16:08:21 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.2169, average loss: 0.6837
[09/30 16:08:21 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.10	rocauc: 56.10	
[09/30 16:08:21 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.012179748700879012
[09/30 16:14:48 visual_prompt]: Epoch 99 / 100: avg data time: 1.06e+01, avg batch time: 11.0518, average train loss: 0.6805
[09/30 16:15:33 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.2587, average loss: 0.6828
[09/30 16:15:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.91	rocauc: 56.82	
[09/30 16:15:33 visual_prompt]: Best epoch 99: best metric: 0.569
[09/30 16:15:33 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0030458649045211894
[09/30 16:22:02 visual_prompt]: Epoch 100 / 100: avg data time: 1.06e+01, avg batch time: 11.1073, average train loss: 0.6829
[09/30 16:22:48 visual_prompt]: Inference (val):avg data time: 2.58e-05, avg batch time: 0.2224, average loss: 0.6836
[09/30 16:22:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.69	rocauc: 56.80	
[09/30 16:22:48 visual_prompt]: Rank of current process: 0. World size: 1
[09/30 16:22:48 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              0
GPU 0                NVIDIA A100-PCIE-40GB
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[09/30 16:22:48 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'mammo-cbis', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[09/30 16:22:48 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/30 16:22:48 visual_prompt]: Training with config:
[09/30 16:22:48 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/mammo-cbis/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr10.0_wd0.0001/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0001, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 10.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'mammo-cbis', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[09/30 16:22:48 visual_prompt]: Loading training data...
[09/30 16:22:48 visual_prompt]: Constructing mammo-cbis dataset train...
[09/30 16:22:48 visual_prompt]: Loading validation data...
[09/30 16:22:48 visual_prompt]: Constructing mammo-cbis dataset val...
[09/30 16:22:48 visual_prompt]: Constructing models...
[09/30 16:22:50 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[09/30 16:22:50 visual_prompt]: tuned percent:0.536
[09/30 16:22:50 visual_prompt]: Device used for model: 0
[09/30 16:22:50 visual_prompt]: Setting up Evaluator...
[09/30 16:22:50 visual_prompt]: Setting up Trainer...
[09/30 16:22:50 visual_prompt]: 	Setting up the optimizer...
[09/30 16:22:51 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[09/30 16:29:17 visual_prompt]: Epoch 1 / 100: avg data time: 1.06e+01, avg batch time: 11.0323, average train loss: 1.4903
[09/30 16:30:02 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.2583, average loss: 1.4710
[09/30 16:30:02 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.15	
[09/30 16:30:02 visual_prompt]: Best epoch 1: best metric: 0.537
[09/30 16:30:02 visual_prompt]: Training 2 / 100 epoch, with learning rate 1.0
[09/30 16:36:30 visual_prompt]: Epoch 2 / 100: avg data time: 1.06e+01, avg batch time: 11.0707, average train loss: 14.6065
[09/30 16:37:15 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2056, average loss: 2.6317
[09/30 16:37:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 46.48	
[09/30 16:37:15 visual_prompt]: Training 3 / 100 epoch, with learning rate 2.0
[09/30 16:43:41 visual_prompt]: Epoch 3 / 100: avg data time: 1.05e+01, avg batch time: 11.0158, average train loss: 2.8772
[09/30 16:44:25 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2014, average loss: 0.7000
[09/30 16:44:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.92	
[09/30 16:44:25 visual_prompt]: Training 4 / 100 epoch, with learning rate 3.0
[09/30 16:50:52 visual_prompt]: Epoch 4 / 100: avg data time: 1.05e+01, avg batch time: 11.0310, average train loss: 5.0138
[09/30 16:51:37 visual_prompt]: Inference (val):avg data time: 2.81e-05, avg batch time: 0.2181, average loss: 8.8094
[09/30 16:51:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.26	
[09/30 16:51:37 visual_prompt]: Training 5 / 100 epoch, with learning rate 4.0
[09/30 16:58:04 visual_prompt]: Epoch 5 / 100: avg data time: 1.06e+01, avg batch time: 11.0466, average train loss: 6.3474
[09/30 16:58:49 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.2001, average loss: 1.2760
[09/30 16:58:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.90	
[09/30 16:58:49 visual_prompt]: Training 6 / 100 epoch, with learning rate 5.0
[09/30 17:05:18 visual_prompt]: Epoch 6 / 100: avg data time: 1.06e+01, avg batch time: 11.1000, average train loss: 8.5601
[09/30 17:06:03 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2114, average loss: 3.4439
[09/30 17:06:03 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.85	
[09/30 17:06:03 visual_prompt]: Training 7 / 100 epoch, with learning rate 6.0
[09/30 17:12:31 visual_prompt]: Epoch 7 / 100: avg data time: 1.06e+01, avg batch time: 11.0821, average train loss: 9.1126
[09/30 17:13:17 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.2307, average loss: 1.9537
[09/30 17:13:17 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 47.92	
[09/30 17:13:17 visual_prompt]: Training 8 / 100 epoch, with learning rate 7.0
[09/30 17:19:44 visual_prompt]: Epoch 8 / 100: avg data time: 1.06e+01, avg batch time: 11.0708, average train loss: 4.2513
[09/30 17:20:30 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2448, average loss: 3.8289
[09/30 17:20:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.61	
[09/30 17:20:30 visual_prompt]: Training 9 / 100 epoch, with learning rate 8.0
[09/30 17:26:58 visual_prompt]: Epoch 9 / 100: avg data time: 1.06e+01, avg batch time: 11.0672, average train loss: 9.2441
[09/30 17:27:43 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.2490, average loss: 7.3098
[09/30 17:27:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 40.21	
[09/30 17:27:43 visual_prompt]: Training 10 / 100 epoch, with learning rate 9.0
[09/30 17:34:09 visual_prompt]: Epoch 10 / 100: avg data time: 1.06e+01, avg batch time: 11.0308, average train loss: 9.9854
[09/30 17:34:55 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.2516, average loss: 2.6237
[09/30 17:34:55 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 47.20	
[09/30 17:34:55 visual_prompt]: Training 11 / 100 epoch, with learning rate 10.0
[09/30 17:41:22 visual_prompt]: Epoch 11 / 100: avg data time: 1.06e+01, avg batch time: 11.0714, average train loss: 23.0330
[09/30 17:42:08 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2154, average loss: 23.5309
[09/30 17:42:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 59.93	
[09/30 17:42:08 visual_prompt]: Training 12 / 100 epoch, with learning rate 9.996954135095478
[09/30 17:48:34 visual_prompt]: Epoch 12 / 100: avg data time: 1.06e+01, avg batch time: 11.0265, average train loss: 16.8427
[09/30 17:49:19 visual_prompt]: Inference (val):avg data time: 2.03e-05, avg batch time: 0.2413, average loss: 25.6027
[09/30 17:49:19 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 47.56	
[09/30 17:49:19 visual_prompt]: Training 13 / 100 epoch, with learning rate 9.987820251299121
[09/30 17:55:45 visual_prompt]: Epoch 13 / 100: avg data time: 1.06e+01, avg batch time: 11.0275, average train loss: 14.0619
[09/30 17:56:30 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2070, average loss: 18.4287
[09/30 17:56:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.88	
[09/30 17:56:30 visual_prompt]: Training 14 / 100 epoch, with learning rate 9.972609476841367
[09/30 18:02:58 visual_prompt]: Epoch 14 / 100: avg data time: 1.06e+01, avg batch time: 11.0649, average train loss: 14.7667
[09/30 18:03:43 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2362, average loss: 7.6966
[09/30 18:03:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 41.88	
[09/30 18:03:43 visual_prompt]: Training 15 / 100 epoch, with learning rate 9.951340343707852
[09/30 18:10:10 visual_prompt]: Epoch 15 / 100: avg data time: 1.06e+01, avg batch time: 11.0577, average train loss: 10.3692
[09/30 18:10:56 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.2136, average loss: 0.7178
[09/30 18:10:56 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 58.60	
[09/30 18:10:56 visual_prompt]: Training 16 / 100 epoch, with learning rate 9.924038765061042
[09/30 18:17:23 visual_prompt]: Epoch 16 / 100: avg data time: 1.05e+01, avg batch time: 11.0430, average train loss: 11.7265
[09/30 18:18:08 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2070, average loss: 11.5502
[09/30 18:18:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.74	
[09/30 18:18:08 visual_prompt]: Training 17 / 100 epoch, with learning rate 9.890738003669028
[09/30 18:24:34 visual_prompt]: Epoch 17 / 100: avg data time: 1.05e+01, avg batch time: 11.0188, average train loss: 4.6302
[09/30 18:25:19 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2204, average loss: 0.6898
[09/30 18:25:19 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.03	
[09/30 18:25:19 visual_prompt]: Training 18 / 100 epoch, with learning rate 9.851478631379981
[09/30 18:31:47 visual_prompt]: Epoch 18 / 100: avg data time: 1.06e+01, avg batch time: 11.0704, average train loss: 4.3949
[09/30 18:32:32 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2255, average loss: 10.4009
[09/30 18:32:32 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.23	
[09/30 18:32:32 visual_prompt]: Training 19 / 100 epoch, with learning rate 9.806308479691594
[09/30 18:38:58 visual_prompt]: Epoch 19 / 100: avg data time: 1.05e+01, avg batch time: 11.0162, average train loss: 6.2012
[09/30 18:39:43 visual_prompt]: Inference (val):avg data time: 2.14e-05, avg batch time: 0.2678, average loss: 2.4552
[09/30 18:39:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 61.23	
[09/30 18:39:43 visual_prompt]: Training 20 / 100 epoch, with learning rate 9.755282581475768
[09/30 18:46:09 visual_prompt]: Epoch 20 / 100: avg data time: 1.06e+01, avg batch time: 11.0284, average train loss: 9.6378
[09/30 18:46:54 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.2350, average loss: 32.8300
[09/30 18:46:54 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.43	
[09/30 18:46:54 visual_prompt]: Training 21 / 100 epoch, with learning rate 9.698463103929543
[09/30 18:53:21 visual_prompt]: Epoch 21 / 100: avg data time: 1.06e+01, avg batch time: 11.0556, average train loss: 15.5608
[09/30 18:54:07 visual_prompt]: Inference (val):avg data time: 2.52e-05, avg batch time: 0.2251, average loss: 23.0466
[09/30 18:54:07 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.48	
[09/30 18:54:07 visual_prompt]: Training 22 / 100 epoch, with learning rate 9.635919272833938
[09/30 19:00:34 visual_prompt]: Epoch 22 / 100: avg data time: 1.06e+01, avg batch time: 11.0465, average train loss: 7.9342
[09/30 19:01:19 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2141, average loss: 3.4267
[09/30 19:01:19 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.07	
[09/30 19:01:19 visual_prompt]: Training 23 / 100 epoch, with learning rate 9.567727288213003
[09/30 19:07:47 visual_prompt]: Epoch 23 / 100: avg data time: 1.06e+01, avg batch time: 11.0666, average train loss: 4.4561
[09/30 19:08:32 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.2321, average loss: 2.1196
[09/30 19:08:32 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.98	
[09/30 19:08:32 visual_prompt]: Training 24 / 100 epoch, with learning rate 9.493970231495835
[09/30 19:14:59 visual_prompt]: Epoch 24 / 100: avg data time: 1.06e+01, avg batch time: 11.0500, average train loss: 5.1559
[09/30 19:15:44 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2425, average loss: 1.8947
[09/30 19:15:44 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.52	
[09/30 19:15:44 visual_prompt]: Training 25 / 100 epoch, with learning rate 9.414737964294634
[09/30 19:22:12 visual_prompt]: Epoch 25 / 100: avg data time: 1.06e+01, avg batch time: 11.0725, average train loss: 10.6850
[09/30 19:22:57 visual_prompt]: Inference (val):avg data time: 2.45e-05, avg batch time: 0.2132, average loss: 4.1006
[09/30 19:22:57 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.92	
[09/30 19:22:57 visual_prompt]: Training 26 / 100 epoch, with learning rate 9.330127018922195
[09/30 19:29:23 visual_prompt]: Epoch 26 / 100: avg data time: 1.06e+01, avg batch time: 11.0260, average train loss: 10.0544
[09/30 19:30:08 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.2510, average loss: 22.0236
[09/30 19:30:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 48.51	
[09/30 19:30:08 visual_prompt]: Training 27 / 100 epoch, with learning rate 9.240240480782129
[09/30 19:36:35 visual_prompt]: Epoch 27 / 100: avg data time: 1.06e+01, avg batch time: 11.0450, average train loss: 13.9612
[09/30 19:37:20 visual_prompt]: Inference (val):avg data time: 2.56e-05, avg batch time: 0.2321, average loss: 9.2100
[09/30 19:37:20 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 46.13	
[09/30 19:37:20 visual_prompt]: Training 28 / 100 epoch, with learning rate 9.145187862775208
[09/30 19:43:47 visual_prompt]: Epoch 28 / 100: avg data time: 1.06e+01, avg batch time: 11.0480, average train loss: 8.6725
[09/30 19:44:33 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2313, average loss: 2.2597
[09/30 19:44:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.21	
[09/30 19:44:33 visual_prompt]: Training 29 / 100 epoch, with learning rate 9.045084971874736
[09/30 19:51:01 visual_prompt]: Epoch 29 / 100: avg data time: 1.06e+01, avg batch time: 11.0960, average train loss: 8.1401
[09/30 19:51:46 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2388, average loss: 1.3028
[09/30 19:51:46 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 47.02	
[09/30 19:51:46 visual_prompt]: Training 30 / 100 epoch, with learning rate 8.940053768033609
[09/30 19:58:13 visual_prompt]: Epoch 30 / 100: avg data time: 1.06e+01, avg batch time: 11.0443, average train loss: 11.2609
[09/30 19:58:58 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2063, average loss: 3.4969
[09/30 19:58:58 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.44	
[09/30 19:58:58 visual_prompt]: Training 31 / 100 epoch, with learning rate 8.83022221559489
[09/30 20:05:25 visual_prompt]: Epoch 31 / 100: avg data time: 1.06e+01, avg batch time: 11.0433, average train loss: 14.9365
[09/30 20:06:10 visual_prompt]: Inference (val):avg data time: 4.05e-05, avg batch time: 0.2353, average loss: 10.2235
[09/30 20:06:10 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.10	
[09/30 20:06:10 visual_prompt]: Training 32 / 100 epoch, with learning rate 8.715724127386972
[09/30 20:12:38 visual_prompt]: Epoch 32 / 100: avg data time: 1.06e+01, avg batch time: 11.0658, average train loss: 10.7206
[09/30 20:13:23 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2216, average loss: 4.6489
[09/30 20:13:23 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.04	
[09/30 20:13:23 visual_prompt]: Training 33 / 100 epoch, with learning rate 8.596699001693256
[09/30 20:19:48 visual_prompt]: Epoch 33 / 100: avg data time: 1.06e+01, avg batch time: 11.0037, average train loss: 5.2553
[09/30 20:20:33 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2349, average loss: 2.2950
[09/30 20:20:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 60.19	
[09/30 20:20:33 visual_prompt]: Training 34 / 100 epoch, with learning rate 8.473291852294986
[09/30 20:27:01 visual_prompt]: Epoch 34 / 100: avg data time: 1.06e+01, avg batch time: 11.0770, average train loss: 3.6169
[09/30 20:27:46 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.1933, average loss: 6.5579
[09/30 20:27:46 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.71	
[09/30 20:27:46 visual_prompt]: Training 35 / 100 epoch, with learning rate 8.345653031794292
[09/30 20:34:15 visual_prompt]: Epoch 35 / 100: avg data time: 1.06e+01, avg batch time: 11.0880, average train loss: 10.1085
[09/30 20:35:00 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2515, average loss: 9.2095
[09/30 20:35:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 43.86	
[09/30 20:35:00 visual_prompt]: Training 36 / 100 epoch, with learning rate 8.213938048432697
[09/30 20:41:27 visual_prompt]: Epoch 36 / 100: avg data time: 1.06e+01, avg batch time: 11.0562, average train loss: 6.6456
[09/30 20:42:12 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.2516, average loss: 11.4421
[09/30 20:42:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.04	
[09/30 20:42:12 visual_prompt]: Training 37 / 100 epoch, with learning rate 8.078307376628292
[09/30 20:48:37 visual_prompt]: Epoch 37 / 100: avg data time: 1.05e+01, avg batch time: 10.9878, average train loss: 5.0417
[09/30 20:49:22 visual_prompt]: Inference (val):avg data time: 2.16e-05, avg batch time: 0.2108, average loss: 1.4838
[09/30 20:49:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 44.10	
[09/30 20:49:22 visual_prompt]: Training 38 / 100 epoch, with learning rate 7.938926261462366
[09/30 20:56:12 visual_prompt]: Epoch 38 / 100: avg data time: 1.12e+01, avg batch time: 11.7112, average train loss: 6.7449
[09/30 20:56:57 visual_prompt]: Inference (val):avg data time: 2.18e-05, avg batch time: 0.2348, average loss: 0.6945
[09/30 20:56:57 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.54	
[09/30 20:56:57 visual_prompt]: Training 39 / 100 epoch, with learning rate 7.795964517353734
[09/30 21:03:25 visual_prompt]: Epoch 39 / 100: avg data time: 1.06e+01, avg batch time: 11.0745, average train loss: 3.6732
[09/30 21:04:11 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.2314, average loss: 4.2553
[09/30 21:04:11 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.89	
[09/30 21:04:11 visual_prompt]: Training 40 / 100 epoch, with learning rate 7.649596321166024
[09/30 21:10:38 visual_prompt]: Epoch 40 / 100: avg data time: 1.06e+01, avg batch time: 11.0507, average train loss: 4.3476
[09/30 21:11:23 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2269, average loss: 8.9812
[09/30 21:11:23 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 63.13	
[09/30 21:11:23 visual_prompt]: Training 41 / 100 epoch, with learning rate 7.5
[09/30 21:17:49 visual_prompt]: Epoch 41 / 100: avg data time: 1.05e+01, avg batch time: 11.0273, average train loss: 7.8147
[09/30 21:18:34 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.2511, average loss: 2.3335
[09/30 21:18:34 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.71	
[09/30 21:18:34 visual_prompt]: Training 42 / 100 epoch, with learning rate 7.347357813929454
[09/30 21:24:59 visual_prompt]: Epoch 42 / 100: avg data time: 1.05e+01, avg batch time: 10.9961, average train loss: 6.1079
[09/30 21:25:44 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.2133, average loss: 7.4161
[09/30 21:25:44 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 45.58	
[09/30 21:25:44 visual_prompt]: Training 43 / 100 epoch, with learning rate 7.191855733945387
[09/30 21:32:10 visual_prompt]: Epoch 43 / 100: avg data time: 1.05e+01, avg batch time: 11.0142, average train loss: 4.2087
[09/30 21:32:55 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2160, average loss: 1.1476
[09/30 21:32:55 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.51	
[09/30 21:32:55 visual_prompt]: Training 44 / 100 epoch, with learning rate 7.033683215379002
[09/30 21:39:23 visual_prompt]: Epoch 44 / 100: avg data time: 1.06e+01, avg batch time: 11.0616, average train loss: 4.6188
[09/30 21:40:08 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2161, average loss: 6.1179
[09/30 21:40:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.79	
[09/30 21:40:08 visual_prompt]: Training 45 / 100 epoch, with learning rate 6.873032967079561
[09/30 21:46:34 visual_prompt]: Epoch 45 / 100: avg data time: 1.06e+01, avg batch time: 11.0262, average train loss: 2.7680
[09/30 21:47:19 visual_prompt]: Inference (val):avg data time: 2.76e-05, avg batch time: 0.2058, average loss: 8.0840
[09/30 21:47:19 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 45.10	
[09/30 21:47:19 visual_prompt]: Training 46 / 100 epoch, with learning rate 6.710100716628345
[09/30 21:53:45 visual_prompt]: Epoch 46 / 100: avg data time: 1.05e+01, avg batch time: 11.0265, average train loss: 2.5968
[09/30 21:54:30 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2053, average loss: 0.7644
[09/30 21:54:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.00	
[09/30 21:54:30 visual_prompt]: Training 47 / 100 epoch, with learning rate 6.545084971874737
[09/30 22:00:57 visual_prompt]: Epoch 47 / 100: avg data time: 1.06e+01, avg batch time: 11.0588, average train loss: 2.3744
[09/30 22:01:43 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2169, average loss: 7.9888
[09/30 22:01:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 40.10	
[09/30 22:01:43 visual_prompt]: Training 48 / 100 epoch, with learning rate 6.378186779084995
[09/30 22:08:09 visual_prompt]: Epoch 48 / 100: avg data time: 1.06e+01, avg batch time: 11.0279, average train loss: 12.3388
[09/30 22:08:54 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2248, average loss: 1.8340
[09/30 22:08:54 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 40.02	
[09/30 22:08:54 visual_prompt]: Training 49 / 100 epoch, with learning rate 6.209609477998338
[09/30 22:15:23 visual_prompt]: Epoch 49 / 100: avg data time: 1.06e+01, avg batch time: 11.1021, average train loss: 7.7186
[09/30 22:16:08 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.2053, average loss: 15.2269
[09/30 22:16:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 46.15	
[09/30 22:16:08 visual_prompt]: Training 50 / 100 epoch, with learning rate 6.039558454088796
[09/30 22:22:37 visual_prompt]: Epoch 50 / 100: avg data time: 1.06e+01, avg batch time: 11.1074, average train loss: 9.7809
[09/30 22:23:22 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.2628, average loss: 17.5248
[09/30 22:23:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 46.03	
[09/30 22:23:22 visual_prompt]: Training 51 / 100 epoch, with learning rate 5.868240888334652
[09/30 22:29:49 visual_prompt]: Epoch 51 / 100: avg data time: 1.06e+01, avg batch time: 11.0390, average train loss: 5.4158
[09/30 22:30:34 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.2305, average loss: 3.2968
[09/30 22:30:34 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 43.57	
[09/30 22:30:34 visual_prompt]: Training 52 / 100 epoch, with learning rate 5.695865504800327
[09/30 22:37:02 visual_prompt]: Epoch 52 / 100: avg data time: 1.06e+01, avg batch time: 11.0692, average train loss: 11.1502
[09/30 22:37:48 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2486, average loss: 5.6643
[09/30 22:37:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.25	
[09/30 22:37:48 visual_prompt]: Training 53 / 100 epoch, with learning rate 5.522642316338268
[09/30 22:44:16 visual_prompt]: Epoch 53 / 100: avg data time: 1.06e+01, avg batch time: 11.0618, average train loss: 5.6637
[09/30 22:45:01 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2357, average loss: 2.5560
[09/30 22:45:01 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.98	
[09/30 22:45:01 visual_prompt]: Training 54 / 100 epoch, with learning rate 5.3487823687206255
[09/30 22:51:28 visual_prompt]: Epoch 54 / 100: avg data time: 1.06e+01, avg batch time: 11.0513, average train loss: 4.7558
[09/30 22:52:13 visual_prompt]: Inference (val):avg data time: 2.82e-05, avg batch time: 0.2315, average loss: 3.2234
[09/30 22:52:13 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 58.51	
[09/30 22:52:13 visual_prompt]: Training 55 / 100 epoch, with learning rate 5.174497483512505
[09/30 22:58:41 visual_prompt]: Epoch 55 / 100: avg data time: 1.06e+01, avg batch time: 11.0590, average train loss: 3.5822
[09/30 22:59:26 visual_prompt]: Inference (val):avg data time: 2.76e-05, avg batch time: 0.2315, average loss: 2.6786
[09/30 22:59:26 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.87	
[09/30 22:59:26 visual_prompt]: Training 56 / 100 epoch, with learning rate 5.0
[09/30 23:05:54 visual_prompt]: Epoch 56 / 100: avg data time: 1.06e+01, avg batch time: 11.0808, average train loss: 1.3722
[09/30 23:06:39 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2266, average loss: 1.2876
[09/30 23:06:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.62	
[09/30 23:06:39 visual_prompt]: Training 57 / 100 epoch, with learning rate 4.8255025164874965
[09/30 23:13:08 visual_prompt]: Epoch 57 / 100: avg data time: 1.06e+01, avg batch time: 11.0863, average train loss: 1.0098
[09/30 23:13:53 visual_prompt]: Inference (val):avg data time: 3.08e-05, avg batch time: 0.2212, average loss: 1.2131
[09/30 23:13:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.31	
[09/30 23:13:53 visual_prompt]: Training 58 / 100 epoch, with learning rate 4.651217631279374
[09/30 23:20:20 visual_prompt]: Epoch 58 / 100: avg data time: 1.06e+01, avg batch time: 11.0425, average train loss: 1.4958
[09/30 23:21:05 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2225, average loss: 1.5467
[09/30 23:21:05 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 59.02	
[09/30 23:21:05 visual_prompt]: Training 59 / 100 epoch, with learning rate 4.477357683661733
[09/30 23:27:32 visual_prompt]: Epoch 59 / 100: avg data time: 1.06e+01, avg batch time: 11.0565, average train loss: 2.4411
[09/30 23:28:17 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2083, average loss: 6.2149
[09/30 23:28:17 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 43.61	
[09/30 23:28:17 visual_prompt]: Training 60 / 100 epoch, with learning rate 4.3041344951996745
[09/30 23:34:44 visual_prompt]: Epoch 60 / 100: avg data time: 1.06e+01, avg batch time: 11.0550, average train loss: 2.8505
[09/30 23:35:29 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.2310, average loss: 1.3911
[09/30 23:35:29 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 42.10	
[09/30 23:35:29 visual_prompt]: Training 61 / 100 epoch, with learning rate 4.131759111665349
[09/30 23:41:57 visual_prompt]: Epoch 61 / 100: avg data time: 1.06e+01, avg batch time: 11.0688, average train loss: 1.1729
[09/30 23:42:42 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2101, average loss: 0.8557
[09/30 23:42:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 49.87	
[09/30 23:42:42 visual_prompt]: Training 62 / 100 epoch, with learning rate 3.960441545911204
[09/30 23:49:11 visual_prompt]: Epoch 62 / 100: avg data time: 1.06e+01, avg batch time: 11.1143, average train loss: 1.2919
[09/30 23:49:57 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.2461, average loss: 1.4476
[09/30 23:49:57 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 48.21	
[09/30 23:49:57 visual_prompt]: Training 63 / 100 epoch, with learning rate 3.790390522001662
[09/30 23:56:25 visual_prompt]: Epoch 63 / 100: avg data time: 1.06e+01, avg batch time: 11.0740, average train loss: 0.8453
[09/30 23:57:10 visual_prompt]: Inference (val):avg data time: 2.09e-05, avg batch time: 0.2219, average loss: 0.7021
[09/30 23:57:10 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.12	
[09/30 23:57:10 visual_prompt]: Training 64 / 100 epoch, with learning rate 3.6218132209150045
[10/01 00:03:38 visual_prompt]: Epoch 64 / 100: avg data time: 1.06e+01, avg batch time: 11.0644, average train loss: 1.0964
[10/01 00:04:23 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2100, average loss: 2.2155
[10/01 00:04:23 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.66	
[10/01 00:04:23 visual_prompt]: Training 65 / 100 epoch, with learning rate 3.454915028125263
[10/01 00:10:51 visual_prompt]: Epoch 65 / 100: avg data time: 1.06e+01, avg batch time: 11.0818, average train loss: 0.9961
[10/01 00:11:36 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.2162, average loss: 0.6994
[10/01 00:11:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.05	
[10/01 00:11:36 visual_prompt]: Training 66 / 100 epoch, with learning rate 3.289899283371657
[10/01 00:18:05 visual_prompt]: Epoch 66 / 100: avg data time: 1.06e+01, avg batch time: 11.0934, average train loss: 0.7672
[10/01 00:18:50 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.2500, average loss: 0.7687
[10/01 00:18:50 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.78	
[10/01 00:18:50 visual_prompt]: Training 67 / 100 epoch, with learning rate 3.1269670329204398
[10/01 00:25:18 visual_prompt]: Epoch 67 / 100: avg data time: 1.06e+01, avg batch time: 11.0691, average train loss: 0.8995
[10/01 00:26:03 visual_prompt]: Inference (val):avg data time: 2.77e-05, avg batch time: 0.2913, average loss: 0.9413
[10/01 00:26:03 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 52.16	
[10/01 00:26:03 visual_prompt]: Training 68 / 100 epoch, with learning rate 2.9663167846209997
[10/01 00:32:30 visual_prompt]: Epoch 68 / 100: avg data time: 1.06e+01, avg batch time: 11.0530, average train loss: 0.7810
[10/01 00:33:15 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.2324, average loss: 0.7451
[10/01 00:33:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.42	
[10/01 00:33:15 visual_prompt]: Training 69 / 100 epoch, with learning rate 2.8081442660546125
[10/01 00:39:41 visual_prompt]: Epoch 69 / 100: avg data time: 1.06e+01, avg batch time: 11.0236, average train loss: 0.9720
[10/01 00:40:27 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.2306, average loss: 0.7494
[10/01 00:40:27 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 47.56	
[10/01 00:40:27 visual_prompt]: Training 70 / 100 epoch, with learning rate 2.6526421860705476
[10/01 00:46:53 visual_prompt]: Epoch 70 / 100: avg data time: 1.06e+01, avg batch time: 11.0395, average train loss: 0.9550
[10/01 00:47:39 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.2458, average loss: 0.6911
[10/01 00:47:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.69	
[10/01 00:47:39 visual_prompt]: Training 71 / 100 epoch, with learning rate 2.500000000000001
[10/01 00:54:04 visual_prompt]: Epoch 71 / 100: avg data time: 1.05e+01, avg batch time: 11.0017, average train loss: 0.8089
[10/01 00:54:49 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2196, average loss: 0.7283
[10/01 00:54:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.14	
[10/01 00:54:49 visual_prompt]: Training 72 / 100 epoch, with learning rate 2.350403678833976
[10/01 01:01:14 visual_prompt]: Epoch 72 / 100: avg data time: 1.05e+01, avg batch time: 10.9944, average train loss: 0.8310
[10/01 01:01:59 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2582, average loss: 0.6934
[10/01 01:01:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.46	
[10/01 01:01:59 visual_prompt]: Training 73 / 100 epoch, with learning rate 2.2040354826462667
[10/01 01:08:25 visual_prompt]: Epoch 73 / 100: avg data time: 1.06e+01, avg batch time: 11.0126, average train loss: 0.8305
[10/01 01:09:10 visual_prompt]: Inference (val):avg data time: 2.10e-05, avg batch time: 0.2207, average loss: 0.7707
[10/01 01:09:10 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 49.42	
[10/01 01:09:10 visual_prompt]: Training 74 / 100 epoch, with learning rate 2.061073738537635
[10/01 01:15:37 visual_prompt]: Epoch 74 / 100: avg data time: 1.06e+01, avg batch time: 11.0461, average train loss: 0.7650
[10/01 01:16:22 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.1942, average loss: 0.7185
[10/01 01:16:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 49.55	
[10/01 01:16:22 visual_prompt]: Training 75 / 100 epoch, with learning rate 1.9216926233717087
[10/01 01:22:51 visual_prompt]: Epoch 75 / 100: avg data time: 1.06e+01, avg batch time: 11.1034, average train loss: 0.8444
[10/01 01:23:36 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2174, average loss: 0.6925
[10/01 01:23:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.50	
[10/01 01:23:36 visual_prompt]: Training 76 / 100 epoch, with learning rate 1.7860619515673033
[10/01 01:30:02 visual_prompt]: Epoch 76 / 100: avg data time: 1.05e+01, avg batch time: 11.0294, average train loss: 0.7825
[10/01 01:30:47 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2056, average loss: 0.6954
[10/01 01:30:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.10	
[10/01 01:30:47 visual_prompt]: Training 77 / 100 epoch, with learning rate 1.6543469682057106
[10/01 01:37:15 visual_prompt]: Epoch 77 / 100: avg data time: 1.06e+01, avg batch time: 11.0518, average train loss: 0.8615
[10/01 01:38:00 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.2315, average loss: 0.8197
[10/01 01:38:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 51.73	
[10/01 01:38:00 visual_prompt]: Training 78 / 100 epoch, with learning rate 1.5267081477050133
[10/01 01:44:27 visual_prompt]: Epoch 78 / 100: avg data time: 1.06e+01, avg batch time: 11.0681, average train loss: 0.7641
[10/01 01:45:12 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2049, average loss: 0.9857
[10/01 01:45:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 50.19	
[10/01 01:45:12 visual_prompt]: Training 79 / 100 epoch, with learning rate 1.403300998306745
[10/01 01:51:39 visual_prompt]: Epoch 79 / 100: avg data time: 1.06e+01, avg batch time: 11.0494, average train loss: 0.7429
[10/01 01:52:25 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2537, average loss: 0.6998
[10/01 01:52:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.10	
[10/01 01:52:25 visual_prompt]: Training 80 / 100 epoch, with learning rate 1.2842758726130281
[10/01 01:58:54 visual_prompt]: Epoch 80 / 100: avg data time: 1.06e+01, avg batch time: 11.0985, average train loss: 0.7104
[10/01 01:59:39 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.2260, average loss: 0.6908
[10/01 01:59:39 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.52	
[10/01 01:59:39 visual_prompt]: Training 81 / 100 epoch, with learning rate 1.1697777844051105
[10/01 02:06:09 visual_prompt]: Epoch 81 / 100: avg data time: 1.07e+01, avg batch time: 11.1153, average train loss: 0.7247
[10/01 02:06:54 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2180, average loss: 0.8889
[10/01 02:06:54 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.81	
[10/01 02:06:54 visual_prompt]: Training 82 / 100 epoch, with learning rate 1.0599462319663906
[10/01 02:13:21 visual_prompt]: Epoch 82 / 100: avg data time: 1.06e+01, avg batch time: 11.0492, average train loss: 0.7386
[10/01 02:14:06 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.2390, average loss: 0.6907
[10/01 02:14:06 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 53.15	
[10/01 02:14:06 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.9549150281252633
[10/01 02:20:33 visual_prompt]: Epoch 83 / 100: avg data time: 1.06e+01, avg batch time: 11.0627, average train loss: 0.7189
[10/01 02:21:18 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2213, average loss: 0.7432
[10/01 02:21:18 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.97	
[10/01 02:21:18 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.8548121372247919
[10/01 02:27:45 visual_prompt]: Epoch 84 / 100: avg data time: 1.06e+01, avg batch time: 11.0252, average train loss: 0.7196
[10/01 02:28:30 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.2728, average loss: 0.6953
[10/01 02:28:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.95	
[10/01 02:28:30 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.7597595192178702
[10/01 02:34:57 visual_prompt]: Epoch 85 / 100: avg data time: 1.06e+01, avg batch time: 11.0470, average train loss: 0.7137
[10/01 02:35:42 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2139, average loss: 0.6955
[10/01 02:35:42 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.05	
[10/01 02:35:42 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.6698729810778065
[10/01 02:42:08 visual_prompt]: Epoch 86 / 100: avg data time: 1.05e+01, avg batch time: 11.0181, average train loss: 0.7163
[10/01 02:42:53 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.2001, average loss: 0.6957
[10/01 02:42:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.38	
[10/01 02:42:53 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.5852620357053651
[10/01 02:49:20 visual_prompt]: Epoch 87 / 100: avg data time: 1.06e+01, avg batch time: 11.0478, average train loss: 0.7033
[10/01 02:50:05 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2114, average loss: 0.6892
[10/01 02:50:05 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.46	
[10/01 02:50:05 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.5060297685041659
[10/01 02:56:31 visual_prompt]: Epoch 88 / 100: avg data time: 1.06e+01, avg batch time: 11.0396, average train loss: 0.6892
[10/01 02:57:17 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.2068, average loss: 0.6980
[10/01 02:57:17 visual_prompt]: Classification results with val_mammo-cbis: top1: 50.00	rocauc: 54.80	
[10/01 02:57:17 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.4322727117869951
[10/01 03:03:45 visual_prompt]: Epoch 89 / 100: avg data time: 1.06e+01, avg batch time: 11.0846, average train loss: 0.7054
[10/01 03:04:30 visual_prompt]: Inference (val):avg data time: 2.09e-05, avg batch time: 0.2630, average loss: 0.7222
[10/01 03:04:30 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 51.56	
[10/01 03:04:30 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.36408072716606343
[10/01 03:10:56 visual_prompt]: Epoch 90 / 100: avg data time: 1.06e+01, avg batch time: 11.0187, average train loss: 0.7077
[10/01 03:11:41 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.2330, average loss: 0.6929
[10/01 03:11:41 visual_prompt]: Classification results with val_mammo-cbis: top1: 51.22	rocauc: 52.23	
[10/01 03:11:41 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.3015368960704584
[10/01 03:18:09 visual_prompt]: Epoch 91 / 100: avg data time: 1.06e+01, avg batch time: 11.0736, average train loss: 0.6999
[10/01 03:18:54 visual_prompt]: Inference (val):avg data time: 2.59e-05, avg batch time: 0.2161, average loss: 0.7140
[10/01 03:18:54 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 52.52	
[10/01 03:18:54 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.24471741852423234
[10/01 03:25:20 visual_prompt]: Epoch 92 / 100: avg data time: 1.06e+01, avg batch time: 11.0326, average train loss: 0.6961
[10/01 03:26:05 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2114, average loss: 0.7543
[10/01 03:26:05 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.36	
[10/01 03:26:05 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.19369152030840553
[10/01 03:32:32 visual_prompt]: Epoch 93 / 100: avg data time: 1.06e+01, avg batch time: 11.0500, average train loss: 0.7038
[10/01 03:33:18 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.2298, average loss: 0.7014
[10/01 03:33:18 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.03	
[10/01 03:33:18 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.14852136862001764
[10/01 03:39:42 visual_prompt]: Epoch 94 / 100: avg data time: 1.05e+01, avg batch time: 10.9570, average train loss: 0.6923
[10/01 03:40:26 visual_prompt]: Inference (val):avg data time: 2.57e-05, avg batch time: 0.2364, average loss: 0.6871
[10/01 03:40:27 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.10	rocauc: 54.26	
[10/01 03:40:27 visual_prompt]: Best epoch 94: best metric: 0.561
[10/01 03:40:27 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.10926199633097156
[10/01 03:46:53 visual_prompt]: Epoch 95 / 100: avg data time: 1.06e+01, avg batch time: 11.0245, average train loss: 0.6881
[10/01 03:47:38 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.1922, average loss: 0.6859
[10/01 03:47:38 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.28	rocauc: 55.60	
[10/01 03:47:38 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.0759612349389599
[10/01 03:54:03 visual_prompt]: Epoch 96 / 100: avg data time: 1.05e+01, avg batch time: 11.0106, average train loss: 0.6871
[10/01 03:54:48 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2382, average loss: 0.6960
[10/01 03:54:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.69	rocauc: 55.22	
[10/01 03:54:48 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.04865965629214819
[10/01 04:01:15 visual_prompt]: Epoch 97 / 100: avg data time: 1.06e+01, avg batch time: 11.0479, average train loss: 0.6870
[10/01 04:02:00 visual_prompt]: Inference (val):avg data time: 2.54e-05, avg batch time: 0.2320, average loss: 0.6880
[10/01 04:02:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.69	rocauc: 55.34	
[10/01 04:02:00 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.02739052315863355
[10/01 04:08:27 visual_prompt]: Epoch 98 / 100: avg data time: 1.06e+01, avg batch time: 11.0512, average train loss: 0.6797
[10/01 04:09:12 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2344, average loss: 0.6867
[10/01 04:09:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 51.63	rocauc: 55.42	
[10/01 04:09:12 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.012179748700879012
[10/01 04:15:40 visual_prompt]: Epoch 99 / 100: avg data time: 1.06e+01, avg batch time: 11.0550, average train loss: 0.6797
[10/01 04:16:25 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.2168, average loss: 0.6871
[10/01 04:16:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 52.44	rocauc: 55.60	
[10/01 04:16:25 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0030458649045211894
[10/01 04:22:53 visual_prompt]: Epoch 100 / 100: avg data time: 1.06e+01, avg batch time: 11.0726, average train loss: 0.6838
[10/01 04:23:38 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2380, average loss: 0.6872
[10/01 04:23:38 visual_prompt]: Classification results with val_mammo-cbis: top1: 52.44	rocauc: 55.64	
[10/01 04:23:38 visual_prompt]: Rank of current process: 0. World size: 1
[10/01 04:23:38 visual_prompt]: Environment info:
-------------------  -------------------------------------------------
Python               3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              2.0.1+cu118
PyTorch Debug Build  False
CUDA available       True
CUDA ID              0
GPU 0                NVIDIA A100-PCIE-40GB
Pillow               9.3.0
cv2                  4.8.0
-------------------  -------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[10/01 04:23:38 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', train_type='prompt', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '50', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'mammo-cbis', 'DATA.NUMBER_CLASSES', '2', 'DATA.CROPSIZE', '224', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir'])
[10/01 04:23:38 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[10/01 04:23:38 visual_prompt]: Training with config:
[10/01 04:23:38 visual_prompt]: CfgNode({'DBG': False, 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/mammo-cbis/sup_vitb16_imagenet21k/prompt50/crop224/val/seed0/lr10.0_wd0.0/run1', 'RUN_N_TIMES': 1, 'CUDNN_BENCHMARK': False, 'NUM_GPUS': 1, 'NUM_SHARDS': 1, 'SEED': 0, 'MODEL': CfgNode({'TRANSFER_TYPE': 'prompt', 'WEIGHT_PATH': '', 'SAVE_CKPT': False, 'MODEL_ROOT': 'visual_prompt_tuning/model_root', 'TYPE': 'vit', 'MLP_NUM': 0, 'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}), 'PROMPT': CfgNode({'NUM_TOKENS': 50, 'LOCATION': 'prepend', 'INITIATION': 'random', 'CLSEMB_FOLDER': '', 'CLSEMB_PATH': '', 'PROJECT': -1, 'DEEP': True, 'NUM_DEEP_LAYERS': None, 'REVERSE_DEEP': False, 'DEEP_SHARED': False, 'FORWARD_DEEP_NOEXPAND': False, 'VIT_POOL_TYPE': 'original', 'DROPOUT': 0.1, 'SAVE_FOR_EACH_EPOCH': False}), 'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'})}), 'SOLVER': CfgNode({'LOSS': 'softmax', 'LOSS_ALPHA': 0.01, 'OPTIMIZER': 'sgd', 'MOMENTUM': 0.9, 'WEIGHT_DECAY': 0.0, 'WEIGHT_DECAY_BIAS': 0, 'PATIENCE': 300, 'SCHEDULER': 'cosine', 'BASE_LR': 10.0, 'BIAS_MULTIPLIER': 1.0, 'WARMUP_EPOCH': 10, 'TOTAL_EPOCH': 100, 'LOG_EVERY_N': 100, 'DBG_TRAINABLE': False}), 'DATA': CfgNode({'NAME': 'mammo-cbis', 'DATAPATH': 'visual_prompt_tuning/data_path', 'FEATURE': 'sup_vitb16_imagenet21k', 'PERCENTAGE': 1.0, 'NUMBER_CLASSES': 2, 'MULTILABEL': False, 'CLASS_WEIGHTS_TYPE': 'none', 'CROPSIZE': 224, 'NO_TEST': False, 'BATCH_SIZE': 64, 'NUM_WORKERS': 4, 'PIN_MEMORY': True})})
[10/01 04:23:38 visual_prompt]: Loading training data...
[10/01 04:23:38 visual_prompt]: Constructing mammo-cbis dataset train...
[10/01 04:23:38 visual_prompt]: Loading validation data...
[10/01 04:23:38 visual_prompt]: Constructing mammo-cbis dataset val...
[10/01 04:23:38 visual_prompt]: Constructing models...
[10/01 04:23:41 visual_prompt]: Total Parameters: 86260994	 Gradient Parameters: 462338
[10/01 04:23:41 visual_prompt]: tuned percent:0.536
[10/01 04:23:41 visual_prompt]: Device used for model: 0
[10/01 04:23:41 visual_prompt]: Setting up Evaluator...
[10/01 04:23:41 visual_prompt]: Setting up Trainer...
[10/01 04:23:41 visual_prompt]: 	Setting up the optimizer...
[10/01 04:23:41 visual_prompt]: Training 1 / 100 epoch, with learning rate 0.0
[10/01 04:30:07 visual_prompt]: Epoch 1 / 100: avg data time: 1.06e+01, avg batch time: 11.0276, average train loss: 1.4903
[10/01 04:30:52 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2153, average loss: 1.4710
[10/01 04:30:52 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.15	
[10/01 04:30:52 visual_prompt]: Best epoch 1: best metric: 0.537
[10/01 04:30:52 visual_prompt]: Training 2 / 100 epoch, with learning rate 1.0
[10/01 04:37:20 visual_prompt]: Epoch 2 / 100: avg data time: 1.06e+01, avg batch time: 11.0910, average train loss: 14.5946
[10/01 04:38:06 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2121, average loss: 2.6024
[10/01 04:38:06 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 45.75	
[10/01 04:38:06 visual_prompt]: Training 3 / 100 epoch, with learning rate 2.0
[10/01 04:44:34 visual_prompt]: Epoch 3 / 100: avg data time: 1.06e+01, avg batch time: 11.0672, average train loss: 2.3128
[10/01 04:45:19 visual_prompt]: Inference (val):avg data time: 2.32e-05, avg batch time: 0.2229, average loss: 6.9444
[10/01 04:45:19 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 50.75	
[10/01 04:45:19 visual_prompt]: Training 4 / 100 epoch, with learning rate 3.0
[10/01 04:51:47 visual_prompt]: Epoch 4 / 100: avg data time: 1.06e+01, avg batch time: 11.0708, average train loss: 6.3240
[10/01 04:52:33 visual_prompt]: Inference (val):avg data time: 2.80e-05, avg batch time: 0.2283, average loss: 12.1476
[10/01 04:52:33 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.78	
[10/01 04:52:33 visual_prompt]: Training 5 / 100 epoch, with learning rate 4.0
[10/01 04:59:00 visual_prompt]: Epoch 5 / 100: avg data time: 1.06e+01, avg batch time: 11.0639, average train loss: 9.3637
[10/01 04:59:46 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.2838, average loss: 9.3815
[10/01 04:59:46 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.06	
[10/01 04:59:46 visual_prompt]: Training 6 / 100 epoch, with learning rate 5.0
[10/01 05:06:16 visual_prompt]: Epoch 6 / 100: avg data time: 1.06e+01, avg batch time: 11.1307, average train loss: 9.1704
[10/01 05:07:02 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.2367, average loss: 18.3163
[10/01 05:07:02 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.73	
[10/01 05:07:02 visual_prompt]: Training 7 / 100 epoch, with learning rate 6.0
[10/01 05:13:30 visual_prompt]: Epoch 7 / 100: avg data time: 1.06e+01, avg batch time: 11.0823, average train loss: 5.5885
[10/01 05:14:15 visual_prompt]: Inference (val):avg data time: 2.83e-05, avg batch time: 0.2374, average loss: 1.0874
[10/01 05:14:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.99	
[10/01 05:14:15 visual_prompt]: Training 8 / 100 epoch, with learning rate 7.0
[10/01 05:20:43 visual_prompt]: Epoch 8 / 100: avg data time: 1.06e+01, avg batch time: 11.0622, average train loss: 11.5814
[10/01 05:21:28 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1989, average loss: 27.9992
[10/01 05:21:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 43.01	
[10/01 05:21:28 visual_prompt]: Training 9 / 100 epoch, with learning rate 8.0
[10/01 05:27:55 visual_prompt]: Epoch 9 / 100: avg data time: 1.06e+01, avg batch time: 11.0461, average train loss: 8.9936
[10/01 05:28:41 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.2262, average loss: 27.0857
[10/01 05:28:41 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.26	
[10/01 05:28:41 visual_prompt]: Training 10 / 100 epoch, with learning rate 9.0
[10/01 05:35:08 visual_prompt]: Epoch 10 / 100: avg data time: 1.06e+01, avg batch time: 11.0488, average train loss: 7.6484
[10/01 05:35:53 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.2087, average loss: 2.6676
[10/01 05:35:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.95	
[10/01 05:35:53 visual_prompt]: Training 11 / 100 epoch, with learning rate 10.0
[10/01 05:42:21 visual_prompt]: Epoch 11 / 100: avg data time: 1.06e+01, avg batch time: 11.0622, average train loss: 25.3558
[10/01 05:43:06 visual_prompt]: Inference (val):avg data time: 2.29e-05, avg batch time: 0.2835, average loss: 18.2167
[10/01 05:43:06 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 61.66	
[10/01 05:43:06 visual_prompt]: Training 12 / 100 epoch, with learning rate 9.996954135095478
[10/01 05:49:33 visual_prompt]: Epoch 12 / 100: avg data time: 1.06e+01, avg batch time: 11.0500, average train loss: 12.3539
[10/01 05:50:19 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2065, average loss: 8.0706
[10/01 05:50:19 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.88	
[10/01 05:50:19 visual_prompt]: Training 13 / 100 epoch, with learning rate 9.987820251299121
[10/01 05:56:46 visual_prompt]: Epoch 13 / 100: avg data time: 1.06e+01, avg batch time: 11.0725, average train loss: 24.9871
[10/01 05:57:32 visual_prompt]: Inference (val):avg data time: 2.63e-05, avg batch time: 0.2124, average loss: 0.7974
[10/01 05:57:32 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.67	
[10/01 05:57:32 visual_prompt]: Training 14 / 100 epoch, with learning rate 9.972609476841367
[10/01 06:04:00 visual_prompt]: Epoch 14 / 100: avg data time: 1.06e+01, avg batch time: 11.0706, average train loss: 8.8591
[10/01 06:04:45 visual_prompt]: Inference (val):avg data time: 2.76e-05, avg batch time: 0.2303, average loss: 8.9390
[10/01 06:04:45 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.43	
[10/01 06:04:45 visual_prompt]: Training 15 / 100 epoch, with learning rate 9.951340343707852
[10/01 06:11:14 visual_prompt]: Epoch 15 / 100: avg data time: 1.06e+01, avg batch time: 11.0856, average train loss: 12.0120
[10/01 06:11:59 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.2580, average loss: 6.2747
[10/01 06:11:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.10	
[10/01 06:11:59 visual_prompt]: Training 16 / 100 epoch, with learning rate 9.924038765061042
[10/01 06:18:26 visual_prompt]: Epoch 16 / 100: avg data time: 1.05e+01, avg batch time: 11.0396, average train loss: 6.9373
[10/01 06:19:11 visual_prompt]: Inference (val):avg data time: 2.44e-05, avg batch time: 0.2300, average loss: 2.2199
[10/01 06:19:11 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.67	
[10/01 06:19:11 visual_prompt]: Training 17 / 100 epoch, with learning rate 9.890738003669028
[10/01 06:25:37 visual_prompt]: Epoch 17 / 100: avg data time: 1.05e+01, avg batch time: 11.0194, average train loss: 14.3748
[10/01 06:26:22 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.2094, average loss: 13.5265
[10/01 06:26:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.41	
[10/01 06:26:22 visual_prompt]: Training 18 / 100 epoch, with learning rate 9.851478631379981
[10/01 06:32:51 visual_prompt]: Epoch 18 / 100: avg data time: 1.06e+01, avg batch time: 11.1134, average train loss: 13.9305
[10/01 06:33:37 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2146, average loss: 5.8715
[10/01 06:33:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.01	
[10/01 06:33:37 visual_prompt]: Training 19 / 100 epoch, with learning rate 9.806308479691594
[10/01 06:40:04 visual_prompt]: Epoch 19 / 100: avg data time: 1.06e+01, avg batch time: 11.0473, average train loss: 6.9749
[10/01 06:40:49 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2682, average loss: 13.5298
[10/01 06:40:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.27	
[10/01 06:40:49 visual_prompt]: Training 20 / 100 epoch, with learning rate 9.755282581475768
[10/01 06:47:15 visual_prompt]: Epoch 20 / 100: avg data time: 1.06e+01, avg batch time: 11.0327, average train loss: 10.7676
[10/01 06:48:01 visual_prompt]: Inference (val):avg data time: 2.04e-05, avg batch time: 0.2045, average loss: 5.9102
[10/01 06:48:01 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.71	
[10/01 06:48:01 visual_prompt]: Training 21 / 100 epoch, with learning rate 9.698463103929543
[10/01 06:54:29 visual_prompt]: Epoch 21 / 100: avg data time: 1.06e+01, avg batch time: 11.0685, average train loss: 6.9116
[10/01 06:55:14 visual_prompt]: Inference (val):avg data time: 2.25e-05, avg batch time: 0.2131, average loss: 6.4060
[10/01 06:55:14 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 53.92	
[10/01 06:55:14 visual_prompt]: Training 22 / 100 epoch, with learning rate 9.635919272833938
[10/01 07:01:40 visual_prompt]: Epoch 22 / 100: avg data time: 1.05e+01, avg batch time: 11.0180, average train loss: 6.2300
[10/01 07:02:25 visual_prompt]: Inference (val):avg data time: 2.27e-05, avg batch time: 0.2721, average loss: 1.8660
[10/01 07:02:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.14	
[10/01 07:02:25 visual_prompt]: Training 23 / 100 epoch, with learning rate 9.567727288213003
[10/01 07:08:49 visual_prompt]: Epoch 23 / 100: avg data time: 1.05e+01, avg batch time: 10.9743, average train loss: 10.3801
[10/01 07:09:34 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2262, average loss: 16.5881
[10/01 07:09:34 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.19	
[10/01 07:09:34 visual_prompt]: Training 24 / 100 epoch, with learning rate 9.493970231495835
[10/01 07:15:59 visual_prompt]: Epoch 24 / 100: avg data time: 1.05e+01, avg batch time: 10.9843, average train loss: 11.7915
[10/01 07:16:44 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2132, average loss: 5.3909
[10/01 07:16:44 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.86	
[10/01 07:16:44 visual_prompt]: Training 25 / 100 epoch, with learning rate 9.414737964294634
[10/01 07:23:11 visual_prompt]: Epoch 25 / 100: avg data time: 1.06e+01, avg batch time: 11.0593, average train loss: 3.2203
[10/01 07:23:57 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.2287, average loss: 1.9154
[10/01 07:23:57 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.30	
[10/01 07:23:57 visual_prompt]: Training 26 / 100 epoch, with learning rate 9.330127018922195
[10/01 07:30:23 visual_prompt]: Epoch 26 / 100: avg data time: 1.06e+01, avg batch time: 11.0234, average train loss: 8.6558
[10/01 07:31:08 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.3058, average loss: 14.6252
[10/01 07:31:08 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.68	
[10/01 07:31:08 visual_prompt]: Training 27 / 100 epoch, with learning rate 9.240240480782129
[10/01 07:37:35 visual_prompt]: Epoch 27 / 100: avg data time: 1.06e+01, avg batch time: 11.0356, average train loss: 5.4314
[10/01 07:38:20 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2465, average loss: 9.3992
[10/01 07:38:20 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.81	
[10/01 07:38:20 visual_prompt]: Training 28 / 100 epoch, with learning rate 9.145187862775208
[10/01 07:44:47 visual_prompt]: Epoch 28 / 100: avg data time: 1.06e+01, avg batch time: 11.0375, average train loss: 7.1160
[10/01 07:45:32 visual_prompt]: Inference (val):avg data time: 2.36e-05, avg batch time: 0.2383, average loss: 3.1147
[10/01 07:45:32 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.15	
[10/01 07:45:32 visual_prompt]: Training 29 / 100 epoch, with learning rate 9.045084971874736
[10/01 07:51:59 visual_prompt]: Epoch 29 / 100: avg data time: 1.06e+01, avg batch time: 11.0450, average train loss: 6.0609
[10/01 07:52:44 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2354, average loss: 10.5211
[10/01 07:52:44 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.02	
[10/01 07:52:44 visual_prompt]: Training 30 / 100 epoch, with learning rate 8.940053768033609
[10/01 07:59:11 visual_prompt]: Epoch 30 / 100: avg data time: 1.06e+01, avg batch time: 11.0515, average train loss: 5.2597
[10/01 07:59:57 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.2842, average loss: 2.5436
[10/01 07:59:57 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.96	
[10/01 07:59:57 visual_prompt]: Training 31 / 100 epoch, with learning rate 8.83022221559489
[10/01 08:06:24 visual_prompt]: Epoch 31 / 100: avg data time: 1.06e+01, avg batch time: 11.0363, average train loss: 3.4746
[10/01 08:07:09 visual_prompt]: Inference (val):avg data time: 2.60e-05, avg batch time: 0.2271, average loss: 6.0780
[10/01 08:07:09 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.28	
[10/01 08:07:09 visual_prompt]: Training 32 / 100 epoch, with learning rate 8.715724127386972
[10/01 08:13:36 visual_prompt]: Epoch 32 / 100: avg data time: 1.06e+01, avg batch time: 11.0603, average train loss: 6.2834
[10/01 08:14:22 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.2291, average loss: 0.7035
[10/01 08:14:22 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.75	rocauc: 55.41	
[10/01 08:14:22 visual_prompt]: Training 33 / 100 epoch, with learning rate 8.596699001693256
[10/01 08:20:51 visual_prompt]: Epoch 33 / 100: avg data time: 1.07e+01, avg batch time: 11.1080, average train loss: 2.6184
[10/01 08:21:36 visual_prompt]: Inference (val):avg data time: 2.10e-05, avg batch time: 0.2292, average loss: 1.8850
[10/01 08:21:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.38	
[10/01 08:21:36 visual_prompt]: Training 34 / 100 epoch, with learning rate 8.473291852294986
[10/01 08:28:04 visual_prompt]: Epoch 34 / 100: avg data time: 1.06e+01, avg batch time: 11.0755, average train loss: 7.8667
[10/01 08:28:49 visual_prompt]: Inference (val):avg data time: 2.48e-05, avg batch time: 0.1942, average loss: 18.6201
[10/01 08:28:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.57	
[10/01 08:28:49 visual_prompt]: Training 35 / 100 epoch, with learning rate 8.345653031794292
[10/01 08:35:15 visual_prompt]: Epoch 35 / 100: avg data time: 1.06e+01, avg batch time: 11.0164, average train loss: 4.3461
[10/01 08:36:00 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.2171, average loss: 1.3742
[10/01 08:36:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.44	
[10/01 08:36:00 visual_prompt]: Training 36 / 100 epoch, with learning rate 8.213938048432697
[10/01 08:42:29 visual_prompt]: Epoch 36 / 100: avg data time: 1.06e+01, avg batch time: 11.0890, average train loss: 4.7939
[10/01 08:43:14 visual_prompt]: Inference (val):avg data time: 2.24e-05, avg batch time: 0.2312, average loss: 6.9733
[10/01 08:43:14 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.63	
[10/01 08:43:14 visual_prompt]: Training 37 / 100 epoch, with learning rate 8.078307376628292
[10/01 08:49:42 visual_prompt]: Epoch 37 / 100: avg data time: 1.06e+01, avg batch time: 11.0647, average train loss: 3.7428
[10/01 08:50:27 visual_prompt]: Inference (val):avg data time: 2.47e-05, avg batch time: 0.2185, average loss: 1.1163
[10/01 08:50:27 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.14	
[10/01 08:50:27 visual_prompt]: Training 38 / 100 epoch, with learning rate 7.938926261462366
[10/01 08:56:55 visual_prompt]: Epoch 38 / 100: avg data time: 1.06e+01, avg batch time: 11.0597, average train loss: 1.6473
[10/01 08:57:40 visual_prompt]: Inference (val):avg data time: 2.69e-05, avg batch time: 0.2265, average loss: 1.7395
[10/01 08:57:40 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.29	
[10/01 08:57:40 visual_prompt]: Training 39 / 100 epoch, with learning rate 7.795964517353734
[10/01 09:04:08 visual_prompt]: Epoch 39 / 100: avg data time: 1.06e+01, avg batch time: 11.0625, average train loss: 4.5854
[10/01 09:04:53 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2124, average loss: 6.6314
[10/01 09:04:53 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.83	
[10/01 09:04:53 visual_prompt]: Training 40 / 100 epoch, with learning rate 7.649596321166024
[10/01 09:11:22 visual_prompt]: Epoch 40 / 100: avg data time: 1.06e+01, avg batch time: 11.1154, average train loss: 7.8149
[10/01 09:12:07 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2079, average loss: 10.8073
[10/01 09:12:07 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.26	
[10/01 09:12:07 visual_prompt]: Training 41 / 100 epoch, with learning rate 7.5
[10/01 09:18:35 visual_prompt]: Epoch 41 / 100: avg data time: 1.06e+01, avg batch time: 11.0589, average train loss: 7.6434
[10/01 09:19:21 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.2609, average loss: 1.7410
[10/01 09:19:21 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.08	
[10/01 09:19:21 visual_prompt]: Training 42 / 100 epoch, with learning rate 7.347357813929454
[10/01 09:25:48 visual_prompt]: Epoch 42 / 100: avg data time: 1.06e+01, avg batch time: 11.0669, average train loss: 5.6353
[10/01 09:26:34 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2240, average loss: 14.9809
[10/01 09:26:34 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.42	
[10/01 09:26:34 visual_prompt]: Training 43 / 100 epoch, with learning rate 7.191855733945387
[10/01 09:33:02 visual_prompt]: Epoch 43 / 100: avg data time: 1.06e+01, avg batch time: 11.0824, average train loss: 8.7866
[10/01 09:33:47 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.2291, average loss: 0.8349
[10/01 09:33:47 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.03	
[10/01 09:33:47 visual_prompt]: Training 44 / 100 epoch, with learning rate 7.033683215379002
[10/01 09:40:14 visual_prompt]: Epoch 44 / 100: avg data time: 1.06e+01, avg batch time: 11.0557, average train loss: 4.2649
[10/01 09:41:00 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2367, average loss: 4.6777
[10/01 09:41:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.75	
[10/01 09:41:00 visual_prompt]: Training 45 / 100 epoch, with learning rate 6.873032967079561
[10/01 09:47:27 visual_prompt]: Epoch 45 / 100: avg data time: 1.06e+01, avg batch time: 11.0569, average train loss: 8.0786
[10/01 09:48:12 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2167, average loss: 3.4458
[10/01 09:48:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.20	
[10/01 09:48:12 visual_prompt]: Training 46 / 100 epoch, with learning rate 6.710100716628345
[10/01 09:54:40 visual_prompt]: Epoch 46 / 100: avg data time: 1.06e+01, avg batch time: 11.0687, average train loss: 7.6734
[10/01 09:55:25 visual_prompt]: Inference (val):avg data time: 2.42e-05, avg batch time: 0.2173, average loss: 3.0282
[10/01 09:55:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 55.34	
[10/01 09:55:25 visual_prompt]: Training 47 / 100 epoch, with learning rate 6.545084971874737
[10/01 10:01:52 visual_prompt]: Epoch 47 / 100: avg data time: 1.06e+01, avg batch time: 11.0458, average train loss: 6.4610
[10/01 10:02:37 visual_prompt]: Inference (val):avg data time: 2.74e-05, avg batch time: 0.2170, average loss: 6.2981
[10/01 10:02:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.99	
[10/01 10:02:37 visual_prompt]: Training 48 / 100 epoch, with learning rate 6.378186779084995
[10/01 10:09:05 visual_prompt]: Epoch 48 / 100: avg data time: 1.06e+01, avg batch time: 11.0784, average train loss: 6.7297
[10/01 10:09:51 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.2341, average loss: 10.0530
[10/01 10:09:51 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.83	
[10/01 10:09:51 visual_prompt]: Training 49 / 100 epoch, with learning rate 6.209609477998338
[10/01 10:16:19 visual_prompt]: Epoch 49 / 100: avg data time: 1.06e+01, avg batch time: 11.0690, average train loss: 4.3186
[10/01 10:17:04 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2065, average loss: 1.6298
[10/01 10:17:04 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 54.98	
[10/01 10:17:04 visual_prompt]: Training 50 / 100 epoch, with learning rate 6.039558454088796
[10/01 10:23:31 visual_prompt]: Epoch 50 / 100: avg data time: 1.06e+01, avg batch time: 11.0430, average train loss: 1.6587
[10/01 10:24:16 visual_prompt]: Inference (val):avg data time: 2.50e-05, avg batch time: 0.2145, average loss: 2.5538
[10/01 10:24:16 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 54.92	
[10/01 10:24:16 visual_prompt]: Training 51 / 100 epoch, with learning rate 5.868240888334652
[10/01 10:30:41 visual_prompt]: Epoch 51 / 100: avg data time: 1.05e+01, avg batch time: 10.9938, average train loss: 4.8961
[10/01 10:31:26 visual_prompt]: Inference (val):avg data time: 2.30e-05, avg batch time: 0.1924, average loss: 2.8789
[10/01 10:31:26 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.12	
[10/01 10:31:26 visual_prompt]: Training 52 / 100 epoch, with learning rate 5.695865504800327
[10/01 10:37:52 visual_prompt]: Epoch 52 / 100: avg data time: 1.05e+01, avg batch time: 11.0130, average train loss: 8.1431
[10/01 10:38:37 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.2064, average loss: 3.1533
[10/01 10:38:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 55.30	
[10/01 10:38:37 visual_prompt]: Training 53 / 100 epoch, with learning rate 5.522642316338268
[10/01 10:45:03 visual_prompt]: Epoch 53 / 100: avg data time: 1.05e+01, avg batch time: 11.0112, average train loss: 2.4457
[10/01 10:45:48 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2125, average loss: 2.7554
[10/01 10:45:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.13	
[10/01 10:45:48 visual_prompt]: Training 54 / 100 epoch, with learning rate 5.3487823687206255
[10/01 10:52:14 visual_prompt]: Epoch 54 / 100: avg data time: 1.05e+01, avg batch time: 11.0172, average train loss: 1.2461
[10/01 10:52:59 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2891, average loss: 0.7715
[10/01 10:52:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 48.78	rocauc: 56.60	
[10/01 10:52:59 visual_prompt]: Training 55 / 100 epoch, with learning rate 5.174497483512505
[10/01 10:59:26 visual_prompt]: Epoch 55 / 100: avg data time: 1.06e+01, avg batch time: 11.0552, average train loss: 0.9970
[10/01 11:00:12 visual_prompt]: Inference (val):avg data time: 2.66e-05, avg batch time: 0.2285, average loss: 0.8251
[10/01 11:00:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.25	
[10/01 11:00:12 visual_prompt]: Training 56 / 100 epoch, with learning rate 5.0
[10/01 11:06:38 visual_prompt]: Epoch 56 / 100: avg data time: 1.06e+01, avg batch time: 11.0421, average train loss: 1.4629
[10/01 11:07:24 visual_prompt]: Inference (val):avg data time: 2.51e-05, avg batch time: 0.3164, average loss: 4.1141
[10/01 11:07:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.66	
[10/01 11:07:24 visual_prompt]: Training 57 / 100 epoch, with learning rate 4.8255025164874965
[10/01 11:13:51 visual_prompt]: Epoch 57 / 100: avg data time: 1.06e+01, avg batch time: 11.0460, average train loss: 2.9864
[10/01 11:14:36 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2268, average loss: 1.7600
[10/01 11:14:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.24	
[10/01 11:14:36 visual_prompt]: Training 58 / 100 epoch, with learning rate 4.651217631279374
[10/01 11:21:03 visual_prompt]: Epoch 58 / 100: avg data time: 1.06e+01, avg batch time: 11.0379, average train loss: 1.1785
[10/01 11:21:48 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2508, average loss: 0.7133
[10/01 11:21:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.69	rocauc: 56.50	
[10/01 11:21:48 visual_prompt]: Best epoch 58: best metric: 0.557
[10/01 11:21:48 visual_prompt]: Training 59 / 100 epoch, with learning rate 4.477357683661733
[10/01 11:28:15 visual_prompt]: Epoch 59 / 100: avg data time: 1.06e+01, avg batch time: 11.0487, average train loss: 0.8784
[10/01 11:29:00 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2267, average loss: 1.1539
[10/01 11:29:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.30	
[10/01 11:29:00 visual_prompt]: Training 60 / 100 epoch, with learning rate 4.3041344951996745
[10/01 11:35:27 visual_prompt]: Epoch 60 / 100: avg data time: 1.06e+01, avg batch time: 11.0268, average train loss: 1.3053
[10/01 11:36:12 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.2623, average loss: 2.1339
[10/01 11:36:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.40	
[10/01 11:36:12 visual_prompt]: Training 61 / 100 epoch, with learning rate 4.131759111665349
[10/01 11:42:39 visual_prompt]: Epoch 61 / 100: avg data time: 1.06e+01, avg batch time: 11.0565, average train loss: 1.3426
[10/01 11:43:24 visual_prompt]: Inference (val):avg data time: 2.65e-05, avg batch time: 0.2338, average loss: 1.8106
[10/01 11:43:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 56.46	
[10/01 11:43:24 visual_prompt]: Training 62 / 100 epoch, with learning rate 3.960441545911204
[10/01 11:49:51 visual_prompt]: Epoch 62 / 100: avg data time: 1.06e+01, avg batch time: 11.0452, average train loss: 1.5117
[10/01 11:50:36 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.1929, average loss: 1.0871
[10/01 11:50:36 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 56.46	
[10/01 11:50:36 visual_prompt]: Training 63 / 100 epoch, with learning rate 3.790390522001662
[10/01 11:57:01 visual_prompt]: Epoch 63 / 100: avg data time: 1.05e+01, avg batch time: 11.0002, average train loss: 1.0296
[10/01 11:57:46 visual_prompt]: Inference (val):avg data time: 2.22e-05, avg batch time: 0.2146, average loss: 0.6919
[10/01 11:57:46 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.10	rocauc: 57.37	
[10/01 11:57:46 visual_prompt]: Best epoch 63: best metric: 0.561
[10/01 11:57:46 visual_prompt]: Training 64 / 100 epoch, with learning rate 3.6218132209150045
[10/01 12:04:13 visual_prompt]: Epoch 64 / 100: avg data time: 1.06e+01, avg batch time: 11.0511, average train loss: 0.9315
[10/01 12:04:59 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2633, average loss: 0.7335
[10/01 12:04:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.10	rocauc: 57.77	
[10/01 12:04:59 visual_prompt]: Training 65 / 100 epoch, with learning rate 3.454915028125263
[10/01 12:11:27 visual_prompt]: Epoch 65 / 100: avg data time: 1.06e+01, avg batch time: 11.0798, average train loss: 0.9380
[10/01 12:12:12 visual_prompt]: Inference (val):avg data time: 2.40e-05, avg batch time: 0.2398, average loss: 0.8808
[10/01 12:12:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.43	
[10/01 12:12:12 visual_prompt]: Training 66 / 100 epoch, with learning rate 3.289899283371657
[10/01 12:18:38 visual_prompt]: Epoch 66 / 100: avg data time: 1.06e+01, avg batch time: 11.0217, average train loss: 0.7710
[10/01 12:19:23 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.1917, average loss: 0.7967
[10/01 12:19:23 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.07	rocauc: 57.29	
[10/01 12:19:23 visual_prompt]: Training 67 / 100 epoch, with learning rate 3.1269670329204398
[10/01 12:25:50 visual_prompt]: Epoch 67 / 100: avg data time: 1.06e+01, avg batch time: 11.0393, average train loss: 0.9130
[10/01 12:26:35 visual_prompt]: Inference (val):avg data time: 2.21e-05, avg batch time: 0.2141, average loss: 0.9362
[10/01 12:26:35 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.05	
[10/01 12:26:35 visual_prompt]: Training 68 / 100 epoch, with learning rate 2.9663167846209997
[10/01 12:33:03 visual_prompt]: Epoch 68 / 100: avg data time: 1.06e+01, avg batch time: 11.0782, average train loss: 0.7881
[10/01 12:33:49 visual_prompt]: Inference (val):avg data time: 2.53e-05, avg batch time: 0.2262, average loss: 1.1020
[10/01 12:33:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.82	
[10/01 12:33:49 visual_prompt]: Training 69 / 100 epoch, with learning rate 2.8081442660546125
[10/01 12:40:16 visual_prompt]: Epoch 69 / 100: avg data time: 1.06e+01, avg batch time: 11.0453, average train loss: 1.0146
[10/01 12:41:01 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.2667, average loss: 0.9424
[10/01 12:41:01 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.21	
[10/01 12:41:01 visual_prompt]: Training 70 / 100 epoch, with learning rate 2.6526421860705476
[10/01 12:47:28 visual_prompt]: Epoch 70 / 100: avg data time: 1.05e+01, avg batch time: 11.0480, average train loss: 0.9244
[10/01 12:48:13 visual_prompt]: Inference (val):avg data time: 2.11e-05, avg batch time: 0.2650, average loss: 0.6880
[10/01 12:48:13 visual_prompt]: Classification results with val_mammo-cbis: top1: 57.72	rocauc: 56.77	
[10/01 12:48:13 visual_prompt]: Best epoch 70: best metric: 0.577
[10/01 12:48:13 visual_prompt]: Training 71 / 100 epoch, with learning rate 2.500000000000001
[10/01 12:54:38 visual_prompt]: Epoch 71 / 100: avg data time: 1.05e+01, avg batch time: 11.0073, average train loss: 0.7786
[10/01 12:55:24 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.2124, average loss: 0.7053
[10/01 12:55:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.69	rocauc: 57.02	
[10/01 12:55:24 visual_prompt]: Training 72 / 100 epoch, with learning rate 2.350403678833976
[10/01 13:01:50 visual_prompt]: Epoch 72 / 100: avg data time: 1.06e+01, avg batch time: 11.0166, average train loss: 0.8081
[10/01 13:02:35 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.2036, average loss: 0.6808
[10/01 13:02:35 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.25	rocauc: 57.10	
[10/01 13:02:35 visual_prompt]: Training 73 / 100 epoch, with learning rate 2.2040354826462667
[10/01 13:09:02 visual_prompt]: Epoch 73 / 100: avg data time: 1.06e+01, avg batch time: 11.0622, average train loss: 0.8726
[10/01 13:09:48 visual_prompt]: Inference (val):avg data time: 2.38e-05, avg batch time: 0.2417, average loss: 0.7513
[10/01 13:09:48 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.47	rocauc: 57.15	
[10/01 13:09:48 visual_prompt]: Training 74 / 100 epoch, with learning rate 2.061073738537635
[10/01 13:16:14 visual_prompt]: Epoch 74 / 100: avg data time: 1.06e+01, avg batch time: 11.0338, average train loss: 0.7930
[10/01 13:16:59 visual_prompt]: Inference (val):avg data time: 2.68e-05, avg batch time: 0.2087, average loss: 0.9305
[10/01 13:16:59 visual_prompt]: Classification results with val_mammo-cbis: top1: 46.34	rocauc: 57.26	
[10/01 13:16:59 visual_prompt]: Training 75 / 100 epoch, with learning rate 1.9216926233717087
[10/01 13:23:27 visual_prompt]: Epoch 75 / 100: avg data time: 1.06e+01, avg batch time: 11.0544, average train loss: 0.8316
[10/01 13:24:12 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.2292, average loss: 0.7205
[10/01 13:24:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 45.93	rocauc: 56.92	
[10/01 13:24:12 visual_prompt]: Training 76 / 100 epoch, with learning rate 1.7860619515673033
[10/01 13:30:39 visual_prompt]: Epoch 76 / 100: avg data time: 1.06e+01, avg batch time: 11.0510, average train loss: 0.7569
[10/01 13:31:24 visual_prompt]: Inference (val):avg data time: 2.20e-05, avg batch time: 0.2147, average loss: 0.6934
[10/01 13:31:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.10	rocauc: 57.15	
[10/01 13:31:24 visual_prompt]: Training 77 / 100 epoch, with learning rate 1.6543469682057106
[10/01 13:37:51 visual_prompt]: Epoch 77 / 100: avg data time: 1.06e+01, avg batch time: 11.0512, average train loss: 0.8441
[10/01 13:38:37 visual_prompt]: Inference (val):avg data time: 2.26e-05, avg batch time: 0.2886, average loss: 0.8688
[10/01 13:38:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.18	
[10/01 13:38:37 visual_prompt]: Training 78 / 100 epoch, with learning rate 1.5267081477050133
[10/01 13:45:03 visual_prompt]: Epoch 78 / 100: avg data time: 1.06e+01, avg batch time: 11.0260, average train loss: 0.7294
[10/01 13:45:49 visual_prompt]: Inference (val):avg data time: 2.19e-05, avg batch time: 0.2257, average loss: 1.0213
[10/01 13:45:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.41	
[10/01 13:45:49 visual_prompt]: Training 79 / 100 epoch, with learning rate 1.403300998306745
[10/01 13:52:15 visual_prompt]: Epoch 79 / 100: avg data time: 1.05e+01, avg batch time: 11.0245, average train loss: 0.7364
[10/01 13:53:00 visual_prompt]: Inference (val):avg data time: 2.43e-05, avg batch time: 0.2133, average loss: 0.6792
[10/01 13:53:00 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.07	rocauc: 57.55	
[10/01 13:53:00 visual_prompt]: Training 80 / 100 epoch, with learning rate 1.2842758726130281
[10/01 13:59:27 visual_prompt]: Epoch 80 / 100: avg data time: 1.06e+01, avg batch time: 11.0431, average train loss: 0.7056
[10/01 14:00:12 visual_prompt]: Inference (val):avg data time: 2.13e-05, avg batch time: 0.2144, average loss: 0.6787
[10/01 14:00:12 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.47	rocauc: 57.69	
[10/01 14:00:12 visual_prompt]: Training 81 / 100 epoch, with learning rate 1.1697777844051105
[10/01 14:06:40 visual_prompt]: Epoch 81 / 100: avg data time: 1.06e+01, avg batch time: 11.0862, average train loss: 0.7138
[10/01 14:07:25 visual_prompt]: Inference (val):avg data time: 2.33e-05, avg batch time: 0.2341, average loss: 0.8776
[10/01 14:07:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.83	
[10/01 14:07:25 visual_prompt]: Training 82 / 100 epoch, with learning rate 1.0599462319663906
[10/01 14:13:52 visual_prompt]: Epoch 82 / 100: avg data time: 1.06e+01, avg batch time: 11.0257, average train loss: 0.7148
[10/01 14:14:37 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2536, average loss: 0.6805
[10/01 14:14:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.91	rocauc: 57.59	
[10/01 14:14:37 visual_prompt]: Training 83 / 100 epoch, with learning rate 0.9549150281252633
[10/01 14:21:04 visual_prompt]: Epoch 83 / 100: avg data time: 1.06e+01, avg batch time: 11.0380, average train loss: 0.7074
[10/01 14:21:49 visual_prompt]: Inference (val):avg data time: 2.14e-05, avg batch time: 0.2471, average loss: 0.6932
[10/01 14:21:49 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.88	rocauc: 57.74	
[10/01 14:21:49 visual_prompt]: Training 84 / 100 epoch, with learning rate 0.8548121372247919
[10/01 14:28:15 visual_prompt]: Epoch 84 / 100: avg data time: 1.06e+01, avg batch time: 11.0335, average train loss: 0.7103
[10/01 14:29:01 visual_prompt]: Inference (val):avg data time: 2.46e-05, avg batch time: 0.2351, average loss: 0.6822
[10/01 14:29:01 visual_prompt]: Classification results with val_mammo-cbis: top1: 53.66	rocauc: 57.86	
[10/01 14:29:01 visual_prompt]: Training 85 / 100 epoch, with learning rate 0.7597595192178702
[10/01 14:35:27 visual_prompt]: Epoch 85 / 100: avg data time: 1.06e+01, avg batch time: 11.0334, average train loss: 0.7022
[10/01 14:36:13 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2203, average loss: 0.7025
[10/01 14:36:13 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.10	rocauc: 57.89	
[10/01 14:36:13 visual_prompt]: Training 86 / 100 epoch, with learning rate 0.6698729810778065
[10/01 14:42:39 visual_prompt]: Epoch 86 / 100: avg data time: 1.06e+01, avg batch time: 11.0323, average train loss: 0.7018
[10/01 14:43:25 visual_prompt]: Inference (val):avg data time: 2.55e-05, avg batch time: 0.2233, average loss: 0.6780
[10/01 14:43:25 visual_prompt]: Classification results with val_mammo-cbis: top1: 57.32	rocauc: 58.06	
[10/01 14:43:25 visual_prompt]: Training 87 / 100 epoch, with learning rate 0.5852620357053651
[10/01 14:49:50 visual_prompt]: Epoch 87 / 100: avg data time: 1.05e+01, avg batch time: 10.9911, average train loss: 0.6927
[10/01 14:50:35 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2580, average loss: 0.6808
[10/01 14:50:35 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.91	rocauc: 58.06	
[10/01 14:50:35 visual_prompt]: Training 88 / 100 epoch, with learning rate 0.5060297685041659
[10/01 14:57:00 visual_prompt]: Epoch 88 / 100: avg data time: 1.05e+01, avg batch time: 10.9993, average train loss: 0.6815
[10/01 14:57:45 visual_prompt]: Inference (val):avg data time: 2.62e-05, avg batch time: 0.2982, average loss: 0.6926
[10/01 14:57:45 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.28	rocauc: 58.01	
[10/01 14:57:45 visual_prompt]: Training 89 / 100 epoch, with learning rate 0.4322727117869951
[10/01 15:04:13 visual_prompt]: Epoch 89 / 100: avg data time: 1.06e+01, avg batch time: 11.0720, average train loss: 0.6845
[10/01 15:04:58 visual_prompt]: Inference (val):avg data time: 2.41e-05, avg batch time: 0.2142, average loss: 0.7439
[10/01 15:04:58 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.47	rocauc: 58.01	
[10/01 15:04:58 visual_prompt]: Training 90 / 100 epoch, with learning rate 0.36408072716606343
[10/01 15:11:26 visual_prompt]: Epoch 90 / 100: avg data time: 1.06e+01, avg batch time: 11.0814, average train loss: 0.6800
[10/01 15:12:11 visual_prompt]: Inference (val):avg data time: 2.78e-05, avg batch time: 0.2102, average loss: 0.6788
[10/01 15:12:11 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.07	rocauc: 58.01	
[10/01 15:12:11 visual_prompt]: Training 91 / 100 epoch, with learning rate 0.3015368960704584
[10/01 15:18:39 visual_prompt]: Epoch 91 / 100: avg data time: 1.06e+01, avg batch time: 11.0665, average train loss: 0.6856
[10/01 15:19:24 visual_prompt]: Inference (val):avg data time: 2.39e-05, avg batch time: 0.2143, average loss: 0.6779
[10/01 15:19:24 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.28	rocauc: 57.97	
[10/01 15:19:24 visual_prompt]: Training 92 / 100 epoch, with learning rate 0.24471741852423234
[10/01 15:25:52 visual_prompt]: Epoch 92 / 100: avg data time: 1.06e+01, avg batch time: 11.0690, average train loss: 0.6881
[10/01 15:26:37 visual_prompt]: Inference (val):avg data time: 2.35e-05, avg batch time: 0.2494, average loss: 0.6778
[10/01 15:26:37 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.28	rocauc: 58.05	
[10/01 15:26:37 visual_prompt]: Training 93 / 100 epoch, with learning rate 0.19369152030840553
[10/01 15:33:04 visual_prompt]: Epoch 93 / 100: avg data time: 1.06e+01, avg batch time: 11.0515, average train loss: 0.6880
[10/01 15:33:50 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2254, average loss: 0.6929
[10/01 15:33:50 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.69	rocauc: 58.12	
[10/01 15:33:50 visual_prompt]: Training 94 / 100 epoch, with learning rate 0.14852136862001764
[10/01 15:40:17 visual_prompt]: Epoch 94 / 100: avg data time: 1.06e+01, avg batch time: 11.0494, average train loss: 0.6863
[10/01 15:41:03 visual_prompt]: Inference (val):avg data time: 2.34e-05, avg batch time: 0.3097, average loss: 0.6894
[10/01 15:41:03 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.91	rocauc: 58.11	
[10/01 15:41:03 visual_prompt]: Training 95 / 100 epoch, with learning rate 0.10926199633097156
[10/01 15:47:30 visual_prompt]: Epoch 95 / 100: avg data time: 1.06e+01, avg batch time: 11.0488, average train loss: 0.6900
[10/01 15:48:15 visual_prompt]: Inference (val):avg data time: 2.28e-05, avg batch time: 0.2121, average loss: 0.6833
[10/01 15:48:15 visual_prompt]: Classification results with val_mammo-cbis: top1: 55.69	rocauc: 58.09	
[10/01 15:48:15 visual_prompt]: Training 96 / 100 epoch, with learning rate 0.0759612349389599
[10/01 15:54:43 visual_prompt]: Epoch 96 / 100: avg data time: 1.06e+01, avg batch time: 11.0707, average train loss: 0.6840
[10/01 15:55:28 visual_prompt]: Inference (val):avg data time: 2.15e-05, avg batch time: 0.2211, average loss: 0.6791
[10/01 15:55:28 visual_prompt]: Classification results with val_mammo-cbis: top1: 57.72	rocauc: 58.13	
[10/01 15:55:28 visual_prompt]: Training 97 / 100 epoch, with learning rate 0.04865965629214819
[10/01 16:01:58 visual_prompt]: Epoch 97 / 100: avg data time: 1.06e+01, avg batch time: 11.1164, average train loss: 0.6814
[10/01 16:02:43 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2439, average loss: 0.6874
[10/01 16:02:43 visual_prompt]: Classification results with val_mammo-cbis: top1: 56.50	rocauc: 58.10	
[10/01 16:02:43 visual_prompt]: Training 98 / 100 epoch, with learning rate 0.02739052315863355
[10/01 16:09:10 visual_prompt]: Epoch 98 / 100: avg data time: 1.06e+01, avg batch time: 11.0476, average train loss: 0.6785
[10/01 16:09:55 visual_prompt]: Inference (val):avg data time: 2.31e-05, avg batch time: 0.2175, average loss: 0.6778
[10/01 16:09:55 visual_prompt]: Classification results with val_mammo-cbis: top1: 54.47	rocauc: 58.09	
[10/01 16:09:55 visual_prompt]: Training 99 / 100 epoch, with learning rate 0.012179748700879012
[10/01 16:16:21 visual_prompt]: Epoch 99 / 100: avg data time: 1.05e+01, avg batch time: 11.0157, average train loss: 0.6756
[10/01 16:17:07 visual_prompt]: Inference (val):avg data time: 2.37e-05, avg batch time: 0.2122, average loss: 0.6785
[10/01 16:17:07 visual_prompt]: Classification results with val_mammo-cbis: top1: 58.54	rocauc: 58.09	
[10/01 16:17:07 visual_prompt]: Best epoch 99: best metric: 0.585
[10/01 16:17:07 visual_prompt]: Training 100 / 100 epoch, with learning rate 0.0030458649045211894
[10/01 16:23:33 visual_prompt]: Epoch 100 / 100: avg data time: 1.06e+01, avg batch time: 11.0311, average train loss: 0.6780
[10/01 16:24:18 visual_prompt]: Inference (val):avg data time: 2.49e-05, avg batch time: 0.2108, average loss: 0.6784
[10/01 16:24:18 visual_prompt]: Classification results with val_mammo-cbis: top1: 58.54	rocauc: 58.09	
Traceback (most recent call last):
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/tune_cbis.py", line 166, in <module>
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/tune_cbis.py", line 152, in main
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/tune_cbis.py", line 142, in explore_lrwd_range
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/tune_cbis.py", line 91, in setup
    except ValueError:
      ^^^^^^^^^^^^^^^^^
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/tune_cbis.py", line 81, in setup_part
    
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.11/site-packages/fvcore/common/config.py", line 121, in merge_from_file
    self.merge_from_other_cfg(loaded_cfg)
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.11/site-packages/fvcore/common/config.py", line 132, in merge_from_other_cfg
    return super().merge_from_other_cfg(cfg_other)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.11/site-packages/yacs/config.py", line 217, in merge_from_other_cfg
    _merge_a_into_b(cfg_other, self, self, [])
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.11/site-packages/yacs/config.py", line 478, in _merge_a_into_b
    _merge_a_into_b(v, b[k], root, key_list + [k])
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.11/site-packages/yacs/config.py", line 491, in _merge_a_into_b
    raise KeyError("Non-existent config key: {}".format(full_key))
KeyError: 'Non-existent config key: SOLVER.CRITERION'
visual_prompt_tuning/experiments/vit_mammo.sh: error reading input file: Stale file handle
