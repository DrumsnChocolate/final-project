[09/15 18:48:44 visual_prompt]: Rank of current process: 0. World size: 1
[09/15 18:48:44 visual_prompt]: Environment info:
-------------------  ----------------------------------------------------
Python               3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              1.7.1
PyTorch Debug Build  False
CUDA available       True
CUDA ID              2,3
GPU 0,1              NVIDIA TITAN X (Pascal)
Pillow               9.3.0
cv2                  4.8.0
-------------------  ----------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[09/15 18:48:44 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '100', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-diabetic_retinopathy(config="btgraham-300")', 'DATA.NUMBER_CLASSES', '5', 'SOLVER.BASE_LR', '5.0', 'SOLVER.WEIGHT_DECAY', '0.0001', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir/seed42'], train_type='')
[09/15 18:48:44 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/15 18:48:44 visual_prompt]: Training with config:
[09/15 18:48:44 visual_prompt]: {'CUDNN_BENCHMARK': False,
 'DATA': {'BATCH_SIZE': 64,
          'CLASS_WEIGHTS_TYPE': 'none',
          'CROPSIZE': 224,
          'DATAPATH': 'visual_prompt_tuning/data_path',
          'FEATURE': 'sup_vitb16_imagenet21k',
          'MULTILABEL': False,
          'NAME': 'vtab-diabetic_retinopathy(config="btgraham-300")',
          'NO_TEST': False,
          'NUMBER_CLASSES': 5,
          'NUM_WORKERS': 4,
          'PERCENTAGE': 1.0,
          'PIN_MEMORY': True},
 'DBG': False,
 'MODEL': {'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'}),
           'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}),
           'MLP_NUM': 0,
           'MODEL_ROOT': 'visual_prompt_tuning/model_root',
           'PROMPT': {'CLSEMB_FOLDER': '',
                      'CLSEMB_PATH': '',
                      'DEEP': True,
                      'DEEP_SHARED': False,
                      'DROPOUT': 0.1,
                      'FORWARD_DEEP_NOEXPAND': False,
                      'INITIATION': 'random',
                      'LOCATION': 'prepend',
                      'NUM_DEEP_LAYERS': None,
                      'NUM_TOKENS': 100,
                      'PROJECT': -1,
                      'REVERSE_DEEP': False,
                      'SAVE_FOR_EACH_EPOCH': False,
                      'VIT_POOL_TYPE': 'original'},
           'SAVE_CKPT': False,
           'TRANSFER_TYPE': 'prompt',
           'TYPE': 'vit',
           'WEIGHT_PATH': ''},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/seed42/vtab-diabetic_retinopathy(config="btgraham-300")/sup_vitb16_imagenet21k/lr5.0_wd0.0001/run1',
 'RUN_N_TIMES': 1,
 'SEED': None,
 'SOLVER': {'BASE_LR': 5.0,
            'BIAS_MULTIPLIER': 1.0,
            'DBG_TRAINABLE': False,
            'LOG_EVERY_N': 100,
            'LOSS': 'softmax',
            'LOSS_ALPHA': 0.01,
            'MOMENTUM': 0.9,
            'OPTIMIZER': 'sgd',
            'PATIENCE': 300,
            'SCHEDULER': 'cosine',
            'TOTAL_EPOCH': 100,
            'WARMUP_EPOCH': 10,
            'WEIGHT_DECAY': 0.0001,
            'WEIGHT_DECAY_BIAS': 0}}
[09/15 18:48:44 visual_prompt]: Loading training data (final training data for vtab)...
2023-09-15 18:48:44.259457: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-09-15 18:48:45.589190: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/cv2/../../lib64:
2023-09-15 18:48:45.589309: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/cv2/../../lib64:
2023-09-15 18:48:45.589324: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2023-09-15 18:48:48.339963: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcusolver.so.11'; dlerror: libcusolver.so.11: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/cv2/../../lib64:
2023-09-15 18:48:48.340114: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudnn.so.8'; dlerror: libcudnn.so.8: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/cv2/../../lib64:
2023-09-15 18:48:48.340143: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1934] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
[09/15 18:48:48 visual_prompt]: Constructing vtab-diabetic_retinopathy(config="btgraham-300") dataset trainval...
2023-09-15 18:48:48.359658: W tensorflow/core/platform/cloud/google_auth_provider.cc:184] All attempts to get a Google authentication bearer token failed, returning an empty token. Retrieving token from files failed with "NOT_FOUND: Could not locate the credentials file.". Retrieving token from GCE failed with "FAILED_PRECONDITION: Error executing an HTTP request: libcurl code 6 meaning 'Couldn't resolve host name', error details: Could not resolve host: metadata".
[INFO: dataset_info.py:  675]: Load pre-computed DatasetInfo (eg: splits, num examples,...) from GCS: diabetic_retinopathy_detection/btgraham-300/3.0.0
[INFO: dataset_info.py:  566]: Load dataset info from /tmp/tmp2pgyvpzctfds
[INFO: dataset_info.py:  647]: Field info.release_notes from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.config_name from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.config_description from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.citation from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.splits from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.module_name from disk and from code do not match. Keeping the one from code.
[INFO: dataset_builder.py:  575]: Generating dataset diabetic_retinopathy_detection (visual_prompt_tuning/data_path/diabetic_retinopathy_detection/btgraham-300/3.0.0)
Downloading and preparing dataset 1.13 MiB (download: 1.13 MiB, generated: Unknown size, total: 1.13 MiB) to visual_prompt_tuning/data_path/diabetic_retinopathy_detection/btgraham-300/3.0.0...
Dl Completed...: 0 url [00:00, ? url/s]
Dl Size...: 0 MiB [00:00, ? MiB/s][A[INFO: download_manager.py:  399]: Downloading https://storage.googleapis.com/kaggle-forum-message-attachments/90528/2877/retinopathy_solution.csv into visual_prompt_tuning/data_path/downloads/kagg-foru-mess-atta_9052_2877_reti_solu7ZQ9Ci-nXYCETc19RaIXY2LhHF8KBtHQbnby6fIGpmg.csv.tmp.b3824d79ab7648f694be288761e6d506...
Dl Completed...:   0%|          | 0/1 [00:00<?, ? url/s]
Dl Size...: 0 MiB [00:00, ? MiB/s][ADl Completed...:   0%|          | 0/1 [00:00<?, ? url/s]
Dl Size...:   0%|          | 0/1 [00:00<?, ? MiB/s][A
Dl Size...: 100%|##########| 1/1 [00:00<00:00,  1.56 MiB/s][ADl Completed...:   0%|          | 0/1 [00:00<?, ? url/s]
Dl Size...: 100%|##########| 1/1 [00:00<00:00,  1.56 MiB/s][ADl Completed...: 100%|##########| 1/1 [00:00<00:00,  1.51 url/s]Dl Completed...: 100%|##########| 1/1 [00:00<00:00,  1.51 url/s]
Dl Size...: 100%|##########| 1/1 [00:00<00:00,  1.56 MiB/s][ADl Size...: 100%|##########| 1/1 [00:00<00:00,  1.50 MiB/s]
Dl Completed...: 100%|##########| 1/1 [00:00<00:00,  1.50 url/s]
Generating splits...:   0%|          | 0/4 [00:00<?, ? splits/s]
Generating sample examples...:   0%|          | 0/10 [00:00<?, ? examples/s][A
                                                                            [A                                                                Traceback (most recent call last):
  File "visual_prompt_tuning/train.py", line 129, in <module>
    main(args)
  File "visual_prompt_tuning/train.py", line 124, in main
    train(cfg, args)
  File "visual_prompt_tuning/train.py", line 99, in train
    train_loader, val_loader, test_loader = get_loaders(cfg, logger)
  File "visual_prompt_tuning/train.py", line 66, in get_loaders
    train_loader = data_loader.construct_trainval_loader(cfg)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/loader.py", line 79, in construct_trainval_loader
    drop_last=drop_last,
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/loader.py", line 31, in _construct_loader
    dataset = TFDataset(cfg, split)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/datasets/tf_dataset.py", line 78, in __init__
    self.get_data(cfg, split)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/datasets/tf_dataset.py", line 81, in get_data
    tf_data = build_tf_dataset(cfg, split)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/datasets/tf_dataset.py", line 172, in build_tf_dataset
    vtab_tf_dataloader = data_cls(data_dir=data_dir)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/vtab_datasets/registry.py", line 50, in __init__
    super(_NewClass, self).__init__(*bound_args, **bound_kwargs)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/vtab_datasets/diabetic_retinopathy.py", line 61, in __init__
    dataset_builder.download_and_prepare()
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/logging/__init__.py", line 169, in __call__
    return function(*args, **kwargs)
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/dataset_builder.py", line 630, in download_and_prepare
    download_config=download_config,
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/dataset_builder.py", line 1477, in _download_and_prepare
    disable_shuffling=self.info.disable_shuffling,
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/split_builder.py", line 340, in submit_split_generation
    return self._build_from_generator(**build_kwargs)
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/split_builder.py", line 411, in _build_from_generator
    leave=False,
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tqdm/std.py", line 1195, in __iter__
    for obj in iterable:
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/image_classification/diabetic_retinopathy_detection.py", line 191, in _generate_examples
    for fname in tf.io.gfile.listdir(images_dir_path)
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow/python/lib/io/file_io.py", line 771, in list_directory_v2
    message="Could not find directory {}".format(path))
tensorflow.python.framework.errors_impl.NotFoundError: Could not find directory visual_prompt_tuning/data_path/downloads/manual/sample
[09/15 18:49:19 visual_prompt]: Rank of current process: 0. World size: 1
[09/15 18:49:19 visual_prompt]: Environment info:
-------------------  ----------------------------------------------------
Python               3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              1.7.1
PyTorch Debug Build  False
CUDA available       True
CUDA ID              2,3
GPU 0,1              NVIDIA TITAN X (Pascal)
Pillow               9.3.0
cv2                  4.8.0
-------------------  ----------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[09/15 18:49:19 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '100', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-diabetic_retinopathy(config="btgraham-300")', 'DATA.NUMBER_CLASSES', '5', 'SOLVER.BASE_LR', '5.0', 'SOLVER.WEIGHT_DECAY', '0.0001', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir/seed44'], train_type='')
[09/15 18:49:19 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/15 18:49:19 visual_prompt]: Training with config:
[09/15 18:49:19 visual_prompt]: {'CUDNN_BENCHMARK': False,
 'DATA': {'BATCH_SIZE': 64,
          'CLASS_WEIGHTS_TYPE': 'none',
          'CROPSIZE': 224,
          'DATAPATH': 'visual_prompt_tuning/data_path',
          'FEATURE': 'sup_vitb16_imagenet21k',
          'MULTILABEL': False,
          'NAME': 'vtab-diabetic_retinopathy(config="btgraham-300")',
          'NO_TEST': False,
          'NUMBER_CLASSES': 5,
          'NUM_WORKERS': 4,
          'PERCENTAGE': 1.0,
          'PIN_MEMORY': True},
 'DBG': False,
 'MODEL': {'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'}),
           'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}),
           'MLP_NUM': 0,
           'MODEL_ROOT': 'visual_prompt_tuning/model_root',
           'PROMPT': {'CLSEMB_FOLDER': '',
                      'CLSEMB_PATH': '',
                      'DEEP': True,
                      'DEEP_SHARED': False,
                      'DROPOUT': 0.1,
                      'FORWARD_DEEP_NOEXPAND': False,
                      'INITIATION': 'random',
                      'LOCATION': 'prepend',
                      'NUM_DEEP_LAYERS': None,
                      'NUM_TOKENS': 100,
                      'PROJECT': -1,
                      'REVERSE_DEEP': False,
                      'SAVE_FOR_EACH_EPOCH': False,
                      'VIT_POOL_TYPE': 'original'},
           'SAVE_CKPT': False,
           'TRANSFER_TYPE': 'prompt',
           'TYPE': 'vit',
           'WEIGHT_PATH': ''},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/seed44/vtab-diabetic_retinopathy(config="btgraham-300")/sup_vitb16_imagenet21k/lr5.0_wd0.0001/run1',
 'RUN_N_TIMES': 1,
 'SEED': None,
 'SOLVER': {'BASE_LR': 5.0,
            'BIAS_MULTIPLIER': 1.0,
            'DBG_TRAINABLE': False,
            'LOG_EVERY_N': 100,
            'LOSS': 'softmax',
            'LOSS_ALPHA': 0.01,
            'MOMENTUM': 0.9,
            'OPTIMIZER': 'sgd',
            'PATIENCE': 300,
            'SCHEDULER': 'cosine',
            'TOTAL_EPOCH': 100,
            'WARMUP_EPOCH': 10,
            'WEIGHT_DECAY': 0.0001,
            'WEIGHT_DECAY_BIAS': 0}}
[09/15 18:49:19 visual_prompt]: Loading training data (final training data for vtab)...
2023-09-15 18:49:19.326818: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-09-15 18:49:20.527653: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/cv2/../../lib64:
2023-09-15 18:49:20.527774: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/cv2/../../lib64:
2023-09-15 18:49:20.527789: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2023-09-15 18:49:22.787173: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcusolver.so.11'; dlerror: libcusolver.so.11: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/cv2/../../lib64:
2023-09-15 18:49:22.787327: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudnn.so.8'; dlerror: libcudnn.so.8: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/cv2/../../lib64:
2023-09-15 18:49:22.787355: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1934] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
[09/15 18:49:22 visual_prompt]: Constructing vtab-diabetic_retinopathy(config="btgraham-300") dataset trainval...
2023-09-15 18:49:22.799127: W tensorflow/core/platform/cloud/google_auth_provider.cc:184] All attempts to get a Google authentication bearer token failed, returning an empty token. Retrieving token from files failed with "NOT_FOUND: Could not locate the credentials file.". Retrieving token from GCE failed with "FAILED_PRECONDITION: Error executing an HTTP request: libcurl code 6 meaning 'Couldn't resolve host name', error details: Could not resolve host: metadata".
[INFO: dataset_info.py:  675]: Load pre-computed DatasetInfo (eg: splits, num examples,...) from GCS: diabetic_retinopathy_detection/btgraham-300/3.0.0
[INFO: dataset_info.py:  566]: Load dataset info from /tmp/tmpqy0le2sqtfds
[INFO: dataset_info.py:  647]: Field info.release_notes from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.config_name from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.config_description from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.citation from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.splits from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.module_name from disk and from code do not match. Keeping the one from code.
[INFO: dataset_builder.py:  575]: Generating dataset diabetic_retinopathy_detection (visual_prompt_tuning/data_path/diabetic_retinopathy_detection/btgraham-300/3.0.0)
Downloading and preparing dataset 1.13 MiB (download: 1.13 MiB, generated: Unknown size, total: 1.13 MiB) to visual_prompt_tuning/data_path/diabetic_retinopathy_detection/btgraham-300/3.0.0...
Dl Completed...: 0 url [00:00, ? url/s]
Dl Size...: 0 MiB [00:00, ? MiB/s][A[INFO: download_manager.py:  388]: Skipping download of https://storage.googleapis.com/kaggle-forum-message-attachments/90528/2877/retinopathy_solution.csv: File cached in visual_prompt_tuning/data_path/downloads/kagg-foru-mess-atta_9052_2877_reti_solupq89ZoBOgYh9qJuSYbz7faT1us7bBw8bXbg_qHmrYMk.csv
Dl Completed...:   0%|          | 0/1 [00:00<?, ? url/s]
Dl Size...: 0 MiB [00:00, ? MiB/s][ADl Completed...: 100%|##########| 1/1 [00:00<00:00, 588.10 url/s]
Dl Size...: 0 MiB [00:00, ? MiB/s][ADl Completed...: 100%|##########| 1/1 [00:00<00:00, 536.08 url/s]
Dl Size...:   0%|          | 0/1181257 [00:00<?, ? MiB/s][ADl Completed...: 100%|##########| 1/1 [00:00<00:00, 491.71 url/s]
Dl Size...: 100%|##########| 1181257/1181257 [00:00<00:00, 628590581.09 MiB/s][ADl Size...: 100%|##########| 1181257/1181257 [00:00<00:00, 476582431.72 MiB/s]
Dl Completed...: 100%|##########| 1/1 [00:00<00:00, 350.08 url/s]
Generating splits...:   0%|          | 0/4 [00:00<?, ? splits/s]
Generating sample examples...:   0%|          | 0/10 [00:00<?, ? examples/s][A
                                                                            [A                                                                Traceback (most recent call last):
  File "visual_prompt_tuning/train.py", line 129, in <module>
    main(args)
  File "visual_prompt_tuning/train.py", line 124, in main
    train(cfg, args)
  File "visual_prompt_tuning/train.py", line 99, in train
    train_loader, val_loader, test_loader = get_loaders(cfg, logger)
  File "visual_prompt_tuning/train.py", line 66, in get_loaders
    train_loader = data_loader.construct_trainval_loader(cfg)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/loader.py", line 79, in construct_trainval_loader
    drop_last=drop_last,
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/loader.py", line 31, in _construct_loader
    dataset = TFDataset(cfg, split)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/datasets/tf_dataset.py", line 78, in __init__
    self.get_data(cfg, split)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/datasets/tf_dataset.py", line 81, in get_data
    tf_data = build_tf_dataset(cfg, split)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/datasets/tf_dataset.py", line 172, in build_tf_dataset
    vtab_tf_dataloader = data_cls(data_dir=data_dir)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/vtab_datasets/registry.py", line 50, in __init__
    super(_NewClass, self).__init__(*bound_args, **bound_kwargs)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/vtab_datasets/diabetic_retinopathy.py", line 61, in __init__
    dataset_builder.download_and_prepare()
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/logging/__init__.py", line 169, in __call__
    return function(*args, **kwargs)
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/dataset_builder.py", line 630, in download_and_prepare
    download_config=download_config,
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/dataset_builder.py", line 1477, in _download_and_prepare
    disable_shuffling=self.info.disable_shuffling,
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/split_builder.py", line 340, in submit_split_generation
    return self._build_from_generator(**build_kwargs)
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/split_builder.py", line 411, in _build_from_generator
    leave=False,
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tqdm/std.py", line 1195, in __iter__
    for obj in iterable:
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/image_classification/diabetic_retinopathy_detection.py", line 191, in _generate_examples
    for fname in tf.io.gfile.listdir(images_dir_path)
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow/python/lib/io/file_io.py", line 771, in list_directory_v2
    message="Could not find directory {}".format(path))
tensorflow.python.framework.errors_impl.NotFoundError: Could not find directory visual_prompt_tuning/data_path/downloads/manual/sample
[09/15 18:49:54 visual_prompt]: Rank of current process: 0. World size: 1
[09/15 18:49:54 visual_prompt]: Environment info:
-------------------  ----------------------------------------------------
Python               3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              1.7.1
PyTorch Debug Build  False
CUDA available       True
CUDA ID              2,3
GPU 0,1              NVIDIA TITAN X (Pascal)
Pillow               9.3.0
cv2                  4.8.0
-------------------  ----------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[09/15 18:49:54 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '100', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-diabetic_retinopathy(config="btgraham-300")', 'DATA.NUMBER_CLASSES', '5', 'SOLVER.BASE_LR', '5.0', 'SOLVER.WEIGHT_DECAY', '0.0001', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir/seed82'], train_type='')
[09/15 18:49:54 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/15 18:49:54 visual_prompt]: Training with config:
[09/15 18:49:54 visual_prompt]: {'CUDNN_BENCHMARK': False,
 'DATA': {'BATCH_SIZE': 64,
          'CLASS_WEIGHTS_TYPE': 'none',
          'CROPSIZE': 224,
          'DATAPATH': 'visual_prompt_tuning/data_path',
          'FEATURE': 'sup_vitb16_imagenet21k',
          'MULTILABEL': False,
          'NAME': 'vtab-diabetic_retinopathy(config="btgraham-300")',
          'NO_TEST': False,
          'NUMBER_CLASSES': 5,
          'NUM_WORKERS': 4,
          'PERCENTAGE': 1.0,
          'PIN_MEMORY': True},
 'DBG': False,
 'MODEL': {'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'}),
           'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}),
           'MLP_NUM': 0,
           'MODEL_ROOT': 'visual_prompt_tuning/model_root',
           'PROMPT': {'CLSEMB_FOLDER': '',
                      'CLSEMB_PATH': '',
                      'DEEP': True,
                      'DEEP_SHARED': False,
                      'DROPOUT': 0.1,
                      'FORWARD_DEEP_NOEXPAND': False,
                      'INITIATION': 'random',
                      'LOCATION': 'prepend',
                      'NUM_DEEP_LAYERS': None,
                      'NUM_TOKENS': 100,
                      'PROJECT': -1,
                      'REVERSE_DEEP': False,
                      'SAVE_FOR_EACH_EPOCH': False,
                      'VIT_POOL_TYPE': 'original'},
           'SAVE_CKPT': False,
           'TRANSFER_TYPE': 'prompt',
           'TYPE': 'vit',
           'WEIGHT_PATH': ''},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/seed82/vtab-diabetic_retinopathy(config="btgraham-300")/sup_vitb16_imagenet21k/lr5.0_wd0.0001/run1',
 'RUN_N_TIMES': 1,
 'SEED': None,
 'SOLVER': {'BASE_LR': 5.0,
            'BIAS_MULTIPLIER': 1.0,
            'DBG_TRAINABLE': False,
            'LOG_EVERY_N': 100,
            'LOSS': 'softmax',
            'LOSS_ALPHA': 0.01,
            'MOMENTUM': 0.9,
            'OPTIMIZER': 'sgd',
            'PATIENCE': 300,
            'SCHEDULER': 'cosine',
            'TOTAL_EPOCH': 100,
            'WARMUP_EPOCH': 10,
            'WEIGHT_DECAY': 0.0001,
            'WEIGHT_DECAY_BIAS': 0}}
[09/15 18:49:54 visual_prompt]: Loading training data (final training data for vtab)...
2023-09-15 18:49:54.980886: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-09-15 18:49:56.231155: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/cv2/../../lib64:
2023-09-15 18:49:56.231273: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/cv2/../../lib64:
2023-09-15 18:49:56.231288: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2023-09-15 18:49:58.668541: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcusolver.so.11'; dlerror: libcusolver.so.11: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/cv2/../../lib64:
2023-09-15 18:49:58.668695: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudnn.so.8'; dlerror: libcudnn.so.8: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/cv2/../../lib64:
2023-09-15 18:49:58.668725: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1934] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
[09/15 18:49:58 visual_prompt]: Constructing vtab-diabetic_retinopathy(config="btgraham-300") dataset trainval...
2023-09-15 18:49:58.680506: W tensorflow/core/platform/cloud/google_auth_provider.cc:184] All attempts to get a Google authentication bearer token failed, returning an empty token. Retrieving token from files failed with "NOT_FOUND: Could not locate the credentials file.". Retrieving token from GCE failed with "FAILED_PRECONDITION: Error executing an HTTP request: libcurl code 6 meaning 'Couldn't resolve host name', error details: Could not resolve host: metadata".
[INFO: dataset_info.py:  675]: Load pre-computed DatasetInfo (eg: splits, num examples,...) from GCS: diabetic_retinopathy_detection/btgraham-300/3.0.0
[INFO: dataset_info.py:  566]: Load dataset info from /tmp/tmpl6jjm92dtfds
[INFO: dataset_info.py:  647]: Field info.release_notes from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.config_name from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.config_description from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.citation from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.splits from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.module_name from disk and from code do not match. Keeping the one from code.
[INFO: dataset_builder.py:  575]: Generating dataset diabetic_retinopathy_detection (visual_prompt_tuning/data_path/diabetic_retinopathy_detection/btgraham-300/3.0.0)
Downloading and preparing dataset 1.13 MiB (download: 1.13 MiB, generated: Unknown size, total: 1.13 MiB) to visual_prompt_tuning/data_path/diabetic_retinopathy_detection/btgraham-300/3.0.0...
Dl Completed...: 0 url [00:00, ? url/s]
Dl Size...: 0 MiB [00:00, ? MiB/s][A[INFO: download_manager.py:  388]: Skipping download of https://storage.googleapis.com/kaggle-forum-message-attachments/90528/2877/retinopathy_solution.csv: File cached in visual_prompt_tuning/data_path/downloads/kagg-foru-mess-atta_9052_2877_reti_solupq89ZoBOgYh9qJuSYbz7faT1us7bBw8bXbg_qHmrYMk.csv
Dl Completed...:   0%|          | 0/1 [00:00<?, ? url/s]
Dl Size...: 0 MiB [00:00, ? MiB/s][ADl Completed...: 100%|##########| 1/1 [00:00<00:00, 598.76 url/s]
Dl Size...: 0 MiB [00:00, ? MiB/s][ADl Completed...: 100%|##########| 1/1 [00:00<00:00, 545.35 url/s]
Dl Size...:   0%|          | 0/1181257 [00:00<?, ? MiB/s][ADl Completed...: 100%|##########| 1/1 [00:00<00:00, 493.16 url/s]
Dl Size...: 100%|##########| 1181257/1181257 [00:00<00:00, 624234718.42 MiB/s][ADl Size...: 100%|##########| 1181257/1181257 [00:00<00:00, 474346669.23 MiB/s]
Dl Completed...: 100%|##########| 1/1 [00:00<00:00, 350.64 url/s]
Generating splits...:   0%|          | 0/4 [00:00<?, ? splits/s]
Generating sample examples...:   0%|          | 0/10 [00:00<?, ? examples/s][A
                                                                            [A                                                                Traceback (most recent call last):
  File "visual_prompt_tuning/train.py", line 129, in <module>
    main(args)
  File "visual_prompt_tuning/train.py", line 124, in main
    train(cfg, args)
  File "visual_prompt_tuning/train.py", line 99, in train
    train_loader, val_loader, test_loader = get_loaders(cfg, logger)
  File "visual_prompt_tuning/train.py", line 66, in get_loaders
    train_loader = data_loader.construct_trainval_loader(cfg)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/loader.py", line 79, in construct_trainval_loader
    drop_last=drop_last,
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/loader.py", line 31, in _construct_loader
    dataset = TFDataset(cfg, split)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/datasets/tf_dataset.py", line 78, in __init__
    self.get_data(cfg, split)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/datasets/tf_dataset.py", line 81, in get_data
    tf_data = build_tf_dataset(cfg, split)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/datasets/tf_dataset.py", line 172, in build_tf_dataset
    vtab_tf_dataloader = data_cls(data_dir=data_dir)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/vtab_datasets/registry.py", line 50, in __init__
    super(_NewClass, self).__init__(*bound_args, **bound_kwargs)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/vtab_datasets/diabetic_retinopathy.py", line 61, in __init__
    dataset_builder.download_and_prepare()
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/logging/__init__.py", line 169, in __call__
    return function(*args, **kwargs)
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/dataset_builder.py", line 630, in download_and_prepare
    download_config=download_config,
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/dataset_builder.py", line 1477, in _download_and_prepare
    disable_shuffling=self.info.disable_shuffling,
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/split_builder.py", line 340, in submit_split_generation
    return self._build_from_generator(**build_kwargs)
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/split_builder.py", line 411, in _build_from_generator
    leave=False,
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tqdm/std.py", line 1195, in __iter__
    for obj in iterable:
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/image_classification/diabetic_retinopathy_detection.py", line 191, in _generate_examples
    for fname in tf.io.gfile.listdir(images_dir_path)
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow/python/lib/io/file_io.py", line 771, in list_directory_v2
    message="Could not find directory {}".format(path))
tensorflow.python.framework.errors_impl.NotFoundError: Could not find directory visual_prompt_tuning/data_path/downloads/manual/sample
[09/15 18:50:09 visual_prompt]: Rank of current process: 0. World size: 1
[09/15 18:50:09 visual_prompt]: Environment info:
-------------------  ----------------------------------------------------
Python               3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              1.7.1
PyTorch Debug Build  False
CUDA available       True
CUDA ID              2,3
GPU 0,1              NVIDIA TITAN X (Pascal)
Pillow               9.3.0
cv2                  4.8.0
-------------------  ----------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[09/15 18:50:09 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '100', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-diabetic_retinopathy(config="btgraham-300")', 'DATA.NUMBER_CLASSES', '5', 'SOLVER.BASE_LR', '5.0', 'SOLVER.WEIGHT_DECAY', '0.0001', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir/seed100'], train_type='')
[09/15 18:50:09 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/15 18:50:09 visual_prompt]: Training with config:
[09/15 18:50:09 visual_prompt]: {'CUDNN_BENCHMARK': False,
 'DATA': {'BATCH_SIZE': 64,
          'CLASS_WEIGHTS_TYPE': 'none',
          'CROPSIZE': 224,
          'DATAPATH': 'visual_prompt_tuning/data_path',
          'FEATURE': 'sup_vitb16_imagenet21k',
          'MULTILABEL': False,
          'NAME': 'vtab-diabetic_retinopathy(config="btgraham-300")',
          'NO_TEST': False,
          'NUMBER_CLASSES': 5,
          'NUM_WORKERS': 4,
          'PERCENTAGE': 1.0,
          'PIN_MEMORY': True},
 'DBG': False,
 'MODEL': {'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'}),
           'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}),
           'MLP_NUM': 0,
           'MODEL_ROOT': 'visual_prompt_tuning/model_root',
           'PROMPT': {'CLSEMB_FOLDER': '',
                      'CLSEMB_PATH': '',
                      'DEEP': True,
                      'DEEP_SHARED': False,
                      'DROPOUT': 0.1,
                      'FORWARD_DEEP_NOEXPAND': False,
                      'INITIATION': 'random',
                      'LOCATION': 'prepend',
                      'NUM_DEEP_LAYERS': None,
                      'NUM_TOKENS': 100,
                      'PROJECT': -1,
                      'REVERSE_DEEP': False,
                      'SAVE_FOR_EACH_EPOCH': False,
                      'VIT_POOL_TYPE': 'original'},
           'SAVE_CKPT': False,
           'TRANSFER_TYPE': 'prompt',
           'TYPE': 'vit',
           'WEIGHT_PATH': ''},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/seed100/vtab-diabetic_retinopathy(config="btgraham-300")/sup_vitb16_imagenet21k/lr5.0_wd0.0001/run1',
 'RUN_N_TIMES': 1,
 'SEED': None,
 'SOLVER': {'BASE_LR': 5.0,
            'BIAS_MULTIPLIER': 1.0,
            'DBG_TRAINABLE': False,
            'LOG_EVERY_N': 100,
            'LOSS': 'softmax',
            'LOSS_ALPHA': 0.01,
            'MOMENTUM': 0.9,
            'OPTIMIZER': 'sgd',
            'PATIENCE': 300,
            'SCHEDULER': 'cosine',
            'TOTAL_EPOCH': 100,
            'WARMUP_EPOCH': 10,
            'WEIGHT_DECAY': 0.0001,
            'WEIGHT_DECAY_BIAS': 0}}
[09/15 18:50:09 visual_prompt]: Loading training data (final training data for vtab)...
2023-09-15 18:50:09.878608: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-09-15 18:50:11.088685: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/cv2/../../lib64:
2023-09-15 18:50:11.088802: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/cv2/../../lib64:
2023-09-15 18:50:11.088817: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2023-09-15 18:50:13.355164: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcusolver.so.11'; dlerror: libcusolver.so.11: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/cv2/../../lib64:
2023-09-15 18:50:13.355311: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudnn.so.8'; dlerror: libcudnn.so.8: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/cv2/../../lib64:
2023-09-15 18:50:13.355340: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1934] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
[09/15 18:50:13 visual_prompt]: Constructing vtab-diabetic_retinopathy(config="btgraham-300") dataset trainval...
2023-09-15 18:50:13.367219: W tensorflow/core/platform/cloud/google_auth_provider.cc:184] All attempts to get a Google authentication bearer token failed, returning an empty token. Retrieving token from files failed with "NOT_FOUND: Could not locate the credentials file.". Retrieving token from GCE failed with "FAILED_PRECONDITION: Error executing an HTTP request: libcurl code 6 meaning 'Couldn't resolve host name', error details: Could not resolve host: metadata".
[INFO: dataset_info.py:  675]: Load pre-computed DatasetInfo (eg: splits, num examples,...) from GCS: diabetic_retinopathy_detection/btgraham-300/3.0.0
[INFO: dataset_info.py:  566]: Load dataset info from /tmp/tmpne1fe83ztfds
[INFO: dataset_info.py:  647]: Field info.release_notes from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.config_name from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.config_description from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.citation from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.splits from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.module_name from disk and from code do not match. Keeping the one from code.
[INFO: dataset_builder.py:  575]: Generating dataset diabetic_retinopathy_detection (visual_prompt_tuning/data_path/diabetic_retinopathy_detection/btgraham-300/3.0.0)
Downloading and preparing dataset 1.13 MiB (download: 1.13 MiB, generated: Unknown size, total: 1.13 MiB) to visual_prompt_tuning/data_path/diabetic_retinopathy_detection/btgraham-300/3.0.0...
Dl Completed...: 0 url [00:00, ? url/s]
Dl Size...: 0 MiB [00:00, ? MiB/s][A[INFO: download_manager.py:  388]: Skipping download of https://storage.googleapis.com/kaggle-forum-message-attachments/90528/2877/retinopathy_solution.csv: File cached in visual_prompt_tuning/data_path/downloads/kagg-foru-mess-atta_9052_2877_reti_solupq89ZoBOgYh9qJuSYbz7faT1us7bBw8bXbg_qHmrYMk.csv
Dl Completed...:   0%|          | 0/1 [00:00<?, ? url/s]
Dl Size...: 0 MiB [00:00, ? MiB/s][ADl Completed...: 100%|##########| 1/1 [00:00<00:00, 372.33 url/s]
Dl Size...: 0 MiB [00:00, ? MiB/s][ADl Completed...: 100%|##########| 1/1 [00:00<00:00, 338.03 url/s]
Dl Size...:   0%|          | 0/1181257 [00:00<?, ? MiB/s][ADl Completed...: 100%|##########| 1/1 [00:00<00:00, 308.04 url/s]
Dl Size...: 100%|##########| 1181257/1181257 [00:00<00:00, 389294488.89 MiB/s][ADl Size...: 100%|##########| 1181257/1181257 [00:00<00:00, 295529433.95 MiB/s]
Dl Completed...: 100%|##########| 1/1 [00:00<00:00, 217.89 url/s]
Generating splits...:   0%|          | 0/4 [00:00<?, ? splits/s]
Generating sample examples...:   0%|          | 0/10 [00:00<?, ? examples/s][A
                                                                            [A                                                                Traceback (most recent call last):
  File "visual_prompt_tuning/train.py", line 129, in <module>
    main(args)
  File "visual_prompt_tuning/train.py", line 124, in main
    train(cfg, args)
  File "visual_prompt_tuning/train.py", line 99, in train
    train_loader, val_loader, test_loader = get_loaders(cfg, logger)
  File "visual_prompt_tuning/train.py", line 66, in get_loaders
    train_loader = data_loader.construct_trainval_loader(cfg)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/loader.py", line 79, in construct_trainval_loader
    drop_last=drop_last,
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/loader.py", line 31, in _construct_loader
    dataset = TFDataset(cfg, split)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/datasets/tf_dataset.py", line 78, in __init__
    self.get_data(cfg, split)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/datasets/tf_dataset.py", line 81, in get_data
    tf_data = build_tf_dataset(cfg, split)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/datasets/tf_dataset.py", line 172, in build_tf_dataset
    vtab_tf_dataloader = data_cls(data_dir=data_dir)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/vtab_datasets/registry.py", line 50, in __init__
    super(_NewClass, self).__init__(*bound_args, **bound_kwargs)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/vtab_datasets/diabetic_retinopathy.py", line 61, in __init__
    dataset_builder.download_and_prepare()
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/logging/__init__.py", line 169, in __call__
    return function(*args, **kwargs)
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/dataset_builder.py", line 630, in download_and_prepare
    download_config=download_config,
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/dataset_builder.py", line 1477, in _download_and_prepare
    disable_shuffling=self.info.disable_shuffling,
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/split_builder.py", line 340, in submit_split_generation
    return self._build_from_generator(**build_kwargs)
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/split_builder.py", line 411, in _build_from_generator
    leave=False,
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tqdm/std.py", line 1195, in __iter__
    for obj in iterable:
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/image_classification/diabetic_retinopathy_detection.py", line 191, in _generate_examples
    for fname in tf.io.gfile.listdir(images_dir_path)
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow/python/lib/io/file_io.py", line 771, in list_directory_v2
    message="Could not find directory {}".format(path))
tensorflow.python.framework.errors_impl.NotFoundError: Could not find directory visual_prompt_tuning/data_path/downloads/manual/sample
[09/15 18:50:29 visual_prompt]: Rank of current process: 0. World size: 1
[09/15 18:50:29 visual_prompt]: Environment info:
-------------------  ----------------------------------------------------
Python               3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
ENV_MODULE           <not set>
PyTorch              1.7.1
PyTorch Debug Build  False
CUDA available       True
CUDA ID              2,3
GPU 0,1              NVIDIA TITAN X (Pascal)
Pillow               9.3.0
cv2                  4.8.0
-------------------  ----------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.5
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

[09/15 18:50:29 visual_prompt]: Command line arguments: Namespace(config_file='visual_prompt_tuning/configs/prompt/cub.yaml', opts=['MODEL.TYPE', 'vit', 'DATA.BATCH_SIZE', '64', 'MODEL.PROMPT.NUM_TOKENS', '100', 'MODEL.PROMPT.DEEP', 'True', 'MODEL.PROMPT.DROPOUT', '0.1', 'DATA.FEATURE', 'sup_vitb16_imagenet21k', 'DATA.NAME', 'vtab-diabetic_retinopathy(config="btgraham-300")', 'DATA.NUMBER_CLASSES', '5', 'SOLVER.BASE_LR', '5.0', 'SOLVER.WEIGHT_DECAY', '0.0001', 'MODEL.MODEL_ROOT', 'visual_prompt_tuning/model_root', 'DATA.DATAPATH', 'visual_prompt_tuning/data_path', 'OUTPUT_DIR', 'visual_prompt_tuning/output_dir/seed800'], train_type='')
[09/15 18:50:29 visual_prompt]: Contents of args.config_file=visual_prompt_tuning/configs/prompt/cub.yaml:
_BASE_: "../base-prompt.yaml"
RUN_N_TIMES: 1
DATA:
  NAME: "CUB"
  DATAPATH: ""  #TODO: need to specify here
  NUMBER_CLASSES: 200
  MULTILABEL: False
MODEL:
  TYPE: "vit"
SOLVER:
  BASE_LR: 0.1
  WEIGHT_DECAY: 0.01
[09/15 18:50:29 visual_prompt]: Training with config:
[09/15 18:50:29 visual_prompt]: {'CUDNN_BENCHMARK': False,
 'DATA': {'BATCH_SIZE': 64,
          'CLASS_WEIGHTS_TYPE': 'none',
          'CROPSIZE': 224,
          'DATAPATH': 'visual_prompt_tuning/data_path',
          'FEATURE': 'sup_vitb16_imagenet21k',
          'MULTILABEL': False,
          'NAME': 'vtab-diabetic_retinopathy(config="btgraham-300")',
          'NO_TEST': False,
          'NUMBER_CLASSES': 5,
          'NUM_WORKERS': 4,
          'PERCENTAGE': 1.0,
          'PIN_MEMORY': True},
 'DBG': False,
 'MODEL': {'ADAPTER': CfgNode({'REDUCATION_FACTOR': 8, 'STYLE': 'Pfeiffer'}),
           'LINEAR': CfgNode({'MLP_SIZES': [], 'DROPOUT': 0.1}),
           'MLP_NUM': 0,
           'MODEL_ROOT': 'visual_prompt_tuning/model_root',
           'PROMPT': {'CLSEMB_FOLDER': '',
                      'CLSEMB_PATH': '',
                      'DEEP': True,
                      'DEEP_SHARED': False,
                      'DROPOUT': 0.1,
                      'FORWARD_DEEP_NOEXPAND': False,
                      'INITIATION': 'random',
                      'LOCATION': 'prepend',
                      'NUM_DEEP_LAYERS': None,
                      'NUM_TOKENS': 100,
                      'PROJECT': -1,
                      'REVERSE_DEEP': False,
                      'SAVE_FOR_EACH_EPOCH': False,
                      'VIT_POOL_TYPE': 'original'},
           'SAVE_CKPT': False,
           'TRANSFER_TYPE': 'prompt',
           'TYPE': 'vit',
           'WEIGHT_PATH': ''},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': 'visual_prompt_tuning/output_dir/seed800/vtab-diabetic_retinopathy(config="btgraham-300")/sup_vitb16_imagenet21k/lr5.0_wd0.0001/run1',
 'RUN_N_TIMES': 1,
 'SEED': None,
 'SOLVER': {'BASE_LR': 5.0,
            'BIAS_MULTIPLIER': 1.0,
            'DBG_TRAINABLE': False,
            'LOG_EVERY_N': 100,
            'LOSS': 'softmax',
            'LOSS_ALPHA': 0.01,
            'MOMENTUM': 0.9,
            'OPTIMIZER': 'sgd',
            'PATIENCE': 300,
            'SCHEDULER': 'cosine',
            'TOTAL_EPOCH': 100,
            'WARMUP_EPOCH': 10,
            'WEIGHT_DECAY': 0.0001,
            'WEIGHT_DECAY_BIAS': 0}}
[09/15 18:50:29 visual_prompt]: Loading training data (final training data for vtab)...
2023-09-15 18:50:29.620850: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-09-15 18:50:30.827385: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/cv2/../../lib64:
2023-09-15 18:50:30.827508: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/cv2/../../lib64:
2023-09-15 18:50:30.827523: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2023-09-15 18:50:33.085669: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcusolver.so.11'; dlerror: libcusolver.so.11: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/cv2/../../lib64:
2023-09-15 18:50:33.085825: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudnn.so.8'; dlerror: libcudnn.so.8: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/cv2/../../lib64:
2023-09-15 18:50:33.085862: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1934] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
[09/15 18:50:33 visual_prompt]: Constructing vtab-diabetic_retinopathy(config="btgraham-300") dataset trainval...
2023-09-15 18:50:33.097402: W tensorflow/core/platform/cloud/google_auth_provider.cc:184] All attempts to get a Google authentication bearer token failed, returning an empty token. Retrieving token from files failed with "NOT_FOUND: Could not locate the credentials file.". Retrieving token from GCE failed with "FAILED_PRECONDITION: Error executing an HTTP request: libcurl code 6 meaning 'Couldn't resolve host name', error details: Could not resolve host: metadata".
[INFO: dataset_info.py:  675]: Load pre-computed DatasetInfo (eg: splits, num examples,...) from GCS: diabetic_retinopathy_detection/btgraham-300/3.0.0
[INFO: dataset_info.py:  566]: Load dataset info from /tmp/tmpn6z2e3iitfds
[INFO: dataset_info.py:  647]: Field info.release_notes from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.config_name from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.config_description from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.citation from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.splits from disk and from code do not match. Keeping the one from code.
[INFO: dataset_info.py:  647]: Field info.module_name from disk and from code do not match. Keeping the one from code.
[INFO: dataset_builder.py:  575]: Generating dataset diabetic_retinopathy_detection (visual_prompt_tuning/data_path/diabetic_retinopathy_detection/btgraham-300/3.0.0)
Downloading and preparing dataset 1.13 MiB (download: 1.13 MiB, generated: Unknown size, total: 1.13 MiB) to visual_prompt_tuning/data_path/diabetic_retinopathy_detection/btgraham-300/3.0.0...
Dl Completed...: 0 url [00:00, ? url/s]
Dl Size...: 0 MiB [00:00, ? MiB/s][A[INFO: download_manager.py:  388]: Skipping download of https://storage.googleapis.com/kaggle-forum-message-attachments/90528/2877/retinopathy_solution.csv: File cached in visual_prompt_tuning/data_path/downloads/kagg-foru-mess-atta_9052_2877_reti_solupq89ZoBOgYh9qJuSYbz7faT1us7bBw8bXbg_qHmrYMk.csv
Dl Completed...:   0%|          | 0/1 [00:00<?, ? url/s]
Dl Size...: 0 MiB [00:00, ? MiB/s][ADl Completed...: 100%|##########| 1/1 [00:00<00:00, 578.60 url/s]
Dl Size...: 0 MiB [00:00, ? MiB/s][ADl Completed...: 100%|##########| 1/1 [00:00<00:00, 528.38 url/s]
Dl Size...:   0%|          | 0/1181257 [00:00<?, ? MiB/s][ADl Completed...: 100%|##########| 1/1 [00:00<00:00, 484.78 url/s]
Dl Size...: 100%|##########| 1181257/1181257 [00:00<00:00, 623763182.69 MiB/s][ADl Size...: 100%|##########| 1181257/1181257 [00:00<00:00, 474801241.99 MiB/s]
Dl Completed...: 100%|##########| 1/1 [00:00<00:00, 346.58 url/s]
Generating splits...:   0%|          | 0/4 [00:00<?, ? splits/s]
Generating sample examples...:   0%|          | 0/10 [00:00<?, ? examples/s][A
                                                                            [A                                                                Traceback (most recent call last):
  File "visual_prompt_tuning/train.py", line 129, in <module>
    main(args)
  File "visual_prompt_tuning/train.py", line 124, in main
    train(cfg, args)
  File "visual_prompt_tuning/train.py", line 99, in train
    train_loader, val_loader, test_loader = get_loaders(cfg, logger)
  File "visual_prompt_tuning/train.py", line 66, in get_loaders
    train_loader = data_loader.construct_trainval_loader(cfg)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/loader.py", line 79, in construct_trainval_loader
    drop_last=drop_last,
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/loader.py", line 31, in _construct_loader
    dataset = TFDataset(cfg, split)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/datasets/tf_dataset.py", line 78, in __init__
    self.get_data(cfg, split)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/datasets/tf_dataset.py", line 81, in get_data
    tf_data = build_tf_dataset(cfg, split)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/datasets/tf_dataset.py", line 172, in build_tf_dataset
    vtab_tf_dataloader = data_cls(data_dir=data_dir)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/vtab_datasets/registry.py", line 50, in __init__
    super(_NewClass, self).__init__(*bound_args, **bound_kwargs)
  File "/home/s1952889/final-project/implementation/visual_prompt_tuning/src/data/vtab_datasets/diabetic_retinopathy.py", line 61, in __init__
    dataset_builder.download_and_prepare()
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/logging/__init__.py", line 169, in __call__
    return function(*args, **kwargs)
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/dataset_builder.py", line 630, in download_and_prepare
    download_config=download_config,
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/dataset_builder.py", line 1477, in _download_and_prepare
    disable_shuffling=self.info.disable_shuffling,
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/split_builder.py", line 340, in submit_split_generation
    return self._build_from_generator(**build_kwargs)
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/core/split_builder.py", line 411, in _build_from_generator
    leave=False,
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tqdm/std.py", line 1195, in __iter__
    for obj in iterable:
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow_datasets/image_classification/diabetic_retinopathy_detection.py", line 191, in _generate_examples
    for fname in tf.io.gfile.listdir(images_dir_path)
  File "/home/s1952889/miniconda3/envs/prompt/lib/python3.7/site-packages/tensorflow/python/lib/io/file_io.py", line 771, in list_directory_v2
    message="Could not find directory {}".format(path))
tensorflow.python.framework.errors_impl.NotFoundError: Could not find directory visual_prompt_tuning/data_path/downloads/manual/sample
